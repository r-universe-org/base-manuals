<!DOCTYPE html>
<html>
  <head>
    <title>Package 'splines' reference manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <!-- styling for math and syntax -->
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/katex.min.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/R.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/prism.css">

    <!-- for (future) customizations -->
    <script src="https://r-universe.dev/static/manual.js"></script>
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/manual.css?nocache=1">

  </head>

  <body class="macintosh">
    <h1 class="manual-title">Package 'splines'</h1>
    <table class="description-table">
      <tr>
<th>Title:</th>
<td class="description-title">Regression Spline Functions and Classes</td>
</tr>
      <tr>
<th>Description:</th>
<td class="description-description">Regression spline functions and classes.</td>
</tr>
      <tr>
<th>Authors:</th>
<td class="description-author">Douglas M. Bates &lt;bates@stat.wisc.edu&gt; and
 William N. Venables &lt;Bill.Venables@csiro.au&gt;</td>
</tr>
      <tr>
<th>Maintainer:</th>
<td class="description-maintainer">R Core Team &lt;do-use-Contact-address@r-project.org&gt;</td>
</tr>
      <tr>
<th>License:</th>
<td class="description-license">Part of R 4.2.2</td>
</tr>
      <tr>
<th>Version:</th>
<td class="description-version">4.2.2</td>
</tr>
      <tr>
<th>Built:</th>
<td class="description-date">2022-10-31 22:33:04 UTC</td>
</tr>
      <tr>
<th>Source:</th>
<td class="description-source">base</td>
</tr>
    </table>

    <a href="#help-index" style="color:black;"><h2 id="help-index">Help Index</h2></a>
    <ul id="help-index-list">
<li class="help-index-item"><a href="#asVector">Coerce an Object to a Vector</a></li>
<li class="help-index-item"><a href="#backSpline">Monotone Inverse Spline</a></li>
<li class="help-index-item"><a href="#bs">B-Spline Basis for Polynomial Splines</a></li>
<li class="help-index-item"><a href="#interpSpline">Create an Interpolation Spline</a></li>
<li class="help-index-item"><a href="#ns">Generate a Basis Matrix for Natural Cubic Splines</a></li>
<li class="help-index-item"><a href="#periodicSpline">Create a Periodic Interpolation Spline</a></li>
<li class="help-index-item"><a href="#polySpline">Piecewise Polynomial Spline Representation</a></li>
<li class="help-index-item"><a href="#predict.bs">Evaluate a Spline Basis</a></li>
<li class="help-index-item"><a href="#predict.bSpline">Evaluate a Spline at New Values of x</a></li>
<li class="help-index-item"><a href="#splineDesign">Design Matrix for B-splines</a></li>
<li class="help-index-item"><a href="#splineKnots">Knot Vector from a Spline</a></li>
<li class="help-index-item"><a href="#splineOrder">Determine the Order of a Spline</a></li>
<li class="help-index-item"><a href="#splines-package">
Regression Spline Functions and Classes
</a></li>
<li class="help-index-item"><a href="#xyVector">Construct an xyVector Object</a></li>
</ul>

    <hr>
    <div class="manual-pages-content">
<div class="container manual-page" id="asVector">

<a href="#asVector" class="help-page-title"><h2>Coerce an Object to a Vector</h2></a>

<h3>Description</h3>

<p>This is a generic function.  Methods for this function coerce objects
of given classes to vectors.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">asVector<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Methods for vector coercion in new classes must be created for the
<code>asVector</code> generic instead of <code>as.vector</code>.  The
<code>as.vector</code> function is internal and not easily extended.
Currently the only class with an <code>asVector</code> method is the
<code>xyVector</code> class.
</p>


<h3>Value</h3>

<p>a vector
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>See Also</h3>

<p><code><a href="#xyVector">xyVector</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
ispl <span class="token operator">&lt;-</span> interpSpline<span class="token punctuation">(</span> weight <span class="token operator">~</span> height<span class="token punctuation">,</span>  women <span class="token punctuation">)</span>
pred <span class="token operator">&lt;-</span> predict<span class="token punctuation">(</span>ispl<span class="token punctuation">)</span>
class<span class="token punctuation">(</span>pred<span class="token punctuation">)</span>
utils<span class="token operator">::</span>str<span class="token punctuation">(</span>pred<span class="token punctuation">)</span>
asVector<span class="token punctuation">(</span>pred<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="backSpline">

<a href="#backSpline" class="help-page-title"><h2>Monotone Inverse Spline</h2></a>

<h3>Description</h3>

<p>Create a monotone inverse of a monotone natural spline.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">backSpline<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object that inherits from class <code>nbSpline</code> or
<code>npolySpline</code>.  That is, the object must represent a natural
interpolation spline but it can be either in the B-spline
representation or the piecewise polynomial one.  The spline is
checked to see if it represents a monotone function.
</p>
</td>
</tr></table>
<h3>Value</h3>

<p>An object of class <code>polySpline</code> that contains the piecewise
polynomial representation of a function that has the appropriate
values and derivatives at the knot positions to be an inverse of the
spline represented by <code>object</code>.  Technically this object is not a
spline because the second derivative is not constrained to be
continuous at the knot positions.  However, it is often a much better
approximation to the inverse than fitting an interpolation spline to
the y/x pairs.
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>See Also</h3>

<p><code><a href="#interpSpline">interpSpline</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>graphics<span class="token punctuation">)</span>
ispl <span class="token operator">&lt;-</span> interpSpline<span class="token punctuation">(</span> women<span class="token operator">$</span>height<span class="token punctuation">,</span> women<span class="token operator">$</span>weight <span class="token punctuation">)</span>
bspl <span class="token operator">&lt;-</span> backSpline<span class="token punctuation">(</span> ispl <span class="token punctuation">)</span>
plot<span class="token punctuation">(</span> bspl <span class="token punctuation">)</span>                   <span class="token comment"># plots over the range of the knots</span>
points<span class="token punctuation">(</span> women<span class="token operator">$</span>weight<span class="token punctuation">,</span> women<span class="token operator">$</span>height <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="bs">

<a href="#bs" class="help-page-title"><h2>B-Spline Basis for Polynomial Splines</h2></a>

<h3>Description</h3>

<p>Generate the B-spline basis matrix for a polynomial spline.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">bs<span class="token punctuation">(</span>x<span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> knots <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> degree <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> intercept <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
   Boundary.knots <span class="token operator">=</span> range<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the predictor variable.  Missing values are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom; one can specify <code>df</code> rather than
<code>knots</code>; <code>bs()</code> then chooses <code>df-degree</code> (minus one
if there is an intercept) knots at suitable quantiles of <code>x</code>
(which will ignore missing values).  The default, <code>NULL</code>,
takes the number of inner knots as <code>length(knots)</code>.  If that is
zero as per default, that corresponds to <code>df = degree - intercept</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>the <em>internal</em> breakpoints that define the
spline.  The default is <code>NULL</code>, which results in a basis for
ordinary polynomial regression.  Typical values are the mean or
median for one knot, quantiles for more knots.  See also
<code>Boundary.knots</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>degree of the piecewise polynomial—default is <code>3</code> for
cubic splines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>if <code>TRUE</code>, an intercept is included in the
basis; default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Boundary.knots</code></td>
<td>
<p>boundary points at which to anchor the B-spline
basis (default the range of the non-<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code> data).  If both
<code>knots</code> and <code>Boundary.knots</code> are supplied, the basis
parameters do not depend on <code>x</code>.  Data can extend beyond
<code>Boundary.knots</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>bs</code> is based on the function <code><a href="#splineDesign">splineDesign</a></code>.
It generates a basis matrix for
representing the family of piecewise polynomials with the specified
interior knots and degree, evaluated at the values of <code>x</code>.  A
primary use is in modeling formulas to directly specify a piecewise
polynomial term in a model.
</p>
<p>When <code>Boundary.knots</code> are set <em>inside</em> <code>range(x)</code>,
<code>bs()</code> now uses a ‘pivot’ inside the respective boundary
knot which is important for derivative evaluation.  In <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> versions
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">\le</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span></code> 3.2.2, the boundary knot itself had been used as
pivot, which lead to somewhat wrong extrapolations.
</p>


<h3>Value</h3>

<p>A matrix of dimension <code>c(length(x), df)</code>, where either <code>df</code>
was supplied or if <code>knots</code> were supplied, <code>df =
  length(knots) + degree</code> plus one if there is an intercept.  Attributes
are returned that correspond to the arguments to <code>bs</code>, and
explicitly give the <code>knots</code>, <code>Boundary.knots</code> etc for use by
<code>predict.bs()</code>.
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables.  Tweaks by R Core, and a patch
fixing extrapolation “outside” <code>Boundary.knots</code> by Trevor
Hastie.
</p>


<h3>References</h3>

<p>Hastie, T. J. (1992)
Generalized additive models.
Chapter 7 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#ns">ns</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#poly">poly</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#smooth.spline">smooth.spline</a></code>,
<code><a href="#predict.bs">predict.bs</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#makepredictcall">SafePrediction</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span> require<span class="token punctuation">(</span>graphics<span class="token punctuation">)</span>
bs<span class="token punctuation">(</span>women<span class="token operator">$</span>height<span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1 <span class="token operator">&lt;-</span> lm<span class="token punctuation">(</span>weight <span class="token operator">~</span> bs<span class="token punctuation">(</span>height<span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> women<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## example of safe prediction</span>
plot<span class="token punctuation">(</span>women<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Height (in)"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Weight (lb)"</span><span class="token punctuation">)</span>
ht <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>ht<span class="token punctuation">,</span> predict<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> data.frame<span class="token punctuation">(</span>height <span class="token operator">=</span> ht<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="interpSpline">

<a href="#interpSpline" class="help-page-title"><h2>Create an Interpolation Spline</h2></a>

<h3>Description</h3>

<p>Create an interpolation spline, either from <code>x</code> and <code>y</code>
vectors (<code>default</code> method), or from a <code>formula</code> / <code>data.frame</code>
combination (<code>formula</code> method).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">interpSpline<span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> obj2<span class="token punctuation">,</span> bSpline <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> period <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
             ord <span class="token operator">=</span> <span class="token number">4L</span><span class="token punctuation">,</span>
             na.action <span class="token operator">=</span> na.fail<span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj1</code></td>
<td>
<p>either a numeric vector of <code>x</code> values or a formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj2</code></td>
<td>
<p>if <code>obj1</code> is numeric this should be a numeric vector
of the same length.  If <code>obj1</code> is a formula this can be an
optional data frame in which to evaluate the names in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bSpline</code></td>
<td>
<p>if <code>TRUE</code> the b-spline representation is returned,
otherwise the piecewise polynomial representation is returned.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>an optional positive numeric value giving a period for a
periodic interpolation spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>an integer specifying the spline <em>order</em>, the number of
coefficients per interval.  <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>r</mi><mi>d</mi><mo>=</mo><mi>d</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">ord = d+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> is the
<em>degree</em> polynomial degree.  Currently, only cubic splines
(<code>ord = 4</code>) are implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a optional function which indicates what should happen
when the data contain <code>NA</code>s.  The default action
(<code>na.omit</code>) is to omit any incomplete observations.  The
alternative action <code>na.fail</code> causes <code>interpSpline</code> to print
an error message and terminate if there are any incomplete
observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>logical passed to the underlying
<code><a href="#splineDesign">splineDesign</a></code>.  If true, saves memory and is faster when
there are more than a few hundred points.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object that inherits from (S3) class <code>spline</code>. The object can be in
the B-spline representation, in which case it will be of class
<code>nbSpline</code> for natural B-spline, or in the piecewise polynomial
representation, in which case it will be of class <code>npolySpline</code>.
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>See Also</h3>

<p><code><a href="#splineKnots">splineKnots</a></code>,
<code><a href="#splineOrder">splineOrder</a></code>,
<code><a href="#periodicSpline">periodicSpline</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>graphics<span class="token punctuation">)</span><span class="token punctuation">;</span> require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
ispl <span class="token operator">&lt;-</span> interpSpline<span class="token punctuation">(</span> women<span class="token operator">$</span>height<span class="token punctuation">,</span> women<span class="token operator">$</span>weight <span class="token punctuation">)</span>
ispl2 <span class="token operator">&lt;-</span> interpSpline<span class="token punctuation">(</span> weight <span class="token operator">~</span> height<span class="token punctuation">,</span>  women <span class="token punctuation">)</span>
<span class="token comment"># ispl and ispl2 should be the same</span>
plot<span class="token punctuation">(</span> predict<span class="token punctuation">(</span> ispl<span class="token punctuation">,</span> seq<span class="token punctuation">(</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">51</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span> <span class="token punctuation">)</span>
points<span class="token punctuation">(</span> women<span class="token operator">$</span>height<span class="token punctuation">,</span> women<span class="token operator">$</span>weight <span class="token punctuation">)</span>
plot<span class="token punctuation">(</span> ispl <span class="token punctuation">)</span>    <span class="token comment"># plots over the range of the knots</span>
points<span class="token punctuation">(</span> women<span class="token operator">$</span>height<span class="token punctuation">,</span> women<span class="token operator">$</span>weight <span class="token punctuation">)</span>
splineKnots<span class="token punctuation">(</span> ispl <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ns">

<a href="#ns" class="help-page-title"><h2>Generate a Basis Matrix for Natural Cubic Splines</h2></a>

<h3>Description</h3>

<p>Generate the B-spline basis matrix for a natural cubic spline.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">ns<span class="token punctuation">(</span>x<span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> knots <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> intercept <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
   Boundary.knots <span class="token operator">=</span> range<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the predictor variable.  Missing values are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom.  One can supply <code>df</code> rather than
knots; <code>ns()</code> then chooses <code>df - 1 - intercept</code> knots at
suitably chosen quantiles of <code>x</code> (which will ignore missing
values).  The default, <code>df = NULL</code>, sets the number of
inner knots as <code>length(knots)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>breakpoints that define the spline.  The default is no
knots; together with the natural boundary conditions this results in
a basis for linear regression on <code>x</code>.  Typical values are the
mean or median for one knot, quantiles for more knots.  See also
<code>Boundary.knots</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>if <code>TRUE</code>, an intercept is included in the
basis; default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Boundary.knots</code></td>
<td>
<p>boundary points at which to impose the natural
boundary conditions and anchor the B-spline basis (default the range
of the data).  If both <code>knots</code> and <code>Boundary.knots</code> are
supplied, the basis parameters do not depend on <code>x</code>. Data can
extend beyond <code>Boundary.knots</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>ns</code> is based on the function <code><a href="#splineDesign">splineDesign</a></code>.  It
generates a basis matrix for representing the family of
piecewise-cubic splines with the specified sequence of
interior knots, and the natural boundary conditions.  These enforce
the constraint that the function is linear beyond the boundary knots,
which can either be supplied or default to the extremes of the
data.
</p>
<p>A primary use is in modeling formula to directly specify a
natural spline term in a model: see the examples.
</p>


<h3>Value</h3>

<p>A matrix of dimension <code>length(x) * df</code> where either <code>df</code> was
supplied or if <code>knots</code> were supplied,
<code>df = length(knots) + 1 + intercept</code>.
Attributes are returned that correspond to the arguments to <code>ns</code>,
and explicitly give the <code>knots</code>, <code>Boundary.knots</code> etc for
use by <code>predict.ns()</code>.
</p>


<h3>References</h3>

<p>Hastie, T. J. (1992)
Generalized additive models.
Chapter 7 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#bs">bs</a></code>, <code><a href="#predict.bs">predict.ns</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#makepredictcall">SafePrediction</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span> require<span class="token punctuation">(</span>graphics<span class="token punctuation">)</span>
ns<span class="token punctuation">(</span>women<span class="token operator">$</span>height<span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1 <span class="token operator">&lt;-</span> lm<span class="token punctuation">(</span>weight <span class="token operator">~</span> ns<span class="token punctuation">(</span>height<span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> women<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## To see what knots were selected</span>
attr<span class="token punctuation">(</span>terms<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"predvars"</span><span class="token punctuation">)</span>

<span class="token comment">## example of safe prediction</span>
plot<span class="token punctuation">(</span>women<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Height (in)"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Weight (lb)"</span><span class="token punctuation">)</span>
ht <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> nD <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>height <span class="token operator">=</span> ht<span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>ht<span class="token punctuation">,</span> p1 <span class="token operator">&lt;-</span> predict<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> nD<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>p1<span class="token punctuation">,</span> predict<span class="token punctuation">(</span>update<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> . <span class="token operator">~</span>
                            splines<span class="token operator">::</span>ns<span class="token punctuation">(</span>height<span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nD<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token comment"># not true in R &lt; 3.5.0</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="periodicSpline">

<a href="#periodicSpline" class="help-page-title"><h2>Create a Periodic Interpolation Spline</h2></a>

<h3>Description</h3>

<p>Create a periodic interpolation spline, either from <code>x</code> and
<code>y</code> vectors, or from a formula/data.frame combination.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">periodicSpline<span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> obj2<span class="token punctuation">,</span> knots<span class="token punctuation">,</span> period <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> ord <span class="token operator">=</span> <span class="token number">4L</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj1</code></td>
<td>
<p>either a numeric vector of <code>x</code> values or a formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj2</code></td>
<td>
<p>if <code>obj1</code> is numeric this should be a numeric vector
of the same length.  If <code>obj1</code> is a formula this can be an
optional data frame in which to evaluate the names in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>optional numeric vector of knot positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>positive numeric value giving the period for the
periodic spline.  Defaults to <code>2 * pi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>integer giving the order of the spline, at least 2.  Defaults
to 4.  See <code><a href="#splineOrder">splineOrder</a></code> for a definition of the order of
a spline.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object that inherits from class <code>spline</code>.  The object can be in
the B-spline representation, in which case it will be a
<code>pbSpline</code> object, or in the piecewise polynomial representation
(a <code>ppolySpline</code> object).
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>See Also</h3>

<p><code><a href="#splineKnots">splineKnots</a></code>,
<code><a href="#interpSpline">interpSpline</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>graphics<span class="token punctuation">)</span><span class="token punctuation">;</span> require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
xx <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span> <span class="token operator">-</span>pi<span class="token punctuation">,</span> pi<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">16</span> <span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
yy <span class="token operator">&lt;-</span> sin<span class="token punctuation">(</span> xx <span class="token punctuation">)</span>
frm <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span> xx<span class="token punctuation">,</span> yy <span class="token punctuation">)</span>
pispl <span class="token operator">&lt;-</span> periodicSpline<span class="token punctuation">(</span> xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> period <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span>
pispl
pispl2 <span class="token operator">&lt;-</span> periodicSpline<span class="token punctuation">(</span> yy <span class="token operator">~</span> xx<span class="token punctuation">,</span> frm<span class="token punctuation">,</span> period <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> pi <span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>pispl<span class="token punctuation">,</span> pispl2<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># pispl and pispl2 are the same</span>

plot<span class="token punctuation">(</span> pispl <span class="token punctuation">)</span>          <span class="token comment"># displays over one period</span>
points<span class="token punctuation">(</span> yy <span class="token operator">~</span> xx<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"brown"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span> predict<span class="token punctuation">(</span> pispl<span class="token punctuation">,</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span> <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="polySpline">

<a href="#polySpline" class="help-page-title"><h2>Piecewise Polynomial Spline Representation</h2></a>

<h3>Description</h3>

<p>Create the piecewise polynomial representation of a spline object.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">polySpline<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
as.polySpline<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object that inherits from class <code>spline</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional additional arguments.  At present no additional
arguments are used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object that inherits from class <code>polySpline</code>.  This is the
piecewise polynomial representation of a univariate spline function.
It is defined by a set of distinct numeric values called knots.  The
spline function is a polynomial function between each successive pair
of knots.  At each interior knot the polynomial segments on each side
are constrained to have the same value of the function and some of its
derivatives.
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>See Also</h3>

<p><code><a href="#interpSpline">interpSpline</a></code>,
<code><a href="#periodicSpline">periodicSpline</a></code>,
<code><a href="#splineKnots">splineKnots</a></code>,
<code><a href="#splineOrder">splineOrder</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>graphics<span class="token punctuation">)</span>
ispl <span class="token operator">&lt;-</span> polySpline<span class="token punctuation">(</span>interpSpline<span class="token punctuation">(</span> weight <span class="token operator">~</span> height<span class="token punctuation">,</span>  women<span class="token punctuation">,</span> bSpline <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## IGNORE_RDIFF_BEGIN</span>
print<span class="token punctuation">(</span> ispl <span class="token punctuation">)</span>   <span class="token comment"># print the piecewise polynomial representation</span>
<span class="token comment">## IGNORE_RDIFF_END</span>
plot<span class="token punctuation">(</span> ispl <span class="token punctuation">)</span>    <span class="token comment"># plots over the range of the knots</span>
points<span class="token punctuation">(</span> women<span class="token operator">$</span>height<span class="token punctuation">,</span> women<span class="token operator">$</span>weight <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="predict.bs">

<a href="#predict.bs" class="help-page-title"><h2>Evaluate a Spline Basis</h2></a>

<h3>Description</h3>

<p>Evaluate a predefined spline basis at given values.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'bs'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> newx<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'ns'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> newx<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>the result of a call to <code><a href="#bs">bs</a></code> or
<code><a href="#ns">ns</a></code> having attributes describing <code>knots</code>,
<code>degree</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newx</code></td>
<td>
<p>the <code>x</code> values at which evaluations are required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional additional arguments.  At present no additional
arguments are used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object just like <code>object</code>, except evaluated at the new values
of <code>x</code>.
</p>
<p>These are methods for the generic function <code><a href="https://r-universe.dev/manuals/stats.html#predict">predict</a></code> for
objects inheriting from classes <code>"bs"</code> or <code>"ns"</code>.  See
<code><a href="https://r-universe.dev/manuals/stats.html#predict">predict</a></code> for the general behavior of this function.
</p>


<h3>See Also</h3>

<p><code><a href="#bs">bs</a></code>, <code><a href="#ns">ns</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#poly">poly</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
basis <span class="token operator">&lt;-</span> ns<span class="token punctuation">(</span>women<span class="token operator">$</span>height<span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
newX <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">51</span><span class="token punctuation">)</span>
<span class="token comment"># evaluate the basis at the new data</span>
predict<span class="token punctuation">(</span>basis<span class="token punctuation">,</span> newX<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="predict.bSpline">

<a href="#predict.bSpline" class="help-page-title"><h2>Evaluate a Spline at New Values of x</h2></a>

<h3>Description</h3>

<p>The <code>predict</code> methods for the classes that inherit from the
virtual classes <code>bSpline</code> and <code>polySpline</code> are used to
evaluate the spline or its derivatives.  The <code>plot</code> method for a
spline object first evaluates <code>predict</code> with the <code>x</code>
argument missing, then plots the resulting <code>xyVector</code> with
<code>type = "l"</code>.</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'bSpline'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> x<span class="token punctuation">,</span> nseg <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> deriv <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'nbSpline'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> x<span class="token punctuation">,</span> nseg <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> deriv <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'pbSpline'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> x<span class="token punctuation">,</span> nseg <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> deriv <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'npolySpline'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> x<span class="token punctuation">,</span> nseg <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> deriv <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'ppolySpline'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> x<span class="token punctuation">,</span> nseg <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> deriv <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object that inherits from the <code>bSpline</code> or the
<code>polySpline</code> class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector of <code>x</code> values at which to evaluate the
spline.  If this argument is missing a suitable set of <code>x</code>
values is generated as a sequence of <code>nseq</code> segments spanning
the range of the knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nseg</code></td>
<td>
<p>A positive integer giving the number of segments in a set
of equally-spaced <code>x</code> values spanning the range of the knots
in <code>object</code>.  This value is only used if <code>x</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>An integer between 0 and <code>splineOrder(object) - 1</code>
specifying the derivative to evaluate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an <code>xyVector</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the supplied or inferred numeric vector of <code>x</code> values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the value of the spline (or its <code>deriv</code>'th derivative)
at the <code>x</code> vector</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>See Also</h3>

<p><code><a href="#xyVector">xyVector</a></code>,
<code><a href="#interpSpline">interpSpline</a></code>,
<code><a href="#periodicSpline">periodicSpline</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>graphics<span class="token punctuation">)</span><span class="token punctuation">;</span> require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
ispl <span class="token operator">&lt;-</span> interpSpline<span class="token punctuation">(</span> weight <span class="token operator">~</span> height<span class="token punctuation">,</span>  women <span class="token punctuation">)</span>
opar <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> las <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>predict<span class="token punctuation">(</span>ispl<span class="token punctuation">,</span> nseg <span class="token operator">=</span> <span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">,</span>     <span class="token comment"># plots over the range of the knots</span>
     main <span class="token operator">=</span> <span class="token string">"Original data with interpolating spline"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> <span class="token string">"height"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"weight"</span><span class="token punctuation">)</span>
points<span class="token punctuation">(</span>women<span class="token operator">$</span>height<span class="token punctuation">,</span> women<span class="token operator">$</span>weight<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>predict<span class="token punctuation">(</span>ispl<span class="token punctuation">,</span> nseg <span class="token operator">=</span> <span class="token number">201</span><span class="token punctuation">,</span> deriv <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token string">"First derivative of interpolating spline"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> <span class="token string">"height"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"weight"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>predict<span class="token punctuation">(</span>ispl<span class="token punctuation">,</span> nseg <span class="token operator">=</span> <span class="token number">201</span><span class="token punctuation">,</span> deriv <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token string">"Second derivative of interpolating spline"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> <span class="token string">"height"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"weight"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>predict<span class="token punctuation">(</span>ispl<span class="token punctuation">,</span> nseg <span class="token operator">=</span> <span class="token number">401</span><span class="token punctuation">,</span> deriv <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token string">"Third derivative of interpolating spline"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> <span class="token string">"height"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"weight"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>opar<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="splineDesign">

<a href="#splineDesign" class="help-page-title"><h2>Design Matrix for B-splines</h2></a>

<h3>Description</h3>

<p>Evaluate the design matrix for the B-splines defined by <code>knots</code>
at the values in <code>x</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">splineDesign<span class="token punctuation">(</span>knots<span class="token punctuation">,</span> x<span class="token punctuation">,</span> ord <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> derivs<span class="token punctuation">,</span> outer.ok <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
             sparse <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
spline.des  <span class="token punctuation">(</span>knots<span class="token punctuation">,</span> x<span class="token punctuation">,</span> ord <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> derivs<span class="token punctuation">,</span> outer.ok <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
             sparse <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>a numeric vector of knot positions (which will be sorted
increasingly if needed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of values at which to evaluate the B-spline
functions or derivatives.  Unless <code>outer.ok</code> is true, the
values in <code>x</code> must be between the “inner” knots
<code>knots[ord]</code> and <code>knots[ length(knots) - (ord-1)]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>a positive integer giving the order of the spline function.
This is the number of coefficients in each piecewise polynomial
segment, thus a cubic spline has order 4.  Defaults to 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derivs</code></td>
<td>
<p>an integer vector with values between <code>0</code> and
<code>ord - 1</code>, conceptually recycled to the length of <code>x</code>.
The derivative of the given order is evaluated at the <code>x</code>
positions.  Defaults to zero (or a vector of zeroes of the same
length as <code>x</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer.ok</code></td>
<td>
<p>logical indicating if <code>x</code> should be allowed
outside the <em>inner</em> knots, see the <code>x</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>logical indicating if the result should inherit from class
<code>"<a href="https://r-forge.r-universe.dev/manual/Matrix.html#sparseMatrix-class">sparseMatrix</a>"</code> (from package <a href="https://CRAN.R-project.org/package=Matrix" target="_blank"><span class="pkg">Matrix</span></a>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with <code>length(x)</code> rows and <code>length(knots) - ord</code>
columns.  The i'th row of the matrix contains the coefficients of the
B-splines (or the indicated derivative of the B-splines) defined by
the <code>knot</code> vector and evaluated at the i'th value of <code>x</code>.
Each B-spline is defined by a set of <code>ord</code> successive knots so
the total number of B-splines is <code>length(knots) - ord</code>.
</p>


<h3>Note</h3>

<p>The older <code>spline.des</code> function takes the same arguments but
returns a list with several components including <code>knots</code>,
<code>ord</code>, <code>derivs</code>, and <code>design</code>.  The <code>design</code>
component is the same as the value of the <code>splineDesign</code>
function.
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>graphics<span class="token punctuation">)</span>
splineDesign<span class="token punctuation">(</span>knots <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span>
splineDesign<span class="token punctuation">(</span>knots <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> derivs <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">## visualize band structure</span>
Matrix<span class="token operator">::</span>drop0<span class="token punctuation">(</span>zapsmall<span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">*</span>splineDesign<span class="token punctuation">(</span>knots <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">40</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">37</span><span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

knots <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1.8</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6.5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8.1</span><span class="token punctuation">,</span><span class="token number">9.2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 10 =&gt; 10-4 = 6 Basis splines</span>
x <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span>min<span class="token punctuation">(</span>knots<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> max<span class="token punctuation">(</span>knots<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">501</span><span class="token punctuation">)</span>
bb <span class="token operator">&lt;-</span> splineDesign<span class="token punctuation">(</span>knots<span class="token punctuation">,</span> x <span class="token operator">=</span> x<span class="token punctuation">,</span> outer.ok <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

plot<span class="token punctuation">(</span>range<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span>  <span class="token string">"B-splines - sum to 1 inside inner knots"</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span>expression<span class="token punctuation">(</span>B<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">*</span><span class="token string">"  and "</span><span class="token operator">*</span> sum<span class="token punctuation">(</span>B<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> j <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>v <span class="token operator">=</span> knots<span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"light gray"</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>v <span class="token operator">=</span> knots<span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>length<span class="token punctuation">(</span>knots<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray10"</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> rowSums<span class="token punctuation">(</span>bb<span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
matlines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> bb<span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="splineKnots">

<a href="#splineKnots" class="help-page-title"><h2>Knot Vector from a Spline</h2></a>

<h3>Description</h3>

<p>Return the knot vector corresponding to a spline object.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">splineKnots<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object that inherits from class <code>"spline"</code>.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>A non-decreasing numeric vector of knot positions.
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">ispl <span class="token operator">&lt;-</span> interpSpline<span class="token punctuation">(</span> weight <span class="token operator">~</span> height<span class="token punctuation">,</span> women <span class="token punctuation">)</span>
splineKnots<span class="token punctuation">(</span> ispl <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="splineOrder">

<a href="#splineOrder" class="help-page-title"><h2>Determine the Order of a Spline</h2></a>

<h3>Description</h3>

<p>Return the order of a spline object.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">splineOrder<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object that inherits from class <code>"spline"</code>.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The order of a spline is the number of coefficients in each piece of
the piecewise polynomial representation.  Thus a cubic spline has
order 4.
</p>


<h3>Value</h3>

<p>A positive integer.
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>See Also</h3>

<p><code><a href="#splineKnots">splineKnots</a></code>,
<code><a href="#interpSpline">interpSpline</a></code>,
<code><a href="#periodicSpline">periodicSpline</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">splineOrder<span class="token punctuation">(</span> interpSpline<span class="token punctuation">(</span> weight <span class="token operator">~</span> height<span class="token punctuation">,</span> women <span class="token punctuation">)</span> <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="splines-package">

<a href="#splines-package" class="help-page-title"><h2>
Regression Spline Functions and Classes
</h2></a>

<h3>Description</h3>

<p>Regression spline functions and classes.
</p>


<h3>Details</h3>

<p>This package provides functions for working with regression
splines using the B-spline basis, <code><a href="#bs">bs</a></code>, and the
natural cubic spline basis, <code><a href="#ns">ns</a></code>.
</p>
<p>For a complete list of functions, use <code>library(help = "splines")</code>.
</p>


<h3>Author(s)</h3>

<p>Douglas M. Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a> and William N. Venables
<a href="mailto:Bill.Venables@csiro.au">Bill.Venables@csiro.au</a>
</p>
<p>Maintainer: R Core Team <a href="mailto:R-core@r-project.org">R-core@r-project.org</a>
</p>

<hr>
</div>
<div class="container manual-page" id="xyVector">

<a href="#xyVector" class="help-page-title"><h2>Construct an <code>xyVector</code> Object</h2></a>

<h3>Description</h3>

<p>Create an object to represent a set of x-y pairs.  The resulting
object can be treated as a matrix or as a data frame or as a vector.
When treated as a vector it reduces to the <code>y</code> component only.
</p>
<p>The result of functions such as <code>predict.spline</code> is returned as
an <code>xyVector</code> object so the x-values used to generate the
y-positions are retained, say for purposes of generating plots.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">xyVector<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector of the same length as <code>x</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>xyVector</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector of the same length as <code>x</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Douglas Bates and Bill Venables</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span> require<span class="token punctuation">(</span>graphics<span class="token punctuation">)</span>
ispl <span class="token operator">&lt;-</span> interpSpline<span class="token punctuation">(</span> weight <span class="token operator">~</span> height<span class="token punctuation">,</span> women <span class="token punctuation">)</span>
weights <span class="token operator">&lt;-</span> predict<span class="token punctuation">(</span> ispl<span class="token punctuation">,</span> seq<span class="token punctuation">(</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">51</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
class<span class="token punctuation">(</span> weights <span class="token punctuation">)</span>
plot<span class="token punctuation">(</span> weights<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"height"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"weight"</span> <span class="token punctuation">)</span>
points<span class="token punctuation">(</span> women<span class="token operator">$</span>height<span class="token punctuation">,</span> women<span class="token operator">$</span>weight <span class="token punctuation">)</span>
weights</code></pre>

<hr>
</div>
</div>
    <footer><p>Rendered with postdoc 1.0.0</p></footer>
  </body>
</html>
