<!DOCTYPE html>
<html>
  <head>
    <title>Package 'nnet' reference manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <!-- styling for math and syntax -->
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/katex.min.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/R.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/prism.css">

    <!-- for (future) customizations -->
    <script src="https://r-universe.dev/static/manual.js"></script>
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/manual.css?nocache=1">

  </head>

  <body class="macintosh">
    <h1 class="manual-title">Package 'nnet'</h1>
    <table class="description-table">
      <tr>
<th>Title:</th>
<td class="description-title">Feed-Forward Neural Networks and Multinomial Log-Linear Models</td>
</tr>
      <tr>
<th>Description:</th>
<td class="description-description">Software for feed-forward neural networks with a single
  hidden layer, and for multinomial log-linear models.</td>
</tr>
      <tr>
<th>Authors:</th>
<td class="description-author"><span>Brian Ripley [aut, cre, cph],
  William Venables [cph]</span></td>
</tr>
      <tr>
<th>Maintainer:</th>
<td class="description-maintainer">Brian Ripley &lt;ripley@stats.ox.ac.uk&gt;</td>
</tr>
      <tr>
<th>License:</th>
<td class="description-license">GPL-2 | GPL-3</td>
</tr>
      <tr>
<th>Version:</th>
<td class="description-version">7.3-19</td>
</tr>
      <tr>
<th>Built:</th>
<td class="description-date">2024-03-27 22:42:15 UTC</td>
</tr>
      <tr>
<th>Source:</th>
<td class="description-source">CRAN</td>
</tr>
    </table>

    <a href="#help-index" style="color:black;"><h2 id="help-index">Help Index</h2></a>
    <ul id="help-index-list">
<li class="help-index-item"><a href="#class.ind">
Generates Class Indicator Matrix from a Factor
</a></li>
<li class="help-index-item"><a href="#multinom">
Fit Multinomial Log-linear Models
</a></li>
<li class="help-index-item"><a href="#nnet">
Fit Neural Networks
</a></li>
<li class="help-index-item"><a href="#nnet.Hess">
Evaluates Hessian for a Neural Network
</a></li>
<li class="help-index-item"><a href="#predict.nnet">
Predict New Examples by a Trained Neural Net
</a></li>
<li class="help-index-item"><a href="#which.is.max">
Find Maximum Position in Vector
</a></li>
</ul>

    <hr>
    <div class="manual-pages-content">
<div class="container manual-page" id="class.ind"><main><a href="#class.ind" class="help-page-title"><h2>
Generates Class Indicator Matrix from a Factor
</h2></a>

<h3>Description</h3>

<p>Generates a class indicator function from a given factor.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">class.ind<span class="token punctuation">(</span>cl<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="cl">cl</code></td>
<td>

<p>factor or vector of classes for cases.
</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a matrix which is zero except for the column corresponding to the class.
</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (2002)
<em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># The function is currently defined as</span>
class.ind <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  n <span class="token operator">&lt;-</span> length<span class="token punctuation">(</span>cl<span class="token punctuation">)</span>
  cl <span class="token operator">&lt;-</span> as.factor<span class="token punctuation">(</span>cl<span class="token punctuation">)</span>
  x <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> length<span class="token punctuation">(</span>levels<span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
  x<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> n<span class="token operator">*</span><span class="token punctuation">(</span>unclass<span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
  dimnames<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>names<span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">,</span> levels<span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">)</span>
  x
<span class="token punctuation">}</span></code></pre>

<hr></main></div>
<div class="container manual-page" id="multinom"><main><a href="#multinom" class="help-page-title"><h2>
Fit Multinomial Log-linear Models
</h2></a>

<h3>Description</h3>

<p>Fits multinomial log-linear models via neural networks.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">multinom<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span>
         contrasts <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> Hess <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> summ <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> censored <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
         model <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="formula">formula</code></td>
<td>

<p>a formula expression as for regression models, of the form
<code>response ~ predictors</code>. The response should be a factor or a
matrix with K columns, which will be interpreted as counts for each of
K classes.
A log-linear model is fitted, with coefficients zero for the first
class. An offset can be included: it should be a numeric matrix with K columns
if the response is either a matrix with K columns or a factor with K &gt;= 2
classes, or a numeric vector for a response factor with 2 levels.
See the documentation of <code><a href="https://r-universe.dev/manuals/stats.html#formula">formula</a>()</code> for other details.
</p>
</td>
</tr>
<tr>
<td><code id="data">data</code></td>
<td>

<p>an optional data frame in which to interpret the variables occurring
in <code>formula</code>.
</p>
</td>
</tr>
<tr>
<td><code id="weights">weights</code></td>
<td>

<p>optional case weights in fitting.
</p>
</td>
</tr>
<tr>
<td><code id="subset">subset</code></td>
<td>

<p>expression saying which subset of the rows of the data should  be used
in the fit. All observations are included by default.
</p>
</td>
</tr>
<tr>
<td><code id="na.action">na.action</code></td>
<td>

<p>a function to filter missing data.
</p>
</td>
</tr>
<tr>
<td><code id="contrasts">contrasts</code></td>
<td>

<p>a list of contrasts to be used for some or all of
the factors appearing as variables in the model formula.
</p>
</td>
</tr>
<tr>
<td><code id="Hess">Hess</code></td>
<td>

<p>logical for whether the Hessian (the observed/expected information matrix)
should be returned.
</p>
</td>
</tr>
<tr>
<td><code id="summ">summ</code></td>
<td>

<p>integer; if non-zero summarize by deleting duplicate rows and adjust weights.
Methods 1 and 2 differ in speed (2 uses <code>C</code>); method 3 also combines rows
with the same X and different Y, which changes the baseline for the
deviance.
</p>
</td>
</tr>
<tr>
<td><code id="censored">censored</code></td>
<td>

<p>If Y is a matrix with <code>K</code> columns, interpret the entries as one
for possible classes, zero for impossible classes, rather than as
counts.
</p>
</td>
</tr>
<tr>
<td><code id="model">model</code></td>
<td>

<p>logical. If true, the model frame is saved as component <code>model</code>
of the returned object.
</p>
</td>
</tr>
<tr>
<td><code id="...">...</code></td>
<td>

<p>additional arguments for <code>nnet</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>multinom</code> calls <code><a href="#nnet">nnet</a></code>.  The variables on the rhs of
the formula should be roughly scaled to [0,1] or the fit will be slow
or may not converge at all.
</p>


<h3>Value</h3>

<p>A <code>nnet</code> object with additional components:
</p>
<table>
<tr>
<td><code>deviance</code></td>
<td>

<p>the residual deviance, compared to the full saturated model (that
explains individual observations exactly).  Also, minus twice log-likelihood.
</p>
</td>
</tr>
<tr>
<td><code>edf</code></td>
<td>

<p>the (effective) number of degrees of freedom used by the model
</p>
</td>
</tr>
<tr>
<td><code>AIC</code></td>
<td>

<p>the AIC for this fit.
</p>
</td>
</tr>
<tr>
<td><code>Hessian</code></td>
<td>

<p>(if <code>Hess</code> is true).
</p>
</td>
</tr>
<tr>
<td><code>model</code></td>
<td>

<p>(if <code>model</code> is true).
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (2002)
<em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#nnet">nnet</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">oc <span class="token operator">&lt;-</span> options<span class="token punctuation">(</span>contrasts <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"contr.treatment"</span><span class="token punctuation">,</span> <span class="token string">"contr.poly"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
library<span class="token punctuation">(</span>MASS<span class="token punctuation">)</span>
example<span class="token punctuation">(</span>birthwt<span class="token punctuation">)</span>
<span class="token punctuation">(</span>bwt.mu <span class="token operator">&lt;-</span> multinom<span class="token punctuation">(</span>low <span class="token operator">~</span> .<span class="token punctuation">,</span> bwt<span class="token punctuation">)</span><span class="token punctuation">)</span>
options<span class="token punctuation">(</span>oc<span class="token punctuation">)</span></code></pre>

<hr></main></div>
<div class="container manual-page" id="nnet"><main><a href="#nnet" class="help-page-title"><h2>
Fit Neural Networks
</h2></a>

<h3>Description</h3>

<p>Fit single-hidden-layer neural network, possibly with skip-layer connections.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">nnet<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
nnet<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
     subset<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span> contrasts <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
nnet<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> size<span class="token punctuation">,</span> Wts<span class="token punctuation">,</span> mask<span class="token punctuation">,</span>
     linout <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> entropy <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> softmax <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
     censored <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> skip <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> rang <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">,</span> decay <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
     maxit <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> Hess <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> trace <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> MaxNWts <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span>
     abstol <span class="token operator">=</span> <span class="token number">1.0e-4</span><span class="token punctuation">,</span> reltol <span class="token operator">=</span> <span class="token number">1.0e-8</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="formula">formula</code></td>
<td>

<p>A formula of the form <code>class ~ x1 + x2 + ...</code>
</p>
</td>
</tr>
<tr>
<td><code id="x">x</code></td>
<td>

<p>matrix or data frame of <code>x</code> values for examples.
</p>
</td>
</tr>
<tr>
<td><code id="y">y</code></td>
<td>

<p>matrix or data frame of target values for examples.
</p>
</td>
</tr>
<tr>
<td><code id="weights">weights</code></td>
<td>

<p>(case) weights for each example â€“ if missing defaults to 1.
</p>
</td>
</tr>
<tr>
<td><code id="size">size</code></td>
<td>

<p>number of units in the hidden layer. Can be zero if there are skip-layer units.
</p>
</td>
</tr>
<tr>
<td><code id="data">data</code></td>
<td>

<p>Data frame from which variables specified in  <code>formula</code> are
preferentially to be taken.
</p>
</td>
</tr>
<tr>
<td><code id="subset">subset</code></td>
<td>

<p>An index vector specifying the cases to be used in the training
sample.  (NOTE: If given, this argument must be named.)
</p>
</td>
</tr>
<tr>
<td><code id="na.action">na.action</code></td>
<td>

<p>A function to specify the action to be taken if <code>NA</code>s are found.
The default action is for the procedure to fail.  An alternative is
na.omit, which leads to rejection of cases with missing values on
any required variable.  (NOTE: If given, this argument must be named.)
</p>
</td>
</tr>
<tr>
<td><code id="contrasts">contrasts</code></td>
<td>

<p>a list of contrasts to be used for some or all  of
the  factors  appearing as variables in the model formula.
</p>
</td>
</tr>
<tr>
<td><code id="Wts">Wts</code></td>
<td>

<p>initial parameter vector. If missing chosen at random.
</p>
</td>
</tr>
<tr>
<td><code id="mask">mask</code></td>
<td>

<p>logical vector indicating which parameters should be optimized (default all).
</p>
</td>
</tr>
<tr>
<td><code id="linout">linout</code></td>
<td>

<p>switch for linear output units. Default logistic output units.
</p>
</td>
</tr>
<tr>
<td><code id="entropy">entropy</code></td>
<td>

<p>switch for entropy (= maximum conditional likelihood) fitting.
Default by least-squares.
</p>
</td>
</tr>
<tr>
<td><code id="softmax">softmax</code></td>
<td>

<p>switch for softmax (log-linear model) and maximum conditional
likelihood fitting. <code>linout</code>, <code>entropy</code>, <code>softmax</code> and <code>censored</code> are mutually
exclusive.
</p>
</td>
</tr>
<tr>
<td><code id="censored">censored</code></td>
<td>

<p>A variant on <code>softmax</code>, in which non-zero targets mean possible
classes. Thus for <code>softmax</code> a row of <code>(0, 1, 1)</code> means one example
each of classes 2 and 3, but for <code>censored</code> it means one example whose
class is only known to be 2 or 3.
</p>
</td>
</tr>
<tr>
<td><code id="skip">skip</code></td>
<td>

<p>switch to add skip-layer connections from input to output.
</p>
</td>
</tr>
<tr>
<td><code id="rang">rang</code></td>
<td>

<p>Initial random weights on [-<code>rang</code>, <code>rang</code>].  Value about 0.5 unless the
inputs are large, in which case it should be chosen so that
<code>rang</code> * max(<code>|x|</code>) is about 1.
</p>
</td>
</tr>
<tr>
<td><code id="decay">decay</code></td>
<td>

<p>parameter for weight decay.  Default 0.
</p>
</td>
</tr>
<tr>
<td><code id="maxit">maxit</code></td>
<td>

<p>maximum number of iterations. Default 100.
</p>
</td>
</tr>
<tr>
<td><code id="Hess">Hess</code></td>
<td>

<p>If true, the Hessian of the measure of fit at the best set of weights
found is returned as component <code>Hessian</code>.
</p>
</td>
</tr>
<tr>
<td><code id="trace">trace</code></td>
<td>

<p>switch for tracing optimization. Default <code>TRUE</code>.
</p>
</td>
</tr>
<tr>
<td><code id="MaxNWts">MaxNWts</code></td>
<td>

<p>The maximum allowable number of weights.  There is no intrinsic limit
in the code, but increasing <code>MaxNWts</code> will probably allow fits that
are very slow and time-consuming.
</p>
</td>
</tr>
<tr>
<td><code id="abstol">abstol</code></td>
<td>

<p>Stop if the fit criterion falls below <code>abstol</code>, indicating an
essentially perfect fit.
</p>
</td>
</tr>
<tr>
<td><code id="reltol">reltol</code></td>
<td>

<p>Stop if the optimizer is unable to reduce the fit criterion by a
factor of at least <code>1 - reltol</code>.
</p>
</td>
</tr>
<tr>
<td><code id="...">...</code></td>
<td>

<p>arguments passed to or from other methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the response in <code>formula</code> is a factor, an appropriate classification
network is constructed; this has one output and entropy fit if the
number of levels is two, and a number of outputs equal to the number
of classes and a softmax output stage for more levels.  If the
response is not a factor, it is passed on unchanged to <code>nnet.default</code>.
</p>
<p>Optimization is done via the BFGS method of <code><a href="https://r-universe.dev/manuals/stats.html#optim">optim</a></code>.
</p>


<h3>Value</h3>

<p>object of class <code>"nnet"</code> or <code>"nnet.formula"</code>.
Mostly internal structure, but has components
</p>
<table>
<tr>
<td><code>wts</code></td>
<td>

<p>the best set of weights found
</p>
</td>
</tr>
<tr>
<td><code>value</code></td>
<td>

<p>value of fitting criterion plus weight decay term.
</p>
</td>
</tr>
<tr>
<td><code>fitted.values</code></td>
<td>

<p>the fitted values for the training data.
</p>
</td>
</tr>
<tr>
<td><code>residuals</code></td>
<td>

<p>the residuals for the training data.
</p>
</td>
</tr>
<tr>
<td><code>convergence</code></td>
<td>

<p><code>1</code> if the maximum number of iterations was reached, otherwise <code>0</code>.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ripley, B. D. (1996)
<em>Pattern Recognition and Neural Networks.</em> Cambridge.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002)
<em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#predict.nnet">predict.nnet</a></code>, <code><a href="#nnet.Hess">nnetHess</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># use half the iris data</span>
ir <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
targets <span class="token operator">&lt;-</span> class.ind<span class="token punctuation">(</span> c<span class="token punctuation">(</span>rep<span class="token punctuation">(</span><span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
samp <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sample<span class="token punctuation">(</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sample<span class="token punctuation">(</span><span class="token number">101</span><span class="token operator">:</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ir1 <span class="token operator">&lt;-</span> nnet<span class="token punctuation">(</span>ir<span class="token punctuation">[</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> targets<span class="token punctuation">[</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> rang <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
            decay <span class="token operator">=</span> <span class="token number">5e-4</span><span class="token punctuation">,</span> maxit <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span>
test.cl <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>true<span class="token punctuation">,</span> pred<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    true <span class="token operator">&lt;-</span> max.col<span class="token punctuation">(</span>true<span class="token punctuation">)</span>
    cres <span class="token operator">&lt;-</span> max.col<span class="token punctuation">(</span>pred<span class="token punctuation">)</span>
    table<span class="token punctuation">(</span>true<span class="token punctuation">,</span> cres<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
test.cl<span class="token punctuation">(</span>targets<span class="token punctuation">[</span><span class="token operator">-</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> predict<span class="token punctuation">(</span>ir1<span class="token punctuation">,</span> ir<span class="token punctuation">[</span><span class="token operator">-</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># or</span>
ird <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>rbind<span class="token punctuation">(</span>iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        species <span class="token operator">=</span> factor<span class="token punctuation">(</span>c<span class="token punctuation">(</span>rep<span class="token punctuation">(</span><span class="token string">"s"</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ir.nn2 <span class="token operator">&lt;-</span> nnet<span class="token punctuation">(</span>species <span class="token operator">~</span> .<span class="token punctuation">,</span> data <span class="token operator">=</span> ird<span class="token punctuation">,</span> subset <span class="token operator">=</span> samp<span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> rang <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
               decay <span class="token operator">=</span> <span class="token number">5e-4</span><span class="token punctuation">,</span> maxit <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span>
table<span class="token punctuation">(</span>ird<span class="token operator">$</span>species<span class="token punctuation">[</span><span class="token operator">-</span>samp<span class="token punctuation">]</span><span class="token punctuation">,</span> predict<span class="token punctuation">(</span>ir.nn2<span class="token punctuation">,</span> ird<span class="token punctuation">[</span><span class="token operator">-</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"class"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr></main></div>
<div class="container manual-page" id="nnet.Hess"><main><a href="#nnet.Hess" class="help-page-title"><h2>
Evaluates Hessian for a Neural Network
</h2></a>

<h3>Description</h3>

<p>Evaluates the Hessian (matrix of second derivatives) of the specified
neural network. Normally called via argument <code>Hess=TRUE</code> to <code>nnet</code> or via
<code>vcov.multinom</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">nnetHess<span class="token punctuation">(</span>net<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> weights<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="net">net</code></td>
<td>

<p>object of class <code>nnet</code> as returned by <code>nnet</code>.
</p>
</td>
</tr>
<tr>
<td><code id="x">x</code></td>
<td>

<p>training data.
</p>
</td>
</tr>
<tr>
<td><code id="y">y</code></td>
<td>

<p>classes for training data.
</p>
</td>
</tr>
<tr>
<td><code id="weights">weights</code></td>
<td>

<p>the (case) weights used in the <code>nnet</code> fit.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>square symmetric matrix of the Hessian evaluated at the weights stored
in the net.
</p>


<h3>References</h3>

<p>Ripley, B. D. (1996)
<em>Pattern Recognition and Neural Networks.</em> Cambridge.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002)
<em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#nnet">nnet</a></code>, <code><a href="#predict.nnet">predict.nnet</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># use half the iris data</span>
ir <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
targets <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span>rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> byrow<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
samp <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sample<span class="token punctuation">(</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sample<span class="token punctuation">(</span><span class="token number">101</span><span class="token operator">:</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ir1 <span class="token operator">&lt;-</span> nnet<span class="token punctuation">(</span>ir<span class="token punctuation">[</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> targets<span class="token punctuation">[</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> rang<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> decay<span class="token operator">=</span><span class="token number">5e-4</span><span class="token punctuation">,</span> maxit<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
eigen<span class="token punctuation">(</span>nnetHess<span class="token punctuation">(</span>ir1<span class="token punctuation">,</span> ir<span class="token punctuation">[</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> targets<span class="token punctuation">[</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>values</code></pre>

<hr></main></div>
<div class="container manual-page" id="predict.nnet"><main><a href="#predict.nnet" class="help-page-title"><h2>
Predict New Examples by a Trained Neural Net
</h2></a>

<h3>Description</h3>

<p>Predict new examples by a trained neural net.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'nnet'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> newdata<span class="token punctuation">,</span> type <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"raw"</span><span class="token punctuation">,</span><span class="token string">"class"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="object">object</code></td>
<td>

<p>an object of class <code>nnet</code> as  returned by <code>nnet</code>.
</p>
</td>
</tr>
<tr>
<td><code id="newdata">newdata</code></td>
<td>

<p>matrix or data frame of test examples. A vector is considered to be
a row vector comprising a single case.
</p>
</td>
</tr>
<tr>
<td><code id="type">type</code></td>
<td>

<p>Type of output
</p>
</td>
</tr>
<tr>
<td><code id="...">...</code></td>
<td>

<p>arguments passed to or from other methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a method for the generic function
<code>predict()</code> for class <code>"nnet"</code>.
It can be invoked by calling <code>predict(x)</code> for an
object <code>x</code> of the appropriate class, or directly by
calling <code>predict.nnet(x)</code> regardless of the
class of the object.
</p>


<h3>Value</h3>

<p>If <code>type = "raw"</code>, the matrix of values returned by the trained network;
if <code>type = "class"</code>, the corresponding class (which is probably only
useful if the net was generated by <code>nnet.formula</code>).
</p>


<h3>References</h3>

<p>Ripley, B. D. (1996)
<em>Pattern Recognition and Neural Networks.</em> Cambridge.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002)
<em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#nnet">nnet</a></code>, <code><a href="#which.is.max">which.is.max</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># use half the iris data</span>
ir <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
targets <span class="token operator">&lt;-</span> class.ind<span class="token punctuation">(</span> c<span class="token punctuation">(</span>rep<span class="token punctuation">(</span><span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
samp <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sample<span class="token punctuation">(</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sample<span class="token punctuation">(</span><span class="token number">101</span><span class="token operator">:</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ir1 <span class="token operator">&lt;-</span> nnet<span class="token punctuation">(</span>ir<span class="token punctuation">[</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> targets<span class="token punctuation">[</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> rang <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
            decay <span class="token operator">=</span> <span class="token number">5e-4</span><span class="token punctuation">,</span> maxit <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span>
test.cl <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>true<span class="token punctuation">,</span> pred<span class="token punctuation">)</span><span class="token punctuation">{</span>
        true <span class="token operator">&lt;-</span> max.col<span class="token punctuation">(</span>true<span class="token punctuation">)</span>
        cres <span class="token operator">&lt;-</span> max.col<span class="token punctuation">(</span>pred<span class="token punctuation">)</span>
        table<span class="token punctuation">(</span>true<span class="token punctuation">,</span> cres<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
test.cl<span class="token punctuation">(</span>targets<span class="token punctuation">[</span><span class="token operator">-</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> predict<span class="token punctuation">(</span>ir1<span class="token punctuation">,</span> ir<span class="token punctuation">[</span><span class="token operator">-</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># or</span>
ird <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>rbind<span class="token punctuation">(</span>iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris3<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        species <span class="token operator">=</span> factor<span class="token punctuation">(</span>c<span class="token punctuation">(</span>rep<span class="token punctuation">(</span><span class="token string">"s"</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ir.nn2 <span class="token operator">&lt;-</span> nnet<span class="token punctuation">(</span>species <span class="token operator">~</span> .<span class="token punctuation">,</span> data <span class="token operator">=</span> ird<span class="token punctuation">,</span> subset <span class="token operator">=</span> samp<span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> rang <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
               decay <span class="token operator">=</span> <span class="token number">5e-4</span><span class="token punctuation">,</span> maxit <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span>
table<span class="token punctuation">(</span>ird<span class="token operator">$</span>species<span class="token punctuation">[</span><span class="token operator">-</span>samp<span class="token punctuation">]</span><span class="token punctuation">,</span> predict<span class="token punctuation">(</span>ir.nn2<span class="token punctuation">,</span> ird<span class="token punctuation">[</span><span class="token operator">-</span>samp<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"class"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr></main></div>
<div class="container manual-page" id="which.is.max"><main><a href="#which.is.max" class="help-page-title"><h2>
Find Maximum Position in Vector
</h2></a>

<h3>Description</h3>

<p>Find the maximum position in a vector, breaking ties at random.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">which.is.max<span class="token punctuation">(</span>x<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="x">x</code></td>
<td>

<p>a vector
</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Ties are broken at random.
</p>


<h3>Value</h3>

<p>index of a maximal value.
</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (2002)
<em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#maxCol">max.col</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#which.min">which.max</a></code> which takes the first of ties.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Not run: ## this is incomplete</span>
pred <span class="token operator">&lt;-</span> predict<span class="token punctuation">(</span>nnet<span class="token punctuation">,</span> test<span class="token punctuation">)</span>
table<span class="token punctuation">(</span>true<span class="token punctuation">,</span> apply<span class="token punctuation">(</span>pred<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> which.is.max<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## End(Not run)</span></code></pre>

<hr></main></div>
</div>
    <footer><p>Rendered with postdoc 1.2.2</p></footer>
  </body>
</html>
