<!DOCTYPE html>
<html>
  <head>
    <title>Package 'Matrix' reference manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <!-- styling for math and syntax -->
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/katex.min.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/R.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/prism.css">

    <!-- for (future) customizations -->
    <script src="https://r-universe.dev/static/manual.js"></script>
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/manual.css?nocache=1">

  </head>

  <body class="macintosh">
    <h1 class="manual-title">Package 'Matrix'</h1>
    <table class="description-table">
      <tr>
<th>Title:</th>
<td class="description-title">Sparse and Dense Matrix Classes and Methods</td>
</tr>
      <tr>
<th>Description:</th>
<td class="description-description">A rich hierarchy of sparse and dense matrix classes,
	including general, symmetric, triangular, and diagonal matrices
	with numeric, logical, or pattern entries.  Efficient methods for
	operating on such matrices, often wrapping the 'BLAS', 'LAPACK',
	and 'SuiteSparse' libraries.</td>
</tr>
      <tr>
<th>Authors:</th>
<td class="description-author"><span>Douglas Bates [aut] <a href="https://orcid.org/0000-0001-8316-9503" target="_blank"><img style="height:1em" src="https://cran.r-project.org/web/orcid.svg"></a>,
  Martin Maechler [aut, cre] <a href="https://orcid.org/0000-0002-8685-9910" target="_blank"><img style="height:1em" src="https://cran.r-project.org/web/orcid.svg"></a>,
  Mikael Jagan [aut] <a href="https://orcid.org/0000-0002-3542-2938" target="_blank"><img style="height:1em" src="https://cran.r-project.org/web/orcid.svg"></a>,
  Timothy A. Davis [ctb] (&lt;https://orcid.org/0000-0001-7614-6899&gt;,
    SuiteSparse libraries, notably CHOLMOD and AMD, collaborators
    listed in dir(pattern="^[A-Z]+[.]txt$", full.names=TRUE,
    system.file("doc", "SuiteSparse", package="Matrix"))),
  Jens Oehlschlägel [ctb] (initial nearPD()),
  Jason Riedy [ctb] (&lt;https://orcid.org/0000-0002-4345-4200&gt;, GNU
    Octave's condest() and onenormest(), Copyright: Regents of the
    University of California),
  R Core Team [ctb] (base R's matrix implementation)</span></td>
</tr>
      <tr>
<th>Maintainer:</th>
<td class="description-maintainer">Martin Maechler &lt;mmaechler+Matrix@gmail.com&gt;</td>
</tr>
      <tr>
<th>License:</th>
<td class="description-license">GPL (&gt;= 2) | file LICENCE</td>
</tr>
      <tr>
<th>Version:</th>
<td class="description-version">1.6-1.1</td>
</tr>
      <tr>
<th>Built:</th>
<td class="description-date">2023-11-01 20:53:46 UTC</td>
</tr>
      <tr>
<th>Source:</th>
<td class="description-source">CRAN</td>
</tr>
    </table>

    <a href="#help-index" style="color:black;"><h2 id="help-index">Help Index</h2></a>
    <ul id="help-index-list">
<li class="help-index-item"><a href="#abIndex-class">Class "abIndex" of Abstract Index Vectors</a></li>
<li class="help-index-item"><a href="#abIseq">Sequence Generation of "abIndex", Abstract Index Vectors</a></li>
<li class="help-index-item"><a href="#all-methods">"Matrix" Methods for Functions all() and any()</a></li>
<li class="help-index-item"><a href="#all.equal-methods">Matrix Package Methods for Function all.equal()</a></li>
<li class="help-index-item"><a href="#atomicVector-class">Virtual Class "atomicVector" of Atomic Vectors</a></li>
<li class="help-index-item"><a href="#band">Extract bands of a matrix</a></li>
<li class="help-index-item"><a href="#bandSparse">Construct Sparse Banded Matrix from (Sup-/Super-) Diagonals</a></li>
<li class="help-index-item"><a href="#bdiag">Construct a Block Diagonal Matrix</a></li>
<li class="help-index-item"><a href="#boolean-matprod">Boolean Arithmetic Matrix Products: %&amp;% and Methods</a></li>
<li class="help-index-item"><a href="#BunchKaufman-class">Dense Bunch-Kaufman Factorizations</a></li>
<li class="help-index-item"><a href="#BunchKaufman-methods">Methods for Bunch-Kaufman Factorization</a></li>
<li class="help-index-item"><a href="#CAex">Albers' example Matrix with "Difficult" Eigen Factorization</a></li>
<li class="help-index-item"><a href="#cBind">'cbind()' and 'rbind()' recursively built on cbind2/rbind2</a></li>
<li class="help-index-item"><a href="#CHMfactor-class">Sparse Cholesky Factorizations</a></li>
<li class="help-index-item"><a href="#chol">Compute the Cholesky Factor of a Matrix</a></li>
<li class="help-index-item"><a href="#chol2inv-methods">Inverse from Cholesky Factor</a></li>
<li class="help-index-item"><a href="#Cholesky-class">Dense Cholesky Factorizations</a></li>
<li class="help-index-item"><a href="#Cholesky">Methods for Cholesky Factorization</a></li>
<li class="help-index-item"><a href="#graph2T">Conversions "graph" &lt;–&gt; (sparse) Matrix</a></li>
<li class="help-index-item"><a href="#SparseM-conv">Sparse Matrix Coercion from and to those from package SparseM</a></li>
<li class="help-index-item"><a href="#colSums">Form Row and Column Sums and Means</a></li>
<li class="help-index-item"><a href="#compMatrix-class">Class "compMatrix" of Composite (Factorizable) Matrices</a></li>
<li class="help-index-item"><a href="#condest">Compute Approximate CONDition number and 1-Norm of (Large) Matrices</a></li>
<li class="help-index-item"><a href="#CsparseMatrix-class">Class "CsparseMatrix" of Sparse Matrices in Column-compressed Form</a></li>
<li class="help-index-item"><a href="#ddenseMatrix-class">Virtual Class "ddenseMatrix" of Numeric Dense Matrices</a></li>
<li class="help-index-item"><a href="#ddiMatrix-class">Class "ddiMatrix" of Diagonal Numeric Matrices</a></li>
<li class="help-index-item"><a href="#LU-class">Dense LU Factorizations</a></li>
<li class="help-index-item"><a href="#denseMatrix-class">Virtual Class "denseMatrix" of All Dense Matrices</a></li>
<li class="help-index-item"><a href="#dgCMatrix-class">Compressed, sparse, column-oriented numeric matrices</a></li>
<li class="help-index-item"><a href="#dgeMatrix-class">Class "dgeMatrix" of Dense Numeric (S4 Class) Matrices</a></li>
<li class="help-index-item"><a href="#dgRMatrix-class">Sparse Compressed, Row-oriented Numeric Matrices</a></li>
<li class="help-index-item"><a href="#dgTMatrix-class">Sparse matrices in triplet form</a></li>
<li class="help-index-item"><a href="#Diagonal">Construct a Diagonal Matrix</a></li>
<li class="help-index-item"><a href="#diagonalMatrix-class">Class "diagonalMatrix" of Diagonal Matrices</a></li>
<li class="help-index-item"><a href="#diagU2N">Transform Triangular Matrices from Unit Triangular to General Triangular and Back</a></li>
<li class="help-index-item"><a href="#dimScale">Scale the Rows and Columns of a Matrix</a></li>
<li class="help-index-item"><a href="#dMatrix-class">(Virtual) Class "dMatrix" of "double" Matrices</a></li>
<li class="help-index-item"><a href="#dmperm">Dulmage-Mendelsohn Permutation / Decomposition</a></li>
<li class="help-index-item"><a href="#dpoMatrix-class">Positive Semi-definite Dense (Packed | Non-packed) Numeric Matrices</a></li>
<li class="help-index-item"><a href="#drop0">Drop Non-Structural Zeros from a Sparse Matrix</a></li>
<li class="help-index-item"><a href="#dsCMatrix-class">Numeric Symmetric Sparse (column compressed) Matrices</a></li>
<li class="help-index-item"><a href="#dsparseMatrix-class">Virtual Class "dsparseMatrix" of Numeric Sparse Matrices</a></li>
<li class="help-index-item"><a href="#dsRMatrix-class">Symmetric Sparse Compressed Row Matrices</a></li>
<li class="help-index-item"><a href="#dsyMatrix-class">Symmetric Dense (Packed or Unpacked) Numeric Matrices</a></li>
<li class="help-index-item"><a href="#dtCMatrix-class">Triangular, (compressed) sparse column matrices</a></li>
<li class="help-index-item"><a href="#dtpMatrix-class">Packed Triangular Dense Matrices - "dtpMatrix"</a></li>
<li class="help-index-item"><a href="#dtrMatrix-class">Triangular, dense, numeric matrices</a></li>
<li class="help-index-item"><a href="#dtRMatrix-class-def">Triangular Sparse Compressed Row Matrices</a></li>
<li class="help-index-item"><a href="#expand">Expand Matrix Factorizations</a></li>
<li class="help-index-item"><a href="#expm">Matrix Exponential</a></li>
<li class="help-index-item"><a href="#externalFormats">Read and write external matrix formats</a></li>
<li class="help-index-item"><a href="#facmul">Multiplication by Factors from Matrix Factorizations</a></li>
<li class="help-index-item"><a href="#fastMisc">“Low Level” Coercions and Methods</a></li>
<li class="help-index-item"><a href="#forceSymmetric">Force a Matrix to 'symmetricMatrix' Without Symmetry Checks</a></li>
<li class="help-index-item"><a href="#formatSparseM">Formatting Sparse Numeric Matrices Utilities</a></li>
<li class="help-index-item"><a href="#generalMatrix-class">Class "generalMatrix" of General Matrices</a></li>
<li class="help-index-item"><a href="#Hilbert">Generate a Hilbert matrix</a></li>
<li class="help-index-item"><a href="#image-methods">Methods for image() in Package 'Matrix'</a></li>
<li class="help-index-item"><a href="#index-class">Virtual Class "index" - Simple Class for Matrix Indices</a></li>
<li class="help-index-item"><a href="#indMatrix-class">Index Matrices</a></li>
<li class="help-index-item"><a href="#invPerm">Utilities for Permutation Vectors</a></li>
<li class="help-index-item"><a href="#is.na-methods">is.na(), is.finite() Methods for 'Matrix' Objects</a></li>
<li class="help-index-item"><a href="#is.null.DN">Are the Dimnames dn NULL-like ?</a></li>
<li class="help-index-item"><a href="#isSymmetric-methods">Methods for Function 'isSymmetric' in Package 'Matrix'</a></li>
<li class="help-index-item"><a href="#isTriangular">Test whether a Matrix is Triangular or Diagonal</a></li>
<li class="help-index-item"><a href="#KhatriRao">Khatri-Rao Matrix Product</a></li>
<li class="help-index-item"><a href="#KNex">Koenker-Ng Example Sparse Model Matrix and Response Vector</a></li>
<li class="help-index-item"><a href="#kronecker-methods">Methods for Function 'kronecker()' in Package 'Matrix'</a></li>
<li class="help-index-item"><a href="#ldenseMatrix-class">Virtual Class "ldenseMatrix" of Dense Logical Matrices</a></li>
<li class="help-index-item"><a href="#ldiMatrix-class">Class "ldiMatrix" of Diagonal Logical Matrices</a></li>
<li class="help-index-item"><a href="#lgeMatrix-class">Class "lgeMatrix" of General Dense Logical Matrices</a></li>
<li class="help-index-item"><a href="#lsparseMatrix-classes">Sparse logical matrices</a></li>
<li class="help-index-item"><a href="#lsyMatrix-class">Symmetric Dense Logical Matrices</a></li>
<li class="help-index-item"><a href="#ltrMatrix-class">Triangular Dense Logical Matrices</a></li>
<li class="help-index-item"><a href="#lu">Methods for LU Factorization</a></li>
<li class="help-index-item"><a href="#mat2triplet">Map Matrix to its Triplet Representation</a></li>
<li class="help-index-item"><a href="#matrix-products">Matrix (Cross) Products (of Transpose)</a></li>
<li class="help-index-item"><a href="#Matrix">Construct a Classed Matrix</a></li>
<li class="help-index-item"><a href="#Matrix-class">Virtual Class "Matrix" of Matrices</a></li>
<li class="help-index-item"><a href="#unused-classes">Virtual Classes Not Yet Really Implemented and Used</a></li>
<li class="help-index-item"><a href="#MatrixClass">The Matrix (Super-) Class of a Class</a></li>
<li class="help-index-item"><a href="#MatrixFactorization-class">Virtual Class "MatrixFactorization" of Matrix Factorizations</a></li>
<li class="help-index-item"><a href="#ndenseMatrix-class">Virtual Class "ndenseMatrix" of Dense Logical Matrices</a></li>
<li class="help-index-item"><a href="#nearPD">Nearest Positive Definite Matrix</a></li>
<li class="help-index-item"><a href="#ngeMatrix-class">Class "ngeMatrix" of General Dense Nonzero-pattern Matrices</a></li>
<li class="help-index-item"><a href="#nMatrix-class">Class "nMatrix" of Non-zero Pattern Matrices</a></li>
<li class="help-index-item"><a href="#nnzero">The Number of Non-Zero Values of a Matrix</a></li>
<li class="help-index-item"><a href="#norm">Matrix Norms</a></li>
<li class="help-index-item"><a href="#nsparseMatrix-classes">Sparse "pattern" Matrices</a></li>
<li class="help-index-item"><a href="#nsyMatrix-class">Symmetric Dense Nonzero-Pattern Matrices</a></li>
<li class="help-index-item"><a href="#ntrMatrix-class">Triangular Dense Logical Matrices</a></li>
<li class="help-index-item"><a href="#number-class">Class "number" of Possibly Complex Numbers</a></li>
<li class="help-index-item"><a href="#unpack">Representation of Packed and Unpacked Dense Matrices</a></li>
<li class="help-index-item"><a href="#packedMatrix-class">Virtual Class "packedMatrix" of Packed Dense Matrices</a></li>
<li class="help-index-item"><a href="#pMatrix-class">Permutation matrices</a></li>
<li class="help-index-item"><a href="#printSpMatrix">Format and Print Sparse Matrices Flexibly</a></li>
<li class="help-index-item"><a href="#qr-methods">Methods for QR Factorization</a></li>
<li class="help-index-item"><a href="#rankMatrix">Rank of a Matrix</a></li>
<li class="help-index-item"><a href="#rcond">Estimate the Reciprocal Condition Number</a></li>
<li class="help-index-item"><a href="#rep2abI">Replicate Vectors into 'abIndex' Result</a></li>
<li class="help-index-item"><a href="#replValue-class">Virtual Class "replValue" - Simple Class for Subassignment Values</a></li>
<li class="help-index-item"><a href="#rleDiff-class">Class "rleDiff" of  rle(diff(.))  Stored Vectors</a></li>
<li class="help-index-item"><a href="#rsparsematrix">Random Sparse Matrix</a></li>
<li class="help-index-item"><a href="#RsparseMatrix-class">Class "RsparseMatrix" of Sparse Matrices in Row-compressed Form</a></li>
<li class="help-index-item"><a href="#Schur-class">Schur Factorizations</a></li>
<li class="help-index-item"><a href="#Schur">Methods for Schur Factorization</a></li>
<li class="help-index-item"><a href="#solve-methods">Methods in Package Matrix for Function solve</a></li>
<li class="help-index-item"><a href="#sparse.model.matrix">Construct Sparse Design / Model Matrices</a></li>
<li class="help-index-item"><a href="#sparseLU-class">Sparse LU Factorizations</a></li>
<li class="help-index-item"><a href="#sparseMatrix">General Sparse Matrix Construction from Nonzero Entries</a></li>
<li class="help-index-item"><a href="#sparseMatrix-class">Virtual Class "sparseMatrix" — Mother of Sparse Matrices</a></li>
<li class="help-index-item"><a href="#sparseQR-class">Sparse QR Factorizations</a></li>
<li class="help-index-item"><a href="#sparseVector">Sparse Vector Construction from Nonzero Entries</a></li>
<li class="help-index-item"><a href="#sparseVector-class">Sparse Vector Classes</a></li>
<li class="help-index-item"><a href="#spMatrix">Sparse Matrix Constructor From Triplet</a></li>
<li class="help-index-item"><a href="#Subassign-methods">Methods for "[&lt;-" - Assigning to Subsets for 'Matrix'</a></li>
<li class="help-index-item"><a href="#Xtrct-methods">Methods for "[": Extraction or Subsetting in Package 'Matrix'</a></li>
<li class="help-index-item"><a href="#symmetricMatrix-class">Virtual Class of Symmetric Matrices in Package Matrix</a></li>
<li class="help-index-item"><a href="#symmpart">Symmetric Part and Skew(symmetric) Part of a Matrix</a></li>
<li class="help-index-item"><a href="#triangularMatrix-class">Virtual Class of Triangular Matrices in Package Matrix</a></li>
<li class="help-index-item"><a href="#TsparseMatrix-class">Class "TsparseMatrix" of Sparse Matrices in Triplet Form</a></li>
<li class="help-index-item"><a href="#uniqTsparse">Unique (Sorted) TsparseMatrix Representations</a></li>
<li class="help-index-item"><a href="#unpackedMatrix-class">Virtual Class "unpackedMatrix" of Unpacked Dense Matrices</a></li>
<li class="help-index-item"><a href="#updown">Updating and Downdating Sparse Cholesky Factorizations</a></li>
<li class="help-index-item"><a href="#USCounties">Contiguity Matrix of U.S. Counties</a></li>
<li class="help-index-item"><a href="#wrld_1deg">Contiguity Matrix of World One-Degree Grid Cells</a></li>
</ul>

    <hr>
    <div class="manual-pages-content">
<div class="container manual-page" id="abIndex-class">

<a href="#abIndex-class" class="help-page-title"><h2 id="abIndex-class">Class "abIndex" of Abstract Index Vectors</h2></a>

<h3>Description</h3>

<p>The <code>"abIndex"</code> <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code>, short for “Abstract
Index Vector”, is used for dealing with large index vectors more
efficiently, than using integer (or <code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code>) vectors of
the kind <code>2:1000000</code> or <code>c(0:1e5, 1000:1e6)</code>.
</p>
<p>Note that the current implementation details are subject to change,
and if you consider working with these classes, please contact the
package maintainers (<code>packageDescription("Matrix")$Maintainer</code>).
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("abIndex", ...)</code>,
but more easily and typically either by <code>as(x, "abIndex")</code> where
<code>x</code> is an integer (valued) vector, or directly by
<code><a href="#abIseq">abIseq</a>()</code> and combination <code><a href="https://r-universe.dev/manuals/base.html#c">c</a>(...)</code> of such.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>kind</code>:</dt>
<dd>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> string,
one of <code>("int32", "double", "rleDiff")</code>, denoting the
internal structure of the abIndex object.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numLike"</code>; is
used (i.e., not of length <code>0</code>) only iff the object is <em>not</em>
compressed, i.e., currently exactly when <code>kind != "rleDiff"</code>.</p>
</dd>
<dt>
<code>rleD</code>:</dt>
<dd>
<p>object of class <code>"<a href="#rleDiff-class">rleDiff</a>"</code>,
used for compression via <code><a href="https://r-universe.dev/manuals/base.html#rle">rle</a></code>.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>as.numeric, as.integer, as.vector</dt>
<dd>
<p><code>signature(x = "abIndex")</code>: ... </p>
</dd>
<dt>[</dt>
<dd>
<p><code>signature(x = "abIndex", i = "index", j = "ANY", drop = "ANY")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "numeric", to = "abIndex")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "abIndex", to = "numeric")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "abIndex", to = "integer")</code>: ... </p>
</dd>
<dt>length</dt>
<dd>
<p><code>signature(x = "abIndex")</code>: ... </p>
</dd>
<dt>Ops</dt>
<dd>
<p><code>signature(e1 = "numeric", e2 = "abIndex")</code>: These
and the following arithmetic and logic operations are
<b>not yet implemented</b>; see <code><a href="https://r-universe.dev/manuals/methods.html#Ops">Ops</a></code> for a
list of these (S4) group methods.</p>
</dd>
<dt>Ops</dt>
<dd>
<p><code>signature(e1 = "abIndex", e2 = "abIndex")</code>: ... </p>
</dd>
<dt>Ops</dt>
<dd>
<p><code>signature(e1 = "abIndex", e2 = "numeric")</code>: ... </p>
</dd>
<dt>Summary</dt>
<dd>
<p><code>signature(x = "abIndex")</code>: ... </p>
</dd>
<dt>show</dt>
<dd>
<p><code>("abIndex")</code>: simple <code><a href="https://r-universe.dev/manuals/methods.html#show">show</a></code> method,
building on <code>show(&lt;rleDiff&gt;)</code>.</p>
</dd>
<dt>is.na</dt>
<dd>
<p><code>("abIndex")</code>: works analogously to regular vectors.</p>
</dd>
<dt>is.finite, is.infinite</dt>
<dd>
<p><code>("abIndex")</code>: ditto.</p>
</dd>
</dl>
<h3>Note</h3>

<p>This is currently experimental and not yet used for our own code.
Please contact us (<code>packageDescription("Matrix")$Maintainer</code>),
if you plan to make use of this class.
</p>
<p>Partly builds on ideas and code from Jens Oehlschlaegel,
as implemented (around 2008, in the GPL'ed part of) package <span class="pkg">ff</span>.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#rle">rle</a></code> (<span class="pkg">base</span>) which is used here;
<code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"abIndex"</span><span class="token punctuation">)</span>
ii <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">70</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>ai <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>ii<span class="token punctuation">,</span> <span class="token string">"abIndex"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># note</span>
ai <span class="token comment"># -&gt; show() method</span>


stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span>
                    as<span class="token punctuation">(</span>abIseq1<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"vector"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="abIseq">

<a href="#abIseq" class="help-page-title"><h2 id="abIseq">Sequence Generation of "abIndex", Abstract Index Vectors</h2></a>

<h3>Description</h3>

<p>Generation of abstract index vectors, i.e., objects of class
<code>"<a href="#abIndex-class">abIndex</a>"</code>.
</p>
<p><code>abIseq()</code> is designed to work entirely like <code><a href="https://r-universe.dev/manuals/base.html#seq">seq</a></code>,
but producing <code>"abIndex"</code> vectors.<br><code>abIseq1()</code> is its basic building block, where
<code>abIseq1(n,m)</code> corresponds to <code>n:m</code>.
</p>
<p><code>c(x, ...)</code> will return an <code>"abIndex"</code> vector, when <code>x</code>
is one.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">abIseq1<span class="token punctuation">(</span>from <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> to <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
abIseq <span class="token punctuation">(</span>from <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> to <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>to <span class="token operator">-</span> from<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>length.out <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        length.out <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> along.with <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'abIndex'</span>
c<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td>
<code id="abIseq_:_from">from</code>, <code id="abIseq_:_to">to</code>
</td>
<td>
<p>the starting and (maximal) end value of the sequence.</p>
</td>
</tr>
<tr>
<td><code id="abIseq_:_by">by</code></td>
<td>
<p>number: increment of the sequence.</p>
</td>
</tr>
<tr>
<td><code id="abIseq_:_length.out">length.out</code></td>
<td>
<p>desired length of the sequence.  A
non-negative number, which for <code>seq</code> and <code>seq.int</code> will be
rounded up if fractional.</p>
</td>
</tr>
<tr>
<td><code id="abIseq_:_along.with">along.with</code></td>
<td>
<p>take the length from the length of this argument.</p>
</td>
</tr>
<tr>
<td><code id="abIseq_:_...">...</code></td>
<td>
<p>in general an arbitrary number of <span class="rlang"><b>R</b></span> objects; here,
when the first is an <code>"<a href="#abIndex-class">abIndex</a>"</code> vector, these
arguments will be concatenated to a new <code>"abIndex"</code> object.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An abstract index vector, i.e., object of class
<code>"<a href="#abIndex-class">abIndex</a>"</code>.
</p>


<h3>See Also</h3>

<p>the class <code><a href="#abIndex-class">abIndex</a></code> documentation;
<code><a href="#rep2abI">rep2abI</a>()</code> for another constructor;
<code><a href="https://r-universe.dev/manuals/base.html#rle">rle</a></code> (<span class="pkg">base</span>).
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span>
                    as<span class="token punctuation">(</span>abIseq1<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"vector"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

try<span class="token punctuation">(</span> <span class="token comment">## (arithmetic) not yet implemented</span>
abIseq<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="all-methods">

<a href="#all-methods" class="help-page-title"><h2 id="all-methods">"Matrix" Methods for Functions all() and any()</h2></a>

<h3>Description</h3>

<p>The basic <span class="rlang"><b>R</b></span> functions <code><a href="#all-methods">all</a></code> and <code><a href="#all-methods">any</a></code> now
have methods for <code><a href="#Matrix-class">Matrix</a></code> objects and should
behave as for <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code> ones.
</p>


<h3>Methods</h3>



<dl>
<dt>all</dt>
<dd>
<p><code>signature(x = "Matrix", ..., na.rm = FALSE)</code>: ...</p>
</dd>
<dt>any</dt>
<dd>
<p><code>signature(x = "Matrix", ..., na.rm = FALSE)</code>: ...</p>
</dd>
<dt>all</dt>
<dd>
<p><code>signature(x = "ldenseMatrix", ..., na.rm = FALSE)</code>: ...</p>
</dd>
<dt>all</dt>
<dd>
<p><code>signature(x = "lsparseMatrix", ..., na.rm = FALSE)</code>: ...</p>
</dd>
</dl>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r">M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">12</span> <span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
all<span class="token punctuation">(</span>M <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># TRUE</span>
any<span class="token punctuation">(</span>M <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token comment"># FALSE</span>
MN <span class="token operator">&lt;-</span> M<span class="token punctuation">;</span> MN<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token keyword">NA</span><span class="token punctuation">;</span> MN
all<span class="token punctuation">(</span>MN <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># NA</span>
any<span class="token punctuation">(</span>MN <span class="token operator">&lt;</span>  <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># NA</span>
any<span class="token punctuation">(</span>MN <span class="token operator">&lt;</span>  <span class="token number">0</span><span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; FALSE</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="all.equal-methods">

<a href="#all.equal-methods" class="help-page-title"><h2 id="all.equal-methods">Matrix Package Methods for Function all.equal()</h2></a>

<h3>Description</h3>

<p>Methods for function <code><a href="#all.equal-methods">all.equal</a>()</code> (from <span class="rlang"><b>R</b></span> package
<span class="pkg">base</span>) are defined for all <code><a href="#Matrix-class">Matrix</a></code> classes.
</p>


<h3>Methods</h3>


<dl>
<dt>target = "Matrix", current = "Matrix"</dt>
<dd>
<p>\ </p>
</dd>
<dt>target = "ANY", current = "Matrix"</dt>
<dd>
<p>\ </p>
</dd>
<dt>target = "Matrix", current = "ANY"</dt>
<dd>
<p>these three methods are
simply using <code><a href="https://r-universe.dev/manuals/base.html#all.equal">all.equal.numeric</a></code> directly and work via
<code><a href="https://r-universe.dev/manuals/base.html#vector">as.vector</a>()</code>.</p>
</dd>
</dl>
<p>There are more methods, notably also for
<code>"<a href="#sparseVector-class">sparseVector</a>"</code>'s, see <code>showMethods("all.equal")</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span><span class="token string">"all.equal"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> spMatrix<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> i<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ex <span class="token operator">&lt;-</span> expand<span class="token punctuation">(</span>lu. <span class="token operator">&lt;-</span> lu<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A<span class="token punctuation">[</span>lu.<span class="token operator">@</span>p <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">,</span> lu.<span class="token operator">@</span>q <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     lu.<span class="token operator">@</span>L <span class="token percent-operator operator">%*%</span> lu.<span class="token operator">@</span>U<span class="token punctuation">)</span><span class="token punctuation">,</span>
           with<span class="token punctuation">(</span>ex<span class="token punctuation">,</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>P <span class="token percent-operator operator">%*%</span> A <span class="token percent-operator operator">%*%</span> t<span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                              L <span class="token percent-operator operator">%*%</span> U<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           with<span class="token punctuation">(</span>ex<span class="token punctuation">,</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                              t<span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token percent-operator operator">%*%</span> L <span class="token percent-operator operator">%*%</span> U <span class="token percent-operator operator">%*%</span> Q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="atomicVector-class">

<a href="#atomicVector-class" class="help-page-title"><h2 id="atomicVector-class">Virtual Class "atomicVector" of Atomic Vectors</h2></a>

<h3>Description</h3>

<p>The <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> <code>"atomicVector"</code> is a
<em>virtual</em> class containing all atomic vector classes of base <span class="rlang"><b>R</b></span>,
as also implicitly defined via <code><a href="https://r-universe.dev/manuals/base.html#is.recursive">is.atomic</a></code>.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Methods</h3>

<p>In the <span class="pkg">Matrix</span> package, the "atomicVector" is used in signatures
where typically “old-style” "matrix" objects can be used and
can be substituted by simple vectors.
</p>


<h3>Extends</h3>


<p>The atomic classes
<code>"logical"</code>, <code>"integer"</code>, <code>"double"</code>, <code>"numeric"</code>,
<code>"complex"</code>, <code>"raw"</code> and <code>"character"</code> are extended
directly.  Note that <code>"numeric"</code> already contains <code>"integer"</code>
and <code>"double"</code>, but we want all of them to be direct subclasses of
<code>"atomicVector"</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#is.recursive">is.atomic</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#integer">integer</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#complex">complex</a></code>, etc.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"atomicVector"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="band">

<a href="#band" class="help-page-title"><h2 id="band-methods">Extract bands of a matrix</h2></a>

<h3>Description</h3>

<p>Return the matrix obtained by setting to zero elements below a diagonal
(<code>triu</code>), above a diagonal (<code>tril</code>), or outside of a general
band (<code>band</code>).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">band<span class="token punctuation">(</span>x<span class="token punctuation">,</span> k1<span class="token punctuation">,</span> k2<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
triu<span class="token punctuation">(</span>x<span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
tril<span class="token punctuation">(</span>x<span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="band-methods_:_x">x</code></td>
<td>
<p>a matrix-like object</p>
</td>
</tr>
<tr>
<td>
<code id="band-methods_:_k">k</code>, <code id="band-methods_:_k1">k1</code>, <code id="band-methods_:_k2">k2</code>
</td>
<td>
<p>integers specifying the diagonals that are not set to
zero.  These are interpreted relative to the main diagonal, which
is <code>k=0</code>.  Positive and negative values of <code>k</code> indicate
diagonals above and below the main diagonal, respectively.</p>
</td>
</tr>
<tr>
<td><code id="band-methods_:_...">...</code></td>
<td>
<p>optional arguments passed methods (currently unused
by package <span class="pkg">Matrix</span>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>triu(x, k)</code> is equivalent to <code>band(x, k, dim(x)[2])</code>.
Similarly,
<code>tril(x, k)</code> is equivalent to <code>band(x, -dim(x)[1], k)</code>.
</p>


<h3>Value</h3>

<p>An object of a suitable matrix class, inheriting from
<code><a href="#triangularMatrix-class">triangularMatrix</a></code> where appropriate.
It inherits from <code><a href="#sparseMatrix-class">sparseMatrix</a></code> if
and only if <code>x</code> does.
</p>


<h3>Methods</h3>


<dl>
<dt>x = "CsparseMatrix"</dt>
<dd>
<p>method for compressed, sparse,
column-oriented matrices.</p>
</dd>
<dt>x = "RsparseMatrix"</dt>
<dd>
<p>method for compressed, sparse,
row-oriented matrices.</p>
</dd>
<dt>x = "TsparseMatrix"</dt>
<dd>
<p>method for sparse matrices in
triplet format.</p>
</dd>
<dt>x = "diagonalMatrix"</dt>
<dd>
<p>method for diagonal matrices.</p>
</dd>
<dt>x = "denseMatrix"</dt>
<dd>
<p>method for dense matrices in
packed or unpacked format.</p>
</dd>
<dt>x = "matrix"</dt>
<dd>
<p>method for traditional matrices
of implicit class <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code><a href="#bandSparse">bandSparse</a></code> for the <em>construction</em> of a
banded sparse matrix directly from its non-zero diagonals.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## A random sparse matrix :</span>
set.seed<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
m <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
m<span class="token punctuation">[</span>sample<span class="token punctuation">(</span>length<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> length<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>mm <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

tril<span class="token punctuation">(</span>mm<span class="token punctuation">)</span>        <span class="token comment"># lower triangle</span>
tril<span class="token punctuation">(</span>mm<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment"># strict lower triangle</span>
triu<span class="token punctuation">(</span>mm<span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment"># strict upper triangle</span>
band<span class="token punctuation">(</span>mm<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># general band</span>
<span class="token punctuation">(</span>m5 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
tril<span class="token punctuation">(</span>m5<span class="token punctuation">)</span>        <span class="token comment"># lower triangle</span>
tril<span class="token punctuation">(</span>m5<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment"># strict lower triangle</span>
triu<span class="token punctuation">(</span>m5<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>     <span class="token comment"># strict upper triangle</span>
band<span class="token punctuation">(</span>m5<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># general band</span>
<span class="token punctuation">(</span>m65 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># not square</span>
triu<span class="token punctuation">(</span>m65<span class="token punctuation">)</span>       <span class="token comment"># result not "dtrMatrix" unless square</span>
<span class="token punctuation">(</span>sm5 <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>m65<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># symmetric</span>
   band<span class="token punctuation">(</span>sm5<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># "dsyMatrix": symmetric band preserves symmetry property</span>
as<span class="token punctuation">(</span>band<span class="token punctuation">(</span>sm5<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token comment"># often preferable</span>
<span class="token punctuation">(</span>sm <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>triu<span class="token punctuation">(</span>mm<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># sparse symmetric ("dsC*")</span>
band<span class="token punctuation">(</span>sm<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># remains "dsC", *however*</span>
band<span class="token punctuation">(</span>sm<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; "dgC"</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="bandSparse">

<a href="#bandSparse" class="help-page-title"><h2 id="bandSparse">Construct Sparse Banded Matrix from (Sup-/Super-) Diagonals</h2></a>

<h3>Description</h3>

<p>Construct a sparse banded matrix by specifying its non-zero sup- and
super-diagonals.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">bandSparse<span class="token punctuation">(</span>n<span class="token punctuation">,</span> m <span class="token operator">=</span> n<span class="token punctuation">,</span> k<span class="token punctuation">,</span> diagonals<span class="token punctuation">,</span> symmetric <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
           repr <span class="token operator">=</span> <span class="token string">"C"</span><span class="token punctuation">,</span> giveCsparse <span class="token operator">=</span> <span class="token punctuation">(</span>repr <span class="token operator">==</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td>
<code id="bandSparse_:_n">n</code>, <code id="bandSparse_:_m">m</code>
</td>
<td>
<p>the matrix dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>n</mi><mi>r</mi><mi>o</mi><mi>w</mi><mo separator="true">,</mo><mi>n</mi><mi>c</mi><mi>o</mi><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n,m) = (nrow, ncol)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">ro</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">co</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span></code>.</p>
</td>
</tr>
<tr>
<td><code id="bandSparse_:_k">k</code></td>
<td>
<p>integer vector of “diagonal numbers”, with identical
meaning as in <code><a href="#band">band</a>(*, k)</code>, i.e., relative to the main diagonal,
which is <code>k=0</code>.</p>
</td>
</tr>
<tr>
<td><code id="bandSparse_:_diagonals">diagonals</code></td>
<td>
<p>optional list of sub-/super- diagonals; if missing,
the result will be a patter<b>n</b> matrix, i.e., inheriting from
class <code><a href="#nMatrix-class">nMatrix</a></code>.
</p>
<p><code>diagonals</code> can also be <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>×</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">n' \times d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8352em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> matrix, where
<code>d &lt;- length(k)</code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>&gt;</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n' &gt;= min(n,m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.791em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></code>.  In that case,
the sub-/super- diagonals are taken from the columns of
<code>diagonals</code>, where only the first several rows will be used
(typically) for off-diagonals.
</p>
</td>
</tr>
<tr>
<td><code id="bandSparse_:_symmetric">symmetric</code></td>
<td>
<p>logical; if true the result will be symmetric
(inheriting from class <code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>) and
only the upper or lower triangle must be specified (via <code>k</code> and
<code>diagonals</code>).</p>
</td>
</tr>
<tr>
<td><code id="bandSparse_:_repr">repr</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> string, one of <code>"C"</code>,
<code>"T"</code>, or <code>"R"</code>, specifying the sparse <em>repr</em>esentation to
be used for the result, i.e., one from the super classes
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>, <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>, or
<code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="bandSparse_:_giveCsparse">giveCsparse</code></td>
<td>
<p>(<b>deprecated</b>, replaced with <code>repr</code>):
logical indicating if the result should be a
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> or a
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>, where the default was <code>TRUE</code>,
and now is determined from <code>repr</code>; very often Csparse matrices are
more efficient subsequently, but not always.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a sparse matrix (of <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code>
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>) of dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code>
with diagonal “bands” as specified.
</p>


<h3>See Also</h3>

<p><code><a href="#band">band</a></code>, for <em>extraction</em> of matrix bands;
<code><a href="#bdiag">bdiag</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#diag">diag</a></code>,
<code><a href="#sparseMatrix">sparseMatrix</a></code>,
<code><a href="#Matrix">Matrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">diags <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s1 <span class="token operator">&lt;-</span> bandSparse<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token operator">-</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag <span class="token operator">=</span> c<span class="token punctuation">(</span>diags<span class="token punctuation">,</span> diags<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> symm<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
s1
s2 <span class="token operator">&lt;-</span> bandSparse<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> k <span class="token operator">=</span>  c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag <span class="token operator">=</span> c<span class="token punctuation">(</span>diags<span class="token punctuation">,</span> diags<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> symm<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>s1<span class="token punctuation">,</span> t<span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> is<span class="token punctuation">(</span>s1<span class="token punctuation">,</span><span class="token string">"dsCMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## a pattern Matrix of *full* (sub-)diagonals:</span>
bk <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>s3 <span class="token operator">&lt;-</span> bandSparse<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> k <span class="token operator">=</span> bk<span class="token punctuation">,</span> symm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## If you want a pattern matrix, but with "sparse"-diagonals,</span>
<span class="token comment">## you currently need to go via logical sparse:</span>
lLis <span class="token operator">&lt;-</span> lapply<span class="token punctuation">(</span>list<span class="token punctuation">(</span>rpois<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rpois<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rpois<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               as.logical<span class="token punctuation">)</span>
<span class="token punctuation">(</span>s4 <span class="token operator">&lt;-</span> bandSparse<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> k <span class="token operator">=</span> bk<span class="token punctuation">,</span> symm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> diag <span class="token operator">=</span> lLis<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>s4. <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>drop0<span class="token punctuation">(</span>s4<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"nsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

n <span class="token operator">&lt;-</span> <span class="token number">1e4</span>
bk <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span>
bMat <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> byrow<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
bLis <span class="token operator">&lt;-</span> as.data.frame<span class="token punctuation">(</span>bMat<span class="token punctuation">)</span>
B  <span class="token operator">&lt;-</span> bandSparse<span class="token punctuation">(</span>n<span class="token punctuation">,</span> k <span class="token operator">=</span> bk<span class="token punctuation">,</span> diag <span class="token operator">=</span> bLis<span class="token punctuation">)</span>
Bs <span class="token operator">&lt;-</span> bandSparse<span class="token punctuation">(</span>n<span class="token punctuation">,</span> k <span class="token operator">=</span> bk<span class="token punctuation">,</span> diag <span class="token operator">=</span> bLis<span class="token punctuation">,</span> symmetric<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
B <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">30</span><span class="token punctuation">]</span>
Bs<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">30</span><span class="token punctuation">]</span>
<span class="token comment">## can use a list *or* a matrix for specifying the diagonals:</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>B<span class="token punctuation">,</span>  bandSparse<span class="token punctuation">(</span>n<span class="token punctuation">,</span> k <span class="token operator">=</span> bk<span class="token punctuation">,</span> diag <span class="token operator">=</span> bMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  identical<span class="token punctuation">(</span>Bs<span class="token punctuation">,</span> bandSparse<span class="token punctuation">(</span>n<span class="token punctuation">,</span> k <span class="token operator">=</span> bk<span class="token punctuation">,</span> diag <span class="token operator">=</span> bMat<span class="token punctuation">,</span> symmetric<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">,</span> inherits<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token string">"dtCMatrix"</span><span class="token punctuation">)</span> <span class="token comment"># triangular!</span>
<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="bdiag">

<a href="#bdiag" class="help-page-title"><h2 id="bdiag">Construct a Block Diagonal Matrix</h2></a>

<h3>Description</h3>

<p>Build a block diagonal matrix given several building block matrices.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">bdiag<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span>
.bdiag<span class="token punctuation">(</span>lst<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="bdiag_:_...">...</code></td>
<td>
<p>individual matrices or a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> of matrices.</p>
</td>
</tr>
<tr>
<td><code id="bdiag_:_lst">lst</code></td>
<td>
<p>non-empty <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> of matrices.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For non-trivial argument list, <code>bdiag()</code> calls <code>.bdiag()</code>.
The latter maybe useful to programmers.
</p>


<h3>Value</h3>

<p>A <em>sparse</em> matrix obtained by combining the arguments into a
block diagonal matrix.
</p>
<p>The value of <code>bdiag()</code> inherits from class
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>, whereas
<code>.bdiag()</code> returns a <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>.
</p>


<h3>Note</h3>

<p>This function has been written and is efficient for the case of
relatively few block matrices which are typically sparse themselves.
</p>
<p>It is currently <em>inefficient</em> for the case of many small dense
block matrices.
For the case of <em>many</em> dense <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>×</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">k \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> matrices,
the <code>bdiag_m()</code> function in the ‘Examples’ is an order of
magnitude faster.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, built on a version posted by Berton Gunter to
R-help; earlier versions have been posted by other authors, notably
Scott Chasalow to S-news.  Doug Bates's faster implementation builds
on <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code> objects.
</p>


<h3>See Also</h3>

<p><code><a href="#Diagonal">Diagonal</a></code> for constructing matrices of
class <code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>, or <code><a href="#kronecker-methods">kronecker</a></code>
which also works for <code>"Matrix"</code> inheriting matrices.
</p>
<p><code><a href="#bandSparse">bandSparse</a></code> constructs a <em>banded</em> sparse matrix from
its non-zero sub-/super - diagonals.
</p>
<p>Note that other CRAN <span class="rlang"><b>R</b></span> packages have own versions of <code>bdiag()</code>
which return traditional matrices.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">bdiag<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## combine "Matrix" class and traditional matrices:</span>
bdiag<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

mlist <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> cbind<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token operator">:</span><span class="token number">101</span><span class="token punctuation">)</span>
bdiag<span class="token punctuation">(</span>mlist<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>bdiag<span class="token punctuation">(</span>mlist<span class="token punctuation">)</span><span class="token punctuation">,</span> 
                    bdiag<span class="token punctuation">(</span>lapply<span class="token punctuation">(</span>mlist<span class="token punctuation">,</span> as.matrix<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ml <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>as<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token percent-operator operator">%%</span> <span class="token number">11</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"nMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rep<span class="token punctuation">(</span>list<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
mln <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>ml<span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>is<span class="token punctuation">(</span>bdiag<span class="token punctuation">(</span>ml<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"lsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          is<span class="token punctuation">(</span>bdiag<span class="token punctuation">(</span>mln<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"dsparseMatrix"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>

<span class="token comment">## random (diagonal-)block-triangular matrices:</span>
rblockTri <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>nb<span class="token punctuation">,</span> max.ni<span class="token punctuation">,</span> lambda <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   .bdiag<span class="token punctuation">(</span>replicate<span class="token punctuation">(</span>nb<span class="token punctuation">,</span> <span class="token punctuation">{</span>
         n <span class="token operator">&lt;-</span> sample.int<span class="token punctuation">(</span>max.ni<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
         tril<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>rpois<span class="token punctuation">(</span>n <span class="token operator">*</span> n<span class="token punctuation">,</span> lambda <span class="token operator">=</span> lambda<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token punctuation">(</span>T4 <span class="token operator">&lt;-</span> rblockTri<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> lambda <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>T1 <span class="token operator">&lt;-</span> rblockTri<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment">##' Fast version of Matrix :: .bdiag() -- for the case of *many*  (k x k) matrices:</span>
<span class="token comment">##' @param lmat list(&lt;mat1&gt;, &lt;mat2&gt;, ....., &lt;mat_N&gt;)  where each mat_j is a  k x k 'matrix'</span>
<span class="token comment">##' @return a sparse (N*k x N*k) matrix of class  \code{"\linkS4class{dgCMatrix}"}.</span>
bdiag_m <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>lmat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">## Copyright (C) 2016 Martin Maechler, ETH Zurich</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>length<span class="token punctuation">(</span>lmat<span class="token punctuation">)</span><span class="token punctuation">)</span> return<span class="token punctuation">(</span>new<span class="token punctuation">(</span><span class="token string">"dgCMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    stopifnot<span class="token punctuation">(</span>is.list<span class="token punctuation">(</span>lmat<span class="token punctuation">)</span><span class="token punctuation">,</span> is.matrix<span class="token punctuation">(</span>lmat<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token punctuation">(</span>k <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>d <span class="token operator">&lt;-</span> dim<span class="token punctuation">(</span>lmat<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> d<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># k x k</span>
              all<span class="token punctuation">(</span>vapply<span class="token punctuation">(</span>lmat<span class="token punctuation">,</span> dim<span class="token punctuation">,</span> integer<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># all of them</span>
    N <span class="token operator">&lt;-</span> length<span class="token punctuation">(</span>lmat<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>N <span class="token operator">*</span> k <span class="token operator">&gt;</span> .Machine<span class="token operator">$</span>integer.max<span class="token punctuation">)</span>
        stop<span class="token punctuation">(</span><span class="token string">"resulting matrix too large; would be  M x M, with M="</span><span class="token punctuation">,</span> N<span class="token operator">*</span>k<span class="token punctuation">)</span>
    M <span class="token operator">&lt;-</span> as.integer<span class="token punctuation">(</span>N <span class="token operator">*</span> k<span class="token punctuation">)</span>
    <span class="token comment">## result: an   M x M  matrix</span>
    new<span class="token punctuation">(</span><span class="token string">"dgCMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>M<span class="token punctuation">,</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">## 'i :' maybe there's a faster way (w/o matrix indexing), but elegant?</span>
        i <span class="token operator">=</span> as.vector<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token number">0L</span><span class="token operator">:</span><span class="token punctuation">(</span>M<span class="token operator">-</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nrow<span class="token operator">=</span>k<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span>seq_len<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> each<span class="token operator">=</span>k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        p <span class="token operator">=</span> k <span class="token operator">*</span> <span class="token number">0L</span><span class="token operator">:</span>M<span class="token punctuation">,</span>
        x <span class="token operator">=</span> as.double<span class="token punctuation">(</span>unlist<span class="token punctuation">(</span>lmat<span class="token punctuation">,</span> recursive<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> use.names<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

l12 <span class="token operator">&lt;-</span> replicate<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> matrix<span class="token punctuation">(</span>rpois<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> lambda <span class="token operator">=</span> <span class="token number">6.4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 simplify<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
dim<span class="token punctuation">(</span>T12 <span class="token operator">&lt;-</span> bdiag_m<span class="token punctuation">(</span>l12<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 48 x 48</span>
T12<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="boolean-matprod">

<a href="#boolean-matprod" class="help-page-title"><h2 id="boolmatmult-methods">Boolean Arithmetic Matrix Products: <code>%&amp;%</code> and Methods</h2></a>

<h3>Description</h3>

<p>For boolean or “patter<b>n</b>” matrices, i.e., <span class="rlang"><b>R</b></span> objects of
class <code><a href="#nMatrix-class">nMatrix</a></code>, it is natural to allow matrix
products using boolean instead of numerical arithmetic.
</p>
<p>In package <span class="pkg">Matrix</span>, we use the binary operator <code>%&amp;%</code> (aka
“infix”) function) for this and provide methods for all our
matrices and the traditional <span class="rlang"><b>R</b></span> matrices (see <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>).
</p>


<h3>Value</h3>

<p>a pattern matrix, i.e., inheriting from <code>"<a href="#nMatrix-class">nMatrix</a>"</code>,
or an <code>"<a href="#ldiMatrix-class">ldiMatrix</a>"</code> in case of a diagonal matrix.
</p>


<h3>Methods</h3>

<p>We provide methods for both the “traditional” (<span class="rlang"><b>R</b></span> base) matrices
and numeric vectors and conceptually all matrices and
<code><a href="#sparseVector-class">sparseVector</a></code>s in package <span class="pkg">Matrix</span>.
</p>

<dl>
<dt><code>signature(x = "ANY", y = "ANY")</code></dt>
<dd> </dd>
<dt><code>signature(x = "ANY", y = "Matrix")</code></dt>
<dd> </dd>
<dt><code>signature(x = "Matrix", y = "ANY")</code></dt>
<dd> </dd>
<dt><code>signature(x = "mMatrix", y = "mMatrix")</code></dt>
<dd> </dd>
<dt><code>signature(x = "nMatrix", y = "nMatrix")</code></dt>
<dd> </dd>
<dt><code>signature(x = "nMatrix", y = "nsparseMatrix")</code></dt>
<dd> </dd>
<dt><code>signature(x = "nsparseMatrix", y = "nMatrix")</code></dt>
<dd> </dd>
<dt><code>signature(x = "nsparseMatrix", y = "nsparseMatrix")</code></dt>
<dd> </dd>
<dt><code>signature(x = "sparseVector", y = "mMatrix")</code></dt>
<dd> </dd>
<dt><code>signature(x = "mMatrix", y = "sparseVector")</code></dt>
<dd> </dd>
<dt><code>signature(x = "sparseVector", y = "sparseVector")</code></dt>
<dd> </dd>
</dl>
<h3>Note</h3>

<p>These boolean arithmetic matrix products had been newly
introduced for <span class="pkg">Matrix</span> 1.2.0 (March 2015).  Its implementation
has still not been tested extensively.
</p>
<p>Originally, it was left unspecified how non-structural zeros, i.e., <code>0</code>'s
as part of the <code>M@x</code> slot should be treated for numeric
(<code>"<a href="#dMatrix-class">dMatrix</a>"</code>) and logical (<code>"<a href="#dMatrix-class">lMatrix</a>"</code>)
sparse matrices.  We now specify that boolean matrix products should behave as if
applied to <code><a href="#drop0">drop0</a>(M)</code>, i.e., as if dropping such zeros from
the matrix before using it.
<br>
Equivalently, for all matrices <code>M</code>, boolean arithmetic should work as if
applied to <code>M != 0</code> (or <code>M != FALSE</code>).
</p>
<p>The current implementation ends up coercing both <code>x</code> and <code>y</code> to
(virtual) class <code><a href="#nsparseMatrix-classes">nsparseMatrix</a></code> which may be quite inefficient
for dense matrices.  A future implementation may well return a matrix
with <b>different</b> class, but the “same” content, i.e., the
same matrix entries <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub><mi>j</mi></mrow><annotation encoding="application/x-tex">m_ij</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#matrix-products">%*%</a></code>, <code>crossprod()</code>, or <code><a href="#matrix-products">tcrossprod</a>()</code>,
for (regular) matrix product methods.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">set.seed<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
L <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>N <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>L<span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
L. <span class="token operator">&lt;-</span> L<span class="token punctuation">;</span> L.<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token boolean">TRUE</span><span class="token punctuation">;</span> L.<span class="token operator">@</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span><span class="token punctuation">;</span> L. <span class="token comment"># has "zeros" to drop0()</span>
D <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; values in -1:1 (for this seed)</span>
L <span class="token percent-operator operator">%&amp;%</span> D
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>L <span class="token percent-operator operator">%&amp;%</span> D<span class="token punctuation">,</span> N <span class="token percent-operator operator">%&amp;%</span> D<span class="token punctuation">)</span><span class="token punctuation">,</span>
          all<span class="token punctuation">(</span>L <span class="token percent-operator operator">%&amp;%</span> D <span class="token operator">==</span> as<span class="token punctuation">(</span><span class="token punctuation">(</span>L <span class="token percent-operator operator">%*%</span> abs<span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## cross products , possibly with  boolArith = TRUE :</span>
crossprod<span class="token punctuation">(</span>N<span class="token punctuation">)</span>     <span class="token comment"># -&gt; sparse patter'n' (TRUE/FALSE : boolean arithmetic)</span>
crossprod<span class="token punctuation">(</span>N  <span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; numeric Matrix (with same "pattern")</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">==</span> t<span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token percent-operator operator">%&amp;%</span> N<span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> crossprod<span class="token punctuation">(</span>N <span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">,</span> boolArith<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">,</span> crossprod<span class="token punctuation">(</span>N   <span class="token punctuation">,</span> boolArith<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
crossprod<span class="token punctuation">(</span>D<span class="token punctuation">,</span> boolArith <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># pattern: "nsCMatrix"</span>
crossprod<span class="token punctuation">(</span>L<span class="token punctuation">,</span> boolArith <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment">#  ditto</span>
crossprod<span class="token punctuation">(</span>L<span class="token punctuation">,</span> boolArith <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span> <span class="token comment"># numeric: "dsCMatrix"</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="BunchKaufman-class">

<a href="#BunchKaufman-class" class="help-page-title"><h2 id="BunchKaufman-class">Dense Bunch-Kaufman Factorizations</h2></a>

<h3>Description</h3>

<p>Classes <code>BunchKaufman</code> and <code>pBunchKaufman</code> represent
Bunch-Kaufman factorizations of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> real,
symmetric matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, having the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>U</mi><msub><mi>D</mi><mi>U</mi></msub><msup><mi>U</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>L</mi><msub><mi>D</mi><mi>L</mi></msub><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A = U D_{U} U' = L D_{L} L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9019em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9019em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">D_{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">D_{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are symmetric, block diagonal
matrices composed of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">b_{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">b_{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code> diagonal blocks;
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>b</mi><mi>U</mi></msub></msubsup><msub><mi>P</mi><mi>k</mi></msub><msub><mi>U</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">U = \prod_{k = 1}^{b_{U}} P_{k} U_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
is the product of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">b_{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> row-permuted unit upper triangular
matrices, each having nonzero entries above the diagonal in 1 or 2 columns;
and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>b</mi><mi>L</mi></msub></msubsup><msub><mi>P</mi><mi>k</mi></msub><msub><mi>L</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">L = \prod_{k = 1}^{b_{L}} P_{k} L_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
is the product of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">b_{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> row-permuted unit lower triangular
matrices, each having nonzero entries below the diagonal in 1 or 2 columns.
</p>
<p>These classes store the nonzero entries of the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msub><mi>b</mi><mi>U</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 b_{U} + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msub><mi>b</mi><mi>L</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 b_{L} + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> factors,
which are individually sparse,
in a dense format as a vector of length
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">nn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">nn</span></span></span></span></code> (<code>BunchKaufman</code>) or
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n(n+1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code> (<code>pBunchKaufman</code>),
the latter giving the “packed” representation.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>, <code>Dimnames</code>
</dt>
<dd>
<p>inherited from virtual class
<code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>.</p>
</dd>
<dt><code>uplo</code></dt>
<dd>
<p>a string, either <code>"U"</code> or <code>"L"</code>,
indicating which triangle (upper or lower) of the factorized
symmetric matrix was used to compute the factorization and
in turn how the <code>x</code> slot is partitioned.</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>a numeric vector of length <code>n*n</code>
(<code>BunchKaufman</code>) or <code>n*(n+1)/2</code> (<code>pBunchKaufman</code>),
where <code>n=Dim[1]</code>.
The details of the representation are specified by the manual
for LAPACK routines <code>dsytrf</code> and <code>dsptrf</code>.</p>
</dd>
<dt><code>perm</code></dt>
<dd>
<p>an integer vector of length <code>n=Dim[1]</code>
specifying row and column interchanges as described in the manual
for LAPACK routines <code>dsytrf</code> and <code>dsptrf</code>.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code><a href="#MatrixFactorization-class">BunchKaufmanFactorization</a></code>, directly.
Class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>, by class
<code><a href="#MatrixFactorization-class">BunchKaufmanFactorization</a></code>, distance 2.
</p>


<h3>Instantiation</h3>

<p>Objects can be generated directly by calls of the form
<code>new("BunchKaufman", ...)</code> or <code>new("pBunchKaufman", ...)</code>,
but they are more typically obtained as the value of
<code><a href="#BunchKaufman-methods">BunchKaufman</a>(x)</code> for <code>x</code> inheriting from
<code><a href="#dsyMatrix-class">dsyMatrix</a></code> or <code><a href="#dsyMatrix-class">dspMatrix</a></code>.
</p>


<h3>Methods</h3>


<dl>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "BunchKaufman", to = "dtrMatrix")</code>:
returns a <code><a href="#dtrMatrix-class">dtrMatrix</a></code>, useful for inspecting
the internal representation of the factorization; see ‘Note’.</p>
</dd>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "pBunchKaufman", to = "dtpMatrix")</code>:
returns a <code><a href="#dtpMatrix-class">dtpMatrix</a></code>, useful for inspecting
the internal representation of the factorization; see ‘Note’.</p>
</dd>
<dt><code>determinant</code></dt>
<dd>
<p><code>signature(from = "p?BunchKaufman", logarithm = "logical")</code>:
computes the determinant of the factorized matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>
or its logarithm.</p>
</dd>
<dt><code>expand1</code></dt>
<dd>
<p><code>signature(x = "p?BunchKaufman")</code>:
see <code><a href="#expand">expand1-methods</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "p?BunchKaufman")</code>:
see <code><a href="#expand">expand2-methods</a></code>.</p>
</dd>
<dt><code>solve</code></dt>
<dd>
<p><code>signature(a = "p?BunchKaufman", b = .)</code>:
see <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
</dl>
<h3>Note</h3>

<p>In <span class="pkg">Matrix</span> <code>&lt; 1.6-0</code>, class <code>BunchKaufman</code> extended
<code><a href="#dtrMatrix-class">dtrMatrix</a></code> and class <code>pBunchKaufman</code> extended
<code><a href="#dtpMatrix-class">dtpMatrix</a></code>, reflecting the fact that the internal
representation of the factorization is fundamentally triangular:
there are <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n(n+1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code> “parameters”, and these
can be arranged systematically to form an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
triangular matrix.
<span class="pkg">Matrix</span> <code>1.6-0</code> removed these extensions so that methods
would no longer be inherited from <code>dtrMatrix</code> and <code>dtpMatrix</code>.  
The availability of such methods gave the wrong impression that
<code>BunchKaufman</code> and <code>pBunchKaufman</code> represent a (singular)
matrix, when in fact they represent an ordered set of matrix factors.
</p>
<p>The coercions <code>as(., "dtrMatrix")</code> and <code>as(., "dtpMatrix")</code>
are provided for users who understand the caveats.
</p>


<h3>References</h3>

<p>The LAPACK source code, including documentation; see
<a href="https://netlib.org/lapack/double/dsytrf.f" target="_blank">https://netlib.org/lapack/double/dsytrf.f</a> and
<a href="https://netlib.org/lapack/double/dsptrf.f" target="_blank">https://netlib.org/lapack/double/dsptrf.f</a>.
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Class <code><a href="#dsyMatrix-class">dsyMatrix</a></code> and its packed counterpart.
</p>
<p>Generic functions <code><a href="#BunchKaufman-methods">BunchKaufman</a></code>,
<code><a href="#expand">expand1</a></code>, and <code><a href="#expand">expand2</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"BunchKaufman"</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

n <span class="token operator">&lt;-</span> <span class="token number">6L</span>
<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> forceSymmetric<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>n <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## With dimnames, to see that they are propagated :</span>
dimnames<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> rep.int<span class="token punctuation">(</span>list<span class="token punctuation">(</span>paste0<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>bk.A <span class="token operator">&lt;-</span> BunchKaufman<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>e.bk.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>bk.A<span class="token punctuation">,</span> complete <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>E.bk.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>bk.A<span class="token punctuation">,</span> complete <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>

<span class="token comment">## Underlying LAPACK representation</span>
<span class="token punctuation">(</span>m.bk.A <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>bk.A<span class="token punctuation">,</span> <span class="token string">"dtrMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>as<span class="token punctuation">(</span>m.bk.A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> `dim<span class="token operator">&lt;-</span>`<span class="token punctuation">(</span>bk.A<span class="token operator">@</span>x<span class="token punctuation">,</span> bk.A<span class="token operator">@</span>Dim<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Number of factors is 2*b+1, b &lt;= n, which can be nontrivial ...</span>
<span class="token punctuation">(</span>b <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>length<span class="token punctuation">(</span>E.bk.A<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1L</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%/%</span> <span class="token number">2L</span><span class="token punctuation">)</span>

ae1 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
ae2 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> ae1<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> unname<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ U DU U', U := prod(Pk Uk) in floating point</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>e.bk.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token string">"DU"</span><span class="token punctuation">,</span> <span class="token string">"U."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.bk.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"U"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> E.bk.A<span class="token punctuation">[</span>seq_len<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.bk.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"U."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span>e.bk.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"U"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae1<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.bk.A<span class="token punctuation">,</span> U <span class="token percent-operator operator">%*%</span> DU <span class="token percent-operator operator">%*%</span> U.<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Factorization handled as factorized matrix</span>
b <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>det<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> det<span class="token punctuation">(</span>bk.A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> solve<span class="token punctuation">(</span>bk.A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="BunchKaufman-methods">

<a href="#BunchKaufman-methods" class="help-page-title"><h2 id="BunchKaufman-methods">Methods for Bunch-Kaufman Factorization</h2></a>

<h3>Description</h3>

<p>Computes the Bunch-Kaufman factorization of an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
real, symmetric matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, which has the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>U</mi><msub><mi>D</mi><mi>U</mi></msub><msup><mi>U</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>L</mi><msub><mi>D</mi><mi>L</mi></msub><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A = U D_{U} U' = L D_{L} L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9019em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9019em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">D_{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">D_{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are symmetric, block diagonal
matrices composed of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">b_{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">b_{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code> diagonal blocks;
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>b</mi><mi>U</mi></msub></msubsup><msub><mi>P</mi><mi>k</mi></msub><msub><mi>U</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">U = \prod_{k = 1}^{b_{U}} P_{k} U_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
is the product of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">b_{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> row-permuted unit upper triangular
matrices, each having nonzero entries above the diagonal in 1 or 2 columns;
and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>b</mi><mi>L</mi></msub></msubsup><msub><mi>P</mi><mi>k</mi></msub><msub><mi>L</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">L = \prod_{k = 1}^{b_{L}} P_{k} L_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
is the product of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">b_{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> row-permuted unit lower triangular
matrices, each having nonzero entries below the diagonal in 1 or 2 columns.
</p>
<p>Methods are built on LAPACK routines <code>dsytrf</code> and <code>dsptrf</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">BunchKaufman<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsyMatrix'</span>
BunchKaufman<span class="token punctuation">(</span>x<span class="token punctuation">,</span> warnSing <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dspMatrix'</span>
BunchKaufman<span class="token punctuation">(</span>x<span class="token punctuation">,</span> warnSing <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'matrix'</span>
BunchKaufman<span class="token punctuation">(</span>x<span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="BunchKaufman-methods_:_x">x</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a> symmetric matrix or
<code><a href="#Matrix-class">Matrix</a></code> to be factorized.
If <code>x</code> is square but not symmetric, then it will be
<em>treated</em> as symmetric; see <code>uplo</code>.</p>
</td>
</tr>
<tr>
<td><code id="BunchKaufman-methods_:_warnSing">warnSing</code></td>
<td>
<p>a logical indicating if a <a href="https://r-universe.dev/manuals/base.html#warning">warning</a> should
be signaled for singular <code>x</code>.</p>
</td>
</tr>
<tr>
<td><code id="BunchKaufman-methods_:_uplo">uplo</code></td>
<td>
<p>a string, either <code>"U"</code> or <code>"L"</code>,
indicating which triangle of <code>x</code> should be used
to compute the factorization.</p>
</td>
</tr>
<tr>
<td><code id="BunchKaufman-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object representing the factorization, inheriting from
virtual class <code><a href="#MatrixFactorization-class">BunchKaufmanFactorization</a></code>.
The specific class is <code><a href="#BunchKaufman-class">BunchKaufman</a></code> unless
<code>x</code> inherits from virtual class <code><a href="#packedMatrix-class">packedMatrix</a></code>,
in which case it is <code><a href="#BunchKaufman-class">pBunchKaufman</a></code>.
</p>


<h3>References</h3>

<p>The LAPACK source code, including documentation; see
<a href="https://netlib.org/lapack/double/dsytrf.f" target="_blank">https://netlib.org/lapack/double/dsytrf.f</a> and
<a href="https://netlib.org/lapack/double/dsptrf.f" target="_blank">https://netlib.org/lapack/double/dsptrf.f</a>.
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Classes <code><a href="#BunchKaufman-class">BunchKaufman</a></code> and
<code><a href="#BunchKaufman-class">pBunchKaufman</a></code> and their methods.
</p>
<p>Classes <code><a href="#dsyMatrix-class">dsyMatrix</a></code> and
<code><a href="#dsyMatrix-class">dspMatrix</a></code>.
</p>
<p>Generic functions <code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>,
for constructing matrix factors from the result.
</p>
<p>Generic functions <code><a href="#Cholesky">Cholesky</a></code>, <code><a href="#Schur">Schur</a></code>,
<code><a href="#lu">lu</a></code>, and <code><a href="#qr-methods">qr</a></code>,
for computing other factorizations.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span><span class="token string">"BunchKaufman"</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

data<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
class<span class="token punctuation">(</span>CAex<span class="token punctuation">)</span> <span class="token comment"># dgCMatrix</span>
isSymmetric<span class="token punctuation">(</span>CAex<span class="token punctuation">)</span> <span class="token comment"># symmetric, but not formally</span>

A <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span>
class<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token comment"># dsCMatrix</span>

<span class="token comment">## Have methods for denseMatrix (unpacked and packed),</span>
<span class="token comment">## but not yet sparseMatrix ...</span>
<span class="token comment">## Not run: </span>
<span class="token punctuation">(</span>bk.A <span class="token operator">&lt;-</span> BunchKaufman<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## End(Not run)</span>
<span class="token punctuation">(</span>bk.A <span class="token operator">&lt;-</span> BunchKaufman<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">"unpackedMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ U DU U' in floating point</span>
str<span class="token punctuation">(</span>e.bk.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>bk.A<span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> e.bk.A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="CAex">

<a href="#CAex" class="help-page-title"><h2 id="CAex">Albers' example Matrix with "Difficult" Eigen Factorization</h2></a>

<h3>Description</h3>

<p>An example of a sparse matrix for which <code><a href="https://r-universe.dev/manuals/base.html#eigen">eigen</a>()</code> seemed
to be difficult, an unscaled version of this has been posted to the
web, accompanying an E-mail to R-help
(<a href="https://stat.ethz.ch/mailman/listinfo/r-help" target="_blank">https://stat.ethz.ch/mailman/listinfo/r-help</a>), by
Casper J Albers, Open University, UK.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>CAex<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>This is a <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>72</mn><mo>×</mo><mn>72</mn></mrow><annotation encoding="application/x-tex">72 \times 72</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">72</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">72</span></span></span></span></code> symmetric matrix with 216
non-zero entries in five bands, stored as sparse matrix of class
<code><a href="#dgCMatrix-class">dgCMatrix</a></code>.
</p>


<h3>Details</h3>

<p>Historical note (2006-03-30):
In earlier versions of <span class="rlang"><b>R</b></span>, <code><a href="https://r-universe.dev/manuals/base.html#eigen">eigen</a>(CAex)</code> fell into an
infinite loop whereas <code><a href="https://r-universe.dev/manuals/base.html#eigen">eigen</a>(CAex, EISPACK=TRUE)</code> had been okay.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>CAex<span class="token punctuation">)</span> <span class="token comment"># of class "dgCMatrix"</span>

image<span class="token punctuation">(</span>CAex<span class="token punctuation">)</span><span class="token comment"># -&gt; it's a simple band matrix with 5 bands</span>
<span class="token comment">## and the eigen values are basically 1 (42 times) and 0 (30 x):</span>
zapsmall<span class="token punctuation">(</span>ev <span class="token operator">&lt;-</span> eigen<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> only.values<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>values<span class="token punctuation">)</span>
<span class="token comment">## i.e., the matrix is symmetric, hence</span>
sCA <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span>
<span class="token comment">## and</span>
stopifnot<span class="token punctuation">(</span>class<span class="token punctuation">(</span>sCA<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"dsCMatrix"</span><span class="token punctuation">,</span>
          as<span class="token punctuation">(</span>sCA<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span> <span class="token operator">==</span> as<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="cBind">

<a href="#cBind" class="help-page-title"><h2 id="cbind2-methods">'cbind()' and 'rbind()' recursively built on cbind2/rbind2</h2></a>

<h3>Description</h3>

<p>The base functions <code><a href="https://r-universe.dev/manuals/base.html#cbind">cbind</a></code> and <code><a href="https://r-universe.dev/manuals/base.html#cbind">rbind</a></code> are
defined for an arbitrary number of arguments and hence have the first
formal argument <code>...</code>.  Now, when S4 objects are found among the arguments,
base <code>cbind()</code> and <code>rbind()</code> internally “dispatch”
<em>recursively</em>, calling <code><a href="#cBind">cbind2</a></code> or <code><a href="#cBind">rbind2</a></code>
respectively, where these have methods defined and so should dispatch
appropriately.
</p>
<p><code><a href="#cBind">cbind2</a>()</code> and <code><a href="#cBind">rbind2</a>()</code> are from the
<span class="pkg">methods</span> package, i.e., standard <span class="rlang"><b>R</b></span>, and have been provided for
binding together <em>two</em> matrices, where in <span class="pkg">Matrix</span>, we have
defined methods for these and the <code>'Matrix'</code> matrices.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## cbind(..., deparse.level = 1)</span>
<span class="token comment">## rbind(..., deparse.level = 1)</span>

<span class="token comment">## S4 method for signature 'denseMatrix,sparseMatrix'</span>
cbind2<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'sparseMatrix,denseMatrix'</span>
cbind2<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'denseMatrix,sparseMatrix'</span>
rbind2<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'sparseMatrix,denseMatrix'</span>
rbind2<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="cbind2-methods_:_...">...</code></td>
<td>
<p>for <code>[cr]bind</code>, vector- or matrix-like <span class="rlang"><b>R</b></span> objects
to be bound together; for <code>[cr]bind2</code>, further arguments
passed to or from methods; see <code><a href="https://r-universe.dev/manuals/base.html#cbind">cbind</a></code> and
<code><a href="https://r-universe.dev/manuals/methods.html#cbind2">cbind2</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="cbind2-methods_:_deparse.level">deparse.level</code></td>
<td>
<p>integer controlling the construction of labels
in the case of non-matrix-like arguments; see <code><a href="https://r-universe.dev/manuals/base.html#cbind">cbind</a></code>.</p>
</td>
</tr>
<tr>
<td>
<code id="cbind2-methods_:_x">x</code>, <code id="cbind2-methods_:_y">y</code>
</td>
<td>
<p>vector- or matrix-like <span class="rlang"><b>R</b></span> objects to be bound together.</p>
</td>
</tr>
<tr>
<td><code id="cbind2-methods_:_sparse">sparse</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if the result should
be formally sparse, i.e., if it should inherit from virtual class
<code><a href="#sparseMatrix-class">sparseMatrix</a></code>.  <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>, the default,
decides based on the “sparsity” of <code>x</code> and <code>y</code>;
see, e.g., <code>selectMethod(cbind2, c("sparseMatrix", "denseMatrix"))</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>typically a ‘matrix-like’ object of a similar
<code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> as the first argument in <code>...</code>.
</p>
<p>Note that sometimes by default, the result is a
<code><a href="#sparseMatrix-class">sparseMatrix</a></code> if one of the arguments is (even in
the case where this is not efficient).  In other cases,
the result is chosen to be sparse when there are more zero entries is
than non-zero ones (as the default <code>sparse</code> in
<code><a href="#Matrix">Matrix</a>()</code>).
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#cbind">cbind</a></code>, <code><a href="https://r-universe.dev/manuals/methods.html#cbind2">cbind2</a></code>.
</p>
<p>Our class definition help pages mentioning <code>cbind2()</code> and
<code>rbind2()</code> methods:
<code>"<a href="#denseMatrix-class">denseMatrix</a>"</code>,
<code>"<a href="#diagonalMatrix-class">diagonalMatrix</a>"</code>,
<code>"<a href="#indMatrix-class">indMatrix</a>"</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>a <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>M1 <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> rbind<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># a traditional matrix</span>

D <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>M2 <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> D<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> D<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># a sparse Matrix</span>

stopifnot<span class="token punctuation">(</span>validObject<span class="token punctuation">(</span>M2<span class="token punctuation">)</span><span class="token punctuation">,</span> inherits<span class="token punctuation">(</span>M2<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          dim<span class="token punctuation">(</span>M2<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="CHMfactor-class">

<a href="#CHMfactor-class" class="help-page-title"><h2 id="CHMfactor-class">Sparse Cholesky Factorizations</h2></a>

<h3>Description</h3>

<p><code>CHMfactor</code> is the virtual class of sparse Cholesky
factorizations of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> real, symmetric
matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, having the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo><mover><mo><mo>=</mo></mo><mrow><msub><mi>D</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub><mo>≥</mo><mn>0</mn></mrow></mover></mo><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">P_1 A P_1' = L_1 D L_1' \overset{D_{jj} \ge 0}{=} L L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.5016em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2535em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.6752em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">jj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mrel mtight">≥</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>P</mi><mn>1</mn></msub><mo><mover><mo><mo>=</mo></mo><mrow><msub><mi>D</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub><mo>≥</mo><mn>0</mn></mrow></mover></mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A = P_1' L_1 D L_1' P_1 \overset{D_{jj} \ge 0}{=} P_1' L L' P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.5016em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2535em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.6752em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">jj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mrel mtight">≥</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is a permutation matrix,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">L_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is a unit lower triangular matrix,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code> is a diagonal matrix, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><msqrt><mi>D</mi></msqrt></mrow><annotation encoding="application/x-tex">L = L_1 \sqrt{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0767em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9267em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-2.8867em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1133em;"><span></span></span></span></span></span></span></span></span></code>.
The second equalities hold only for positive semidefinite <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
for which the diagonal entries of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code> are non-negative
and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>D</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1133em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9267em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-2.8867em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1133em;"><span></span></span></span></span></span></span></span></span></code> is well-defined.
</p>
<p>The implementation of class <code>CHMfactor</code> is based on
CHOLMOD's C-level <code>cholmod_factor_struct</code>.  Virtual
subclasses <code>CHMsimpl</code> and <code>CHMsuper</code> separate
the simplicial and supernodal variants.  These have nonvirtual
subclasses <code>[dn]CHMsimpl</code> and <code>[dn]CHMsuper</code>,
where prefix ‘<span class="samp">⁠d⁠</span>’ and prefix ‘<span class="samp">⁠n⁠</span>’ are reserved
for numeric and symbolic factorizations, respectively.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">isLDL<span class="token punctuation">(</span>x<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="CHMfactor-class_:_x">x</code></td>
<td>
<p>an object inheriting from virtual class <code>CHMfactor</code>,
almost always the result of a call to generic function
<code><a href="#Cholesky">Cholesky</a></code>.</p>
</td>
</tr></table>
<h3>Value</h3>

<p><code>isLDL(x)</code> returns <code>TRUE</code> or <code>FALSE</code>:
<code>TRUE</code> if <code>x</code> stores the lower triangular entries
of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mo>−</mo><mi>I</mi><mo>+</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">L_1-I+D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code>,
<code>FALSE</code> if <code>x</code> stores the lower triangular entries
of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code>.
</p>


<h3>Slots</h3>

<p>Of <code>CHMfactor</code>:
</p>

<dl>
<dt>
<code>Dim</code>, <code>Dimnames</code>
</dt>
<dd>
<p>inherited from virtual class
<code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>.</p>
</dd>
<dt><code>colcount</code></dt>
<dd>
<p>an integer vector of length <code>Dim[1]</code>
giving an <em>estimate</em> of the number of nonzero entries in
each column of the lower triangular Cholesky factor.
If symbolic analysis was performed prior to factorization,
then the estimate is exact.</p>
</dd>
<dt><code>perm</code></dt>
<dd>
<p>a 0-based integer vector of length <code>Dim[1]</code>
specifying the permutation applied to the rows and columns
of the factorized matrix.  <code>perm</code> of length 0 is valid and
equivalent to the identity permutation, implying no pivoting.</p>
</dd>
<dt><code>type</code></dt>
<dd>
<p>an integer vector of length 6 specifying
details of the factorization.  The elements correspond to
members <code>ordering</code>, <code>is_ll</code>, <code>is_super</code>,
<code>is_monotonic</code>, <code>maxcsize</code>, and <code>maxesize</code>
of the original <code>cholmod_factor_struct</code>.
Simplicial and supernodal factorizations are distinguished
by <code>is_super</code>.  Simplicial factorizations do not use
<code>maxcsize</code> or <code>maxesize</code>.  Supernodal factorizations
do not use <code>is_ll</code> or <code>is_monotonic</code>.</p>
</dd>
</dl>
<p>Of <code>CHMsimpl</code> (all unused by <code>nCHMsimpl</code>): 
</p>

<dl>
<dt><code>nz</code></dt>
<dd>
<p>an integer vector of length <code>Dim[1]</code>
giving the number of nonzero entries in each column of the
lower triangular Cholesky factor.  There is at least one
nonzero entry in each column, because the diagonal elements
of the factor are stored explicitly.</p>
</dd>
<dt><code>p</code></dt>
<dd>
<p>an integer vector of length <code>Dim[1]+1</code>.
Row indices of nonzero entries in column <code>j</code> of the
lower triangular Cholesky factor are obtained as
<code>i[p[j]+seq_len(nz[j])]+1</code>.</p>
</dd>
<dt><code>i</code></dt>
<dd>
<p>an integer vector of length greater than or equal
to <code>sum(nz)</code> containing the row indices of nonzero entries
in the lower triangular Cholesky factor.  These are grouped by
column and sorted within columns, but the columns themselves
need not be ordered monotonically.  Columns may be overallocated,
i.e., the number of elements of <code>i</code> reserved for column
<code>j</code> may exceed <code>nz[j]</code>.</p>
</dd>
<dt>
<code>prv</code>, <code>nxt</code>
</dt>
<dd>
<p>integer vectors of length
<code>Dim[1]+2</code> indicating the order in which the columns of
the lower triangular Cholesky factor are stored in <code>i</code>
and <code>x</code>.
Starting from <code>j &lt;- Dim[1]+2</code>,
the recursion <code>j &lt;- nxt[j+1]+1</code> traverses the columns
in  forward order and terminates when <code>nxt[j+1] = -1</code>.
Starting from <code>j &lt;- Dim[1]+1</code>,
the recursion <code>j &lt;- prv[j+1]+1</code> traverses the columns
in backward order and terminates when <code>prv[j+1] = -1</code>.</p>
</dd>
</dl>
<p>Of <code>dCHMsimpl</code>:
</p>

<dl>
<dt><code>x</code></dt>
<dd>
<p>a numeric vector parallel to <code>i</code> containing
the corresponding nonzero entries of the lower triangular
Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> <em>or</em> (if and only if <code>type[2]</code>
is 0) of the lower triangular matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mo>−</mo><mi>I</mi><mo>+</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">L_1-I+D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code>.</p>
</dd>
</dl>
<p>Of <code>CHMsuper</code>:
</p>

<dl>
<dt>
<code>super</code>, <code>pi</code>, <code>px</code>
</dt>
<dd>
<p>integer vectors of
length <code>nsuper+1</code>, where <code>nsuper</code> is the number of
supernodes.  <code>super[j]+1</code> is the index of the leftmost
column of supernode <code>j</code>.  The row indices of supernode
<code>j</code> are obtained as <code>s[pi[j]+seq_len(pi[j+1]-pi[j])]+1</code>.
The numeric entries of supernode <code>j</code> are obtained as
<code>x[px[j]+seq_len(px[j+1]-px[j])]+1</code> (if slot <code>x</code>
is available).</p>
</dd>
<dt><code>s</code></dt>
<dd>
<p>an integer vector of length greater than or equal
to <code>Dim[1]</code> containing the row indices of the supernodes.
<code>s</code> may contain duplicates, but not within a supernode,
where the row indices must be increasing.</p>
</dd>
</dl>
<p>Of <code>dCHMsuper</code>:
</p>

<dl>
<dt><code>x</code></dt>
<dd>
<p>a numeric vector of length less than or equal to
<code>prod(Dim)</code> containing the numeric entries of the supernodes.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>, directly.
</p>


<h3>Instantiation</h3>

<p>Objects can be generated directly by calls of the form
<code>new("dCHMsimpl", ...)</code>, etc., but <code>dCHMsimpl</code> and
<code>dCHMsuper</code> are more typically obtained as the value of
<code><a href="#Cholesky">Cholesky</a>(x, ...)</code> for <code>x</code> inheriting from
<code><a href="#sparseMatrix-class">sparseMatrix</a></code>
(often <code><a href="#dsCMatrix-class">dsCMatrix</a></code>).
</p>
<p>There is currently no API outside of calls to <code><a href="https://r-universe.dev/manuals/methods.html#new">new</a></code>
for generating <code>nCHMsimpl</code> and <code>nCHMsuper</code>.  These
classes are vestigial and may be formally deprecated in a future
version of <span class="pkg">Matrix</span>.
</p>


<h3>Methods</h3>


<dl>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "CHMsimpl", to = "dtCMatrix")</code>:
returns a <code><a href="#dtCMatrix-class">dtCMatrix</a></code> representing
the lower triangular Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> <em>or</em>
the lower triangular matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mo>−</mo><mi>I</mi><mo>+</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">L_1-I+D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code>,
the latter if and only if <code>from@type[2]</code> is 0.</p>
</dd>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "CHMsuper", to = "dgCMatrix")</code>:
returns a <code><a href="#dgCMatrix-class">dgCMatrix</a></code> representing
the lower triangular Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code>.  Note that,
for supernodes spanning two or more columns, the supernodal
algorithm by design stores non-structural zeros above
the main diagonal, hence <code><a href="#dgCMatrix-class">dgCMatrix</a></code> is
indeed more appropriate than <code><a href="#dtCMatrix-class">dtCMatrix</a></code>
as a coercion target.</p>
</dd>
<dt><code>determinant</code></dt>
<dd>
<p><code>signature(from = "CHMfactor", logarithm = "logical")</code>:
behaves according to an optional argument <code>sqrt</code>.
If <code>sqrt = FALSE</code>, then this method computes the determinant
of the factorized matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> or its logarithm.
If <code>sqrt = TRUE</code>, then this method computes the determinant
of the factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L = L_1 sqrt(D)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span></code> or
its logarithm, giving <code>NaN</code> for the modulus when <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code>
has negative diagonal elements.  For backwards compatibility,
the default value of <code>sqrt</code> is <code>TRUE</code>, but that can
be expected change in a future version of <span class="pkg">Matrix</span>, hence
defensive code will always set <code>sqrt</code> (to <code>TRUE</code>,
if the code must remain backwards compatible with <span class="pkg">Matrix</span>
<code>&lt; 1.6-0</code>).  Calls to this method not setting <code>sqrt</code>
may warn about the pending change.  The warnings can be disabled
with <code><a href="https://r-universe.dev/manuals/base.html#options">options</a>(Matrix.warnSqrtDefault = 0)</code>.</p>
</dd>
<dt><code>diag</code></dt>
<dd>
<p><code>signature(x = "CHMfactor")</code>:
returns a numeric vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> containing the diagonal
elements of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code>, which (<em>if</em> they are all non-negative)
are the squared diagonal elements of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code>.</p>
</dd>
<dt><code>expand</code></dt>
<dd>
<p><code>signature(x = "CHMfactor")</code>:
see <code><a href="#expand">expand-methods</a></code>.</p>
</dd>
<dt><code>expand1</code></dt>
<dd>
<p><code>signature(x = "CHMsimpl")</code>:
see <code><a href="#expand">expand1-methods</a></code>.</p>
</dd>
<dt><code>expand1</code></dt>
<dd>
<p><code>signature(x = "CHMsuper")</code>:
see <code><a href="#expand">expand1-methods</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "CHMsimpl")</code>:
see <code><a href="#expand">expand2-methods</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "CHMsuper")</code>:
see <code><a href="#expand">expand2-methods</a></code>.</p>
</dd>
<dt><code>image</code></dt>
<dd>
<p><code>signature(x = "CHMfactor")</code>:
see <code><a href="#image-methods">image-methods</a></code>.</p>
</dd>
<dt><code>nnzero</code></dt>
<dd>
<p><code>signature(x = "CHMfactor")</code>:
see <code><a href="#nnzero">nnzero-methods</a></code>.</p>
</dd>
<dt><code>solve</code></dt>
<dd>
<p><code>signature(a = "CHMfactor", b = .)</code>:
see <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
<dt><code>update</code></dt>
<dd>
<p><code>signature(object = "CHMfactor")</code>:
returns a copy of <code>object</code> with the same nonzero pattern
but with numeric entries updated according to additional
arguments <code>parent</code> and <code>mult</code>, where <code>parent</code>
is (coercible to) a <code><a href="#dsCMatrix-class">dsCMatrix</a></code> or a
<code><a href="#dgCMatrix-class">dgCMatrix</a></code> and <code>mult</code> is a numeric
vector of positive length.
<br>
The numeric entries are updated with those of the Cholesky
factor of <code>F(parent) + mult[1] * I</code>, i.e.,
<code>F(parent)</code> plus <code>mult[1]</code> times the identity matrix,
where <code>F = <a href="https://r-universe.dev/manuals/base.html#identity">identity</a></code> for symmetric <code>parent</code>
and <code>F = <a href="#matrix-products">tcrossprod</a></code> for other <code>parent</code>.
The nonzero pattern of <code>F(parent)</code> must match
that of <code>S</code> if <code>object = Cholesky(S, ...)</code>.</p>
</dd>
<dt><code>updown</code></dt>
<dd>
<p><code>signature(update = ., C = ., object = "CHMfactor")</code>:
see <code><a href="#updown">updown-methods</a></code>.</p>
</dd>
</dl>
<h3>References</h3>

<p>The CHOLMOD source code; see
<a href="https://github.com/DrTimothyAldenDavis/SuiteSparse" target="_blank">https://github.com/DrTimothyAldenDavis/SuiteSparse</a>,
notably the header file ‘<span class="file">CHOLMOD/Include/cholmod.h</span>’
defining <code>cholmod_factor_struct</code>.
</p>
<p>Chen, Y., Davis, T. A., Hager, W. W., &amp; Rajamanickam, S. (2008).
Algorithm 887: CHOLMOD, supernodal sparse Cholesky factorization
and update/downdate.
<em>ACM Transactions on Mathematical Software</em>,
<em>35</em>(3), Article 22, 1-14.
<a href="https://doi.org/10.1145/1391989.1391995" target="_blank">doi:10.1145/1391989.1391995</a>
</p>
<p>Amestoy, P. R., Davis, T. A., &amp; Duff, I. S. (2004).
Algorithm 837: AMD, an approximate minimum degree ordering algorithm.
<em>ACM Transactions on Mathematical Software</em>,
<em>17</em>(4), 886-905.
<a href="https://doi.org/10.1145/1024074.1024081" target="_blank">doi:10.1145/1024074.1024081</a>
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Class <code><a href="#dsCMatrix-class">dsCMatrix</a></code>.
</p>
<p>Generic functions <code><a href="#Cholesky">Cholesky</a></code>, <code><a href="#updown">updown</a></code>,
<code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"dCHMsimpl"</span><span class="token punctuation">)</span>
showClass<span class="token punctuation">(</span><span class="token string">"dCHMsuper"</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

m <span class="token operator">&lt;-</span> <span class="token number">1000L</span>
n <span class="token operator">&lt;-</span> <span class="token number">200L</span>
M <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
A <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>M<span class="token punctuation">)</span>

<span class="token comment">## With dimnames, to see that they are propagated :</span>
dimnames<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> dn <span class="token operator">&lt;-</span> rep.int<span class="token punctuation">(</span>list<span class="token punctuation">(</span>paste0<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>ch.A <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># pivoted, by default</span>
str<span class="token punctuation">(</span>e.ch.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span> LDL <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>E.ch.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>

ae1 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
ae2 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> ae1<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> unname<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ P1' L1 D L1' P1 ~ P1' L L' P1 in floating point</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"P1."</span><span class="token punctuation">,</span> <span class="token string">"L1"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"L1."</span><span class="token punctuation">,</span> <span class="token string">"P1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"P1."</span><span class="token punctuation">,</span> <span class="token string">"L"</span> <span class="token punctuation">,</span>      <span class="token string">"L."</span> <span class="token punctuation">,</span> <span class="token string">"P1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              new<span class="token punctuation">(</span><span class="token string">"pMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> Dimnames <span class="token operator">=</span> c<span class="token punctuation">(</span>list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dn<span class="token punctuation">[</span><span class="token number">2L</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  margin <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">,</span> perm <span class="token operator">=</span> invertPerm<span class="token punctuation">(</span>ch.A<span class="token operator">@</span>perm<span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L1."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L1"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L."</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"D"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> diag<span class="token punctuation">(</span>ch.A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">,</span> L1 <span class="token percent-operator operator">%*%</span> sqrt<span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae1<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> L1 <span class="token percent-operator operator">%*%</span> D <span class="token percent-operator operator">%*%</span> L1. <span class="token percent-operator operator">%*%</span> P1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae1<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> L  <span class="token percent-operator operator">%*%</span>         L.  <span class="token percent-operator operator">%*%</span> P1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>A<span class="token punctuation">[</span>ch.A<span class="token operator">@</span>perm <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">,</span> ch.A<span class="token operator">@</span>perm <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">,</span> L1 <span class="token percent-operator operator">%*%</span> D <span class="token percent-operator operator">%*%</span> L1.<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>A<span class="token punctuation">[</span>ch.A<span class="token operator">@</span>perm <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">,</span> ch.A<span class="token operator">@</span>perm <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">,</span> L  <span class="token percent-operator operator">%*%</span>         L. <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Factorization handled as factorized matrix</span>
<span class="token comment">## (in some cases only optionally, depending on arguments)</span>
b <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>det<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> det<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span> sqrt <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> solve<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span> b<span class="token punctuation">,</span> system <span class="token operator">=</span> <span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

u1 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span>   A <span class="token punctuation">,</span> mult <span class="token operator">=</span> sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
u2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span> t<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> mult <span class="token operator">=</span> sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># updating with crossprod(M), not M</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>u1<span class="token punctuation">,</span> u2<span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">1e-14</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="chol">

<a href="#chol" class="help-page-title"><h2 id="chol-methods">Compute the Cholesky Factor of a Matrix</h2></a>

<h3>Description</h3>

<p>Computes the upper triangular Cholesky factor of an
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> real, symmetric, positive semidefinite
matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, optionally after pivoting.
That is the factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> in
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">P_{1} A P_{1}' = L L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A = P_{1}' L L' P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is a permutation matrix.
</p>
<p>Methods for <code><a href="#denseMatrix-class">denseMatrix</a></code> are built on
LAPACK routines <code>dpstrf</code>, <code>dpotrf</code>, and <code>dpptrf</code>,
The latter two do not permute rows or columns,
so that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is an identity matrix.
</p>
<p>Methods for <code><a href="#sparseMatrix-class">sparseMatrix</a></code> are built on
CHOLMOD routines <code>cholmod_analyze</code> and <code>cholmod_factorize_p</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">chol<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsyMatrix'</span>
chol<span class="token punctuation">(</span>x<span class="token punctuation">,</span> pivot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dspMatrix'</span>
chol<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsCMatrix'</span>
chol<span class="token punctuation">(</span>x<span class="token punctuation">,</span> pivot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'ddiMatrix'</span>
chol<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'generalMatrix'</span>
chol<span class="token punctuation">(</span>x<span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'triangularMatrix'</span>
chol<span class="token punctuation">(</span>x<span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="chol-methods_:_x">x</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a>, symmetric, positive
semidefinite matrix or <code><a href="#Matrix-class">Matrix</a></code> to
be factorized.  If <code>x</code> is square but not symmetric,
then it will be <em>treated</em> as symmetric; see <code>uplo</code>.
Methods for dense <code>x</code> require positive definiteness
when <code>pivot = FALSE</code>.
Methods for sparse (but not diagonal) <code>x</code> require
positive definiteness unconditionally.</p>
</td>
</tr>
<tr>
<td><code id="chol-methods_:_pivot">pivot</code></td>
<td>
<p>a logical indicating if the rows and columns
of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code> should be pivoted.  Methods for sparse <code>x</code>
employ the approximate minimum degree (AMD) algorithm
in order to reduce fill-in, i.e., without regard for
numerical stability.</p>
</td>
</tr>
<tr>
<td><code id="chol-methods_:_tol">tol</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a> numeric tolerance,
used only if <code>pivot = TRUE</code>.
The factorization algorithm stops if the pivot is less than
or equal to <code>tol</code>.  Negative <code>tol</code> is equivalent
to <code>nrow(x) * .Machine$double.eps * max(diag(x))</code>.</p>
</td>
</tr>
<tr>
<td><code id="chol-methods_:_uplo">uplo</code></td>
<td>
<p>a string, either <code>"U"</code> or <code>"L"</code>,
indicating which triangle of <code>x</code> should be used
to compute the factorization.  The default is <code>"U"</code>,
even for lower triangular <code>x</code>, to be consistent with
<code><a href="https://r-universe.dev/manuals/base.html#chol">chol</a></code> from <span class="pkg">base</span>.</p>
</td>
</tr>
<tr>
<td><code id="chol-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>x</code> inheriting from <code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>,
the diagonal result is computed directly and without pivoting,
i.e., bypassing CHOLMOD.
</p>
<p>For all other <code>x</code>, <code>chol(x, pivot = value)</code> calls
<code><a href="#Cholesky">Cholesky</a>(x, perm = value, ...)</code> under the hood.
If you must know the permutation <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> in addition
to the Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>, then call <code><a href="#Cholesky">Cholesky</a></code>
directly, as the result of <code>chol(x, pivot = TRUE)</code> specifies
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> but not <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.
</p>


<h3>Value</h3>

<p>A matrix, <code><a href="#triangularMatrix-class">triangularMatrix</a></code>,
or <code><a href="#diagonalMatrix-class">diagonalMatrix</a></code> representing
the upper triangular Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>.
The result is a traditional matrix if <code>x</code> is a
traditional matrix, dense if <code>x</code> is dense, and
sparse if <code>x</code> is sparse.
</p>


<h3>References</h3>

<p>The LAPACK source code, including documentation; see
<a href="https://netlib.org/lapack/double/dpstrf.f" target="_blank">https://netlib.org/lapack/double/dpstrf.f</a>,
<a href="https://netlib.org/lapack/double/dpotrf.f" target="_blank">https://netlib.org/lapack/double/dpotrf.f</a>, and
<a href="https://netlib.org/lapack/double/dpptrf.f" target="_blank">https://netlib.org/lapack/double/dpptrf.f</a>.
</p>
<p>The CHOLMOD source code; see
<a href="https://github.com/DrTimothyAldenDavis/SuiteSparse" target="_blank">https://github.com/DrTimothyAldenDavis/SuiteSparse</a>,
notably the header file ‘<span class="file">CHOLMOD/Include/cholmod.h</span>’
defining <code>cholmod_factor_struct</code>.
</p>
<p>Chen, Y., Davis, T. A., Hager, W. W., &amp; Rajamanickam, S. (2008).
Algorithm 887: CHOLMOD, supernodal sparse Cholesky factorization
and update/downdate.
<em>ACM Transactions on Mathematical Software</em>,
<em>35</em>(3), Article 22, 1-14.
<a href="https://doi.org/10.1145/1391989.1391995" target="_blank">doi:10.1145/1391989.1391995</a>
</p>
<p>Amestoy, P. R., Davis, T. A., &amp; Duff, I. S. (2004).
Algorithm 837: AMD, an approximate minimum degree ordering algorithm.
<em>ACM Transactions on Mathematical Software</em>,
<em>17</em>(4), 886-905.
<a href="https://doi.org/10.1145/1024074.1024081" target="_blank">doi:10.1145/1024074.1024081</a>
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>The default method from <span class="pkg">base</span>, <code><a href="https://r-universe.dev/manuals/base.html#chol">chol</a></code>,
called for traditional matrices <code>x</code>.
</p>
<p>Generic function <code><a href="#Cholesky">Cholesky</a></code>, for more flexibility
notably when computing the Cholesky <em>factorization</em> and
not only the <em>factor</em> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span><span class="token string">"chol"</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">## ---- Dense ----------------------------------------------------------</span>

<span class="token comment">## chol(x, pivot = value) wrapping Cholesky(x, perm = value)</span>
selectMethod<span class="token punctuation">(</span><span class="token string">"chol"</span><span class="token punctuation">,</span> <span class="token string">"dsyMatrix"</span><span class="token punctuation">)</span>

<span class="token comment">## Except in packed cases where pivoting is not yet available</span>
selectMethod<span class="token punctuation">(</span><span class="token string">"chol"</span><span class="token punctuation">,</span> <span class="token string">"dspMatrix"</span><span class="token punctuation">)</span>

<span class="token comment">## .... Positive definite ..............................................</span>

<span class="token punctuation">(</span>A1 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dsyMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>R1.nopivot <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>A1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>R1 <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>A1<span class="token punctuation">,</span> pivot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## In 2-by-2 cases, we know that the permutation is 1:2 or 2:1,</span>
<span class="token comment">## even if in general 'chol' does not say ...</span>

stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
   all.equal<span class="token punctuation">(</span>  A1           <span class="token punctuation">,</span> as<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>R1.nopivot<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"dsyMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   all.equal<span class="token punctuation">(</span>t<span class="token punctuation">(</span>A1<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>R1        <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"dsyMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   identical<span class="token punctuation">(</span>Cholesky<span class="token punctuation">(</span>A1<span class="token punctuation">)</span><span class="token operator">@</span>perm<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># because 5 &gt; 1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## .... Positive semidefinite but not positive definite ................</span>

<span class="token punctuation">(</span>A2 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dpoMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
try<span class="token punctuation">(</span>R2.nopivot <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>A2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># fails as not positive definite</span>
<span class="token punctuation">(</span>R2 <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>A2<span class="token punctuation">,</span> pivot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># returns, with a warning and ...</span>

stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
   all.equal<span class="token punctuation">(</span>t<span class="token punctuation">(</span>A2<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>R2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"dsyMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   identical<span class="token punctuation">(</span>Cholesky<span class="token punctuation">(</span>A2<span class="token punctuation">)</span><span class="token operator">@</span>perm<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># because 4 &gt; 1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## .... Not positive semidefinite ......................................</span>

<span class="token punctuation">(</span>A3 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dsyMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
try<span class="token punctuation">(</span>R3.nopivot <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>A3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># fails as not positive definite</span>
<span class="token punctuation">(</span>R3 <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>A3<span class="token punctuation">,</span> pivot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># returns, with a warning and ...</span>

<span class="token comment">## _Not_ equal: see details and examples in help("Cholesky")</span>
all.equal<span class="token punctuation">(</span>t<span class="token punctuation">(</span>A3<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>R3<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"dsyMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## ---- Sparse ---------------------------------------------------------</span>

<span class="token comment">## chol(x, pivot = value) wrapping</span>
<span class="token comment">## Cholesky(x, perm = value, LDL = FALSE, super = FALSE)</span>
selectMethod<span class="token punctuation">(</span><span class="token string">"chol"</span><span class="token punctuation">,</span> <span class="token string">"dsCMatrix"</span><span class="token punctuation">)</span>

<span class="token comment">## Except in diagonal cases which are handled "directly"</span>
selectMethod<span class="token punctuation">(</span><span class="token string">"chol"</span><span class="token punctuation">,</span> <span class="token string">"ddiMatrix"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>A4 <span class="token operator">&lt;-</span> toeplitz<span class="token punctuation">(</span>as<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"sparseVector"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>ch.A4.nopivot <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> super <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>ch.A4 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> super <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>R4.nopivot <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>A4<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>R4 <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> pivot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

det4 <span class="token operator">&lt;-</span> det<span class="token punctuation">(</span>A4<span class="token punctuation">)</span>
b4 <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span><span class="token number">5L</span><span class="token punctuation">)</span>
x4 <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> b4<span class="token punctuation">)</span>

stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>R4.nopivot<span class="token punctuation">,</span> expand1<span class="token punctuation">(</span>ch.A4.nopivot<span class="token punctuation">,</span> <span class="token string">"L."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>R4<span class="token punctuation">,</span> expand1<span class="token punctuation">(</span>ch.A4<span class="token punctuation">,</span> <span class="token string">"L."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> crossprod<span class="token punctuation">(</span>R4.nopivot<span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>A4<span class="token punctuation">[</span>ch.A4<span class="token operator">@</span>perm <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">,</span> ch.A4<span class="token operator">@</span>perm <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> crossprod<span class="token punctuation">(</span>R4<span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>diag<span class="token punctuation">(</span>R4.nopivot<span class="token punctuation">)</span><span class="token punctuation">,</span> sqrt<span class="token punctuation">(</span>diag<span class="token punctuation">(</span>ch.A4.nopivot<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>diag<span class="token punctuation">(</span>R4<span class="token punctuation">)</span><span class="token punctuation">,</span> sqrt<span class="token punctuation">(</span>diag<span class="token punctuation">(</span>ch.A4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>det4<span class="token punctuation">)</span><span class="token punctuation">,</span> det<span class="token punctuation">(</span>R4.nopivot<span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>det4<span class="token punctuation">)</span><span class="token punctuation">,</span> det<span class="token punctuation">(</span>R4<span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>det4<span class="token punctuation">,</span> det<span class="token punctuation">(</span>ch.A4.nopivot<span class="token punctuation">,</span> sqrt <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>det4<span class="token punctuation">,</span> det<span class="token punctuation">(</span>ch.A4<span class="token punctuation">,</span> sqrt <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>x4<span class="token punctuation">,</span> solve<span class="token punctuation">(</span>R4.nopivot<span class="token punctuation">,</span> solve<span class="token punctuation">(</span>t<span class="token punctuation">(</span>R4.nopivot<span class="token punctuation">)</span><span class="token punctuation">,</span> b4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>x4<span class="token punctuation">,</span> solve<span class="token punctuation">(</span>ch.A4.nopivot<span class="token punctuation">,</span> b4<span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>x4<span class="token punctuation">,</span> solve<span class="token punctuation">(</span>ch.A4<span class="token punctuation">,</span> b4<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="chol2inv-methods">

<a href="#chol2inv-methods" class="help-page-title"><h2 id="chol2inv-methods">Inverse from Cholesky Factor</h2></a>

<h3>Description</h3>

<p>Given <em>formally</em> upper and lower triangular matrices
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code>, compute <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>U</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>U</mi><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">(U' U)^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></code>
and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">(L L')^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></code>, respectively.
</p>
<p>This function can be seen as way to compute the inverse of a
symmetric positive definite matrix given its Cholesky factor.
Equivalently, it can be seen as a way to compute
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>X</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">(X' X)^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></code> given the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code> part
of the QR factorization of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">chol2inv<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dtrMatrix'</span>
chol2inv<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dtCMatrix'</span>
chol2inv<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'generalMatrix'</span>
chol2inv<span class="token punctuation">(</span>x<span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="chol2inv-methods_:_x">x</code></td>
<td>
<p>a square matrix or <code><a href="#Matrix-class">Matrix</a></code>,
typically the result of a call to <code><a href="#chol">chol</a></code>.
If <code>x</code> is square but not (formally) triangular,
then only the upper or lower triangle is considered,
depending on optional argument <code>uplo</code> if <code>x</code>
is a <code><a href="#Matrix-class">Matrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="chol2inv-methods_:_uplo">uplo</code></td>
<td>
<p>a string, either <code>"U"</code> or <code>"L"</code>,
indicating which triangle of <code>x</code> contains the
Cholesky factor.  The default is <code>"U"</code>, to be
consistent with <code><a href="https://r-universe.dev/manuals/base.html#chol2inv">chol2inv</a></code> from <span class="pkg">base</span>.</p>
</td>
</tr>
<tr>
<td><code id="chol2inv-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix, <code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>,
or <code><a href="#diagonalMatrix-class">diagonalMatrix</a></code> representing
the inverse of the positive definite matrix whose
Cholesky factor is <code>x</code>.
The result is a traditional matrix if <code>x</code> is a
traditional matrix, dense if <code>x</code> is dense, and
sparse if <code>x</code> is sparse.
</p>


<h3>See Also</h3>

<p>The default method from <span class="pkg">base</span>, <code><a href="https://r-universe.dev/manuals/base.html#chol2inv">chol2inv</a></code>,
called for traditional matrices <code>x</code>.
</p>
<p>Generic function <code><a href="#chol">chol</a></code>, for computing the upper
triangular Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> of a symmetric positive
semidefinite matrix.
</p>
<p>Generic function <code><a href="#solve-methods">solve</a></code>, for solving linear systems
and (as a corollary) for computing inverses more generally.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>R <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>L <span class="token operator">&lt;-</span> t<span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>R2i <span class="token operator">&lt;-</span> chol2inv<span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>L2i <span class="token operator">&lt;-</span> chol2inv<span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    all.equal<span class="token punctuation">(</span>R2i<span class="token punctuation">,</span> tcrossprod<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>L2i<span class="token punctuation">,</span>  crossprod<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>R2i <span class="token percent-operator operator">%*%</span> A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># the identity </span>
    all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>L2i <span class="token percent-operator operator">%*%</span> A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># ditto</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Cholesky-class">

<a href="#Cholesky-class" class="help-page-title"><h2 id="Cholesky-class">Dense Cholesky Factorizations</h2></a>

<h3>Description</h3>

<p>Classes <code>Cholesky</code> and <code>pCholesky</code> represent
dense, pivoted Cholesky factorizations of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
real, symmetric, positive semidefinite matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
having the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">P_{1} A P_{1}' = L_{1} D L_{1}' = L L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A = P_{1}' L_{1} D L_{1}' P_{1} = P_{1}' L L' P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is a permutation matrix,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">L_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is a unit lower triangular matrix,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code> is a non-negative diagonal matrix, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><msqrt><mi>D</mi></msqrt></mrow><annotation encoding="application/x-tex">L = L_{1} \sqrt{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0767em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9267em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-2.8867em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1133em;"><span></span></span></span></span></span></span></span></span></code>.
</p>
<p>These classes store the entries of the Cholesky factor
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> or its transpose <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> in a dense format as
a vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">nn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">nn</span></span></span></span></code> (<code>Cholesky</code>) or
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n(n+1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code> (<code>pCholesky</code>), the latter
giving the “packed” representation.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>, <code>Dimnames</code>
</dt>
<dd>
<p>inherited from virtual class
<code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>.</p>
</dd>
<dt><code>uplo</code></dt>
<dd>
<p>a string, either <code>"U"</code> or <code>"L"</code>,
indicating which triangle (upper or lower) of the factorized
symmetric matrix was used to compute the factorization and
in turn whether <code>x</code> stores <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code>.</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>a numeric vector of length <code>n*n</code>
(<code>Cholesky</code>) or <code>n*(n+1)/2</code> (<code>pCholesky</code>),
where <code>n=Dim[1]</code>, listing the entries of the Cholesky
factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> or its transpose <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> in column-major
order.</p>
</dd>
<dt><code>perm</code></dt>
<dd>
<p>a 1-based integer vector of length <code>Dim[1]</code>
specifying the permutation applied to the rows and columns
of the factorized matrix.  <code>perm</code> of length 0 is valid and
equivalent to the identity permutation, implying no pivoting.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code><a href="#MatrixFactorization-class">CholeskyFactorization</a></code>, directly.
Class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>, by class
<code><a href="#MatrixFactorization-class">CholeskyFactorization</a></code>, distance 2.
</p>


<h3>Instantiation</h3>

<p>Objects can be generated directly by calls of the form
<code>new("Cholesky", ...)</code> or <code>new("pCholesky", ...)</code>,
but they are more typically obtained as the value of
<code><a href="#Cholesky">Cholesky</a>(x)</code> for <code>x</code> inheriting from
<code><a href="#dsyMatrix-class">dsyMatrix</a></code> or <code><a href="#dsyMatrix-class">dspMatrix</a></code>
(often the subclasses of those reserved for positive
semidefinite matrices, namely <code><a href="#dpoMatrix-class">dpoMatrix</a></code>
and <code><a href="#dpoMatrix-class">dppMatrix</a></code>).
</p>


<h3>Methods</h3>


<dl>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "Cholesky", to = "dtrMatrix")</code>:
returns a <code><a href="#dtrMatrix-class">dtrMatrix</a></code> representing
the Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> or its transpose <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>;
see ‘Note’.</p>
</dd>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "pCholesky", to = "dtpMatrix")</code>:
returns a <code><a href="#dtpMatrix-class">dtpMatrix</a></code> representing
the Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> or its transpose <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>;
see ‘Note’.</p>
</dd>
<dt><code>determinant</code></dt>
<dd>
<p><code>signature(from = "p?Cholesky", logarithm = "logical")</code>:
computes the determinant of the factorized matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>
or its logarithm.</p>
</dd>
<dt><code>diag</code></dt>
<dd>
<p><code>signature(x = "p?Cholesky")</code>:
returns a numeric vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> containing the diagonal
elements of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code>, which are the squared diagonal elements of
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code>.</p>
</dd>
<dt><code>expand1</code></dt>
<dd>
<p><code>signature(x = "p?Cholesky")</code>:
see <code><a href="#expand">expand1-methods</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "p?Cholesky")</code>:
see <code><a href="#expand">expand2-methods</a></code>.</p>
</dd>
<dt><code>solve</code></dt>
<dd>
<p><code>signature(a = "p?Cholesky", b = .)</code>:
see <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
</dl>
<h3>Note</h3>

<p>In <span class="pkg">Matrix</span> <code>&lt; 1.6-0</code>, class <code>Cholesky</code> extended
<code><a href="#dtrMatrix-class">dtrMatrix</a></code> and class <code>pCholesky</code> extended
<code><a href="#dtpMatrix-class">dtpMatrix</a></code>, reflecting the fact that the factor
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> is indeed a triangular matrix.
<span class="pkg">Matrix</span> <code>1.6-0</code> removed these extensions so that methods
would no longer be inherited from <code>dtrMatrix</code> and <code>dtpMatrix</code>.  
The availability of such methods gave the wrong impression that
<code>Cholesky</code> and <code>pCholesky</code> represent a (singular)
matrix, when in fact they represent an ordered set of matrix factors.
</p>
<p>The coercions <code>as(., "dtrMatrix")</code> and <code>as(., "dtpMatrix")</code>
are provided for users who understand the caveats.
</p>


<h3>References</h3>

<p>The LAPACK source code, including documentation; see
<a href="https://netlib.org/lapack/double/dpstrf.f" target="_blank">https://netlib.org/lapack/double/dpstrf.f</a>,
<a href="https://netlib.org/lapack/double/dpotrf.f" target="_blank">https://netlib.org/lapack/double/dpotrf.f</a>, and
<a href="https://netlib.org/lapack/double/dpptrf.f" target="_blank">https://netlib.org/lapack/double/dpptrf.f</a>.
</p>
<p>Lucas, C. (2004).
<em>LAPACK-style codes for level 2 and 3 pivoted Cholesky factorizations</em>.
LAPACK Working Note, Number 161.
<a href="https://www.netlib.org/lapack/lawnspdf/lawn161.pdf" target="_blank">https://www.netlib.org/lapack/lawnspdf/lawn161.pdf</a>
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Class <code><a href="#CHMfactor-class">CHMfactor</a></code> for sparse Cholesky factorizations.
</p>
<p>Classes <code><a href="#dpoMatrix-class">dpoMatrix</a></code> and <code><a href="#dpoMatrix-class">dppMatrix</a></code>.
</p>
<p>Generic functions <code><a href="#Cholesky">Cholesky</a></code>,
<code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"Cholesky"</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

m <span class="token operator">&lt;-</span> <span class="token number">30L</span>
n <span class="token operator">&lt;-</span> <span class="token number">6L</span>
<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>m <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## With dimnames, to see that they are propagated :</span>
dimnames<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> dn <span class="token operator">&lt;-</span> rep.int<span class="token punctuation">(</span>list<span class="token punctuation">(</span>paste0<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>ch.A <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># pivoted, by default</span>
str<span class="token punctuation">(</span>e.ch.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span> LDL <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>E.ch.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>

<span class="token comment">## Underlying LAPACK representation</span>
<span class="token punctuation">(</span>m.ch.A <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span> <span class="token string">"dtrMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># which is L', not L, because</span>
A<span class="token operator">@</span>uplo <span class="token operator">==</span> <span class="token string">"U"</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>as<span class="token punctuation">(</span>m.ch.A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> `dim<span class="token operator">&lt;-</span>`<span class="token punctuation">(</span>ch.A<span class="token operator">@</span>x<span class="token punctuation">,</span> ch.A<span class="token operator">@</span>Dim<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ae1 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
ae2 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> ae1<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> unname<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ P1' L1 D L1' P1 ~ P1' L L' P1 in floating point</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"P1."</span><span class="token punctuation">,</span> <span class="token string">"L1"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"L1."</span><span class="token punctuation">,</span> <span class="token string">"P1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"P1."</span><span class="token punctuation">,</span> <span class="token string">"L"</span> <span class="token punctuation">,</span>      <span class="token string">"L."</span> <span class="token punctuation">,</span> <span class="token string">"P1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              new<span class="token punctuation">(</span><span class="token string">"pMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> Dimnames <span class="token operator">=</span> c<span class="token punctuation">(</span>list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dn<span class="token punctuation">[</span><span class="token number">2L</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  margin <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">,</span> perm <span class="token operator">=</span> invertPerm<span class="token punctuation">(</span>ch.A<span class="token operator">@</span>perm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L1."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L1"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L."</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"D"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> diag<span class="token punctuation">(</span>ch.A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">,</span> L1 <span class="token percent-operator operator">%*%</span> sqrt<span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae1<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> L1 <span class="token percent-operator operator">%*%</span> D <span class="token percent-operator operator">%*%</span> L1. <span class="token percent-operator operator">%*%</span> P1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae1<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> L  <span class="token percent-operator operator">%*%</span>         L.  <span class="token percent-operator operator">%*%</span> P1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>A<span class="token punctuation">[</span>ch.A<span class="token operator">@</span>perm<span class="token punctuation">,</span> ch.A<span class="token operator">@</span>perm<span class="token punctuation">]</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.ch.A<span class="token punctuation">,</span> L1 <span class="token percent-operator operator">%*%</span> D <span class="token percent-operator operator">%*%</span> L1.<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>A<span class="token punctuation">[</span>ch.A<span class="token operator">@</span>perm<span class="token punctuation">,</span> ch.A<span class="token operator">@</span>perm<span class="token punctuation">]</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>E.ch.A<span class="token punctuation">,</span> L  <span class="token percent-operator operator">%*%</span>         L. <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Factorization handled as factorized matrix</span>
b <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
all.equal<span class="token punctuation">(</span>det<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> det<span class="token punctuation">(</span>ch.A<span class="token punctuation">)</span><span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
all.equal<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> solve<span class="token punctuation">(</span>ch.A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">## For identical results, we need the _unpivoted_ factorization</span>
<span class="token comment">## computed by det(A) and solve(A, b)</span>
<span class="token punctuation">(</span>ch.A.nopivot <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>det<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> det<span class="token punctuation">(</span>ch.A.nopivot<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> solve<span class="token punctuation">(</span>ch.A.nopivot<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Cholesky">

<a href="#Cholesky" class="help-page-title"><h2 id="Cholesky-methods">Methods for Cholesky Factorization</h2></a>

<h3>Description</h3>

<p>Computes the pivoted Cholesky factorization of an
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> real, symmetric matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
which has the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo><mover><mo><mo>=</mo></mo><mrow><msub><mi>D</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub><mo>≥</mo><mn>0</mn></mrow></mover></mo><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">P_1 A P_1' = L_1 D L_1' \overset{D_{jj} \ge 0}{=} L L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.5016em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2535em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.6752em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">jj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mrel mtight">≥</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>P</mi><mn>1</mn></msub><mo><mover><mo><mo>=</mo></mo><mrow><msub><mi>D</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub><mo>≥</mo><mn>0</mn></mrow></mover></mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A = P_1' L_1 D L_1' P_1 \overset{D_{jj} \ge 0}{=} P_1' L L' P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.5016em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2535em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.6752em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">jj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mrel mtight">≥</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is a permutation matrix,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">L_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is a unit lower triangular matrix,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code> is a diagonal matrix, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><msqrt><mi>D</mi></msqrt></mrow><annotation encoding="application/x-tex">L = L_1 \sqrt{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0767em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9267em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-2.8867em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1133em;"><span></span></span></span></span></span></span></span></span></code>.
The second equalities hold only for positive semidefinite <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
for which the diagonal entries of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code> are non-negative
and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>D</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1133em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9267em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-2.8867em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1133em;"><span></span></span></span></span></span></span></span></span></code> is well-defined.
</p>
<p>Methods for <code><a href="#denseMatrix-class">denseMatrix</a></code> are built on
LAPACK routines <code>dpstrf</code>, <code>dpotrf</code>, and <code>dpptrf</code>.
The latter two do not permute rows or columns,
so that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is an identity matrix.
</p>
<p>Methods for <code><a href="#sparseMatrix-class">sparseMatrix</a></code> are built on
CHOLMOD routines <code>cholmod_analyze</code> and <code>cholmod_factorize_p</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsyMatrix'</span>
Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dspMatrix'</span>
Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsCMatrix'</span>
Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token operator">!</span>super<span class="token punctuation">,</span> super <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
    Imult <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'ddiMatrix'</span>
Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'generalMatrix'</span>
Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'triangularMatrix'</span>
Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'matrix'</span>
Cholesky<span class="token punctuation">(</span>A<span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="Cholesky-methods_:_A">A</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a>, symmetric matrix or
<code><a href="#Matrix-class">Matrix</a></code> to be factorized.  If <code>A</code>
is square but not symmetric, then it will be <em>treated</em>
as symmetric; see <code>uplo</code>.
Methods for dense <code>A</code> require positive definiteness
when <code>perm = FALSE</code> and positive semidefiniteness
when <code>perm = TRUE</code>.
Methods for sparse <code>A</code> require positive definiteness
when <code>LDL = TRUE</code> and nonzero leading principal minors
(after pivoting) when <code>LDL = FALSE</code>.
Methods for sparse, <em>diagonal</em> <code>A</code> are an exception,
requiring positive semidefiniteness unconditionally.</p>
</td>
</tr>
<tr>
<td><code id="Cholesky-methods_:_perm">perm</code></td>
<td>
<p>a logical indicating if the rows and columns
of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> should be pivoted.  Methods for sparse <code>A</code>
employ the approximate minimum degree (AMD) algorithm
in order to reduce fill-in, i.e., without regard for
numerical stability.
Pivoting for sparsity may introduce nonpositive leading
principal minors, causing the factorization to fail, in
which case it may be necessary to set <code>perm = FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="Cholesky-methods_:_tol">tol</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a> numeric tolerance,
used only if <code>perm = TRUE</code>.
The factorization algorithm stops if the pivot is less than
or equal to <code>tol</code>.  Negative <code>tol</code> is equivalent
to <code>nrow(A) * .Machine$double.eps * max(diag(A))</code>.</p>
</td>
</tr>
<tr>
<td><code id="Cholesky-methods_:_LDL">LDL</code></td>
<td>
<p>a logical indicating if the simplicial factorization
should be computed as
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1' L_1 D L_1' P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>,
such that the result stores the lower triangular entries
of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mo>−</mo><mi>I</mi><mo>+</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">L_1-I+D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code>.
The alternative is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1' L L' P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>,
such that the result stores the lower triangular entries
of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><msqrt><mi>D</mi></msqrt></mrow><annotation encoding="application/x-tex">L = L_1 \sqrt{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0767em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9267em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-2.8867em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1133em;"><span></span></span></span></span></span></span></span></span></code>.  This argument
is ignored if <code>super = TRUE</code> (or if <code>super = NA</code>
and the supernodal algorithm is chosen), as the supernodal
code does not yet support the <code>LDL = TRUE</code> variant.</p>
</td>
</tr>
<tr>
<td><code id="Cholesky-methods_:_super">super</code></td>
<td>
<p>a logical indicating if the factorization should
use the supernodal algorithm.  The alternative is the simplicial
algorithm.  Setting <code>super = NA</code> leaves the choice to
a CHOLMOD-internal heuristic.</p>
</td>
</tr>
<tr>
<td><code id="Cholesky-methods_:_Imult">Imult</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a> number. The matrix
that is factorized is <code>A + Imult * diag(nrow(A))</code>,
i.e., <code>A</code> plus <code>Imult</code> times the identity matrix.
This argument is useful for symmetric, indefinite <code>A</code>,
as <code>Imult &gt; max(rowSums(abs(A)) - diag(abs(A)))</code> ensures
that <code>A + Imult * diag(nrow(A))</code> is diagonally dominant.
(Symmetric, diagonally dominant matrices are positive definite.)</p>
</td>
</tr>
<tr>
<td><code id="Cholesky-methods_:_uplo">uplo</code></td>
<td>
<p>a string, either <code>"U"</code> or <code>"L"</code>,
indicating which triangle of <code>A</code> should be used
to compute the factorization.  The default is <code>"U"</code>,
even for lower triangular <code>A</code>, to be consistent with
<code><a href="https://r-universe.dev/manuals/base.html#chol">chol</a></code> from <span class="pkg">base</span>.</p>
</td>
</tr>
<tr>
<td><code id="Cholesky-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the result of a call to <code>Cholesky</code> inherits
from <code><a href="#MatrixFactorization-class">CholeskyFactorization</a></code> but not
<code><a href="#Matrix-class">Matrix</a></code>.  Users who just want a matrix
should consider using <code><a href="#chol">chol</a></code>, whose methods are
simple wrappers around <code>Cholesky</code> returning just the
upper triangular Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>,
typically as a <code><a href="#triangularMatrix-class">triangularMatrix</a></code>.
However, a more principled approach would be to construct
factors as needed from the <code>CholeskyFactorization</code> object,
e.g., with <code><a href="#expand">expand1</a>(x, "L")</code>, if <code>x</code> is the
object.
</p>
<p>The behaviour of <code>Cholesky(A, perm = TRUE)</code> for dense <code>A</code>
is somewhat exceptional, in that it expects <em>without</em> checking
that <code>A</code> is positive semidefinite.  By construction, if <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>
is positive semidefinite and the exact algorithm encounters a zero
pivot, then the unfactorized trailing submatrix is the zero matrix,
and there is nothing left to do.  Hence when the finite precision
algorithm encounters a pivot less than <code>tol</code>, it signals a
warning instead of an error and zeros the trailing submatrix in
order to guarantee that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>P</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>P</mi></mrow><annotation encoding="application/x-tex">P' L L' P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></code> is positive
semidefinite even if <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> is not.  It follows that one way to
test for positive semidefiniteness of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> in the event of a
warning is to analyze the error
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mo stretchy="false">∥</mo><mi>A</mi><mo>−</mo><msup><mi>P</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>P</mi><mo stretchy="false">∥</mo></mrow><mrow><mo stretchy="false">∥</mo><mi>A</mi><mo stretchy="false">∥</mo></mrow></mfrac><mtext> </mtext><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\lVert A - P' L L' P \rVert}{\lVert A \rVert}\,.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5845em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0645em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">∥</span><span class="mord mathnormal mtight">A</span><span class="mclose mtight">∥</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">∥</span><span class="mord mathnormal mtight">A</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal mtight">L</span><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mclose mtight">∥</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">.</span></span></span></span></code>
</p>

<p>See the examples and LAPACK Working Note (“LAWN”) 161
for details.
</p>


<h3>Value</h3>

<p>An object representing the factorization, inheriting from
virtual class <code><a href="#MatrixFactorization-class">CholeskyFactorization</a></code>.
For a traditional matrix <code>A</code>, the specific class is
<code><a href="#Cholesky-class">Cholesky</a></code>.
For <code>A</code> inheriting from
<code><a href="#unpackedMatrix-class">unpackedMatrix</a></code>,
<code><a href="#packedMatrix-class">packedMatrix</a></code>, and
<code><a href="#sparseMatrix-class">sparseMatrix</a></code>,
the specific class is
<code><a href="#Cholesky-class">Cholesky</a></code>,
<code><a href="#Cholesky-class">pCholesky</a></code>, and
<code><a href="#CHMfactor-class">dCHMsimpl</a></code> or <code><a href="#CHMfactor-class">dCHMsuper</a></code>,
respectively.
</p>


<h3>References</h3>

<p>The LAPACK source code, including documentation; see
<a href="https://netlib.org/lapack/double/dpstrf.f" target="_blank">https://netlib.org/lapack/double/dpstrf.f</a>,
<a href="https://netlib.org/lapack/double/dpotrf.f" target="_blank">https://netlib.org/lapack/double/dpotrf.f</a>, and
<a href="https://netlib.org/lapack/double/dpptrf.f" target="_blank">https://netlib.org/lapack/double/dpptrf.f</a>.
</p>
<p>The CHOLMOD source code; see
<a href="https://github.com/DrTimothyAldenDavis/SuiteSparse" target="_blank">https://github.com/DrTimothyAldenDavis/SuiteSparse</a>,
notably the header file ‘<span class="file">CHOLMOD/Include/cholmod.h</span>’
defining <code>cholmod_factor_struct</code>.
</p>
<p>Lucas, C. (2004).
<em>LAPACK-style codes for level 2 and 3 pivoted Cholesky factorizations</em>.
LAPACK Working Note, Number 161.
<a href="https://www.netlib.org/lapack/lawnspdf/lawn161.pdf" target="_blank">https://www.netlib.org/lapack/lawnspdf/lawn161.pdf</a>
</p>
<p>Chen, Y., Davis, T. A., Hager, W. W., &amp; Rajamanickam, S. (2008).
Algorithm 887: CHOLMOD, supernodal sparse Cholesky factorization
and update/downdate.
<em>ACM Transactions on Mathematical Software</em>,
<em>35</em>(3), Article 22, 1-14.
<a href="https://doi.org/10.1145/1391989.1391995" target="_blank">doi:10.1145/1391989.1391995</a>
</p>
<p>Amestoy, P. R., Davis, T. A., &amp; Duff, I. S. (2004).
Algorithm 837: AMD, an approximate minimum degree ordering algorithm.
<em>ACM Transactions on Mathematical Software</em>,
<em>17</em>(4), 886-905.
<a href="https://doi.org/10.1145/1024074.1024081" target="_blank">doi:10.1145/1024074.1024081</a>
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Classes <code><a href="#Cholesky-class">Cholesky</a></code>, <code><a href="#Cholesky-class">pCholesky</a></code>,
<code><a href="#CHMfactor-class">dCHMsimpl</a></code> and <code><a href="#CHMfactor-class">dCHMsuper</a></code>
and their methods.
</p>
<p>Classes <code><a href="#dpoMatrix-class">dpoMatrix</a></code>, <code><a href="#dpoMatrix-class">dppMatrix</a></code>,
and <code><a href="#dsCMatrix-class">dsCMatrix</a></code>.
</p>
<p>Generic function <code><a href="#chol">chol</a></code>,
for obtaining the upper triangular Cholesky factor <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> as a
matrix or <code><a href="#Matrix-class">Matrix</a></code>.
</p>
<p>Generic functions <code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>,
for constructing matrix factors from the result.
</p>
<p>Generic functions <code><a href="#BunchKaufman-methods">BunchKaufman</a></code>, <code><a href="#Schur">Schur</a></code>,
<code><a href="#lu">lu</a></code>, and <code><a href="#qr-methods">qr</a></code>,
for computing other factorizations.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span><span class="token string">"Cholesky"</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">## ---- Dense ----------------------------------------------------------</span>

<span class="token comment">## .... Positive definite ..............................................</span>

n <span class="token operator">&lt;-</span> <span class="token number">6L</span>
<span class="token punctuation">(</span>A1 <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>n <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>ch.A1.nopivot <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A1<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>ch.A1 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A1<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    length<span class="token punctuation">(</span>ch.A1<span class="token operator">@</span>perm<span class="token punctuation">)</span> <span class="token operator">==</span> ncol<span class="token punctuation">(</span>A1<span class="token punctuation">)</span>
    isPerm<span class="token punctuation">(</span>ch.A1<span class="token operator">@</span>perm<span class="token punctuation">)</span>
    is.unsorted<span class="token punctuation">(</span>ch.A1<span class="token operator">@</span>perm<span class="token punctuation">)</span> <span class="token comment"># typically not the identity permutation</span>
    length<span class="token punctuation">(</span>ch.A1.nopivot<span class="token operator">@</span>perm<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0L</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ P1' L D L' P1 ~ P1' L L' P1 in floating point</span>
str<span class="token punctuation">(</span>e.ch.A1 <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>ch.A1<span class="token punctuation">,</span> LDL <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>E.ch.A1 <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>ch.A1<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A1<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> e.ch.A1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A1<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> E.ch.A1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## .... Positive semidefinite but not positive definite ................</span>

A2 <span class="token operator">&lt;-</span> A1
A2<span class="token punctuation">[</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token operator">&lt;-</span> A2<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
A2
try<span class="token punctuation">(</span>Cholesky<span class="token punctuation">(</span>A2<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># fails as not positive definite</span>
ch.A2 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A2<span class="token punctuation">)</span> <span class="token comment"># returns, with a warning and ...</span>
A2.hat <span class="token operator">&lt;-</span> Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> expand2<span class="token punctuation">(</span>ch.A2<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
norm<span class="token punctuation">(</span>A2 <span class="token operator">-</span> A2.hat<span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token operator">/</span> norm<span class="token punctuation">(</span>A2<span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token comment"># 7.670858e-17</span>

<span class="token comment">## .... Not positive semidefinite ......................................</span>

A3 <span class="token operator">&lt;-</span> A1
A3<span class="token punctuation">[</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token operator">&lt;-</span> A3<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token operator">-</span><span class="token number">1</span>
A3
try<span class="token punctuation">(</span>Cholesky<span class="token punctuation">(</span>A3<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># fails as not positive definite</span>
ch.A3 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A3<span class="token punctuation">)</span> <span class="token comment"># returns, with a warning and ...</span>
A3.hat <span class="token operator">&lt;-</span> Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> expand2<span class="token punctuation">(</span>ch.A3<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
norm<span class="token punctuation">(</span>A3 <span class="token operator">-</span> A3.hat<span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token operator">/</span> norm<span class="token punctuation">(</span>A3<span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token comment"># 1.781568</span>

<span class="token comment">## Indeed, 'A3' is not positive semidefinite, but 'A3.hat' _is_</span>
ch.A3.hat <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A3.hat<span class="token punctuation">)</span>
A3.hat.hat <span class="token operator">&lt;-</span> Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> expand2<span class="token punctuation">(</span>ch.A3.hat<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
norm<span class="token punctuation">(</span>A3.hat <span class="token operator">-</span> A3.hat.hat<span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token operator">/</span> norm<span class="token punctuation">(</span>A3.hat<span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token comment"># 1.777944e-16</span>

<span class="token comment">## ---- Sparse ---------------------------------------------------------</span>

<span class="token comment">## Really just three cases modulo permutation :</span>
<span class="token comment">##</span>
<span class="token comment">##            type        factorization  minors of P1 A P1'</span>
<span class="token comment">##   1  simplicial  P1 A P1' = L1 D L1'             nonzero</span>
<span class="token comment">##   2  simplicial  P1 A P1' = L    L '            positive</span>
<span class="token comment">##   3  supernodal  P1 A P2' = L    L '            positive</span>

data<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
A4 <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>KNex<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"mm"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

ch.A4 <span class="token operator">&lt;-</span>
list<span class="token punctuation">(</span>pivoted <span class="token operator">=</span>
     list<span class="token punctuation">(</span>simpl1 <span class="token operator">=</span> Cholesky<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> perm <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">,</span> super <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> LDL <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          simpl0 <span class="token operator">=</span> Cholesky<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> perm <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">,</span> super <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          super0 <span class="token operator">=</span> Cholesky<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> perm <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">,</span> super <span class="token operator">=</span>  <span class="token boolean">TRUE</span>             <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     unpivoted <span class="token operator">=</span>
     list<span class="token punctuation">(</span>simpl1 <span class="token operator">=</span> Cholesky<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> super <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> LDL <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          simpl0 <span class="token operator">=</span> Cholesky<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> super <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          super0 <span class="token operator">=</span> Cholesky<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> super <span class="token operator">=</span>  <span class="token boolean">TRUE</span>             <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ch.A4

s <span class="token operator">&lt;-</span> simplify2array
rapply2 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> f<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> rapply<span class="token punctuation">(</span>object<span class="token punctuation">,</span> f<span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token punctuation">,</span> how <span class="token operator">=</span> <span class="token string">"list"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

s<span class="token punctuation">(</span>rapply2<span class="token punctuation">(</span>ch.A4<span class="token punctuation">,</span> isLDL<span class="token punctuation">)</span><span class="token punctuation">)</span>
s<span class="token punctuation">(</span>m.ch.A4 <span class="token operator">&lt;-</span> rapply2<span class="token punctuation">(</span>ch.A4<span class="token punctuation">,</span> expand1<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># giving L = L1 sqrt(D)</span>

<span class="token comment">## By design, the pivoted and simplicial factorizations</span>
<span class="token comment">## are more sparse than the unpivoted and supernodal ones ...</span>
s<span class="token punctuation">(</span>rapply2<span class="token punctuation">(</span>m.ch.A4<span class="token punctuation">,</span> object.size<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Which is nicely visualized by lattice-based methods for 'image'</span>
inm <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"pivoted"</span><span class="token punctuation">,</span> <span class="token string">"unpivoted"</span><span class="token punctuation">)</span>
jnm <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"simpl1"</span><span class="token punctuation">,</span> <span class="token string">"simpl0"</span><span class="token punctuation">,</span> <span class="token string">"super0"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>image<span class="token punctuation">(</span>m.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span>c<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> main <span class="token operator">=</span> paste<span class="token punctuation">(</span>inm<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> jnm<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            split <span class="token operator">=</span> c<span class="token punctuation">(</span>j<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> more <span class="token operator">=</span> i <span class="token operator">*</span> j <span class="token operator">&lt;</span> <span class="token number">6L</span><span class="token punctuation">)</span>

simpl1 <span class="token operator">&lt;-</span> ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token string">"pivoted"</span><span class="token punctuation">,</span> <span class="token string">"simpl1"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    length<span class="token punctuation">(</span>simpl1<span class="token operator">@</span>perm<span class="token punctuation">)</span> <span class="token operator">==</span> ncol<span class="token punctuation">(</span>A4<span class="token punctuation">)</span>
    isPerm<span class="token punctuation">(</span>simpl1<span class="token operator">@</span>perm<span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">)</span>
    is.unsorted<span class="token punctuation">(</span>simpl1<span class="token operator">@</span>perm<span class="token punctuation">)</span> <span class="token comment"># typically not the identity permutation</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## One can expand with and without D regardless of isLDL(.),</span>
<span class="token comment">## but "without" requires L = L1 sqrt(D), which is conditional</span>
<span class="token comment">## on min(diag(D)) &gt;= 0, hence "with" is the default</span>
isLDL<span class="token punctuation">(</span>simpl1<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>min<span class="token punctuation">(</span>diag<span class="token punctuation">(</span>simpl1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>e.ch.A4 <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>simpl1<span class="token punctuation">,</span> LDL <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span> <span class="token comment"># default</span>
str<span class="token punctuation">(</span>E.ch.A4 <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>simpl1<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    all.equal<span class="token punctuation">(</span>E.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> e.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L1"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token percent-operator operator">%*%</span> sqrt<span class="token punctuation">(</span>e.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"D"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>E.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sqrt<span class="token punctuation">(</span>e.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"D"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%*%</span> e.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L1."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> as<span class="token punctuation">(</span>Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> e.ch.A4<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> as<span class="token punctuation">(</span>Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> E.ch.A4<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## The "same" permutation matrix with "alternate" representation</span>
<span class="token comment">## [i, perm[i]] {margin=1} &lt;-&gt; [invertPerm(perm)[j], j] {margin=2}</span>
alt <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    P<span class="token operator">@</span>margin <span class="token operator">&lt;-</span> <span class="token number">1L</span> <span class="token operator">+</span> <span class="token operator">!</span><span class="token punctuation">(</span>P<span class="token operator">@</span>margin <span class="token operator">-</span> <span class="token number">1L</span><span class="token punctuation">)</span> <span class="token comment"># 1 &lt;-&gt; 2</span>
    P<span class="token operator">@</span>perm <span class="token operator">&lt;-</span> invertPerm<span class="token punctuation">(</span>P<span class="token operator">@</span>perm<span class="token punctuation">)</span>
    P
<span class="token punctuation">}</span>

<span class="token comment">## Expansions are elegant but inefficient (transposes are redundant)</span>
<span class="token comment">## hence programmers should consider methods for 'expand1' and 'diag'</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>expand1<span class="token punctuation">(</span>simpl1<span class="token punctuation">,</span> <span class="token string">"P1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alt<span class="token punctuation">(</span>e.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>expand1<span class="token punctuation">(</span>simpl1<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> E.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> diag<span class="token punctuation">(</span>simpl1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"D"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## chol(A, pivot = value) is a simple wrapper around</span>
<span class="token comment">## Cholesky(A, perm = value, LDL = FALSE, super = FALSE),</span>
<span class="token comment">## returning L' = sqrt(D) L1' _but_ giving no information</span>
<span class="token comment">## about the permutation P1</span>
selectMethod<span class="token punctuation">(</span><span class="token string">"chol"</span><span class="token punctuation">,</span> <span class="token string">"dsCMatrix"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>chol<span class="token punctuation">(</span>A4<span class="token punctuation">,</span> pivot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> E.ch.A4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Now a symmetric matrix with positive _and_ negative eigenvalues,</span>
<span class="token comment">## hence _not_ positive semidefinite</span>
A5 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dsCMatrix"</span><span class="token punctuation">,</span>
          Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">7L</span><span class="token punctuation">,</span> <span class="token number">7L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          p <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">247</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">67</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>ev <span class="token operator">&lt;-</span> eigen<span class="token punctuation">(</span>A5<span class="token punctuation">,</span> only.values <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>values<span class="token punctuation">)</span>
<span class="token punctuation">(</span>t.ev <span class="token operator">&lt;-</span> table<span class="token punctuation">(</span>factor<span class="token punctuation">(</span>sign<span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># the matrix "inertia"</span>

ch.A5 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A5<span class="token punctuation">)</span>
isLDL<span class="token punctuation">(</span>ch.A5<span class="token punctuation">)</span>
<span class="token punctuation">(</span>d.A5 <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span>ch.A5<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># diag(D) is partly negative</span>

<span class="token comment">## Sylvester's law of inertia holds here, but not in general</span>
<span class="token comment">## in finite precision arithmetic</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>table<span class="token punctuation">(</span>factor<span class="token punctuation">(</span>sign<span class="token punctuation">(</span>d.A5<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t.ev<span class="token punctuation">)</span><span class="token punctuation">)</span>

try<span class="token punctuation">(</span>expand1<span class="token punctuation">(</span>ch.A5<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token comment"># unable to compute L = L1 sqrt(D)</span>
try<span class="token punctuation">(</span>expand2<span class="token punctuation">(</span>ch.A5<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># ditto</span>
try<span class="token punctuation">(</span>chol<span class="token punctuation">(</span>A5<span class="token punctuation">,</span> pivot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment"># ditto</span>

<span class="token comment">## The default expansion is "square root free" and still works here</span>
str<span class="token punctuation">(</span>e.ch.A5 <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>ch.A5<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>A5<span class="token punctuation">,</span> as<span class="token punctuation">(</span>Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> e.ch.A5<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Version of the SuiteSparse library, which includes CHOLMOD</span>
.SuiteSparse_version<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="graph2T">

<a href="#graph2T" class="help-page-title"><h2 id="coerce-methods-graph">Conversions "graph" &lt;–&gt; (sparse) Matrix</h2></a>

<h3>Description</h3>

<p>Since 2005, package <span class="pkg">Matrix</span> has supported coercions to and
from class <code><a>graph</a></code> from package
<a href="https://bioconductor.org/packages/graph/" target="_blank"><span class="pkg">graph</span></a>.
Since 2013, this functionality has been exposed via functions
<code>T2graph</code> and <code>graph2T</code>, which, unlike methods for
<code><a href="https://r-universe.dev/manuals/methods.html#as">as</a>(from, "&lt;Class&gt;")</code>, support optional arguments.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">graph2T<span class="token punctuation">(</span>from<span class="token punctuation">,</span> use.weights <span class="token operator">=</span> <span class="token punctuation">)</span>
T2graph<span class="token punctuation">(</span>from<span class="token punctuation">,</span> need.uniq <span class="token operator">=</span> is_not_uniqT<span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">,</span> edgemode <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="coerce-methods-graph_:_from">from</code></td>
<td>
<p>for <code>graph2T()</code>, an <span class="rlang"><b>R</b></span> object of class
<code>"graph"</code>; <br>
for <code>T2graph()</code>, a sparse matrix inheriting from
<code>"<a href="#TsparseMatrix-class">TsparseMatrix</a>"</code>.</p>
</td>
</tr>
<tr>
<td><code id="coerce-methods-graph_:_use.weights">use.weights</code></td>
<td>
<p>logical indicating if weights should be used, i.e.,
equivalently the result will be numeric, i.e. of class
<code><a href="#dgTMatrix-class">dgTMatrix</a></code>; otherwise the result will be
<code><a href="#nsparseMatrix-classes">ngTMatrix</a></code> or <code><a href="#nsparseMatrix-classes">nsTMatrix</a></code>,
the latter if the graph is undirected.  The default looks if there
are weights in the graph, and if any differ from <code>1</code>, weights
are used.</p>
</td>
</tr>
<tr>
<td><code id="coerce-methods-graph_:_need.uniq">need.uniq</code></td>
<td>
<p>a logical indicating if <code>from</code> may need to be
internally “uniqified”; do not set this and hence rather use
the default, unless you know what you are doing!</p>
</td>
</tr>
<tr>
<td><code id="coerce-methods-graph_:_edgemode">edgemode</code></td>
<td>
<p>one of <code>NULL</code>, <code>"directed"</code>, or
<code>"undirected"</code>.  The default <code>NULL</code> looks if the matrix is
symmetric and assumes <code>"undirected"</code> in that case.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>graph2T()</code>, a sparse matrix  inheriting from
<code>"<a href="#TsparseMatrix-class">TsparseMatrix</a>"</code>.
</p>
<p>For <code>T2graph()</code> an <span class="rlang"><b>R</b></span> object of class <code>"graph"</code>.
</p>


<h3>See Also</h3>

<p>Package <a href="https://CRAN.R-project.org/package=igraph" target="_blank"><span class="pkg">igraph</span></a>, which provides similar coercions
to and from its class <code>igraph</code> via functions
<code>graph_from_adjacency_matrix</code> and <code>as_adjacency_matrix</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token keyword">if</span><span class="token punctuation">(</span>requireNamespace<span class="token punctuation">(</span><span class="token string">"graph"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  n4 <span class="token operator">&lt;-</span> LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> dns <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>n4<span class="token punctuation">,</span>n4<span class="token punctuation">)</span>
  show<span class="token punctuation">(</span>a1 <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   j<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>    dimnames<span class="token operator">=</span>dns<span class="token punctuation">)</span><span class="token punctuation">)</span>
  show<span class="token punctuation">(</span>g1 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>a1<span class="token punctuation">,</span> <span class="token string">"graph"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># directed</span>
  unlist<span class="token punctuation">(</span>graph<span class="token operator">::</span>edgeWeights<span class="token punctuation">(</span>g1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># all '2'</span>

  show<span class="token punctuation">(</span>a2 <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> dimnames<span class="token operator">=</span>dns<span class="token punctuation">)</span><span class="token punctuation">)</span>
  show<span class="token punctuation">(</span>g2 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>a2<span class="token punctuation">,</span> <span class="token string">"graph"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># directed</span>
  <span class="token comment"># now if you want it undirected:</span>
  show<span class="token punctuation">(</span>g3  <span class="token operator">&lt;-</span> T2graph<span class="token punctuation">(</span>as<span class="token punctuation">(</span>a2<span class="token punctuation">,</span><span class="token string">"TsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> edgemode<span class="token operator">=</span><span class="token string">"undirected"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  show<span class="token punctuation">(</span>m3 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>g3<span class="token punctuation">,</span><span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  show<span class="token punctuation">(</span> graph2T<span class="token punctuation">(</span>g3<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment"># a "pattern Matrix" (nsTMatrix)</span>

  a. <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> dimnames<span class="token operator">=</span>list<span class="token punctuation">(</span>n4<span class="token punctuation">,</span> n4<span class="token punctuation">)</span><span class="token punctuation">,</span> repr<span class="token operator">=</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token comment"># no 'x'</span>
  show<span class="token punctuation">(</span>a.<span class="token punctuation">)</span> <span class="token comment"># "ngTMatrix"</span>
  show<span class="token punctuation">(</span>g. <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>a.<span class="token punctuation">,</span> <span class="token string">"graph"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="SparseM-conv">

<a href="#SparseM-conv" class="help-page-title"><h2 id="coerce-methods-SparseM">Sparse Matrix Coercion from and to those from package <span class="pkg">SparseM</span>
</h2></a>

<h3>Description</h3>

<p>Methods for coercion from and to sparse matrices from package <span class="pkg">SparseM</span>
are provided here, for ease of porting functionality to the
<span class="pkg">Matrix</span> package, and comparing functionality of the two
packages.  All these work via the usual <code><a href="https://r-universe.dev/manuals/methods.html#as">as</a>(., "&lt;class&gt;")</code>
coercion, </p>
<pre>  as(from, Class)
</pre>


<h3>Methods</h3>


<dl>
<dt>from = "matrix.csr", to = "dgRMatrix"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "matrix.csc", to = "dgCMatrix"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "matrix.coo", to = "dgTMatrix"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "dgRMatrix", to = "matrix.csr"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "dgCMatrix", to = "matrix.csc"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "dgTMatrix", to = "matrix.coo"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "Matrix", to = "matrix.csr"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "matrix.csr", to = "dgCMatrix"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "matrix.coo", to = "dgCMatrix"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "matrix.csr", to = "Matrix"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "matrix.csc", to = "Matrix"</dt>
<dd>
<p> ... </p>
</dd>
<dt>from = "matrix.coo", to = "Matrix"</dt>
<dd>
<p> ... </p>
</dd>
</dl>
<h3>See Also</h3>

<p>The documentation in CRAN package <a href="https://CRAN.R-project.org/package=SparseM" target="_blank"><span class="pkg">SparseM</span></a>, such as
<code><a href="https://cran.r-universe.dev/SparseM/doc/manual.html#SparseM.ontology">SparseM.ontology</a></code>, and one important class,
<code><a href="https://cran.r-universe.dev/SparseM/doc/manual.html#matrix.csr-class">matrix.csr</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="colSums">

<a href="#colSums" class="help-page-title"><h2 id="colSums-methods">Form Row and Column Sums and Means</h2></a>

<h3>Description</h3>

<p>Form row and column sums and means for
objects, for <code><a href="#sparseMatrix-class">sparseMatrix</a></code> the result may
optionally be sparse (<code><a href="#sparseVector-class">sparseVector</a></code>), too.
Row or column names are kept respectively as for <span class="pkg">base</span> matrices
and <code><a href="#colSums">colSums</a></code> methods, when the result is
<code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code> vector.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">colSums<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
 rowSums<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
colMeans<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
rowMeans<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S4 method for signature 'CsparseMatrix'</span>
 colSums<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span>
         sparseResult <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'CsparseMatrix'</span>
 rowSums<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span>
         sparseResult <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'CsparseMatrix'</span>
colMeans<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span>
         sparseResult <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'CsparseMatrix'</span>
rowMeans<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span>
         sparseResult <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="colSums-methods_:_x">x</code></td>
<td>
<p>a Matrix, i.e., inheriting from  <code><a href="#Matrix-class">Matrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="colSums-methods_:_na.rm">na.rm</code></td>
<td>
<p>logical.  Should missing values (including <code>NaN</code>)
be omitted from the calculations?</p>
</td>
</tr>
<tr>
<td><code id="colSums-methods_:_dims">dims</code></td>
<td>
<p>completely ignored by the <code>Matrix</code> methods.</p>
</td>
</tr>
<tr>
<td><code id="colSums-methods_:_...">...</code></td>
<td>
<p>potentially further arguments, for method <code>&lt;-&gt;</code>
generic compatibility.</p>
</td>
</tr>
<tr>
<td><code id="colSums-methods_:_sparseResult">sparseResult</code></td>
<td>
<p>logical indicating if the result should be sparse,
i.e., inheriting from class <code><a href="#sparseVector-class">sparseVector</a></code>.  Only
applicable when <code>x</code> is inheriting from a
<code><a href="#sparseMatrix-class">sparseMatrix</a></code> class.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>returns a numeric vector if <code>sparseResult</code> is <code>FALSE</code> as per
default.  Otherwise, returns a <code><a href="#sparseVector-class">sparseVector</a></code>.
</p>
<p><code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a>(x)</code> are only kept (as <code><a href="https://r-universe.dev/manuals/base.html#names">names</a>(v)</code>)
when the resulting <code>v</code> is <code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code>, since
<code><a href="#sparseVector">sparseVector</a></code>s do not have names.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#colSums">colSums</a></code> and the
<code><a href="#sparseVector-class">sparseVector</a></code> classes.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> bdiag<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 7 x 8</span>
colSums<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
d <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>rep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
MM <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>d<span class="token punctuation">,</span> M<span class="token punctuation">)</span>
dim<span class="token punctuation">(</span>MM<span class="token punctuation">)</span> <span class="token comment"># 70 80</span>
length<span class="token punctuation">(</span>MM<span class="token operator">@</span>x<span class="token punctuation">)</span> <span class="token comment"># 160, but many are '0' ; drop those:</span>
MM <span class="token operator">&lt;-</span> drop0<span class="token punctuation">(</span>MM<span class="token punctuation">)</span>
length<span class="token punctuation">(</span>MM<span class="token operator">@</span>x<span class="token punctuation">)</span> <span class="token comment"># 32</span>
  cm <span class="token operator">&lt;-</span> colSums<span class="token punctuation">(</span>MM<span class="token punctuation">)</span>
<span class="token punctuation">(</span>scm <span class="token operator">&lt;-</span> colSums<span class="token punctuation">(</span>MM<span class="token punctuation">,</span> sparseResult <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>is<span class="token punctuation">(</span>scm<span class="token punctuation">,</span> <span class="token string">"sparseVector"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>cm<span class="token punctuation">,</span> as.numeric<span class="token punctuation">(</span>scm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
rowSums <span class="token punctuation">(</span>MM<span class="token punctuation">,</span> sparseResult <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># 14 of 70 are not zero</span>
colMeans<span class="token punctuation">(</span>MM<span class="token punctuation">,</span> sparseResult <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># 16 of 80 are not zero</span>
<span class="token comment">## Since we have no 'NA's, these two are equivalent :</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>rowMeans<span class="token punctuation">(</span>MM<span class="token punctuation">,</span> sparseResult <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    rowMeans<span class="token punctuation">(</span>MM<span class="token punctuation">,</span> sparseResult <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  rowMeans<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">,</span>
	  colSums<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">## dimnames(x) --&gt;  names( &lt;value&gt; ) :</span>
dimnames<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>paste0<span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> paste0<span class="token punctuation">(</span><span class="token string">"V"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
M
colSums<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
rowMeans<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token comment">## Assertions :</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    all.equal<span class="token punctuation">(</span>colSums<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span>
              structure<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> names <span class="token operator">=</span> colnames<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>rowMeans<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span>
              structure<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">,</span> names <span class="token operator">=</span> paste0<span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="compMatrix-class">

<a href="#compMatrix-class" class="help-page-title"><h2 id="compMatrix-class">Class "compMatrix" of Composite (Factorizable) Matrices</h2></a>

<h3>Description</h3>

<p>Virtual class of <em>composite</em> matrices; i.e., matrices
that can be <em>factorized</em>, typically as a product of simpler
matrices.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Slots</h3>


<dl>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> - a list of
factorizations of the matrix.  Note that this is typically empty,
i.e., <code>list()</code>, initially and is <em>updated
<b>automagically</b></em> whenever a matrix factorization is computed.</p>
</dd>
<dt>
<code>Dim</code>, <code>Dimnames</code>:</dt>
<dd>
<p>inherited from the
<code><a href="#Matrix-class">Matrix</a></code> class, see there.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"Matrix"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>dimnames&lt;-</dt>
<dd>
<p><code>signature(x = "compMatrix", value = "list")</code>: set
the <code>dimnames</code> to a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> of length 2, see
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames&lt;-</a></code>.  The <code>factors</code> slot is currently reset to
empty, as the factorization <code>dimnames</code> would have to be adapted, too.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>The matrix factorization classes
<code>"<a href="#MatrixFactorization-class">MatrixFactorization</a>"</code> and their generators,
<code><a href="#lu">lu</a>()</code>,
<code><a href="#qr-methods">qr</a>()</code>,
<code><a href="#chol">chol</a>()</code> and <code><a href="#Cholesky">Cholesky</a>()</code>,
<code><a href="#BunchKaufman-methods">BunchKaufman</a>()</code>, <code><a href="#Schur">Schur</a>()</code>.
</p>

<hr>
</div>
<div class="container manual-page" id="condest">

<a href="#condest" class="help-page-title"><h2 id="condest">Compute Approximate CONDition number and 1-Norm of (Large) Matrices</h2></a>

<h3>Description</h3>

<p>“Estimate”, i.e. compute approximately the CONDition number of
a (potentially large, often sparse) matrix <code>A</code>.
It works by apply a fast <em>randomized</em> approximation of the 1-norm,
<code>norm(A,"1")</code>, through <code>onenormest(.)</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">condest<span class="token punctuation">(</span>A<span class="token punctuation">,</span> t <span class="token operator">=</span> min<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> normA <span class="token operator">=</span> norm<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        silent <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> quiet <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

onenormest<span class="token punctuation">(</span>A<span class="token punctuation">,</span> t <span class="token operator">=</span> min<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> A.x<span class="token punctuation">,</span> At.x<span class="token punctuation">,</span> n<span class="token punctuation">,</span>
           silent <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> quiet <span class="token operator">=</span> silent<span class="token punctuation">,</span>
           iter.max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> eps <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> .Machine<span class="token operator">$</span>double.eps<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="condest_:_A">A</code></td>
<td>
<p>a square matrix, optional for <code>onenormest()</code>, where
instead of <code>A</code>, <code>A.x</code> and <code>At.x</code> can be specified,
see there.</p>
</td>
</tr>
<tr>
<td><code id="condest_:_t">t</code></td>
<td>
<p>number of columns to use in the iterations.</p>
</td>
</tr>
<tr>
<td><code id="condest_:_normA">normA</code></td>
<td>
<p>number; (an estimate of) the 1-norm of <code>A</code>, by
default <code><a href="#norm">norm</a>(A, "1")</code>; may be replaced by an estimate.</p>
</td>
</tr>
<tr>
<td><code id="condest_:_silent">silent</code></td>
<td>
<p>logical indicating if warning and (by default)
convergence messages should be displayed.</p>
</td>
</tr>
<tr>
<td><code id="condest_:_quiet">quiet</code></td>
<td>
<p>logical indicating if convergence messages should be
displayed.</p>
</td>
</tr>
<tr>
<td>
<code id="condest_:_A.x">A.x</code>, <code id="condest_:_At.x">At.x</code>
</td>
<td>
<p>when <code>A</code> is missing, these two must be given as
functions which compute <code>A %% x</code>, or <code>t(A) %% x</code>,
respectively.</p>
</td>
</tr>
<tr>
<td><code id="condest_:_n">n</code></td>
<td>
<p><code> == nrow(A)</code>, only needed when <code>A</code> is not specified.</p>
</td>
</tr>
<tr>
<td><code id="condest_:_iter.max">iter.max</code></td>
<td>
<p>maximal number of iterations for the 1-norm estimator.</p>
</td>
</tr>
<tr>
<td><code id="condest_:_eps">eps</code></td>
<td>
<p>the relative change that is deemed irrelevant.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code><a href="#condest">condest</a>()</code> calls <code><a href="#lu">lu</a>(A)</code>, and subsequently
<code>onenormest(A.x = , At.x = )</code> to compute an approximate norm of
the <em>inverse</em> of <code>A</code>, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">A^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></code>, in a way which
keeps using sparse matrices efficiently when <code>A</code> is sparse.
</p>
<p>Note that <code>onenormest()</code> uses random vectors and hence
<em>both</em> functions' results are random, i.e., depend on the random
seed, see, e.g., <code><a href="https://r-universe.dev/manuals/base.html#Random">set.seed</a>()</code>.
</p>


<h3>Value</h3>

<p>Both functions return a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code>;
<code>condest()</code> with components,
</p>
<table>
<tr>
<td><code>est</code></td>
<td>
<p>a number <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">&gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></code>, the estimated (1-norm) condition number
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>κ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat\kappa</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">κ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></code>; when <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>:</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">r :=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span></span></span></span></code><code>rcond(A)</code>,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mover accent="true"><mi>κ</mi><mo>^</mo></mover><mo>≈</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">1/\hat\kappa \approx r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">κ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></code>.</p>
</td>
</tr>
<tr>
<td><code>v</code></td>
<td>
<p>the maximal <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">A x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span></span></span></span></code> column, scaled to norm(v) = 1.
Consequently, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mo stretchy="false">(</mo><mi>A</mi><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">norm(A v) = norm(A) / est</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span></span></span></span></code>;
when <code>est</code> is large, <code>v</code> is an approximate null vector.</p>
</td>
</tr>
</table>
<p>The function <code>onenormest()</code> returns a list with components,
</p>
<table>
<tr>
<td><code>est</code></td>
<td>
<p>a number <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">&gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></code>, the estimated <code>norm(A, "1")</code>.</p>
</td>
</tr>
<tr>
<td><code>v</code></td>
<td>
<p>0-1 integer vector length <code>n</code>, with an <code>1</code> at the index
<code>j</code> with maximal column <code>A[,j]</code> in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>.</p>
</td>
</tr>
<tr>
<td><code>w</code></td>
<td>
<p>numeric vector, the largest <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">A x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span></span></span></span></code> found.</p>
</td>
</tr>
<tr>
<td><code>iter</code></td>
<td>
<p>the number of iterations used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>This is based on octave's <code>condest()</code> and
<code>onenormest()</code> implementations with original author
Jason Riedy, U Berkeley; translation to <span class="rlang"><b>R</b></span> and
adaption by Martin Maechler.
</p>


<h3>References</h3>


<p>Nicholas J. Higham and Françoise Tisseur (2000).
A Block Algorithm for Matrix 1-Norm Estimation, with an Application
to 1-Norm Pseudospectra.
<em>SIAM J. Matrix Anal. Appl.</em> <b>21</b>, 4, 1185–1201.


</p>
<p>William W. Hager (1984).
Condition Estimates.
<em>SIAM J. Sci. Stat. Comput.</em> <b>5</b>, 311–316.
</p>


<h3>See Also</h3>

<p><code><a href="#norm">norm</a></code>, <code><a href="#rcond">rcond</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
mtm <span class="token operator">&lt;-</span> with<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> crossprod<span class="token punctuation">(</span>mm<span class="token punctuation">)</span><span class="token punctuation">)</span>
system.time<span class="token punctuation">(</span>ce <span class="token operator">&lt;-</span> condest<span class="token punctuation">(</span>mtm<span class="token punctuation">)</span><span class="token punctuation">)</span>
sum<span class="token punctuation">(</span>abs<span class="token punctuation">(</span>ce<span class="token operator">$</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">## || v ||_1  == 1</span>
<span class="token comment">## Prove that  || A v || = || A || / est  (as ||v|| = 1):</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>norm<span class="token punctuation">(</span>mtm <span class="token percent-operator operator">%*%</span> ce<span class="token operator">$</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    norm<span class="token punctuation">(</span>mtm<span class="token punctuation">)</span> <span class="token operator">/</span> ce<span class="token operator">$</span>est<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## reciprocal</span>
<span class="token number">1</span> <span class="token operator">/</span> ce<span class="token operator">$</span>est
system.time<span class="token punctuation">(</span>rc <span class="token operator">&lt;-</span> rcond<span class="token punctuation">(</span>mtm<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># takes ca  3 x  longer</span>
rc
all.equal<span class="token punctuation">(</span>rc<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span>ce<span class="token operator">$</span>est<span class="token punctuation">)</span> <span class="token comment"># TRUE -- the approxmation was good</span>

one <span class="token operator">&lt;-</span> onenormest<span class="token punctuation">(</span>mtm<span class="token punctuation">)</span>
str<span class="token punctuation">(</span>one<span class="token punctuation">)</span> <span class="token comment">## est = 12.3</span>
<span class="token comment">## the maximal column:</span>
which<span class="token punctuation">(</span>one<span class="token operator">$</span>v <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># mostly 4, rarely 1, depending on random seed</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="CsparseMatrix-class">

<a href="#CsparseMatrix-class" class="help-page-title"><h2 id="CsparseMatrix-class">Class "CsparseMatrix" of Sparse Matrices in Column-compressed Form</h2></a>

<h3>Description</h3>

<p>The <code>"CsparseMatrix"</code> class is the virtual class of
all sparse matrices coded in sorted compressed column-oriented form.
Since it is a virtual class, no objects may be created from it.  See
<code>showClass("CsparseMatrix")</code> for its subclasses.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>i</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length nnzero
(number of non-zero elements).  These are the <em>0-based</em> row numbers for
each non-zero element in the matrix, i.e., <code>i</code> must be in
<code>0:(nrow(.)-1)</code>.</p>
</dd>
<dt>
<code>p</code>:</dt>
<dd>
<p><code><a href="https://r-universe.dev/manuals/base.html#integer">integer</a></code> vector for providing pointers, one
for each column, to the initial (zero-based) index of elements in
the column.  <code>.@p</code> is of length <code>ncol(.) + 1</code>, with
<code>p[1] == 0</code> and <code>p[length(p)] == nnzero</code>, such that in
fact, <code>diff(.@p)</code> are the number of non-zero elements for
each column.
</p>
<p>In other words, <code>m@p[1:ncol(m)]</code> contains the indices of
those elements in <code>m@x</code> that are the first elements in the
respective column of <code>m</code>.
</p>
</dd>
<dt>
<code>Dim</code>, <code>Dimnames</code>:</dt>
<dd>
<p>inherited from
the superclass, see the <code><a href="#sparseMatrix-class">sparseMatrix</a></code> class.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"sparseMatrix"</code>, directly.
Class <code>"Matrix"</code>, by class <code>"sparseMatrix"</code>.
</p>


<h3>Methods</h3>


<p>matrix products <code><a href="#matrix-products">%*%</a></code>,
<code><a href="#matrix-products">crossprod</a>()</code> and <code>tcrossprod()</code>,
several <code><a href="#solve-methods">solve</a></code> methods,
and other matrix methods available:


</p>
<dl>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "CsparseMatrix", e2 = "numeric")</code>: ... </p>
</dd>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "numeric", e2 = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>Math</dt>
<dd>
<p><code>signature(x = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>band</dt>
<dd>
<p><code>signature(x = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>-</dt>
<dd>
<p><code>signature(e1 = "CsparseMatrix", e2 = "numeric")</code>: ... </p>
</dd>
<dt>-</dt>
<dd>
<p><code>signature(e1 = "numeric", e2 = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>+</dt>
<dd>
<p><code>signature(e1 = "CsparseMatrix", e2 = "numeric")</code>: ... </p>
</dd>
<dt>+</dt>
<dd>
<p><code>signature(e1 = "numeric", e2 = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "CsparseMatrix", to = "TsparseMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "CsparseMatrix", to = "denseMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "CsparseMatrix", to = "matrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "TsparseMatrix", to = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "denseMatrix", to = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>diag</dt>
<dd>
<p><code>signature(x = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>gamma</dt>
<dd>
<p><code>signature(x = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>lgamma</dt>
<dd>
<p><code>signature(x = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>log</dt>
<dd>
<p><code>signature(x = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>tril</dt>
<dd>
<p><code>signature(x = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>triu</dt>
<dd>
<p><code>signature(x = "CsparseMatrix")</code>: ... </p>
</dd>
</dl>
<h3>Note</h3>

<p>All classes extending <code>CsparseMatrix</code> have a common validity
(see <code><a href="https://r-universe.dev/manuals/methods.html#validObject">validObject</a></code>) check function.  That function
additionally checks the <code>i</code> slot for each column to contain
increasing row numbers. <br>
In earlier versions of <span class="pkg">Matrix</span> (<code>&lt;= 0.999375-16</code>),
<code><a href="https://r-universe.dev/manuals/methods.html#validObject">validObject</a></code> automatically re-sorted the entries when
necessary, and hence <code>new()</code> calls with somewhat permuted
<code>i</code> and <code>x</code> slots worked, as <code><a href="https://r-universe.dev/manuals/methods.html#new">new</a>(...)</code>
(<em>with</em> slot arguments) automatically checks the validity.
</p>
<p>Now, you have to use <code><a href="#sparseMatrix">sparseMatrix</a></code> to achieve the same
functionality or know how to use <code>.validateCsparse()</code> to do so.
</p>


<h3>See Also</h3>

<p><code><a href="#colSums">colSums</a></code>, <code><a href="#kronecker-methods">kronecker</a></code>, and other such methods
with own help pages.
</p>
<p>Further, the super class of <code>CsparseMatrix</code>,
<code><a href="#sparseMatrix-class">sparseMatrix</a></code>, and, e.g.,
class <code><a href="#dgCMatrix-class">dgCMatrix</a></code> for the links to other classes.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">getClass<span class="token punctuation">(</span><span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span>

<span class="token comment">## The common validity check function (based on C code):</span>
getValidity<span class="token punctuation">(</span>getClass<span class="token punctuation">(</span><span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ddenseMatrix-class">

<a href="#ddenseMatrix-class" class="help-page-title"><h2 id="ddenseMatrix-class">Virtual Class "ddenseMatrix" of Numeric Dense Matrices</h2></a>

<h3>Description</h3>

<p>This is the virtual class of all dense numeric (i.e.,
<b>d</b>ouble, hence <em>“ddense”</em>) S4 matrices.
</p>
<p>Its most important subclass is the <code><a href="#dgeMatrix-class">dgeMatrix</a></code> class.

</p>


<h3>Extends</h3>

<p>Class <code>"dMatrix"</code> directly;
class <code>"Matrix"</code>, by the above.
</p>


<h3>Slots</h3>

<p>the same slots at its subclass <code><a href="#dgeMatrix-class">dgeMatrix</a></code>, see
there.
</p>


<h3>Methods</h3>

<p>Most methods are implemented via <code>as(*, "generalMatrix")</code> and are
mainly used as “fallbacks” when the subclass doesn't need its
own specialized method.
</p>
<p>Use <code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(class = "ddenseMatrix", where =
      "package:Matrix")</code> for an overview.
</p>


<h3>See Also</h3>

<p>The virtual classes <code><a href="#Matrix-class">Matrix</a></code>,
<code><a href="#dMatrix-class">dMatrix</a></code>, and <code><a href="#dsparseMatrix-class">dsparseMatrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"ddenseMatrix"</span><span class="token punctuation">)</span>

showMethods<span class="token punctuation">(</span>class <span class="token operator">=</span> <span class="token string">"ddenseMatrix"</span><span class="token punctuation">,</span> where <span class="token operator">=</span> <span class="token string">"package:Matrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ddiMatrix-class">

<a href="#ddiMatrix-class" class="help-page-title"><h2 id="ddiMatrix-class">Class "ddiMatrix" of Diagonal Numeric Matrices</h2></a>

<h3>Description</h3>

<p>The class <code>"ddiMatrix"</code> of numerical diagonal matrices.

Note that diagonal matrices now extend <em><code>sparseMatrix</code></em>, whereas
they did extend dense matrices earlier.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("ddiMatrix", ...)</code>
but typically rather via <code><a href="#Diagonal">Diagonal</a></code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>numeric vector.  For an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
matrix, the <code>x</code> slot is of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> or <code>0</code>,
depending on the <code>diag</code> slot:</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p><code>"character"</code> string, either <code>"U"</code> or
<code>"N"</code> where <code>"U"</code> denotes unit-diagonal, i.e., identity
matrices.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>matrix dimension and
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>, see the <code><a href="#Matrix-class">Matrix</a></code> class
description.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"<a href="#diagonalMatrix-class">diagonalMatrix</a>"</code>, directly.
Class <code>"<a href="#dMatrix-class">dMatrix</a>"</code>, directly.
Class <code>"<a href="#sparseMatrix-class">sparseMatrix</a>"</code>, indirectly, see
<code><a href="https://r-universe.dev/manuals/methods.html#RClassUtils">showClass</a>("ddiMatrix")</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>%*%</dt>
<dd>
<p><code>signature(x = "ddiMatrix", y = "ddiMatrix")</code>: ... </p>
</dd>
</dl>
<h3>See Also</h3>

<p>Class <code><a href="#diagonalMatrix-class">diagonalMatrix</a></code> and function <code><a href="#Diagonal">Diagonal</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>d2 <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>d2<span class="token punctuation">)</span>
<span class="token comment">## slightly larger in internal size:</span>
str<span class="token punctuation">(</span>as<span class="token punctuation">(</span>d2<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
M <span class="token percent-operator operator">%*%</span> d2 <span class="token comment">#&gt; `fast' multiplication</span>

chol<span class="token punctuation">(</span>d2<span class="token punctuation">)</span> <span class="token comment"># trivial</span>
stopifnot<span class="token punctuation">(</span>is<span class="token punctuation">(</span>cd2 <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>d2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"ddiMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          all.equal<span class="token punctuation">(</span>cd2<span class="token operator">@</span>x<span class="token punctuation">,</span> c<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="LU-class">

<a href="#LU-class" class="help-page-title"><h2 id="denseLU-class">Dense LU Factorizations</h2></a>

<h3>Description</h3>

<p><code>denseLU</code> is the class of dense, row-pivoted LU factorizations
of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> real matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
having the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><mo>=</mo><mi>L</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">P_{1} A = L U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">LU</span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">A = P_{1}' L U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">LU</span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> permutation matrix, 
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mtext>min</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m \times \text{min}(m,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">min</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></code>
unit lower trapezoidal matrix, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code> is a  <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>min</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\text{min}(m,n) \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">min</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
upper trapezoidal matrix.  If <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m = n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, then the factors
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code> are triangular.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>, <code>Dimnames</code>
</dt>
<dd>
<p>inherited from virtual class
<code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>.</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>a numeric vector of length <code>prod(Dim)</code> storing
the triangular <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code> factors together in a packed
format.  The details of the representation are specified by the
manual for LAPACK routine <code>dgetrf</code>.</p>
</dd>
<dt><code>perm</code></dt>
<dd>
<p>an integer vector of length <code>min(Dim)</code>
specifying the permutation <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> as a product of
transpositions.   The corresponding permutation vector can
be obtained as <code><a href="#invPerm">asPerm</a>(perm)</code>.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code><a href="#MatrixFactorization-class">LU</a></code>, directly.
Class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>, by class
<code><a href="#MatrixFactorization-class">LU</a></code>, distance 2.
</p>


<h3>Instantiation</h3>

<p>Objects can be generated directly by calls of the form
<code>new("denseLU", ...)</code>, but they are more typically obtained
as the value of <code><a href="#lu">lu</a>(x)</code> for <code>x</code> inheriting from
<code><a href="#denseMatrix-class">denseMatrix</a></code> (often <code><a href="#dgeMatrix-class">dgeMatrix</a></code>).
</p>


<h3>Methods</h3>


<dl>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "denseLU", to = "dgeMatrix")</code>:
returns a <code><a href="#dgeMatrix-class">dgeMatrix</a></code> with the dimensions
of the factorized matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> below the
diagonal and equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code> on and above the diagonal.</p>
</dd>
<dt><code>determinant</code></dt>
<dd>
<p><code>signature(from = "denseLU", logarithm = "logical")</code>:
computes the determinant of the factorized matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>
or its logarithm.</p>
</dd>
<dt><code>expand</code></dt>
<dd>
<p><code>signature(x = "denseLU")</code>:
see <code><a href="#expand">expand-methods</a></code>.</p>
</dd>
<dt><code>expand1</code></dt>
<dd>
<p><code>signature(x = "denseLU")</code>:
see <code><a href="#expand">expand1-methods</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "denseLU")</code>:
see <code><a href="#expand">expand2-methods</a></code>.</p>
</dd>
<dt><code>solve</code></dt>
<dd>
<p><code>signature(a = "denseLU", b = "missing")</code>:
see <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
</dl>
<h3>References</h3>

<p>The LAPACK source code, including documentation; see
<a href="https://netlib.org/lapack/double/dgetrf.f" target="_blank">https://netlib.org/lapack/double/dgetrf.f</a>.
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Class <code><a href="#sparseLU-class">sparseLU</a></code> for sparse LU factorizations.
</p>
<p>Class <code><a href="#dgeMatrix-class">dgeMatrix</a></code>.
</p>
<p>Generic functions <code><a href="#lu">lu</a></code>,
<code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"denseLU"</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

n <span class="token operator">&lt;-</span> <span class="token number">3L</span>
<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>n <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## With dimnames, to see that they are propagated :</span>
dimnames<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> dn <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>paste0<span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                          paste0<span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>lu.A <span class="token operator">&lt;-</span> lu<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>e.lu.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>lu.A<span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>

<span class="token comment">## Underlying LAPACK representation</span>
<span class="token punctuation">(</span>m.lu.A <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>lu.A<span class="token punctuation">,</span> <span class="token string">"dgeMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># which is L and U interlaced</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>as<span class="token punctuation">(</span>m.lu.A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> `dim<span class="token operator">&lt;-</span>`<span class="token punctuation">(</span>lu.A<span class="token operator">@</span>x<span class="token punctuation">,</span> lu.A<span class="token operator">@</span>Dim<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ae1 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
ae2 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> ae1<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> unname<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ P1' L U in floating point</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"P1."</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"U"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              new<span class="token punctuation">(</span>  <span class="token string">"pMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> Dimnames <span class="token operator">=</span> c<span class="token punctuation">(</span>dn<span class="token punctuation">[</span><span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  margin <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> perm <span class="token operator">=</span> invertPerm<span class="token punctuation">(</span>asPerm<span class="token punctuation">(</span>lu.A<span class="token operator">@</span>perm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              new<span class="token punctuation">(</span><span class="token string">"dtrMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> Dimnames <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  uplo <span class="token operator">=</span> <span class="token string">"L"</span><span class="token punctuation">,</span> diag <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> x <span class="token operator">=</span> lu.A<span class="token operator">@</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"U"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              new<span class="token punctuation">(</span><span class="token string">"dtrMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> Dimnames <span class="token operator">=</span> c<span class="token punctuation">(</span>list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dn<span class="token punctuation">[</span><span class="token number">2L</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> diag <span class="token operator">=</span> <span class="token string">"N"</span><span class="token punctuation">,</span> x <span class="token operator">=</span> lu.A<span class="token operator">@</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae1<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> L <span class="token percent-operator operator">%*%</span> U<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>A<span class="token punctuation">[</span>asPerm<span class="token punctuation">(</span>lu.A<span class="token operator">@</span>perm<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">,</span> L <span class="token percent-operator operator">%*%</span> U<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Factorization handled as factorized matrix</span>
b <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>det<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> det<span class="token punctuation">(</span>lu.A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> solve<span class="token punctuation">(</span>lu.A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="denseMatrix-class">

<a href="#denseMatrix-class" class="help-page-title"><h2 id="denseMatrix-class">Virtual Class "denseMatrix" of All Dense Matrices</h2></a>

<h3>Description</h3>

<p>This is the virtual class of all dense (S4) matrices.
It partitions into two subclasses
<code><a href="#packedMatrix-class">packedMatrix</a></code> and
<code><a href="#unpackedMatrix-class">unpackedMatrix</a></code>.
Alternatively into the (currently) three subclasses
<code><a href="#ddenseMatrix-class">ddenseMatrix</a></code>,
<code><a href="#ldenseMatrix-class">ldenseMatrix</a></code>, and
<code><a href="#ndenseMatrix-class">ndenseMatrix</a></code>.
</p>
<p><code>denseMatrix</code> is (hence) the direct superclass of these (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>+</mo><mn>3</mn><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">2+3 = 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span></code>) classes.
</p>


<h3>Extends</h3>

<p>class <code>"Matrix"</code> directly.
</p>


<h3>Slots</h3>

<p>exactly those of its superclass <code>"<a href="#Matrix-class">Matrix</a>"</code>, i.e.,
<code>"Dim"</code> and <code>"Dimnames"</code>.
</p>


<h3>Methods</h3>

<p>Use <code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(class = "denseMatrix", where =
    "package:Matrix")</code> for an overview of methods.
</p>
<p>Extraction (<code>"["</code>) methods,
see <code><a href="#Xtrct-methods">[-methods</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#colSums">colSums</a></code>, <code><a href="#kronecker-methods">kronecker</a></code>, and other such methods
with own help pages.
</p>
<p>Its superclass <code><a href="#Matrix-class">Matrix</a></code>, and main subclasses,
<code><a href="#ddenseMatrix-class">ddenseMatrix</a></code> and <code><a href="#sparseMatrix-class">sparseMatrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"denseMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dgCMatrix-class">

<a href="#dgCMatrix-class" class="help-page-title"><h2 id="dgCMatrix-class">Compressed, sparse, column-oriented numeric matrices</h2></a>

<h3>Description</h3>

<p>The <code>dgCMatrix</code> class is a class of sparse numeric
matrices in the compressed, sparse, column-oriented format.  In this
implementation the non-zero elements in the columns are sorted into
increasing row order.  <code>dgCMatrix</code> is the
<em>“standard”</em> class for sparse numeric matrices in the
<span class="pkg">Matrix</span> package.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("dgCMatrix",
    ...)</code>, more typically via <code>as(*, "CsparseMatrix")</code> or similar.
Often however, more easily via <code><a href="#Matrix">Matrix</a>(*, sparse = TRUE)</code>,
or most efficiently via <code><a href="#sparseMatrix">sparseMatrix</a>()</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code> - the non-zero
elements of the matrix.</p>
</dd>
<dt>...</dt>
<dd>
<p>all other slots are inherited from the superclass
<code>"<a href="#CsparseMatrix-class">CsparseMatrix</a>"</code>.
</p>
</dd>
</dl>
<h3>Methods</h3>

<p>Matrix products (e.g., <a href="#matrix-products">crossprod-methods</a>), and (among other)
</p>

<dl>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "matrix", to = "dgCMatrix")</code></p>
</dd>
<dt>diag</dt>
<dd>
<p><code>signature(x = "dgCMatrix")</code>: returns the diagonal
of <code>x</code></p>
</dd>
<dt>dim</dt>
<dd>
<p><code>signature(x = "dgCMatrix")</code>: returns the dimensions
of <code>x</code></p>
</dd>
<dt>image</dt>
<dd>
<p><code>signature(x = "dgCMatrix")</code>: plots an image of
<code>x</code> using the <code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a></code> function</p>
</dd>
<dt>solve</dt>
<dd>
<p><code>signature(a = "dgCMatrix", b = "...")</code>:
see <code><a href="#solve-methods">solve-methods</a></code>, notably the extra argument
<code>sparse</code>.</p>
</dd>
<dt>lu</dt>
<dd>
<p><code>signature(x = "dgCMatrix")</code>: computes the LU
decomposition of a square <code>dgCMatrix</code> object</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Classes <code><a href="#dsCMatrix-class">dsCMatrix</a></code>,
<code><a href="#dtCMatrix-class">dtCMatrix</a></code>, <code><a href="#lu">lu</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>m <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
m<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dgeMatrix-class">

<a href="#dgeMatrix-class" class="help-page-title"><h2 id="dgeMatrix-class">Class "dgeMatrix" of Dense Numeric (S4 Class) Matrices</h2></a>

<h3>Description</h3>

<p>A general numeric dense matrix in the S4 Matrix
representation.  <code>dgeMatrix</code> is the <em>“standard”</em>
class for dense numeric matrices in the <span class="pkg">Matrix</span> package.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("dgeMatrix", ...)</code>
or, more commonly, by coercion from the <code>Matrix</code> class (see
<a href="#Matrix-class">Matrix</a>) or by <code><a href="#Matrix">Matrix</a>(..)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code> - the numeric
values contained in the matrix, in column-major order.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the dimensions
of the matrix - must be an integer vector with exactly two
non-negative values.</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>a list of length two - inherited from class
<code><a href="#Matrix-class">Matrix</a></code>.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> - a list
of factorizations of the matrix.</p>
</dd>
</dl>
<h3>Methods</h3>

<p>The are group methods (see, e.g., <code><a href="https://r-universe.dev/manuals/methods.html#S4groupGeneric">Arith</a></code>)
</p>

<dl>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "dgeMatrix", e2 = "dgeMatrix")</code>: ... </p>
</dd>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "dgeMatrix", e2 = "numeric")</code>: ... </p>
</dd>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "numeric", e2 = "dgeMatrix")</code>: ... </p>
</dd>
<dt>Math</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: ... </p>
</dd>
<dt>Math2</dt>
<dd>
<p><code>signature(x = "dgeMatrix", digits = "numeric")</code>: ...</p>
</dd>
</dl>
<p>matrix products <code><a href="#matrix-products">%*%</a></code>,
<code><a href="#matrix-products">crossprod</a>()</code> and <code>tcrossprod()</code>,
several <code><a href="#solve-methods">solve</a></code> methods,
and other matrix methods available:
</p>

<dl>
<dt>Schur</dt>
<dd>
<p><code>signature(x = "dgeMatrix", vectors = "logical")</code>: ... </p>
</dd>
<dt>Schur</dt>
<dd>
<p><code>signature(x = "dgeMatrix", vectors = "missing")</code>: ... </p>
</dd>
<dt>chol</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: see <code><a href="#chol">chol</a></code>.</p>
</dd>
<dt>colMeans</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: columnwise means (averages)</p>
</dd>
<dt>colSums</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: columnwise sums</p>
</dd>
<dt>diag</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: ... </p>
</dd>
<dt>dim</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: ... </p>
</dd>
<dt>dimnames</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: ... </p>
</dd>
<dt>eigen</dt>
<dd>
<p><code>signature(x = "dgeMatrix", only.values= "logical")</code>: ...</p>
</dd>
<dt>eigen</dt>
<dd>
<p><code>signature(x = "dgeMatrix", only.values= "missing")</code>: ...</p>
</dd>
<dt>norm</dt>
<dd>
<p><code>signature(x = "dgeMatrix", type = "character")</code>: ... </p>
</dd>
<dt>norm</dt>
<dd>
<p><code>signature(x = "dgeMatrix", type = "missing")</code>: ... </p>
</dd>
<dt>rcond</dt>
<dd>
<p><code>signature(x = "dgeMatrix", norm = "character")</code>
or <code>norm = "missing"</code>:
the reciprocal condition number, <code><a href="#rcond">rcond</a>()</code>.</p>
</dd>
<dt>rowMeans</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: rowwise means (averages)</p>
</dd>
<dt>rowSums</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: rowwise sums</p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "dgeMatrix")</code>: matrix transpose</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Classes <code><a href="#Matrix-class">Matrix</a></code>,
<code><a href="#dtrMatrix-class">dtrMatrix</a></code>, and <code><a href="#dsyMatrix-class">dsyMatrix</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="dgRMatrix-class">

<a href="#dgRMatrix-class" class="help-page-title"><h2 id="dgRMatrix-class">Sparse Compressed, Row-oriented Numeric Matrices</h2></a>

<h3>Description</h3>

<p>The <code>dgRMatrix</code> class is a class of sparse numeric
matrices in the compressed, sparse, row-oriented format.  In this
implementation the non-zero elements in the rows are sorted into
increasing column order.
</p>
<p><b>Note:</b> The column-oriented sparse classes, e.g.,
<code><a href="#dgCMatrix-class">dgCMatrix</a></code>, are preferred and better supported in
the <span class="pkg">Matrix</span> package.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("dgRMatrix", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>j</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length nnzero
(number of non-zero elements).  These are the column numbers for
each non-zero element in the matrix.</p>
</dd>
<dt>
<code>p</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of pointers, one
for each row, to the initial (zero-based) index of elements in
the row.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code> - the non-zero
elements of the matrix.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the dimensions
of the matrix.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>diag</dt>
<dd>
<p><code>signature(x = "dgRMatrix")</code>: returns the diagonal
of <code>x</code></p>
</dd>
<dt>dim</dt>
<dd>
<p><code>signature(x = "dgRMatrix")</code>: returns the dimensions
of <code>x</code></p>
</dd>
<dt>image</dt>
<dd>
<p><code>signature(x = "dgRMatrix")</code>: plots an image of
<code>x</code> using the <code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a></code> function</p>
</dd>
</dl>
<h3>See Also</h3>

<p>the <code><a href="#RsparseMatrix-class">RsparseMatrix</a></code> class, the virtual class of all
sparse compressed <b>r</b>ow-oriented matrices, with its methods.
The <code><a href="#dgCMatrix-class">dgCMatrix</a></code> class (<b>c</b>olumn compressed
sparse) is really preferred.
</p>

<hr>
</div>
<div class="container manual-page" id="dgTMatrix-class">

<a href="#dgTMatrix-class" class="help-page-title"><h2 id="dgTMatrix-class">Sparse matrices in triplet form</h2></a>

<h3>Description</h3>

<p>The <code>"dgTMatrix"</code> class is the class of sparse
matrices stored as (possibly redundant) triplets.  The internal
representation is not at all unique, contrary to the one for class
<code><a href="#dgCMatrix-class">dgCMatrix</a></code>.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form
<code>new("dgTMatrix", ...)</code>, but more typically via
<code><a href="#spMatrix">spMatrix</a>()</code> or <code><a href="#sparseMatrix">sparseMatrix</a>(*, repr = "T")</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>i</code>:</dt>
<dd>
<p><code><a href="https://r-universe.dev/manuals/base.html#integer">integer</a></code> row indices of non-zero
entries <em>in 0-base</em>, i.e., must be in <code>0:(nrow(.)-1)</code>.</p>
</dd>
<dt>
<code>j</code>:</dt>
<dd>
<p><code><a href="https://r-universe.dev/manuals/base.html#integer">integer</a></code> column indices of non-zero
entries.  Must be the same length as slot <code>i</code> and
<em>0-based</em> as well, i.e., in <code>0:(ncol(.)-1)</code>.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p><code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code> vector - the (non-zero)
entry at position <code>(i,j)</code>.  Must be the same length as slot
<code>i</code>.  If an index pair occurs more than once, the corresponding
values of slot <code>x</code> are added to form the element of the matrix.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length 2 -
the dimensions of the matrix.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>+</dt>
<dd>
<p><code>signature(e1 = "dgTMatrix", e2 = "dgTMatrix")</code></p>
</dd>
<dt>image</dt>
<dd>
<p><code>signature(x = "dgTMatrix")</code>: plots an image of
<code>x</code> using the <code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a></code> function</p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "dgTMatrix")</code>: returns the transpose of
<code>x</code></p>
</dd>
</dl>
<h3>Note</h3>

<p>Triplet matrices are a convenient form in which to construct sparse
matrices after which they can be coerced to
<code><a href="#dgCMatrix-class">dgCMatrix</a></code> objects.
</p>
<p>Note that both <code>new(.)</code> and <code><a href="#spMatrix">spMatrix</a></code> constructors
for <code>"dgTMatrix"</code> (and other <code>"<a href="#TsparseMatrix-class">TsparseMatrix</a>"</code>
classes) implicitly add <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">x_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>'s that belong to identical
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>i</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>j</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i_k, j_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> pairs.
</p>
<p>However this means that a matrix typically can be stored in more than
one possible <code>"<a href="#TsparseMatrix-class">TsparseMatrix</a>"</code> representations.
Use <code><a href="#uniqTsparse">uniqTsparse</a>()</code> in order to ensure uniqueness of the
internal representation of such a matrix.
</p>


<h3>See Also</h3>

<p>Class <code><a href="#dgCMatrix-class">dgCMatrix</a></code> or the superclasses
<code><a href="#dsparseMatrix-class">dsparseMatrix</a></code> and
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>; <code><a href="#uniqTsparse">uniqTsparse</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">m <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
m<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> m<span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> m<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
<span class="token punctuation">(</span>mT <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">"TsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>mT<span class="token punctuation">)</span>
mT<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span>
mT<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">]</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>mT<span class="token punctuation">[</span>lower.tri<span class="token punctuation">(</span>mT<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    m <span class="token punctuation">[</span>lower.tri<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
mT<span class="token punctuation">[</span>lower.tri<span class="token punctuation">(</span>mT<span class="token punctuation">,</span>diag<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
mT

<span class="token comment">## Triplet representation with repeated (i,j) entries</span>
<span class="token comment">## *adds* the corresponding x's:</span>
T2 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dgTMatrix"</span><span class="token punctuation">,</span>
          i <span class="token operator">=</span> as.integer<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          j <span class="token operator">=</span> as.integer<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token number">10</span><span class="token operator">*</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> Dim<span class="token operator">=</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>T2<span class="token punctuation">)</span> <span class="token comment"># contains (i,j,x) slots exactly as above, but</span>
T2 <span class="token comment">## has only three non-zero entries, as for repeated (i,j)'s,</span>
   <span class="token comment">## the corresponding x's are "implicitly" added</span>
stopifnot<span class="token punctuation">(</span>nnzero<span class="token punctuation">(</span>T2<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Diagonal">

<a href="#Diagonal" class="help-page-title"><h2 id="Diagonal">Construct a Diagonal Matrix</h2></a>

<h3>Description</h3>

<p>Construct a formally diagonal <code><a href="#Matrix-class">Matrix</a></code>,
i.e., an object inheriting from virtual class
<code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>
(or, if desired, a <em>mathematically</em> diagonal
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Diagonal<span class="token punctuation">(</span>n<span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> names <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

.sparseDiagonal<span class="token punctuation">(</span>n<span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> shape <span class="token operator">=</span> <span class="token string">"t"</span><span class="token punctuation">,</span> unitri <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> kind<span class="token punctuation">,</span> cols<span class="token punctuation">)</span>
    .trDiagonal<span class="token punctuation">(</span>n<span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> unitri <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> kind<span class="token punctuation">)</span>
   .symDiagonal<span class="token punctuation">(</span>n<span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> kind<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="Diagonal_:_n">n</code></td>
<td>
<p>integer indicating the dimension of the (square) matrix.
If missing, then <code>length(x)</code> is used.</p>
</td>
</tr>
<tr>
<td><code id="Diagonal_:_x">x</code></td>
<td>
<p>numeric or logical vector listing values for the diagonal
entries, to be recycled as necessary.  If <code>NULL</code> (the default),
then the result is a unit diagonal matrix.  <code>.sparseDiagonal()</code>
and friends ignore non-<code>NULL</code> <code>x</code> when <code>kind = "n"</code>.</p>
</td>
</tr>
<tr>
<td><code id="Diagonal_:_names">names</code></td>
<td>
<p>either <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> <code>TRUE</code> or <code>FALSE</code> or
then a <code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> vector of <code><a href="https://r-universe.dev/manuals/base.html#length">length</a></code>
<code>n</code>.  If true <em>and</em> <code><a href="https://r-universe.dev/manuals/base.html#names">names</a>(x)</code> is not
<code>NULL</code>, use that as both row and column names for the resulting
matrix.  When a character vector, use it for both dimnames.</p>
</td>
</tr>
<tr>
<td><code id="Diagonal_:_uplo">uplo</code></td>
<td>
<p>one of <code>c("U","L")</code>, specifying the <code>uplo</code> slot
of the result if the result is formally triangular of symmetric.</p>
</td>
</tr>
<tr>
<td><code id="Diagonal_:_shape">shape</code></td>
<td>
<p>one of <code>c("t","s","g")</code>, indicating if the result
should be formally triangular, symmetric, or “general”.
The result will inherit from virtual class
<code><a href="#triangularMatrix-class">triangularMatrix</a></code>,
<code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>, or
<code><a href="#generalMatrix-class">generalMatrix</a></code>, respectively.</p>
</td>
</tr>
<tr>
<td><code id="Diagonal_:_unitri">unitri</code></td>
<td>
<p>logical indicating if a formally triangular result with
ones on the diagonal should be formally <em>unit</em> triangular, i.e.,
with <code>diag</code> slot equal to <code>"U"</code> rather than <code>"N"</code>.</p>
</td>
</tr>
<tr>
<td><code id="Diagonal_:_kind">kind</code></td>
<td>
<p>one of <code>c("d","l","n")</code>, indicating the “mode”
of the result: numeric, logical, or pattern.
The result will inherit from virtual class
<code><a href="#dsparseMatrix-class">dsparseMatrix</a></code>,
<code><a href="#lsparseMatrix-classes">lsparseMatrix</a></code>, or
<code><a href="#nsparseMatrix-classes">nsparseMatrix</a></code>, respectively.
Values other than <code>"n"</code> are ignored when <code>x</code> is
non-<code>NULL</code>; in that case the mode is determined by
<code><a href="https://r-universe.dev/manuals/base.html#typeof">typeof</a>(x)</code>.</p>
</td>
</tr>
<tr>
<td><code id="Diagonal_:_cols">cols</code></td>
<td>
<p>optional integer vector with values in <code>0:(n-1)</code>,
indexing columns of the specified diagonal matrix.  If specified,
then the result is (mathematically) <code>D[, cols+1]</code> rather
than <code>D</code>, where <code>D = Diagonal(n, x)</code>, and it is always
“general” (i.e., <code>shape</code> is ignored).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>Diagonal()</code> returns an object inheriting from virtual class
<code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>.
</p>
<p><code>.sparseDiagonal()</code> returns a <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>
representation of <code>Diagonal(n, x)</code> or, if <code>cols</code> is given,
of <code>Diagonal(n, x)[, cols+1]</code>.  The precise class of the result
depends on <code>shape</code> and <code>kind</code>.
</p>
<p><code>.trDiagonal()</code> and <code>.symDiagonal()</code> are simple wrappers,
for <code>.sparseDiagonal(shape = "t")</code> and
<code>.sparseDiagonal(shape = "s")</code>, respectively.
</p>
<p><code>.sparseDiagonal()</code> exists primarily to leverage efficient
C-level methods available for <code>CsparseMatrix</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p>the generic function <code><a href="https://r-universe.dev/manuals/base.html#diag">diag</a></code> for <em>extraction</em>
of the diagonal from a matrix works for all “Matrices”.
</p>
<p><code><a href="#bandSparse">bandSparse</a></code> constructs a <em>banded</em> sparse matrix from
its non-zero sub-/super - diagonals.  <code><a href="#band">band</a>(A)</code> returns a
band matrix containing some sub-/super - diagonals of <code>A</code>.
</p>
<p><code><a href="#Matrix">Matrix</a></code> for general matrix construction;
further, class <code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">Diagonal<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">#-&gt; "ldiMatrix"</span>

<span class="token comment">## Use Diagonal() + kronecker() for "repeated-block" matrices:</span>
M1 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">+</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> M1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>S <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>rbinom<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> prob<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>SI <span class="token operator">&lt;-</span> S <span class="token operator">+</span> <span class="token number">10</span><span class="token operator">*</span>.symDiagonal<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># sparse symmetric still</span>
stopifnot<span class="token punctuation">(</span>is<span class="token punctuation">(</span>SI<span class="token punctuation">,</span> <span class="token string">"dsCMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>I4 <span class="token operator">&lt;-</span> .sparseDiagonal<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token string">"t"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># now (2012-10) unitriangular</span>
stopifnot<span class="token punctuation">(</span>I4<span class="token operator">@</span>diag <span class="token operator">==</span> <span class="token string">"U"</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span>I4 <span class="token operator">==</span> diag<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="diagonalMatrix-class">

<a href="#diagonalMatrix-class" class="help-page-title"><h2 id="diagonalMatrix-class">Class "diagonalMatrix" of Diagonal Matrices</h2></a>

<h3>Description</h3>

<p>Class "diagonalMatrix" is the virtual class of all diagonal matrices.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be
created from it.</p>


<h3>Slots</h3>


<dl>
<dt>
<code>diag</code>:</dt>
<dd>
<p><code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> string, either <code>"U"</code> or
<code>"N"</code>, where <code>"U"</code> means ‘unit-diagonal’.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>matrix dimension, and</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>the <code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>, a
<code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code>, see the <code><a href="#Matrix-class">Matrix</a></code> class
description.  Typically <code>list(NULL,NULL)</code> for diagonal matrices.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"<a href="#sparseMatrix-class">sparseMatrix</a>"</code>, directly.
</p>


<h3>Methods</h3>

<p>These are just a subset of the signature for which defined methods.
Currently, there are (too) many explicit methods defined in order to
ensure efficient methods for diagonal matrices.
</p>

<dl>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "matrix", to = "diagonalMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "Matrix", to = "diagonalMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "diagonalMatrix", to = "generalMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "diagonalMatrix", to = "triangularMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "diagonalMatrix", to = "nMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "diagonalMatrix", to = "matrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "diagonalMatrix", to = "sparseVector")</code>: ... </p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "diagonalMatrix")</code>: ... </p>
</dd>
</dl>
<p><br> and many more methods
</p>
<dl>
<dt>solve</dt>
<dd>
<p><code>signature(a = "diagonalMatrix", b, ...)</code>: is
trivially implemented, of course; see also <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
<dt>which</dt>
<dd>
<p><code>signature(x = "nMatrix")</code>, semantically
equivalent to <span class="pkg">base</span> function <code><a href="https://r-universe.dev/manuals/base.html#which">which</a>(x, arr.ind)</code>.</p>
</dd>
<dt>"Math"</dt>
<dd>
<p><code>signature(x = "diagonalMatrix")</code>: all these
group methods return a <code>"diagonalMatrix"</code>, apart from
<code><a href="https://r-universe.dev/manuals/base.html#cumsum">cumsum</a>()</code> etc which return a <em>vector</em> also for
<span class="pkg">base</span> <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>.</p>
</dd>
<dt>*</dt>
<dd>
<p><code>signature(e1 = "ddiMatrix", e2="denseMatrix")</code>:
arithmetic and other operators from the <code><a href="https://r-universe.dev/manuals/methods.html#S4groupGeneric">Ops</a></code>
group have a few dozen explicit method definitions, in order to
keep the results <em>diagonal</em> in many cases, including the following:</p>
</dd>
<dt>/</dt>
<dd>
<p><code>signature(e1 = "ddiMatrix", e2="denseMatrix")</code>:
the result is from class <code><a href="#ddiMatrix-class">ddiMatrix</a></code> which is
typically very desirable.  Note that when <code>e2</code> contains
off-diagonal zeros or <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s, we implicitly use <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mi mathvariant="normal">/</mi><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">0 / x = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0/</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></code>, hence
differing from traditional <span class="rlang"><b>R</b></span> arithmetic (where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mi mathvariant="normal">/</mi><mn>0</mn><mo>↦</mo><mtext>NaN</mtext></mrow><annotation encoding="application/x-tex">0 / 0
	\mapsto \mbox{NaN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0/0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">NaN</span></span></span></span></span></code>), in order to preserve sparsity.</p>
</dd>
<dt>summary</dt>
<dd>
<p><code>(object = "diagonalMatrix")</code>: Returns
an object of S3 class <code>"diagSummary"</code> which is the summary of
the vector <code>object@x</code> plus a simple heading, and an
appropriate <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code> method.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code><a href="#Diagonal">Diagonal</a>()</code> as constructor of these matrices, and
<code><a href="#isTriangular">isDiagonal</a></code>.
<code><a href="#ddiMatrix-class">ddiMatrix</a></code> and <code><a href="#ldiMatrix-class">ldiMatrix</a></code> are
“actual” classes extending <code>"diagonalMatrix"</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">I5 <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
D5 <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## trivial (but explicitly defined) methods:</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>I5<span class="token punctuation">)</span><span class="token punctuation">,</span> I5<span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>tcrossprod<span class="token punctuation">(</span>I5<span class="token punctuation">)</span><span class="token punctuation">,</span> I5<span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>I5<span class="token punctuation">,</span> D5<span class="token punctuation">)</span><span class="token punctuation">,</span> D5<span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>tcrossprod<span class="token punctuation">(</span>D5<span class="token punctuation">,</span> I5<span class="token punctuation">)</span><span class="token punctuation">,</span> D5<span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>D5<span class="token punctuation">)</span><span class="token punctuation">,</span> solve<span class="token punctuation">(</span>D5<span class="token punctuation">,</span> I5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          all.equal<span class="token punctuation">(</span>D5<span class="token punctuation">,</span> solve<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>D5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">1e-12</span><span class="token punctuation">)</span>
          <span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>D5<span class="token punctuation">)</span><span class="token comment"># efficient as is diagonal</span>

<span class="token comment"># an unusual way to construct a band matrix:</span>
rbind2<span class="token punctuation">(</span>cbind2<span class="token punctuation">(</span>I5<span class="token punctuation">,</span> D5<span class="token punctuation">)</span><span class="token punctuation">,</span>
       cbind2<span class="token punctuation">(</span>D5<span class="token punctuation">,</span> I5<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="diagU2N">

<a href="#diagU2N" class="help-page-title"><h2 id="diagU2N">Transform Triangular Matrices from Unit Triangular to General Triangular and Back</h2></a>

<h3>Description</h3>

<p>Transform a triangular matrix <code>x</code>, i.e., of <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code>
<code><a href="#triangularMatrix-class">triangularMatrix</a></code>,
from (internally!) unit triangular (“unitriangular”) to
“general” triangular (<code>diagU2N(x)</code>) or back (<code>diagN2U(x)</code>).
Note that the latter, <code>diagN2U(x)</code>, also sets the diagonal to one
in cases where <code>diag(x)</code> was not all one.
</p>
<p><code>.diagU2N(x)</code> and <code>.diagN2U(x)</code> assume <em>without</em>
checking that <code>x</code> is a <code><a href="#triangularMatrix-class">triangularMatrix</a></code> with
suitable <code>diag</code> slot (<code>"U"</code> and <code>"N"</code>, respectively),
hence they should be used with care.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">diagU2N<span class="token punctuation">(</span>x<span class="token punctuation">,</span> cl <span class="token operator">=</span> getClassDef<span class="token punctuation">(</span>class<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> checkDense <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
 diagN2U<span class="token punctuation">(</span>x<span class="token punctuation">,</span> cl <span class="token operator">=</span> getClassDef<span class="token punctuation">(</span>class<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> checkDense <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

.diagU2N<span class="token punctuation">(</span>x<span class="token punctuation">,</span> cl <span class="token operator">=</span> getClassDef<span class="token punctuation">(</span>class<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> checkDense <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
.diagN2U<span class="token punctuation">(</span>x<span class="token punctuation">,</span> cl <span class="token operator">=</span> getClassDef<span class="token punctuation">(</span>class<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> checkDense <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="diagU2N_:_x">x</code></td>
<td>
<p>a <code><a href="#triangularMatrix-class">triangularMatrix</a></code>, often sparse.</p>
</td>
</tr>
<tr>
<td><code id="diagU2N_:_cl">cl</code></td>
<td>
<p>(optional, for speedup only:) class (definition) of <code>x</code>.</p>
</td>
</tr>
<tr>
<td><code id="diagU2N_:_checkDense">checkDense</code></td>
<td>
<p>logical indicating if dense (see
<code><a href="#denseMatrix-class">denseMatrix</a></code>) matrices should be considered at
all; i.e., when false, as per default, the result will be sparse even
when <code>x</code> is dense.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The concept of unit triangular matrices with a <code>diag</code> slot of
<code>"U"</code> stems from LAPACK.
</p>


<h3>Value</h3>

<p>a triangular matrix of the same <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> but with a
different <code>diag</code> slot.  For <code>diagU2N</code> (semantically) with
identical entries as <code>x</code>, whereas in <code>diagN2U(x)</code>, the
off-diagonal entries are unchanged and the diagonal is set to all
<code>1</code> even if it was not previously.
</p>


<h3>Note</h3>

<p>Such internal storage details should rarely be of relevance to the
user.  Hence, these functions really are rather <em>internal</em>
utilities.
</p>


<h3>See Also</h3>

<p><code>"<a href="#triangularMatrix-class">triangularMatrix</a>"</code>,
<code>"<a href="#dtCMatrix-class">dtCMatrix</a>"</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>T <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">+</span> triu<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>rpois<span class="token punctuation">(</span><span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>uT <span class="token operator">&lt;-</span> diagN2U<span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># "unitriangular"</span>
<span class="token punctuation">(</span>t.u <span class="token operator">&lt;-</span> diagN2U<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># changes the diagonal!</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>T <span class="token operator">==</span> uT<span class="token punctuation">)</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span>t.u<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>T<span class="token punctuation">,</span> diagU2N<span class="token punctuation">(</span>uT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
T<span class="token punctuation">[</span>upper.tri<span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">5</span> <span class="token comment"># still "dtC"</span>
T <span class="token operator">&lt;-</span> diagN2U<span class="token punctuation">(</span>as<span class="token punctuation">(</span>T<span class="token punctuation">,</span><span class="token string">"triangularMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dT <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>T<span class="token punctuation">,</span> <span class="token string">"denseMatrix"</span><span class="token punctuation">)</span> <span class="token comment"># (unitriangular)</span>
dT.n <span class="token operator">&lt;-</span> diagU2N<span class="token punctuation">(</span>dT<span class="token punctuation">,</span> checkDense <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
sT.n <span class="token operator">&lt;-</span> diagU2N<span class="token punctuation">(</span>dT<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>is<span class="token punctuation">(</span>dT.n<span class="token punctuation">,</span> <span class="token string">"denseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> is<span class="token punctuation">(</span>sT.n<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          dT<span class="token operator">@</span>diag <span class="token operator">==</span> <span class="token string">"U"</span><span class="token punctuation">,</span> dT.n<span class="token operator">@</span>diag <span class="token operator">==</span> <span class="token string">"N"</span><span class="token punctuation">,</span> sT.n<span class="token operator">@</span>diag <span class="token operator">==</span> <span class="token string">"N"</span><span class="token punctuation">,</span>
          all<span class="token punctuation">(</span>dT <span class="token operator">==</span> dT.n<span class="token punctuation">)</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span>dT <span class="token operator">==</span> sT.n<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dimScale">

<a href="#dimScale" class="help-page-title"><h2 id="dimScale">Scale the Rows and Columns of a Matrix</h2></a>

<h3>Description</h3>

<p><code>dimScale</code>, <code>rowScale</code>, and <code>colScale</code> implement
<code>D1 %*% x %*% D2</code>, <code>D %*% x</code>, and <code>x %*% D</code>
for diagonal matrices <code>D1</code>, <code>D2</code>, and <code>D</code> with
diagonal entries <code>d1</code>, <code>d2</code>, and <code>d</code>, respectively.
Unlike the explicit products, these functions preserve <code>dimnames(x)</code>
and symmetry where appropriate.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">dimScale<span class="token punctuation">(</span>x<span class="token punctuation">,</span> d1 <span class="token operator">=</span> sqrt<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>diag<span class="token punctuation">(</span>x<span class="token punctuation">,</span> names <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> d2 <span class="token operator">=</span> d1<span class="token punctuation">)</span>
rowScale<span class="token punctuation">(</span>x<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
colScale<span class="token punctuation">(</span>x<span class="token punctuation">,</span> d<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="dimScale_:_x">x</code></td>
<td>
<p>a matrix, possibly inheriting from virtual class
<code><a href="#Matrix-class">Matrix</a></code>.</p>
</td>
</tr>
<tr>
<td>
<code id="dimScale_:_d1">d1</code>, <code id="dimScale_:_d2">d2</code>, <code id="dimScale_:_d">d</code>
</td>
<td>
<p>numeric vectors giving factors by which to scale
the rows or columns of <code>x</code>; they are recycled as necessary.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>dimScale(x)</code> (with <code>d1</code> and <code>d2</code> unset) is only
roughly equivalent to <code><a href="https://r-universe.dev/manuals/stats.html#cor">cov2cor</a>(x)</code>.  <code>cov2cor</code>
sets the diagonal entries of the result to 1 (exactly);
<code>dimScale</code> does not.
</p>


<h3>Value</h3>

<p>The result of scaling <code>x</code>, currently always inheriting from
virtual class <code><a href="#dMatrix-class">dMatrix</a></code>.
</p>
<p>It inherits from <code><a href="#triangularMatrix-class">triangularMatrix</a></code> if and only
if <code>x</code> does.  In the special case of <code>dimScale(x, d1, d2)</code>
with identical <code>d1</code> and <code>d2</code>, it inherits from
<code><a href="#symmetricMatrix-class">symmetricMatrix</a></code> if and only if <code>x</code> does.
</p>


<h3>Author(s)</h3>

<p>Mikael Jagan</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#cor">cov2cor</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">n <span class="token operator">&lt;-</span> <span class="token number">6L</span>
<span class="token punctuation">(</span>x <span class="token operator">&lt;-</span> forceSymmetric<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> rep.int<span class="token punctuation">(</span>list<span class="token punctuation">(</span>letters<span class="token punctuation">[</span>seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span>

d <span class="token operator">&lt;-</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token punctuation">(</span>D <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>scx <span class="token operator">&lt;-</span> dimScale<span class="token punctuation">(</span>x<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># symmetry and 'dimnames' kept</span>
<span class="token punctuation">(</span>mmx <span class="token operator">&lt;-</span> D <span class="token percent-operator operator">%*%</span> x <span class="token percent-operator operator">%*%</span> D<span class="token punctuation">)</span> <span class="token comment"># symmetry and 'dimnames' lost</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>as<span class="token punctuation">(</span>scx<span class="token punctuation">,</span> <span class="token string">"generalMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mmx<span class="token punctuation">)</span><span class="token punctuation">)</span>

rowScale<span class="token punctuation">(</span>x<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
colScale<span class="token punctuation">(</span>x<span class="token punctuation">,</span> d<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dMatrix-class">

<a href="#dMatrix-class" class="help-page-title"><h2 id="dMatrix-class">(Virtual) Class "dMatrix" of "double" Matrices</h2></a>

<h3>Description</h3>

<p>The <code>dMatrix</code> class is a virtual class contained by all actual
classes of numeric matrices in the <span class="pkg">Matrix</span> package.  Similarly,
all the actual classes of logical matrices inherit from the
<code>lMatrix</code> class.
</p>


<h3>Slots</h3>

<p>Common to <em>all</em> matrix object in the package:
</p>

<dl>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the dimensions
of the matrix - must be an integer vector with exactly two
non-negative values.</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>list of length two; each component
containing NULL or a <code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> vector length
equal the corresponding <code>Dim</code> element.</p>
</dd>
</dl>
<h3>Methods</h3>

<p>There are (relatively simple) group methods (see, e.g., <code><a href="https://r-universe.dev/manuals/methods.html#S4groupGeneric">Arith</a></code>)
</p>

<dl>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "dMatrix", e2 = "dMatrix")</code>: ... </p>
</dd>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "dMatrix", e2 = "numeric")</code>: ... </p>
</dd>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "numeric", e2 = "dMatrix")</code>: ... </p>
</dd>
<dt>Math</dt>
<dd>
<p><code>signature(x = "dMatrix")</code>: ... </p>
</dd>
<dt>Math2</dt>
<dd>
<p><code>signature(x = "dMatrix", digits = "numeric")</code>:
this group contains <code><a href="https://r-universe.dev/manuals/base.html#Round">round</a>()</code> and <code><a href="https://r-universe.dev/manuals/base.html#Round">signif</a>()</code>.</p>
</dd>
<dt>Compare</dt>
<dd>
<p><code>signature(e1 = "numeric", e2 = "dMatrix")</code>: ... </p>
</dd>
<dt>Compare</dt>
<dd>
<p><code>signature(e1 = "dMatrix", e2 = "numeric")</code>: ... </p>
</dd>
<dt>Compare</dt>
<dd>
<p><code>signature(e1 = "dMatrix", e2 = "dMatrix")</code>: ... </p>
</dd>
<dt>Summary</dt>
<dd>
<p><code>signature(x = "dMatrix")</code>: The <code>"Summary"</code>
group contains the seven functions
<code><a href="https://r-universe.dev/manuals/base.html#Extremes">max</a>()</code>, <code><a href="https://r-universe.dev/manuals/base.html#Extremes">min</a>()</code>, <code><a href="https://r-universe.dev/manuals/base.html#range">range</a>()</code>,
<code><a href="https://r-universe.dev/manuals/base.html#prod">prod</a>()</code>, <code><a href="https://r-universe.dev/manuals/base.html#sum">sum</a>()</code>,
<code><a href="#all-methods">any</a>()</code>, and <code><a href="#all-methods">all</a>()</code>.</p>
</dd>
</dl>
<p>The following methods are also defined for all double matrices:
</p>

<dl>
<dt>expm</dt>
<dd>
<p><code>signature(x = "dMatrix")</code>: computes the
<em>“Matrix Exponential”</em>, see <code><a href="#expm">expm</a></code>.</p>
</dd>
<dt>zapsmall</dt>
<dd>
<p><code>signature(x = "dMatrix")</code>: ... </p>
</dd>
</dl>
<p>The following methods are defined for all logical matrices:
</p>

<dl>
<dt>which</dt>
<dd>
<p><code>signature(x = "lsparseMatrix")</code> and many other
subclasses of <code>"lMatrix"</code>: as the <span class="pkg">base</span> function
<code><a href="https://r-universe.dev/manuals/base.html#which">which</a>(x, arr.ind)</code> returns the indices of the
<code><a href="https://r-universe.dev/manuals/base.html#logical">TRUE</a></code> entries in <code>x</code>; if <code>arr.ind</code> is true,
as a 2-column matrix of row and column indices. Since <span class="pkg">Matrix</span>
version 1.2-9, if <code>useNames</code> is true, as by default, with
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>, the same as <code>base::which</code>.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>The nonzero-pattern matrix class <code><a href="#nMatrix-class">nMatrix</a></code>, which
can be used to store non-<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code> <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code>
matrices even more compactly.
</p>
<p>The numeric matrix classes <code><a href="#dgeMatrix-class">dgeMatrix</a></code>,
<code><a href="#dgCMatrix-class">dgCMatrix</a></code>, and <code><a href="#Matrix-class">Matrix</a></code>.
</p>
<p><code><a href="#drop0">drop0</a>(x, tol=1e-10)</code> is sometimes preferable to (and
more efficient than) <code>zapsmall(x, digits=10)</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"dMatrix"</span><span class="token punctuation">)</span>

 set.seed<span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span>
 round<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
 M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>rlnorm<span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">,</span> sd<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span>
 <span class="token punctuation">(</span>M. <span class="token operator">&lt;-</span> zapsmall<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span>
 table<span class="token punctuation">(</span>as.logical<span class="token punctuation">(</span>M. <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dmperm">

<a href="#dmperm" class="help-page-title"><h2 id="dmperm">Dulmage-Mendelsohn Permutation / Decomposition</h2></a>

<h3>Description</h3>

<p>For any <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> (typically) sparse matrix <code>x</code>
compute the Dulmage-Mendelsohn row and columns permutations which at
first splits the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> rows and <code>m</code> columns into coarse partitions
each; and then a finer one, reordering rows and columns such that the
permutated matrix is “as upper triangular” as possible.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">dmperm<span class="token punctuation">(</span>x<span class="token punctuation">,</span> nAns <span class="token operator">=</span> <span class="token number">6L</span><span class="token punctuation">,</span> seed <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="dmperm_:_x">x</code></td>
<td>
<p>a typically sparse matrix; internally coerced to either
<code>"<a href="#dgCMatrix-class">dgCMatrix</a>"</code> or
<code>"<a href="#dtCMatrix-class">dtCMatrix</a>"</code>.</p>
</td>
</tr>
<tr>
<td><code id="dmperm_:_nAns">nAns</code></td>
<td>
<p>an integer specifying the <code><a href="https://r-universe.dev/manuals/base.html#length">length</a></code> of the
resulting <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code>.  Must be 2, 4, or 6.

</p>
</td>
</tr>
<tr>
<td><code id="dmperm_:_seed">seed</code></td>
<td>
<p>an integer code in -1,0,1; determining the (initial)
permutation; by default, <code>seed = 0</code>, no (or the identity) permutation;
<code>seed = -1</code> uses the “reverse” permutation <code>k:1</code>; for
<code>seed = 1</code>, it is a <em>random</em> permutation (using R's RNG,
seed, etc).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the book section by Tim Davis; page 122–127, in the References.
</p>


<h3>Value</h3>

<p>a named <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> with (by default) 6 components,
</p>
<table>
<tr>
<td><code>p</code></td>
<td>
<p>integer vector with the permutation <code>p</code>, of length <code>nrow(x)</code>.</p>
</td>
</tr>
<tr>
<td><code>q</code></td>
<td>
<p>integer vector with the permutation <code>q</code>, of length <code>ncol(x)</code>.</p>
</td>
</tr>
<tr>
<td><code>r</code></td>
<td>
<p>integer vector of length <code>nb+1</code>, where block k is rows r[k] to r[k+1]-1 in A[p,q].</p>
</td>
</tr>
<tr>
<td><code>s</code></td>
<td>
<p>integer vector of length <code>nb+1</code>, where block k is cols s[k] to s[k+1]-1 in A[p,q].</p>
</td>
</tr>
<tr>
<td><code>rr5</code></td>
<td>
<p>integer vector of length 5, defining the coarse row
decomposition.</p>
</td>
</tr>
<tr>
<td><code>cc5</code></td>
<td>
<p>integer vector of length 5, defining the coarse column decomposition.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Martin Maechler, with a lot of “encouragement” by Mauricio
Vargas.
</p>


<h3>References</h3>

<p>Section 7.4 <em>Dulmage-Mendelsohn decomposition</em>, pp. 122 ff  of
<br>
Timothy A. Davis (2006)
<em>Direct Methods for Sparse Linear Systems</em>, SIAM Series
“Fundamentals of Algorithms”.
</p>


<h3>See Also</h3>

<p><code><a href="#Schur">Schur</a></code>, the class of permutation matrices; <code>"<a href="#pMatrix-class">pMatrix</a>"</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">set.seed<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>S9 <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> nnz <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> symmetric<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># dsCMatrix</span>
str<span class="token punctuation">(</span> dm9 <span class="token operator">&lt;-</span> dmperm<span class="token punctuation">(</span>S9<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token punctuation">(</span>S9p <span class="token operator">&lt;-</span> with<span class="token punctuation">(</span>dm9<span class="token punctuation">,</span> S9<span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## looks good, but *not* quite upper triangular; these, too:</span>
str<span class="token punctuation">(</span> dm9.<span class="token number">0</span> <span class="token operator">&lt;-</span> dmperm<span class="token punctuation">(</span>S9<span class="token punctuation">,</span> seed<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># non-random too.</span>
str<span class="token punctuation">(</span> dm9_1 <span class="token operator">&lt;-</span> dmperm<span class="token punctuation">(</span>S9<span class="token punctuation">,</span> seed<span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># a random one</span>
<span class="token comment">## The last two permutations differ, but have the same effect!</span>
<span class="token punctuation">(</span>S9p0 <span class="token operator">&lt;-</span> with<span class="token punctuation">(</span>dm9.<span class="token number">0</span><span class="token punctuation">,</span> S9<span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># .. hmm ..</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>S9p0<span class="token punctuation">,</span> S9p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># same as as default, but different from the random one</span>


set.seed<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> triu<span class="token punctuation">(</span>rsparsematrix<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dM <span class="token operator">&lt;-</span> dmperm<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">;</span> with<span class="token punctuation">(</span>dM<span class="token punctuation">,</span> M<span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>Mp <span class="token operator">&lt;-</span> M<span class="token punctuation">[</span>sample.int<span class="token punctuation">(</span>nrow<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sample.int<span class="token punctuation">(</span>ncol<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
dMp <span class="token operator">&lt;-</span> dmperm<span class="token punctuation">(</span>Mp<span class="token punctuation">)</span><span class="token punctuation">;</span> with<span class="token punctuation">(</span>dMp<span class="token punctuation">,</span> Mp<span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span>


set.seed<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>n7 <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> nnz <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> rand.x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span> dm.<span class="token number">7</span> <span class="token operator">&lt;-</span> dmperm<span class="token punctuation">(</span>n7<span class="token punctuation">)</span> <span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
  lengths<span class="token punctuation">(</span>dm.<span class="token number">7</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> dim<span class="token punctuation">(</span>n7<span class="token punctuation">)</span>
  identical<span class="token punctuation">(</span>dm.<span class="token number">7</span><span class="token punctuation">,</span>      dmperm<span class="token punctuation">(</span>as<span class="token punctuation">(</span>n7<span class="token punctuation">,</span> <span class="token string">"dMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  identical<span class="token punctuation">(</span>dm.<span class="token number">7</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dmperm<span class="token punctuation">(</span>n7<span class="token punctuation">,</span> nAns<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  identical<span class="token punctuation">(</span>dm.<span class="token number">7</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dmperm<span class="token punctuation">(</span>n7<span class="token punctuation">,</span> nAns<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dpoMatrix-class">

<a href="#dpoMatrix-class" class="help-page-title"><h2 id="dpoMatrix-class">Positive Semi-definite Dense (Packed | Non-packed) Numeric Matrices</h2></a>

<h3>Description</h3>


<ul>
<li>
<p>The <code>"dpoMatrix"</code> class is the class of
positive-semidefinite symmetric matrices in nonpacked storage.
</p>
</li>
<li>
<p>The <code>"dppMatrix"</code> class is the same except in packed
storage.  Only the upper triangle or the lower triangle is
required to be available.
</p>
</li>
<li>
<p>The <code>"corMatrix"</code> and <code>"pcorMatrix"</code> classes
represent correlation matrices.  They extend <code>"dpoMatrix"</code>
and <code>"dppMatrix"</code>, respectively, with an additional slot
<code>sd</code> allowing restoration of the original covariance matrix.
</p>
</li>
</ul>
<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the
form <code>new("dpoMatrix", ...)</code> or from <code>crossprod</code> applied to
an <code>"dgeMatrix"</code> object.</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>. The numeric
values that constitute the matrix, stored in column-major order.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code>. The dimensions
of the matrix which must be a two-element vector of non-negative
integers.</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>inherited from class <code>"Matrix"</code></p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code>.  A named
list of factorizations that have been computed for the matrix.</p>
</dd>
<dt>
<code>sd</code>:</dt>
<dd>
<p>(for <code>"corMatrix"</code> and <code>"pcorMatrix"</code>)
a <code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code> vector of length <code>n</code> containing the
(original) <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mo stretchy="false">)</mo></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{var(.)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.305em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord">.</span><span class="mclose">)</span></span></span><span style="top:-2.895em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305em;"><span></span></span></span></span></span></span></span></span></code> entries which allow
reconstruction of a covariance matrix from the correlation matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"dsyMatrix"</code>, directly.<br>
Classes <code>"dgeMatrix"</code>, <code>"symmetricMatrix"</code>, and many more
by class <code>"dsyMatrix"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>chol</dt>
<dd>
<p><code>signature(x = "dpoMatrix")</code>:
Returns (and stores) the Cholesky decomposition of <code>x</code>, see
<code><a href="#chol">chol</a></code>.</p>
</dd>
<dt>determinant</dt>
<dd>
<p><code>signature(x = "dpoMatrix")</code>:
Returns the <code><a href="https://r-universe.dev/manuals/base.html#det">determinant</a></code> of <code>x</code>, via
<code>chol(x)</code>, see above.</p>
</dd>
<dt>rcond</dt>
<dd>
<p><code>signature(x = "dpoMatrix", norm = "character")</code>:
Returns (and stores) the reciprocal of the condition number of
<code>x</code>.  The <code>norm</code> can be <code>"O"</code> for the
one-norm (the default) or <code>"I"</code> for the infinity-norm.  For
symmetric matrices the result does not depend on the norm.</p>
</dd>
<dt>solve</dt>
<dd>
<p><code>signature(a = "dpoMatrix", b = "....")</code></p>
</dd>
</dl>
<p>, and
</p>
<dl>
<dt>solve</dt>
<dd>
<p><code>signature(a = "dppMatrix", b = "....")</code></p>
</dd>
</dl>
<p>work
via the Cholesky composition, see also the Matrix <code><a href="#solve-methods">solve-methods</a></code>.
</p>
<dl>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "dpoMatrix", e2 = "numeric")</code> (and
quite a few other signatures): The result of (“elementwise”
defined) arithmetic operations is typically <em>not</em>
positive-definite anymore.  The only exceptions, currently, are
multiplications, divisions or additions with <em>positive</em>
<code>length(.) == 1</code> numbers (or <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code>s).</p>
</dd>
</dl>
<h3>Note</h3>

<p>Currently the validity methods for these classes such as
<code><a href="https://r-universe.dev/manuals/methods.html#validObject">getValidity</a>(getClass("dpoMatrix"))</code> for efficiency reasons
only check the diagonal entries of the matrix – they may not be negative.
This is only necessary but not sufficient for a symmetric matrix to be
positive semi-definite.
</p>
<p>A more reliable (but often more expensive) check for positive
semi-definiteness would look at the signs of <code>diag(<a href="#BunchKaufman-methods">BunchKaufman</a>(.))</code>
(with some tolerance for very small negative values), and for (strict)
positive definiteness at something like
<code>!inherits(tryCatch(chol(.), error=identity), "error")</code> .
Indeed, when <em>coercing</em> to these classes, a version
of <code><a href="#Cholesky">Cholesky</a>()</code> or <code><a href="#chol">chol</a>()</code> is
typically used, e.g., see <code>selectMethod("coerce",
    c(from="dsyMatrix", to="dpoMatrix"))</code> .
</p>


<h3>See Also</h3>

<p>Classes <code><a href="#dsyMatrix-class">dsyMatrix</a></code> and <code><a href="#dgeMatrix-class">dgeMatrix</a></code>;
further, <code><a href="#Matrix">Matrix</a></code>, <code><a href="#rcond">rcond</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#chol">chol</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#solve">solve</a></code>, <code><a href="#matrix-products">crossprod</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">h6 <span class="token operator">&lt;-</span> Hilbert<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
rcond<span class="token punctuation">(</span>h6<span class="token punctuation">)</span>
str<span class="token punctuation">(</span>h6<span class="token punctuation">)</span>
h6 <span class="token operator">*</span> <span class="token number">27720</span> <span class="token comment"># is ``integer''</span>
solve<span class="token punctuation">(</span>h6<span class="token punctuation">)</span>
str<span class="token punctuation">(</span>hp6 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>h6<span class="token punctuation">,</span> <span class="token string">"dppMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">### Note that  as(*, "corMatrix")  *scales* the matrix</span>
<span class="token punctuation">(</span>ch6 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>h6<span class="token punctuation">,</span> <span class="token string">"corMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>h6 <span class="token operator">*</span> <span class="token number">27720</span><span class="token punctuation">,</span> round<span class="token punctuation">(</span><span class="token number">27720</span> <span class="token operator">*</span> h6<span class="token punctuation">)</span><span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">1e-14</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          all.equal<span class="token punctuation">(</span>ch6<span class="token operator">@</span>sd<span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> tolerance<span class="token operator">=</span> <span class="token number">1e-12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
chch <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>ch6<span class="token punctuation">,</span> perm <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>chch<span class="token punctuation">,</span> ch6<span class="token operator">@</span>factors<span class="token operator">$</span>Cholesky<span class="token punctuation">)</span><span class="token punctuation">,</span>
          all<span class="token punctuation">(</span>abs<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>as<span class="token punctuation">(</span>chch<span class="token punctuation">,</span> <span class="token string">"dtrMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> ch6<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1e-10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="drop0">

<a href="#drop0" class="help-page-title"><h2 id="drop0">Drop Non-Structural Zeros from a Sparse Matrix</h2></a>

<h3>Description</h3>

<p>Deletes “non-structural” zeros (i.e., zeros stored explicitly,
in memory) from a sparse matrix and returns the result.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">drop0<span class="token punctuation">(</span>x<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> is.Csparse <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> give.Csparse <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="drop0_:_x">x</code></td>
<td>
<p>a <code><a href="#Matrix-class">Matrix</a></code>, typically inheriting
from virtual class <code><a href="#sparseMatrix-class">sparseMatrix</a></code>.
<code><a href="#denseMatrix-class">denseMatrix</a></code> and traditional vectors and
matrices are coerced to <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>,
with zeros dropped automatically, hence users passing such
<code>x</code> should consider <code>as(x, "CsparseMatrix")</code> instead,
notably in the <code>tol = 0</code> case.</p>
</td>
</tr>
<tr>
<td><code id="drop0_:_tol">tol</code></td>
<td>
<p>a non-negative number.  If <code>x</code> is numeric,
then entries less than or equal to <code>tol</code> in absolute value
are deleted.</p>
</td>
</tr>
<tr>
<td><code id="drop0_:_is.Csparse">is.Csparse</code></td>
<td>
<p>a logical used only if <code>give.Csparse</code>
is <code>TRUE</code>, indicating if <code>x</code> already inherits from
virtual class <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>, in which
case coercion is not attempted, permitting some (typically
small) speed-up.</p>
</td>
</tr>
<tr>
<td><code id="drop0_:_give.Csparse">give.Csparse</code></td>
<td>
<p>a logical indicating if the result must
inherit from virtual class <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>.
If <code>FALSE</code> and <code>x</code> inherits from
<code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>,
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>, or
<code><a href="#indMatrix-class">indMatrix</a></code>,
then the result preserves the class of <code>x</code>.
The default value is <code>TRUE</code> only for backwards compatibility.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code><a href="#sparseMatrix-class">sparseMatrix</a></code>, the result of deleting
non-structural zeros from <code>x</code>, possibly after coercion.
</p>


<h3>Note</h3>

<p><code>drop0</code> is sometimes called in conjunction with
<code><a href="https://r-universe.dev/manuals/base.html#zapsmall">zapsmall</a></code>, e.g., when dealing with sparse
matrix products; see the example.
</p>


<h3>See Also</h3>

<p>Function <code><a href="#sparseMatrix">sparseMatrix</a></code>, for constructing objects
inheriting from virtual class <code><a href="#sparseMatrix-class">sparseMatrix</a></code>;
<code><a href="#nnzero">nnzero</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>m <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   dims <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">10L</span><span class="token punctuation">,</span> <span class="token number">20L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
drop0<span class="token punctuation">(</span>m<span class="token punctuation">)</span>

<span class="token comment">## A larger example:</span>
t5 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dtCMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">5L</span><span class="token punctuation">,</span> <span class="token number">5L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"L"</span><span class="token punctuation">,</span>
          x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span><span class="token number">2L</span><span class="token punctuation">,</span><span class="token number">4L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span><span class="token number">2L</span><span class="token punctuation">,</span><span class="token number">4L</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">4L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          p <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">5L</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
TT <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>t5<span class="token punctuation">,</span> kronecker<span class="token punctuation">(</span>kronecker<span class="token punctuation">(</span>t5<span class="token punctuation">,</span> t5<span class="token punctuation">)</span><span class="token punctuation">,</span> t5<span class="token punctuation">)</span><span class="token punctuation">)</span>
IT <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>TT<span class="token punctuation">)</span>
I. <span class="token operator">&lt;-</span> TT <span class="token percent-operator operator">%*%</span> IT <span class="token punctuation">;</span>  nnzero<span class="token punctuation">(</span>I.<span class="token punctuation">)</span> <span class="token comment"># 697 ( == 625 + 72 )</span>
I.<span class="token number">0</span> <span class="token operator">&lt;-</span> drop0<span class="token punctuation">(</span>zapsmall<span class="token punctuation">(</span>I.<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## which actually can be more efficiently achieved by</span>
I.. <span class="token operator">&lt;-</span> drop0<span class="token punctuation">(</span>I.<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">1e-15</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>I.<span class="token number">0</span> <span class="token operator">==</span> Diagonal<span class="token punctuation">(</span><span class="token number">625</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nnzero<span class="token punctuation">(</span>I..<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">625</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dsCMatrix-class">

<a href="#dsCMatrix-class" class="help-page-title"><h2 id="dsCMatrix-class">Numeric Symmetric Sparse (column compressed) Matrices</h2></a>

<h3>Description</h3>

<p>The <code>dsCMatrix</code> class is a class of symmetric, sparse
numeric matrices in the compressed, <b>c</b>olumn-oriented format.  In
this implementation the non-zero elements in the columns are sorted
into increasing row order.
</p>
<p>The <code>dsTMatrix</code> class is the class of symmetric, sparse numeric
matrices in <b>t</b>riplet format.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("dsCMatrix",
    ...)</code> or <code>new("dsTMatrix", ...)</code>, or automatically via e.g.,
<code>as(*, "symmetricMatrix")</code>, or (for <code>dsCMatrix</code>) also
from <code><a href="#Matrix">Matrix</a>(.)</code>.
</p>
<p>Creation “from scratch” most efficiently happens via
<code><a href="#sparseMatrix">sparseMatrix</a>(*, symmetric=TRUE)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>A character object indicating if the upper
triangle (<code>"U"</code>) or the lower triangle (<code>"L"</code>) is stored.</p>
</dd>
<dt>
<code>i</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length nnZ
(<em>half</em> number of non-zero elements).  These are the row
numbers for each non-zero element in the lower triangle of the matrix.</p>
</dd>
<dt>
<code>p</code>:</dt>
<dd>
<p>(only in class <code>"dsCMatrix"</code>:) an
<code><a href="https://r-universe.dev/manuals/base.html#integer">integer</a></code> vector for providing pointers, one for each
column, see the detailed description in <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>.</p>
</dd>
<dt>
<code>j</code>:</dt>
<dd>
<p>(only in class <code>"dsTMatrix"</code>:) Object of
class <code>"integer"</code> of length nnZ (as <code>i</code>).  These are the
column numbers for each non-zero element in the lower triangle of
the matrix.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code> of length nnZ –
the non-zero elements of the matrix (to be duplicated for full matrix).</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> - a list
of factorizations of the matrix. </p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the dimensions
of the matrix - must be an integer vector with exactly two
non-negative values.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Both classes extend classes and <code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>
<code><a href="#dsparseMatrix-class">dsparseMatrix</a></code> directly;
<code>dsCMatrix</code> further directly extends
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>, where
<code>dsTMatrix</code> does <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>.
</p>


<h3>Methods</h3>


<dl>
<dt>solve</dt>
<dd>
<p><code>signature(a = "dsCMatrix", b = "....")</code>: <code>x
	&lt;- solve(a,b)</code> solves <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">A x = b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></code> for <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code>; see
<code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
<dt>chol</dt>
<dd>
<p><code>signature(x = "dsCMatrix", pivot = "logical")</code>:
Returns (and stores) the Cholesky decomposition of <code>x</code>, see
<code><a href="#chol">chol</a></code>.</p>
</dd>
<dt>Cholesky</dt>
<dd>
<p><code>signature(A = "dsCMatrix",...)</code>:
Computes more flexibly Cholesky decompositions,
see <code><a href="#Cholesky">Cholesky</a></code>.</p>
</dd>
<dt>determinant</dt>
<dd>
<p><code>signature(x = "dsCMatrix", logarithm =
	"missing")</code>: Evaluate the determinant of <code>x</code> on the
logarithm scale.  This creates and stores the Cholesky factorization.</p>
</dd>
<dt>determinant</dt>
<dd>
<p><code>signature(x = "dsCMatrix", logarithm =
	"logical")</code>: Evaluate the determinant of <code>x</code> on the
logarithm scale or not, according to the <code>logarithm</code>
argument.  This creates and stores the Cholesky factorization.</p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "dsCMatrix")</code>: Transpose.  As for all
symmetric matrices, a matrix for which the upper triangle is
stored produces a matrix for which the lower triangle is stored
and vice versa, i.e., the <code>uplo</code> slot is swapped, and the row
and column indices are interchanged.</p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "dsTMatrix")</code>: Transpose.  The
<code>uplo</code> slot is swapped from <code>"U"</code> to <code>"L"</code> or vice
versa, as for a <code>"dsCMatrix"</code>, see above.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Classes <code><a href="#dgCMatrix-class">dgCMatrix</a></code>, <code><a href="#dgTMatrix-class">dgTMatrix</a></code>,
<code><a href="#dgeMatrix-class">dgeMatrix</a></code> and those mentioned above.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">mm <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>toeplitz<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
mm <span class="token comment"># automatically dsCMatrix</span>
str<span class="token punctuation">(</span>mm<span class="token punctuation">)</span>
mT <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>as<span class="token punctuation">(</span>mm<span class="token punctuation">,</span> <span class="token string">"generalMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"TsparseMatrix"</span><span class="token punctuation">)</span>

<span class="token comment">## Either</span>
<span class="token punctuation">(</span>symM <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>mT<span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># dsT</span>
<span class="token punctuation">(</span>symC <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>symM<span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># dsC</span>
<span class="token comment">## or</span>
sT <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>mT<span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> forceCheck<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># dsT</span>

sym2 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>symC<span class="token punctuation">,</span> <span class="token string">"TsparseMatrix"</span><span class="token punctuation">)</span>
<span class="token comment">## --&gt; the same as 'symM', a "dsTMatrix"</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dsparseMatrix-class">

<a href="#dsparseMatrix-class" class="help-page-title"><h2 id="dsparseMatrix-class">Virtual Class "dsparseMatrix" of Numeric Sparse Matrices</h2></a>

<h3>Description</h3>

<p>The Class <code>"dsparseMatrix"</code> is the virtual (super) class of
all numeric sparse matrices.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>the matrix dimension, see class <code>"<a href="#Matrix-class">Matrix</a>"</code>.</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>see the <code>"Matrix"</code> class.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code> vector containing the
(non-zero) matrix entries.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"dMatrix"</code> and <code>"sparseMatrix"</code>, directly.<br>
Class <code>"Matrix"</code>, by the above classes.
</p>


<h3>See Also</h3>

<p>the documentation of the (non virtual) sub classes, see
<code>showClass("dsparseMatrix")</code>; in particular,
<a href="#dgTMatrix-class">dgTMatrix</a>, <a href="#dgCMatrix-class">dgCMatrix</a>, and
<a href="#dgRMatrix-class">dgRMatrix</a>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"dsparseMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dsRMatrix-class">

<a href="#dsRMatrix-class" class="help-page-title"><h2 id="dsRMatrix-class">Symmetric Sparse Compressed Row Matrices</h2></a>

<h3>Description</h3>

<p>The <code>dsRMatrix</code> class is a class of symmetric, sparse
matrices in the compressed, row-oriented format.  In this
implementation the non-zero elements in the rows are sorted into
increasing column order.
</p>


<h3>Objects from the Class</h3>

<p>These <code>"..RMatrix"</code> classes are currently still mostly unimplemented!
</p>
<p>Objects can be created by calls of the form <code>new("dsRMatrix", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>A character object indicating if the upper
triangle (<code>"U"</code>) or the lower triangle (<code>"L"</code>) is
stored.  At present only the lower triangle form is allowed.</p>
</dd>
<dt>
<code>j</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length
<code>nnzero</code> (number of non-zero elements).  These are the row
numbers for each non-zero element in the matrix.</p>
</dd>
<dt>
<code>p</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of pointers, one
for each row, to the initial (zero-based) index of elements in
the row.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> - a list
of factorizations of the matrix.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code> - the non-zero
elements of the matrix.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the dimensions
of the matrix - must be an integer vector with exactly two
non-negative values.</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>List of length two, see <code><a href="#Matrix">Matrix</a></code>.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Classes <code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>, <code><a href="#dsparseMatrix-class">dsparseMatrix</a></code> and
<code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>, directly.
</p>
<p>Class <code>"dMatrix"</code>, by class <code>"dsparseMatrix"</code>,
class <code>"sparseMatrix"</code>, by class <code>"dsparseMatrix"</code> or
<code>"RsparseMatrix"</code>;
class <code>"compMatrix"</code> by class <code>"symmetricMatrix"</code> and of course,
class <code>"Matrix"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>forceSymmetric</dt>
<dd>
<p><code>signature(x = "dsRMatrix", uplo = "missing")</code>:
a trivial method just returning <code>x</code></p>
</dd>
<dt>forceSymmetric</dt>
<dd>
<p><code>signature(x = "dsRMatrix", uplo = "character")</code>:
if <code>uplo == x@uplo</code>, this trivially returns <code>x</code>;
otherwise <code>t(x)</code>.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>the classes <code><a href="#dgCMatrix-class">dgCMatrix</a></code>,
<code><a href="#dgTMatrix-class">dgTMatrix</a></code>, and <code><a href="#dgeMatrix-class">dgeMatrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>m0 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dsRMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
m2 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dsRMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span><span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>
m2
stopifnot<span class="token punctuation">(</span>colSums<span class="token punctuation">(</span>as<span class="token punctuation">(</span>m2<span class="token punctuation">,</span> <span class="token string">"TsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>m2<span class="token punctuation">)</span>
<span class="token punctuation">(</span>ds2 <span class="token operator">&lt;-</span> forceSymmetric<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># dsy*</span>
dR <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token string">"RsparseMatrix"</span><span class="token punctuation">)</span>
dR <span class="token comment"># dsRMatrix</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dsyMatrix-class">

<a href="#dsyMatrix-class" class="help-page-title"><h2 id="dsyMatrix-class">Symmetric Dense (Packed or Unpacked) Numeric Matrices</h2></a>

<h3>Description</h3>


<ul>
<li>
<p>The <code>"dsyMatrix"</code> class is the class of symmetric, dense matrices
in <em>non-packed</em> storage and
</p>
</li>
<li>
<p><code>"dspMatrix"</code> is the class of symmetric dense matrices in
<em>packed</em> storage, see <code><a href="#unpack">pack</a>()</code>.  Only the upper
triangle or the lower triangle is stored.
</p>
</li>
</ul>
<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("dsyMatrix",
    ...)</code> or <code>new("dspMatrix", ...)</code>, respectively.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>. The numeric
values that constitute the matrix, stored in column-major order.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>), see the
<code><a href="#Matrix-class">Matrix</a></code>.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code>.  A named
list of factorizations that have been computed for the matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p><code>"dsyMatrix"</code> extends class <code>"dgeMatrix"</code>, directly, whereas<br><code>"dspMatrix"</code> extends class <code>"ddenseMatrix"</code>, directly.
</p>
<p>Both extend class <code>"symmetricMatrix"</code>, directly,
and class <code>"Matrix"</code> and others, <em>in</em>directly, use
<code><a href="https://r-universe.dev/manuals/methods.html#RClassUtils">showClass</a>("dsyMatrix")</code>, e.g., for details.
</p>


<h3>Methods</h3>


<dl>
<dt>norm</dt>
<dd>
<p><code>signature(x = "dspMatrix", type = "character")</code>, or
<code>x = "dsyMatrix"</code> or <code>type = "missing"</code>: Computes the
matrix norm of the desired type, see, <code><a href="#norm">norm</a></code>.</p>
</dd>
<dt>rcond</dt>
<dd>
<p><code>signature(x = "dspMatrix", type = "character")</code>, or
<code>x = "dsyMatrix"</code> or <code>type = "missing"</code>: Computes the
reciprocal condition number, <code><a href="#rcond">rcond</a>()</code>.</p>
</dd>
<dt>solve</dt>
<dd>
<p><code>signature(a = "dspMatrix", b = "....")</code>, and</p>
</dd>
<dt>solve</dt>
<dd>
<p><code>signature(a = "dsyMatrix", b = "....")</code>: <code>x
	&lt;- solve(a,b)</code> solves <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">A x = b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></code> for <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code>; see
<code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "dsyMatrix")</code>: Transpose; swaps from
upper triangular to lower triangular storage, i.e., the uplo slot
from <code>"U"</code> to <code>"L"</code> or vice versa, the same as for all
symmetric matrices.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>The <em>positive (Semi-)definite</em> dense (packed or non-packed
numeric matrix classes <code><a href="#dpoMatrix-class">dpoMatrix</a></code>,
<code><a href="#dpoMatrix-class">dppMatrix</a></code> and <code><a href="#dpoMatrix-class">corMatrix</a></code>,
</p>
<p>Classes <code><a href="#dgeMatrix-class">dgeMatrix</a></code> and <code><a href="#Matrix-class">Matrix</a></code>;
<code><a href="https://r-universe.dev/manuals/base.html#solve">solve</a></code>, <code><a href="#norm">norm</a></code>, <code><a href="#rcond">rcond</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#t">t</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Only upper triangular part matters (when uplo == "U" as per default)</span>
<span class="token punctuation">(</span>sy2 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dsyMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> as.integer<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>t<span class="token punctuation">(</span>sy2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># uplo = "L", and the lower tri. (i.e. NA is replaced).</span>

chol<span class="token punctuation">(</span>sy2<span class="token punctuation">)</span> <span class="token comment">#-&gt; "Cholesky" matrix</span>
<span class="token punctuation">(</span>sp2 <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>sy2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># a "dspMatrix"</span>

<span class="token comment">## Coercing to dpoMatrix gives invalid object:</span>
sy3 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dsyMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> as.integer<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
try<span class="token punctuation">(</span>as<span class="token punctuation">(</span>sy3<span class="token punctuation">,</span> <span class="token string">"dpoMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; error: not positive definite</span>


<span class="token comment">## 4x4 example</span>
m <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> m<span class="token punctuation">[</span>upper.tri<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span>
<span class="token punctuation">(</span>sym <span class="token operator">&lt;-</span> m<span class="token operator">+</span>t<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">+</span>diag<span class="token punctuation">(</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>S1 <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>sym<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>S2 <span class="token operator">&lt;-</span> t<span class="token punctuation">(</span>S1<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>S1 <span class="token operator">==</span> S2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># equal "seen as matrix", but differ internally :</span>
str<span class="token punctuation">(</span>S1<span class="token punctuation">)</span>
S2<span class="token operator">@</span>x</code></pre>

<hr>
</div>
<div class="container manual-page" id="dtCMatrix-class">

<a href="#dtCMatrix-class" class="help-page-title"><h2 id="dtCMatrix-class">Triangular, (compressed) sparse column matrices</h2></a>

<h3>Description</h3>

<p>The <code>"dtCMatrix"</code> class is a class of triangular, sparse
matrices in the compressed, column-oriented format.  In this
implementation the non-zero elements in the columns are sorted into
increasing row order.
</p>
<p>The <code>"dtTMatrix"</code> class is a class of triangular, sparse matrices
in triplet format.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("dtCMatrix",
    ...)</code> or calls of the form  <code>new("dtTMatrix", ...)</code>,
but more typically automatically via <code><a href="#Matrix">Matrix</a>()</code>
or coercions such as <code>as(x, "triangularMatrix")</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either <code>"U"</code>, for unit triangular (diagonal is all ones), or
<code>"N"</code>; see <code><a href="#triangularMatrix-class">triangularMatrix</a></code>.</p>
</dd>
<dt>
<code>p</code>:</dt>
<dd>
<p>(only present in <code>"dtCMatrix"</code>:) an
<code><a href="https://r-universe.dev/manuals/base.html#integer">integer</a></code> vector for providing pointers, one for each
column, see the detailed description in <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>.</p>
</dd>
<dt>
<code>i</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length nnzero
(number of non-zero elements).  These are the row numbers for
each non-zero element in the matrix.</p>
</dd>
<dt>
<code>j</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length nnzero
(number of non-zero elements).  These are the column numbers for
each non-zero element in the matrix. (Only present in the
<code>dtTMatrix</code> class.)</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code> - the non-zero
elements of the matrix.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>),
inherited from the <code><a href="#Matrix-class">Matrix</a></code>, see there.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"dgCMatrix"</code>, directly.
Class <code>"triangularMatrix"</code>, directly.
Class <code>"dMatrix"</code>, <code>"sparseMatrix"</code>, and more by class
<code>"dgCMatrix"</code> etc, see the examples.
</p>


<h3>Methods</h3>


<dl>
<dt>solve</dt>
<dd>
<p><code>signature(a = "dtCMatrix", b = "....")</code>:
sparse triangular solve (aka “backsolve” or
“forwardsolve”), see <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "dtCMatrix")</code>: returns the transpose of
<code>x</code></p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "dtTMatrix")</code>: returns the transpose of
<code>x</code></p>
</dd>
</dl>
<h3>See Also</h3>

<p>Classes <code><a href="#dgCMatrix-class">dgCMatrix</a></code>, <code><a href="#dgTMatrix-class">dgTMatrix</a></code>,
<code><a href="#dgeMatrix-class">dgeMatrix</a></code>, and <code><a href="#dtrMatrix-class">dtrMatrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"dtCMatrix"</span><span class="token punctuation">)</span>
showClass<span class="token punctuation">(</span><span class="token string">"dtTMatrix"</span><span class="token punctuation">)</span>
t1 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dtTMatrix"</span><span class="token punctuation">,</span> x<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> Dim<span class="token operator">=</span> as.integer<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
t1
<span class="token comment">## from  0-diagonal to unit-diagonal {low-level step}:</span>
tu <span class="token operator">&lt;-</span> t1 <span class="token punctuation">;</span> tu<span class="token operator">@</span>diag <span class="token operator">&lt;-</span> <span class="token string">"U"</span>
tu
<span class="token punctuation">(</span>cu <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>tu<span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>cu<span class="token punctuation">)</span><span class="token comment"># only two entries in @i and @x</span>
stopifnot<span class="token punctuation">(</span>cu<span class="token operator">@</span>i <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
          all<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> symmpart<span class="token punctuation">(</span>cu<span class="token punctuation">)</span> <span class="token operator">==</span> Diagonal<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> forceSymmetric<span class="token punctuation">(</span>cu<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

t1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">2</span>
diag<span class="token punctuation">(</span>t1<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">*</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>
t1 <span class="token comment"># still triangular</span>
<span class="token punctuation">(</span>it1 <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">)</span>
t1. <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>it1<span class="token punctuation">)</span>
all<span class="token punctuation">(</span>abs<span class="token punctuation">(</span>t1 <span class="token operator">-</span> t1.<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">*</span> .Machine<span class="token operator">$</span>double.eps<span class="token punctuation">)</span>

<span class="token comment">## 2nd example</span>
U5 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dtCMatrix"</span><span class="token punctuation">,</span> i<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span><span class="token number">0L</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">5L</span><span class="token punctuation">,</span> <span class="token number">5L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          x <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">)</span>
U5
<span class="token punctuation">(</span>iu <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>U5<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># contains one '0'</span>
validObject<span class="token punctuation">(</span>iu2 <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>U5<span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># failed in earlier versions</span>

I5 <span class="token operator">&lt;-</span> iu  <span class="token percent-operator operator">%*%</span> U5 <span class="token comment"># should equal the identity matrix</span>
i5 <span class="token operator">&lt;-</span> iu2 <span class="token percent-operator operator">%*%</span> U5
m53 <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> dimnames<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span>letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
asDiag <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span> as<span class="token punctuation">(</span>drop0<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"diagonalMatrix"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>
   all.equal<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> asDiag<span class="token punctuation">(</span>I5<span class="token punctuation">)</span><span class="token punctuation">,</span> tolerance<span class="token operator">=</span><span class="token number">1e-14</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
   all.equal<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> asDiag<span class="token punctuation">(</span>i5<span class="token punctuation">)</span><span class="token punctuation">,</span> tolerance<span class="token operator">=</span><span class="token number">1e-14</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
   identical<span class="token punctuation">(</span>list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> dimnames<span class="token punctuation">(</span>m53<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dimnames<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>U5<span class="token punctuation">,</span> m53<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dtpMatrix-class">

<a href="#dtpMatrix-class" class="help-page-title"><h2 id="dtpMatrix-class">Packed Triangular Dense Matrices - "dtpMatrix"</h2></a>

<h3>Description</h3>

<p>The <code>"dtpMatrix"</code> class is the class of triangular,
dense, numeric matrices in packed storage.  The <code>"dtrMatrix"</code>
class is the same except in nonpacked storage.</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("dtpMatrix",
    ...)</code> or by coercion from other classes of matrices.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either <code>"U"</code>, for unit triangular (diagonal is all ones), or
<code>"N"</code>; see <code><a href="#triangularMatrix-class">triangularMatrix</a></code>.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>. The numeric
values that constitute the matrix, stored in column-major order.
For a packed square matrix of dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">d \times d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code>,
<code>length(x)</code> is of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>d</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">d(d+1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code> (also when
<code>diag == "U"</code>!).</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>),
inherited from the <code><a href="#Matrix-class">Matrix</a></code>, see there.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"ddenseMatrix"</code>, directly.
Class <code>"triangularMatrix"</code>, directly.
Class <code>"dMatrix"</code> and more by class <code>"ddenseMatrix"</code> etc, see
the examples.
</p>


<h3>Methods</h3>


<dl>
<dt>%*%</dt>
<dd>
<p><code>signature(x = "dtpMatrix", y = "dgeMatrix")</code>:
Matrix multiplication; ditto for several other signature
combinations, see <code>showMethods("%*%", class = "dtpMatrix")</code>.</p>
</dd>
<dt>determinant</dt>
<dd>
<p><code>signature(x = "dtpMatrix", logarithm = "logical")</code>:
the <code><a href="https://r-universe.dev/manuals/base.html#det">determinant</a>(x)</code> trivially is
<code>prod(diag(x))</code>, but computed on log scale to prevent over-
and underflow.</p>
</dd>
<dt>diag</dt>
<dd>
<p><code>signature(x = "dtpMatrix")</code>: ... </p>
</dd>
<dt>norm</dt>
<dd>
<p><code>signature(x = "dtpMatrix", type = "character")</code>: ... </p>
</dd>
<dt>rcond</dt>
<dd>
<p><code>signature(x = "dtpMatrix", norm = "character")</code>: ... </p>
</dd>
<dt>solve</dt>
<dd>
<p><code>signature(a = "dtpMatrix", b = "...")</code>:
efficiently using internal backsolve or forwardsolve, see
<code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "dtpMatrix")</code>: <code>t(x)</code> remains
a <code>"dtpMatrix"</code>, lower triangular if <code>x</code> is upper
triangular, and vice versa.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Class <code><a href="#dtrMatrix-class">dtrMatrix</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"dtrMatrix"</span><span class="token punctuation">)</span>

example<span class="token punctuation">(</span><span class="token string">"dtrMatrix-class"</span><span class="token punctuation">,</span> echo<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>p1 <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>T2<span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>pp <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span>
ip1 <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>length<span class="token punctuation">(</span>p1<span class="token operator">@</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">,</span> length<span class="token punctuation">(</span>pp<span class="token operator">@</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">,</span>
          p1 <span class="token operator">@</span> uplo <span class="token operator">==</span> T2 <span class="token operator">@</span> uplo<span class="token punctuation">,</span> pp <span class="token operator">@</span> uplo <span class="token operator">==</span> T <span class="token operator">@</span> uplo<span class="token punctuation">,</span>
	  identical<span class="token punctuation">(</span>t<span class="token punctuation">(</span>pp<span class="token punctuation">)</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span><span class="token punctuation">,</span> identical<span class="token punctuation">(</span>t<span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">,</span> pp<span class="token punctuation">)</span><span class="token punctuation">,</span>
	  all<span class="token punctuation">(</span><span class="token punctuation">(</span>l.d <span class="token operator">&lt;-</span> p1 <span class="token operator">-</span> T2<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> is<span class="token punctuation">(</span>l.d<span class="token punctuation">,</span> <span class="token string">"dtpMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  all<span class="token punctuation">(</span><span class="token punctuation">(</span>u.d <span class="token operator">&lt;-</span> pp <span class="token operator">-</span> T <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> is<span class="token punctuation">(</span>u.d<span class="token punctuation">,</span> <span class="token string">"dtpMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  l.d<span class="token operator">@</span>uplo <span class="token operator">==</span> T2<span class="token operator">@</span>uplo<span class="token punctuation">,</span> u.d<span class="token operator">@</span>uplo <span class="token operator">==</span> T<span class="token operator">@</span>uplo<span class="token punctuation">,</span>
	  identical<span class="token punctuation">(</span>t<span class="token punctuation">(</span>ip1<span class="token punctuation">)</span><span class="token punctuation">,</span> solve<span class="token punctuation">(</span>pp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> is<span class="token punctuation">(</span>ip1<span class="token punctuation">,</span> <span class="token string">"dtpMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>p1<span class="token punctuation">,</span>p1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"diagonalMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dtrMatrix-class">

<a href="#dtrMatrix-class" class="help-page-title"><h2 id="dtrMatrix-class">Triangular, dense, numeric matrices</h2></a>

<h3>Description</h3>

<p>The <code>"dtrMatrix"</code> class is the class of triangular, dense,
numeric matrices in nonpacked storage.  The <code>"dtpMatrix"</code> class
is the same except in packed storage, see <code><a href="#unpack">pack</a>()</code>.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("dtrMatrix", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either <code>"U"</code>, for unit triangular (diagonal is all ones), or
<code>"N"</code>; see <code><a href="#triangularMatrix-class">triangularMatrix</a></code>.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>. The numeric
values that constitute the matrix, stored in column-major order.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code>. The dimensions
of the matrix which must be a two-element vector of non-negative
integers.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"ddenseMatrix"</code>, directly.
Class <code>"triangularMatrix"</code>, directly.
Class <code>"Matrix"</code> and others, by class <code>"ddenseMatrix"</code>.
</p>


<h3>Methods</h3>

<p>Among others (such as matrix products, e.g. <code>?<a href="#matrix-products">crossprod-methods</a></code>),
</p>

<dl>
<dt>norm</dt>
<dd>
<p><code>signature(x = "dtrMatrix", type = "character")</code></p>
</dd>
<dt>rcond</dt>
<dd>
<p><code>signature(x = "dtrMatrix", norm = "character")</code></p>
</dd>
<dt>solve</dt>
<dd>
<p><code>signature(a = "dtrMatrix", b = "....")</code></p>
</dd>
</dl>
<p>efficientely
use a “forwardsolve” or <code>backsolve</code> for a lower or
upper triangular matrix, respectively, see also
<code><a href="#solve-methods">solve-methods</a></code>.
</p>
<dl>
<dt>+, -, *, ..., ==, &gt;=, ...</dt>
<dd>
<p>all the <code><a href="https://r-universe.dev/manuals/methods.html#S4groupGeneric">Ops</a></code> group
methods are available.  When applied to two triangular matrices,
these return a triangular matrix when easily possible.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Classes <code><a href="#ddenseMatrix-class">ddenseMatrix</a></code>, <code><a href="#dtpMatrix-class">dtpMatrix</a></code>,
<code><a href="#triangularMatrix-class">triangularMatrix</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>m <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">"generalMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>T <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>M<span class="token punctuation">,</span> <span class="token string">"triangularMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># formally upper triangular</span>
<span class="token punctuation">(</span>T2 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>t<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"triangularMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>T<span class="token operator">@</span>uplo <span class="token operator">==</span> <span class="token string">"U"</span><span class="token punctuation">,</span> T2<span class="token operator">@</span>uplo <span class="token operator">==</span> <span class="token string">"L"</span><span class="token punctuation">,</span> identical<span class="token punctuation">(</span>T2<span class="token punctuation">,</span> t<span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

m <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> m<span class="token punctuation">[</span>upper.tri<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span>
<span class="token punctuation">(</span>t1 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>m<span class="token operator">+</span>diag<span class="token punctuation">(</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>t1p <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>t1pu <span class="token operator">&lt;-</span> diagN2U<span class="token punctuation">(</span>t1p<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
   inherits<span class="token punctuation">(</span>t1 <span class="token punctuation">,</span> <span class="token string">"dtrMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> validObject<span class="token punctuation">(</span>t1<span class="token punctuation">)</span>
   inherits<span class="token punctuation">(</span>t1p<span class="token punctuation">,</span> <span class="token string">"dtpMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> validObject<span class="token punctuation">(</span>t1p<span class="token punctuation">)</span>
   inherits<span class="token punctuation">(</span>t1pu<span class="token punctuation">,</span><span class="token string">"dtCMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> validObject<span class="token punctuation">(</span>t1pu<span class="token punctuation">)</span>
   t1pu<span class="token operator">@</span>x <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span>
   all<span class="token punctuation">(</span>t1pu <span class="token operator">==</span> t1p<span class="token punctuation">)</span>
   identical<span class="token punctuation">(</span><span class="token punctuation">(</span>t1pu <span class="token operator">-</span> t1<span class="token punctuation">)</span><span class="token operator">@</span>x<span class="token punctuation">,</span> numeric<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># sparse all-0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dtRMatrix-class-def">

<a href="#dtRMatrix-class-def" class="help-page-title"><h2 id="dtRMatrix-class">Triangular Sparse Compressed Row Matrices</h2></a>

<h3>Description</h3>

<p>The <code>dtRMatrix</code> class is a class of triangular, sparse
matrices in the compressed, row-oriented format.  In this
implementation the non-zero elements in the rows are sorted into
increasing columnd order.
</p>


<h3>Objects from the Class</h3>

<p>This class is currently still mostly unimplemented!
</p>
<p>Objects can be created by calls of the form <code>new("dtRMatrix", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.
At present only the lower triangle form is allowed.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either <code>"U"</code>, for unit triangular (diagonal is all ones), or
<code>"N"</code>; see <code><a href="#triangularMatrix-class">triangularMatrix</a></code>.</p>
</dd>
<dt>
<code>j</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length
<code><a href="#nnzero">nnzero</a>(.)</code> (number of non-zero elements).  These are
the row numbers for each non-zero element in the matrix.</p>
</dd>
<dt>
<code>p</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of pointers, one
for each row, to the initial (zero-based) index of elements in
the row. (Only present in the <code>dsRMatrix</code> class.)</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code> - the non-zero
elements of the matrix.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>The dimension (a length-2 <code>"integer"</code>)</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>corresponding names (or <code>NULL</code>),
inherited from the <code><a href="#Matrix-class">Matrix</a></code>, see there.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"dgRMatrix"</code>, directly.
Class <code>"dsparseMatrix"</code>, by class <code>"dgRMatrix"</code>.
Class <code>"dMatrix"</code>, by class <code>"dgRMatrix"</code>.
Class <code>"sparseMatrix"</code>, by class <code>"dgRMatrix"</code>.
Class <code>"Matrix"</code>, by class <code>"dgRMatrix"</code>.
</p>


<h3>Methods</h3>

<p>No methods currently with class "dsRMatrix" in the signature.








</p>


<h3>See Also</h3>

<p>Classes <code><a href="#dgCMatrix-class">dgCMatrix</a></code>, <code><a href="#dgTMatrix-class">dgTMatrix</a></code>,
<code><a href="#dgeMatrix-class">dgeMatrix</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>m0 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dtRMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>m2 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dtRMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span><span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>m2<span class="token punctuation">)</span>
<span class="token punctuation">(</span>m3 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"RsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># --&gt; dtRMatrix</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="expand">

<a href="#expand" class="help-page-title"><h2 id="expand-methods">Expand Matrix Factorizations</h2></a>

<h3>Description</h3>

<p><code>expand1</code> and <code>expand2</code> construct matrix factors from
objects specifying matrix factorizations.  Such objects typically
do not store the factors explicitly, employing instead a compact
representation to save memory.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">expand1<span class="token punctuation">(</span>x<span class="token punctuation">,</span> which<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
expand2<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

expand <span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="expand-methods_:_x">x</code></td>
<td>
<p>a matrix factorization, typically inheriting from
virtual class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="expand-methods_:_which">which</code></td>
<td>
<p>a character string indicating a matrix factor.</p>
</td>
</tr>
<tr>
<td><code id="expand-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Methods for <code>expand</code> are retained only for backwards
compatibility with <span class="pkg">Matrix</span> <code>&lt; 1.6-0</code>.  New code
should use <code>expand1</code> and <code>expand2</code>, whose methods
provide more control and behave more consistently.  Notably,
<code>expand2</code> obeys the rule that the product of the matrix
factors in the returned list should reproduce
(within some tolerance) the factorized matrix,
<em>including</em> its <code>dimnames</code>.
</p>
<p>Hence if <code>x</code> is a matrix and <code>y</code> is its factorization,
then
</p>
<pre>    all.equal(as(x, "matrix"), as(Reduce(`%*%`, expand2(y)), "matrix"))</pre>
<p>should in most cases return <code>TRUE</code>.
</p>


<h3>Value</h3>

<p><code>expand1</code> returns an object inheriting from virtual class
<code><a href="#Matrix-class">Matrix</a></code>, representing the factor indicated
by <code>which</code>, always without row and column names.
</p>
<p><code>expand2</code> returns a list of factors, typically with names
using conventional notation, as in <code>list(L=, U=)</code>.
The first and last factors get the row and column names of the
factorized matrix, which are preserved in the <code>Dimnames</code>
slot of <code>x</code>.
</p>


<h3>Methods</h3>

<p>The following table lists methods for <code>expand1</code> together with
allowed values of argument <code>which</code>.
</p>

<table>
<tr>
<td style="text-align: right;">
    <code>class(x)</code> </td>
<td style="text-align: left;"> <code>which</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code><a href="#Schur-class">Schur</a></code> </td>
<td style="text-align: left;"> <code>c("Q", "T", "Q.")</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code><a href="#LU-class">denseLU</a></code> </td>
<td style="text-align: left;"> <code>c("P1", "P1.", "L", "U")</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code><a href="#sparseLU-class">sparseLU</a></code> </td>
<td style="text-align: left;"> <code>c("P1", "P1.", "P2", "P2.", "L", "U")</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code><a href="#sparseQR-class">sparseQR</a></code> </td>
<td style="text-align: left;"> <code>c("P1", "P1.", "P2", "P2.", "Q", "Q1", "R", "R1")</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code><a href="#BunchKaufman-class">BunchKaufman</a></code>, <code><a href="#BunchKaufman-class">pBunchKaufman</a></code> </td>
<td style="text-align: left;"> <code>c("U", "DU", "U.", "L", "DL", "L.")</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code><a href="#Cholesky-class">Cholesky</a></code>, <code><a href="#Cholesky-class">pCholesky</a></code> </td>
<td style="text-align: left;"> <code>c("P1", "P1.", "L1", "D", "L1.", "L", "L.")</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code><a href="#CHMfactor-class">CHMsimpl</a></code>, <code><a href="#CHMfactor-class">CHMsimpl</a></code> </td>
<td style="text-align: left;"> <code>c("P1", "P1.", "L1", "D", "L1.", "L", "L.")</code>
  </td>
</tr>
</table>
<p>Methods for <code>expand2</code> and <code>expand</code> are described
below.  Factor names and classes apply also to <code>expand1</code>.
</p>

<dl>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "CHMsimpl")</code>:
expands the factorization
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A = P_{1}' L_{1} D L_{1}' P_{1} = P_{1}' L L' P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
as <code>list(P1., L1, D, L1., P1)</code> (the default)
or as <code>list(P1., L, L., P1)</code>,
depending on optional logical argument <code>LDL</code>.
<code>P1</code> and <code>P1.</code> are <code><a href="#pMatrix-class">pMatrix</a></code>,
<code>L1</code>, <code>L1.</code>, <code>L</code>, and <code>L.</code> are
<code><a href="#dtCMatrix-class">dtCMatrix</a></code>,
and <code>D</code> is a <code><a href="#ddiMatrix-class">ddiMatrix</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "CHMsuper")</code>:
as <code>CHMsimpl</code>, but the triangular factors are
stored as <code><a href="#dgCMatrix-class">dgCMatrix</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "p?Cholesky")</code>:
expands the factorization
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A = L_{1} D L_{1}' = L L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
as <code>list(L1, D, L1.)</code> (the default) or as <code>list(L, L.)</code>,
depending on optional logical argument <code>LDL</code>.
<code>L1</code>, <code>L1.</code>, <code>L</code>, and <code>L.</code> are
<code><a href="#dtrMatrix-class">dtrMatrix</a></code> or <code><a href="#dtpMatrix-class">dtpMatrix</a></code>,
and <code>D</code> is a <code><a href="#ddiMatrix-class">ddiMatrix</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "p?BunchKaufman")</code>:
expands the factorization
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>U</mi><msub><mi>D</mi><mi>U</mi></msub><msup><mi>U</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>L</mi><msub><mi>D</mi><mi>L</mi></msub><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A = U D_{U} U' = L D_{L} L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9019em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9019em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>b</mi><mi>U</mi></msub></msubsup><msub><mi>P</mi><mi>k</mi></msub><msub><mi>U</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">U = \prod_{k = 1}^{b_{U}} P_{k} U_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>b</mi><mi>L</mi></msub></msubsup><msub><mi>P</mi><mi>k</mi></msub><msub><mi>L</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">L = \prod_{k = 1}^{b_{L}} P_{k} L_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
as <code>list(U, DU, U.)</code> or <code>list(L, DL, L.)</code>,
depending on <code>x@uplo</code>.  If optional argument <code>complete</code>
is <code>TRUE</code>, then an unnamed list giving the full expansion
with <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msub><mi>b</mi><mi>U</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 b_{U} + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msub><mi>b</mi><mi>L</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 b_{L} + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> matrix
factors is returned instead.
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">P_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are represented as <code><a href="#pMatrix-class">pMatrix</a></code>,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">U_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">L_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are represented as
<code><a href="#dtCMatrix-class">dtCMatrix</a></code>, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">D_{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">D_{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are represented as
<code><a href="#dsCMatrix-class">dsCMatrix</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "Schur")</code>:
expands the factorization
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>Q</mi><mi>T</mi><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A = Q T Q'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">QT</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
as <code>list(Q, T, Q.)</code>.
<code>Q</code> and <code>Q.</code> are <code>x@Q</code> and <code>t(x@Q)</code>
modulo <code>Dimnames</code>, and <code>T</code> is <code>x@T</code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "sparseLU")</code>:
expands the factorization
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><mi>U</mi><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">A = P_{1}' L U P_{2}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">LU</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>
as <code>list(P1., L, U, P2.)</code>.
<code>P1.</code> and <code>P2.</code> are <code><a href="#pMatrix-class">pMatrix</a></code>,
and <code>L</code> and <code>U</code> are <code><a href="#dtCMatrix-class">dtCMatrix</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "denseLU")</code>:
expands the factorization
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">A = P_{1}' L U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">LU</span></span></span></span></code>
as <code>list(P1., L, U)</code>.
<code>P1.</code> is a <code><a href="#pMatrix-class">pMatrix</a></code>,
and <code>L</code> and <code>U</code> are <code><a href="#dtrMatrix-class">dtrMatrix</a></code>
if square and <code><a href="#dgeMatrix-class">dgeMatrix</a></code> otherwise.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "sparseQR")</code>:
expands the factorization
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>Q</mi><mi>R</mi><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>Q</mi><mn>1</mn></msub><msub><mi>R</mi><mn>1</mn></msub><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">A = P_{1}' Q R P_{2}' = P_{1}' Q_{1} R_{1} P_{2}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>
as <code>list(P1., Q, R, P2.)</code> or <code>list(P1., Q1, R1, P2.)</code>,
depending on optional logical argument <code>complete</code>.
<code>P1.</code> and <code>P2.</code> are <code><a href="#pMatrix-class">pMatrix</a></code>,
<code>Q</code> and <code>Q1</code> are <code><a href="#dgeMatrix-class">dgeMatrix</a></code>,
<code>R</code> is a <code><a href="#dgCMatrix-class">dgCMatrix</a></code>,
and <code>R1</code> is a <code><a href="#dtCMatrix-class">dtCMatrix</a></code>.</p>
</dd>
<dt><code>expand</code></dt>
<dd>
<p><code>signature(x = "CHMfactor")</code>:
as <code>expand2</code>, but returning <code>list(P, L)</code>.
<code>expand(x)[["P"]]</code> and <code>expand2(x)[["P1"]]</code>
represent the same permutation matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
but have opposite <code>margin</code> slots and inverted
<code>perm</code> slots.  The components of <code>expand(x)</code>
do not preserve <code>x@Dimnames</code>.</p>
</dd>
<dt><code>expand</code></dt>
<dd>
<p><code>signature(x = "sparseLU")</code>:
as <code>expand2</code>, but returning <code>list(P, L, U, Q)</code>.
<code>expand(x)[["Q"]]</code> and <code>expand2(x)[["P2."]]</code>
represent the same permutation matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">P_{2}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>
but have opposite <code>margin</code> slots and inverted
<code>perm</code> slots.  <code>expand(x)[["P"]]</code> represents
the permutation matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> rather than its
transpose <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">P_{1}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>; it is <code>expand2(x)[["P1."]]</code>
with an inverted <code>perm</code> slot.  <code>expand(x)[["L"]]</code>
and <code>expand2(x)[["L"]]</code> represent the same unit lower
triangular matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code>, but with <code>diag</code> slot equal
to <code>"N"</code> and <code>"U"</code>, respectively.
<code>expand(x)[["L"]]</code> and <code>expand(x)[["U"]]</code>
store the <em>permuted</em> first and second components of
<code>x@Dimnames</code> in their <code>Dimnames</code> slots.</p>
</dd>
<dt><code>expand</code></dt>
<dd>
<p><code>signature(x = "denseLU")</code>:
as <code>expand2</code>, but returning <code>list(L, U, P)</code>.
<code>expand(x)[["P"]]</code> and <code>expand2(x)[["P1."]]</code>
are identical modulo <code>Dimnames</code>.  The components
of <code>expand(x)</code> do not preserve <code>x@Dimnames</code>.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>The virtual class <code><a href="#compMatrix-class">compMatrix</a></code>
of <em>factorizable</em> matrices.
</p>
<p>The virtual class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>
of matrix factorizations.
</p>
<p>Generic functions <code><a href="#Cholesky">Cholesky</a></code>, <code><a href="#BunchKaufman-methods">BunchKaufman</a></code>,
<code><a href="#Schur">Schur</a></code>, <code><a href="#lu">lu</a></code>, and <code><a href="#qr-methods">qr</a></code> for
<em>computing</em> factorizations.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span><span class="token string">"expand1"</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
showMethods<span class="token punctuation">(</span><span class="token string">"expand2"</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">9L</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>lu.A <span class="token operator">&lt;-</span> lu<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>e.lu.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>lu.A<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    is.list<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"P1."</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"U"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all<span class="token punctuation">(</span>sapply<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">,</span> is<span class="token punctuation">,</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> e.lu.A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## 'expand1' and 'expand2' give equivalent results modulo</span>
<span class="token comment">## dimnames and representation of permutation matrices;</span>
<span class="token comment">## see also function 'alt' in example("Cholesky-methods")</span>
<span class="token punctuation">(</span>a1 <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>names<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">)</span><span class="token punctuation">,</span> expand1<span class="token punctuation">,</span> x <span class="token operator">=</span> lu.A<span class="token punctuation">,</span> simplify <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
all.equal<span class="token punctuation">(</span>a1<span class="token punctuation">,</span> e.lu.A<span class="token punctuation">)</span>

<span class="token comment">## see help("denseLU-class") and others for more examples</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="expm">

<a href="#expm" class="help-page-title"><h2 id="expm-methods">Matrix Exponential</h2></a>

<h3>Description</h3>

<p>Compute the exponential of a matrix.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">expm<span class="token punctuation">(</span>x<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="expm-methods_:_x">x</code></td>
<td>
<p>a matrix, typically inheriting from the
<code><a href="#dMatrix-class">dMatrix</a></code> class.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The exponential of a matrix is defined as the infinite Taylor
series <code>expm(A) = I + A + A^2/2! + A^3/3! + ...</code> (although this is
definitely not the way to compute it).  The method for the
<code>dgeMatrix</code> class uses Ward's diagonal Pade' approximation with
three step preconditioning, a recommendation from
Moler &amp; Van Loan (1978) “Nineteen dubious ways...”.
</p>


<h3>Value</h3>

<p>The matrix exponential of <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>This is a translation of the implementation of the corresponding
Octave function contributed to the Octave project by
A. Scottedward Hodel <a href="mailto:A.S.Hodel@Eng.Auburn.EDU">A.S.Hodel@Eng.Auburn.EDU</a>.  A bug in there
has been fixed by Martin Maechler.
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Matrix_exponential" target="_blank">https://en.wikipedia.org/wiki/Matrix_exponential</a>
</p>
<p>Cleve Moler and Charles Van Loan (2003)
Nineteen dubious ways to compute the exponential of a matrix,
twenty-five years later. <em>SIAM Review</em> <b>45</b>, 1, 3–49.
<a href="https://doi.org/10.1137/S00361445024180" target="_blank">doi:10.1137/S00361445024180</a>
</p>
<p><em>for historical reference mostly:</em><br>
Moler, C. and Van Loan, C. (1978)
Nineteen dubious ways to compute the exponential of a matrix.
<em>SIAM Review</em> <b>20</b>, 4, 801–836.
<a href="https://doi.org/10.1137/1020098" target="_blank">doi:10.1137/1020098</a>
</p>

<p>Eric W. Weisstein et al. (1999) <em>Matrix Exponential</em>.
From MathWorld, <a href="https://mathworld.wolfram.com/MatrixExponential.html" target="_blank">https://mathworld.wolfram.com/MatrixExponential.html</a>
</p>


<h3>See Also</h3>

<p>Package <a href="https://CRAN.R-project.org/package=expm" target="_blank"><span class="pkg">expm</span></a>, which provides newer (in some cases
faster, more accurate) algorithms for computing the matrix
exponential via its own (non-generic) function <code>expm()</code>.
<span class="pkg">expm</span> also implements <code>logm()</code>, <code>sqrtm()</code>, etc.
</p>
<p>Generic function <code><a href="#Schur">Schur</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>m1 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>e1 <span class="token operator">&lt;-</span> expm<span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> e <span class="token operator">&lt;-</span> exp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>e1<span class="token operator">@</span>x<span class="token punctuation">,</span> c<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">1e-15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>m2 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">49</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>e2 <span class="token operator">&lt;-</span> expm<span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>m3 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>rbind<span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">*</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># sparse!</span>
<span class="token punctuation">(</span>e3 <span class="token operator">&lt;-</span> expm<span class="token punctuation">(</span>m3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># upper triangular</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="externalFormats">

<a href="#externalFormats" class="help-page-title"><h2 id="externalFormats">Read and write external matrix formats</h2></a>

<h3>Description</h3>

<p>Read matrices stored in the Harwell-Boeing or MatrixMarket formats
or write <code><a href="#sparseMatrix-class">sparseMatrix</a></code> objects to one of these
formats.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">readHB<span class="token punctuation">(</span>file<span class="token punctuation">)</span>
readMM<span class="token punctuation">(</span>file<span class="token punctuation">)</span>
writeMM<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> file<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="externalFormats_:_obj">obj</code></td>
<td>
<p>a real sparse matrix</p>
</td>
</tr>
<tr>
<td><code id="externalFormats_:_file">file</code></td>
<td>
<p>for <code>writeMM</code> - the name of the file to be written.
For <code>readHB</code> and <code>readMM</code> the name of the file to read, as
a character scalar.  The names of files storing matrices in the
Harwell-Boeing format usually end in <code>".rua"</code> or <code>".rsa"</code>.
Those storing matrices in the MatrixMarket format usually end in
<code>".mtx"</code>.
</p>
<p>Alternatively, <code>readHB</code> and <code>readMM</code> accept connection objects.</p>
</td>
</tr>
<tr>
<td><code id="externalFormats_:_...">...</code></td>
<td>
<p>optional additional arguments. Currently none are used in
any methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>readHB</code> and <code>readMM</code> functions return an object that
inherits from the <code>"<a href="#Matrix-class">Matrix</a>"</code> class.  Methods for the
<code>writeMM</code> generic functions usually return
<code><a href="https://r-universe.dev/manuals/base.html#NULL">NULL</a></code> and, as a side effect, the matrix <code>obj</code> is
written to <code>file</code> in the MatrixMarket format (writeMM).
</p>


<h3>Note</h3>

<p>The Harwell-Boeing format is older and less flexible than the
MatrixMarket format.  The function <code>writeHB</code> was deprecated and
has now been removed.  Please use <code>writeMM</code> instead.
</p>
<p>Note that these formats do <em>not</em> know anything about
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>, hence these are dropped by <code>writeMM()</code>.
</p>
<p>A very simple way to export small sparse matrices <code>S</code>, is to use
<code>summary(S)</code> which returns a <code><a href="https://r-universe.dev/manuals/base.html#data.frame">data.frame</a></code> with
columns <code>i</code>, <code>j</code>, and possibly <code>x</code>, see <code>summary</code> in
<code><a href="#sparseMatrix-class">sparseMatrix-class</a></code>, and an example below.
</p>


<h3>References</h3>

<p><a href="https://math.nist.gov/MatrixMarket/" target="_blank">https://math.nist.gov/MatrixMarket/</a>
</p>
<p><a href="https://sparse.tamu.edu/" target="_blank">https://sparse.tamu.edu/</a>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">str<span class="token punctuation">(</span>pores <span class="token operator">&lt;-</span> readMM<span class="token punctuation">(</span>system.file<span class="token punctuation">(</span><span class="token string">"external/pores_1.mtx"</span><span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>utm   <span class="token operator">&lt;-</span> readHB<span class="token punctuation">(</span>system.file<span class="token punctuation">(</span><span class="token string">"external/utm300.rua"</span> <span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>lundA <span class="token operator">&lt;-</span> readMM<span class="token punctuation">(</span>system.file<span class="token punctuation">(</span><span class="token string">"external/lund_a.mtx"</span> <span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>lundA <span class="token operator">&lt;-</span> readHB<span class="token punctuation">(</span>system.file<span class="token punctuation">(</span><span class="token string">"external/lund_a.rsa"</span> <span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## https://math.nist.gov/MatrixMarket/data/Harwell-Boeing/counterx/counterx.htm</span>
str<span class="token punctuation">(</span>jgl   <span class="token operator">&lt;-</span> readMM<span class="token punctuation">(</span>system.file<span class="token punctuation">(</span><span class="token string">"external/jgl009.mtx"</span> <span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## NOTE: The following examples take quite some time</span>
<span class="token comment">## ----  even on a fast internet connection:</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">## The URL has been corrected, but we need an untar step:</span>
u. <span class="token operator">&lt;-</span> url<span class="token punctuation">(</span><span class="token string">"https://www.cise.ufl.edu/research/sparse/RB/Boeing/msc00726.tar.gz"</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>sm <span class="token operator">&lt;-</span> readHB<span class="token punctuation">(</span>gzcon<span class="token punctuation">(</span>u.<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

data<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
<span class="token comment">## Store as MatrixMarket (".mtx") file, here inside temporary dir./folder:</span>
<span class="token punctuation">(</span>MMfile <span class="token operator">&lt;-</span> file.path<span class="token punctuation">(</span>tempdir<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"mmMM.mtx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
writeMM<span class="token punctuation">(</span>KNex<span class="token operator">$</span>mm<span class="token punctuation">,</span> file<span class="token operator">=</span>MMfile<span class="token punctuation">)</span>
file.info<span class="token punctuation">(</span>MMfile<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span>c<span class="token punctuation">(</span><span class="token string">"size"</span><span class="token punctuation">,</span> <span class="token string">"ctime"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># (some confirmation of the file's)</span>

<span class="token comment">## very simple export - in triplet format - to text file:</span>
data<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
s.CA <span class="token operator">&lt;-</span> summary<span class="token punctuation">(</span>CAex<span class="token punctuation">)</span>
s.CA <span class="token comment"># shows  (i, j, x)  [columns of a data frame]</span>
message<span class="token punctuation">(</span><span class="token string">"writing to "</span><span class="token punctuation">,</span> outf <span class="token operator">&lt;-</span> tempfile<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
write.table<span class="token punctuation">(</span>s.CA<span class="token punctuation">,</span> file <span class="token operator">=</span> outf<span class="token punctuation">,</span> row.names<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
<span class="token comment">## and read it back -- showing off  sparseMatrix():</span>
str<span class="token punctuation">(</span>dd <span class="token operator">&lt;-</span> read.table<span class="token punctuation">(</span>outf<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## has columns (i, j, x) -&gt; we can use via do.call() as arguments to sparseMatrix():</span>
mm <span class="token operator">&lt;-</span> do.call<span class="token punctuation">(</span>sparseMatrix<span class="token punctuation">,</span> dd<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>mm<span class="token punctuation">,</span> CAex<span class="token punctuation">,</span> tolerance<span class="token operator">=</span><span class="token number">1e-15</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="facmul">

<a href="#facmul" class="help-page-title"><h2 id="facmul-methods">Multiplication by Factors from Matrix Factorizations</h2></a>

<h3>Description</h3>

<p>Multiplies a matrix or vector on the left or right by a factor
from a matrix factorization or its transpose.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">facmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> factor<span class="token punctuation">,</span> y<span class="token punctuation">,</span> trans <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> left <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="facmul-methods_:_x">x</code></td>
<td>
<p>a <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code> object.</p>
</td>
</tr>
<tr>
<td><code id="facmul-methods_:_factor">factor</code></td>
<td>
<p>a character string indicating a factor in the
factorization represented by <code>x</code>, typically an element
of <code>names(<a href="#expand">expand2</a>(x, ...))</code>.</p>
</td>
</tr>
<tr>
<td><code id="facmul-methods_:_y">y</code></td>
<td>
<p>a matrix or vector to be multiplied on the left or right
by the factor or its transpose.</p>
</td>
</tr>
<tr>
<td><code id="facmul-methods_:_trans">trans</code></td>
<td>
<p>a logical indicating if the transpose of the
factor should be used, rather than the factor itself.</p>
</td>
</tr>
<tr>
<td><code id="facmul-methods_:_left">left</code></td>
<td>
<p>a logical indicating if the <code>y</code> should be
multiplied on the left by the factor, rather than on the right.</p>
</td>
</tr>
<tr>
<td><code id="facmul-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>facmul</code> is experimental and currently no methods are
exported from <span class="pkg">Matrix</span>.
</p>


<h3>Value</h3>

<p>The value of <code>op(M) %*% y</code> or <code>y %*% op(M)</code>,
depending on <code>left</code>, where <code>M</code> is the factor
(always <em>without</em> <code>dimnames</code>) and <code>op(M)</code>
is <code>M</code> or <code>t(M)</code>, depending on <code>trans</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Conceptually, methods for 'facmul' _would_ behave as follows ...</span>
<span class="token comment">## Not run: </span>
n <span class="token operator">&lt;-</span> <span class="token number">3L</span>
x <span class="token operator">&lt;-</span> lu<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>n <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
L <span class="token operator">&lt;-</span> unname<span class="token punctuation">(</span>expand2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span>nm <span class="token operator">&lt;-</span> <span class="token string">"L"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    all.equal<span class="token punctuation">(</span>facmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> nm<span class="token punctuation">,</span> y<span class="token punctuation">,</span> trans <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> left <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> L <span class="token percent-operator operator">%*%</span> y<span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>facmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> nm<span class="token punctuation">,</span> y<span class="token punctuation">,</span> trans <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> left <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token percent-operator operator">%*%</span> L<span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>facmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> nm<span class="token punctuation">,</span> y<span class="token punctuation">,</span> trans <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">,</span> left <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  crossprod<span class="token punctuation">(</span>L<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>facmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> nm<span class="token punctuation">,</span> y<span class="token punctuation">,</span> trans <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">,</span> left <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tcrossprod<span class="token punctuation">(</span>y<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## End(Not run)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="fastMisc">

<a href="#fastMisc" class="help-page-title"><h2 id="fastMisc">“Low Level” Coercions and Methods</h2></a>

<h3>Description</h3>

<p>“Semi-API” functions used internally by <span class="pkg">Matrix</span>,
often to bypass S4 dispatch and avoid the associated overhead.
These are exported to provide this capability to expert users.
Typical users should continue to rely on S4 generic functions
to dispatch suitable methods, by calling,
e.g., <code>as(., &lt;class&gt;)</code> for coercions.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">.M2kind<span class="token punctuation">(</span>from<span class="token punctuation">,</span> kind <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>

.M2gen<span class="token punctuation">(</span>from<span class="token punctuation">,</span> kind <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">)</span>
.M2sym<span class="token punctuation">(</span>from<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
.M2tri<span class="token punctuation">(</span>from<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
.M2diag<span class="token punctuation">(</span>from<span class="token punctuation">)</span>

.M2v<span class="token punctuation">(</span>from<span class="token punctuation">)</span>
.M2m<span class="token punctuation">(</span>from<span class="token punctuation">)</span>
.M2unpacked<span class="token punctuation">(</span>from<span class="token punctuation">)</span>
.M2packed<span class="token punctuation">(</span>from<span class="token punctuation">)</span>
.M2C<span class="token punctuation">(</span>from<span class="token punctuation">)</span>
.M2R<span class="token punctuation">(</span>from<span class="token punctuation">)</span>
.M2T<span class="token punctuation">(</span>from<span class="token punctuation">)</span>

.sparse2dense<span class="token punctuation">(</span>from<span class="token punctuation">,</span> packed <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
.diag2dense<span class="token punctuation">(</span>from<span class="token punctuation">,</span> shape <span class="token operator">=</span> <span class="token string">"t"</span><span class="token punctuation">,</span> packed <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">)</span>
.ind2dense<span class="token punctuation">(</span>from<span class="token punctuation">,</span> kind <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
.m2dense<span class="token punctuation">(</span>from<span class="token punctuation">,</span> class<span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> diag <span class="token operator">=</span> <span class="token string">"N"</span><span class="token punctuation">)</span>

.dense2sparse<span class="token punctuation">(</span>from<span class="token punctuation">,</span> repr <span class="token operator">=</span> <span class="token string">"C"</span><span class="token punctuation">)</span>
.diag2sparse<span class="token punctuation">(</span>from<span class="token punctuation">,</span> shape <span class="token operator">=</span> <span class="token string">"t"</span><span class="token punctuation">,</span> repr <span class="token operator">=</span> <span class="token string">"C"</span><span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">)</span>
.ind2sparse<span class="token punctuation">(</span>from<span class="token punctuation">,</span> kind <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> repr <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">)</span>
.m2sparse<span class="token punctuation">(</span>from<span class="token punctuation">,</span> class<span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">,</span> diag <span class="token operator">=</span> <span class="token string">"N"</span><span class="token punctuation">)</span>

.tCRT<span class="token punctuation">(</span>x<span class="token punctuation">,</span> lazy <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

.diag.dsC<span class="token punctuation">(</span>x<span class="token punctuation">,</span> Chx <span class="token operator">=</span> Cholesky<span class="token punctuation">(</span>x<span class="token punctuation">,</span> LDL <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> res.kind <span class="token operator">=</span> <span class="token string">"diag"</span><span class="token punctuation">)</span>

.solve.dgC.lu  <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> tol <span class="token operator">=</span> .Machine<span class="token operator">$</span>double.eps<span class="token punctuation">,</span> check <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
.solve.dgC.qr  <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> order <span class="token operator">=</span> <span class="token number">3L</span><span class="token punctuation">,</span> check <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
.solve.dgC.chol<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> check <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

.updateCHMfactor<span class="token punctuation">(</span>object<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> mult <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td>
<code id="fastMisc_:_from">from</code>, <code id="fastMisc_:_x">x</code>, <code id="fastMisc_:_a">a</code>, <code id="fastMisc_:_b">b</code>
</td>
<td>
<p>a <code><a href="#Matrix-class">Matrix</a></code>, matrix, or vector.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_kind">kind</code></td>
<td>
<p>a string (<code>"."</code>, <code>"n"</code>, <code>"l"</code>, or
<code>"d"</code>) specifying the “kind” of the result.  <code>"."</code>
indicates that the kind of <code>from</code> should be preserved.
<code>"n"</code> indicates that the result should inherit from
<code><a href="#nMatrix-class">nMatrix</a></code> (and so on).</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_shape">shape</code></td>
<td>
<p>a string (<code>"."</code>, <code>"g"</code>, <code>"s"</code>, or
<code>"t"</code>) specifying the “shape” of the result.  <code>"."</code>
indicates that the shape of <code>from</code> should be preserved.
<code>"g"</code> indicates that the result should inherit from
<code><a href="#generalMatrix-class">generalMatrix</a></code> (and so on).</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_repr">repr</code></td>
<td>
<p>a string (<code>"."</code>, <code>"C"</code>, <code>"R"</code>, or
<code>"T"</code>) specifying the sparse representation of the result.
<code>"."</code> is accepted only by <code>.ind2sparse</code> and indicates
the most efficient representation,
which is <code>"C"</code> (<code>"R"</code>) for <code>margin = 2</code> (<code>1</code>).
<code>"C"</code> indicates that the result should inherit from
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> (and so on).</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_packed">packed</code></td>
<td>
<p>a logical indicating if the result should
inherit from <code><a href="#packedMatrix-class">packedMatrix</a></code>
rather than from <code><a href="#unpackedMatrix-class">unpackedMatrix</a></code>.
It is ignored for <code>from</code> inheriting from
<code><a href="#generalMatrix-class">generalMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_sparse">sparse</code></td>
<td>
<p>a logical indicating if the result should inherit
from <code><a href="#sparseMatrix-class">sparseMatrix</a></code> rather than from
<code><a href="#denseMatrix-class">denseMatrix</a></code>.  If <code>NA</code>, then the result
will be formally sparse if and only if <code>from</code> is.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_uplo">uplo</code></td>
<td>
<p>a string (<code>"U"</code> or <code>"L"</code>) indicating whether
the result (if symmetric or triangular) should store the upper or
lower triangle of <code>from</code>.  The elements of <code>from</code> in the
opposite triangle are ignored.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_diag">diag</code></td>
<td>
<p>a string (<code>"N"</code> or <code>"U"</code>) indicating whether
the result (if triangular) should be formally nonunit or unit
triangular.  In the unit triangular case, the diagonal elements
of <code>from</code> are ignored.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_class">class</code></td>
<td>
<p>a string whose first three characters specify the class
of the result.  It should match the pattern
<code>"^[.nld](ge|sy|tr|sp|tp)"</code> for <code>.m2dense</code> and
<code>"^[.nld][gst][CRT]"</code> for <code>.m2sparse</code>,
where <code>"."</code> in the first position is equivalent to <code>"l"</code>
for logical arguments and <code>"d"</code> for numeric arguments.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_...">...</code></td>
<td>
<p>optional arguments passed to <code><a href="#isSymmetric-methods">isSymmetric</a></code>
or <code><a href="#isTriangular">isTriangular</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_lazy">lazy</code></td>
<td>
<p>a logical indicating if the transpose should be
constructed with minimal allocation, but possibly <em>without</em>
preserving representation.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_Chx">Chx</code></td>
<td>
<p>optionally, the <code><a href="#Cholesky">Cholesky</a>(x, ...)</code>
factorization of <code>x</code>.  If supplied, then <code>x</code> is unused.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_res.kind">res.kind</code></td>
<td>
<p>a string in <code>c("trace", "sumLog", "prod", "min",
      "max", "range", "diag", "diagBack")</code>.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_tol">tol</code></td>
<td>
<p>see <code><a href="#lu">lu-methods</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_order">order</code></td>
<td>
<p>see <code><a href="#qr-methods">qr-methods</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_check">check</code></td>
<td>
<p>a logical indicating if the first argument should be
tested for inheritance from <code><a href="#dgCMatrix-class">dgCMatrix</a></code> and
coerced if necessary.   Set to <code>FALSE</code> for speed only if it
is known to already inherit from <code><a href="#dgCMatrix-class">dgCMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_object">object</code></td>
<td>
<p>a Cholesky factorization inheriting from virtual class
<code>CHMfactor</code>, almost always the result of a call to generic
function <code><a href="#Cholesky">Cholesky</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_parent">parent</code></td>
<td>
<p>an object of class <code><a href="#dsCMatrix-class">dsCMatrix</a></code>
or class <code><a href="#dgCMatrix-class">dgCMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="fastMisc_:_mult">mult</code></td>
<td>
<p>a numeric vector of postive length.  Only the first
element is used, and that must be finite.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functions with names of the form <code>.&lt;A&gt;2&lt;B&gt;</code> implement coercions
from virtual class A to the “nearest” non-virtual subclass of
virtual class B, where the virtual classes are abbreviated as follows:
</p>

<dl>
<dt><code>M</code></dt>
<dd>
<p><code><a href="#Matrix-class">Matrix</a></code></p>
</dd>
<dt><code>m</code></dt>
<dd>
<p>matrix or vector</p>
</dd>
<dt><code>v</code></dt>
<dd>
<p>vector</p>
</dd>
<dt><code>dense</code></dt>
<dd>
<p><code><a href="#denseMatrix-class">denseMatrix</a></code></p>
</dd>
<dt><code>unpacked</code></dt>
<dd>
<p><code><a href="#unpackedMatrix-class">unpackedMatrix</a></code></p>
</dd>
<dt><code>packed</code></dt>
<dd>
<p><code><a href="#packedMatrix-class">packedMatrix</a></code></p>
</dd>
<dt><code>sparse</code></dt>
<dd>
<p><code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>,
<code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>, or
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code></p>
</dd>
<dt><code>C</code></dt>
<dd>
<p><code><a href="#CsparseMatrix-class">CsparseMatrix</a></code></p>
</dd>
<dt><code>R</code></dt>
<dd>
<p><code><a href="#RsparseMatrix-class">RsparseMatrix</a></code></p>
</dd>
<dt><code>T</code></dt>
<dd>
<p><code><a href="#TsparseMatrix-class">TsparseMatrix</a></code></p>
</dd>
<dt><code>gen</code></dt>
<dd>
<p><code><a href="#generalMatrix-class">generalMatrix</a></code></p>
</dd>
<dt><code>sym</code></dt>
<dd>
<p><code><a href="#symmetricMatrix-class">symmetricMatrix</a></code></p>
</dd>
<dt><code>tri</code></dt>
<dd>
<p><code><a href="#triangularMatrix-class">triangularMatrix</a></code></p>
</dd>
<dt><code>diag</code></dt>
<dd>
<p><code><a href="#diagonalMatrix-class">diagonalMatrix</a></code></p>
</dd>
<dt><code>ind</code></dt>
<dd>
<p><code><a href="#indMatrix-class">indMatrix</a></code></p>
</dd>
</dl>
<p>Abbreviations should be seen as a guide, rather than as an
exact description of behaviour.  For example, <code>.m2dense</code>
and <code>.m2sparse</code> accept vectors in addition to matrices.
</p>


<h4><code>.tCRT(x)</code></h4>

<p>If <code>lazy = TRUE</code>, then <code>.tCRT</code> constructs the transpose
of <code>x</code> using the most efficient representation,
which for ‘<span class="samp">⁠CRT⁠</span>’ is ‘<span class="samp">⁠RCT⁠</span>’.  If <code>lazy = FALSE</code>,
then <code>.tCRT</code> preserves the representation of <code>x</code>,
behaving as the corresponding methods for generic function <code>t</code>.
</p>



<h4><code>.diag.dsC(x)</code></h4>

<p><code>.diag.dsC</code> computes (or uses if <code>Chx</code> is supplied)
the Cholesky factorization of <code>x</code> as <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>D</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">L D L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> in order
to calculate one of several possible statistics from the diagonal
entries of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></code>.  See <code>res.kind</code> under ‘Arguments’.
</p>



<h4><code>.solve.dgC.*(a, b)</code></h4>

<p><code>.solve.dgC.lu(a, b)</code> needs a square matrix <code>a</code>.
<code>.solve.dgC.qr(a, b)</code> needs a “long” matrix <code>a</code>,
with <code>nrow(a) &gt;= ncol(a)</code>.
<code>.solve.dgC.chol(a, b)</code> needs a “wide” matrix <code>a</code>,
with <code>nrow(a) &lt;= ncol(a)</code>.
</p>
<p>All three may be used to solve sparse linear systems directly.
Only <code>.solve.dgC.qr</code> and <code>.solve.dgC.chol</code> be used
to solve sparse <em>least squares</em> problems.
</p>



<h4><code>.updateCHMfactor(object, parent, mult)</code></h4>

<p><code>.updateCHMfactor</code> updates <code>object</code> with the result
of Cholesky factorizing
<code>F(parent) + mult[1] * diag(nrow(parent))</code>,
i.e., <code>F(parent)</code> plus <code>mult[1]</code> times the identity matrix,
where <code>F = identity</code> if <code>parent</code> is a <code>dsCMatrix</code>
and <code>F = tcrossprod</code> if <code>parent</code> is a <code>dgCMatrix</code>.
The nonzero pattern of <code>F(parent)</code> must match
that of <code>S</code> if <code>object = Cholesky(S, ...)</code>.
</p>



<h3>Examples</h3>

<pre class="language-r"><code class="language-r">D. <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span>x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
D.<span class="token number">0</span> <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
S. <span class="token operator">&lt;-</span> toeplitz<span class="token punctuation">(</span>as.double<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
C. <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dgCMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">4L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          p <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>.M2tri <span class="token punctuation">(</span>D.<span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>D.<span class="token punctuation">,</span> <span class="token string">"triangularMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>.M2sym <span class="token punctuation">(</span>D.<span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>D.<span class="token punctuation">,</span>  <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>.M2diag<span class="token punctuation">(</span>D.<span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>D.<span class="token punctuation">,</span>   <span class="token string">"diagonalMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>.M2kind<span class="token punctuation">(</span>C.<span class="token punctuation">,</span> <span class="token string">"l"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              as<span class="token punctuation">(</span>C.<span class="token punctuation">,</span> <span class="token string">"lMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>.M2kind<span class="token punctuation">(</span>.sparse2dense<span class="token punctuation">(</span>C.<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"l"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              as<span class="token punctuation">(</span>as<span class="token punctuation">(</span>C.<span class="token punctuation">,</span> <span class="token string">"denseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"lMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>.diag2sparse<span class="token punctuation">(</span>D.<span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              .dense2sparse<span class="token punctuation">(</span>.diag2dense<span class="token punctuation">(</span>D.<span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>.M2gen<span class="token punctuation">(</span>.diag2dense<span class="token punctuation">(</span>D.<span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              .sparse2dense<span class="token punctuation">(</span>.M2gen<span class="token punctuation">(</span>.diag2sparse<span class="token punctuation">(</span>D.<span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token string">"T"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>S.<span class="token punctuation">,</span>
              .M2m<span class="token punctuation">(</span>.m2sparse<span class="token punctuation">(</span>S.<span class="token punctuation">,</span> <span class="token string">".sR"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>S. <span class="token operator">*</span> lower.tri<span class="token punctuation">(</span>S.<span class="token punctuation">)</span> <span class="token operator">+</span> diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              .M2m<span class="token punctuation">(</span>.m2dense <span class="token punctuation">(</span>S.<span class="token punctuation">,</span> <span class="token string">".tr"</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"U"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>.M2R<span class="token punctuation">(</span>C.<span class="token punctuation">)</span><span class="token punctuation">,</span> .M2R<span class="token punctuation">(</span>.M2T<span class="token punctuation">(</span>C.<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>.tCRT<span class="token punctuation">(</span>C.<span class="token punctuation">)</span><span class="token punctuation">,</span> .M2R<span class="token punctuation">(</span>t<span class="token punctuation">(</span>C.<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

A <span class="token operator">&lt;-</span> tcrossprod<span class="token punctuation">(</span>C.<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6</span> <span class="token operator">+</span> Diagonal<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">3</span><span class="token punctuation">;</span> A
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    is.numeric<span class="token punctuation">(</span> x. <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">2.2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.2</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>x.<span class="token punctuation">,</span> .solve.dgC.lu<span class="token punctuation">(</span>A<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>x.<span class="token punctuation">,</span> .solve.dgC.qr<span class="token punctuation">(</span>A<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Solving sparse least squares:</span>

X <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>A<span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># design matrix X (for L.S.)</span>
Xt <span class="token operator">&lt;-</span> t<span class="token punctuation">(</span>X<span class="token punctuation">)</span>                 <span class="token comment"># *transposed*  X (for L.S.)</span>
<span class="token punctuation">(</span>y <span class="token operator">&lt;-</span> drop<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>Xt<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token comment"># small rand.err.</span>
str<span class="token punctuation">(</span>solveCh <span class="token operator">&lt;-</span> .solve.dgC.chol<span class="token punctuation">(</span>Xt<span class="token punctuation">,</span> y<span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># Xt *is* dgC..</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    all.equal<span class="token punctuation">(</span>solveCh<span class="token operator">$</span>coef<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">1e-3</span><span class="token punctuation">)</span><span class="token comment"># rel.err ~ 1e-4</span>
    all.equal<span class="token punctuation">(</span>solveCh<span class="token operator">$</span>coef<span class="token punctuation">,</span> drop<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>tcrossprod<span class="token punctuation">(</span>Xt<span class="token punctuation">)</span><span class="token punctuation">,</span> Xt <span class="token percent-operator operator">%*%</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>solveCh<span class="token operator">$</span>coef<span class="token punctuation">,</span> .solve.dgC.qr<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="forceSymmetric">

<a href="#forceSymmetric" class="help-page-title"><h2 id="forceSymmetric-methods">Force a Matrix to 'symmetricMatrix' Without Symmetry Checks</h2></a>

<h3>Description</h3>

<p>Force a square matrix <code>x</code> to a <code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>,
<b>without</b> a symmetry check as it would be applied for <code>as(x,
    "symmetricMatrix")</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">forceSymmetric<span class="token punctuation">(</span>x<span class="token punctuation">,</span> uplo<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="forceSymmetric-methods_:_x">x</code></td>
<td>
<p>any square matrix (of numbers), either “"traditional"”
(<code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>) or inheriting from
<code><a href="#Matrix-class">Matrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="forceSymmetric-methods_:_uplo">uplo</code></td>
<td>
<p>optional string, <code>"U"</code> or <code>"L"</code> indicating which
“triangle” half of <code>x</code> should determine the result.  The
default is <code>"U"</code> unless <code>x</code> already has a <code>uplo</code> slot
(i.e., when it is <code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>, or
<code><a href="#triangularMatrix-class">triangularMatrix</a></code>), where the default will be
<code>x@uplo</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a square matrix inheriting from class
<code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#symmpart">symmpart</a></code> for the symmetric part of a matrix, or
the coercions <code>as(x, &lt;symmetricMatrix class&gt;)</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Hilbert matrix</span>
 i <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span>
 h6 <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">/</span>outer<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1L</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">"+"</span><span class="token punctuation">)</span>
 sd <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>diag<span class="token punctuation">(</span>h6<span class="token punctuation">)</span><span class="token punctuation">)</span>
 hh <span class="token operator">&lt;-</span> t<span class="token punctuation">(</span>h6<span class="token operator">/</span>sd<span class="token punctuation">)</span><span class="token operator">/</span>sd <span class="token comment"># theoretically symmetric</span>
 isSymmetric<span class="token punctuation">(</span>hh<span class="token punctuation">,</span> tol<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># FALSE; hence</span>
 try<span class="token punctuation">(</span> as<span class="token punctuation">(</span>hh<span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment"># fails, but this works fine:</span>
 H6 <span class="token operator">&lt;-</span> forceSymmetric<span class="token punctuation">(</span>hh<span class="token punctuation">)</span>

 <span class="token comment">## result can be pretty surprising:</span>
 <span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 forceSymmetric<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token comment"># symmetric, hence very different in lower triangle</span>
 <span class="token punctuation">(</span>tm <span class="token operator">&lt;-</span> tril<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span>
 forceSymmetric<span class="token punctuation">(</span>tm<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="formatSparseM">

<a href="#formatSparseM" class="help-page-title"><h2 id="formatSparseM">Formatting Sparse Numeric Matrices Utilities</h2></a>

<h3>Description</h3>

<p>Utilities for formatting sparse numeric matrices in a flexible way.
These functions are used by the <code><a href="https://r-universe.dev/manuals/base.html#format">format</a></code> and <code>print</code>
methods for sparse matrices and can be applied as well to standard <span class="rlang"><b>R</b></span>
matrices.  Note that <em>all</em> arguments but the first are optional.
</p>
<p><code>formatSparseM()</code> is the main “workhorse” of
<code><a href="#printSpMatrix">formatSpMatrix</a></code>, the <code>format</code> method for sparse
matrices.
</p>
<p><code>.formatSparseSimple()</code> is a simple helper function, also dealing
with (short/empty) column names construction.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">formatSparseM<span class="token punctuation">(</span>x<span class="token punctuation">,</span> zero.print <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">,</span> align <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"fancy"</span><span class="token punctuation">,</span> <span class="token string">"right"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              m <span class="token operator">=</span> as<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> asLogical<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> uniDiag<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span>
              digits<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> cx<span class="token punctuation">,</span> iN0<span class="token punctuation">,</span> dn <span class="token operator">=</span> dimnames<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>

.formatSparseSimple<span class="token punctuation">(</span>m<span class="token punctuation">,</span> asLogical<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> digits<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span>
		    col.names<span class="token punctuation">,</span> note.dropping.colnames <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
                    dn<span class="token operator">=</span>dimnames<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="formatSparseM_:_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object inheriting from class <code><a href="#sparseMatrix-class">sparseMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="formatSparseM_:_zero.print">zero.print</code></td>
<td>
<p>character which should be used for
<em>structural</em> zeroes.  The default <code>"."</code> may occasionally
be replaced by <code>" "</code> (blank); using <code>"0"</code> would look
almost like <code>print()</code>ing of non-sparse matrices.</p>
</td>
</tr>
<tr>
<td><code id="formatSparseM_:_align">align</code></td>
<td>
<p>a string specifying how the <code>zero.print</code> codes
should be aligned, see <code><a href="#printSpMatrix">formatSpMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="formatSparseM_:_m">m</code></td>
<td>
<p>(optional) a (standard <span class="rlang"><b>R</b></span>) <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code> version of <code>x</code>.</p>
</td>
</tr>
<tr>
<td><code id="formatSparseM_:_asLogical">asLogical</code></td>
<td>
<p>should the matrix be formatted as a logical matrix
(or rather as a numeric one); mostly for <code>formatSparseM()</code>.</p>
</td>
</tr>
<tr>
<td><code id="formatSparseM_:_uniDiag">uniDiag</code></td>
<td>
<p>logical indicating if the diagonal entries of a sparse
unit triangular or unit-diagonal matrix should be formatted as
<code>"I"</code> instead of <code>"1"</code> (to emphasize that the 1's are
“structural”).</p>
</td>
</tr>
<tr>
<td><code id="formatSparseM_:_digits">digits</code></td>
<td>
<p>significant digits to use for printing, see
<code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="formatSparseM_:_cx">cx</code></td>
<td>
<p>(optional) character matrix; a formatted version of <code>x</code>, still
with strings such as <code>"0.00"</code> for the zeros.</p>
</td>
</tr>
<tr>
<td><code id="formatSparseM_:_iN0">iN0</code></td>
<td>
<p>(optional) integer vector, specifying the location of the
<em>non</em>-zeroes of <code>x</code>.</p>
</td>
</tr>
<tr>
<td>
<code id="formatSparseM_:_col.names">col.names</code>, <code id="formatSparseM_:_note.dropping.colnames">note.dropping.colnames</code>
</td>
<td>
<p>see <code><a href="#printSpMatrix">formatSpMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="formatSparseM_:_dn">dn</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code> to be used; a list (of length two)
with row and column names (or <code><a href="https://r-universe.dev/manuals/base.html#NULL">NULL</a></code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a character matrix like <code>cx</code>, where the zeros have been replaced
with (padded versions of) <code>zero.print</code>.
As this is a <em>dense</em> matrix, do not use these functions for
really large (really) sparse matrices!
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#printSpMatrix">formatSpMatrix</a></code> which calls <code>formatSparseM()</code> and is
the <code><a href="https://r-universe.dev/manuals/base.html#format">format</a></code> method for sparse matrices.<br><code><a href="#printSpMatrix">printSpMatrix</a></code> which is used by the (typically
implicitly called) <code><a href="https://r-universe.dev/manuals/methods.html#show">show</a></code> and <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code> methods
for sparse matrices.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">m <span class="token operator">&lt;-</span> suppressWarnings<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3.2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fm <span class="token operator">&lt;-</span> formatSparseM<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
noquote<span class="token punctuation">(</span>fm<span class="token punctuation">)</span>
<span class="token comment">## nice, but this is nicer {with "units" vertically aligned}:</span>
print<span class="token punctuation">(</span>fm<span class="token punctuation">,</span> quote<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment">## and "the same" as :</span>
Matrix<span class="token punctuation">(</span>m<span class="token punctuation">)</span>

<span class="token comment">## align = "right" is cheaper --&gt;  the "." are not aligned:</span>
noquote<span class="token punctuation">(</span>f2 <span class="token operator">&lt;-</span> formatSparseM<span class="token punctuation">(</span>m<span class="token punctuation">,</span>align<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>f2 <span class="token operator">==</span> fm   <span class="token operator">|</span>   m <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> dim<span class="token punctuation">(</span>f2<span class="token punctuation">)</span> <span class="token operator">==</span> dim<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span>
         <span class="token punctuation">(</span>f2 <span class="token operator">==</span> <span class="token string">"."</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>m <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="generalMatrix-class">

<a href="#generalMatrix-class" class="help-page-title"><h2 id="generalMatrix-class">Class "generalMatrix" of General Matrices</h2></a>

<h3>Description</h3>

<p>Virtual class of “general” matrices; i.e., matrices
that do not have a known property such as symmetric, triangular, or
diagonal.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Slots</h3>


<dl>
<dt><code>factors</code></dt>
<dd>
<p>,</p>
</dd>
<dt><code>Dim</code></dt>
<dd>
<p>,</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>all slots inherited from
<code><a href="#compMatrix-class">compMatrix</a></code>; see its description.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"compMatrix"</code>, directly.
Class <code>"Matrix"</code>, by class <code>"compMatrix"</code>.
</p>


<h3>See Also</h3>

<p>Classes <code><a href="#compMatrix-class">compMatrix</a></code>, and the non-general virtual
classes:
<code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>,
<code><a href="#triangularMatrix-class">triangularMatrix</a></code>,
<code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="Hilbert">

<a href="#Hilbert" class="help-page-title"><h2 id="Hilbert">Generate a Hilbert matrix</h2></a>

<h3>Description</h3>

<p>Generate the <code>n</code> by <code>n</code> symmetric Hilbert matrix.  Because
these matrices are ill-conditioned for moderate to large <code>n</code>,
they are often used for testing numerical linear algebra code.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Hilbert<span class="token punctuation">(</span>n<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="Hilbert_:_n">n</code></td>
<td>
<p>a non-negative integer.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>the <code>n</code> by <code>n</code> symmetric Hilbert matrix as a
<code>"dpoMatrix"</code> object.
</p>


<h3>See Also</h3>

<p>the class <code><a href="#dpoMatrix-class">dpoMatrix</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">Hilbert<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="image-methods">

<a href="#image-methods" class="help-page-title"><h2 id="image-methods">Methods for image() in Package 'Matrix'</h2></a>

<h3>Description</h3>

<p>Methods for function <code><a href="https://r-universe.dev/manuals/graphics.html#image">image</a></code> in package
<span class="pkg">Matrix</span>.  An image of a matrix simply color codes all matrix
entries and draws the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n\times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> matrix using an
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n\times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> grid of (colored) rectangles.
</p>
<p>The <span class="pkg">Matrix</span> package <code>image</code> methods are based on
<code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a>()</code> from package <span class="pkg">lattice</span>; hence
these methods return an “object” of class <code>"trellis"</code>,
producing a graphic when (auto-) <code><a href="https://r-universe.dev/manuals/base.html#print">print</a>()</code>ed.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S4 method for signature 'dgTMatrix'</span>
image<span class="token punctuation">(</span>x<span class="token punctuation">,</span>
      xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> di<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      ylim <span class="token operator">=</span> c<span class="token punctuation">(</span>di<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> aspect <span class="token operator">=</span> <span class="token string">"iso"</span><span class="token punctuation">,</span>
      sub <span class="token operator">=</span> sprintf<span class="token punctuation">(</span><span class="token string">"Dimensions: %d x %d"</span><span class="token punctuation">,</span> di<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> di<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      xlab <span class="token operator">=</span> <span class="token string">"Column"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Row"</span><span class="token punctuation">,</span> cuts <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span>
      useRaster <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      useAbs <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> colorkey <span class="token operator">=</span> <span class="token operator">!</span>useAbs<span class="token punctuation">,</span>
      col.regions <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
      lwd <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> border.col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="image-methods_:_x">x</code></td>
<td>
<p>a Matrix object, i.e., fulfilling <code><a href="https://r-universe.dev/manuals/methods.html#is">is</a>(x, "Matrix")</code>.</p>
</td>
</tr>
<tr>
<td>
<code id="image-methods_:_xlim">xlim</code>, <code id="image-methods_:_ylim">ylim</code>
</td>
<td>
<p>x- and y-axis limits; may be used to “zoom
into” matrix.  Note that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></code> “feel reversed”:
<code>ylim</code> is for the rows (= 1st index) and <code>xlim</code> for the
columns (= 2nd index).  For convenience, when the limits are integer
valued, they are both extended by <code>0.5</code>; also, <code>ylim</code> is
always used decreasingly.</p>
</td>
</tr>
<tr>
<td><code id="image-methods_:_aspect">aspect</code></td>
<td>
<p>aspect ratio specified as number (y/x) or string;
see <code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a></code>.</p>
</td>
</tr>
<tr>
<td>
<code id="image-methods_:_sub">sub</code>, <code id="image-methods_:_xlab">xlab</code>, <code id="image-methods_:_ylab">ylab</code>
</td>
<td>
<p>axis annotation with sensible defaults;
see <code><a href="https://r-universe.dev/manuals/graphics.html#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="image-methods_:_cuts">cuts</code></td>
<td>
<p>number of levels the range of matrix values would be
divided into.</p>
</td>
</tr>
<tr>
<td><code id="image-methods_:_useRaster">useRaster</code></td>
<td>
<p>logical indicating if raster graphics should be used
(instead of the tradition rectangle vector drawing).  If true,
<code><a href="https://r-universe.dev/manuals/lattice.html#panel.levelplot.raster">panel.levelplot.raster</a></code> (from <span class="pkg">lattice</span>
package) is used, and the colorkey is also done via rasters, see
also <code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a></code> and possibly
<code><a href="https://r-universe.dev/manuals/grid.html#grid.raster">grid.raster</a></code>.
</p>
<p>Note that using raster graphics may often be faster, but can be slower,
depending on the matrix dimensions and the graphics device (dimensions).</p>
</td>
</tr>
<tr>
<td><code id="image-methods_:_useAbs">useAbs</code></td>
<td>
<p>logical indicating if <code><a href="https://r-universe.dev/manuals/base.html#MathFun">abs</a>(x)</code> should be
shown; if <code>TRUE</code>, the former (implicit) default, the default
<code>col.regions</code> will be <code><a href="https://r-universe.dev/manuals/grDevices.html#gray">grey</a></code> colors (and no
<code>colorkey</code> drawn).  The default is <code>FALSE</code> unless the
matrix has no negative entries.</p>
</td>
</tr>
<tr>
<td><code id="image-methods_:_colorkey">colorkey</code></td>
<td>
<p>logical indicating if a color key aka ‘legend’
should be produced.  Default is to draw one, unless <code>useAbs</code> is
true.  You can also specify a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code>, see
<code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a></code>, such as<code>list(raster=TRUE)</code> in
the case of rastering.</p>
</td>
</tr>
<tr>
<td><code id="image-methods_:_col.regions">col.regions</code></td>
<td>
<p>vector of gradually varying colors; see
<code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="image-methods_:_lwd">lwd</code></td>
<td>
<p>(only used when <code>useRaster</code> is false:) non-negative
number or <code>NULL</code> (default), specifying the line-width of the
rectangles of each non-zero matrix entry (drawn by
<code><a href="https://r-universe.dev/manuals/grid.html#grid.rect">grid.rect</a></code>).  The default depends on the matrix
dimension and the device size.</p>
</td>
</tr>
<tr>
<td><code id="image-methods_:_border.col">border.col</code></td>
<td>
<p>color for the border of each rectangle. <code>NA</code>
means no border is drawn.   When <code>NULL</code> as by default,
<code>border.col &lt;- if(lwd &lt; .01) NA else NULL</code> is used.
Consider using an opaque color instead of <code>NULL</code> which
corresponds to <code>grid::<a href="https://r-universe.dev/manuals/grid.html#get.gpar">get.gpar</a>("col")</code>.</p>
</td>
</tr>
<tr>
<td><code id="image-methods_:_...">...</code></td>
<td>
<p>further arguments passed to methods and
<code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a></code>, notably <code>at</code> for specifying
(possibly non equidistant) cut values for dividing the matrix
values (superseding <code>cuts</code> above).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>as all <span class="pkg">lattice</span> graphics functions, <code>image(&lt;Matrix&gt;)</code>
returns a <code>"trellis"</code> object, effectively the result of
<code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a>()</code>.
</p>


<h3>Methods</h3>

<p>All methods currently end up calling the method for the
<code><a href="#dgTMatrix-class">dgTMatrix</a></code> class.
Use <code>showMethods(image)</code> to list them all.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a></code>, and
<code><a href="https://r-universe.dev/manuals/lattice.html#print.trellis">print.trellis</a></code> from package <span class="pkg">lattice</span>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
<span class="token comment">## And if you want to see the method definitions:</span>
showMethods<span class="token punctuation">(</span>image<span class="token punctuation">,</span> includeDefs <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

data<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"image(CAex)"</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> imgC<span class="token punctuation">;</span> imgC
stopifnot<span class="token punctuation">(</span><span class="token operator">!</span>is.null<span class="token punctuation">(</span>leg <span class="token operator">&lt;-</span> imgC<span class="token operator">$</span>legend<span class="token punctuation">)</span><span class="token punctuation">,</span> is.list<span class="token punctuation">(</span>leg<span class="token operator">$</span>right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># failed for 2 days ..</span>
image<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> useAbs<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"image(CAex, useAbs=TRUE)"</span><span class="token punctuation">)</span>

cCA <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>CAex<span class="token punctuation">)</span><span class="token punctuation">,</span> Imult <span class="token operator">=</span> <span class="token number">.01</span><span class="token punctuation">)</span>
<span class="token comment">## See  ?print.trellis --- place two image() plots side by side:</span>
print<span class="token punctuation">(</span>image<span class="token punctuation">(</span>cCA<span class="token punctuation">,</span> main<span class="token operator">=</span><span class="token string">"Cholesky(crossprod(CAex), Imult = .01)"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      split<span class="token operator">=</span>c<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>nx<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> ny<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> more<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>image<span class="token punctuation">(</span>cCA<span class="token punctuation">,</span> useAbs<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      split<span class="token operator">=</span>c<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>nx<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>ny<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

data<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>USCounties<span class="token punctuation">)</span><span class="token comment"># huge</span>
image<span class="token punctuation">(</span>sign<span class="token punctuation">(</span>USCounties<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">## just the pattern</span>
    <span class="token comment"># how the result looks, may depend heavily on</span>
    <span class="token comment"># the device, screen resolution, antialiasing etc</span>
    <span class="token comment"># e.g. x11(type="Xlib") may show very differently than cairo-based</span>

<span class="token comment">## Drawing borders around each rectangle;</span>
    <span class="token comment"># again, viewing depends very much on the device:</span>
image<span class="token punctuation">(</span>USCounties<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">.1</span><span class="token punctuation">)</span>
<span class="token comment">## Using (xlim,ylim) has advantage : matrix dimension and (col/row) indices:</span>
image<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">.1</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">.5</span> <span class="token punctuation">)</span>
image<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">.01</span><span class="token punctuation">)</span>
<span class="token comment">## These 3 are all equivalent :</span>
<span class="token punctuation">(</span>I1 <span class="token operator">&lt;-</span> image<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> useAbs<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 I2 <span class="token operator">&lt;-</span> image<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> useAbs<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span>        border.col<span class="token operator">=</span><span class="token keyword">NA</span><span class="token punctuation">)</span>
 I3 <span class="token operator">&lt;-</span> image<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> useAbs<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> border.col<span class="token operator">=</span><span class="token keyword">NA</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I2<span class="token punctuation">,</span> check.environment<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          all.equal<span class="token punctuation">(</span>I2<span class="token punctuation">,</span> I3<span class="token punctuation">,</span> check.environment<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## using an opaque border color</span>
image<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> useAbs<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> border.col <span class="token operator">=</span> adjustcolor<span class="token punctuation">(</span><span class="token string">"skyblue"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> nzchar<span class="token punctuation">(</span>Sys.getenv<span class="token punctuation">(</span><span class="token string">"R_MATRIX_CHECK_EXTRA"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">## Using raster graphics: For PDF this would give a 77 MB file,</span>
<span class="token comment">## however, for such a large matrix, this is typically considerably</span>
<span class="token comment">## *slower* (than vector graphics rectangles) in most cases :</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>doPNG <span class="token operator">&lt;-</span> <span class="token operator">!</span>dev.interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   png<span class="token punctuation">(</span><span class="token string">"image-USCounties-raster.png"</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">3200</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">3200</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> useRaster <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># should not suffer from anti-aliasing</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>doPNG<span class="token punctuation">)</span>
   dev.off<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token comment">## and now look at the *.png image in a viewer you can easily zoom in and out</span>
<span class="token punctuation">}</span><span class="token comment">#only if(doExtras)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="index-class">

<a href="#index-class" class="help-page-title"><h2 id="index-class">Virtual Class "index" - Simple Class for Matrix Indices</h2></a>

<h3>Description</h3>

<p>The class <code>"index"</code> is a virtual class used for
indices (in signatures) for matrix indexing and sub-assignment of
<span class="pkg">Matrix</span> matrices.
</p>
<p>In fact, it is currently implemented as a simple class union
(<code><a href="https://r-universe.dev/manuals/methods.html#setClassUnion">setClassUnion</a></code>) of
<code>"numeric"</code>,  <code>"logical"</code> and <code>"character"</code>.
</p>


<h3>Objects from the Class</h3>

<p>Since it is a virtual Class, no objects
may be created from it.</p>


<h3>See Also</h3>

<p><code><a href="#Xtrct-methods">[-methods</a></code>, and

<code><a href="#Subassign-methods">Subassign-methods</a></code>, also for examples.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="indMatrix-class">

<a href="#indMatrix-class" class="help-page-title"><h2 id="indMatrix-class">Index Matrices</h2></a>

<h3>Description</h3>

<p>The <code>indMatrix</code> class is the class of row and column
<em>index</em> matrices, stored as 1-based integer index vectors.
A row (column) index matrix is a matrix whose rows (columns)
are standard unit vectors.  Such matrices are useful
when mapping observations to discrete sets of covariate values.
</p>
<p>Multiplying a matrix on the left by a row index matrix is
equivalent to indexing its rows, i.e., sampling the rows
“with replacement”.  Analogously, multiplying a matrix
on the right by a column index matrix is equivalent to
indexing its columns.  Indeed, such products are implemented in
<span class="pkg">Matrix</span> as indexing operations; see ‘Details’ below.
</p>
<p>A matrix whose rows <em>and</em> columns are standard unit vectors
is called a <em>permutation</em> matrix.  This special case is
designated by the <code><a href="#pMatrix-class">pMatrix</a></code> class, a direct
subclass of <code>indMatrix</code>.
</p>


<h3>Details</h3>

<p>The transpose of an index matrix is an index matrix with identical
<code>perm</code> but opposite <code>margin</code>.  Hence the transpose of a
row index matrix is a column index matrix, and vice versa.
</p>
<p>The cross product of a row index matrix <code>R</code> and itself is a
diagonal matrix whose diagonal entries are the the number of entries
in each column of <code>R</code>.
</p>
<p>Given a row index matrix <code>R</code> with <code>perm</code> slot <code>p</code>,
a column index matrix <code>C</code> with <code>perm</code> slot <code>q</code>,
and a matrix <code>M</code> with conformable dimensions, we have
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">R M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">RM</span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>R %*% M</code>        </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M[p, ]</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">M C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">MC</span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M %*% C</code>        </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M[, q]</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>C</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>M</mi></mrow><annotation encoding="application/x-tex">C'M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>crossprod(C, M)</code>  </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M[q, ]</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">MR'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>tcrossprod(M, R)</code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M[, p]</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>R</mi></mrow><annotation encoding="application/x-tex">R'R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>crossprod(R)</code>     </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>Diagonal(x=tabulate(p, ncol(R)))</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msup><mi>C</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">CC'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>tcrossprod(C)</code>    </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>Diagonal(x=tabulate(q, nrow(C)))</code>
  </td>
</tr>
</table>
<p>Operations on index matrices that result in index matrices will
accordingly return an <code>indMatrix</code>.  These include products
of two column index matrices and (equivalently) column-indexing
of a column index matrix (when dimensions are not dropped).
Most other operations on <code>indMatrix</code> treat them as sparse
nonzero pattern matrices (i.e., inheriting from virtual class
<code><a href="#nsparseMatrix-classes">nsparseMatrix</a></code>).  Hence vector-valued subsets
of <code>indMatrix</code>, such as those given by <code><a href="https://r-universe.dev/manuals/base.html#diag">diag</a></code>,
are always of type <code>"<a href="https://r-universe.dev/manuals/base.html#logical">logical</a>"</code>.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created explicitly with calls of the form
<code>new("indMatrix", ...)</code>, but they are more commonly created
by coercing 1-based integer index vectors, with calls of the
form <code>as(., "indMatrix")</code>; see ‘Methods’ below.
</p>


<h3>Slots</h3>


<dl>
<dt><code>margin</code></dt>
<dd>
<p>an integer, either 1 or 2, specifying
whether the matrix is a row (1) or column (2) index.</p>
</dd>
<dt><code>perm</code></dt>
<dd>
<p>a 1-based integer index vector, i.e.,
a vector of length <code>Dim[margin]</code> with elements
taken from <code>1:Dim[1+margin%%2]</code>.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>
</dt>
<dd>
<p>inherited from virtual
superclass <code><a href="#Matrix-class">Matrix</a></code>.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Classes <code>"<a href="#sparseMatrix-class">sparseMatrix</a>"</code> and
<code>"<a href="#generalMatrix-class">generalMatrix</a>"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt><code>%*%</code></dt>
<dd>
<p><code>signature(x = "indMatrix", y = "Matrix")</code>
and others listed by <code>showMethods("%*%", classes = "indMatrix")</code>:
matrix products implemented where appropriate as indexing operations.</p>
</dd>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "numeric", to = "indMatrix")</code>:
supporting typical <code>indMatrix</code> construction from
a vector of positive integers.  Row indexing is assumed.</p>
</dd>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "list", to = "indMatrix")</code>:
supporting <code>indMatrix</code> construction for row <em>and</em>
column indexing, including index vectors of length 0 and
index vectors whose maximum is less than the number of rows
or columns being indexed.</p>
</dd>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "indMatrix", to = "matrix")</code>:
coercion to a traditional <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code> of <a href="https://r-universe.dev/manuals/base.html#logical">logical</a> type,
with <code>FALSE</code> and <code>TRUE</code> in place of 0 and 1.</p>
</dd>
<dt><code>t</code></dt>
<dd>
<p><code>signature(x = "indMatrix")</code>:
the transpose, which is an <code>indMatrix</code> with identical
<code>perm</code> but opposite <code>margin</code>.</p>
</dd>
<dt>
<code>rowSums</code>,<code>rowMeans</code>,<code>colSums</code>,<code>colMeans</code>
</dt>
<dd>
<p><code>signature(x = "indMatrix")</code>:
row and column sums and means.</p>
</dd>
<dt>
<code>rbind2</code>,<code>cbind2</code>
</dt>
<dd>
<p><code>signature(x = "indMatrix", y = "indMatrix")</code>:
row-wise catenation of two row index matrices with equal numbers
of columns and column-wise catenation of two column index matrices
with equal numbers of rows.</p>
</dd>
<dt>kronecker</dt>
<dd>
<p><code>signature(X = "indMatrix", Y = "indMatrix")</code>:
Kronecker product of two row index matrices or two column index
matrices, giving the row or column index matrix corresponding to
their “interaction”.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Fabian Scheipl and Uni Muenchen, building on the existing class
<code><a href="#pMatrix-class">pMatrix</a></code> after a nice hike's conversation with
Martin Maechler.  Methods for <code><a href="#matrix-products">crossprod</a>(x, y)</code> and
<code><a href="#kronecker-methods">kronecker</a>(x, y)</code> with both arguments inheriting from
<code>indMatrix</code> were made considerably faster thanks to a suggestion
by Boris Vaillant.  Diverse tweaks by Martin Maechler and
Mikael Jagan, notably the latter's implementation of <code>margin</code>,
prior to which the <code>indMatrix</code> class was designated only for
row index matrices.
</p>


<h3>See Also</h3>

<p>Subclass <code><a href="#pMatrix-class">pMatrix</a></code> of permutation matrices,
a special case of index matrices; virtual class
<code><a href="#nMatrix-class">nMatrix</a></code> of nonzero pattern matrices,
and its subclasses.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">p1 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"pMatrix"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>sm1 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"indMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>sm1 <span class="token operator">==</span> p1<span class="token punctuation">[</span>rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> each<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## row-indexing of a &lt;pMatrix&gt; turns it into an &lt;indMatrix&gt;:</span>
class<span class="token punctuation">(</span>p1<span class="token punctuation">[</span>rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> each<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

set.seed<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token comment"># so we know '10' is in sample</span>
<span class="token comment">## random index matrix for 30 observations and 10 unique values:</span>
<span class="token punctuation">(</span>s10 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"indMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Sample rows of a numeric matrix :</span>
<span class="token punctuation">(</span>mm <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> nrow<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> ncol<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s10 <span class="token percent-operator operator">%*%</span> mm

set.seed<span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span>
IM1 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"indMatrix"</span><span class="token punctuation">)</span>
IM2 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"indMatrix"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>c12 <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>IM1<span class="token punctuation">,</span>IM2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## same as cross-tabulation of the two index vectors:</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>c12 <span class="token operator">-</span> unclass<span class="token punctuation">(</span>table<span class="token punctuation">(</span>IM1<span class="token operator">@</span>perm<span class="token punctuation">,</span> IM2<span class="token operator">@</span>perm<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 3 observations, 4 implied values, first does not occur in sample:</span>
as<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"indMatrix"</span><span class="token punctuation">)</span>
<span class="token comment"># 3 observations, 5 values, first and last do not occur in sample:</span>
as<span class="token punctuation">(</span>list<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"indMatrix"</span><span class="token punctuation">)</span>

as<span class="token punctuation">(</span>sm1<span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span>
s10<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token comment"># gives an "ngTMatrix" (most economic!)</span>
s10<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>  <span class="token comment"># preserves "indMatrix"-class</span>

I1 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"indMatrix"</span><span class="token punctuation">)</span>
I2 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"pMatrix"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>I12 <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I2<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>is<span class="token punctuation">(</span>I12<span class="token punctuation">,</span> <span class="token string">"indMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>I12<span class="token punctuation">,</span> rbind<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  colSums<span class="token punctuation">(</span>I12<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="invPerm">

<a href="#invPerm" class="help-page-title"><h2 id="invertPerm">Utilities for Permutation Vectors</h2></a>

<h3>Description</h3>

<p><code>invertPerm</code> and <code>signPerm</code> compute the inverse and sign
of a length-<code>n</code> permutation vector.  <code>isPerm</code> tests
if a length-<code>n</code> integer vector is a valid permutation vector.
<code>asPerm</code> coerces a length-<code>m</code> transposition vector to a
length-<code>n</code> permutation vector, where <code>m &lt;= n</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">invertPerm<span class="token punctuation">(</span>p<span class="token punctuation">,</span> off <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> ioff <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">)</span>
signPerm<span class="token punctuation">(</span>p<span class="token punctuation">,</span> off <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">)</span>
isPerm<span class="token punctuation">(</span>p<span class="token punctuation">,</span> off <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">)</span>
asPerm<span class="token punctuation">(</span>pivot<span class="token punctuation">,</span> off <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> ioff <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> n <span class="token operator">=</span> length<span class="token punctuation">(</span>pivot<span class="token punctuation">)</span><span class="token punctuation">)</span>

invPerm<span class="token punctuation">(</span>p<span class="token punctuation">,</span> zero.p <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> zero.res <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="invertPerm_:_p">p</code></td>
<td>
<p>an integer vector of length <code>n</code>.</p>
</td>
</tr>
<tr>
<td><code id="invertPerm_:_pivot">pivot</code></td>
<td>
<p>an integer vector of length <code>m</code>.</p>
</td>
</tr>
<tr>
<td><code id="invertPerm_:_off">off</code></td>
<td>
<p>an integer offset, indicating that <code>p</code> is
a permutation of <code>off+0:(n-1)</code> or that <code>pivot</code>
contains <code>m</code> values sampled with replacement from
<code>off+0:(n-1)</code>.</p>
</td>
</tr>
<tr>
<td><code id="invertPerm_:_ioff">ioff</code></td>
<td>
<p>an integer offset, indicating that the result
should be a permutation of <code>ioff+0:(n-1)</code>.</p>
</td>
</tr>
<tr>
<td><code id="invertPerm_:_n">n</code></td>
<td>
<p>a integer greater than or equal to <code>m</code>,
indicating the length of the result.  Transpositions
are applied to a permutation vector vector initialized
as <code>seq_len(n)</code>.</p>
</td>
</tr>
<tr>
<td><code id="invertPerm_:_zero.p">zero.p</code></td>
<td>
<p>a logical.  Equivalent to <code>off=0</code> if <code>TRUE</code>
and <code>off=1</code> if <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="invertPerm_:_zero.res">zero.res</code></td>
<td>
<p>a logical.  Equivalent to <code>ioff=0</code> if <code>TRUE</code>
and <code>ioff=1</code> if <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>invertPerm(p, off, ioff=1)</code> is equivalent to
<code><a href="https://r-universe.dev/manuals/base.html#order">order</a>(p)</code> or <code><a href="https://r-universe.dev/manuals/base.html#order">sort.list</a>(p)</code>
for all values of <code>off</code>.  For the default value
<code>off=1</code>, it returns the value of <code>p</code> after
<code>p[p] &lt;- seq_along(p)</code>.
</p>
<p><code>invPerm</code> is a simple wrapper around <code>invertPerm</code>,
retained for backwards compatibility.
</p>


<h3>Value</h3>

<p>By default, i.e., with <code>off=1</code> and <code>ioff=1</code>:
</p>
<p><code>invertPerm(p)</code> returns an integer vector of length
<code>length(p)</code> such that <code>p[invertPerm(p)]</code>
and <code>invertPerm(p)[p]</code> are both <code>seq_along(p)</code>,
i.e., the identity permutation.
</p>
<p><code>signPerm(p)</code> returns 1 if <code>p</code> is an even permutation
and <code>-1</code> otherwise (i.e., if <code>p</code> is odd).
</p>
<p><code>isPerm(p)</code> returns <code>TRUE</code> if <code>p</code> is a
permutation of <code>seq_along(p)</code> and <code>FALSE</code> otherwise.
</p>
<p><code>asPerm(pivot)</code> returns the result of transposing elements
<code>i</code> and <code>pivot[i]</code> of a permutation vector initialized
as <code>seq_len(n)</code>, for <code>i</code> in <code>seq_along(pivot)</code>.
</p>


<h3>See Also</h3>

<p>Class <code><a href="#pMatrix-class">pMatrix</a></code> of permutation matrices.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">p <span class="token operator">&lt;-</span> sample<span class="token punctuation">(</span><span class="token number">10L</span><span class="token punctuation">)</span> <span class="token comment"># a random permutation vector</span>
ip <span class="token operator">&lt;-</span> invertPerm<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
s <span class="token operator">&lt;-</span> signPerm<span class="token punctuation">(</span>p<span class="token punctuation">)</span>

<span class="token comment">## 'p' and 'ip' are indeed inverses:</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    isPerm<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    isPerm<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span> <span class="token operator">||</span> identical<span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1L</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>s<span class="token punctuation">,</span> signPerm<span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>p<span class="token punctuation">[</span>ip<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>ip<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>invertPerm<span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Product of transpositions (1 2)(2 1)(4 3)(6 8)(10 1) = (3 4)(6 8)(1 10)</span>
pivot <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">5L</span><span class="token punctuation">,</span> <span class="token number">8L</span><span class="token punctuation">,</span> <span class="token number">7L</span><span class="token punctuation">,</span> <span class="token number">8L</span><span class="token punctuation">,</span> <span class="token number">9L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span>
q <span class="token operator">&lt;-</span> asPerm<span class="token punctuation">(</span>pivot<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>q<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">10L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">4L</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">5L</span><span class="token punctuation">,</span> <span class="token number">8L</span><span class="token punctuation">,</span> <span class="token number">7L</span><span class="token punctuation">,</span> <span class="token number">6L</span><span class="token punctuation">,</span> <span class="token number">9L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>q<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span><span class="token number">10L</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># because the permutation is odd:</span>
    signPerm<span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1L</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

invPerm <span class="token comment"># a less general version of 'invertPerm'</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="is.na-methods">

<a href="#is.na-methods" class="help-page-title"><h2 id="is.na-methods">is.na(), is.finite() Methods for 'Matrix' Objects</h2></a>

<h3>Description</h3>

<p>Methods for generic functions <code><a href="#is.na-methods">is.na</a>()</code>,
<code><a href="#is.na-methods">is.nan</a>()</code>, <code><a href="#is.na-methods">is.finite</a>()</code>,
<code><a href="#is.na-methods">is.infinite</a>()</code>, and <code><a href="#is.na-methods">anyNA</a>()</code>,
for objects inheriting from virtual class
<code><a href="#Matrix-class">Matrix</a></code> or <code><a href="#sparseVector-class">sparseVector</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S4 method for signature 'dsparseMatrix'</span>
is.na<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsparseMatrix'</span>
is.nan<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsparseMatrix'</span>
is.finite<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsparseMatrix'</span>
is.infinite<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsparseMatrix'</span>
anyNA<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">## ...</span>
<span class="token comment">## and for other classes</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="is.na-methods_:_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object, here a sparse or dense matrix or vector.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>For <code>is.*()</code>, an <code><a href="#nMatrix-class">nMatrix</a></code> or
<code><a href="#sparseVector-class">nsparseVector</a></code> matching the dimensions
of <code>x</code> and specifying the positions in <code>x</code> of
(some subset of) <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#is.finite">NaN</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#is.finite">Inf</a></code>, and <code>-Inf</code>.
For <code>anyNA</code>(), <code>TRUE</code> if <code>x</code> contains <code>NA</code>
or <code>NaN</code> and <code>FALSE</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#is.finite">NaN</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#is.finite">Inf</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
             dimnames <span class="token operator">=</span> list<span class="token punctuation">(</span>letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span><span class="token operator">!</span>anyNA<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">!</span>any<span class="token punctuation">(</span>is.na<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

M<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token keyword">NA</span>
<span class="token punctuation">(</span>inM <span class="token operator">&lt;-</span> is.na<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>anyNA<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> sum<span class="token punctuation">(</span>inM<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> spMatrix<span class="token punctuation">(</span>nrow <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span>
               i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span><span class="token operator">!</span>anyNA<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">!</span>any<span class="token punctuation">(</span>is.na<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

A<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> A<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token keyword">NA</span>
<span class="token punctuation">(</span>inA <span class="token operator">&lt;-</span> is.na<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>anyNA<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> sum<span class="token punctuation">(</span>inA<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="is.null.DN">

<a href="#is.null.DN" class="help-page-title"><h2 id="is.null.DN">Are the Dimnames <code>dn</code> NULL-like ?</h2></a>

<h3>Description</h3>

<p>Are the <code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code> <code>dn</code> <code><a href="https://r-universe.dev/manuals/base.html#NULL">NULL</a></code>-like?
</p>
<p><code>is.null.DN(dn)</code> is less strict than <code><a href="https://r-universe.dev/manuals/base.html#NULL">is.null</a>(dn)</code>,
because it is also true (<code><a href="https://r-universe.dev/manuals/base.html#logical">TRUE</a></code>) when the dimnames
<code>dn</code> are “like” <code>NULL</code>, or <code>list(NULL,NULL)</code>, as
they can easily be for the traditional <span class="rlang"><b>R</b></span> matrices
(<code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>) which have no formal <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code>
definition, and hence much freedom in how their <code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>
look like.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">is.null.DN<span class="token punctuation">(</span>dn<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="is.null.DN_:_dn">dn</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a>()</code> of a <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>-like <span class="rlang"><b>R</b></span>
object.
</p>
</td>
</tr></table>
<h3>Value</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> <code><a href="https://r-universe.dev/manuals/base.html#logical">TRUE</a></code> or <code><a href="https://r-universe.dev/manuals/base.html#logical">FALSE</a></code>.
</p>


<h3>Note</h3>

<p>This function is really to be used on “traditional” matrices
rather than those inheriting from <code><a href="#Matrix-class">Matrix</a></code>, as
the latter will always have dimnames <code>list(NULL,NULL)</code> exactly,
in such a case.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#NULL">is.null</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">m1 <span class="token operator">&lt;-</span> m2 <span class="token operator">&lt;-</span> m3 <span class="token operator">&lt;-</span> m4 <span class="token operator">&lt;-</span> m <span class="token operator">&lt;-</span>
    matrix<span class="token punctuation">(</span>round<span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> rnorm<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>m1<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>m2<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> character<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>m3<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> rev<span class="token punctuation">(</span>dimnames<span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>m4<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> rep<span class="token punctuation">(</span>list<span class="token punctuation">(</span>character<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>

m4 <span class="token comment"># prints absolutely identically to m</span>

c.o <span class="token operator">&lt;-</span> capture.output
cm <span class="token operator">&lt;-</span> c.o<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    m <span class="token operator">==</span> m1<span class="token punctuation">;</span> m <span class="token operator">==</span> m2<span class="token punctuation">;</span> m <span class="token operator">==</span> m3<span class="token punctuation">;</span> m <span class="token operator">==</span> m4
	identical<span class="token punctuation">(</span>cm<span class="token punctuation">,</span> c.o<span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	identical<span class="token punctuation">(</span>cm<span class="token punctuation">,</span> c.o<span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">)</span>
	identical<span class="token punctuation">(</span>cm<span class="token punctuation">,</span> c.o<span class="token punctuation">(</span>m3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> identical<span class="token punctuation">(</span>cm<span class="token punctuation">,</span> c.o<span class="token punctuation">(</span>m4<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

hasNoDimnames <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>.<span class="token punctuation">)</span> is.null.DN<span class="token punctuation">(</span>dimnames<span class="token punctuation">(</span>.<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    hasNoDimnames<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    hasNoDimnames<span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">;</span> hasNoDimnames<span class="token punctuation">(</span>m2<span class="token punctuation">)</span>
    hasNoDimnames<span class="token punctuation">(</span>m3<span class="token punctuation">)</span><span class="token punctuation">;</span> hasNoDimnames<span class="token punctuation">(</span>m4<span class="token punctuation">)</span>
    hasNoDimnames<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> M<span class="token punctuation">)</span>
    hasNoDimnames<span class="token punctuation">(</span>as<span class="token punctuation">(</span>M<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="isSymmetric-methods">

<a href="#isSymmetric-methods" class="help-page-title"><h2 id="isSymmetric-methods">Methods for Function 'isSymmetric' in Package 'Matrix'</h2></a>

<h3>Description</h3>

<p><code>isSymmetric</code> tests whether its argument is a symmetric square
matrix, by default tolerating some numerical fuzz and requiring
symmetric <code>[dD]imnames</code> in addition to symmetry in the
mathematical sense.  <code>isSymmetric</code> is a generic function in
<span class="pkg">base</span>, which has a <a href="#isSymmetric-methods">method</a> for traditional
matrices of implicit <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> <code>"<a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a>"</code>.
Methods are defined here for various proper and virtual classes
in <span class="pkg">Matrix</span>, so that <code>isSymmetric</code> works for all objects
inheriting from virtual class <code>"<a href="#Matrix-class">Matrix</a>"</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S4 method for signature 'symmetricMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'triangularMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> checkDN <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'diagonalMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> checkDN <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'indMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> checkDN <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dgeMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> .Machine<span class="token operator">$</span>double.eps<span class="token punctuation">,</span> tol1 <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">*</span> tol<span class="token punctuation">,</span> checkDN <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'lgeMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> checkDN <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'ngeMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> checkDN <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dgCMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> .Machine<span class="token operator">$</span>double.eps<span class="token punctuation">,</span> checkDN <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'lgCMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> checkDN <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'ngCMatrix'</span>
isSymmetric<span class="token punctuation">(</span>object<span class="token punctuation">,</span> checkDN <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="isSymmetric-methods_:_object">object</code></td>
<td>
<p>a <code>"Matrix"</code>.</p>
</td>
</tr>
<tr>
<td>
<code id="isSymmetric-methods_:_tol">tol</code>, <code id="isSymmetric-methods_:_tol1">tol1</code>
</td>
<td>
<p>numerical tolerances allowing <em>approximate</em>
symmetry of numeric (rather than logical) matrices.  See also
<code><a href="https://r-universe.dev/manuals/base.html#isSymmetric">isSymmetric.matrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="isSymmetric-methods_:_checkDN">checkDN</code></td>
<td>
<p>a <a href="https://r-universe.dev/manuals/base.html#logical">logical</a> indicating whether symmetry of the
<code>Dimnames</code> <a href="https://r-universe.dev/manuals/methods.html#slot">slot</a> of <code>object</code> should be checked.</p>
</td>
</tr>
<tr>
<td><code id="isSymmetric-methods_:_...">...</code></td>
<td>
<p>further arguments passed to methods
(typically methods for <code><a href="#all.equal-methods">all.equal</a></code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>Dimnames</code> <a href="https://r-universe.dev/manuals/methods.html#slot">slot</a> of <code>object</code>, say <code>dn</code>,
is considered to be symmetric if and only if
</p>

<ul>
<li> <p><code>dn[[1]]</code> and <code>dn[[2]]</code> are identical <em>or</em>
one is <code>NULL</code>; <em>and</em>
</p>
</li>
<li> <p><code>ndn &lt;- names(dn)</code> is <code>NULL</code> <em>or</em>
<code>ndn[1]</code> and <code>ndn[2]</code> are identical <em>or</em>
one is the empty string <code>""</code>.
</p>
</li>
</ul>
<p>Hence <code>list(a=nms, a=nms)</code> is considered to be <em>symmetric</em>,
and so too are <code>list(a=nms, NULL)</code> and <code>list(NULL, a=nms)</code>.
</p>
<p>Note that this definition is <em>looser</em> than that employed by
<code><a href="https://r-universe.dev/manuals/base.html#isSymmetric">isSymmetric.matrix</a></code>, which requires <code>dn[1]</code> and
<code>dn[2]</code> to be identical, where <code>dn</code> is the <code>dimnames</code>
<a href="https://r-universe.dev/manuals/base.html#attr">attribute</a> of a traditional matrix.
</p>


<h3>Value</h3>

<p>A <a href="https://r-universe.dev/manuals/base.html#logical">logical</a>, either <code>TRUE</code> or <code>FALSE</code>
(never <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>).
</p>


<h3>See Also</h3>

<p><code><a href="#forceSymmetric">forceSymmetric</a></code>;
<code><a href="#symmpart">symmpart</a></code> and <code><a href="#symmpart">skewpart</a></code>;
virtual class <code>"<a href="#symmetricMatrix-class">symmetricMatrix</a>"</code> and its subclasses.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">isSymmetric<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># TRUE of course</span>
M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
isSymmetric<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token comment"># TRUE (*and* of formal class "dsyMatrix")</span>
isSymmetric<span class="token punctuation">(</span>as<span class="token punctuation">(</span>M<span class="token punctuation">,</span> <span class="token string">"generalMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># still symmetric, even if not "formally"</span>
isSymmetric<span class="token punctuation">(</span>triu<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># FALSE</span>

<span class="token comment">## Look at implementations:</span>
showMethods<span class="token punctuation">(</span><span class="token string">"isSymmetric"</span><span class="token punctuation">,</span> includeDefs <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># includes S3 generic from base</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="isTriangular">

<a href="#isTriangular" class="help-page-title"><h2 id="isTriangular-methods">Test whether a Matrix is Triangular or Diagonal</h2></a>

<h3>Description</h3>

<p><code>isTriangular</code> and <code>isDiagonal</code> test whether their argument
is a triangular or diagonal matrix, respectively.  Unlike the analogous
<code><a href="#isSymmetric-methods">isSymmetric</a></code>, these two functions are generically
from <span class="pkg">Matrix</span> rather than <code>base</code>.  Hence <span class="pkg">Matrix</span>
defines methods for traditional matrices of implicit <a href="https://r-universe.dev/manuals/base.html#class">class</a>
<code>"<a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a>"</code> in addition to matrices inheriting from
virtual class <code>"<a href="#Matrix-class">Matrix</a>"</code>.
</p>
<p>By our definition, triangular and diagonal matrices are <em>square</em>,
i.e., they have the same number of rows and columns.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">isTriangular<span class="token punctuation">(</span>object<span class="token punctuation">,</span> upper <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

isDiagonal<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="isTriangular-methods_:_object">object</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object, typically a matrix.</p>
</td>
</tr>
<tr>
<td><code id="isTriangular-methods_:_upper">upper</code></td>
<td>
<p>a <a href="https://r-universe.dev/manuals/base.html#logical">logical</a>, either <code>TRUE</code> or <code>FALSE</code>,
in which case <code>TRUE</code> is returned only for upper or lower
triangular <code>object</code>; or otherwise <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code> (the
default), in which case <code>TRUE</code> is returned for any triangular
<code>object</code>.</p>
</td>
</tr>
<tr>
<td><code id="isTriangular-methods_:_...">...</code></td>
<td>
<p>further arguments passed to methods
(currently unused by <span class="pkg">Matrix</span>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <a href="https://r-universe.dev/manuals/base.html#logical">logical</a>, either <code>TRUE</code> or <code>FALSE</code>
(never <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>).
</p>
<p>If <code>object</code> is triangular and <code>upper</code> is <code>NA</code>, then
<code>isTriangular</code> returns <code>TRUE</code> with an <a href="https://r-universe.dev/manuals/base.html#attr">attribute</a> 
<code>kind</code>, either <code>"U"</code> or <code>"L"</code>, indicating that
<code>object</code> is <b>u</b>pper or <b>l</b>ower triangular, respectively.  
Users should not rely on how <code>kind</code> is determined for diagonal
matrices, which are both upper and lower triangular.
</p>


<h3>See Also</h3>

<p><code><a href="#isSymmetric-methods">isSymmetric</a></code>;
virtual classes <code>"<a href="#triangularMatrix-class">triangularMatrix</a>"</code> and
<code>"<a href="#diagonalMatrix-class">diagonalMatrix</a>"</code> and their subclasses.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">isTriangular<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## is TRUE: a diagonal matrix is also (both upper and lower) triangular</span>
<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
isTriangular<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token comment"># TRUE (*and* of formal class "dtrMatrix")</span>
isTriangular<span class="token punctuation">(</span>as<span class="token punctuation">(</span>M<span class="token punctuation">,</span> <span class="token string">"generalMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># still triangular, even if not "formally"</span>
isTriangular<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># FALSE</span>

isDiagonal<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># TRUE</span>

<span class="token comment">## Look at implementations:</span>
showMethods<span class="token punctuation">(</span><span class="token string">"isTriangular"</span><span class="token punctuation">,</span> includeDefs <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
showMethods<span class="token punctuation">(</span><span class="token string">"isDiagonal"</span><span class="token punctuation">,</span> includeDefs <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="KhatriRao">

<a href="#KhatriRao" class="help-page-title"><h2 id="KhatriRao">Khatri-Rao Matrix Product</h2></a>

<h3>Description</h3>

<p>Computes Khatri-Rao products for any kind of matrices.
</p>
<p>The Khatri-Rao product is a column-wise Kronecker product.  Originally
introduced by Khatri and Rao (1968), it has many different applications,
see Liu and Trenkler (2008) for a survey.  Notably, it is used in
higher-dimensional tensor decompositions, see Bader and Kolda (2008).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">KhatriRao<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y <span class="token operator">=</span> X<span class="token punctuation">,</span> FUN <span class="token operator">=</span> <span class="token string">"*"</span><span class="token punctuation">,</span> sparseY <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> make.dimnames <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td>
<code id="KhatriRao_:_X">X</code>, <code id="KhatriRao_:_Y">Y</code>
</td>
<td>
<p>matrices of with the same number of columns.</p>
</td>
</tr>
<tr>
<td><code id="KhatriRao_:_FUN">FUN</code></td>
<td>
<p>the (name of the) <code><a href="https://r-universe.dev/manuals/base.html#function">function</a></code> to be used for the
column-wise Kronecker products, see <code><a href="#kronecker-methods">kronecker</a></code>,
defaulting to the usual multiplication.</p>
</td>
</tr>
<tr>
<td><code id="KhatriRao_:_sparseY">sparseY</code></td>
<td>
<p>logical specifying if <code>Y</code> should be coerced and
treated as <code><a href="#sparseMatrix-class">sparseMatrix</a></code>.   Set this to
<code>FALSE</code>, e.g., to distinguish structural zeros from zero entries.</p>
</td>
</tr>
<tr>
<td><code id="KhatriRao_:_make.dimnames">make.dimnames</code></td>
<td>
<p>logical indicating if the result should inherit
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code> from <code>X</code> and <code>Y</code> in a simple way.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>"<a href="#CsparseMatrix-class">CsparseMatrix</a>"</code>, say <code>R</code>, the Khatri-Rao
product of <code>X</code> (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">n \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>) and <code>Y</code> (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">m
    \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>), is of dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>m</mi><mo stretchy="false">)</mo><mo>×</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">(n\cdot m) \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>,
where the j-th column, <code>R[,j]</code> is the kronecker product
<code><a href="#kronecker-methods">kronecker</a>(X[,j], Y[,j])</code>.
</p>


<h3>Note</h3>


<p>The current implementation is efficient for large sparse matrices.
</p>


<h3>Author(s)</h3>

<p>Original by Michael Cysouw, Univ. Marburg;
minor tweaks, bug fixes etc, by Martin Maechler.
</p>


<h3>References</h3>

<p>Khatri, C. G., and Rao, C. Radhakrishna (1968)
Solutions to Some Functional Equations and Their Applications to
Characterization of Probability Distributions.
<em>Sankhya: Indian J. Statistics, Series A</em> <b>30</b>, 167–180.
</p>
<p>Bader, Brett W, and Tamara G Kolda (2008)
Efficient MATLAB Computations with Sparse and Factored Tensors.
<em>SIAM J. Scientific Computing</em> <b>30</b>, 205–231.
</p>


<h3>See Also</h3>

<p><code><a href="#kronecker-methods">kronecker</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Example with very small matrices:</span>
m <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
d <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>
KhatriRao<span class="token punctuation">(</span>m<span class="token punctuation">,</span>d<span class="token punctuation">)</span>
KhatriRao<span class="token punctuation">(</span>d<span class="token punctuation">,</span>m<span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
KhatriRao<span class="token punctuation">(</span>m<span class="token punctuation">,</span>d<span class="token punctuation">,</span> make.dimnames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
KhatriRao<span class="token punctuation">(</span>d<span class="token punctuation">,</span>m<span class="token punctuation">,</span> make.dimnames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> paste0<span class="token punctuation">(</span><span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
KhatriRao<span class="token punctuation">(</span>m<span class="token punctuation">,</span>d<span class="token punctuation">,</span> make.dimnames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
KhatriRao<span class="token punctuation">(</span>d<span class="token punctuation">,</span>m<span class="token punctuation">,</span> make.dimnames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>paste0<span class="token punctuation">(</span><span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> paste0<span class="token punctuation">(</span><span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>Kmd <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>m<span class="token punctuation">,</span>d<span class="token punctuation">,</span> make.dimnames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>Kdm <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>d<span class="token punctuation">,</span>m<span class="token punctuation">,</span> make.dimnames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

nm <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">"nsparseMatrix"</span><span class="token punctuation">)</span>
nd <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token string">"nsparseMatrix"</span><span class="token punctuation">)</span>
KhatriRao<span class="token punctuation">(</span>nm<span class="token punctuation">,</span>nd<span class="token punctuation">,</span> make.dimnames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
KhatriRao<span class="token punctuation">(</span>nd<span class="token punctuation">,</span>nm<span class="token punctuation">,</span> make.dimnames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>

stopifnot<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>KhatriRao<span class="token punctuation">(</span>m<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">(</span>nrow<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">*</span>nrow<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> ncol<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## border cases / checks:</span>
zm <span class="token operator">&lt;-</span> nm<span class="token punctuation">;</span> zm<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token boolean">FALSE</span> <span class="token comment"># all FALSE matrix</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>K1 <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>nd<span class="token punctuation">,</span> zm<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> identical<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>K1<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">12L</span><span class="token punctuation">,</span> <span class="token number">4L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          all<span class="token punctuation">(</span>K2 <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>zm<span class="token punctuation">,</span> nd<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> identical<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>K2<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">12L</span><span class="token punctuation">,</span> <span class="token number">4L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

d0 <span class="token operator">&lt;-</span> d<span class="token punctuation">;</span> d0<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span><span class="token punctuation">;</span> m0 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>d0<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>K3 <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>d0<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> identical<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>K3<span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token punctuation">(</span>Kdm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  all<span class="token punctuation">(</span>K4 <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>m<span class="token punctuation">,</span> d0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> identical<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>K4<span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token punctuation">(</span>Kmd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  all<span class="token punctuation">(</span>KhatriRao<span class="token punctuation">(</span>d0<span class="token punctuation">,</span> d0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span>KhatriRao<span class="token punctuation">(</span>m0<span class="token punctuation">,</span> d0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  all<span class="token punctuation">(</span>KhatriRao<span class="token punctuation">(</span>d0<span class="token punctuation">,</span> m0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span>KhatriRao<span class="token punctuation">(</span>m0<span class="token punctuation">,</span> m0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  identical<span class="token punctuation">(</span>dimnames<span class="token punctuation">(</span>KhatriRao<span class="token punctuation">(</span>m<span class="token punctuation">,</span> d0<span class="token punctuation">,</span> make.dimnames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dimnames<span class="token punctuation">(</span>Kmd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## a matrix with "structural" and non-structural zeros:</span>
m01 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dgCMatrix"</span><span class="token punctuation">,</span> i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">4L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           Dim <span class="token operator">=</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
D4 <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment"># "as" d</span>
DU <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token comment"># unit-diagonal: uplo="U"</span>
<span class="token punctuation">(</span>K5  <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span> d<span class="token punctuation">,</span> m01<span class="token punctuation">)</span><span class="token punctuation">)</span>
K5d  <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span> d<span class="token punctuation">,</span> m01<span class="token punctuation">,</span> sparseY<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
K5Dd <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>D4<span class="token punctuation">,</span> m01<span class="token punctuation">,</span> sparseY<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
K5Ud <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>DU<span class="token punctuation">,</span> m01<span class="token punctuation">,</span> sparseY<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>K6  <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>     t<span class="token punctuation">(</span>m01<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
K6D  <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span>m01<span class="token punctuation">)</span><span class="token punctuation">)</span>
K6d  <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>     t<span class="token punctuation">(</span>m01<span class="token punctuation">)</span><span class="token punctuation">,</span> sparseY<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
K6Dd <span class="token operator">&lt;-</span> KhatriRao<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span>m01<span class="token punctuation">)</span><span class="token punctuation">,</span> sparseY<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    all<span class="token punctuation">(</span>K5 <span class="token operator">==</span> K5d<span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">7L</span><span class="token punctuation">,</span> <span class="token number">10L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">4L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              which<span class="token punctuation">(</span>K5 <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span> arr.ind <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> useNames<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>K5d<span class="token punctuation">,</span> K5Dd<span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>K6<span class="token punctuation">,</span> K6D<span class="token punctuation">)</span>
    all<span class="token punctuation">(</span>K6 <span class="token operator">==</span> K6d<span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              which<span class="token punctuation">(</span>K6 <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span> arr.ind <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> useNames<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>K6d<span class="token punctuation">,</span> K6Dd<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="KNex">

<a href="#KNex" class="help-page-title"><h2 id="KNex">Koenker-Ng Example Sparse Model Matrix and Response Vector</h2></a>

<h3>Description</h3>

<p>A model matrix <code>mm</code> and corresponding response vector <code>y</code>
used in an example by Koenker and Ng.  The matrix <code>mm</code> is a sparse
matrix with 1850 rows and 712 columns but only 8758 non-zero entries.
It is a <code>"dgCMatrix"</code> object.  The vector <code>y</code> is just
<code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code> of length 1850.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>KNex<span class="token punctuation">)</span></code></pre>


<h3>References</h3>

<p>Roger Koenker and Pin Ng (2003).
SparseM: A sparse matrix package for R;
<em>J. of Statistical Software</em>, <b>8</b> (6),
<a href="https://doi.org/10.18637/jss.v008.i06" target="_blank">doi:10.18637/jss.v008.i06</a>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
class<span class="token punctuation">(</span>KNex<span class="token operator">$</span>mm<span class="token punctuation">)</span>
dim<span class="token punctuation">(</span>KNex<span class="token operator">$</span>mm<span class="token punctuation">)</span>
image<span class="token punctuation">(</span>KNex<span class="token operator">$</span>mm<span class="token punctuation">)</span>
str<span class="token punctuation">(</span>KNex<span class="token punctuation">)</span>

system.time<span class="token punctuation">(</span> <span class="token comment"># a fraction of a second</span>
  sparse.sol <span class="token operator">&lt;-</span> with<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> solve<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>mm<span class="token punctuation">)</span><span class="token punctuation">,</span> crossprod<span class="token punctuation">(</span>mm<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

head<span class="token punctuation">(</span>round<span class="token punctuation">(</span>sparse.sol<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Compare with QR-based solution ("more accurate, but slightly slower"):</span>
system.time<span class="token punctuation">(</span>
  sp.sol2 <span class="token operator">&lt;-</span> with<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> qr.coef<span class="token punctuation">(</span>qr<span class="token punctuation">(</span>mm<span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>

all.equal<span class="token punctuation">(</span>sparse.sol<span class="token punctuation">,</span> sp.sol2<span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">1e-13</span><span class="token punctuation">)</span> <span class="token comment"># TRUE</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="kronecker-methods">

<a href="#kronecker-methods" class="help-page-title"><h2 id="kronecker-methods">Methods for Function 'kronecker()' in Package 'Matrix'</h2></a>

<h3>Description</h3>

<p>Computes Kronecker products for objects inheriting from
<code>"<a href="#Matrix-class">Matrix</a>"</code>.
</p>
<p>In order to preserver sparseness, we treat <code>0 * NA</code> as <code>0</code>,
not as <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code> as usually in <span class="rlang"><b>R</b></span> (and as used for the
<span class="pkg">base</span> function <code><a href="https://r-universe.dev/manuals/base.html#kronecker">kronecker</a></code>).
</p>


<h3>Methods</h3>


<dl>
<dt>kronecker</dt>
<dd>
<p><code>signature(X = "Matrix", Y = "ANY")</code> .......</p>
</dd>
<dt>kronecker</dt>
<dd>
<p><code>signature(X = "ANY", Y = "Matrix")</code> .......</p>
</dd>
<dt>kronecker</dt>
<dd>
<p><code>signature(X = "diagonalMatrix", Y = "ANY")</code> .......</p>
</dd>
<dt>kronecker</dt>
<dd>
<p><code>signature(X = "sparseMatrix", Y = "ANY")</code> .......</p>
</dd>
<dt>kronecker</dt>
<dd>
<p><code>signature(X = "TsparseMatrix", Y = "TsparseMatrix")</code> .......</p>
</dd>
<dt>kronecker</dt>
<dd>
<p><code>signature(X = "dgTMatrix", Y = "dgTMatrix")</code> .......</p>
</dd>
<dt>kronecker</dt>
<dd>
<p><code>signature(X = "dtTMatrix", Y = "dtTMatrix")</code> .......</p>
</dd>
<dt>kronecker</dt>
<dd>
<p><code>signature(X = "indMatrix", Y = "indMatrix")</code> .......</p>
</dd>
</dl>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>t1 <span class="token operator">&lt;-</span> spMatrix<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span> x<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#  5 x  4</span>
<span class="token punctuation">(</span>t2 <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t1<span class="token punctuation">)</span><span class="token punctuation">)</span>               <span class="token comment"># 15 x 12</span>

<span class="token comment">## should also work with special-cased logical matrices</span>
l3 <span class="token operator">&lt;-</span> upper.tri<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>l3<span class="token punctuation">)</span>
<span class="token punctuation">(</span>N <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>M<span class="token punctuation">,</span> <span class="token string">"nsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># "ntCMatrix" (upper triangular)</span>
N2 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token string">"generalMatrix"</span><span class="token punctuation">)</span>  <span class="token comment"># (lost "t"riangularity)</span>
MM <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>M<span class="token punctuation">,</span>M<span class="token punctuation">)</span>
NN <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>N<span class="token punctuation">,</span>N<span class="token punctuation">)</span> <span class="token comment"># "dtTMatrix" i.e. did keep</span>
NN2 <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>N2<span class="token punctuation">,</span>N2<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>NN<span class="token punctuation">,</span>MM<span class="token punctuation">)</span><span class="token punctuation">,</span>
          is<span class="token punctuation">(</span>NN2<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span>NN2 <span class="token operator">==</span> NN<span class="token punctuation">)</span><span class="token punctuation">,</span>
          is<span class="token punctuation">(</span>NN<span class="token punctuation">,</span> <span class="token string">"triangularMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ldenseMatrix-class">

<a href="#ldenseMatrix-class" class="help-page-title"><h2 id="ldenseMatrix-class">Virtual Class "ldenseMatrix" of Dense Logical Matrices</h2></a>

<h3>Description</h3>

<p><code>ldenseMatrix</code> is the virtual class of all dense <b>l</b>ogical
(S4) matrices.  It extends both <code><a href="#denseMatrix-class">denseMatrix</a></code>
and <code><a href="#dMatrix-class">lMatrix</a></code> directly.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>logical vector containing the entries of the matrix.</p>
</dd>
<dt>
<code>Dim</code>, <code>Dimnames</code>:</dt>
<dd>
<p>see <code><a href="#Matrix-class">Matrix</a></code>.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"lMatrix"</code>, directly.
Class <code>"denseMatrix"</code>, directly.
Class <code>"Matrix"</code>, by class <code>"lMatrix"</code>.
Class <code>"Matrix"</code>, by class <code>"denseMatrix"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>as.vector</dt>
<dd>
<p><code>signature(x = "ldenseMatrix", mode = "missing")</code>: ...</p>
</dd>
<dt>which</dt>
<dd>
<p><code>signature(x = "ndenseMatrix")</code>, semantically
equivalent to <span class="pkg">base</span> function <code><a href="https://r-universe.dev/manuals/base.html#which">which</a>(x, arr.ind)</code>;
for details, see the <code><a href="#dMatrix-class">lMatrix</a></code> class documentation.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Class <code><a href="#lgeMatrix-class">lgeMatrix</a></code> and the other subclasses.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"ldenseMatrix"</span><span class="token punctuation">)</span>

as<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"ldenseMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ldiMatrix-class">

<a href="#ldiMatrix-class" class="help-page-title"><h2 id="ldiMatrix-class">Class "ldiMatrix" of Diagonal Logical Matrices</h2></a>

<h3>Description</h3>

<p>The class <code>"ldiMatrix"</code> of logical diagonal matrices.

</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("ldiMatrix", ...)</code>
but typically rather via <code><a href="#Diagonal">Diagonal</a></code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p><code>"logical"</code> vector.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p><code>"character"</code> string, either "U" or "N",
see <code><a href="#ddiMatrix-class">ddiMatrix</a></code>.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>matrix dimension and
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>, see the <code><a href="#Matrix-class">Matrix</a></code> class
description.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"<a href="#diagonalMatrix-class">diagonalMatrix</a>"</code> and
class <code>"<a href="#dMatrix-class">lMatrix</a>"</code>, directly.
</p>
<p>Class <code>"<a href="#sparseMatrix-class">sparseMatrix</a>"</code>, by class <code>"diagonalMatrix"</code>.
</p>


<h3>See Also</h3>

<p>Classes <code><a href="#ddiMatrix-class">ddiMatrix</a></code> and
<code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>; function <code><a href="#Diagonal">Diagonal</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>lM <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span>x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>lM<span class="token punctuation">)</span><span class="token comment">#&gt; gory details (slots)</span>

crossprod<span class="token punctuation">(</span>lM<span class="token punctuation">)</span> <span class="token comment"># numeric</span>
<span class="token punctuation">(</span>nM <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>lM<span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># -&gt; sparse (not formally ``diagonal'')</span>
crossprod<span class="token punctuation">(</span>nM<span class="token punctuation">)</span> <span class="token comment"># logical sparse</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lgeMatrix-class">

<a href="#lgeMatrix-class" class="help-page-title"><h2 id="lgeMatrix-class">Class "lgeMatrix" of General Dense Logical Matrices</h2></a>

<h3>Description</h3>

<p>This is the class of general dense <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code>
matrices.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code>. The logical
values that constitute the matrix, stored in column-major order.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>), see the
<code><a href="#Matrix-class">Matrix</a></code> class.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code>.  A named
list of factorizations that have been computed for the matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"ldenseMatrix"</code>, directly.
Class <code>"lMatrix"</code>, by class <code>"ldenseMatrix"</code>.
Class <code>"denseMatrix"</code>, by class <code>"ldenseMatrix"</code>.
Class <code>"Matrix"</code>, by class <code>"ldenseMatrix"</code>.
Class <code>"Matrix"</code>, by class <code>"ldenseMatrix"</code>.
</p>


<h3>Methods</h3>

<p>Currently, mainly <code><a href="https://r-universe.dev/manuals/base.html#t">t</a>()</code> and coercion methods (for
<code><a href="https://r-universe.dev/manuals/methods.html#as">as</a>(.)</code>); use, e.g.,
<code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(class="lgeMatrix")</code> for details.
</p>


<h3>See Also</h3>

<p>Non-general logical dense matrix classes such as
<code><a href="#ltrMatrix-class">ltrMatrix</a></code>, or <code><a href="#lsyMatrix-class">lsyMatrix</a></code>;
<em>sparse</em> logical classes such as <code><a href="#lsparseMatrix-classes">lgCMatrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"lgeMatrix"</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>new<span class="token punctuation">(</span><span class="token string">"lgeMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>lM <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># a simple random lgeMatrix</span>
set.seed<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>lC <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># a simple random lgCMatrix</span>
as<span class="token punctuation">(</span>lM<span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lsparseMatrix-classes">

<a href="#lsparseMatrix-classes" class="help-page-title"><h2 id="lsparseMatrix-classes">Sparse logical matrices</h2></a>

<h3>Description</h3>

<p>The <code>lsparseMatrix</code> class is a virtual class of sparse
matrices with <code>TRUE</code>/<code>FALSE</code> or <code>NA</code> entries.  Only the
positions of the elements that are <code>TRUE</code> are stored.
</p>
<p>These can be stored in the “triplet” form (class
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>, subclasses <code>lgTMatrix</code>,
<code>lsTMatrix</code>, and <code>ltTMatrix</code>) or in compressed
column-oriented form (class <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>,
subclasses <code>lgCMatrix</code>, <code>lsCMatrix</code>, and <code>ltCMatrix</code>)
or–<em>rarely</em>–in compressed row-oriented form (class
<code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>, subclasses <code>lgRMatrix</code>,
<code>lsRMatrix</code>, and <code>ltRMatrix</code>).  The second letter in the
name of these non-virtual classes indicates <code>g</code>eneral,
<code>s</code>ymmetric, or <code>t</code>riangular.
</p>


<h3>Details</h3>

<p>Note that triplet stored (<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>) matrices
such as <code>lgTMatrix</code> may contain duplicated pairs of indices
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></code> as for the corresponding numeric class
<code><a href="#dgTMatrix-class">dgTMatrix</a></code> where for such pairs, the corresponding
<code>x</code> slot entries are added.  For logical matrices, the <code>x</code>
entries corresponding to duplicated index pairs <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></code> are
“added” as well if the addition is defined as logical <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">or</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span></span></span></span></code>,
i.e., “<code>TRUE + TRUE  |-&gt;  TRUE</code>” and
“<code>TRUE + FALSE  |-&gt;  TRUE</code>”.
Note the use of <code><a href="#uniqTsparse">uniqTsparse</a>()</code> for getting an internally
unique representation without duplicated <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></code> entries.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("lgCMatrix",
    ...)</code> and so on.  More frequently objects are created by coercion of
a numeric sparse matrix to the logical form, e.g. in an expression
<code>x != 0</code>.
</p>
<p>The logical form is also used in the symbolic analysis phase
of an algorithm involving sparse matrices.  Such algorithms often
involve two phases: a symbolic phase wherein the positions of the
non-zeros in the result are determined and a numeric phase wherein the
actual results are calculated.  During the symbolic phase only the
positions of the non-zero elements in any operands are of interest,
hence any numeric sparse matrices can be treated as logical sparse
matrices.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code>, i.e., either
<code>TRUE</code>, <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>, or <code>FALSE</code>.</p>
</dd>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower
triangular. Present in the triangular and symmetric classes but not
in the general class.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either <code>"U"</code>, for unit triangular (diagonal is all ones), or
<code>"N"</code> for non-unit.  The implicit diagonal elements are not
explicitly stored when <code>diag</code> is <code>"U"</code>.  Present in the
triangular classes only.</p>
</dd>
<dt>
<code>p</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of pointers, one
for each column (row), to the initial (zero-based) index of elements in
the column.  Present in compressed column-oriented and compressed
row-oriented forms only.</p>
</dd>
<dt>
<code>i</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length nnzero
(number of non-zero elements).  These are the row numbers for
each TRUE element in the matrix.  All other elements are FALSE.
Present in triplet and compressed column-oriented forms only.</p>
</dd>
<dt>
<code>j</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length nnzero
(number of non-zero elements).  These are the column numbers for
each TRUE element in the matrix.  All other elements are FALSE.
Present in triplet and compressed row-oriented forms only.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the dimensions
of the matrix.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "dgCMatrix", to = "lgCMatrix")</code></p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "lgCMatrix")</code>: returns the transpose
of <code>x</code></p>
</dd>
<dt>which</dt>
<dd>
<p><code>signature(x = "lsparseMatrix")</code>, semantically
equivalent to <span class="pkg">base</span> function <code><a href="https://r-universe.dev/manuals/base.html#which">which</a>(x, arr.ind)</code>;
for details, see the <code><a href="#dMatrix-class">lMatrix</a></code> class documentation.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>the class <code><a href="#dgCMatrix-class">dgCMatrix</a></code> and <code><a href="#dgTMatrix-class">dgTMatrix</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>m <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span> dimnames<span class="token operator">=</span>list<span class="token punctuation">(</span>LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>lm <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># lgC</span>
<span class="token operator">!</span>lm     <span class="token comment"># no longer sparse</span>
stopifnot<span class="token punctuation">(</span>is<span class="token punctuation">(</span>lm<span class="token punctuation">,</span><span class="token string">"lsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span><span class="token operator">!</span>lm<span class="token punctuation">,</span> m <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

data<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>mmG.<span class="token number">1</span> <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>KNex <span class="token operator">$</span> mm<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token comment"># "lgC..."</span>
table<span class="token punctuation">(</span>mmG.<span class="token number">1</span><span class="token operator">@</span>x<span class="token punctuation">)</span><span class="token comment"># however with many ``non-structural zeros''</span>
<span class="token comment">## from logical to nz_pattern -- okay when there are no NA's :</span>
nmG.<span class="token number">1</span> <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>mmG.<span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span> <span class="token comment"># &lt;&lt;&lt; has "TRUE" also where mmG.1 had FALSE</span>
<span class="token comment">## from logical to "double"</span>
dmG.<span class="token number">1</span> <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>mmG.<span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"dMatrix"</span><span class="token punctuation">)</span> <span class="token comment"># has '0' and back:</span>
lmG.<span class="token number">1</span> <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>dmG.<span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"lMatrix"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>nmG.<span class="token number">1</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span><span class="token punctuation">(</span>KNex <span class="token operator">$</span> mm<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"nMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          validObject<span class="token punctuation">(</span>lmG.<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>lmG.<span class="token number">1</span><span class="token punctuation">,</span> mmG.<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

class<span class="token punctuation">(</span>xnx <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>nmG.<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># "nsC.."</span>
class<span class="token punctuation">(</span>xlx <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>mmG.<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># "dsC.." : numeric</span>
is0 <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>xlx <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
mean<span class="token punctuation">(</span>as.vector<span class="token punctuation">(</span>is0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 99.3% zeros: quite sparse, but</span>
table<span class="token punctuation">(</span>xlx<span class="token operator">@</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment"># more than half of the entries are (non-structural!) 0</span>
stopifnot<span class="token punctuation">(</span>isSymmetric<span class="token punctuation">(</span>xlx<span class="token punctuation">)</span><span class="token punctuation">,</span> isSymmetric<span class="token punctuation">(</span>xnx<span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token comment">## compare xnx and xlx : have the *same* non-structural 0s :</span>
          sapply<span class="token punctuation">(</span>slotNames<span class="token punctuation">(</span>xnx<span class="token punctuation">)</span><span class="token punctuation">,</span>
                 <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> identical<span class="token punctuation">(</span>slot<span class="token punctuation">(</span>xnx<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> slot<span class="token punctuation">(</span>xlx<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lsyMatrix-class">

<a href="#lsyMatrix-class" class="help-page-title"><h2 id="lsyMatrix-class">Symmetric Dense Logical Matrices</h2></a>

<h3>Description</h3>

<p>The <code>"lsyMatrix"</code> class is the class of symmetric, dense logical
matrices in non-packed storage and <code>"lspMatrix"</code> is the class of
of these in packed storage. In the packed form, only the upper
triangle or the lower triangle is stored.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("lsyMatrix", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code>. The logical
values that constitute the matrix, stored in column-major order.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>), see the
<code><a href="#Matrix-class">Matrix</a></code> class.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code>.  A named
list of factorizations that have been computed for the matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Both extend classes <code>"<a href="#ldenseMatrix-class">ldenseMatrix</a>"</code> and
<code>"<a href="#symmetricMatrix-class">symmetricMatrix</a>"</code>, directly; further, class
<code>"Matrix"</code> and others, <em>in</em>directly.  Use
<code><a href="https://r-universe.dev/manuals/methods.html#RClassUtils">showClass</a>("lsyMatrix")</code>, e.g., for details.
</p>


<h3>Methods</h3>

<p>Currently, mainly <code><a href="https://r-universe.dev/manuals/base.html#t">t</a>()</code> and coercion methods (for
<code><a href="https://r-universe.dev/manuals/methods.html#as">as</a>(.)</code>; use, e.g.,
<code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(class="lsyMatrix")</code> for details.
</p>


<h3>See Also</h3>

<p><code><a href="#lgeMatrix-class">lgeMatrix</a></code>, <code><a href="#Matrix-class">Matrix</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#t">t</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>M2 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># logical dense (ltr)</span>
str<span class="token punctuation">(</span>M2<span class="token punctuation">)</span>
<span class="token comment"># can</span>
<span class="token punctuation">(</span>sM <span class="token operator">&lt;-</span> M2 <span class="token operator">|</span> t<span class="token punctuation">(</span>M2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># "lge"</span>
as<span class="token punctuation">(</span>sM<span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>sM <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sM<span class="token punctuation">,</span> <span class="token string">"packedMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># packed symmetric</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ltrMatrix-class">

<a href="#ltrMatrix-class" class="help-page-title"><h2 id="ltrMatrix-class">Triangular Dense Logical Matrices</h2></a>

<h3>Description</h3>

<p>The <code>"ltrMatrix"</code> class is the class of triangular, dense,
logical matrices in nonpacked storage.  The <code>"ltpMatrix"</code> class
is the same except in packed storage.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code>. The logical
values that constitute the matrix, stored in column-major order.</p>
</dd>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either <code>"U"</code>, for unit triangular (diagonal is all ones), or
<code>"N"</code>; see <code><a href="#triangularMatrix-class">triangularMatrix</a></code>.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>), see the
<code><a href="#Matrix-class">Matrix</a></code> class.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code>.  A named
list of factorizations that have been computed for the matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Both extend classes <code>"<a href="#ldenseMatrix-class">ldenseMatrix</a>"</code> and
<code>"<a href="#triangularMatrix-class">triangularMatrix</a>"</code>, directly; further, class
<code>"Matrix"</code>, <code>"<a href="#dMatrix-class">lMatrix</a>"</code> and others,
<em>in</em>directly.  Use <code><a href="https://r-universe.dev/manuals/methods.html#RClassUtils">showClass</a>("ltrMatrix")</code>, e.g.,
for details.
</p>


<h3>Methods</h3>

<p>Currently, mainly <code><a href="https://r-universe.dev/manuals/base.html#t">t</a>()</code> and coercion methods (for
<code><a href="https://r-universe.dev/manuals/methods.html#as">as</a>(.)</code>; use, e.g.,
<code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(class="ltrMatrix")</code> for details.
</p>


<h3>See Also</h3>

<p>Classes <code><a href="#lgeMatrix-class">lgeMatrix</a></code>, <code><a href="#Matrix-class">Matrix</a></code>;
function <code><a href="https://r-universe.dev/manuals/base.html#t">t</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"ltrMatrix"</span><span class="token punctuation">)</span>

str<span class="token punctuation">(</span>new<span class="token punctuation">(</span><span class="token string">"ltpMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>lutr <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>upper.tri<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"ldenseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>lutp <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>lutr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># packed matrix: only 10 = 4*(4+1)/2 entries</span>
<span class="token operator">!</span>lutp <span class="token comment"># the logical negation (is *not* logical triangular !)</span>
<span class="token comment">## but this one is:</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>lutp<span class="token punctuation">,</span> pack<span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span>lutp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lu">

<a href="#lu" class="help-page-title"><h2 id="lu-methods">Methods for LU Factorization</h2></a>

<h3>Description</h3>

<p>Computes the pivoted LU factorization of an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
real matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, which has the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><mi>L</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">P_{1} A P_{2} = L U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">LU</span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><mi>U</mi><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">A = P_{1}' L U P_{2}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">LU</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> permutation matrix, 
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> permutation matrix, 
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mtext>min</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m \times \text{min}(m,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">min</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></code>
unit lower trapezoidal matrix, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code> is a  <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>min</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\text{min}(m,n) \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">min</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
upper trapezoidal matrix.
</p>
<p>Methods for <code><a href="#denseMatrix-class">denseMatrix</a></code> are built on
LAPACK routine <code>dgetrf</code>, which does not permute columns,
so that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is an identity matrix.
</p>
<p>Methods for <code><a href="#sparseMatrix-class">sparseMatrix</a></code> are built on
CSparse routine <code>cs_lu</code>, which requires <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m = n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>,
so that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code> are triangular matrices.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">lu<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dgeMatrix'</span>
lu<span class="token punctuation">(</span>x<span class="token punctuation">,</span> warnSing <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dgCMatrix'</span>
lu<span class="token punctuation">(</span>x<span class="token punctuation">,</span> errSing <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> order <span class="token operator">=</span> <span class="token keyword">NA_integer_</span><span class="token punctuation">,</span>
  tol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsyMatrix'</span>
lu<span class="token punctuation">(</span>x<span class="token punctuation">,</span> cache <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dsCMatrix'</span>
lu<span class="token punctuation">(</span>x<span class="token punctuation">,</span> cache <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'matrix'</span>
lu<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="lu-methods_:_x">x</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a> matrix or
<code><a href="#Matrix-class">Matrix</a></code> to be factorized,
which must be square if sparse.</p>
</td>
</tr>
<tr>
<td><code id="lu-methods_:_warnSing">warnSing</code></td>
<td>
<p>a logical indicating if a <a href="https://r-universe.dev/manuals/base.html#warning">warning</a> should
be signaled for singular <code>x</code>.  Used only by methods for
dense matrices.</p>
</td>
</tr>
<tr>
<td><code id="lu-methods_:_errSing">errSing</code></td>
<td>
<p>a logical indicating if an <a href="https://r-universe.dev/manuals/base.html#stop">error</a> should
be signaled for singular <code>x</code>.  Used only by methods for
sparse matrices.</p>
</td>
</tr>
<tr>
<td><code id="lu-methods_:_order">order</code></td>
<td>
<p>an integer in <code>0:3</code> passed to CSparse routine
<code>cs_sqr</code>, indicating a strategy for choosing the column
permutation <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.  0 means no column permutation.
1, 2, and 3 indicate a fill-reducing ordering of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>+</mo><msup><mi>A</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A + A'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>A</mi><mo>~</mo></mover><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mover accent="true"><mi>A</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{A}' \tilde{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span></code>, and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>A</mi></mrow><annotation encoding="application/x-tex">A' A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span></span></span></span></code>,
where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span></code> is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> with “dense” rows
removed.
<code>NA</code> (the default) is equivalent to 2 if <code>tol == 1</code>
and 1 otherwise.
Do not set to 0 unless you know that the column order of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>
is already sensible.</p>
</td>
</tr>
<tr>
<td><code id="lu-methods_:_tol">tol</code></td>
<td>
<p>a number.  The original pivot element is used
if its absolute value exceeds <code>tol * a</code>,
where <code>a</code> is the maximum in absolute value of the
other possible pivot elements.
Set <code>tol &lt; 1</code> only if you know what you are doing.</p>
</td>
</tr>
<tr>
<td><code id="lu-methods_:_cache">cache</code></td>
<td>
<p>a logical indicating if the result should be
cached in <code>x@factors[["LU"]]</code>.  Note that
caching is experimental and that only methods for classes
extending <code><a href="#compMatrix-class">compMatrix</a></code> will have this
argument.</p>
</td>
</tr>
<tr>
<td><code id="lu-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>What happens when <code>x</code> is determined to be near-singular
differs by method.  The method for class <code><a href="#dgeMatrix-class">dgeMatrix</a></code>
completes the factorization, warning if <code>warnSing = TRUE</code>
and in any case returning a valid <code><a href="#LU-class">denseLU</a></code>
object.  Users of this method can detect singular <code>x</code> with
a suitable warning handler; see <code><a href="https://r-universe.dev/manuals/base.html#conditions">tryCatch</a></code>.
In contrast, the method for class <code><a href="#dgCMatrix-class">dgCMatrix</a></code>
abandons further computation, throwing an error if <code>errSing = TRUE</code>
and otherwise returning <code>NA</code>.  Users of this method can
detect singular <code>x</code> with an error handler or by setting
<code>errSing = FALSE</code> and testing for a formal result with
<code>is(., "sparseLU")</code>.
</p>


<h3>Value</h3>

<p>An object representing the factorization, inheriting from
virtual class <code><a href="#MatrixFactorization-class">LU</a></code>.  The specific class
is <code><a href="#LU-class">denseLU</a></code> unless <code>x</code> inherits
from virtual class <code><a href="#sparseMatrix-class">sparseMatrix</a></code>,
in which case it is <code><a href="#sparseLU-class">sparseLU</a></code>.
</p>


<h3>References</h3>

<p>The LAPACK source code, including documentation; see
<a href="https://netlib.org/lapack/double/dgetrf.f" target="_blank">https://netlib.org/lapack/double/dgetrf.f</a>.
</p>
<p>Davis, T. A. (2006).
<em>Direct methods for sparse linear systems</em>.
Society for Industrial and Applied Mathematics.
<a href="https://doi.org/10.1137/1.9780898718881" target="_blank">doi:10.1137/1.9780898718881</a>
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Classes <code><a href="#LU-class">denseLU</a></code> and
<code><a href="#sparseLU-class">sparseLU</a></code> and their methods.
</p>
<p>Classes <code><a href="#dgeMatrix-class">dgeMatrix</a></code> and
<code><a href="#dgCMatrix-class">dgCMatrix</a></code>.
</p>
<p>Generic functions <code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>,
for constructing matrix factors from the result.
</p>
<p>Generic functions <code><a href="#Cholesky">Cholesky</a></code>, <code><a href="#BunchKaufman-methods">BunchKaufman</a></code>,
<code><a href="#Schur">Schur</a></code>, and <code><a href="#qr-methods">qr</a></code>,
for computing other factorizations.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span><span class="token string">"lu"</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">## ---- Dense ----------------------------------------------------------</span>

<span class="token punctuation">(</span>A1 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">9L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>lu.A1 <span class="token operator">&lt;-</span> lu<span class="token punctuation">(</span>A1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>A2 <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">*</span> A1<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3L</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>lu.A2 <span class="token operator">&lt;-</span> lu<span class="token punctuation">(</span>A2<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ P1' L U in floating point</span>
str<span class="token punctuation">(</span>e.lu.A2 <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>lu.A2<span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>A2<span class="token punctuation">,</span> Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> e.lu.A2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## ---- Sparse ---------------------------------------------------------</span>

A3 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>readMM<span class="token punctuation">(</span>system.file<span class="token punctuation">(</span><span class="token string">"external/pores_1.mtx"</span><span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>lu.A3 <span class="token operator">&lt;-</span> lu<span class="token punctuation">(</span>A3<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ P1' L U P2' in floating point</span>
str<span class="token punctuation">(</span>e.lu.A3 <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>lu.A3<span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>A3<span class="token punctuation">,</span> Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> e.lu.A3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="mat2triplet">

<a href="#mat2triplet" class="help-page-title"><h2 id="mat2triplet">Map Matrix to its Triplet Representation</h2></a>

<h3>Description</h3>

<p>From an <span class="rlang"><b>R</b></span> object coercible to <code>"<a href="#TsparseMatrix-class">TsparseMatrix</a>"</code>,
typically a (sparse) matrix, produce its triplet representation which may
collapse to a “Duplet” in the case of binary aka pattern, such as
<code>"<a href="#nMatrix-class">nMatrix</a>"</code> objects.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">mat2triplet<span class="token punctuation">(</span>x<span class="token punctuation">,</span> uniqT <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="mat2triplet_:_x">x</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object for which <code>as(x, "<a href="#TsparseMatrix-class">TsparseMatrix</a>")</code>
works; typically a <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code> of one of the <span class="pkg">Matrix</span>
package matrices.</p>
</td>
</tr>
<tr>
<td><code id="mat2triplet_:_uniqT">uniqT</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if the triplet
representation should be ‘unique’ in the sense of
<code><a href="#uniqTsparse">uniqTsparse</a>()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code>, typically with three components,
</p>
<table>
<tr>
<td><code>i</code></td>
<td>
<p>vector of   row   indices for all non-zero entries of <code>x</code></p>
</td>
</tr>
<tr>
<td><code>i</code></td>
<td>
<p>vector of columns indices for all non-zero entries of <code>x</code></p>
</td>
</tr>
<tr>
<td><code>x</code></td>
<td>
<p>vector of all non-zero entries of <code>x</code>; exists <b>only</b>
when <code>as(x, "TsparseMatrix")</code> is <b>not</b> a
<code>"<a href="#nsparseMatrix-classes">nsparseMatrix</a>"</code>.</p>
</td>
</tr>
</table>
<p>Note that the <code><a href="https://r-universe.dev/manuals/base.html#order">order</a></code> of the entries is determined by the
coercion to <code>"<a href="#TsparseMatrix-class">TsparseMatrix</a>"</code> and hence typically
with increasing <code>j</code> (and increasing <code>i</code> within ties of <code>j</code>).
</p>


<h3>Note</h3>

<p>The <code>mat2triplet()</code> utility was created to be a more efficient and
more predictable substitute for <code><a href="https://r-universe.dev/manuals/base.html#summary">summary</a>(&lt;sparseMatrix&gt;)</code>.
UseRs have wrongly expected the latter to return a data frame with
columns <code>i</code> and <code>j</code> which however is wrong for a
<code>"<a href="#diagonalMatrix-class">diagonalMatrix</a>"</code>.
</p>


<h3>See Also</h3>

<p>The <code>summary()</code> method for <code>"sparseMatrix"</code>,
<code><a href="#sparseMatrix-class">summary,sparseMatrix-method</a></code>.
</p>
<p><code>mat2triplet()</code> is conceptually the <em>inverse</em> function of
<code><a href="#spMatrix">spMatrix</a></code> and (one case of) <code><a href="#sparseMatrix">sparseMatrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">mat2triplet <span class="token comment"># simple definition</span>

i <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> x <span class="token operator">&lt;-</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>Ax <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> x <span class="token operator">=</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">##  8 x 10 "dgCMatrix"</span>
str<span class="token punctuation">(</span>trA <span class="token operator">&lt;-</span> mat2triplet<span class="token punctuation">(</span>Ax<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>i <span class="token operator">==</span> sort<span class="token punctuation">(</span>trA<span class="token operator">$</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>  sort<span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> trA<span class="token operator">$</span>j<span class="token punctuation">,</span>  x <span class="token operator">==</span> sort<span class="token punctuation">(</span>trA<span class="token operator">$</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

D <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>D<span class="token punctuation">)</span>
str<span class="token punctuation">(</span>mat2triplet<span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="matrix-products">

<a href="#matrix-products" class="help-page-title"><h2 id="matmult-methods">Matrix (Cross) Products (of Transpose)</h2></a>

<h3>Description</h3>

<p>The basic matrix product, <code>%*%</code> is implemented for all our
<code><a href="#Matrix-class">Matrix</a></code> and also for
<code><a href="#sparseVector-class">sparseVector</a></code> classes, fully analogously to <span class="rlang"><b>R</b></span>'s
base <code>matrix</code> and vector objects.
</p>
<p>The functions <code><a href="#matrix-products">crossprod</a></code> and <code><a href="#matrix-products">tcrossprod</a></code> are
matrix products or “cross products”, ideally implemented
efficiently without computing <code><a href="https://r-universe.dev/manuals/base.html#t">t</a>(.)</code>'s unnecessarily.
They also return <code><a href="#symmetricMatrix-class">symmetricMatrix</a></code> classed
matrices when easily detectable, e.g., in <code>crossprod(m)</code>, the one
argument case.
</p>
<p><code>tcrossprod()</code> takes the cross-product of the transpose of a matrix.
<code>tcrossprod(x)</code> is formally equivalent to, but faster than, the
call <code>x %*% t(x)</code>, and so is <code>tcrossprod(x, y)</code> instead of
<code>x %*% t(y)</code>.
</p>
<p><em>Boolean</em> matrix products are computed via either
<code><a href="#boolean-matprod">%&amp;%</a></code> or <code>boolArith = TRUE</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S4 method for signature 'CsparseMatrix,diagonalMatrix'</span>
x <span class="token percent-operator operator">%*%</span> y

<span class="token comment">## S4 method for signature 'dgeMatrix,missing'</span>
crossprod<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> boolArith <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'CsparseMatrix,diagonalMatrix'</span>
crossprod<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> boolArith <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
       <span class="token comment">## .... and for many more signatures</span>

<span class="token comment">## S4 method for signature 'CsparseMatrix,ddenseMatrix'</span>
tcrossprod<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> boolArith <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'TsparseMatrix,missing'</span>
tcrossprod<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> boolArith <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
       <span class="token comment">## .... and for many more signatures</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="matmult-methods_:_x">x</code></td>
<td>
<p>a matrix-like object</p>
</td>
</tr>
<tr>
<td><code id="matmult-methods_:_y">y</code></td>
<td>
<p>a matrix-like object, or for <code>[t]crossprod()</code>
<code>NULL</code> (by default); the latter case is formally equivalent to
<code>y = x</code>.</p>
</td>
</tr>
<tr>
<td><code id="matmult-methods_:_boolArith">boolArith</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code>, i.e., <code>NA</code>, <code>TRUE</code>,
or <code>FALSE</code>.  If true the result is (coerced to) a pattern
matrix, i.e., <code>"<a href="#nMatrix-class">nMatrix</a>"</code>, unless there are
<code>NA</code> entries and the result will be a
<code>"<a href="#dMatrix-class">lMatrix</a>"</code>.  If false the result is (coerced to)
numeric.  When <code>NA</code>, currently the default, the
result is a pattern matrix when <code>x</code> and <code>y</code> are
<code>"<a href="#nsparseMatrix-classes">nsparseMatrix</a>"</code> and numeric otherwise.</p>
</td>
</tr>
<tr>
<td><code id="matmult-methods_:_...">...</code></td>
<td>
<p>potentially more arguments passed to and from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For some classes in the <code>Matrix</code> package, such as
<code><a href="#dgCMatrix-class">dgCMatrix</a></code>, it is much faster to calculate the
cross-product of the transpose directly instead of calculating the
transpose first and then its cross-product.
</p>
<p><code>boolArith = TRUE</code> for regular (“non cross”) matrix
products, <code>%*%</code> cannot be specified.  Instead, we provide the
<code><a href="#boolean-matprod">%&amp;%</a></code> operator for <em>boolean</em> matrix products.
</p>


<h3>Value</h3>

<p>A <code><a href="#Matrix-class">Matrix</a></code> object, in the one argument case
of an appropriate <em>symmetric</em> matrix class, i.e., inheriting from
<code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>.
</p>


<h3>Methods</h3>


<dl>
<dt>%*%</dt>
<dd>
<p><code>signature(x = "dgeMatrix", y = "dgeMatrix")</code>:
Matrix multiplication; ditto for several other signature
combinations, see <code>showMethods("%*%", class = "dgeMatrix")</code>.</p>
</dd>
<dt>%*%</dt>
<dd>
<p><code>signature(x = "dtrMatrix", y = "matrix")</code> and other
signatures (use <code>showMethods("%*%", class="dtrMatrix")</code>):
matrix multiplication.  Multiplication of (matching) triangular
matrices now should remain triangular (in the sense of class
<a href="#triangularMatrix-class">triangularMatrix</a>).</p>
</dd>
<dt>crossprod</dt>
<dd>
<p><code>signature(x = "dgeMatrix", y = "dgeMatrix")</code>:
ditto for several other signatures, use
<code>showMethods("crossprod", class = "dgeMatrix")</code>, matrix
crossproduct, an efficient version of <code>t(x) %*% y</code>.</p>
</dd>
<dt>crossprod</dt>
<dd>
<p><code>signature(x = "CsparseMatrix", y = "missing")</code>
returns <code>t(x) %*% x</code> as an <code>dsCMatrix</code> object.</p>
</dd>
<dt>crossprod</dt>
<dd>
<p><code>signature(x = "TsparseMatrix", y = "missing")</code>
returns <code>t(x) %*% x</code> as an <code>dsCMatrix</code> object.</p>
</dd>
<dt>crossprod,tcrossprod</dt>
<dd>
<p><code>signature(x = "dtrMatrix", y =
      "matrix")</code> and other signatures, see <code>"%*%"</code> above.</p>
</dd>
</dl>
<h3>Note</h3>

<p><code>boolArith = TRUE</code>, <code>FALSE</code> or <code>NA</code> has been newly
introduced for <span class="pkg">Matrix</span> 1.2.0 (March 2015).  Its implementation
has still not been tested extensively.  Notably the behaviour for
sparse matrices with <code>x</code> slots containing extra zeros had not been
documented previously, see the <code><a href="#boolean-matprod">%&amp;%</a></code> help page.
</p>
<p>Currently, <code>boolArith = TRUE</code> is implemented via
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> coercions which may be quite
inefficient for dense matrices.  Contributions for efficiency
improvements are welcome.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#tcrossprod">tcrossprod</a></code> in <span class="rlang"><b>R</b></span>'s base, and
<code><a href="#matrix-products">crossprod</a></code> and <code><a href="#matrix-products">%*%</a></code>.
<span class="pkg">Matrix</span> package <code><a href="#boolean-matprod">%&amp;%</a></code> for boolean matrix product
methods.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## A random sparse "incidence" matrix :</span>
 m <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
 set.seed<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
 m<span class="token punctuation">[</span>runif<span class="token punctuation">(</span><span class="token number">314</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> length<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
 mm <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span>
 object.size<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">/</span> object.size<span class="token punctuation">(</span>mm<span class="token punctuation">)</span> <span class="token comment"># smaller by a factor of &gt; 200</span>

 <span class="token comment">## tcrossprod() is very fast:</span>
 system.time<span class="token punctuation">(</span>tCmm <span class="token operator">&lt;-</span> tcrossprod<span class="token punctuation">(</span>mm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 0   (PIII, 933 MHz)</span>
 system.time<span class="token punctuation">(</span>cm <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>t<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 0.16</span>
 system.time<span class="token punctuation">(</span>cm. <span class="token operator">&lt;-</span> tcrossprod<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 0.02</span>

 stopifnot<span class="token punctuation">(</span>cm <span class="token operator">==</span> as<span class="token punctuation">(</span>tCmm<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

 <span class="token comment">## show sparse sub matrix</span>
 tCmm<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">30</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Matrix">

<a href="#Matrix" class="help-page-title"><h2 id="Matrix">Construct a Classed Matrix</h2></a>

<h3>Description</h3>

<p>Construct a Matrix of a class that inherits from <code>Matrix</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Matrix<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token keyword">NA</span><span class="token punctuation">,</span> nrow<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ncol<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> byrow<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> dimnames<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span>
       sparse <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> doDiag <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> forceCheck <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="Matrix_:_data">data</code></td>
<td>
<p>an optional numeric data vector or matrix.</p>
</td>
</tr>
<tr>
<td><code id="Matrix_:_nrow">nrow</code></td>
<td>
<p>when <code>data</code> is not a matrix, the desired number of rows</p>
</td>
</tr>
<tr>
<td><code id="Matrix_:_ncol">ncol</code></td>
<td>
<p>when <code>data</code> is not a matrix, the desired number of columns</p>
</td>
</tr>
<tr>
<td><code id="Matrix_:_byrow">byrow</code></td>
<td>
<p>logical.  If <code>FALSE</code> (the default) the matrix is
filled by columns, otherwise the matrix is filled by rows.</p>
</td>
</tr>
<tr>
<td><code id="Matrix_:_dimnames">dimnames</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code> attribute for the matrix: a
<code>list</code> of two character components.  They are set if not
<code><a href="https://r-universe.dev/manuals/base.html#NULL">NULL</a></code> (as per default).</p>
</td>
</tr>
<tr>
<td><code id="Matrix_:_sparse">sparse</code></td>
<td>
<p>logical or <code>NULL</code>, specifying if the result should
be sparse or not.  By default, it is made sparse when more than half
of the entries are 0.</p>
</td>
</tr>
<tr>
<td><code id="Matrix_:_doDiag">doDiag</code></td>
<td>
<p>logical indicating if a <code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>
object should be returned when the resulting matrix is diagonal
(<em>mathematically</em>).  As class <code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>
<code><a href="https://r-universe.dev/manuals/methods.html#is">extends</a></code> <code><a href="#sparseMatrix-class">sparseMatrix</a></code>, this is a
natural default for all values of <code>sparse</code>.
</p>
<p>Otherwise, if <code>doDiag</code> is false, a dense or sparse (depending on
<code>sparse</code>) <em>symmetric</em> matrix will be returned.</p>
</td>
</tr>
<tr>
<td><code id="Matrix_:_forceCheck">forceCheck</code></td>
<td>
<p>logical indicating if the checks for structure
should even happen when <code>data</code> is already a <code>"Matrix"</code>
object.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If either of <code>nrow</code> or <code>ncol</code> is not given, an attempt is
made to infer it from the length of <code>data</code> and the other
parameter.
Further, <code>Matrix()</code> makes efforts to keep <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code>
matrices logical, i.e., inheriting from class <code><a href="#dMatrix-class">lMatrix</a></code>,
and to determine specially structured matrices such as symmetric,
triangular or diagonal ones.  Note that a <em>symmetric</em> matrix also
needs symmetric <code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>, e.g., by specifying
<code>dimnames = list(NULL,NULL)</code>, see the examples.
</p>
<p>Most of the time, the function works via a traditional (<em>full</em>)
<code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>.  However, <code>Matrix(0, nrow,ncol)</code> directly
constructs an “empty” <a href="#sparseMatrix-class">sparseMatrix</a>, as does
<code>Matrix(FALSE, *)</code>.
</p>
<p>Although it is sometime possible to mix unclassed matrices (created
with <code>matrix</code>) with ones of class <code>"Matrix"</code>, it is much
safer to always use carefully constructed ones of class
<code>"Matrix"</code>.
</p>


<h3>Value</h3>

<p>Returns matrix of a class that inherits from <code>"Matrix"</code>.
Only if <code>data</code> is not a <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code> and does not already inherit
from class <code><a href="#Matrix-class">Matrix</a></code> are the arguments
<code>nrow</code>, <code>ncol</code> and <code>byrow</code> made use of.
</p>


<h3>See Also</h3>

<p>The classes <code><a href="#Matrix-class">Matrix</a></code>,
<code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>,
<code><a href="#triangularMatrix-class">triangularMatrix</a></code>, and
<code><a href="#diagonalMatrix-class">diagonalMatrix</a></code>; further,
<code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>.
</p>
<p>Special matrices can be constructed, e.g., via
<code><a href="#sparseMatrix">sparseMatrix</a></code> (sparse), <code><a href="#bdiag">bdiag</a></code>
(block-diagonal), <code><a href="#bandSparse">bandSparse</a></code> (banded sparse), or
<code><a href="#Diagonal">Diagonal</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>             <span class="token comment"># 3 by 2 matrix of zeros -&gt; sparse</span>
Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token comment"># -&gt; 'dense'</span>

<span class="token comment">## 4 cases - 3 different results :</span>
Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>              <span class="token comment"># diagonal !</span>
Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token comment"># (ditto)</span>
Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>               doDiag<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token comment"># -&gt; sparse symm. "dsCMatrix"</span>
Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> doDiag<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token comment"># -&gt; dense  symm. "dsyMatrix"</span>

Matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>           <span class="token comment"># a 3 by 2 matrix (+ integer warning)</span>
Matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> nrow<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment">## logical ones:</span>
Matrix<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span>  <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; "ldiMatrix" with diag = "U"</span>
Matrix<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span>  <span class="token number">0</span><span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment">#  (ditto)</span>
Matrix<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; "lsyMatrix" (of all 'TRUE')</span>
<span class="token comment">## triangular</span>
l3 <span class="token operator">&lt;-</span> upper.tri<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>l3<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># -&gt; "ltCMatrix"</span>
Matrix<span class="token punctuation">(</span><span class="token operator">!</span> l3<span class="token punctuation">)</span>        <span class="token comment"># -&gt; "ltrMatrix"</span>
as<span class="token punctuation">(</span>l3<span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token comment"># "lgCMatrix"</span>

Matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> nrow<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
       dimnames <span class="token operator">=</span> list<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>I3 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># identity, i.e., unit "diagonalMatrix"</span>
str<span class="token punctuation">(</span>I3<span class="token punctuation">)</span> <span class="token comment"># note  'diag = "U"' and the empty 'x' slot</span>

<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>a<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># symmetric *apart* from dimnames</span>
Matrix<span class="token punctuation">(</span>A<span class="token punctuation">)</span>                    <span class="token comment"># hence 'dgeMatrix'</span>
<span class="token punctuation">(</span>As <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>A<span class="token punctuation">,</span> dimnames <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># -&gt; symmetric</span>
forceSymmetric<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token comment"># also symmetric, w/ symm. dimnames</span>
stopifnot<span class="token punctuation">(</span>is<span class="token punctuation">(</span>As<span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          is<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          is<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Matrix-class">

<a href="#Matrix-class" class="help-page-title"><h2 id="Matrix-class">Virtual Class "Matrix" of Matrices</h2></a>

<h3>Description</h3>

<p>The <code>Matrix</code> class is a class contained by all actual
classes in the <span class="pkg">Matrix</span> package.  It is a “virtual” class.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Dim</code></dt>
<dd>
<p>an integer vector of length 2 giving the
dimensions of the matrix.</p>
</dd>
<dt><code>Dimnames</code></dt>
<dd>
<p>a list of length 2.  Each element must
be <code>NULL</code> or a character vector of length equal to the
corresponding element of <code>Dim</code>.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>determinant</dt>
<dd>
<p><code>signature(x = "Matrix", logarithm = "missing")</code>: and</p>
</dd>
<dt>determinant</dt>
<dd>
<p><code>signature(x = "Matrix", logarithm = "logical")</code>:
compute the (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\log</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span></span></span></span></code>) determinant of <code>x</code>.  The method
chosen depends on the actual Matrix class of <code>x</code>.  Note that
<code><a href="https://r-universe.dev/manuals/base.html#det">det</a></code> also works for all our matrices, calling the
appropriate <code>determinant()</code> method.  The <code>Matrix::det</code>
is an exact copy of <code>base::det</code>, but in the correct
namespace, and hence calling the S4-aware version of
<code>determinant()</code>.).</p>
</dd>
<dt>diff</dt>
<dd>
<p><code>signature(x = "Matrix")</code>: As <code><a href="https://r-universe.dev/manuals/base.html#diff">diff</a>()</code>
for traditional matrices, i.e., applying <code>diff()</code> to each
column.</p>
</dd>
<dt>dim</dt>
<dd>
<p><code>signature(x = "Matrix")</code>: extract matrix dimensions
<code><a href="https://r-universe.dev/manuals/base.html#dim">dim</a></code>.</p>
</dd>
<dt>dim&lt;-</dt>
<dd>
<p><code>signature(x = "Matrix", value = "ANY")</code>: where
<code>value</code> is integer of length 2.  Allows to <em>reshape</em>
Matrix objects, but only when <code>prod(value) == prod(dim(x))</code>.</p>
</dd>
<dt>dimnames</dt>
<dd>
<p><code>signature(x = "Matrix")</code>: extract
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>.</p>
</dd>
<dt>dimnames&lt;-</dt>
<dd>
<p><code>signature(x = "Matrix", value = "list")</code>: set
the <code>dimnames</code> to a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> of length 2, see
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames&lt;-</a></code>.</p>
</dd>
<dt>length</dt>
<dd>
<p><code>signature(x = "Matrix")</code>: simply defined as
<code>prod(dim(x))</code> (and hence of mode <code>"double"</code>).</p>
</dd>
<dt>show</dt>
<dd>
<p><code>signature(object = "Matrix")</code>: <code><a href="https://r-universe.dev/manuals/methods.html#show">show</a></code>
method for <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code>ing.  For printing <em>sparse</em>
matrices, see <code><a href="#printSpMatrix">printSpMatrix</a></code>.</p>
</dd>
<dt>image</dt>
<dd>
<p><code>signature(object = "Matrix")</code>: draws an
<code><a href="#image-methods">image</a></code> of the matrix entries, using
<code><a href="https://r-universe.dev/manuals/lattice.html#levelplot">levelplot</a>()</code> from package <span class="pkg">lattice</span>.</p>
</dd>
<dt>head</dt>
<dd>
<p><code>signature(object = "Matrix")</code>: return only the
<em>“head”</em>, i.e., the first few rows.</p>
</dd>
<dt>tail</dt>
<dd>
<p><code>signature(object = "Matrix")</code>: return only the
<em>“tail”</em>, i.e., the last few rows of the respective matrix.</p>
</dd>
</dl>
<p><br></p>
<dl>
<dt>as.matrix, as.array</dt>
<dd>
<p><code>signature(x = "Matrix")</code>: the same as
<code>as(x, "matrix")</code>; see also the note below.</p>
</dd>
<dt>as.vector</dt>
<dd>
<p><code>signature(x = "Matrix", mode = "missing")</code>:
<code>as.vector(m)</code> should be identical to <code>as.vector(as(m,
	"matrix"))</code>, implemented more efficiently for some subclasses.</p>
</dd>
<dt>as(x, "vector"), as(x, "numeric")</dt>
<dd>
<p>etc, similarly.</p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "ANY", to = "Matrix")</code>: This
relies on a correct <code><a href="https://r-universe.dev/manuals/base.html#matrix">as.matrix</a>()</code> method for <code>from</code>.</p>
</dd>
</dl>
<p>There are many more methods that (conceptually should) work for all
<code>"Matrix"</code> objects, e.g., <code><a href="#colSums">colSums</a></code>,
<code><a href="#colSums">rowMeans</a></code>.  Even <span class="pkg">base</span> functions may work
automagically (if they first call <code><a href="https://r-universe.dev/manuals/base.html#matrix">as.matrix</a>()</code> on their
principal argument), e.g., <code><a href="https://r-universe.dev/manuals/base.html#apply">apply</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#eigen">eigen</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#svd">svd</a></code> or <code><a href="https://r-universe.dev/manuals/base.html#kappa">kappa</a></code> all do work via coercion to a
“traditional” (dense) <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>.

</p>


<h3>Note</h3>

<p>Loading the <code>Matrix</code> namespace “overloads”
<code><a href="https://r-universe.dev/manuals/base.html#matrix">as.matrix</a></code> and <code><a href="https://r-universe.dev/manuals/base.html#array">as.array</a></code> in the <span class="pkg">base</span>
namespace by the equivalent of <code>function(x) as(x, "matrix")</code>.
Consequently, <code>as.matrix(m)</code> or <code>as.array(m)</code> will properly
work when <code>m</code> inherits from the <code>"Matrix"</code> class —
<em>also</em> for functions in package <span class="pkg">base</span> and other packages.
E.g., <code><a href="https://r-universe.dev/manuals/base.html#apply">apply</a></code> or <code><a href="https://r-universe.dev/manuals/base.html#outer">outer</a></code> can therefore be applied
to <code>"Matrix"</code> matrices.
</p>


<h3>Author(s)</h3>

<p>Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a> and Martin Maechler</p>


<h3>See Also</h3>

<p>the classes <code><a href="#dgeMatrix-class">dgeMatrix</a></code>,
<code><a href="#dgCMatrix-class">dgCMatrix</a></code>, and function
<code><a href="#Matrix">Matrix</a></code> for construction (and examples).
</p>
<p>Methods, e.g., for <code><a href="#kronecker-methods">kronecker</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">slotNames<span class="token punctuation">(</span><span class="token string">"Matrix"</span><span class="token punctuation">)</span>

cl <span class="token operator">&lt;-</span> getClass<span class="token punctuation">(</span><span class="token string">"Matrix"</span><span class="token punctuation">)</span>
names<span class="token punctuation">(</span>cl<span class="token operator">@</span>subclasses<span class="token punctuation">)</span> <span class="token comment"># more than 40 ..</span>

showClass<span class="token punctuation">(</span><span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token comment">#&gt; output with slots and all subclasses</span>

<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dim<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
diag<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
cm <span class="token operator">&lt;-</span> M<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token operator">*</span>Diagonal<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
diff<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token comment">## can reshape it even :</span>
dim<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>
M
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>M<span class="token punctuation">,</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          all.equal<span class="token punctuation">(</span>det<span class="token punctuation">(</span>cm<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    determinant<span class="token punctuation">(</span>as<span class="token punctuation">(</span>cm<span class="token punctuation">,</span><span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> log<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token operator">$</span>modulus<span class="token punctuation">,</span>
                    check.attributes<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="unused-classes">

<a href="#unused-classes" class="help-page-title"><h2 id="Matrix-notyet">Virtual Classes Not Yet Really Implemented and Used</h2></a>

<h3>Description</h3>

<p><code>iMatrix</code> is the virtual class of all integer
(S4) matrices.  It extends the <code><a href="#Matrix-class">Matrix</a></code> class directly.
</p>
<p><code>zMatrix</code> is the virtual class of all <code><a href="https://r-universe.dev/manuals/base.html#complex">complex</a></code>
(S4) matrices.  It extends the <code><a href="#Matrix-class">Matrix</a></code> class directly.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"iMatrix"</span><span class="token punctuation">)</span>
showClass<span class="token punctuation">(</span><span class="token string">"zMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="MatrixClass">

<a href="#MatrixClass" class="help-page-title"><h2 id="MatrixClass">The Matrix (Super-) Class of a Class</h2></a>

<h3>Description</h3>

<p>Return the (maybe super-)<code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> of class <code>cl</code> from
package <span class="pkg">Matrix</span>, returning <code><a href="https://r-universe.dev/manuals/base.html#character">character</a>(0)</code> if there is none.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">MatrixClass<span class="token punctuation">(</span>cl<span class="token punctuation">,</span> cld <span class="token operator">=</span> getClassDef<span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span>Matrix <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
            dropVirtual <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="MatrixClass_:_cl">cl</code></td>
<td>
<p>string, class name</p>
</td>
</tr>
<tr>
<td><code id="MatrixClass_:_cld">cld</code></td>
<td>
<p>its class definition</p>
</td>
</tr>
<tr>
<td><code id="MatrixClass_:_...Matrix">...Matrix</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if the result must be of
pattern <code>"[dlniz]..Matrix"</code> where the first letter "[dlniz]"
denotes the content kind.</p>
</td>
</tr>
<tr>
<td><code id="MatrixClass_:_dropVirtual">dropVirtual</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if virtual classes
are included or not.</p>
</td>
</tr>
<tr>
<td><code id="MatrixClass_:_...">...</code></td>
<td>
<p>further arguments are passed to
<code><a href="https://r-universe.dev/manuals/methods.html#selectSuperClasses">.selectSuperClasses</a>()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> string
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 24 Mar 2009</p>


<h3>See Also</h3>

<p><code><a href="#Matrix-class">Matrix</a></code>, the mother of all <span class="pkg">Matrix</span> classes.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">mkA <span class="token operator">&lt;-</span> setClass<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> contains<span class="token operator">=</span><span class="token string">"dgCMatrix"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> mkA<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>
     MatrixClass<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     <span class="token string">"dgCMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="MatrixFactorization-class">

<a href="#MatrixFactorization-class" class="help-page-title"><h2 id="MatrixFactorization-class">Virtual Class "MatrixFactorization" of Matrix Factorizations</h2></a>

<h3>Description</h3>

<p><code>MatrixFactorization</code> is the virtual class of
factorizations of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
having the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><msub><mi>A</mi><mn>1</mn></msub><mo>⋯</mo><msub><mi>A</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">P_{1} A P_{2} = A_{1} \cdots A_{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>A</mi><mn>1</mn></msub><mo>⋯</mo><msub><mi>A</mi><mi>p</mi></msub><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">A = P_{1}' A_{1} \cdots A_{p} P_{2}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.038em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are permutation matrices.
Factorizations requiring symmetric <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> have the constraint
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">P_{2} = P_{1}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>, and factorizations without row
or column pivoting have the constraints
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><msub><mi>I</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">P_{1} = I_{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><msub><mi>I</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">P_{2} = I_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>,
where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">I_{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">I_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> identity matrices.
</p>
<p><code>CholeskyFactorization</code>, <code>BunchKaufmanFactorization</code>,
<code>SchurFactorization</code>, <code>LU</code>, and <code>QR</code> are the virtual
subclasses of <code>MatrixFactorization</code> containing all Cholesky,
Bunch-Kaufman, Schur, LU, and QR factorizations, respectively.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Dim</code></dt>
<dd>
<p>an integer vector of length 2 giving the
dimensions of the factorized matrix.</p>
</dd>
<dt><code>Dimnames</code></dt>
<dd>
<p>a list of length 2 preserving the
<code>dimnames</code> of the factorized matrix.  Each element
must be <code>NULL</code> or a character vector of length equal
to the corresponding element of <code>Dim</code>.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt><code>determinant</code></dt>
<dd>
<p><code>signature(x = "MatrixFactorization", logarithm = "missing")</code>:
sets <code>logarithm = TRUE</code> and recalls the generic function.</p>
</dd>
<dt><code>dim</code></dt>
<dd>
<p><code>signature(x = "MatrixFactorization")</code>:
returns <code>x@Dim</code>.</p>
</dd>
<dt><code>dimnames</code></dt>
<dd>
<p><code>signature(x = "MatrixFactorization")</code>:
returns <code>x@Dimnames</code>.</p>
</dd>
<dt><code>dimnames&lt;-</code></dt>
<dd>
<p><code>signature(x = "MatrixFactorization", value = "NULL")</code>:
returns <code>x</code> with <code>x@Dimnames</code> set to <code>list(NULL, NULL)</code>.</p>
</dd>
<dt><code>dimnames&lt;-</code></dt>
<dd>
<p><code>signature(x = "MatrixFactorization", value = "list")</code>:
returns <code>x</code> with <code>x@Dimnames</code> set to <code>value</code>.</p>
</dd>
<dt><code>length</code></dt>
<dd>
<p><code>signature(x = "MatrixFactorization")</code>:
returns <code>prod(x@Dim)</code>.</p>
</dd>
<dt><code>show</code></dt>
<dd>
<p><code>signature(object = "MatrixFactorization")</code>:
prints the internal representation of the factorization using
<code><a href="https://r-universe.dev/manuals/utils.html#str">str</a></code>.</p>
</dd>
<dt><code>solve</code></dt>
<dd>
<p><code>signature(a = "MatrixFactorization", b = .)</code>:
see <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
<dt><code>unname</code></dt>
<dd>
<p><code>signature(obj = "MatrixFactorization")</code>:
returns <code>obj</code> with <code>obj@Dimnames</code> set to
<code>list(NULL, NULL)</code>.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>The virtual class <code><a href="#compMatrix-class">compMatrix</a></code>
of <em>factorizable</em> matrices.
</p>
<p>Classes extending <code>CholeskyFactorization</code>, namely
<code><a href="#Cholesky-class">Cholesky</a></code>, <code><a href="#Cholesky-class">pCholesky</a></code>,
and <code><a href="#CHMfactor-class">CHMfactor</a></code>.
</p>
<p>Classes extending <code>BunchKaufmanFactorization</code>, namely
<code><a href="#BunchKaufman-class">BunchKaufman</a></code> and <code><a href="#BunchKaufman-class">pBunchKaufman</a></code>.
</p>
<p>Classes extending <code>SchurFactorization</code>, namely
<code><a href="#Schur-class">Schur</a></code>.
</p>
<p>Classes extending <code>LU</code>, namely
<code><a href="#LU-class">denseLU</a></code> and <code><a href="#sparseLU-class">sparseLU</a></code>.
</p>
<p>Classes extending <code>QR</code>, namely <code><a href="#sparseQR-class">sparseQR</a></code>.
</p>
<p>Generic functions <code><a href="#Cholesky">Cholesky</a></code>, <code><a href="#BunchKaufman-methods">BunchKaufman</a></code>,
<code><a href="#Schur">Schur</a></code>, <code><a href="#lu">lu</a></code>, and <code><a href="#qr-methods">qr</a></code> for
<em>computing</em> factorizations.
</p>
<p>Generic functions <code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>
for constructing matrix factors from <code>MatrixFactorization</code>
objects.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"MatrixFactorization"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ndenseMatrix-class">

<a href="#ndenseMatrix-class" class="help-page-title"><h2 id="ndenseMatrix-class">Virtual Class "ndenseMatrix" of Dense Logical Matrices</h2></a>

<h3>Description</h3>

<p><code>ndenseMatrix</code> is the virtual class of all dense <b>l</b>ogical
(S4) matrices.  It extends both <code><a href="#denseMatrix-class">denseMatrix</a></code>
and <code><a href="#dMatrix-class">lMatrix</a></code> directly.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>logical vector containing the entries of the matrix.</p>
</dd>
<dt>
<code>Dim</code>, <code>Dimnames</code>:</dt>
<dd>
<p>see <code><a href="#Matrix-class">Matrix</a></code>.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"nMatrix"</code>, directly.
Class <code>"denseMatrix"</code>, directly.
Class <code>"Matrix"</code>, by class <code>"nMatrix"</code>.
Class <code>"Matrix"</code>, by class <code>"denseMatrix"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>%*%</dt>
<dd>
<p><code>signature(x = "nsparseMatrix", y = "ndenseMatrix")</code>: ... </p>
</dd>
<dt>%*%</dt>
<dd>
<p><code>signature(x = "ndenseMatrix", y = "nsparseMatrix")</code>: ... </p>
</dd>
<dt>crossprod</dt>
<dd>
<p><code>signature(x = "nsparseMatrix", y = "ndenseMatrix")</code>: ... </p>
</dd>
<dt>crossprod</dt>
<dd>
<p><code>signature(x = "ndenseMatrix", y = "nsparseMatrix")</code>: ... </p>
</dd>
<dt>as.vector</dt>
<dd>
<p><code>signature(x = "ndenseMatrix", mode = "missing")</code>: ...</p>
</dd>
<dt>diag</dt>
<dd>
<p><code>signature(x = "ndenseMatrix")</code>: extracts the
diagonal as for all matrices, see the generic <code><a href="https://r-universe.dev/manuals/base.html#diag">diag</a>()</code>.</p>
</dd>
<dt>which</dt>
<dd>
<p><code>signature(x = "ndenseMatrix")</code>, semantically
equivalent to <span class="pkg">base</span> function <code><a href="https://r-universe.dev/manuals/base.html#which">which</a>(x, arr.ind)</code>;
for details, see the <code><a href="#dMatrix-class">lMatrix</a></code> class documentation.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Class <code><a href="#ngeMatrix-class">ngeMatrix</a></code> and the other subclasses.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"ndenseMatrix"</span><span class="token punctuation">)</span>

as<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"ndenseMatrix"</span><span class="token punctuation">)</span><span class="token comment"># -&gt; "nge"</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nearPD">

<a href="#nearPD" class="help-page-title"><h2 id="nearPD">Nearest Positive Definite Matrix</h2></a>

<h3>Description</h3>

<p>Compute the nearest positive definite matrix to an approximate
one, typically a correlation or variance-covariance matrix.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">nearPD<span class="token punctuation">(</span>x<span class="token punctuation">,</span> corr <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> keepDiag <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> base.matrix <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
       do2eigen <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> doSym <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
       doDykstra <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> only.values <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
       ensureSymmetry <span class="token operator">=</span> <span class="token operator">!</span>isSymmetric<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>
       eig.tol <span class="token operator">=</span> <span class="token number">1e-06</span><span class="token punctuation">,</span> conv.tol <span class="token operator">=</span> <span class="token number">1e-07</span><span class="token punctuation">,</span> posd.tol <span class="token operator">=</span> <span class="token number">1e-08</span><span class="token punctuation">,</span>
       maxit <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> conv.norm.type <span class="token operator">=</span> <span class="token string">"I"</span><span class="token punctuation">,</span> trace <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="nearPD_:_x">x</code></td>
<td>
<p>numeric <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> approximately positive
definite matrix, typically an approximation to a correlation or
covariance matrix.  If <code>x</code> is not symmetric (and
<code>ensureSymmetry</code> is not false), <code><a href="#symmpart">symmpart</a>(x)</code> is used.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_corr">corr</code></td>
<td>
<p>logical indicating if the matrix should be a
<em>correlation</em> matrix.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_keepDiag">keepDiag</code></td>
<td>
<p>logical, generalizing <code>corr</code>: if <code>TRUE</code>, the
resulting matrix should have the same diagonal
(<code><a href="https://r-universe.dev/manuals/base.html#diag">diag</a>(x)</code>) as the input matrix.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_base.matrix">base.matrix</code></td>
<td>
<p>logical indicating if the resulting <code>mat</code>
component should be a <span class="pkg">base</span> <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code> or (by default) a
<code><a href="#Matrix-class">Matrix</a></code> of class <code><a href="#dpoMatrix-class">dpoMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_do2eigen">do2eigen</code></td>
<td>
<p>logical indicating if a
<code><a href="https://mmaechler.r-universe.dev/sfsmisc/doc/manual.html#posdefify">posdefify</a>()</code> eigen step should be applied to
the result of the Higham algorithm.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_doSym">doSym</code></td>
<td>
<p>logical indicating if <code>X &lt;- (X + t(X))/2</code> should be
done, after <code>X &lt;- tcrossprod(Qd, Q)</code>; some doubt if this is necessary.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_doDykstra">doDykstra</code></td>
<td>
<p>logical indicating if Dykstra's correction should be
used; true by default.  If false, the algorithm is basically the
direct fixpoint iteration
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>k</mi></msub><mo>=</mo><msub><mi>P</mi><mi>U</mi></msub><mo stretchy="false">(</mo><msub><mi>P</mi><mi>S</mi></msub><mo stretchy="false">(</mo><msub><mi>Y</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y_k = P_U(P_S(Y_{k-1}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></code>.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_only.values">only.values</code></td>
<td>
<p>logical; if <code>TRUE</code>, the result is just the
vector of eigenvalues of the approximating matrix.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_ensureSymmetry">ensureSymmetry</code></td>
<td>
<p>logical; by default, <code><a href="#symmpart">symmpart</a>(x)</code>
is used whenever <code><a href="#isSymmetric-methods">isSymmetric</a>(x)</code> is not true.  The user
can explicitly set this to <code>TRUE</code> or <code>FALSE</code>, saving the
symmetry test. <em>Beware</em> however that setting it <code>FALSE</code>
for an <b>a</b>symmetric input <code>x</code>, is typically nonsense!</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_eig.tol">eig.tol</code></td>
<td>
<p>defines relative positiveness of eigenvalues compared
to largest one, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>. Eigenvalues <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are
treated as if zero when <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>k</mi></msub><mi mathvariant="normal">/</mi><msub><mi>λ</mi><mn>1</mn></msub><mo>≤</mo><mi>e</mi><mi>i</mi><mi>g</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi>o</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">\lambda_k / \lambda_1 \le eig.tol</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">.</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span></code>.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_conv.tol">conv.tol</code></td>
<td>
<p>convergence tolerance for Higham algorithm.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_posd.tol">posd.tol</code></td>
<td>
<p>tolerance for enforcing positive definiteness (in the
final <code>posdefify</code> step when <code>do2eigen</code> is <code>TRUE</code>).</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_maxit">maxit</code></td>
<td>
<p>maximum number of iterations allowed.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_conv.norm.type">conv.norm.type</code></td>
<td>
<p>convergence norm type (<code><a href="#norm">norm</a>(*,
      type)</code>) used for Higham algorithm.  The default is <code>"I"</code>
(infinity), for reasons of speed (and back compatibility); using
<code>"F"</code> is more in line with Higham's proposal.</p>
</td>
</tr>
<tr>
<td><code id="nearPD_:_trace">trace</code></td>
<td>
<p>logical or integer specifying if convergence monitoring
should be traced.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This implements the algorithm of Higham (2002), and then (if
<code>do2eigen</code> is true) forces positive definiteness using code from
<code><a href="https://mmaechler.r-universe.dev/sfsmisc/doc/manual.html#posdefify">posdefify</a></code>.  The algorithm of Knol and ten
Berge (1989) (not implemented here) is more general in that it
allows constraints to (1) fix some rows (and columns) of the matrix and
(2) force the smallest eigenvalue to have a certain value.
</p>
<p>Note that setting <code>corr = TRUE</code> just sets <code>diag(.) &lt;- 1</code>
within the algorithm.
</p>
<p>Higham (2002) uses Dykstra's correction, but the version by Jens
Oehlschlägel did not use it (accidentally),
and still gave reasonable results; this simplification, now only
used if <code>doDykstra = FALSE</code>,
was active in <code>nearPD()</code> up to Matrix version 0.999375-40.
</p>


<h3>Value</h3>

<p>If <code>only.values = TRUE</code>, a numeric vector of eigenvalues of the
approximating matrix;
Otherwise, as by default, an S3 object of <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code>
<code>"nearPD"</code>, basically a list with components
</p>
<table>
<tr>
<td><code>mat</code></td>
<td>
<p>a matrix of class <code><a href="#dpoMatrix-class">dpoMatrix</a></code>, the
computed positive-definite matrix.</p>
</td>
</tr>
<tr>
<td><code>eigenvalues</code></td>
<td>
<p>numeric vector of eigenvalues of <code>mat</code>.</p>
</td>
</tr>
<tr>
<td><code>corr</code></td>
<td>
<p>logical, just the argument <code>corr</code>.</p>
</td>
</tr>
<tr>
<td><code>normF</code></td>
<td>
<p>the Frobenius norm (<code><a href="#norm">norm</a>(x-X, "F")</code>) of the
difference between the original and the resulting matrix.</p>
</td>
</tr>
<tr>
<td><code>iterations</code></td>
<td>
<p>number of iterations needed.</p>
</td>
</tr>
<tr>
<td><code>converged</code></td>
<td>
<p>logical indicating if iterations converged.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jens Oehlschlägel donated a first version.
Subsequent changes by the Matrix package authors.
</p>


<h3>References</h3>


<p>Cheng, Sheung Hun and Higham, Nick (1998)
A Modified Cholesky Algorithm Based on a Symmetric Indefinite Factorization;
<em>SIAM J. Matrix Anal.\ Appl.</em>, <b>19</b>, 1097–1110.
</p>
<p>Knol DL, ten Berge JMF (1989)
Least-squares approximation of an improper correlation matrix by a
proper one.
<em>Psychometrika</em> <b>54</b>, 53–61.
</p>
<p>Higham, Nick (2002)
Computing the nearest correlation matrix - a problem from finance;
<em>IMA Journal of Numerical Analysis</em> <b>22</b>, 329–343.
</p>


<h3>See Also</h3>

<p>A first version of this (with non-optional <code>corr=TRUE</code>)
has been available as <code><a href="https://mmaechler.r-universe.dev/sfsmisc/doc/manual.html#nearcor">nearcor</a>()</code>; and
more simple versions with a similar purpose
<code><a href="https://mmaechler.r-universe.dev/sfsmisc/doc/manual.html#posdefify">posdefify</a>()</code>, both from package <span class="pkg">sfsmisc</span>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Higham(2002), p.334f - simple example</span>
 A <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> A<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
 n.A <span class="token operator">&lt;-</span> nearPD<span class="token punctuation">(</span>A<span class="token punctuation">,</span> corr<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> do2eigen<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
 n.A<span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token string">"mat"</span><span class="token punctuation">,</span> <span class="token string">"normF"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
 n.A.m <span class="token operator">&lt;-</span> nearPD<span class="token punctuation">(</span>A<span class="token punctuation">,</span> corr<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> do2eigen<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> base.matrix<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>mat
 stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>                           <span class="token comment">#=--------------</span>
   all.equal<span class="token punctuation">(</span>n.A<span class="token operator">$</span>mat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.760689917</span><span class="token punctuation">)</span>
   all.equal<span class="token punctuation">(</span>n.A<span class="token operator">$</span>normF<span class="token punctuation">,</span> <span class="token number">0.52779033</span><span class="token punctuation">,</span> tolerance<span class="token operator">=</span><span class="token number">1e-9</span><span class="token punctuation">)</span>
   all.equal<span class="token punctuation">(</span>n.A.m<span class="token punctuation">,</span> unname<span class="token punctuation">(</span>as.matrix<span class="token punctuation">(</span>n.A<span class="token operator">$</span>mat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">1e-15</span><span class="token punctuation">)</span><span class="token comment"># seen rel.d.= 1.46e-16</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
 set.seed<span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span>
 m <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
 m <span class="token operator">&lt;-</span> m <span class="token operator">+</span> t<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
 diag<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> pmax<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
 <span class="token punctuation">(</span>m <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>cov2cor<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

 str<span class="token punctuation">(</span>near.m <span class="token operator">&lt;-</span> nearPD<span class="token punctuation">(</span>m<span class="token punctuation">,</span> trace <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 round<span class="token punctuation">(</span>near.m<span class="token operator">$</span>mat<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
 norm<span class="token punctuation">(</span>m <span class="token operator">-</span> near.m<span class="token operator">$</span>mat<span class="token punctuation">)</span> <span class="token comment"># 1.102 / 1.08</span>

 <span class="token keyword">if</span><span class="token punctuation">(</span>requireNamespace<span class="token punctuation">(</span><span class="token string">"sfsmisc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    m2 <span class="token operator">&lt;-</span> sfsmisc<span class="token operator">::</span>posdefify<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token comment"># a simpler approach</span>
    norm<span class="token punctuation">(</span>m <span class="token operator">-</span> m2<span class="token punctuation">)</span>  <span class="token comment"># 1.185, i.e., slightly "less near"</span>
 <span class="token punctuation">}</span>

 round<span class="token punctuation">(</span>nearPD<span class="token punctuation">(</span>m<span class="token punctuation">,</span> only.values<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>

<span class="token comment">## A longer example, extended from Jens' original,</span>
<span class="token comment">## showing the effects of some of the options:</span>

pr <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>     <span class="token number">0.477</span><span class="token punctuation">,</span> <span class="token number">0.644</span><span class="token punctuation">,</span> <span class="token number">0.478</span><span class="token punctuation">,</span> <span class="token number">0.651</span><span class="token punctuation">,</span> <span class="token number">0.826</span><span class="token punctuation">,</span>
               <span class="token number">0.477</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>     <span class="token number">0.516</span><span class="token punctuation">,</span> <span class="token number">0.233</span><span class="token punctuation">,</span> <span class="token number">0.682</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span>
               <span class="token number">0.644</span><span class="token punctuation">,</span> <span class="token number">0.516</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>     <span class="token number">0.599</span><span class="token punctuation">,</span> <span class="token number">0.581</span><span class="token punctuation">,</span> <span class="token number">0.742</span><span class="token punctuation">,</span>
               <span class="token number">0.478</span><span class="token punctuation">,</span> <span class="token number">0.233</span><span class="token punctuation">,</span> <span class="token number">0.599</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>     <span class="token number">0.741</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
               <span class="token number">0.651</span><span class="token punctuation">,</span> <span class="token number">0.682</span><span class="token punctuation">,</span> <span class="token number">0.581</span><span class="token punctuation">,</span> <span class="token number">0.741</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>     <span class="token number">0.798</span><span class="token punctuation">,</span>
               <span class="token number">0.826</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span>  <span class="token number">0.742</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">,</span>   <span class="token number">0.798</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             nrow <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">)</span>

nc.  <span class="token operator">&lt;-</span> nearPD<span class="token punctuation">(</span>pr<span class="token punctuation">,</span> conv.tol <span class="token operator">=</span> <span class="token number">1e-7</span><span class="token punctuation">)</span> <span class="token comment"># default</span>
nc.<span class="token operator">$</span>iterations  <span class="token comment"># 2</span>
nc.<span class="token number">1</span> <span class="token operator">&lt;-</span> nearPD<span class="token punctuation">(</span>pr<span class="token punctuation">,</span> conv.tol <span class="token operator">=</span> <span class="token number">1e-7</span><span class="token punctuation">,</span> corr <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
nc.<span class="token number">1</span><span class="token operator">$</span>iterations <span class="token comment"># 11 / 12 (!)</span>
ncr   <span class="token operator">&lt;-</span> nearPD<span class="token punctuation">(</span>pr<span class="token punctuation">,</span> conv.tol <span class="token operator">=</span> <span class="token number">1e-15</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>ncr<span class="token punctuation">)</span><span class="token comment"># still 2 iterations</span>
ncr.<span class="token number">1</span> <span class="token operator">&lt;-</span> nearPD<span class="token punctuation">(</span>pr<span class="token punctuation">,</span> conv.tol <span class="token operator">=</span> <span class="token number">1e-15</span><span class="token punctuation">,</span> corr <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
ncr.<span class="token number">1</span> <span class="token operator">$</span> iterations <span class="token comment"># 27 / 30 !</span>

ncF <span class="token operator">&lt;-</span> nearPD<span class="token punctuation">(</span>pr<span class="token punctuation">,</span> conv.tol <span class="token operator">=</span> <span class="token number">1e-15</span><span class="token punctuation">,</span> conv.norm <span class="token operator">=</span> <span class="token string">"F"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>ncr<span class="token punctuation">,</span> ncF<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># norm type does not matter at all in this example</span>

<span class="token comment">## But indeed, the 'corr = TRUE' constraint did ensure a better solution;</span>
<span class="token comment">## cov2cor() does not just fix it up equivalently :</span>
norm<span class="token punctuation">(</span>pr <span class="token operator">-</span> cov2cor<span class="token punctuation">(</span>ncr<span class="token operator">$</span>mat<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># = 0.09994</span>
norm<span class="token punctuation">(</span>pr <span class="token operator">-</span>       ncr.<span class="token number">1</span><span class="token operator">$</span>mat<span class="token punctuation">)</span>  <span class="token comment"># = 0.08746 / 0.08805</span>

<span class="token comment">### 3) a real data example from a 'systemfit' model (3 eq.):</span>
<span class="token punctuation">(</span>load<span class="token punctuation">(</span>system.file<span class="token punctuation">(</span><span class="token string">"external"</span><span class="token punctuation">,</span> <span class="token string">"symW.rda"</span><span class="token punctuation">,</span> package<span class="token operator">=</span><span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># "symW"</span>
dim<span class="token punctuation">(</span>symW<span class="token punctuation">)</span> <span class="token comment">#  24 x 24</span>
class<span class="token punctuation">(</span>symW<span class="token punctuation">)</span><span class="token comment"># "dsCMatrix": sparse symmetric</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>dev.interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  image<span class="token punctuation">(</span>symW<span class="token punctuation">)</span>
EV <span class="token operator">&lt;-</span> eigen<span class="token punctuation">(</span>symW<span class="token punctuation">,</span> only<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>values
summary<span class="token punctuation">(</span>EV<span class="token punctuation">)</span> <span class="token comment">## looking more closely {EV sorted decreasingly}:</span>
tail<span class="token punctuation">(</span>EV<span class="token punctuation">)</span><span class="token comment"># all 6 are negative</span>
EV2 <span class="token operator">&lt;-</span> eigen<span class="token punctuation">(</span>sWpos <span class="token operator">&lt;-</span> nearPD<span class="token punctuation">(</span>symW<span class="token punctuation">)</span><span class="token operator">$</span>mat<span class="token punctuation">,</span> only<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>values
stopifnot<span class="token punctuation">(</span>EV2 <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>requireNamespace<span class="token punctuation">(</span><span class="token string">"sfsmisc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    plot<span class="token punctuation">(</span>pmax<span class="token punctuation">(</span><span class="token number">1e-3</span><span class="token punctuation">,</span>EV<span class="token punctuation">)</span><span class="token punctuation">,</span> EV2<span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"o"</span><span class="token punctuation">,</span> log<span class="token operator">=</span><span class="token string">"xy"</span><span class="token punctuation">,</span> xaxt<span class="token operator">=</span><span class="token string">"n"</span><span class="token punctuation">,</span> yaxt<span class="token operator">=</span><span class="token string">"n"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>side <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span> sfsmisc<span class="token operator">::</span>eaxis<span class="token punctuation">(</span>side<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span>
    plot<span class="token punctuation">(</span>pmax<span class="token punctuation">(</span><span class="token number">1e-3</span><span class="token punctuation">,</span>EV<span class="token punctuation">)</span><span class="token punctuation">,</span> EV2<span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"o"</span><span class="token punctuation">,</span> log<span class="token operator">=</span><span class="token string">"xy"</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"red3"</span><span class="token punctuation">,</span> lty<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ngeMatrix-class">

<a href="#ngeMatrix-class" class="help-page-title"><h2 id="ngeMatrix-class">Class "ngeMatrix" of General Dense Nonzero-pattern Matrices</h2></a>

<h3>Description</h3>

<p>This is the class of general dense nonzero-pattern
matrices, see <code><a href="#nMatrix-class">nMatrix</a></code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code>. The logical
values that constitute the matrix, stored in column-major order.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>), see the
<code><a href="#Matrix-class">Matrix</a></code> class.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code>.  A named
list of factorizations that have been computed for the matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"ndenseMatrix"</code>, directly.
Class <code>"lMatrix"</code>, by class <code>"ndenseMatrix"</code>.
Class <code>"denseMatrix"</code>, by class <code>"ndenseMatrix"</code>.
Class <code>"Matrix"</code>, by class <code>"ndenseMatrix"</code>.
Class <code>"Matrix"</code>, by class <code>"ndenseMatrix"</code>.
</p>


<h3>Methods</h3>

<p>Currently, mainly <code><a href="https://r-universe.dev/manuals/base.html#t">t</a>()</code> and coercion methods (for
<code><a href="https://r-universe.dev/manuals/methods.html#as">as</a>(.)</code>); use, e.g.,
<code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(class="ngeMatrix")</code> for details.
</p>


<h3>See Also</h3>

<p>Non-general logical dense matrix classes such as
<code><a href="#ntrMatrix-class">ntrMatrix</a></code>, or <code><a href="#nsyMatrix-class">nsyMatrix</a></code>;
<em>sparse</em> logical classes such as <code><a href="#nsparseMatrix-classes">ngCMatrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"ngeMatrix"</span><span class="token punctuation">)</span>
<span class="token comment">## "lgeMatrix" is really more relevant</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nMatrix-class">

<a href="#nMatrix-class" class="help-page-title"><h2 id="nMatrix-class">Class "nMatrix" of Non-zero Pattern Matrices</h2></a>

<h3>Description</h3>

<p>The <code>nMatrix</code> class is the virtual “mother” class of all
<em><b>n</b>on-zero pattern</em> (or simply <em>patter<b>n</b></em>)
matrices in the <span class="pkg">Matrix</span> package.
</p>


<h3>Slots</h3>

<p>Common to <em>all</em> matrix object in the package:
</p>

<dl>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the dimensions
of the matrix - must be an integer vector with exactly two
non-negative values.</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>list of length two; each component
containing NULL or a <code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> vector length
equal the corresponding <code>Dim</code> element.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "matrix", to = "nMatrix")</code>:
Note that these coercions (must) coerce <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s to
non-zero, hence conceptually <code>TRUE</code>.
This is particularly important when
<code><a href="#sparseMatrix-class">sparseMatrix</a></code> objects are coerced to
<code>"nMatrix"</code> and hence to <code><a href="#nsparseMatrix-classes">nsparseMatrix</a></code>.
</p>
</dd>
</dl>
<p>— — —
</p>
<p>Additional methods contain group methods, such as
</p>

<dl>
<dt>Ops</dt>
<dd>
<p><code>signature(e1 = "nMatrix", e2 = "....")</code>, ...</p>
</dd>
<dt>Arith</dt>
<dd>
<p><code>signature(e1 = "nMatrix", e2 = "....")</code>, ...</p>
</dd>
<dt>Compare</dt>
<dd>
<p><code>signature(e1 = "nMatrix", e2 = "....")</code>, ...</p>
</dd>
<dt>Logic</dt>
<dd>
<p><code>signature(e1 = "nMatrix", e2 = "....")</code>, ...</p>
</dd>
<dt>Summary</dt>
<dd>
<p><code>signature(x = "nMatrix", "....")</code>, ...</p>
</dd>
</dl>
<h3>See Also</h3>

<p>The classes <code><a href="#dMatrix-class">lMatrix</a></code>,
<code><a href="#nsparseMatrix-classes">nsparseMatrix</a></code>, and the mother class,
<code><a href="#Matrix-class">Matrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">getClass<span class="token punctuation">(</span><span class="token string">"nMatrix"</span><span class="token punctuation">)</span>

L3 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>upper.tri<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
L3 <span class="token comment"># an "ltCMatrix"</span>
as<span class="token punctuation">(</span>L3<span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; ntC*</span>

<span class="token comment">## similar, not using Matrix()</span>
as<span class="token punctuation">(</span>upper.tri<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span><span class="token comment"># currently "ngTMatrix"</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nnzero">

<a href="#nnzero" class="help-page-title"><h2 id="nnzero-methods">The Number of Non-Zero Values of a Matrix</h2></a>

<h3>Description</h3>

<p>Returns the number of non-zero values of a numeric-like <span class="rlang"><b>R</b></span> object, and
in particular an object <code>x</code> inheriting from class
<code><a href="#Matrix-class">Matrix</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">nnzero<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.counted <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="nnzero-methods_:_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object, typically inheriting from class
<code><a href="#Matrix-class">Matrix</a></code> or <code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="nnzero-methods_:_na.counted">na.counted</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> describing how
<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s should be counted.  There are three possible
settings for <code>na.counted</code>:
</p>

<dl>
<dt>TRUE</dt>
<dd>
<p><code>NA</code>s <em>are</em> counted as non-zero (since
“they are not zero”).</p>
</dd>
<dt>NA</dt>
<dd>
<p>(default)the result will be <code>NA</code> if there are <code>NA</code>'s in
<code>x</code> (since “NA's are not known, i.e., <em>may be</em> zero”).</p>
</dd>
<dt>FALSE</dt>
<dd>
<p><code>NA</code>s are <em>omitted</em> from <code>x</code> before
the non-zero entries are counted.</p>
</dd>
</dl>
<p>For sparse matrices, you may often want to use <code>na.counted = TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the number of non zero entries in <code>x</code> (typically
<code><a href="https://r-universe.dev/manuals/base.html#integer">integer</a></code>).
</p>
<p>Note that for a <em>symmetric</em> sparse matrix <code>S</code> (i.e., inheriting from
class <code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>), <code>nnzero(S)</code> is
typically <em>twice</em> the <code>length(S@x)</code>.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "ANY")</code></dt>
<dd>
<p>the default method for
non-<code><a href="#Matrix-class">Matrix</a></code> class objects, simply counts the
number <code>0</code>s in <code>x</code>, counting <code>NA</code>'s depending on
the <code>na.counted</code> argument, see above.</p>
</dd>
<dt><code>signature(x = "denseMatrix")</code></dt>
<dd>
<p>conceptually the same as
for traditional <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code> objects, care has to be taken
for <code>"<a href="#symmetricMatrix-class">symmetricMatrix</a>"</code> objects.</p>
</dd>
<dt>
<code>signature(x = "diagonalMatrix")</code>, and
<code>signature(x = "indMatrix")</code>
</dt>
<dd>
<p>fast simple methods for these
special <code>"sparseMatrix"</code> classes.</p>
</dd>
<dt><code>signature(x = "sparseMatrix")</code></dt>
<dd>
<p>typically, the most
interesting method, also carefully taking
<code>"<a href="#symmetricMatrix-class">symmetricMatrix</a>"</code> objects into account.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>The <code><a href="#Matrix-class">Matrix</a></code> class also has a
<code><a href="https://r-universe.dev/manuals/base.html#length">length</a></code> method; typically, <code>length(M)</code> is much
larger than <code>nnzero(M)</code> for a sparse matrix M, and the latter is
a better indication of the <em>size</em> of <code>M</code>.
</p>
<p><code><a href="#drop0">drop0</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#zapsmall">zapsmall</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">m <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
m<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> m<span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> m<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
<span class="token punctuation">(</span>mT <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">"TsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
nnzero<span class="token punctuation">(</span>mT<span class="token punctuation">)</span>
<span class="token punctuation">(</span>S <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>mT<span class="token punctuation">)</span><span class="token punctuation">)</span>
nnzero<span class="token punctuation">(</span>S<span class="token punctuation">)</span>
str<span class="token punctuation">(</span>S<span class="token punctuation">)</span> <span class="token comment"># slots are smaller than nnzero()</span>
stopifnot<span class="token punctuation">(</span>nnzero<span class="token punctuation">(</span>S<span class="token punctuation">)</span> <span class="token operator">==</span> sum<span class="token punctuation">(</span>as.matrix<span class="token punctuation">(</span>S<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># failed earlier</span>

data<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
M <span class="token operator">&lt;-</span> KNex<span class="token operator">$</span>mm
class<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
dim<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
length<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">;</span> stopifnot<span class="token punctuation">(</span>length<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token operator">==</span> prod<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
nnzero<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token comment"># more relevant than length</span>
<span class="token comment">## the above are also visible from</span>
str<span class="token punctuation">(</span>M<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="norm">

<a href="#norm" class="help-page-title"><h2 id="norm-methods">Matrix Norms</h2></a>

<h3>Description</h3>

<p>Computes a matrix norm of <code>x</code>, using Lapack for dense matrices.
The norm can be the one  (<code>"O"</code>, or <code>"1"</code>) norm, the
infinity (<code>"I"</code>) norm, the Frobenius  (<code>"F"</code>) norm,
the maximum modulus (<code>"M"</code>) among elements of a matrix, or the
spectral norm or 2-norm (<code>"2"</code>), as determined by the value of
<code>type</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">norm<span class="token punctuation">(</span>x<span class="token punctuation">,</span> type<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="norm-methods_:_x">x</code></td>
<td>

<p>a real or complex matrix.
</p>
</td>
</tr>
<tr>
<td><code id="norm-methods_:_type">type</code></td>
<td>

<p>A character indicating the type of norm desired.
</p>

<dl>
<dt>
<code>"O"</code>, <code>"o"</code> or <code>"1"</code>
</dt>
<dd>
<p>specifies the one norm,
(maximum absolute column sum);</p>
</dd>
<dt>
<code>"I"</code> or <code>"i"</code>
</dt>
<dd>
<p>specifies the infinity norm (maximum
absolute row sum);</p>
</dd>
<dt>
<code>"F"</code> or <code>"f"</code>
</dt>
<dd>
<p>specifies the Frobenius norm (the
Euclidean norm of <code>x</code> treated as if it were a vector);</p>
</dd>
<dt>
<code>"M"</code> or <code>"m"</code>
</dt>
<dd>
<p>specifies the maximum modulus of
all the elements in <code>x</code>; and</p>
</dd>
<dt><code>"2"</code></dt>
<dd>
<p>specifies the “spectral norm” or 2-norm, which
is the largest singular value (<code><a href="https://r-universe.dev/manuals/base.html#svd">svd</a></code>) of <code>x</code>.</p>
</dd>
</dl>
<p>The default is <code>"O"</code>.  Only the first character of
<code>type[1]</code> is used.
</p>
</td>
</tr>
<tr>
<td><code id="norm-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For dense matrices, the methods eventually call the Lapack functions
<code>dlange</code>, <code>dlansy</code>, <code>dlantr</code>, <code>zlange</code>,
<code>zlansy</code>, and <code>zlantr</code>.
</p>


<h3>Value</h3>

<p>A numeric value of class <code>"norm"</code>, representing the quantity
chosen according to <code>type</code>.
</p>


<h3>References</h3>

<p>Anderson, E., et al. (1994).
<em>LAPACK User's Guide,</em>
2nd edition, SIAM, Philadelphia.
</p>


<h3>See Also</h3>

<p><code><a href="#condest">onenormest</a>()</code>, an <em>approximate</em> randomized estimate
of the 1-norm condition number, efficient for large sparse matrices.
</p>
<p>The <code><a href="https://r-universe.dev/manuals/base.html#norm">norm</a>()</code> function from <span class="rlang"><b>R</b></span>'s <span class="pkg">base</span> package.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">x <span class="token operator">&lt;-</span> Hilbert<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
norm<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment"># = "O" = "1"</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>norm<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> norm<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
norm<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">)</span><span class="token comment"># the same, because 'x' is symmetric</span>

allnorms <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> vapply<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"I"</span><span class="token punctuation">,</span><span class="token string">"F"</span><span class="token punctuation">,</span><span class="token string">"M"</span><span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                               norm<span class="token punctuation">,</span> x <span class="token operator">=</span> d<span class="token punctuation">,</span> double<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
allnorms<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
allnorms<span class="token punctuation">(</span>Hilbert<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

i <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> x <span class="token operator">&lt;-</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span>
A <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> x <span class="token operator">=</span> x<span class="token punctuation">)</span>                      <span class="token comment">##  8 x 10 "dgCMatrix"</span>
<span class="token punctuation">(</span>sA <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> x <span class="token operator">=</span> x<span class="token punctuation">,</span> symmetric <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">## 10 x 10 "dsCMatrix"</span>
<span class="token punctuation">(</span>tA <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> x <span class="token operator">=</span> x<span class="token punctuation">,</span> triangular<span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">## 10 x 10 "dtCMatrix"</span>
<span class="token punctuation">(</span>allnorms<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> nA<span class="token punctuation">)</span>
allnorms<span class="token punctuation">(</span>sA<span class="token punctuation">)</span>
allnorms<span class="token punctuation">(</span>tA<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>nA<span class="token punctuation">,</span> allnorms<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  all.equal<span class="token punctuation">(</span>nA<span class="token punctuation">,</span> allnorms<span class="token punctuation">(</span>tA<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># because tA == rbind(A, 0, 0)</span>
A. <span class="token operator">&lt;-</span> A<span class="token punctuation">;</span> A.<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token keyword">NA</span>
stopifnot<span class="token punctuation">(</span>is.na<span class="token punctuation">(</span>allnorms<span class="token punctuation">(</span>A.<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># gave error</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nsparseMatrix-classes">

<a href="#nsparseMatrix-classes" class="help-page-title"><h2 id="nsparseMatrix-classes">Sparse "pattern" Matrices</h2></a>

<h3>Description</h3>

<p>The <code>nsparseMatrix</code> class is a virtual class of sparse
<em>“pattern”</em> matrices, i.e., binary matrices conceptually
with <code>TRUE</code>/<code>FALSE</code> entries.  Only the positions of the
elements that are <code>TRUE</code> are stored.
</p>
<p>These can be stored in the “triplet” form
(<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>, subclasses <code>ngTMatrix</code>,
<code>nsTMatrix</code>, and <code>ntTMatrix</code> which really contain pairs, not
triplets) or in compressed column-oriented form (class
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>, subclasses <code>ngCMatrix</code>,
<code>nsCMatrix</code>, and <code>ntCMatrix</code>) or–<em>rarely</em>–in
compressed row-oriented form (class <code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>,
subclasses <code>ngRMatrix</code>, <code>nsRMatrix</code>, and <code>ntRMatrix</code>).
The second letter in the name of these non-virtual classes indicates
<code>g</code>eneral, <code>s</code>ymmetric, or <code>t</code>riangular.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("ngCMatrix",
    ...)</code> and so on.  More frequently objects are created by coercion of
a numeric sparse matrix to the pattern form for use in
the symbolic analysis phase
of an algorithm involving sparse matrices.  Such algorithms often
involve two phases: a symbolic phase wherein the positions of the
non-zeros in the result are determined and a numeric phase wherein the
actual results are calculated.  During the symbolic phase only the
positions of the non-zero elements in any operands are of interest,
hence numeric sparse matrices can be treated as sparse pattern
matrices.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower
triangular. Present in the triangular and symmetric classes but not
in the general class.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either <code>"U"</code>, for unit triangular (diagonal is all ones), or
<code>"N"</code> for non-unit.  The implicit diagonal elements are not
explicitly stored when <code>diag</code> is <code>"U"</code>.  Present in the
triangular classes only.</p>
</dd>
<dt>
<code>p</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of pointers, one
for each column (row), to the initial (zero-based) index of elements in
the column.  Present in compressed column-oriented and compressed
row-oriented forms only.</p>
</dd>
<dt>
<code>i</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length nnzero
(number of non-zero elements).  These are the row numbers for
each TRUE element in the matrix.  All other elements are FALSE.
Present in triplet and compressed column-oriented forms only.</p>
</dd>
<dt>
<code>j</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length nnzero
(number of non-zero elements).  These are the column numbers for
each TRUE element in the matrix.  All other elements are FALSE.
Present in triplet and compressed row-oriented forms only.</p>
</dd>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the dimensions
of the matrix.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "dgCMatrix", to =
	"ngCMatrix")</code>, and many similar ones; typically you should
coerce to <code>"nsparseMatrix"</code> (or <code>"nMatrix"</code>).  Note that
coercion to a sparse pattern matrix records all the potential
non-zero entries, i.e., explicit (“non-structural”) zeroes
are coerced to <code>TRUE</code>, not <code>FALSE</code>, see the example.
</p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "ngCMatrix")</code>: returns the transpose
of <code>x</code></p>
</dd>
<dt>which</dt>
<dd>
<p><code>signature(x = "lsparseMatrix")</code>, semantically
equivalent to <span class="pkg">base</span> function <code><a href="https://r-universe.dev/manuals/base.html#which">which</a>(x, arr.ind)</code>;
for details, see the <code><a href="#dMatrix-class">lMatrix</a></code> class documentation.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>the class <code><a href="#dgCMatrix-class">dgCMatrix</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>m <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span> dimnames<span class="token operator">=</span>list<span class="token punctuation">(</span>LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## ``extract the nonzero-pattern of (m) into an nMatrix'':</span>
nm <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">"nsparseMatrix"</span><span class="token punctuation">)</span> <span class="token comment">## -&gt; will be a "ngCMatrix"</span>
str<span class="token punctuation">(</span>nm<span class="token punctuation">)</span> <span class="token comment"># no 'x' slot</span>
nnm <span class="token operator">&lt;-</span> <span class="token operator">!</span>nm <span class="token comment"># no longer sparse</span>
<span class="token comment">## consistency check:</span>
stopifnot<span class="token punctuation">(</span>xor<span class="token punctuation">(</span>as<span class="token punctuation">(</span> nm<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              as<span class="token punctuation">(</span>nnm<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## low-level way of adding "non-structural zeros" :</span>
nnm <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>nnm<span class="token punctuation">,</span> <span class="token string">"lsparseMatrix"</span><span class="token punctuation">)</span> <span class="token comment"># "lgCMatrix"</span>
nnm<span class="token operator">@</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
nnm
as<span class="token punctuation">(</span>nnm<span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span> <span class="token comment"># NAs *and* non-structural 0  |---&gt;  'TRUE'</span>

data<span class="token punctuation">(</span>KNex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
nmm <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>KNex <span class="token operator">$</span> mm<span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>xlx <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>nmm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># "nsCMatrix"</span>
stopifnot<span class="token punctuation">(</span>isSymmetric<span class="token punctuation">(</span>xlx<span class="token punctuation">)</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>xlx<span class="token punctuation">,</span> main<span class="token operator">=</span>paste<span class="token punctuation">(</span><span class="token string">"crossprod(nmm) : Sparse"</span><span class="token punctuation">,</span> class<span class="token punctuation">(</span>xlx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nsyMatrix-class">

<a href="#nsyMatrix-class" class="help-page-title"><h2 id="nsyMatrix-class">Symmetric Dense Nonzero-Pattern Matrices</h2></a>

<h3>Description</h3>

<p>The <code>"nsyMatrix"</code> class is the class of symmetric, dense nonzero-pattern
matrices in non-packed storage and <code>"nspMatrix"</code> is the class of
of these in packed storage.  Only the upper triangle or the
lower triangle is stored.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("nsyMatrix", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code>. The logical
values that constitute the matrix, stored in column-major order.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>), see the
<code><a href="#Matrix-class">Matrix</a></code> class.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code>.  A named
list of factorizations that have been computed for the matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p><code>"nsyMatrix"</code> extends class <code>"ngeMatrix"</code>, directly, whereas<br><code>"nspMatrix"</code> extends class <code>"ndenseMatrix"</code>, directly.
</p>
<p>Both extend class <code>"symmetricMatrix"</code>, directly,
and class <code>"Matrix"</code> and others, <em>in</em>directly, use
<code><a href="https://r-universe.dev/manuals/methods.html#RClassUtils">showClass</a>("nsyMatrix")</code>, e.g., for details.
</p>


<h3>Methods</h3>

<p>Currently, mainly <code><a href="https://r-universe.dev/manuals/base.html#t">t</a>()</code> and coercion methods (for
<code><a href="https://r-universe.dev/manuals/methods.html#as">as</a>(.)</code>; use, e.g.,
<code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(class="nsyMatrix")</code> for details.
</p>


<h3>See Also</h3>

<p><code><a href="#ngeMatrix-class">ngeMatrix</a></code>, <code><a href="#Matrix-class">Matrix</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#t">t</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>s0 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"nsyMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>M2 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># logical dense (ltr)</span>
<span class="token punctuation">(</span>sM <span class="token operator">&lt;-</span> M2 <span class="token operator">&amp;</span> t<span class="token punctuation">(</span>M2<span class="token punctuation">)</span><span class="token punctuation">)</span>                       <span class="token comment"># -&gt; "lge"</span>
class<span class="token punctuation">(</span>sM <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sM<span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>           <span class="token comment"># -&gt; "nge"</span>
     <span class="token punctuation">(</span>sM <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sM<span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># -&gt; "nsy"</span>
str<span class="token punctuation">(</span>sM <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sM<span class="token punctuation">,</span> <span class="token string">"packedMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; "nsp", i.e., packed symmetric</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ntrMatrix-class">

<a href="#ntrMatrix-class" class="help-page-title"><h2 id="ntrMatrix-class">Triangular Dense Logical Matrices</h2></a>

<h3>Description</h3>

<p>The <code>"ntrMatrix"</code> class is the class of triangular, dense,
logical matrices in nonpacked storage.  The <code>"ntpMatrix"</code> class
is the same except in packed storage.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code>. The logical
values that constitute the matrix, stored in column-major order.</p>
</dd>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. Must be
either <code>"U"</code>, for unit triangular (diagonal is all ones), or
<code>"N"</code>; see <code><a href="#triangularMatrix-class">triangularMatrix</a></code>.</p>
</dd>
<dt>
<code>Dim</code>,<code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>), see the
<code><a href="#Matrix-class">Matrix</a></code> class.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code>.  A named
list of factorizations that have been computed for the matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p><code>"ntrMatrix"</code> extends class <code>"ngeMatrix"</code>, directly, whereas<br><code>"ntpMatrix"</code> extends class <code>"ndenseMatrix"</code>, directly.
</p>
<p>Both extend Class <code>"triangularMatrix"</code>, directly,
and class <code>"denseMatrix"</code>, <code>"lMatrix"</code> and others,
<em>in</em>directly, use <code><a href="https://r-universe.dev/manuals/methods.html#RClassUtils">showClass</a>("nsyMatrix")</code>, e.g., for
details.
</p>


<h3>Methods</h3>

<p>Currently, mainly <code><a href="https://r-universe.dev/manuals/base.html#t">t</a>()</code> and coercion methods (for
<code><a href="https://r-universe.dev/manuals/methods.html#as">as</a>(.)</code>; use, e.g.,
<code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(class="ntrMatrix")</code> for details.
</p>


<h3>See Also</h3>

<p>Classes <code><a href="#ngeMatrix-class">ngeMatrix</a></code>, <code><a href="#Matrix-class">Matrix</a></code>;
function <code><a href="https://r-universe.dev/manuals/base.html#t">t</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"ntrMatrix"</span><span class="token punctuation">)</span>

str<span class="token punctuation">(</span>new<span class="token punctuation">(</span><span class="token string">"ntpMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>nutr <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>upper.tri<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"ndenseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>nutp <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>nutr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># packed matrix: only 10 = 4*(4+1)/2 entries</span>
<span class="token operator">!</span>nutp <span class="token comment"># the logical negation (is *not* logical triangular !)</span>
<span class="token comment">## but this one is:</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>nutp<span class="token punctuation">,</span> pack<span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span>nutp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="number-class">

<a href="#number-class" class="help-page-title"><h2 id="number-class">Class "number" of Possibly Complex Numbers</h2></a>

<h3>Description</h3>

<p>The class <code>"number"</code> is a virtual class,
currently used for vectors of eigen values which can be
<code>"numeric"</code> or <code>"complex"</code>.
</p>
<p>It is a simple class union (<code><a href="https://r-universe.dev/manuals/methods.html#setClassUnion">setClassUnion</a></code>) of
<code>"numeric"</code> and <code>"complex"</code>.
</p>


<h3>Objects from the Class</h3>

<p>Since it is a virtual Class, no objects
may be created from it.</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"number"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span> is<span class="token punctuation">(</span><span class="token number">1i</span><span class="token punctuation">,</span> <span class="token string">"number"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> is<span class="token punctuation">(</span>pi<span class="token punctuation">,</span> <span class="token string">"number"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> is<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"number"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="unpack">

<a href="#unpack" class="help-page-title"><h2 id="pack">Representation of Packed and Unpacked Dense Matrices</h2></a>

<h3>Description</h3>

<p><code>pack()</code> coerces dense symmetric and dense triangular matrices
from unpacked format (storing the full matrix) to packed format
(storing only one of the upper and lower triangles).  <code>unpack()</code>
performs the reverse coercion. The two formats are formalized
by the virtual classes <code>"<a href="#packedMatrix-class">packedMatrix</a>"</code> and
<code>"<a href="#unpackedMatrix-class">unpackedMatrix</a>"</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pack<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dgeMatrix'</span>
pack<span class="token punctuation">(</span>x<span class="token punctuation">,</span> symmetric <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> upperTri <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'lgeMatrix'</span>
pack<span class="token punctuation">(</span>x<span class="token punctuation">,</span> symmetric <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> upperTri <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'ngeMatrix'</span>
pack<span class="token punctuation">(</span>x<span class="token punctuation">,</span> symmetric <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> upperTri <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'matrix'</span>
pack<span class="token punctuation">(</span>x<span class="token punctuation">,</span> symmetric <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> upperTri <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

unpack<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="pack_:_x">x</code></td>
<td>
<p>A dense symmetric or dense triangular matrix.
</p>

<dl>
<dt>For <code>pack()</code>:</dt>
<dd>
<p>typically an <code>"unpackedMatrix"</code>
or a standard <code>"matrix"</code>, though <code>"packedMatrix"</code>
are allowed and returned unchanged.</p>
</dd>
<dt>For <code>unpack()</code>:</dt>
<dd>
<p>typically a <code>"packedMatrix"</code>,
though <code>"unpackedMatrix"</code> are allowed and returned unchanged.</p>
</dd>
</dl>
</td>
</tr>
<tr>
<td><code id="pack_:_symmetric">symmetric</code></td>
<td>
<p>logical (including <code>NA</code>) optionally
indicating whether <code>x</code> is symmetric (or triangular).</p>
</td>
</tr>
<tr>
<td><code id="pack_:_upperTri">upperTri</code></td>
<td>
<p>(for triangular <code>x</code> only) logical
(including <code>NA</code>) indicating whether <code>x</code> is
upper (or lower) triangular.</p>
</td>
</tr>
<tr>
<td><code id="pack_:_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pack(x)</code> checks matrices <code>x</code> <em>not</em> inheriting from
one of the virtual classes <code>"<a href="#symmetricMatrix-class">symmetricMatrix</a>"</code>
<code>"<a href="#triangularMatrix-class">triangularMatrix</a>"</code> for symmetry
(via <code><a href="#isSymmetric-methods">isSymmetric</a>()</code>)
then for upper and lower triangularity
(via <code><a href="#isTriangular">isTriangular</a>()</code>) in order to identify a suitable
coercion.  Setting one or both of <code>symmetric</code> and <code>upperTri</code>
to <code>TRUE</code> or <code>FALSE</code> rather than <code>NA</code> allows skipping
of irrelevant tests for large matrices known to be symmetric or
(upper or lower) triangular.
</p>
<p>Users should <em>not</em> assume that <code>pack()</code> and <code>unpack()</code>
are inverse operations.  Specifically, <code>y &lt;- unpack(pack(x))</code>
may not reproduce an <code>"unpackedMatrix"</code> <code>x</code> in the sense of
<code><a href="https://r-universe.dev/manuals/base.html#identical">identical</a>()</code>.  See the examples.
</p>


<h3>Value</h3>


<dl>
<dt>For <code>pack()</code>:</dt>
<dd>
<p>a <code>"packedMatrix"</code> giving
the condensed representation of <code>x</code>.</p>
</dd>
<dt>For <code>unpack()</code>:</dt>
<dd>
<p>an <code>"unpackedMatrix"</code> giving
the full storage representation of <code>x</code>.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span><span class="token string">"pack"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>s <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># traditional symmetric matrix</span>
<span class="token punctuation">(</span>sp <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
mt <span class="token operator">&lt;-</span> as.matrix<span class="token punctuation">(</span>tt <span class="token operator">&lt;-</span> tril<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>pt <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>mt<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>pt<span class="token punctuation">,</span> pack<span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  dim<span class="token punctuation">(</span>s <span class="token punctuation">)</span> <span class="token operator">==</span> dim<span class="token punctuation">(</span>sp<span class="token punctuation">)</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span>s  <span class="token operator">==</span> sp<span class="token punctuation">)</span><span class="token punctuation">,</span>
	  dim<span class="token punctuation">(</span>mt<span class="token punctuation">)</span> <span class="token operator">==</span> dim<span class="token punctuation">(</span>pt<span class="token punctuation">)</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span>mt <span class="token operator">==</span> pt<span class="token punctuation">)</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span>mt <span class="token operator">==</span> tt<span class="token punctuation">)</span><span class="token punctuation">)</span>

showMethods<span class="token punctuation">(</span><span class="token string">"unpack"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>cp4 <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>Hilbert<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># is triangular</span>
tp4 <span class="token operator">&lt;-</span> pack<span class="token punctuation">(</span>cp4<span class="token punctuation">)</span> <span class="token comment"># [t]riangular [p]acked</span>
str<span class="token punctuation">(</span>tp4<span class="token punctuation">)</span>
<span class="token punctuation">(</span>unpack<span class="token punctuation">(</span>tp4<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>tp4<span class="token punctuation">,</span> pack<span class="token punctuation">(</span>unpack<span class="token punctuation">(</span>tp4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

z1 <span class="token operator">&lt;-</span> new<span class="token punctuation">(</span><span class="token string">"dsyMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> as.double<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> uplo <span class="token operator">=</span> <span class="token string">"U"</span><span class="token punctuation">)</span>
z2 <span class="token operator">&lt;-</span> unpack<span class="token punctuation">(</span>pack<span class="token punctuation">(</span>z1<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span><span class="token operator">!</span>identical<span class="token punctuation">(</span>z1<span class="token punctuation">,</span> z2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># _not_ identical</span>
          all<span class="token punctuation">(</span>z1 <span class="token operator">==</span> z2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># but mathematically equal</span>
cbind<span class="token punctuation">(</span>z1<span class="token operator">@</span>x<span class="token punctuation">,</span> z2<span class="token operator">@</span>x<span class="token punctuation">)</span> <span class="token comment"># (unused!) lower triangle is "lost" in translation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="packedMatrix-class">

<a href="#packedMatrix-class" class="help-page-title"><h2 id="packedMatrix-class">Virtual Class <code>"packedMatrix"</code> of Packed Dense Matrices</h2></a>

<h3>Description</h3>

<p>Class <code>"packedMatrix"</code> is the <em>virtual</em> class of dense
symmetric or triangular matrices in "packed" format, storing only
the <code>choose(n+1,2) == n*(n+1)/2</code> elements of the upper or
lower triangle of an <code>n</code>-by-<code>n</code> matrix. It is used to
define common methods for efficient subsetting, transposing, etc.
of its <em>proper</em> subclasses: currently <code>"[dln]spMatrix"</code>
(packed symmetric), <code>"[dln]tpMatrix"</code> (packed triangular),
and subclasses of these, such as
<code>"<a href="#dpoMatrix-class">dppMatrix</a>"</code>,
<code>"<a href="#Cholesky-class">pCholesky</a>"</code>, and
<code>"<a href="#BunchKaufman-class">pBunchKaufman</a>"</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p><code>"character"</code>; either "U", for upper triangular, and "L", for lower.</p>
</dd>
<dt>
<code>Dim</code>, <code>Dimnames</code>:</dt>
<dd>
<p>as all <code><a href="#Matrix-class">Matrix</a></code> objects.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"<a href="#denseMatrix-class">denseMatrix</a>"</code>, directly.
Class <code>"<a href="#Matrix-class">Matrix</a>"</code>, by class <code>"denseMatrix"</code>,
distance 2.
Class <code>"mMatrix"</code>, by class <code>"Matrix"</code>, distance 3.
Class <code>"replValueSp"</code>, by class <code>"Matrix"</code>, distance 3.
</p>


<h3>Methods</h3>


<dl>
<dt>pack</dt>
<dd>
<p><code>signature(x = "packedMatrix")</code>: ... </p>
</dd>
<dt>unpack</dt>
<dd>
<p><code>signature(x = "packedMatrix")</code>: ... </p>
</dd>
<dt>isSymmetric</dt>
<dd>
<p><code>signature(object = "packedMatrix")</code>: ... </p>
</dd>
<dt>isTriangular</dt>
<dd>
<p><code>signature(object = "packedMatrix")</code>: ... </p>
</dd>
<dt>isDiagonal</dt>
<dd>
<p><code>signature(object = "packedMatrix")</code>: ... </p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "packedMatrix")</code>: ... </p>
</dd>
<dt>diag</dt>
<dd>
<p><code>signature(x = "packedMatrix")</code>: ... </p>
</dd>
<dt>diag&lt;-</dt>
<dd>
<p><code>signature(x = "packedMatrix")</code>: ... </p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Mikael Jagan</p>


<h3>See Also</h3>

<p><code><a href="#unpack">pack</a></code> and <code><a href="#unpack">unpack</a></code>; its virtual "complement"
<code>"<a href="#unpackedMatrix-class">unpackedMatrix</a>"</code>; its proper subclasses
<code>"<a href="#dsyMatrix-class">dspMatrix</a>"</code>, <code>"<a href="#ltrMatrix-class">ltpMatrix</a>"</code>, etc.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"packedMatrix"</span><span class="token punctuation">)</span>
showMethods<span class="token punctuation">(</span>classes <span class="token operator">=</span> <span class="token string">"packedMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pMatrix-class">

<a href="#pMatrix-class" class="help-page-title"><h2 id="pMatrix-class">Permutation matrices</h2></a>

<h3>Description</h3>

<p>The <code>pMatrix</code> class is the class of <em>permutation</em> matrices,
stored as 1-based integer permutation vectors.  A permutation
matrix is a square matrix whose rows <em>and</em> columns are all
standard unit vectors.  It follows that permutation matrices are
a special case of <em>index</em> matrices (hence <code>pMatrix</code>
is defined as a direct subclass of <code><a href="#indMatrix-class">indMatrix</a></code>).
</p>
<p>Multiplying a matrix on the left by a permutation matrix is
equivalent to permuting its rows.  Analogously, multiplying a
matrix on the right by a permutation matrix is equivalent to
permuting its columns.  Indeed, such products are implemented in
<span class="pkg">Matrix</span> as indexing operations; see ‘Details’ below.
</p>


<h3>Details</h3>

<p>By definition, a permutation matrix is both a row index matrix
and a column index matrix.  However, the <code>perm</code> slot of
a <code>pMatrix</code> cannot be used interchangeably as a row index
vector and column index vector.  If <code>margin=1</code>, then
<code>perm</code> is a row index vector, and the corresponding column
index vector can be computed as <code><a href="#invPerm">invPerm</a>(perm)</code>, i.e.,
by inverting the permutation.  Analogously, if <code>margin=2</code>,
then <code>perm</code> and <code>invPerm(perm)</code> are column and row
index vectors, respectively.
</p>
<p>Given an <code>n</code>-by-<code>n</code> row permutation matrix <code>P</code>
with <code>perm</code> slot <code>p</code> and a matrix <code>M</code> with
conformable dimensions, we have
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">P M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">PM</span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>P %*% M</code>        </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M[p, ]</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">M P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">MP</span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M %*% P</code>        </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M[, i(p)]</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>P</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>M</mi></mrow><annotation encoding="application/x-tex">P'M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>crossprod(P, M)</code>  </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M[i(p), ]</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><msup><mi>P</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">MP'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>tcrossprod(M, P)</code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>M[, p]</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>P</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>P</mi></mrow><annotation encoding="application/x-tex">P'P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>crossprod(P)</code>     </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>Diagonal(n)</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msup><mi>P</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">PP'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code> </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>tcrossprod(P)</code>    </td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"> <code>Diagonal(n)</code>
  </td>
</tr>
</table>
<p>where <code>i := invPerm</code>.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created explicitly with calls of the form
<code>new("pMatrix", ...)</code>, but they are more commonly created
by coercing 1-based integer index vectors, with calls of the
form <code>as(., "pMatrix")</code>; see ‘Methods’ below.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>margin</code>,<code>perm</code>
</dt>
<dd>
<p>inherited from superclass
<code><a href="#indMatrix-class">indMatrix</a></code>.  Here, <code>perm</code> is an
integer vector of length <code>Dim[1]</code> and a permutation
of <code>1:Dim[1]</code></p>
</dd>
</dl>
<p>.
</p>
<dl>
<dt>
<code>Dim</code>,<code>Dimnames</code>
</dt>
<dd>
<p>inherited from virtual
superclass <code><a href="#Matrix-class">Matrix</a></code>.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"<a href="#indMatrix-class">indMatrix</a>"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt><code>%*%</code></dt>
<dd>
<p><code>signature(x = "pMatrix", y = "Matrix")</code>
and others listed by <code>showMethods("%*%", classes = "pMatrix")</code>:
matrix products implemented where appropriate as indexing operations.</p>
</dd>
<dt><code>coerce</code></dt>
<dd>
<p><code>signature(from = "numeric", to = "pMatrix")</code>:
supporting typical <code>pMatrix</code> construction from a vector
of positive integers, specifically a permutation of <code>1:n</code>.
Row permutation is assumed.</p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "pMatrix")</code>:
the transpose, which is a <code>pMatrix</code> with identical
<code>perm</code> but opposite <code>margin</code>.  Coincides with
the inverse, as permutation matrices are orthogonal.</p>
</dd>
<dt>solve</dt>
<dd>
<p><code>signature(a = "pMatrix", b = "missing")</code>:
the inverse permutation matrix, which is a <code>pMatrix</code>
with identical <code>perm</code> but opposite <code>margin</code>.
Coincides with the transpose, as permutation matrices are
orthogonal.  See <code>showMethods("solve", classes = "pMatrix")</code>
for more signatures.</p>
</dd>
<dt>determinant</dt>
<dd>
<p><code>signature(x = "pMatrix", logarithm = "logical")</code>:
always returning 1 or -1, as permutation matrices are orthogonal.  
In fact, the result is exactly the <em>sign</em> of the permutation.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Superclass <code><a href="#indMatrix-class">indMatrix</a></code> of index matrices,
for many inherited methods; <code><a href="#invPerm">invPerm</a></code>, for computing
inverse permutation vectors.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>pm1 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>as.integer<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"pMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
t<span class="token punctuation">(</span>pm1<span class="token punctuation">)</span> <span class="token comment"># is the same as</span>
solve<span class="token punctuation">(</span>pm1<span class="token punctuation">)</span>
pm1 <span class="token percent-operator operator">%*%</span> t<span class="token punctuation">(</span>pm1<span class="token punctuation">)</span> <span class="token comment"># check that the transpose is the inverse</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">==</span> as<span class="token punctuation">(</span>pm1 <span class="token percent-operator operator">%*%</span> t<span class="token punctuation">(</span>pm1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          is.logical<span class="token punctuation">(</span>as<span class="token punctuation">(</span>pm1<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

set.seed<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
<span class="token comment">## random permutation matrix :</span>
<span class="token punctuation">(</span>p10 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"pMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Permute rows / columns of a numeric matrix :</span>
<span class="token punctuation">(</span>mm <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>array<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
mm <span class="token percent-operator operator">%*%</span> pm1
pm1 <span class="token percent-operator operator">%*%</span> mm
try<span class="token punctuation">(</span>as<span class="token punctuation">(</span>as.integer<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"pMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Error: not a permutation</span>

as<span class="token punctuation">(</span>pm1<span class="token punctuation">,</span> <span class="token string">"TsparseMatrix"</span><span class="token punctuation">)</span>
p10<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token comment"># gives an "ngTMatrix" (most economic!)</span>

<span class="token comment">## row-indexing of a &lt;pMatrix&gt; keeps it as an &lt;indMatrix&gt;:</span>
p10<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="printSpMatrix">

<a href="#printSpMatrix" class="help-page-title"><h2 id="printSpMatrix">Format and Print Sparse Matrices Flexibly</h2></a>

<h3>Description</h3>

<p>Format and print sparse matrices flexibly.  These are the “workhorses” used by
the <code><a href="https://r-universe.dev/manuals/base.html#format">format</a></code>, <code><a href="https://r-universe.dev/manuals/methods.html#show">show</a></code> and <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code>
methods for sparse matrices.  If <code>x</code> is large,
<code>printSpMatrix2(x)</code> calls <code>printSpMatrix()</code> twice, namely,
for the first and the last few rows, suppressing those in between, and
also suppresses columns when <code>x</code> is too wide.
</p>
<p><code>printSpMatrix()</code> basically prints the result of
<code>formatSpMatrix()</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">formatSpMatrix<span class="token punctuation">(</span>x<span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> maxp <span class="token operator">=</span> <span class="token number">1e9</span><span class="token punctuation">,</span>
               cld <span class="token operator">=</span> getClassDef<span class="token punctuation">(</span>class<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> zero.print <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">,</span>
               col.names<span class="token punctuation">,</span> note.dropping.colnames <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> uniDiag <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
               align <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"fancy"</span><span class="token punctuation">,</span> <span class="token string">"right"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

printSpMatrix<span class="token punctuation">(</span>x<span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> maxp <span class="token operator">=</span> max<span class="token punctuation">(</span><span class="token number">100L</span><span class="token punctuation">,</span> getOption<span class="token punctuation">(</span><span class="token string">"max.print"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              cld <span class="token operator">=</span> getClassDef<span class="token punctuation">(</span>class<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              zero.print <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">,</span> col.names<span class="token punctuation">,</span> note.dropping.colnames <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
              uniDiag <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col.trailer <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
              align <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"fancy"</span><span class="token punctuation">,</span> <span class="token string">"right"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

printSpMatrix2<span class="token punctuation">(</span>x<span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> maxp <span class="token operator">=</span> max<span class="token punctuation">(</span><span class="token number">100L</span><span class="token punctuation">,</span> getOption<span class="token punctuation">(</span><span class="token string">"max.print"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              zero.print <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">,</span> col.names<span class="token punctuation">,</span> note.dropping.colnames <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
              uniDiag <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> suppRows <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> suppCols <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
              col.trailer <span class="token operator">=</span> <span class="token keyword">if</span><span class="token punctuation">(</span>suppCols<span class="token punctuation">)</span> <span class="token string">"......"</span> <span class="token keyword">else</span> <span class="token string">""</span><span class="token punctuation">,</span>
              align <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"fancy"</span><span class="token punctuation">,</span> <span class="token string">"right"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              width <span class="token operator">=</span> getOption<span class="token punctuation">(</span><span class="token string">"width"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fitWidth <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="printSpMatrix_:_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object inheriting from class <code><a href="#sparseMatrix-class">sparseMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_digits">digits</code></td>
<td>
<p>significant digits to use for printing, see
<code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>, the default, <code><a href="https://r-universe.dev/manuals/base.html#NULL">NULL</a></code>,
corresponds to using <code><a href="https://r-universe.dev/manuals/base.html#options">getOption</a>("digits")</code>.</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_maxp">maxp</code></td>
<td>
<p>integer, default from <code><a href="https://r-universe.dev/manuals/base.html#options">options</a>(max.print)</code>,
influences how many entries of large matrices are printed at all.
Typically should not be smaller than around 1000; values smaller than
100 are silently “rounded up” to 100.</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_cld">cld</code></td>
<td>
<p>the class definition of <code>x</code>; must be equivalent to
<code><a href="https://r-universe.dev/manuals/methods.html#getClass">getClassDef</a>(class(x))</code> and exists mainly for possible
speedup.</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_zero.print">zero.print</code></td>
<td>
<p>character which should be printed for
<em>structural</em> zeroes.  The default <code>"."</code> may occasionally
be replaced by <code>" "</code> (blank); using <code>"0"</code> would look
almost like <code>print()</code>ing of non-sparse matrices.</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_col.names">col.names</code></td>
<td>
<p>logical or string specifying if and how column names of
<code>x</code> should be printed, possibly abbreviated.  The default is
taken from <code><a href="https://r-universe.dev/manuals/base.html#options">options</a>("sparse.colnames")</code> if that is set, otherwise
<code>FALSE</code> unless there are less than ten columns.  When
<code>TRUE</code> the full column names are printed.<br>
When <code>col.names</code> is a string beginning with <code>"abb"</code> or
<code>"sub"</code> and ending with an integer <code>n</code> (i.e., of the form
<code>"abb... &lt;n&gt;"</code>),
the column names are <code><a href="https://r-universe.dev/manuals/base.html#abbreviate">abbreviate</a>()</code>d or
<code><a href="https://r-universe.dev/manuals/base.html#substr">substring</a>()</code>ed to (target) length <code>n</code>, see the examples.
</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_note.dropping.colnames">note.dropping.colnames</code></td>
<td>
<p>logical specifying, when
<code>col.names</code> is <code>FALSE</code> if the dropping of the column names
should be noted, <code>TRUE</code> by default.</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_uniDiag">uniDiag</code></td>
<td>
<p>logical indicating if the diagonal entries of a sparse
unit triangular or unit-diagonal matrix should be formatted as
<code>"I"</code> instead of <code>"1"</code> (to emphasize that the 1's are
“structural”).</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_col.trailer">col.trailer</code></td>
<td>
<p>a string to be appended to the right of each
column; this is typically made use of by <code><a href="https://r-universe.dev/manuals/methods.html#show">show</a>(&lt;sparseMatrix&gt;)</code>
only, when suppressing columns.</p>
</td>
</tr>
<tr>
<td>
<code id="printSpMatrix_:_suppRows">suppRows</code>, <code id="printSpMatrix_:_suppCols">suppCols</code>
</td>
<td>
<p>logicals or <code>NULL</code>, for
<code>printSpMatrix2()</code> specifying if rows or columns should be
suppressed in printing.  If <code>NULL</code>, sensible defaults are
determined from <code><a href="https://r-universe.dev/manuals/base.html#dim">dim</a>(x)</code> and
<code><a href="https://r-universe.dev/manuals/base.html#options">options</a>(c("width", "max.print"))</code>.
Setting both to <code>FALSE</code> may be a very bad idea.</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_align">align</code></td>
<td>
<p>a string specifying how the <code>zero.print</code> codes
should be aligned, i.e., padded as strings.  The default,
<code>"fancy"</code>, takes some effort to align the typical
<code>zero.print = "."</code> with the position of <code>0</code>, i.e., the
first decimal (one left of decimal point) of the numbers printed,
whereas <code>align = "right"</code> just makes use of
<code><a href="https://r-universe.dev/manuals/base.html#print">print</a>(*, right = TRUE)</code>.</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_width">width</code></td>
<td>
<p>number, a positive integer, indicating the approximately
desired (line) width of the output, see also <code>fitWidth</code>.</p>
</td>
</tr>
<tr>
<td><code id="printSpMatrix_:_fitWidth">fitWidth</code></td>
<td>
<p>logical indicating if some effort should be made to
match the desired <code>width</code> or temporarily enlarge that if deemed
necessary.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>formatSpMatrix:</dt>
<dd>
<p>If <code>x</code> is large, only the first rows making up the
approximately first <code>maxp</code> entries is used, otherwise all of <code>x</code>.
<code><a href="#formatSparseM">.formatSparseSimple</a>()</code> is applied to (a dense version
of) the matrix.  Then, <code><a href="#formatSparseM">formatSparseM</a></code> is used, unless
in trivial cases or for sparse matrices without <code>x</code> slot.</p>
</dd>
</dl>
<h3>Value</h3>

<table>
<tr>
<td><code>formatSpMatrix()</code></td>
<td>
<p>returns a character matrix with possibly empty
column names, depending on <code>col.names</code> etc, see above.</p>
</td>
</tr>
<tr>
<td><code>printSpMatrix*()</code></td>
<td>
<p>return <code>x</code> <em>invisibly</em>, see <code><a href="https://r-universe.dev/manuals/base.html#invisible">invisible</a></code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p>the virtual class <code><a href="#sparseMatrix-class">sparseMatrix</a></code> and the
classes extending it;  maybe <code><a href="#sparseMatrix">sparseMatrix</a></code> or
<code><a href="#spMatrix">spMatrix</a></code> as simple constructors of such matrices.
</p>
<p>The underlying utilities <code><a href="#formatSparseM">formatSparseM</a></code> and
<code>.formatSparseSimple()</code> (on the same page).
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">f1 <span class="token operator">&lt;-</span> gl<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
X <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span>
X <span class="token comment">## &lt;==&gt;  show(X)  &lt;==&gt;  print(X)</span>
t<span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token comment">## shows column names, since only 5 columns</span>

X2 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>gl<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> paste<span class="token punctuation">(</span>LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"c"</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span>
X2
<span class="token comment">## less nice, but possible:</span>
print<span class="token punctuation">(</span>X2<span class="token punctuation">,</span> col.names <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># use [,1] [,2] .. =&gt; does not fit</span>

<span class="token comment">## Possibilities with column names printing:</span>
      t<span class="token punctuation">(</span>X2<span class="token punctuation">)</span> <span class="token comment"># suppressing column names</span>
print<span class="token punctuation">(</span>t<span class="token punctuation">(</span>X2<span class="token punctuation">)</span><span class="token punctuation">,</span> col.names<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>t<span class="token punctuation">(</span>X2<span class="token punctuation">)</span><span class="token punctuation">,</span> zero.print <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> col.names<span class="token operator">=</span><span class="token string">"abbr. 1"</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>t<span class="token punctuation">(</span>X2<span class="token punctuation">)</span><span class="token punctuation">,</span> zero.print <span class="token operator">=</span> <span class="token string">"-"</span><span class="token punctuation">,</span> col.names<span class="token operator">=</span><span class="token string">"substring 2"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="qr-methods">

<a href="#qr-methods" class="help-page-title"><h2 id="qr-methods">Methods for QR Factorization</h2></a>

<h3>Description</h3>

<p>Computes the pivoted QR factorization of an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
real matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, which has the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><mi>Q</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">P_{1} A P_{2} = Q R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>Q</mi><mi>R</mi><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">A = P_{1}' Q R P_{2}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are permutation matrices,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>H</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">Q = \prod_{j = 1}^{n} H_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2401em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code>
is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> orthogonal matrix
equal to the product of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> Householder matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">H_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code>, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code> is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> upper trapezoidal matrix.
</p>
<p><code><a href="#denseMatrix-class">denseMatrix</a></code> use the default method implemented
in <span class="pkg">base</span>, namely <code><a href="https://r-universe.dev/manuals/base.html#qr">qr.default</a></code>.  It is built on
LINPACK routine <code>dqrdc</code> and LAPACK routine <code>dgeqp3</code>, which
do not pivot rows, so that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is an identity matrix.
</p>
<p>Methods for <code><a href="#sparseMatrix-class">sparseMatrix</a></code> are built on
CSparse routines <code>cs_sqr</code> and <code>cs_qr</code>, which require
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≥</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \ge n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">qr<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dgCMatrix'</span>
qr<span class="token punctuation">(</span>x<span class="token punctuation">,</span> order <span class="token operator">=</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="qr-methods_:_x">x</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a> matrix or
<code><a href="#Matrix-class">Matrix</a></code> to be factorized,
satisfying <code>nrow(x) &gt;= ncol(x)</code> if sparse.</p>
</td>
</tr>
<tr>
<td><code id="qr-methods_:_order">order</code></td>
<td>
<p>an integer in <code>0:3</code> passed to CSparse routine
<code>cs_sqr</code>, indicating a strategy for choosing the column
permutation <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.  0 means no column permutation.
1, 2, and 3 indicate a fill-reducing ordering of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>+</mo><msup><mi>A</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A + A'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>A</mi><mo>~</mo></mover><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mover accent="true"><mi>A</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{A}' \tilde{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span></code>, and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>A</mi></mrow><annotation encoding="application/x-tex">A' A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span></span></span></span></code>,
where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span></code> is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> with “dense” rows
removed.
Do not set to 0 unless you know that the column order of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>
is already sensible.</p>
</td>
</tr>
<tr>
<td><code id="qr-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> is sparse and structurally rank deficient, having
structural rank <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">r &lt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, then <code>x</code> is augmented with
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n-r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></code> rows of (partly non-structural) zeros, such that
the augmented matrix has structural rank <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>.
This augmented matrix is factorized as described above:
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><mi>Q</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">P_1 A P_2 = P_1 \begin{bmatrix} A_{0} \\ 0 \end{bmatrix} P_2 = Q R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span></span></span></span></code>
</p>

<p>where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">A_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> denotes the original, user-supplied
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo>−</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">(m-(n-r)) \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> matrix.
</p>


<h3>Value</h3>

<p>An object representing the factorization, inheriting from
virtual S4 class <code><a href="#MatrixFactorization-class">QR</a></code> or S3 class
<code><a href="https://r-universe.dev/manuals/base.html#qr">qr</a></code>.  The specific class is <code>qr</code>
unless <code>x</code> inherits from virtual class
<code><a href="#sparseMatrix-class">sparseMatrix</a></code>, in which case it is
<code><a href="#sparseQR-class">sparseQR</a></code>.
</p>


<h3>References</h3>

<p>Davis, T. A. (2006).
<em>Direct methods for sparse linear systems</em>.
Society for Industrial and Applied Mathematics.
<a href="https://doi.org/10.1137/1.9780898718881" target="_blank">doi:10.1137/1.9780898718881</a>
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Class <code><a href="#sparseQR-class">sparseQR</a></code> and its methods.
</p>
<p>Class <code><a href="#dgCMatrix-class">dgCMatrix</a></code>.
</p>
<p>Generic function <code><a href="https://r-universe.dev/manuals/base.html#qr">qr</a></code> from <span class="pkg">base</span>,
whose default method <code>qr.default</code> “defines”
the S3 class <code>qr</code> of dense QR factorizations.
</p>
<p>Generic functions <code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>,
for constructing matrix factors from the result.
</p>
<p>Generic functions <code><a href="#Cholesky">Cholesky</a></code>, <code><a href="#BunchKaufman-methods">BunchKaufman</a></code>,
<code><a href="#Schur">Schur</a></code>, and <code><a href="#lu">lu</a></code>,
for computing other factorizations.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span><span class="token string">"qr"</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment">## Rank deficient: columns 3 {b2} and 6 {c3} are "extra"</span>
M <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>a1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
              b1 <span class="token operator">=</span> rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> each <span class="token operator">=</span> <span class="token number">3L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              b2 <span class="token operator">=</span> rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> each <span class="token operator">=</span> <span class="token number">3L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              c1 <span class="token operator">=</span> rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              c2 <span class="token operator">=</span> rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              c3 <span class="token operator">=</span> rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span>
rownames<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>nrow<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
b <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span>
eps <span class="token operator">&lt;-</span> .Machine<span class="token operator">$</span>double.eps

<span class="token comment">## .... [1] full rank ..................................................</span>
<span class="token comment">## ===&gt; a least squares solution of A x = b exists</span>
<span class="token comment">##      and is unique _in exact arithmetic_</span>

<span class="token punctuation">(</span>A1 <span class="token operator">&lt;-</span> M<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token operator">-</span>c<span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">6L</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>qr.A1 <span class="token operator">&lt;-</span> qr<span class="token punctuation">(</span>A1<span class="token punctuation">)</span><span class="token punctuation">)</span>

stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    rankMatrix<span class="token punctuation">(</span>A1<span class="token punctuation">)</span> <span class="token operator">==</span> ncol<span class="token punctuation">(</span>A1<span class="token punctuation">)</span>
    <span class="token punctuation">{</span> d1 <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span>qr.A1<span class="token operator">@</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span> sum<span class="token punctuation">(</span>d1 <span class="token operator">&lt;</span> max<span class="token punctuation">(</span>d1<span class="token punctuation">)</span> <span class="token operator">*</span> eps<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0L</span> <span class="token punctuation">}</span>
    rcond<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>A1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> eps
    all.equal<span class="token punctuation">(</span>qr.coef<span class="token punctuation">(</span>qr.A1<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> drop<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>A1<span class="token punctuation">)</span><span class="token punctuation">,</span> crossprod<span class="token punctuation">(</span>A1<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>qr.fitted<span class="token punctuation">(</span>qr.A1<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> qr.resid<span class="token punctuation">(</span>qr.A1<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## .... [2] numerically rank deficient with full structural rank .......</span>
<span class="token comment">## ===&gt; a least squares solution of A x = b does not</span>
<span class="token comment">##      exist or is not unique _in exact arithmetic_</span>

<span class="token punctuation">(</span>A2 <span class="token operator">&lt;-</span> M<span class="token punctuation">)</span>
<span class="token punctuation">(</span>qr.A2 <span class="token operator">&lt;-</span> qr<span class="token punctuation">(</span>A2<span class="token punctuation">)</span><span class="token punctuation">)</span>

stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    rankMatrix<span class="token punctuation">(</span>A2<span class="token punctuation">)</span> <span class="token operator">==</span> ncol<span class="token punctuation">(</span>A2<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2L</span>
    <span class="token punctuation">{</span> d2 <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span>qr.A2<span class="token operator">@</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span> sum<span class="token punctuation">(</span>d2 <span class="token operator">&lt;</span> max<span class="token punctuation">(</span>d2<span class="token punctuation">)</span> <span class="token operator">*</span> eps<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2L</span> <span class="token punctuation">}</span>
    rcond<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>A2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps

    <span class="token comment">## 'qr.coef' computes unique least squares solution of "nearby" problem</span>
    <span class="token comment">## Z x = b for some full rank Z ~ A, currently without warning {FIXME} !</span>
    tryCatch<span class="token punctuation">(</span><span class="token punctuation">{</span> qr.coef<span class="token punctuation">(</span>qr.A2<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token boolean">TRUE</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> condition <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

    all.equal<span class="token punctuation">(</span>qr.fitted<span class="token punctuation">(</span>qr.A2<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> qr.resid<span class="token punctuation">(</span>qr.A2<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## .... [3] numerically and structurally rank deficient ................</span>
<span class="token comment">## ===&gt; factorization of _augmented_ matrix with</span>
<span class="token comment">##      full structural rank proceeds as in [2]</span>

<span class="token comment">##  NB: implementation details are subject to change; see (*) below</span>

A3 <span class="token operator">&lt;-</span> M
A3<span class="token punctuation">[</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">,</span> <span class="token number">6L</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
A3
<span class="token punctuation">(</span>qr.A3 <span class="token operator">&lt;-</span> qr<span class="token punctuation">(</span>A3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># with a warning ... "additional 2 row(s) of zeros"</span>

stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">## sparseQR object preserves the unaugmented dimensions (*)</span>
    dim<span class="token punctuation">(</span>qr.A3  <span class="token punctuation">)</span> <span class="token operator">==</span> dim<span class="token punctuation">(</span>A3<span class="token punctuation">)</span>
    dim<span class="token punctuation">(</span>qr.A3<span class="token operator">@</span>V<span class="token punctuation">)</span> <span class="token operator">==</span> dim<span class="token punctuation">(</span>A3<span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">)</span>
    dim<span class="token punctuation">(</span>qr.A3<span class="token operator">@</span>R<span class="token punctuation">)</span> <span class="token operator">==</span> dim<span class="token punctuation">(</span>A3<span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">)</span>

    <span class="token comment">## The augmented matrix remains numerically rank deficient</span>
    rankMatrix<span class="token punctuation">(</span>A3<span class="token punctuation">)</span> <span class="token operator">==</span> ncol<span class="token punctuation">(</span>A3<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2L</span>
    <span class="token punctuation">{</span> d3 <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span>qr.A3<span class="token operator">@</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span> sum<span class="token punctuation">(</span>d3 <span class="token operator">&lt;</span> max<span class="token punctuation">(</span>d3<span class="token punctuation">)</span> <span class="token operator">*</span> eps<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2L</span> <span class="token punctuation">}</span>
    rcond<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>A3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Auxiliary functions accept and return a vector or matrix</span>
<span class="token comment">## with dimensions corresponding to the unaugmented matrix (*),</span>
<span class="token comment">## in all cases with a warning</span>
qr.coef  <span class="token punctuation">(</span>qr.A3<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
qr.fitted<span class="token punctuation">(</span>qr.A3<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
qr.resid <span class="token punctuation">(</span>qr.A3<span class="token punctuation">,</span> b<span class="token punctuation">)</span>

<span class="token comment">## .... [4] yet more examples ..........................................</span>

<span class="token comment">## By disabling column pivoting, one gets the "vanilla" factorization</span>
<span class="token comment">## A = Q~ R, where Q~ := P1' Q is orthogonal because P1 and Q are</span>

<span class="token punctuation">(</span>qr.A1.pp <span class="token operator">&lt;-</span> qr<span class="token punctuation">(</span>A1<span class="token punctuation">,</span> order <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># partial pivoting</span>

ae1 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
ae2 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> ae1<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> unname<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    length<span class="token punctuation">(</span>qr.A1   <span class="token operator">@</span>q<span class="token punctuation">)</span> <span class="token operator">==</span> ncol<span class="token punctuation">(</span>A1<span class="token punctuation">)</span>
    length<span class="token punctuation">(</span>qr.A1.pp<span class="token operator">@</span>q<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0L</span> <span class="token comment"># indicating no column pivoting</span>
    ae2<span class="token punctuation">(</span>A1<span class="token punctuation">[</span><span class="token punctuation">,</span> qr.A1<span class="token operator">@</span>q <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> qr.Q<span class="token punctuation">(</span>qr.A1   <span class="token punctuation">)</span> <span class="token percent-operator operator">%*%</span> qr.R<span class="token punctuation">(</span>qr.A1   <span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>A1                <span class="token punctuation">,</span> qr.Q<span class="token punctuation">(</span>qr.A1.pp<span class="token punctuation">)</span> <span class="token percent-operator operator">%*%</span> qr.R<span class="token punctuation">(</span>qr.A1.pp<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="rankMatrix">

<a href="#rankMatrix" class="help-page-title"><h2 id="rankMatrix">Rank of a Matrix</h2></a>

<h3>Description</h3>

<p>Compute ‘the’ matrix rank, a well-defined functional in theory(*),
somewhat ambiguous in practice.  We provide several methods, the
default corresponding to Matlab's definition.
</p>
<p>(*) The rank of a <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>k</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">rk(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span></code>,
is the maximal number of linearly independent columns (or rows); hence
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>k</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">rk(A) \le min(n,m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">rankMatrix<span class="token punctuation">(</span>x<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
           method <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"tolNorm2"</span><span class="token punctuation">,</span> <span class="token string">"qr.R"</span><span class="token punctuation">,</span> <span class="token string">"qrLINPACK"</span><span class="token punctuation">,</span> <span class="token string">"qr"</span><span class="token punctuation">,</span>
                      <span class="token string">"useGrad"</span><span class="token punctuation">,</span> <span class="token string">"maybeGrad"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           sval <span class="token operator">=</span> svd<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">$</span>d<span class="token punctuation">,</span> warn.t <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> warn.qr <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

qr2rankMatrix<span class="token punctuation">(</span>qr<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> isBqr <span class="token operator">=</span> is.qr<span class="token punctuation">(</span>qr<span class="token punctuation">)</span><span class="token punctuation">,</span> do.warn <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="rankMatrix_:_x">x</code></td>
<td>
<p>numeric matrix, of dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code>, say.</p>
</td>
</tr>
<tr>
<td><code id="rankMatrix_:_tol">tol</code></td>
<td>
<p>nonnegative number specifying a (relative,
“scalefree”) tolerance for testing of
“practically zero” with specific meaning depending on
<code>method</code>; by default, <code>max(dim(x)) * <a href="https://r-universe.dev/manuals/base.html#zMachine">.Machine</a>$double.eps</code>
is according to Matlab's default (for its only method which is our
<code>method="tolNorm2"</code>).</p>
</td>
</tr>
<tr>
<td><code id="rankMatrix_:_method">method</code></td>
<td>
<p>a character string specifying the computational method
for the rank, can be abbreviated:
</p>

<dl>
<dt>
<code>"tolNorm2"</code>:</dt>
<dd>
<p>the number of singular values
<code>&gt;= tol * max(sval)</code>;</p>
</dd>
<dt>
<code>"qrLINPACK"</code>:</dt>
<dd>
<p>for a dense matrix, this is the rank of
<code><a href="https://r-universe.dev/manuals/base.html#qr">qr</a>(x, tol, LAPACK=FALSE)</code> (which is
<code>qr(...)$rank</code>);
<br>
This ("qr*", dense) version used to be <em>the</em> recommended way to
compute a matrix rank for a while in the past.
</p>
<p>For sparse <code>x</code>, this is equivalent to <code>"qr.R"</code>.
</p>
</dd>
<dt>
<code>"qr.R"</code>:</dt>
<dd>
<p>this is the rank of triangular matrix
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code>, where <code>qr()</code> uses LAPACK or a "sparseQR" method
(see <code><a href="#qr-methods">qr-methods</a></code>) to compute the decomposition
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">QR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span></span></span></span></code>.  The rank of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code> is then defined as the number of
“non-zero” diagonal entries <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code>, and
“non-zero”s fulfill
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>d</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mo>≥</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">l</mi></mrow><mo>⋅</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><msub><mi>d</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">|d_i| \ge \mathrm{tol}\cdot\max(|d_i|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">tol</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mclose">)</span></span></span></span></code>.
</p>
</dd>
<dt>
<code>"qr"</code>:</dt>
<dd>
<p>is for back compatibility; for dense <code>x</code>,
it corresponds to <code>"qrLINPACK"</code>, whereas for sparse
<code>x</code>, it uses <code>"qr.R"</code>.
</p>
<p>For all the "qr*" methods, singular values <code>sval</code> are not
used, which may be crucially important for a large sparse matrix
<code>x</code>, as in that case, when <code>sval</code> is not specified,
the default, computing <code><a href="https://r-universe.dev/manuals/base.html#svd">svd</a>()</code> currently coerces
<code>x</code> to a dense matrix.
</p>
</dd>
<dt>
<code>"useGrad"</code>:</dt>
<dd>
<p>considering the “gradient” of the
(decreasing) singular values, the index of the <em>smallest</em> gap.</p>
</dd>
<dt>
<code>"maybeGrad"</code>:</dt>
<dd>
<p>choosing method <code>"useGrad"</code> only when
that seems <em>reasonable</em>; otherwise using <code>"tolNorm2"</code>.</p>
</dd>

</dl>
</td>
</tr>
<tr>
<td><code id="rankMatrix_:_sval">sval</code></td>
<td>
<p>numeric vector of non-increasing singular values of
<code>x</code>; typically unspecified and computed from <code>x</code> when
needed, i.e., unless <code>method = "qr"</code>.</p>
</td>
</tr>
<tr>
<td><code id="rankMatrix_:_warn.t">warn.t</code></td>
<td>
<p>logical indicating if <code>rankMatrix()</code> should warn
when it needs <code><a href="https://r-universe.dev/manuals/base.html#t">t</a>(x)</code> instead of <code>x</code>.  Currently, for
<code>method = "qr"</code> only, gives a warning by default because the
caller often could have passed <code>t(x)</code> directly, more efficiently.</p>
</td>
</tr>
<tr>
<td><code id="rankMatrix_:_warn.qr">warn.qr</code></td>
<td>
<p>in the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">QR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span></span></span></span></code> cases (i.e., if <code>method</code> starts with
<code>"qr"</code>), <code>rankMatrix()</code> calls
<code>qr2rankMarix(.., do.warn = warn.qr)</code>, see below.</p>
</td>
</tr>
<tr>
<td><code id="rankMatrix_:_qr">qr</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object resulting from <code><a href="#qr-methods">qr</a>(x,..)</code>, i.e.,
typically inheriting from <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> <code>"<a href="#qr-methods">qr</a>"</code> or
<code>"<a href="#sparseQR-class">sparseQR</a>"</code>.</p>
</td>
</tr>
<tr>
<td><code id="rankMatrix_:_isBqr">isBqr</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if <code>qr</code> is resulting
from <span class="pkg">base</span> <code><a href="https://r-universe.dev/manuals/base.html#qr">qr</a>()</code>.  (Otherwise, it is typically
from <span class="pkg">Matrix</span> package sparse <code><a href="#qr-methods">qr</a></code>.)</p>
</td>
</tr>
<tr>
<td><code id="rankMatrix_:_do.warn">do.warn</code></td>
<td>
<p>logical; if true, warn about non-finite (or in the
<code>sparseQR</code> case negative)
diagonal entries in the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code> matrix of the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">QR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span></span></span></span></code> decomposition.
Do not change lightly!</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>qr2rankMatrix()</code> is typically called from <code>rankMatrix()</code> for
the <code>"qr"</code>* <code>method</code>s, but can be used directly - much more
efficiently in case the <code>qr</code>-decomposition is available anyway.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a matrix of all <code>0</code> (or of zero dimension), the rank
is zero; otherwise, typically a positive integer in <code>1:min(dim(x))</code>
with attributes detailing the method used.
</p>
<p>There are rare cases where the sparse <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">QR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span></span></span></span></code> decomposition
“fails” in so far as the diagonal entries of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code>, the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> (see above), end with non-finite, typically <code><a href="https://r-universe.dev/manuals/base.html#is.finite">NaN</a></code>
entries.  Then, a warning is signalled (unless <code>warn.qr</code> /
<code>do.warn</code> is not true) and <code>NA</code> (specifically,
<code><a href="https://r-universe.dev/manuals/base.html#NA">NA_integer_</a></code>) is returned.
</p>


<h3>Note</h3>

<p>For large sparse matrices <code>x</code>, unless you can specify
<code>sval</code> yourself, currently <code>method = "qr"</code> may
be the only feasible one, as the others need <code>sval</code> and call
<code><a href="https://r-universe.dev/manuals/base.html#svd">svd</a>()</code> which currently coerces <code>x</code> to a
<code><a href="#denseMatrix-class">denseMatrix</a></code> which may be very slow or impossible,
depending on the matrix dimensions.
</p>
<p>Note that in the case of sparse <code>x</code>, <code>method = "qr"</code>, all
non-strictly zero diagonal entries <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> where counted, up to
including <span class="pkg">Matrix</span> version 1.1-0, i.e., that method implicitly
used <code>tol = 0</code>, see also the <code>set.seed(42)</code> example below.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler; for the "*Grad" methods building on
suggestions by Ravi Varadhan.
</p>


<h3>See Also</h3>

<p><code><a href="#qr-methods">qr</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#svd">svd</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rankMatrix<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 2</span>

<span class="token punctuation">(</span>meths <span class="token operator">&lt;-</span> eval<span class="token punctuation">(</span>formals<span class="token punctuation">(</span>rankMatrix<span class="token punctuation">)</span><span class="token operator">$</span>method<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## a "border" case:</span>
H12 <span class="token operator">&lt;-</span> Hilbert<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
rankMatrix<span class="token punctuation">(</span>H12<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">1e-20</span><span class="token punctuation">)</span> <span class="token comment"># 12;  but  11  with default method &amp; tol.</span>
sapply<span class="token punctuation">(</span>meths<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>.m.<span class="token punctuation">)</span> rankMatrix<span class="token punctuation">(</span>H12<span class="token punctuation">,</span> method <span class="token operator">=</span> .m.<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## tolNorm2   qr.R  qrLINPACK   qr  useGrad maybeGrad</span>
<span class="token comment">##       11     11         12   12       11        11</span>
<span class="token comment">## The meaning of 'tol' for method="qrLINPACK" and *dense* x is not entirely "scale free"</span>
rMQL <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>ex<span class="token punctuation">,</span> M<span class="token punctuation">)</span> rankMatrix<span class="token punctuation">(</span>M<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"qrLINPACK"</span><span class="token punctuation">,</span>tol <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">^</span><span class="token operator">-</span>ex<span class="token punctuation">)</span>
rMQR <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>ex<span class="token punctuation">,</span> M<span class="token punctuation">)</span> rankMatrix<span class="token punctuation">(</span>M<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"qr.R"</span><span class="token punctuation">,</span>     tol <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">^</span><span class="token operator">-</span>ex<span class="token punctuation">)</span>
sapply<span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">,</span> rMQL<span class="token punctuation">,</span> M <span class="token operator">=</span> H12<span class="token punctuation">)</span> <span class="token comment"># result is platform dependent</span>
<span class="token comment">##  7  7  8 10 10 11 11 11 12 12 12  {x86_64}</span>
sapply<span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">,</span> rMQL<span class="token punctuation">,</span> M <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> H12<span class="token punctuation">)</span> <span class="token comment"># not identical unfortunately</span>
<span class="token comment">##  7  7  8 10 11 11 12 12 12 12 12</span>
sapply<span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">,</span> rMQR<span class="token punctuation">,</span> M <span class="token operator">=</span> H12<span class="token punctuation">)</span>
<span class="token comment">##  5  6  7  8  8  9  9 10 10 11 11</span>
sapply<span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">,</span> rMQR<span class="token punctuation">,</span> M <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> H12<span class="token punctuation">)</span> <span class="token comment"># the *same*</span>


<span class="token comment">## "sparse" case:</span>
M15 <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>diag<span class="token punctuation">(</span>x<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Hilbert<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sapply<span class="token punctuation">(</span>meths<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>.m.<span class="token punctuation">)</span> rankMatrix<span class="token punctuation">(</span>M15<span class="token punctuation">,</span> method <span class="token operator">=</span> .m.<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#--&gt; all 15, but 'useGrad' has 14.</span>
sapply<span class="token punctuation">(</span>meths<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>.m.<span class="token punctuation">)</span> rankMatrix<span class="token punctuation">(</span>M15<span class="token punctuation">,</span> method <span class="token operator">=</span> .m.<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">1e-7</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># all 14</span>

<span class="token comment">## "large" sparse</span>
n <span class="token operator">&lt;-</span> <span class="token number">250000</span><span class="token punctuation">;</span> p <span class="token operator">&lt;-</span> <span class="token number">33</span><span class="token punctuation">;</span> nnz <span class="token operator">&lt;-</span> <span class="token number">10000</span>
L <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i <span class="token operator">=</span> sample.int<span class="token punctuation">(</span>n<span class="token punctuation">,</span> nnz<span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  j <span class="token operator">=</span> sample.int<span class="token punctuation">(</span>p<span class="token punctuation">,</span> nnz<span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  x <span class="token operator">=</span> rnorm<span class="token punctuation">(</span>nnz<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>st1 <span class="token operator">&lt;-</span> system.time<span class="token punctuation">(</span>r1 <span class="token operator">&lt;-</span> rankMatrix<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment"># warning+ ~1.5 sec (2013)</span>
<span class="token punctuation">(</span>st2 <span class="token operator">&lt;-</span> system.time<span class="token punctuation">(</span>r2 <span class="token operator">&lt;-</span> rankMatrix<span class="token punctuation">(</span>L<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"qr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># considerably faster!</span>
r1<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> print<span class="token punctuation">(</span>r2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">## --&gt;  ( 33  TRUE )</span>

<span class="token comment">## another sparse-"qr" one, which ``failed'' till 2013-11-23:</span>
set.seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
f1 <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f2 <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f3 <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>sample<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
D <span class="token operator">&lt;-</span> t<span class="token punctuation">(</span>do.call<span class="token punctuation">(</span>rbind<span class="token punctuation">,</span> lapply<span class="token punctuation">(</span>list<span class="token punctuation">(</span>f1<span class="token punctuation">,</span>f2<span class="token punctuation">,</span>f3<span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">,</span> <span class="token string">'sparseMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dim<span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">;</span> nnzero<span class="token punctuation">(</span>D<span class="token punctuation">)</span> <span class="token comment">## 1000 x 150 // 3000 non-zeros (= 2%)</span>
stopifnot<span class="token punctuation">(</span>rankMatrix<span class="token punctuation">(</span>D<span class="token punctuation">,</span>           method<span class="token operator">=</span><span class="token string">'qr'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">148</span><span class="token punctuation">,</span>
	  rankMatrix<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">,</span>method<span class="token operator">=</span><span class="token string">'qr'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">148</span><span class="token punctuation">)</span>

<span class="token comment">## zero matrix has rank 0 :</span>
stopifnot<span class="token punctuation">(</span>sapply<span class="token punctuation">(</span>meths<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>.m.<span class="token punctuation">)</span>
                        rankMatrix<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> method <span class="token operator">=</span> .m.<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="rcond">

<a href="#rcond" class="help-page-title"><h2 id="rcond-methods">Estimate the Reciprocal Condition Number</h2></a>

<h3>Description</h3>

<p>Estimate the reciprocal of the condition number of a matrix.
</p>
<p>This is a generic function with several methods, as seen by
<code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(rcond)</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">rcond<span class="token punctuation">(</span>x<span class="token punctuation">,</span> norm<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S4 method for signature 'sparseMatrix,character'</span>
rcond<span class="token punctuation">(</span>x<span class="token punctuation">,</span> norm<span class="token punctuation">,</span> useInv<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="rcond-methods_:_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object that inherits from the <code>Matrix</code> class.</p>
</td>
</tr>
<tr>
<td><code id="rcond-methods_:_norm">norm</code></td>
<td>
<p>character string indicating the type of norm to be used in
the estimate. The default is <code>"O"</code> for the 1-norm (<code>"O"</code> is
equivalent to <code>"1"</code>).  For sparse matrices, when <code>useInv=TRUE</code>,
<code>norm</code> can be any of the <code>kind</code>s allowed for <code><a href="#norm">norm</a></code>;
otherwise, the other possible value is <code>"I"</code> for the infinity
norm, see also <code><a href="#norm">norm</a></code>.
</p>
</td>
</tr>
<tr>
<td><code id="rcond-methods_:_useInv">useInv</code></td>
<td>
<p>logical (or <code>"Matrix"</code> containing
<code><a href="#solve-methods">solve</a>(x)</code>).  If not false, compute the reciprocal
condition number as <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∥</mi><mi>x</mi><mi mathvariant="normal">∥</mi><mo>⋅</mo><mi mathvariant="normal">∥</mi><msup><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">∥</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1/(\|x\| \cdot \|x^{-1}\|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mopen">(</span><span class="mord">∥</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">∥</span><span class="mclose">)</span></span></span></span></code>,
where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">x^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></code> is the inverse of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code>, <code>solve(x)</code>.
</p>
<p>This may be an efficient alternative (only) in situations where
<code>solve(x)</code> is fast (or known), e.g., for (very) sparse or
triangular matrices.
</p>
<p>Note that the <em>result</em> may differ depending on <code>useInv</code>,
as per default, when it is false, an <em>approximation</em> is
computed.
</p>
</td>
</tr>
<tr>
<td><code id="rcond-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An estimate of the reciprocal condition number of <code>x</code>.
</p>


<h3>BACKGROUND</h3>

<p>The condition number of a regular (square) matrix is the product of
the <code><a href="#norm">norm</a></code> of the matrix and the norm of its inverse (or
pseudo-inverse).
</p>
<p>More generally, the condition number is defined (also for
non-square matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>) as
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi mathvariant="normal">∥</mi><mi>v</mi><mi mathvariant="normal">∥</mi><mo>=</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∥</mi><mi>A</mi><mi>v</mi><mi mathvariant="normal">∥</mi></mrow><mrow><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi mathvariant="normal">∥</mi><mi>v</mi><mi mathvariant="normal">∥</mi><mo>=</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∥</mi><mi>A</mi><mi>v</mi><mi mathvariant="normal">∥</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\kappa(A) = \frac{\max_{\|v\| = 1} \|A v\|}{\min_{\|v\| = 1} \|A v\|}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">κ</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6973em;vertical-align:-0.6036em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0936em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">∥</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mtight">∥</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3695em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight">∥</span><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mtight">∥</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5686em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">∥</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mtight">∥</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3695em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight">∥</span><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mtight">∥</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6036em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></code>
</p>

<p>Whenever <code>x</code> is <em>not</em> a square matrix, in our method
definitions, this is typically computed via <code>rcond(qr.R(qr(X)), ...)</code>
where <code>X</code> is <code>x</code> or <code>t(x)</code>.
</p>
<p>The condition number takes on values between 1 and infinity,
inclusive, and can be viewed as a factor by which errors in solving
linear systems with this matrix as coefficient matrix could be
magnified.
</p>
<p><code>rcond()</code> computes the <em>reciprocal</em> condition number
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>κ</mi></mrow><annotation encoding="application/x-tex">1/\kappa</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord mathnormal">κ</span></span></span></span></code> with values in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code> and can be viewed as a
scaled measure of how close a matrix is to being rank deficient (aka
“singular”).
</p>
<p>Condition numbers are usually estimated, since exact computation is
costly in terms of floating-point operations.  An (over) estimate of
reciprocal condition number is given, since by doing so overflow is
avoided.  Matrices are well-conditioned if the reciprocal condition
number is near 1 and ill-conditioned if it is near zero.
</p>


<h3>References</h3>

<p>Golub, G., and Van Loan, C. F. (1989).
<em>Matrix Computations,</em>
2nd edition, Johns Hopkins, Baltimore.
</p>


<h3>See Also</h3>

<p><code><a href="#norm">norm</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#kappa">kappa</a>()</code> from package
<span class="pkg">base</span> computes an <em>approximate</em> condition number of a
“traditional” matrix, even non-square ones, with respect to the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">p=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code> (Euclidean) <code><a href="#norm">norm</a></code>.
<code><a href="https://r-universe.dev/manuals/base.html#solve">solve</a></code>.
</p>
<p><code><a href="#condest">condest</a></code>, a newer <em>approximate</em> estimate of
the (1-norm) condition number, particularly efficient for large sparse
matrices.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">x <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
rcond<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">## typically "the same" (with more computational effort):</span>
<span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>norm<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> norm<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
rcond<span class="token punctuation">(</span>Hilbert<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># should be about 9.1e-13</span>

<span class="token comment">## For non-square matrices:</span>
rcond<span class="token punctuation">(</span>x1 <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 0.05278</span>
rcond<span class="token punctuation">(</span>x2 <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># practically 0, since x2 does not have full rank</span>

<span class="token comment">## sparse</span>
<span class="token punctuation">(</span>S1 <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>rbind<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
rcond<span class="token punctuation">(</span>S1<span class="token punctuation">)</span>
m1 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> <span class="token string">"denseMatrix"</span><span class="token punctuation">)</span>
all.equal<span class="token punctuation">(</span>rcond<span class="token punctuation">(</span>S1<span class="token punctuation">)</span><span class="token punctuation">,</span> rcond<span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## wide and sparse</span>
rcond<span class="token punctuation">(</span>Matrix<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Large sparse example ----------</span>
m <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
M <span class="token operator">&lt;-</span> bdiag<span class="token punctuation">(</span>kronecker<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">,</span> kronecker<span class="token punctuation">(</span>m<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">36</span><span class="token operator">*</span><span class="token punctuation">(</span>iM <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># still sparse</span>
MM <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> kronecker<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>kronecker<span class="token punctuation">(</span>m<span class="token punctuation">,</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dim<span class="token punctuation">(</span>M3 <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>bdiag<span class="token punctuation">(</span>M<span class="token punctuation">,</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span>MM<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 12'800 ^ 2</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">## takes about 2 seconds if you have &gt;= 8 GB RAM</span>
  system.time<span class="token punctuation">(</span>r <span class="token operator">&lt;-</span> rcond<span class="token punctuation">(</span>M3<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## whereas this is *fast* even though it computes  solve(M3)</span>
system.time<span class="token punctuation">(</span>r. <span class="token operator">&lt;-</span> rcond<span class="token punctuation">(</span>M3<span class="token punctuation">,</span> useInv<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">## the values are not the same</span>
  c<span class="token punctuation">(</span>r<span class="token punctuation">,</span> r.<span class="token punctuation">)</span>  <span class="token comment"># 0.05555 0.013888</span>
<span class="token comment">## for all 4 norms available for sparseMatrix :</span>
cbind<span class="token punctuation">(</span>rr <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"I"</span><span class="token punctuation">,</span><span class="token string">"F"</span><span class="token punctuation">,</span><span class="token string">"M"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             <span class="token keyword">function</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span> rcond<span class="token punctuation">(</span>M3<span class="token punctuation">,</span> norm<span class="token operator">=</span>N<span class="token punctuation">,</span> useInv<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="rep2abI">

<a href="#rep2abI" class="help-page-title"><h2 id="rep2abI">Replicate Vectors into 'abIndex' Result</h2></a>

<h3>Description</h3>

<p><code>rep2abI(x, times)</code> conceptually computes
<code><a href="https://r-universe.dev/manuals/base.html#rep">rep.int</a>(x, times)</code> but with an
<code><a href="#abIndex-class">abIndex</a></code> class result.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">rep2abI<span class="token punctuation">(</span>x<span class="token punctuation">,</span> times<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="rep2abI_:_x">x</code></td>
<td>
<p>numeric vector</p>
</td>
</tr>
<tr>
<td><code id="rep2abI_:_times">times</code></td>
<td>
<p>integer (valued) scalar: the number of repetitions</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector of <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> <code><a href="#abIndex-class">abIndex</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#rep">rep.int</a>()</code>, the base function;
<code><a href="#abIseq">abIseq</a></code>, <code><a href="#abIndex-class">abIndex</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>ab <span class="token operator">&lt;-</span> rep2abI<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>as<span class="token punctuation">(</span>ab<span class="token punctuation">,</span> <span class="token string">"numeric"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	   rep<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="replValue-class">

<a href="#replValue-class" class="help-page-title"><h2 id="replValue-class">Virtual Class "replValue" - Simple Class for Subassignment Values</h2></a>

<h3>Description</h3>

<p>The class <code>"replValue"</code> is a virtual class used for
values in signatures for sub-assignment of <span class="pkg">Matrix</span> matrices.
</p>
<p>In fact, it is a simple class union  (<code><a href="https://r-universe.dev/manuals/methods.html#setClassUnion">setClassUnion</a></code>) of
<code>"numeric"</code> and <code>"logical"</code> (and maybe <code>"complex"</code> in
the future).
</p>


<h3>Objects from the Class</h3>

<p>Since it is a virtual Class, no objects
may be created from it.</p>


<h3>See Also</h3>


<p><code><a href="#Subassign-methods">Subassign-methods</a></code>, also for examples.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"replValue"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="rleDiff-class">

<a href="#rleDiff-class" class="help-page-title"><h2 id="rleDiff-class">Class "rleDiff" of  rle(diff(.))  Stored Vectors</h2></a>

<h3>Description</h3>

<p>Class <code>"rleDiff"</code> is for compactly storing long vectors
which mainly consist of <em>linear</em> stretches.  For such a vector
<code>x</code>, <code><a href="https://r-universe.dev/manuals/base.html#diff">diff</a>(x)</code> consists of <em>constant</em> stretches
and is hence well compressable via <code><a href="https://r-universe.dev/manuals/base.html#rle">rle</a>()</code>.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("rleDiff", ...)</code>.
</p>
<p>Currently experimental, see below.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>first</code>:</dt>
<dd>
<p>A single number (of class <code>"numLike"</code>,
a class union of <code>"numeric"</code> and <code>"logical"</code>).</p>
</dd>
<dt>
<code>rle</code>:</dt>
<dd>
<p>Object of class <code>"rle"</code>, basically a
<code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> with components <code>"lengths"</code> and
<code>"values"</code>, see <code><a href="https://r-universe.dev/manuals/base.html#rle">rle</a>()</code>.  As this is used to
encode potentially huge index vectors, <code>lengths</code> may be of
type <code><a href="https://r-universe.dev/manuals/base.html#double">double</a></code> here.</p>
</dd>
</dl>
<h3>Methods</h3>

<p>There is a simple <code><a href="https://r-universe.dev/manuals/methods.html#show">show</a></code> method only.
</p>


<h3>Note</h3>

<p>This is currently an <em>experimental</em> auxiliary class
for the class <code><a href="#abIndex-class">abIndex</a></code>, see there.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#rle">rle</a></code>, <code><a href="#abIndex-class">abIndex</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"rleDiff"</span><span class="token punctuation">)</span>

ab <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>abIseq<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> abIseq<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ab<span class="token operator">@</span>rleD  <span class="token comment"># is "rleDiff"</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="rsparsematrix">

<a href="#rsparsematrix" class="help-page-title"><h2 id="rsparsematrix">Random Sparse Matrix</h2></a>

<h3>Description</h3>

<p>Generate a random sparse matrix efficiently.  The default has rounded
gaussian non-zero entries, and <code>rand.x = NULL</code> generates random
patter<b>n</b> matrices, i.e. inheriting from <code><a href="#nsparseMatrix-classes">nsparseMatrix</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">rsparsematrix<span class="token punctuation">(</span>nrow<span class="token punctuation">,</span> ncol<span class="token punctuation">,</span> density<span class="token punctuation">,</span> nnz <span class="token operator">=</span> round<span class="token punctuation">(</span>density <span class="token operator">*</span> maxE<span class="token punctuation">)</span><span class="token punctuation">,</span>
              symmetric <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
              rand.x <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> signif<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td>
<code id="rsparsematrix_:_nrow">nrow</code>, <code id="rsparsematrix_:_ncol">ncol</code>
</td>
<td>
<p>number of rows and columns, i.e., the matrix
dimension (<code><a href="https://r-universe.dev/manuals/base.html#dim">dim</a></code>).</p>
</td>
</tr>
<tr>
<td><code id="rsparsematrix_:_density">density</code></td>
<td>
<p>optional number in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code>, the density is the
proportion of non-zero entries among all matrix entries.  If
specified it determines the default for <code>nnz</code>, otherwise
<code>nnz</code> needs to be specified.</p>
</td>
</tr>
<tr>
<td><code id="rsparsematrix_:_nnz">nnz</code></td>
<td>
<p>number of non-zero entries, for a sparse matrix typically
considerably smaller than <code>nrow*ncol</code>.  Must be specified if
<code>density</code> is not.</p>
</td>
</tr>
<tr>
<td><code id="rsparsematrix_:_symmetric">symmetric</code></td>
<td>
<p>logical indicating if result should be a matrix of
class <code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>.  Note that in the symmetric
case, <code>nnz</code> denotes the number of non zero entries of the upper
(or lower) part of the matrix, including the diagonal.</p>
</td>
</tr>
<tr>
<td><code id="rsparsematrix_:_rand.x">rand.x</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#NULL">NULL</a></code> or the random number generator for the <code>x</code> slot, a
<code><a href="https://r-universe.dev/manuals/base.html#function">function</a></code> such that <code>rand.x(n)</code> generates a
numeric vector of length <code>n</code>.  Typical examples are
<code>rand.x = rnorm</code>, or <code>rand.x = runif</code>; the default is nice
for didactical purposes.</p>
</td>
</tr>
<tr>
<td><code id="rsparsematrix_:_...">...</code></td>
<td>
<p>optionally further arguments passed to
<code><a href="#sparseMatrix">sparseMatrix</a>()</code>, notably <code>repr</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm first samples “encoded” <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></code>s without
replacement, via one dimensional indices, if not <code>symmetric</code>
<code><a href="https://r-universe.dev/manuals/base.html#sample">sample.int</a>(nrow*ncol, nnz)</code>, then—if <code>rand.x</code> is
not <code>NULL</code>—gets <code>x &lt;- rand.x(nnz)</code> and calls
<code><a href="#sparseMatrix">sparseMatrix</a>(i=i, j=j, x=x, ..)</code>.  When
<code>rand.x=NULL</code>, <code><a href="#sparseMatrix">sparseMatrix</a>(i=i, j=j, ..)</code> will
return a patter<b>n</b> matrix (i.e., inheriting from
<code><a href="#nsparseMatrix-classes">nsparseMatrix</a></code>).
</p>


<h3>Value</h3>

<p>a <code><a href="#sparseMatrix-class">sparseMatrix</a></code>, say <code>M</code> of dimension (nrow,
ncol), i.e., with <code>dim(M) == c(nrow, ncol)</code>, if <code>symmetric</code>
is not true, with <code>nzM &lt;- <a href="#nnzero">nnzero</a>(M)</code> fulfilling
<code>nzM &lt;= nnz</code> and typically, <code>nzM == nnz</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">set.seed<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token comment"># to be reproducible</span>
M <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> nnz <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token comment"># small example, not very sparse</span>
M
M1 <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span>  nnz <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">,</span>  rand.x <span class="token operator">=</span> runif<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>M1<span class="token punctuation">)</span>

<span class="token comment">## a random *symmetric* Matrix</span>
<span class="token punctuation">(</span>S9 <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> nnz <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> symmetric<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># dsCMatrix</span>
nnzero<span class="token punctuation">(</span>S9<span class="token punctuation">)</span><span class="token comment"># ~ 20: as 'nnz' only counts one "triangle"</span>

<span class="token comment">## a random patter*n* aka boolean Matrix (no 'x' slot):</span>
<span class="token punctuation">(</span>n7 <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> nnz <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> rand.x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## a [T]riplet representation sparseMatrix:</span>
T2 <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> nnz <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">,</span> repr <span class="token operator">=</span> <span class="token string">"T"</span><span class="token punctuation">)</span>
head<span class="token punctuation">(</span>T2<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="RsparseMatrix-class">

<a href="#RsparseMatrix-class" class="help-page-title"><h2 id="RsparseMatrix-class">Class "RsparseMatrix" of Sparse Matrices in Row-compressed Form</h2></a>

<h3>Description</h3>

<p>The <code>"RsparseMatrix"</code> class is the virtual class of
all sparse matrices coded in sorted compressed row-oriented form.
Since it is a virtual class, no objects may be created from it.  See
<code>showClass("RsparseMatrix")</code> for its subclasses.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>j</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length <code>nnzero</code>
(number of non-zero elements).  These are the row numbers for
each non-zero element in the matrix.</p>
</dd>
<dt>
<code>p</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of pointers, one
for each row, to the initial (zero-based) index of elements in
the row.</p>
</dd>
<dt>
<code>Dim</code>, <code>Dimnames</code>:</dt>
<dd>
<p>inherited from
the superclass, see <code><a href="#sparseMatrix-class">sparseMatrix</a></code>.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"sparseMatrix"</code>, directly.
Class <code>"Matrix"</code>, by class <code>"sparseMatrix"</code>.
</p>


<h3>Methods</h3>

<p>Originally, <b>few</b> methods were defined on purpose, as we
rather use the <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> in <span class="pkg">Matrix</span>.
Then, more methods were added but <em>beware</em> that these
typically do <em>not</em> return <code>"RsparseMatrix"</code> results, but
rather Csparse* or Tsparse* ones; e.g., <code>R[i, j] &lt;- v</code> for an
<code>"RsparseMatrix"</code> <code>R</code> works, but after the assignment, <code>R</code>
is a (triplet) <code>"TsparseMatrix"</code>.
</p>

<dl>
<dt>t</dt>
<dd>
<p><code>signature(x = "RsparseMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "RsparseMatrix", to = "CsparseMatrix")</code>: ... </p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "RsparseMatrix", to = "TsparseMatrix")</code>: ... </p>
</dd>
</dl>
<h3>See Also</h3>

<p>its superclass, <code><a href="#sparseMatrix-class">sparseMatrix</a></code>, and, e.g., class
<code><a href="#dgRMatrix-class">dgRMatrix</a></code> for the links to other classes.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"RsparseMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Schur-class">

<a href="#Schur-class" class="help-page-title"><h2 id="Schur-class">Schur Factorizations</h2></a>

<h3>Description</h3>

<p><code>Schur</code> is the class of Schur factorizations of
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> real matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
having the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>Q</mi><mi>T</mi><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A = Q T Q'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">QT</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></code> is an orthogonal matrix and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></code> is a block upper triangular matrix with
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code> diagonal blocks
specifying the real and complex conjugate eigenvalues of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>.
The column vectors of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></code> are the Schur vectors of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></code> is the Schur form of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>.
</p>
<p>The Schur factorization generalizes the spectral decomposition
of normal matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, whose Schur form is block diagonal,
to arbitrary square matrices.
</p>


<h3>Details</h3>

<p>The matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> and its Schur form <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></code> are <em>similar</em>
and thus have the same spectrum.  The eigenvalues are computed
trivially as the eigenvalues of the diagonal blocks of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>, <code>Dimnames</code>
</dt>
<dd>
<p>inherited from virtual class
<code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>.</p>
</dd>
<dt><code>Q</code></dt>
<dd>
<p>an orthogonal matrix,
inheriting from virtual class <code><a href="#Matrix-class">Matrix</a></code>.</p>
</dd>
<dt><code>T</code></dt>
<dd>
<p>a block upper triangular matrix,
inheriting from virtual class <code><a href="#Matrix-class">Matrix</a></code>.
The diagonal blocks have dimensions 1-by-1 or 2-by-2.</p>
</dd>
<dt><code>EValues</code></dt>
<dd>
<p>a numeric or complex vector containing
the eigenvalues of the diagonal blocks of <code>T</code>, which are
the eigenvalues of <code>T</code> and consequently of the factorized
matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code><a href="#MatrixFactorization-class">SchurFactorization</a></code>, directly.
Class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>, by class
<code><a href="#MatrixFactorization-class">SchurFactorization</a></code>, distance 2.
</p>


<h3>Instantiation</h3>

<p>Objects can be generated directly by calls of the form
<code>new("Schur", ...)</code>, but they are more typically obtained
as the value of <code><a href="#Schur">Schur</a>(x)</code> for <code>x</code> inheriting from
<code><a href="#Matrix-class">Matrix</a></code> (often <code><a href="#dgeMatrix-class">dgeMatrix</a></code>).
</p>


<h3>Methods</h3>


<dl>
<dt><code>determinant</code></dt>
<dd>
<p><code>signature(from = "Schur", logarithm = "logical")</code>:
computes the determinant of the factorized matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>
or its logarithm.</p>
</dd>
<dt><code>expand1</code></dt>
<dd>
<p><code>signature(x = "Schur")</code>:
see <code><a href="#expand">expand1-methods</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "Schur")</code>:
see <code><a href="#expand">expand2-methods</a></code>.</p>
</dd>
<dt><code>solve</code></dt>
<dd>
<p><code>signature(a = "Schur", b = .)</code>:
see <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
</dl>
<h3>References</h3>

<p>The LAPACK source code, including documentation; see
<a href="https://netlib.org/lapack/double/dgees.f" target="_blank">https://netlib.org/lapack/double/dgees.f</a>.
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Class <code><a href="#dgeMatrix-class">dgeMatrix</a></code>.
</p>
<p>Generic functions <code><a href="#Schur">Schur</a></code>,
<code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"Schur"</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

n <span class="token operator">&lt;-</span> <span class="token number">4L</span>
<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>n <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## With dimnames, to see that they are propagated :</span>
dimnames<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>paste0<span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    paste0<span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>sch.A <span class="token operator">&lt;-</span> Schur<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>e.sch.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>sch.A<span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ Q T Q' in floating point</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>e.sch.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">,</span> <span class="token string">"T"</span><span class="token punctuation">,</span> <span class="token string">"Q."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.sch.A<span class="token punctuation">,</span> Q <span class="token percent-operator operator">%*%</span> T <span class="token percent-operator operator">%*%</span> Q.<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Factorization handled as factorized matrix</span>
b <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>det<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> det<span class="token punctuation">(</span>sch.A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          all.equal<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> solve<span class="token punctuation">(</span>sch.A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## One of the non-general cases:</span>
Schur<span class="token punctuation">(</span>Diagonal<span class="token punctuation">(</span><span class="token number">6L</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Schur">

<a href="#Schur" class="help-page-title"><h2 id="Schur-methods">Methods for Schur Factorization</h2></a>

<h3>Description</h3>

<p>Computes the Schur factorization of an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
real matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>, which has the general form 
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>Q</mi><mi>T</mi><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A = Q T Q'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">QT</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></code> is an orthogonal matrix and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></code> is a block upper triangular matrix with
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code> diagonal blocks
specifying the real and complex conjugate eigenvalues of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>.
The column vectors of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></code> are the Schur vectors of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></code> is the Schur form of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>.
</p>
<p>Methods are built on LAPACK routine <code>dgees</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Schur<span class="token punctuation">(</span>x<span class="token punctuation">,</span> vectors <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="Schur-methods_:_x">x</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a> square matrix or
<code><a href="#Matrix-class">Matrix</a></code> to be factorized.</p>
</td>
</tr>
<tr>
<td><code id="Schur-methods_:_vectors">vectors</code></td>
<td>
<p>a logical.  If <code>TRUE</code> (the default),
then Schur vectors are computed in addition to the Schur form.</p>
</td>
</tr>
<tr>
<td><code id="Schur-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object representing the factorization, inheriting
from virtual class <code><a href="#MatrixFactorization-class">SchurFactorization</a></code>
if <code>vectors = TRUE</code>.  Currently, the specific class
is always <code><a href="#Schur-class">Schur</a></code> in that case.

An exception is if <code>x</code> is a traditional matrix,
in which case the result is a named list containing
<code>Q</code>, <code>T</code>, and <code>EValues</code> slots of the
<code><a href="#Schur-class">Schur</a></code> object.
</p>
<p>If <code>vectors = FALSE</code>, then the result is the same
named list but without <code>Q</code>.
</p>


<h3>References</h3>

<p>The LAPACK source code, including documentation; see
<a href="https://netlib.org/lapack/double/dgees.f" target="_blank">https://netlib.org/lapack/double/dgees.f</a>.
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Class <code><a href="#Schur-class">Schur</a></code> and its methods.
</p>
<p>Class <code><a href="#dgeMatrix-class">dgeMatrix</a></code>.
</p>
<p>Generic functions <code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>,
for constructing matrix factors from the result.
</p>
<p>Generic functions <code><a href="#Cholesky">Cholesky</a></code>, <code><a href="#BunchKaufman-methods">BunchKaufman</a></code>,
<code><a href="#lu">lu</a></code>, and <code><a href="#qr-methods">qr</a></code>,
for computing other factorizations.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showMethods<span class="token punctuation">(</span><span class="token string">"Schur"</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

Schur<span class="token punctuation">(</span>Hilbert<span class="token punctuation">(</span><span class="token number">9L</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># real eigenvalues</span>

<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">25L</span><span class="token punctuation">,</span> sd <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5L</span><span class="token punctuation">,</span> <span class="token number">5L</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>sch.A <span class="token operator">&lt;-</span> Schur<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># complex eigenvalues</span>

<span class="token comment">## A ~ Q T Q' in floating point</span>
str<span class="token punctuation">(</span>e.sch.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>sch.A<span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>A<span class="token punctuation">,</span> Reduce<span class="token punctuation">(</span>`<span class="token percent-operator operator">%*%</span>`<span class="token punctuation">,</span> e.sch.A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>e1 <span class="token operator">&lt;-</span> eigen<span class="token punctuation">(</span>sch.A<span class="token operator">@</span>T<span class="token punctuation">,</span> only.values <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>values<span class="token punctuation">)</span>
<span class="token punctuation">(</span>e2 <span class="token operator">&lt;-</span> eigen<span class="token punctuation">(</span>    A  <span class="token punctuation">,</span> only.values <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>values<span class="token punctuation">)</span>
<span class="token punctuation">(</span>e3 <span class="token operator">&lt;-</span> sch.A<span class="token operator">@</span>EValues<span class="token punctuation">)</span>

stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    all.equal<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">1e-13</span><span class="token punctuation">)</span>
    all.equal<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e3<span class="token punctuation">[</span>order<span class="token punctuation">(</span>Mod<span class="token punctuation">(</span>e3<span class="token punctuation">)</span><span class="token punctuation">,</span> decreasing <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">1e-13</span><span class="token punctuation">)</span> 
    identical<span class="token punctuation">(</span>Schur<span class="token punctuation">(</span>A<span class="token punctuation">,</span> vectors <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              list<span class="token punctuation">(</span>T <span class="token operator">=</span> sch.A<span class="token operator">@</span>T<span class="token punctuation">,</span> EValues <span class="token operator">=</span> e3<span class="token punctuation">)</span><span class="token punctuation">)</span>    
    identical<span class="token punctuation">(</span>Schur<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              list<span class="token punctuation">(</span>Q <span class="token operator">=</span> as<span class="token punctuation">(</span>sch.A<span class="token operator">@</span>Q<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   T <span class="token operator">=</span> as<span class="token punctuation">(</span>sch.A<span class="token operator">@</span>T<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> EValues <span class="token operator">=</span> e3<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="solve-methods">

<a href="#solve-methods" class="help-page-title"><h2 id="solve-methods">Methods in Package <span class="pkg">Matrix</span> for Function <code>solve</code>
</h2></a>

<h3>Description</h3>

<p>Methods for generic function <code><a href="https://r-universe.dev/manuals/base.html#solve">solve</a></code> for solving
linear systems of equations,
i.e., for <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></code> in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>,
where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> is a square matrix and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> are matrices
with dimensions consistent with <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S4 method for signature 'dgeMatrix,ANY'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> tol <span class="token operator">=</span> .Machine<span class="token operator">$</span>double.eps<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S4 method for signature 'dgCMatrix,missing'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dgCMatrix,matrix'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dgCMatrix,denseMatrix'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'dgCMatrix,sparseMatrix'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> sparse <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S4 method for signature 'denseLU,dgeMatrix'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'BunchKaufman,dgeMatrix'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'Cholesky,dgeMatrix'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'sparseLU,dgCMatrix'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> tol <span class="token operator">=</span> .Machine<span class="token operator">$</span>double.eps<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'sparseQR,dgCMatrix'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S4 method for signature 'CHMfactor,dgCMatrix'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> system <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"LDLt"</span><span class="token punctuation">,</span> <span class="token string">"LD"</span><span class="token punctuation">,</span> <span class="token string">"DLt"</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"Lt"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"Pt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="solve-methods_:_a">a</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a> square matrix or
<code><a href="#Matrix-class">Matrix</a></code> containing the coefficients
of the linear system, or otherwise a
<code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>,
in which case methods behave (by default)
as if the factorized matrix were specified.</p>
</td>
</tr>
<tr>
<td><code id="solve-methods_:_b">b</code></td>
<td>
<p>a vector, <code><a href="#sparseVector-class">sparseVector</a></code>,
matrix, or <code><a href="#Matrix-class">Matrix</a></code> satisfying
<code>NROW(b) == nrow(a)</code>, giving the right-hand side(s)
of the linear system.  Vectors <code>b</code> are treated as
<code>length(b)</code>-by-1 matrices.  If <code>b</code> is missing,
then methods take <code>b</code> to be an identity matrix.</p>
</td>
</tr>
<tr>
<td><code id="solve-methods_:_tol">tol</code></td>
<td>
<p>a non-negative number.  For <code>a</code> inheriting from
<code><a href="#denseMatrix-class">denseMatrix</a></code>, an error is signaled if the
reciprocal one-norm condition number (see <code><a href="https://r-universe.dev/manuals/base.html#rcond">rcond</a></code>)
of <code>a</code> is less than <code>tol</code>, indicating that <code>a</code> is
near-singular.  For <code>a</code> of class <code><a href="#sparseLU-class">sparseLU</a></code>,
an error is signaled if the ratio <code>min(d)/max(d)</code> is less
than <code>tol</code>, where <code>d = abs(diag(a@U))</code>.  (Interpret
with care, as this ratio is a cheap heuristic and <em>not</em>
in general equal to or even proportional to the reciprocal
one-norm condition number.)  Setting <code>tol = 0</code> disables
the test.</p>
</td>
</tr>
<tr>
<td><code id="solve-methods_:_sparse">sparse</code></td>
<td>
<p>a logical indicating if the result should be formally
sparse, i.e., if the result should inherit from virtual class
<code><a href="#sparseMatrix-class">sparseMatrix</a></code>.
Only methods for sparse <code>a</code> and missing or matrix <code>b</code>
have this argument.
Methods for missing or sparse <code>b</code> use <code>sparse = TRUE</code>
by default.  Methods for dense <code>b</code> use <code>sparse = FALSE</code>
by default.</p>
</td>
</tr>
<tr>
<td><code id="solve-methods_:_system">system</code></td>
<td>
<p>a string specifying a linear system to be solved.
Only methods for <code>a</code>
inheriting from <code><a href="#CHMfactor-class">CHMfactor</a></code> have this argument.
See ‘Details’.</p>
</td>
</tr>
<tr>
<td><code id="solve-methods_:_...">...</code></td>
<td>
<p>further arguments passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Methods for general and symmetric matrices <code>a</code> compute a
triangular factorization (LU, Bunch-Kaufman, or Cholesky)
and call the method for the corresponding factorization class.
The factorization is sparse if <code>a</code> is.  Methods for sparse,
symmetric matrices <code>a</code> attempt a Cholesky factorization
and perform an LU factorization only if that fails (typically
because <code>a</code> is not positive definite).
</p>
<p>Triangular, diagonal, and permutation matrices do not require
factorization (they are already “factors”), hence methods
for those are implemented directly.  For triangular <code>a</code>,
solutions are obtained by forward or backward substitution;
for diagonal <code>a</code>, they are obtained by scaling the rows
of <code>b</code>; and for permutations <code>a</code>, they are obtained
by permuting the rows of <code>b</code>.
</p>
<p>Methods for dense <code>a</code> are built on 14 LAPACK routines:
class <code>d..Matrix</code>, where <code>..=(ge|tr|tp|sy|sp|po|pp)</code>,
uses routines <code>d..tri</code> and <code>d..trs</code> for missing
and non-missing <code>b</code>, respectively.  A corollary is that
these methods always give a dense result.
</p>
<p>Methods for sparse <code>a</code> are built on CSparse routines
<code>cs_lsolve</code>, <code>cs_usolve</code>, and <code>cs_spsolve</code> and
CHOLMOD routines <code>cholmod_solve</code> and <code>cholmod_spsolve</code>.
By default, these methods give a vector result if <code>b</code>
is a vector, a sparse matrix result if <code>b</code> is missing
or a sparse matrix, and a dense matrix result if <code>b</code>
is a dense matrix.  One can override this behaviour by setting
the <code>sparse</code> argument, where available, but that should
be done with care.  Note that a sparse result may be sparse only
in the formal sense and not at all in the mathematical sense,
depending on the nonzero patterns of <code>a</code> and <code>b</code>.
Furthermore, whereas dense results are fully preallocated,
sparse results must be “grown” in a loop over the columns
of <code>b</code>.
</p>
<p>Methods for <code>a</code> of class <code><a href="#sparseQR-class">sparseQR</a></code>
are simple wrappers around <code><a href="https://r-universe.dev/manuals/base.html#qr">qr.coef</a></code>, giving the
<em>least squares</em> solution in overdetermined cases.
</p>
<p>Methods for <code>a</code> inheriting from <code><a href="#CHMfactor-class">CHMfactor</a></code>
can solve systems other than the default one <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>.
The correspondance between its <code>system</code> argument the system
actually solved is outlined in the table below.
See <code><a href="#CHMfactor-class">CHMfactor-class</a></code> for a definition of notation.
</p>

<table>
<tr>
<td style="text-align: right;">
    <code>system</code> </td>
<td style="text-align: right;"> <code><a href="#CHMfactor-class">isLDL</a>(a)=TRUE</code> </td>
<td style="text-align: right;"> <code><a href="#CHMfactor-class">isLDL</a>(a)=FALSE</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code>"A"</code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code>"LDLt"</code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L_{1} D L_{1}' X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L L' X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code>"LD"</code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L_{1} D X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code>"DLt"</code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">D L_{1}' X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L' X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code>"L"</code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L_{1} X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code>"Lt"</code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L_{1}' X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L' X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code>"D"</code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">D X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">X = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code>"P"</code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mi>B</mi></mrow><annotation encoding="application/x-tex">X = P_{1} B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mi>B</mi></mrow><annotation encoding="application/x-tex">X = P_{1} B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>
</td>
</tr>
<tr>
<td style="text-align: right;">
    <code>"Pt"</code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>B</mi></mrow><annotation encoding="application/x-tex">X = P_{1}' B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code> </td>
<td style="text-align: right;"> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>B</mi></mrow><annotation encoding="application/x-tex">X = P_{1}' B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></code>
  </td>
</tr>
</table>
<h3>See Also</h3>

<p>Virtual class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code> and its
subclasses.
</p>
<p>Generic functions <code><a href="#Cholesky">Cholesky</a></code>, <code><a href="#BunchKaufman-methods">BunchKaufman</a></code>,
<code><a href="#Schur">Schur</a></code>, <code><a href="#lu">lu</a></code>, and <code><a href="#qr-methods">qr</a></code> for
<em>computing</em> factorizations.
</p>
<p>Generic function <code><a href="https://r-universe.dev/manuals/base.html#solve">solve</a></code> from <span class="pkg">base</span>.
</p>
<p>Function <code><a href="https://r-universe.dev/manuals/base.html#qr">qr.coef</a></code> from <span class="pkg">base</span> for computing
least squares solutions of overdetermined linear systems.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## A close to symmetric example with "quite sparse" inverse:</span>
n1 <span class="token operator">&lt;-</span> <span class="token number">7</span><span class="token punctuation">;</span> n2 <span class="token operator">&lt;-</span> <span class="token number">3</span>
dd <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>a <span class="token operator">=</span> gl<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token punctuation">,</span> b <span class="token operator">=</span> gl<span class="token punctuation">(</span>n2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n1<span class="token operator">*</span>n2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># balanced 2-way</span>
X <span class="token operator">&lt;-</span> sparse.model.matrix<span class="token punctuation">(</span><span class="token operator">~</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> dd<span class="token punctuation">)</span><span class="token comment"># no intercept --&gt; even sparser</span>
XXt <span class="token operator">&lt;-</span> tcrossprod<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
diag<span class="token punctuation">(</span>XXt<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> nrow<span class="token punctuation">(</span>XXt<span class="token punctuation">)</span><span class="token punctuation">)</span>

n <span class="token operator">&lt;-</span> nrow<span class="token punctuation">(</span>ZZ <span class="token operator">&lt;-</span> kronecker<span class="token punctuation">(</span>XXt<span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span>x<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>a <span class="token operator">&lt;-</span> <span class="token number">2</span><span class="token operator">*</span>Diagonal<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> ZZ <span class="token percent-operator operator">%*%</span> Diagonal<span class="token punctuation">(</span>x<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
isSymmetric<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment"># FALSE</span>
image<span class="token punctuation">(</span>drop0<span class="token punctuation">(</span>skewpart<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>ia0 <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># checker board, dense [but really, a is singular!]</span>
try<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">##-&gt; error [ TODO: assertError ]</span>
ia. <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">1e-19</span><span class="token punctuation">)</span><span class="token comment">##-&gt; *no* error</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>R.version<span class="token operator">$</span>arch <span class="token operator">==</span> <span class="token string">"x86_64"</span><span class="token punctuation">)</span>
  <span class="token comment">## Fails on 32-bit [Fedora 19, R 3.0.2] from Matrix 1.1-0 on [FIXME ??] only</span>
  stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>as.matrix<span class="token punctuation">(</span>ia.<span class="token punctuation">)</span><span class="token punctuation">,</span> as.matrix<span class="token punctuation">(</span>ia0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
a <span class="token operator">&lt;-</span> a <span class="token operator">+</span> Diagonal<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
iad <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
ias <span class="token operator">&lt;-</span> solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>iad<span class="token punctuation">,</span><span class="token string">"denseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ias<span class="token punctuation">,</span> tolerance<span class="token operator">=</span><span class="token number">1e-14</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
I. <span class="token operator">&lt;-</span> iad <span class="token percent-operator operator">%*%</span> a          <span class="token punctuation">;</span> image<span class="token punctuation">(</span>I.<span class="token punctuation">)</span>
I0 <span class="token operator">&lt;-</span> drop0<span class="token punctuation">(</span>zapsmall<span class="token punctuation">(</span>I.<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> image<span class="token punctuation">(</span>I0<span class="token punctuation">)</span>
.I <span class="token operator">&lt;-</span> a <span class="token percent-operator operator">%*%</span> iad
.I0 <span class="token operator">&lt;-</span> drop0<span class="token punctuation">(</span>zapsmall<span class="token punctuation">(</span>.I<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>I0<span class="token punctuation">,</span> <span class="token string">"diagonalMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>.I0<span class="token punctuation">,</span><span class="token string">"diagonalMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="sparse.model.matrix">

<a href="#sparse.model.matrix" class="help-page-title"><h2 id="sparse.model.matrix">Construct Sparse Design / Model Matrices</h2></a>

<h3>Description</h3>

<p>Construct a sparse model or “design” matrix,
from a formula and data frame (<code>sparse.model.matrix</code>) or a single
factor (<code>fac2sparse</code>).
</p>
<p>The <code>fac2[Ss]parse()</code> functions are utilities, also used
internally in the principal user level function
<code>sparse.model.matrix()</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">sparse.model.matrix<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data <span class="token operator">=</span> environment<span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">,</span>
		    contrasts.arg <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlev <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> transpose <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
		    drop.unused.levels <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> row.names <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
		    sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> verbose <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

fac2sparse<span class="token punctuation">(</span>from<span class="token punctuation">,</span> to <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"l"</span><span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	   drop.unused.levels <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> repr <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"T"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> giveCsparse<span class="token punctuation">)</span>
fac2Sparse<span class="token punctuation">(</span>from<span class="token punctuation">,</span> to <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"l"</span><span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	   drop.unused.levels <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> repr <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"T"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> giveCsparse<span class="token punctuation">,</span>
	   factorPatt12<span class="token punctuation">,</span> contrasts.arg <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="sparse.model.matrix_:_object">object</code></td>
<td>
<p>an object of an appropriate class.  For the default
method, a model formula or terms object.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_data">data</code></td>
<td>
<p>a data frame created with <code><a href="https://r-universe.dev/manuals/stats.html#model.frame">model.frame</a></code>.  If
another sort of object, <code>model.frame</code> is called first.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_contrasts.arg">contrasts.arg</code></td>
<td>

<dl>
<dt>for <code>sparse.model.matrix()</code>:</dt>
<dd>
<p>A list, whose entries are
contrasts suitable for input to the <code><a href="https://r-universe.dev/manuals/stats.html#contrasts">contrasts</a></code>
replacement function and whose names are the names of columns
of <code>data</code> containing <code><a href="https://r-universe.dev/manuals/base.html#factor">factor</a></code>s.</p>
</dd>
<dt>for <code>fac2Sparse()</code>:</dt>
<dd>
<p>character string or <code>NULL</code> or
(coercable to) <code>"<a href="#sparseMatrix-class">sparseMatrix</a>"</code>, specifying the
contrasts to be applied to the factor levels.</p>
</dd>
</dl>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_xlev">xlev</code></td>
<td>
<p>to be used as argument of <code><a href="https://r-universe.dev/manuals/stats.html#model.frame">model.frame</a></code> if
<code>data</code> has no <code>"terms"</code> attribute.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_transpose">transpose</code></td>
<td>
<p>logical indicating if the <em>transpose</em> should be
returned; if the transposed is used anyway, setting <code>transpose = TRUE</code>
is more efficient.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_drop.unused.levels">drop.unused.levels</code></td>
<td>
<p>should factors have unused levels dropped?
The default for <code>sparse.model.matrix</code> has been changed to
<code>FALSE</code>, 2010-07, for compatibility with <span class="rlang"><b>R</b></span>'s standard (dense)
<code><a href="https://r-universe.dev/manuals/stats.html#model.matrix">model.matrix</a>()</code>.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_row.names">row.names</code></td>
<td>
<p>logical indicating if row names should be used.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_sep">sep</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> string passed to <code><a href="https://r-universe.dev/manuals/base.html#paste">paste</a>()</code>
when constructing column names from the variable name and its levels.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_verbose">verbose</code></td>
<td>
<p>logical or integer indicating if (and how much)
progress output should be printed.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_from">from</code></td>
<td>
<p>(for <code>fac2sparse()</code>:) a <code><a href="https://r-universe.dev/manuals/base.html#factor">factor</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_to">to</code></td>
<td>
<p>a character indicating the “kind” of sparse matrix to
be returned.  The default, <code>"d"</code> is for <code><a href="https://r-universe.dev/manuals/base.html#double">double</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_giveCsparse">giveCsparse</code></td>
<td>
<p><b>deprecated</b>, replaced with <code>repr</code>; logical indicating if
the result must be a <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_repr">repr</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> string, one of <code>"C"</code>,
<code>"T"</code>, or <code>"R"</code>, specifying the sparse <em>repr</em>esentation to
be used for the result, i.e., one from the super classes
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>, <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>, or
<code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="sparse.model.matrix_:_factorPatt12">factorPatt12</code></td>
<td>
<p>logical vector, say <code>fp</code>, of length two;
when <code>fp[1]</code> is true, return “contrasted” <code>t(X)</code>;
when <code>fp[2]</code> is true, the original (“dummy”)
<code>t(X)</code>, i.e, the result of <code><a href="#sparse.model.matrix">fac2sparse</a>()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a sparse matrix, extending <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> (for
<code>fac2sparse()</code> if <code>repr = "C"</code> as per default; a
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code> or <code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>, otherwise).
</p>
<p>For <code>fac2Sparse()</code>, a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> of length two, both
components with the corresponding transposed model matrix, where the
corresponding <code>factorPatt12</code> is true.
</p>
<p><code>fac2sparse()</code>, the basic workhorse of
<code>sparse.model.matrix()</code>, returns the <em>transpose</em>
(<code><a href="https://r-universe.dev/manuals/base.html#t">t</a></code>) of the model matrix.
</p>


<h3>Note</h3>

<p><code>model.Matrix(sparse = TRUE)</code> from package <a href="https://CRAN.R-project.org/package=MatrixModels" target="_blank"><span class="pkg">MatrixModels</span></a>
may be nowadays be preferable to <code>sparse.model.matrix</code>,
as <code>model.Matrix</code> returns an object of class <code>modelMatrix</code>
with additional slots <code>assign</code> and <code>contrasts</code> relating to
the model variables.
</p>


<h3>Author(s)</h3>

<p>Doug Bates and Martin Maechler, with initial suggestions from Tim
Hesterberg.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#model.matrix">model.matrix</a></code> in package <span class="pkg">stats</span>, part of base <span class="rlang"><b>R</b></span>.
</p>
<p><code>model.Matrix</code> in package <a href="https://CRAN.R-project.org/package=MatrixModels" target="_blank"><span class="pkg">MatrixModels</span></a>; see ‘Note’.
</p>
<p><code>as(f, "sparseMatrix")</code> (see <code>coerce(from = "factor", ..)</code>
in the class doc <a href="#sparseMatrix-class">sparseMatrix</a>) produces the
<em>transposed</em> sparse model matrix for a single factor <code>f</code>
(and <em>no</em> contrasts).
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">dd <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>a <span class="token operator">=</span> gl<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> b <span class="token operator">=</span> gl<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># balanced 2-way</span>
options<span class="token punctuation">(</span><span class="token string">"contrasts"</span><span class="token punctuation">)</span> <span class="token comment"># the default:  "contr.treatment"</span>
sparse.model.matrix<span class="token punctuation">(</span><span class="token operator">~</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> dd<span class="token punctuation">)</span>
sparse.model.matrix<span class="token punctuation">(</span><span class="token operator">~</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> dd<span class="token punctuation">)</span><span class="token comment"># no intercept --&gt; even sparser</span>
sparse.model.matrix<span class="token punctuation">(</span><span class="token operator">~</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> dd<span class="token punctuation">,</span> contrasts <span class="token operator">=</span> list<span class="token punctuation">(</span>a<span class="token operator">=</span><span class="token string">"contr.sum"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sparse.model.matrix<span class="token punctuation">(</span><span class="token operator">~</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> dd<span class="token punctuation">,</span> contrasts <span class="token operator">=</span> list<span class="token punctuation">(</span>b<span class="token operator">=</span><span class="token string">"contr.SAS"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Sparse method is equivalent to the traditional one :</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>sparse.model.matrix<span class="token punctuation">(</span><span class="token operator">~</span>    a <span class="token operator">+</span> b<span class="token punctuation">,</span> dd<span class="token punctuation">)</span> <span class="token operator">==</span>
	          Matrix<span class="token punctuation">(</span>model.matrix<span class="token punctuation">(</span><span class="token operator">~</span>    a <span class="token operator">+</span> b<span class="token punctuation">,</span> dd<span class="token punctuation">)</span><span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	      all<span class="token punctuation">(</span>sparse.model.matrix<span class="token punctuation">(</span><span class="token operator">~</span><span class="token number">0</span> <span class="token operator">+</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> dd<span class="token punctuation">)</span> <span class="token operator">==</span>
	          Matrix<span class="token punctuation">(</span>model.matrix<span class="token punctuation">(</span><span class="token operator">~</span><span class="token number">0</span> <span class="token operator">+</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> dd<span class="token punctuation">)</span><span class="token punctuation">,</span> sparse<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token punctuation">(</span>ff <span class="token operator">&lt;-</span> gl<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">,</span><span class="token string">"Y"</span><span class="token punctuation">,</span> <span class="token string">"Z"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fac2sparse<span class="token punctuation">(</span>ff<span class="token punctuation">)</span> <span class="token comment">#  3 x 12 sparse Matrix of class "dgCMatrix"</span>
<span class="token comment">##</span>
<span class="token comment">##  X  1 1 1 1 . . . . . . . .</span>
<span class="token comment">##  Y  . . . . 1 1 1 1 . . . .</span>
<span class="token comment">##  Z  . . . . . . . . 1 1 1 1</span>

<span class="token comment">## can also be computed via sparse.model.matrix():</span>
f30 <span class="token operator">&lt;-</span> gl<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span>    <span class="token punctuation">)</span>
f12 <span class="token operator">&lt;-</span> gl<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>
  all.equal<span class="token punctuation">(</span>t<span class="token punctuation">(</span> fac2sparse<span class="token punctuation">(</span>ff<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
	    sparse.model.matrix<span class="token punctuation">(</span><span class="token operator">~</span> <span class="token number">0</span><span class="token operator">+</span>ff<span class="token punctuation">)</span><span class="token punctuation">,</span>
	    tolerance <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> check.attributes<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  is<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> fac2sparse<span class="token punctuation">(</span>f30<span class="token punctuation">,</span> drop<span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  is<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> fac2sparse<span class="token punctuation">(</span>f30<span class="token punctuation">,</span> drop<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  is<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> fac2sparse<span class="token punctuation">(</span>f12<span class="token punctuation">,</span> drop<span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  is<span class="token punctuation">(</span>M <span class="token operator">&lt;-</span> fac2sparse<span class="token punctuation">(</span>f12<span class="token punctuation">,</span> drop<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span>
 <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="sparseLU-class">

<a href="#sparseLU-class" class="help-page-title"><h2 id="sparseLU-class">Sparse LU Factorizations</h2></a>

<h3>Description</h3>

<p><code>sparseLU</code> is the class of sparse, row- and column-pivoted
LU factorizations of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> real matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>,
having the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><mi>L</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">P_{1} A P_{2} = L U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">LU</span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>L</mi><mi>U</mi><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">A = P_{1}' L U P_{2}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">LU</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are permutation matrices,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> is a unit lower triangular matrix, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code> is an upper triangular matrix.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>, <code>Dimnames</code>
</dt>
<dd>
<p>inherited from virtual class
<code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>.</p>
</dd>
<dt><code>L</code></dt>
<dd>
<p>an object of class <code><a href="#dtCMatrix-class">dtCMatrix</a></code>,
the unit lower triangular <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> factor.</p>
</dd>
<dt><code>U</code></dt>
<dd>
<p>an object of class <code><a href="#dtCMatrix-class">dtCMatrix</a></code>,
the upper triangular <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code> factor.</p>
</dd>
<dt>
<code>p</code>, <code>q</code>
</dt>
<dd>
<p>0-based integer vectors of length
<code>Dim[1]</code>,
specifying the permutations applied to the rows and columns of
the factorized matrix.  <code>q</code> of length 0 is valid and
equivalent to the identity permutation, implying no column pivoting.
Using <span class="rlang"><b>R</b></span> syntax, the matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_{1} A P_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
is precisely <code>A[p+1, q+1]</code>
(<code>A[p+1, ]</code> when <code>q</code> has length 0).</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code><a href="#MatrixFactorization-class">LU</a></code>, directly.
Class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>, by class
<code><a href="#MatrixFactorization-class">LU</a></code>, distance 2.
</p>


<h3>Instantiation</h3>

<p>Objects can be generated directly by calls of the form
<code>new("sparseLU", ...)</code>, but they are more typically obtained
as the value of <code><a href="#lu">lu</a>(x)</code> for <code>x</code> inheriting from
<code><a href="#sparseMatrix-class">sparseMatrix</a></code> (often <code><a href="#dgCMatrix-class">dgCMatrix</a></code>).
</p>


<h3>Methods</h3>


<dl>
<dt><code>determinant</code></dt>
<dd>
<p><code>signature(from = "sparseLU", logarithm = "logical")</code>:
computes the determinant of the factorized matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>
or its logarithm.</p>
</dd>
<dt><code>expand</code></dt>
<dd>
<p><code>signature(x = "sparseLU")</code>:
see <code><a href="#expand">expand-methods</a></code>.</p>
</dd>
<dt><code>expand1</code></dt>
<dd>
<p><code>signature(x = "sparseLU")</code>:
see <code><a href="#expand">expand1-methods</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "sparseLU")</code>:
see <code><a href="#expand">expand2-methods</a></code>.</p>
</dd>
<dt><code>solve</code></dt>
<dd>
<p><code>signature(a = "sparseLU", b = .)</code>:
see <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
</dl>
<h3>References</h3>

<p>Davis, T. A. (2006).
<em>Direct methods for sparse linear systems</em>.
Society for Industrial and Applied Mathematics.
<a href="https://doi.org/10.1137/1.9780898718881" target="_blank">doi:10.1137/1.9780898718881</a>
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Class <code><a href="#LU-class">denseLU</a></code> for dense LU factorizations.
</p>
<p>Class <code><a href="#dgCMatrix-class">dgCMatrix</a></code>.
</p>
<p>Generic functions <code><a href="#lu">lu</a></code>,
<code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"sparseLU"</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

A <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>readMM<span class="token punctuation">(</span>system.file<span class="token punctuation">(</span><span class="token string">"external"</span><span class="token punctuation">,</span> <span class="token string">"pores_1.mtx"</span><span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>n <span class="token operator">&lt;-</span> A<span class="token operator">@</span>Dim<span class="token punctuation">[</span><span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## With dimnames, to see that they are propagated :</span>
dimnames<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> dn <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>paste0<span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                          paste0<span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>lu.A <span class="token operator">&lt;-</span> lu<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>e.lu.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>lu.A<span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>

ae1 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
ae2 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> ae1<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> unname<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ P1' L U P2' in floating point</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"P1."</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token string">"P2."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              new<span class="token punctuation">(</span><span class="token string">"pMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> Dimnames <span class="token operator">=</span> c<span class="token punctuation">(</span>dn<span class="token punctuation">[</span><span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  margin <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> perm <span class="token operator">=</span> invertPerm<span class="token punctuation">(</span>lu.A<span class="token operator">@</span>p<span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P2."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              new<span class="token punctuation">(</span><span class="token string">"pMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> Dimnames <span class="token operator">=</span> c<span class="token punctuation">(</span>list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dn<span class="token punctuation">[</span><span class="token number">2L</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  margin <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">,</span> perm <span class="token operator">=</span> invertPerm<span class="token punctuation">(</span>lu.A<span class="token operator">@</span>q<span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"L"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lu.A<span class="token operator">@</span>L<span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"U"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lu.A<span class="token operator">@</span>U<span class="token punctuation">)</span>
    ae1<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> L <span class="token percent-operator operator">%*%</span> U <span class="token percent-operator operator">%*%</span> P2.<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>A<span class="token punctuation">[</span>lu.A<span class="token operator">@</span>p <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">,</span> lu.A<span class="token operator">@</span>q <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.lu.A<span class="token punctuation">,</span> L <span class="token percent-operator operator">%*%</span> U<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Factorization handled as factorized matrix</span>
b <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>det<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> det<span class="token punctuation">(</span>lu.A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>solve<span class="token punctuation">(</span>A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> solve<span class="token punctuation">(</span>lu.A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="sparseMatrix">

<a href="#sparseMatrix" class="help-page-title"><h2 id="sparseMatrix">General Sparse Matrix Construction from Nonzero Entries</h2></a>

<h3>Description</h3>

<p>User-friendly construction of sparse matrices (inheriting from
virtual <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>,
<code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>, or
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>)
from the positions and values of their nonzero entries.
</p>
<p>This interface is recommended over direct construction via
calls such as <code><a href="https://r-universe.dev/manuals/methods.html#new">new</a>("..[CRT]Matrix", ...)</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">sparseMatrix<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> p<span class="token punctuation">,</span> x<span class="token punctuation">,</span> dims<span class="token punctuation">,</span> dimnames<span class="token punctuation">,</span>
             symmetric <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> triangular <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> index1 <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
             repr <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"T"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> giveCsparse<span class="token punctuation">,</span>
             check <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> use.last.ij <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td>
<code id="sparseMatrix_:_i">i</code>, <code id="sparseMatrix_:_j">j</code>
</td>
<td>
<p>integer vectors of equal length specifying the positions
(row and column indices) of the nonzero (or non-<code>TRUE</code>) entries
of the matrix.  Note that, when <code>x</code> is non-missing, the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">x_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> corresponding to <em>repeated</em> pairs <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>i</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>j</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i_k,j_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code>
are <em>added</em>, for consistency with the definition of class
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>, unless <code>use.last.ij</code> is
<code>TRUE</code>, in which case only the <em>last</em> such <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">x_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> is
used.</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_p">p</code></td>
<td>
<p>integer vector of pointers, one for each column (or row),
to the initial (zero-based) index of elements in the column (or row).
Exactly one of <code>i</code>, <code>j</code>, and <code>p</code> must be missing.</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_x">x</code></td>
<td>
<p>optional, typically nonzero values for the matrix entries.
If specified, then the length must equal that of <code>i</code>
(or <code>j</code>) or equal 1, in which case <code>x</code> is recycled as
necessary.  If missing, then the result is a <b>n</b>onzero pattern
matrix, i.e., inheriting from class <code><a href="#nsparseMatrix-classes">nsparseMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_dims">dims</code></td>
<td>
<p>optional length-2 integer vector of matrix dimensions.
If missing, then <code>!index1+c(max(i),max(j))</code> is used.</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_dimnames">dimnames</code></td>
<td>
<p>optional list of <code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>; if missing,
then <code><a href="https://r-universe.dev/manuals/base.html#NULL">NULL</a></code> ones are used.</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_symmetric">symmetric</code></td>
<td>
<p>logical indicating if the resulting matrix should
be symmetric.  In that case, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j,p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></code> should specify only one
triangle (upper or lower).</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_triangular">triangular</code></td>
<td>
<p>logical indicating if the resulting matrix should
be triangular.  In that case, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j,p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></code> should specify only one
triangle (upper or lower).</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_index1">index1</code></td>
<td>
<p>logical.  If <code>TRUE</code> (the default), then <code>i</code>
and <code>j</code> are interpreted as 1-based indices, following the <span class="rlang"><b>R</b></span>
convention.  That is, counting of rows and columns starts at 1.
If <code>FALSE</code>, then they are interpreted as 0-based indices.</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_repr">repr</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> string, one of <code>"C"</code>,
<code>"R"</code>, and <code>"T"</code>, specifying the <b>repr</b>esentation
of the sparse matrix result, i.e., specifying one of the virtual
classes <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>,
<code><a href="#RsparseMatrix-class">RsparseMatrix</a></code>, and
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_giveCsparse">giveCsparse</code></td>
<td>
<p>(<b>deprecated</b>, replaced by <code>repr</code>)
logical indicating if the result should inherit from
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> or
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>.
Note that operations involving <code>CsparseMatrix</code> are very often
(but not always) more efficient.</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_check">check</code></td>
<td>
<p>logical indicating whether to check that the result is
formally valid before returning.  Do not set to <code>FALSE</code> unless
you know what you are doing!</p>
</td>
</tr>
<tr>
<td><code id="sparseMatrix_:_use.last.ij">use.last.ij</code></td>
<td>
<p>logical indicating if, in the case of repeated
(duplicated) pairs <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>i</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>j</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i_k,j_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code>, only the last pair should be
used.  <code>FALSE</code> (the default) is consistent with the definiton
of class <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

 
<p>Exactly one of the arguments <code>i</code>, <code>j</code> and <code>p</code> must be
missing.
</p>
<p>In typical usage, <code>p</code> is missing, <code>i</code> and <code>j</code> are
vectors of positive integers and <code>x</code> is a numeric vector.  These
three vectors, which must have the same length, form the triplet
representation of the sparse matrix.
</p>
<p>If <code>i</code> or <code>j</code> is missing then <code>p</code> must be a
non-decreasing integer vector whose first element is zero.  It
provides the compressed, or “pointer” representation of the row
or column indices, whichever is missing.  The expanded form of <code>p</code>,
<code>rep(seq_along(dp),dp)</code> where <code>dp &lt;- diff(p)</code>, is used as
the (1-based) row or column indices.
</p>
<p>You cannot set both <code>singular</code> and <code>triangular</code> to true;
rather use <code><a href="#Diagonal">Diagonal</a>()</code> (or its alternatives, see there).
</p>
<p>The values of <code>i</code>, <code>j</code>, <code>p</code> and <code>index1</code> are used
to create 1-based index vectors <code>i</code> and <code>j</code> from which a
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code> is constructed, with numerical
values given by <code>x</code>, if non-missing.  Note that in that case,
when some pairs <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>i</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>j</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i_k,j_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> are repeated (aka
“duplicated”), the corresponding <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">x_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are <em>added</em>, in
consistency with the definition of the
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code> class, unless <code>use.last.ij</code>
is set to true.
</p>
<p>By default, when <code>repr = "C"</code>, the <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>
derived from this triplet form is returned, where <code>repr = "R"</code> now
allows to directly get an <code><a href="#RsparseMatrix-class">RsparseMatrix</a></code> and
<code>repr = "T"</code> leaves the result as <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>.
</p>
<p>The reason for returning a <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> object
instead of the triplet format by default is that the compressed column
form is easier to work with when performing matrix operations.  In
particular, if there are no zeros in <code>x</code> then a
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> is a unique representation of the
sparse matrix.
</p>


<h3>Value</h3>

<p>A sparse matrix, by default in compressed sparse column format and
(formally) without symmetric or triangular structure, i.e.,
by default inheriting from both <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>
and <code><a href="#generalMatrix-class">generalMatrix</a></code>.
</p>


<h3>Note</h3>


<p>You <em>do</em> need to use <code>index1 = FALSE</code> (or add <code>+ 1</code>
to <code>i</code> and <code>j</code>) if you want use the 0-based <code>i</code> (and
<code>j</code>) slots from existing sparse matrices.
</p>


<h3>See Also</h3>

<p><code><a href="#Matrix">Matrix</a>(*, sparse=TRUE)</code> for the constructor of
such matrices from a <em>dense</em> matrix.  That is easier in small
sample, but much less efficient (or impossible) for large matrices,
where something like <code>sparseMatrix()</code> is needed.
Further <code><a href="#bdiag">bdiag</a></code> and <code><a href="#Diagonal">Diagonal</a></code> for (block-)diagonal and
<code><a href="#bandSparse">bandSparse</a></code> for banded sparse matrix constructors.
</p>
<p>Random sparse matrices via <code><a href="#rsparsematrix">rsparsematrix</a>()</code>.
</p>
<p>The standard <span class="rlang"><b>R</b></span> <code><a href="https://r-universe.dev/manuals/stats.html#xtabs">xtabs</a>(*, sparse=TRUE)</code>, for sparse tables
and <code><a href="#sparse.model.matrix">sparse.model.matrix</a>()</code> for building sparse model
matrices.
</p>
<p>Consider <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> and similar class
definition help files.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## simple example</span>
i <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> x <span class="token operator">&lt;-</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> x <span class="token operator">=</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token comment">##  8 x 10 "dgCMatrix"</span>
summary<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
str<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token comment"># note that *internally* 0-based row indices are used</span>

<span class="token punctuation">(</span>sA <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> x <span class="token operator">=</span> x<span class="token punctuation">,</span> symmetric <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">## 10 x 10 "dsCMatrix"</span>
<span class="token punctuation">(</span>tA <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> x <span class="token operator">=</span> x<span class="token punctuation">,</span> triangular<span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">## 10 x 10 "dtCMatrix"</span>
stopifnot<span class="token punctuation">(</span> all<span class="token punctuation">(</span>sA <span class="token operator">==</span> tA <span class="token operator">+</span> t<span class="token punctuation">(</span>tA<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
           identical<span class="token punctuation">(</span>sA<span class="token punctuation">,</span> as<span class="token punctuation">(</span>tA <span class="token operator">+</span> t<span class="token punctuation">(</span>tA<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## dims can be larger than the maximum row or column indices</span>
<span class="token punctuation">(</span>AA <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>AA<span class="token punctuation">)</span>

<span class="token comment">## i, j and x can be in an arbitrary order, as long as they are consistent</span>
set.seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">(</span>perm <span class="token operator">&lt;-</span> sample<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>A1 <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token punctuation">[</span>perm<span class="token punctuation">]</span><span class="token punctuation">,</span> j<span class="token punctuation">[</span>perm<span class="token punctuation">]</span><span class="token punctuation">,</span> x <span class="token operator">=</span> x<span class="token punctuation">[</span>perm<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>A<span class="token punctuation">,</span> A1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## The slots are 0-index based, so</span>
try<span class="token punctuation">(</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token operator">=</span>A<span class="token operator">@</span>i<span class="token punctuation">,</span> p<span class="token operator">=</span>A<span class="token operator">@</span>p<span class="token punctuation">,</span> x<span class="token operator">=</span> seq_along<span class="token punctuation">(</span>A<span class="token operator">@</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment">## fails and you should say so: 1-indexing is FALSE:</span>
     sparseMatrix<span class="token punctuation">(</span>i<span class="token operator">=</span>A<span class="token operator">@</span>i<span class="token punctuation">,</span> p<span class="token operator">=</span>A<span class="token operator">@</span>p<span class="token punctuation">,</span> x<span class="token operator">=</span> seq_along<span class="token punctuation">(</span>A<span class="token operator">@</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> index1 <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment">## the (i,j) pairs can be repeated, in which case the x's are summed</span>
<span class="token punctuation">(</span>args <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>i <span class="token operator">=</span> c<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j <span class="token operator">=</span> c<span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> c<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>Aa <span class="token operator">&lt;-</span> do.call<span class="token punctuation">(</span>sparseMatrix<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## explicitly ask for elimination of such duplicates, so</span>
<span class="token comment">## that the last one is used:</span>
<span class="token punctuation">(</span>A. <span class="token operator">&lt;-</span> do.call<span class="token punctuation">(</span>sparseMatrix<span class="token punctuation">,</span> c<span class="token punctuation">(</span>args<span class="token punctuation">,</span> list<span class="token punctuation">(</span>use.last.ij <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>Aa<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token comment"># 2+7 == 9</span>
          A.<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 2 was *after* 7</span>

<span class="token comment">## for a pattern matrix, of course there is no "summing":</span>
<span class="token punctuation">(</span>nA <span class="token operator">&lt;-</span> do.call<span class="token punctuation">(</span>sparseMatrix<span class="token punctuation">,</span> args<span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span><span class="token string">"j"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

dn <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">## pointer vectors can be used, and the (i,x) slots are sorted if necessary:</span>
m <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> dimnames <span class="token operator">=</span> dn<span class="token punctuation">)</span>
m
str<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>dimnames<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> dn<span class="token punctuation">)</span><span class="token punctuation">)</span>

sparseMatrix<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">2.72</span><span class="token punctuation">,</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment"># recycling x</span>
sparseMatrix<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment"># recycling x, |--&gt; "lgCMatrix"</span>

<span class="token comment">## no 'x' --&gt; patter*n* matrix:</span>
<span class="token punctuation">(</span>n <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> j<span class="token operator">=</span>rev<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># -&gt; ngCMatrix</span>

<span class="token comment">## an empty sparse matrix:</span>
<span class="token punctuation">(</span>e <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>dims <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## a symmetric one:</span>
<span class="token punctuation">(</span>sy <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span>
                    dims <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> symmetric<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>isSymmetric<span class="token punctuation">(</span>sy<span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>sy<span class="token punctuation">,</span> <span class="token comment">## switch i &lt;-&gt; j {and transpose }</span>
    t<span class="token punctuation">(</span> sparseMatrix<span class="token punctuation">(</span>j<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span>
                    dims <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> symmetric<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## rsparsematrix() calls sparseMatrix() :</span>
M1 <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> nnz <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>M1<span class="token punctuation">)</span>

<span class="token comment">## pointers example in converting from other sparse matrix representations.</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>requireNamespace<span class="token punctuation">(</span><span class="token string">"SparseM"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
   packageVersion<span class="token punctuation">(</span><span class="token string">"SparseM"</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token string">"0.87"</span> <span class="token operator">&amp;&amp;</span>
   nzchar<span class="token punctuation">(</span>dfil <span class="token operator">&lt;-</span> system.file<span class="token punctuation">(</span><span class="token string">"extdata"</span><span class="token punctuation">,</span> <span class="token string">"rua_32_ax.rua"</span><span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"SparseM"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  X <span class="token operator">&lt;-</span> SparseM<span class="token operator">::</span>model.matrix<span class="token punctuation">(</span>SparseM<span class="token operator">::</span>read.matrix.hb<span class="token punctuation">(</span>dfil<span class="token punctuation">)</span><span class="token punctuation">)</span>
  XX <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>j <span class="token operator">=</span> X<span class="token operator">@</span>ja<span class="token punctuation">,</span> p <span class="token operator">=</span> X<span class="token operator">@</span>ia <span class="token operator">-</span> <span class="token number">1L</span><span class="token punctuation">,</span> x <span class="token operator">=</span> X<span class="token operator">@</span>ra<span class="token punctuation">,</span> dims <span class="token operator">=</span> X<span class="token operator">@</span>dimension<span class="token punctuation">)</span>
  validObject<span class="token punctuation">(</span>XX<span class="token punctuation">)</span>

  <span class="token comment">## Alternatively, and even more user friendly :</span>
  X. <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>  <span class="token comment"># or also</span>
  X2 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span>
  stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>XX<span class="token punctuation">,</span> X.<span class="token punctuation">)</span><span class="token punctuation">,</span> identical<span class="token punctuation">(</span>X.<span class="token punctuation">,</span> X2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="sparseMatrix-class">

<a href="#sparseMatrix-class" class="help-page-title"><h2 id="sparseMatrix-class">Virtual Class "sparseMatrix" — Mother of Sparse Matrices</h2></a>

<h3>Description</h3>

<p>Virtual Mother Class of All Sparse Matrices</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the dimensions
of the matrix - must be an integer vector with exactly two
non-negative values.</p>
</dd>
<dt>
<code>Dimnames</code>:</dt>
<dd>
<p>a list of length two - inherited from class
<code>Matrix</code>, see <code><a href="#Matrix-class">Matrix</a></code>.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"Matrix"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>show</dt>
<dd>
<p><code>(object = "sparseMatrix")</code>: The
<code><a href="https://r-universe.dev/manuals/methods.html#show">show</a></code> method for sparse matrices prints
<em>“structural”</em> zeroes as <code>"."</code> using
<code><a href="#printSpMatrix">printSpMatrix</a>()</code> which allows further customization.</p>
</dd>
<dt>print</dt>
<dd>
<p><code>signature(x = "sparseMatrix")</code>, ....<br>
The <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code> method for sparse matrices by default is the
same as <code>show()</code> but can be called with extra optional
arguments, see <code><a href="#printSpMatrix">printSpMatrix</a>()</code>.</p>
</dd>
<dt>format</dt>
<dd>
<p><code>signature(x = "sparseMatrix")</code>, ....<br>
The <code><a href="https://r-universe.dev/manuals/base.html#format">format</a></code> method for sparse matrices, see
<code><a href="#printSpMatrix">formatSpMatrix</a>()</code> for details such as the extra
optional arguments.</p>
</dd>
<dt>summary</dt>
<dd>
<p><code>(object = "sparseMatrix", uniqT=FALSE)</code>: Returns
an object of S3 class <code>"sparseSummary"</code> which is basically a
<code><a href="https://r-universe.dev/manuals/base.html#data.frame">data.frame</a></code> with columns <code>(i,j,x)</code> (or just
<code>(i,j)</code> for <code><a href="#nsparseMatrix-classes">nsparseMatrix</a></code> class objects)
with the stored (typically non-zero) entries.  The
<code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code> method resembles Matlab's way of printing
sparse matrices, and also the MatrixMarket format, see
<code><a href="#externalFormats">writeMM</a></code>.</p>
</dd>
<dt>cbind2</dt>
<dd>
<p><code>(x = *, y = *)</code>: several methods for binding
matrices together, column-wise, see the basic <code><a href="https://r-universe.dev/manuals/base.html#cbind">cbind</a></code>
and <code><a href="https://r-universe.dev/manuals/base.html#cbind">rbind</a></code> functions.<br>
Note that the result will typically be sparse, even when one
argument is dense and larger than the sparse one.
</p>
</dd>
<dt>rbind2</dt>
<dd>
<p><code>(x = *, y = *)</code>: binding matrices together
row-wise, see <code>cbind2</code> above.</p>
</dd>
<dt>determinant</dt>
<dd>
<p><code>(x = "sparseMatrix", logarithm=TRUE)</code>:
<code><a href="https://r-universe.dev/manuals/base.html#det">determinant</a>()</code> methods for sparse matrices typically
work via <code><a href="#Cholesky">Cholesky</a></code> or <code><a href="#lu">lu</a></code> decompositions.</p>
</dd>
<dt>diag</dt>
<dd>
<p><code>(x = "sparseMatrix")</code>: extracts the diagonal of a
sparse matrix.</p>
</dd>
<dt>dim&lt;-</dt>
<dd>
<p><code>signature(x = "sparseMatrix", value = "ANY")</code>:
allows to <em>reshape</em> a sparse matrix to a sparse matrix with
the same entries but different dimensions. <code>value</code> must be of
length two and fulfill <code>prod(value) == prod(dim(x))</code>.</p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "factor", to = "sparseMatrix")</code>:
Coercion of a factor to <code>"sparseMatrix"</code> produces the matrix
of indicator <b>rows</b> stored as an object of class
<code>"dgCMatrix"</code>.  To obtain columns representing the interaction
of the factor and a numeric covariate, replace the <code>"x"</code> slot
of the result by the numeric covariate then take the transpose.
Missing values (<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>) from the factor are translated
to columns of all <code>0</code>s.</p>
</dd>
</dl>
<p>See also <code><a href="#colSums">colSums</a></code>, <code><a href="#norm">norm</a></code>,
... 
for methods with separate help pages.
</p>


<h3>Note</h3>

<p>In method selection for multiplication operations (i.e. <code>%*%</code>
and the two-argument form of <code><a href="https://r-universe.dev/manuals/base.html#crossprod">crossprod</a></code>)
the sparseMatrix class takes precedence in the sense that if one
operand is a sparse matrix and the other is any type of dense matrix
then the dense matrix is coerced to a <code>dgeMatrix</code> and the
appropriate sparse matrix method is used.
</p>


<h3>See Also</h3>

<p><code><a href="#sparseMatrix">sparseMatrix</a></code>, and its references, such as
<code><a href="https://r-universe.dev/manuals/stats.html#xtabs">xtabs</a>(*, sparse=TRUE)</code>, or
<code><a href="#sparse.model.matrix">sparse.model.matrix</a>()</code>,
for constructing sparse matrices.
</p>
<p><code><a href="#graph2T">T2graph</a></code> for conversion of <code>"graph"</code> objects
(package <span class="pkg">graph</span>) to and from sparse matrices.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span> <span class="token comment">## and look at the help() of its subclasses</span>
M <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
M<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> M<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">3.14</span>
M  <span class="token comment">## show(.) method suppresses printing of the majority of rows</span>

data<span class="token punctuation">(</span>CAex<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
dim<span class="token punctuation">(</span>CAex<span class="token punctuation">)</span> <span class="token comment"># 72 x 72 matrix</span>
determinant<span class="token punctuation">(</span>CAex<span class="token punctuation">)</span> <span class="token comment"># works via sparse lu(.)</span>

<span class="token comment">## factor -&gt; t( &lt;sparse design matrix&gt; ) :</span>
<span class="token punctuation">(</span>fact <span class="token operator">&lt;-</span> gl<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>Xt <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>fact<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># indicator rows</span>

<span class="token comment">## missing values --&gt; all-0 columns:</span>
f.mis <span class="token operator">&lt;-</span> fact
i.mis <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span>
is.na<span class="token punctuation">(</span>f.mis<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> i.mis
Xt <span class="token operator">!=</span> <span class="token punctuation">(</span>X. <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>f.mis<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># differ only in columns 3:5,17</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>X.<span class="token punctuation">[</span><span class="token punctuation">,</span>i.mis<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span>Xt<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token operator">-</span>i.mis<span class="token punctuation">]</span> <span class="token operator">==</span> X.<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token operator">-</span>i.mis<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="sparseQR-class">

<a href="#sparseQR-class" class="help-page-title"><h2 id="sparseQR-class">Sparse QR Factorizations</h2></a>

<h3>Description</h3>

<p><code>sparseQR</code> is the class of sparse, row- and column-pivoted
QR factorizations of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≥</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \ge n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>)
real matrices, having the general form
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><mi>Q</mi><mi>R</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>Q</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>Q</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>R</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><msub><mi>Q</mi><mn>1</mn></msub><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1 A P_2 = Q R = \begin{bmatrix} Q_1 &amp; Q_2 \end{bmatrix} 
    \begin{bmatrix} R_1 \\ 0 \end{bmatrix} = Q_1 R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>or (equivalently)
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>Q</mi><mi>R</mi><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>Q</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>Q</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>R</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>Q</mi><mn>1</mn></msub><msub><mi>R</mi><mn>1</mn></msub><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">A = P_1' Q R P_2' = P_1' \begin{bmatrix} Q_1 &amp; Q_2 \end{bmatrix} 
    \begin{bmatrix} R_1 \\ 0 \end{bmatrix} P_2' = P_1' Q_1 R_1 P_2'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.00773em;">QR</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are permutation matrices,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>H</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">Q = \prod_{j = 1}^{n} H_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2401em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code>
is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> orthogonal matrix
(<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> contains the first <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> column vectors)
equal to the product of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> Householder matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">H_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code>, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code> is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> upper trapezoidal matrix
(<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> contains the first <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> row vectors and is
upper <em>triangular</em>) with non-negative diagonal elements.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">qrR<span class="token punctuation">(</span>qr<span class="token punctuation">,</span> complete <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> backPermute <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> row.names <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="sparseQR-class_:_qr">qr</code></td>
<td>
<p>an object of class <code><a href="#sparseQR-class">sparseQR</a></code>,
almost always the result of a call to generic function <code>qr</code>
with sparse <code>x</code>.</p>
</td>
</tr>
<tr>
<td><code id="sparseQR-class_:_complete">complete</code></td>
<td>
<p>a logical indicating if <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code> should be returned
instead of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.</p>
</td>
</tr>
<tr>
<td><code id="sparseQR-class_:_backPermute">backPermute</code></td>
<td>
<p>a logical indicating if <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code> or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
should be multiplied on the right by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">P_2'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>.</p>
</td>
</tr>
<tr>
<td><code id="sparseQR-class_:_row.names">row.names</code></td>
<td>
<p>a logical indicating if <code>dimnames(qr)[1]</code>
should be propagated unpermuted to the result.
If <code>complete = FALSE</code>, then only the first <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> names are kept.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method for <code>qr.Q</code> does not return <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></code> but rather the
(also orthogonal) product <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>Q</mi></mrow><annotation encoding="application/x-tex">P_1' Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">Q</span></span></span></span></code>.  This behaviour
is algebraically consistent with the <span class="pkg">base</span> implementation
(see <code><a href="https://r-universe.dev/manuals/base.html#qr">qr</a></code>), which can be seen by noting that
<code>qr.default</code> in <span class="pkg">base</span> does not pivot rows, constraining
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> to be an identity matrix.  It follows that
<code>qr.Q(qr.default(x))</code> also returns <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>Q</mi></mrow><annotation encoding="application/x-tex">P_1' Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">Q</span></span></span></span></code>.
</p>
<p>Similarly, the methods for <code>qr.qy</code> and <code>qr.qty</code> multiply
on the left by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>Q</mi></mrow><annotation encoding="application/x-tex">P_1' Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">Q</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Q' P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
rather than <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">Q'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>.
</p>
<p>It is wrong to expect the values of <code>qr.Q</code> (or <code>qr.R</code>,
<code>qr.qy</code>, <code>qr.qty</code>) computed from “equivalent”
sparse and dense factorizations
(say, <code>qr(x)</code> and <code>qr(as(x, "matrix"))</code> for <code>x</code>
of class <code><a href="#dgCMatrix-class">dgCMatrix</a></code>) to compare equal.
The underlying factorization algorithms are quite different,
notably as they employ different pivoting strategies,
and in general the factorization is not unique even for fixed
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.
</p>
<p>On the other hand, the values of <code>qr.X</code>, <code>qr.coef</code>,
<code>qr.fitted</code>, and <code>qr.resid</code> are well-defined, and
in those cases the sparse and dense computations <em>should</em>
compare equal (within some tolerance).
</p>
<p>The method for <code>qr.R</code> is a simple wrapper around <code>qrR</code>,
but not back-permuting by default and never giving row names.
It did not support <code>backPermute = TRUE</code> until <span class="pkg">Matrix</span>
<code>1.6-0</code>, hence code needing the back-permuted result should
call <code>qrR</code> if <span class="pkg">Matrix</span> <code>&gt;= 1.6-0</code> is not known.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>, <code>Dimnames</code>
</dt>
<dd>
<p>inherited from virtual class
<code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>.</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>a numeric vector of length <code>Dim[2]</code>,
used to construct Householder matrices; see <code>V</code> below.</p>
</dd>
<dt><code>V</code></dt>
<dd>
<p>an object of class <code><a href="#dgCMatrix-class">dgCMatrix</a></code>
with <code>Dim[2]</code> columns.  The number of rows <code>nrow(V)</code>
is at least <code>Dim[1]</code> and at most <code>Dim[1]+Dim[2]</code>.
<code>V</code> is lower trapezoidal, and its column vectors generate the
Householder matrices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">H_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> that compose the orthogonal
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></code> factor.  Specifically, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">H_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> is constructed as
<code>diag(Dim[1]) - beta[j] * tcrossprod(V[, j])</code>.</p>
</dd>
<dt><code>R</code></dt>
<dd>
<p>an object of class <code><a href="#dgCMatrix-class">dgCMatrix</a></code>
with <code>nrow(V)</code> rows and <code>Dim[2]</code> columns.
<code>R</code> is the upper trapezoidal <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code> factor with
non-negative diagonal elements.</p>
</dd>
<dt>
<code>p</code>, <code>q</code>
</dt>
<dd>
<p>0-based integer vectors of length
<code>nrow(V)</code> and <code>Dim[2]</code>, respectively,
specifying the permutations applied to the rows and columns of
the factorized matrix.  <code>q</code> of length 0 is valid and
equivalent to the identity permutation, implying no column pivoting.
Using <span class="rlang"><b>R</b></span> syntax, the matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_1 A P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
is precisely <code>A[p+1, q+1]</code>
(<code>A[p+1, ]</code> when <code>q</code> has length 0).</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code><a href="#MatrixFactorization-class">QR</a></code>, directly.
Class <code><a href="#MatrixFactorization-class">MatrixFactorization</a></code>, by class
<code><a href="#MatrixFactorization-class">QR</a></code>, distance 2.
</p>


<h3>Instantiation</h3>

<p>Objects can be generated directly by calls of the form
<code>new("sparseQR", ...)</code>, but they are more typically obtained
as the value of <code><a href="#qr-methods">qr</a>(x)</code> for <code>x</code> inheriting from
<code><a href="#sparseMatrix-class">sparseMatrix</a></code> (often <code><a href="#dgCMatrix-class">dgCMatrix</a></code>).
</p>


<h3>Methods</h3>


<dl>
<dt><code>determinant</code></dt>
<dd>
<p><code>signature(from = "sparseQR", logarithm = "logical")</code>:
computes the determinant of the factorized matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code>
or its logarithm.</p>
</dd>
<dt><code>expand1</code></dt>
<dd>
<p><code>signature(x = "sparseQR")</code>:
see <code><a href="#expand">expand1-methods</a></code>.</p>
</dd>
<dt><code>expand2</code></dt>
<dd>
<p><code>signature(x = "sparseQR")</code>:
see <code><a href="#expand">expand2-methods</a></code>.</p>
</dd>
<dt><code>qr.Q</code></dt>
<dd>
<p><code>signature(qr = "sparseQR")</code>:
returns as a <code><a href="#dgeMatrix-class">dgeMatrix</a></code> either
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>Q</mi></mrow><annotation encoding="application/x-tex">P_1' Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">Q</span></span></span></span></code> or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>Q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1' Q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>,
depending on optional argument <code>complete</code>.  The default
is <code>FALSE</code>, indicating <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>Q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1' Q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.</p>
</dd>
<dt><code>qr.R</code></dt>
<dd>
<p><code>signature(qr = "sparseQR")</code>:
<code>qrR</code> returns <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></code>, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>, 
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>P</mi><msup><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">R P2'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RP</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>, or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mi>P</mi><msup><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">R_1 P2'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9019em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>,
depending on optional arguments <code>complete</code> and
<code>backPermute</code>.  The default in both cases is <code>FALSE</code>,
indicating <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>, for compatibility with <span class="pkg">base</span>.  
The class of the result in that case is
<code><a href="#dtCMatrix-class">dtCMatrix</a></code>.  In the other three cases,
it is <code><a href="#dgCMatrix-class">dgCMatrix</a></code>.</p>
</dd>
<dt><code>qr.X</code></dt>
<dd>
<p><code>signature(qr = "sparseQR")</code>:
returns <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></code> as a <code><a href="#dgeMatrix-class">dgeMatrix</a></code>,
by default.  If <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m &gt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> and optional argument
<code>ncol</code> is greater than <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, then the result
is augmented with <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>Q</mi><mi>J</mi></mrow><annotation encoding="application/x-tex">P_1' Q J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">Q</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span></code>, where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span></code> is composed of columns <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></code> through
<code>ncol</code> of the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></code> identity matrix.</p>
</dd>
<dt><code>qr.coef</code></dt>
<dd>
<p><code>signature(qr = "sparseQR", y = .)</code>:
returns as a <code><a href="#dgeMatrix-class">dgeMatrix</a></code> or vector
the result of multiplying <code>y</code> on the left by
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub><msubsup><mi>R</mi><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msubsup><mi>Q</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_2 R_1^{-1} Q_1' P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.</p>
</dd>
<dt><code>qr.fitted</code></dt>
<dd>
<p><code>signature(qr = "sparseQR", y = .)</code>:
returns as a <code><a href="#dgeMatrix-class">dgeMatrix</a></code> or vector
the result of multiplying <code>y</code> on the left by
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>Q</mi><mn>1</mn></msub><msubsup><mi>Q</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1' Q_1 Q_1' P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.</p>
</dd>
<dt><code>qr.resid</code></dt>
<dd>
<p><code>signature(qr = "sparseQR", y = .)</code>:
returns as a <code><a href="#dgeMatrix-class">dgeMatrix</a></code> or vector
the result of multiplying <code>y</code> on the left by
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>Q</mi><mn>2</mn></msub><msubsup><mi>Q</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1' Q_2 Q_2' P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.</p>
</dd>
<dt><code>qr.qty</code></dt>
<dd>
<p><code>signature(qr = "sparseQR", y = .)</code>:
returns as a <code><a href="#dgeMatrix-class">dgeMatrix</a></code> or vector
the result of multiplying <code>y</code> on the left by
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Q' P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>.</p>
</dd>
<dt><code>qr.qy</code></dt>
<dd>
<p><code>signature(qr = "sparseQR", y = .)</code>:
returns as a <code><a href="#dgeMatrix-class">dgeMatrix</a></code> or vector
the result of multiplying <code>y</code> on the left by
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>Q</mi></mrow><annotation encoding="application/x-tex">P_1' Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord mathnormal">Q</span></span></span></span></code>.</p>
</dd>
<dt><code>solve</code></dt>
<dd>
<p><code>signature(a = "sparseQR", b = .)</code>:
see <code><a href="#solve-methods">solve-methods</a></code>.</p>
</dd>
</dl>
<h3>References</h3>

<p>Davis, T. A. (2006).
<em>Direct methods for sparse linear systems</em>.
Society for Industrial and Applied Mathematics.
<a href="https://doi.org/10.1137/1.9780898718881" target="_blank">doi:10.1137/1.9780898718881</a>
</p>
<p>Golub, G. H., &amp; Van Loan, C. F. (2013).
<em>Matrix computations</em> (4th ed.).
Johns Hopkins University Press.
<a href="https://doi.org/10.56021/9781421407944" target="_blank">doi:10.56021/9781421407944</a>
</p>


<h3>See Also</h3>

<p>Class <code><a href="#dgCMatrix-class">dgCMatrix</a></code>.
</p>
<p>Generic function <code><a href="https://r-universe.dev/manuals/base.html#qr">qr</a></code> from <span class="pkg">base</span>,
whose default method <code>qr.default</code> “defines”
the S3 class <code>qr</code> of dense QR factorizations.
</p>
<p><code><a href="#qr-methods">qr-methods</a></code> for methods defined in <span class="pkg">Matrix</span>.
</p>
<p>Generic functions <code><a href="#expand">expand1</a></code> and <code><a href="#expand">expand2</a></code>.
</p>
<p>The many auxiliary functions for QR factorizations:
<code><a href="https://r-universe.dev/manuals/base.html#qraux">qr.Q</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#qraux">qr.R</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#qraux">qr.X</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#qr">qr.coef</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#qr">qr.fitted</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#qr">qr.resid</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#qr">qr.qty</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#qr">qr.qy</a></code>, and <code><a href="https://r-universe.dev/manuals/base.html#qr">qr.solve</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"sparseQR"</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

m <span class="token operator">&lt;-</span> <span class="token number">300L</span>
n <span class="token operator">&lt;-</span> <span class="token number">60L</span>
A <span class="token operator">&lt;-</span> rsparsematrix<span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span>

<span class="token comment">## With dimnames, to see that they are propagated :</span>
dimnames<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> dn <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>paste0<span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                          paste0<span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>qr.A <span class="token operator">&lt;-</span> qr<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>e.qr.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>qr.A<span class="token punctuation">,</span> complete <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>E.qr.A <span class="token operator">&lt;-</span> expand2<span class="token punctuation">(</span>qr.A<span class="token punctuation">,</span> complete <span class="token operator">=</span>  <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max.level <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">)</span>

t<span class="token punctuation">(</span>sapply<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">,</span> dim<span class="token punctuation">)</span><span class="token punctuation">)</span>
t<span class="token punctuation">(</span>sapply<span class="token punctuation">(</span>E.qr.A<span class="token punctuation">,</span> dim<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Horribly inefficient, but instructive :</span>
slowQ <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> beta<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    d <span class="token operator">&lt;-</span> dim<span class="token punctuation">(</span>V<span class="token punctuation">)</span>
    Q <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">2L</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0L</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> d<span class="token punctuation">[</span><span class="token number">2L</span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token number">1L</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cat<span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">,</span> sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
            Q <span class="token operator">&lt;-</span> Q <span class="token operator">-</span> <span class="token punctuation">(</span>beta<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> tcrossprod<span class="token punctuation">(</span>V<span class="token punctuation">[</span><span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%*%</span> Q
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    Q
<span class="token punctuation">}</span>

ae1 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> all.equal<span class="token punctuation">(</span>as<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
ae2 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> ae1<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> unname<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## A ~ P1' Q R P2' ~ P1' Q1 R1 P2' in floating point</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"P1."</span><span class="token punctuation">,</span> <span class="token string">"Q1"</span><span class="token punctuation">,</span> <span class="token string">"R1"</span><span class="token punctuation">,</span> <span class="token string">"P2."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>names<span class="token punctuation">(</span>E.qr.A<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"P1."</span><span class="token punctuation">,</span> <span class="token string">"Q"</span> <span class="token punctuation">,</span> <span class="token string">"R"</span> <span class="token punctuation">,</span> <span class="token string">"P2."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P1."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              new<span class="token punctuation">(</span><span class="token string">"pMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>m<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">,</span> Dimnames <span class="token operator">=</span> c<span class="token punctuation">(</span>dn<span class="token punctuation">[</span><span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  margin <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">,</span> perm <span class="token operator">=</span> invertPerm<span class="token punctuation">(</span>qr.A<span class="token operator">@</span>p<span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"P2."</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              new<span class="token punctuation">(</span><span class="token string">"pMatrix"</span><span class="token punctuation">,</span> Dim <span class="token operator">=</span> c<span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> Dimnames <span class="token operator">=</span> c<span class="token punctuation">(</span>list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dn<span class="token punctuation">[</span><span class="token number">2L</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  margin <span class="token operator">=</span> <span class="token number">2L</span><span class="token punctuation">,</span> perm <span class="token operator">=</span> invertPerm<span class="token punctuation">(</span>qr.A<span class="token operator">@</span>q<span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"R1"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> triu<span class="token punctuation">(</span>E.qr.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"R"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"Q1"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      E.qr.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"Q"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
    identical<span class="token punctuation">(</span>E.qr.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"R"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> qr.A<span class="token operator">@</span>R<span class="token punctuation">)</span>
 <span class="token comment">## ae1(E.qr.A[["Q"]], slowQ(qr.A@V, qr.A@beta))</span>
    ae1<span class="token punctuation">(</span>crossprod<span class="token punctuation">(</span>E.qr.A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"Q"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae1<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> Q1 <span class="token percent-operator operator">%*%</span> R1 <span class="token percent-operator operator">%*%</span> P2.<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae1<span class="token punctuation">(</span>A<span class="token punctuation">,</span> with<span class="token punctuation">(</span>E.qr.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> Q  <span class="token percent-operator operator">%*%</span> R  <span class="token percent-operator operator">%*%</span> P2.<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>A.perm <span class="token operator">&lt;-</span> A<span class="token punctuation">[</span>qr.A<span class="token operator">@</span>p <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">,</span> qr.A<span class="token operator">@</span>q <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">]</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">,</span> Q1 <span class="token percent-operator operator">%*%</span> R1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>A.perm                               <span class="token punctuation">,</span> with<span class="token punctuation">(</span>E.qr.A<span class="token punctuation">,</span> Q  <span class="token percent-operator operator">%*%</span> R <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## More identities</span>
b <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    ae1<span class="token punctuation">(</span>qrX <span class="token operator">&lt;-</span> qr.X     <span class="token punctuation">(</span>qr.A   <span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>qrQ <span class="token operator">&lt;-</span> qr.Q     <span class="token punctuation">(</span>qr.A   <span class="token punctuation">)</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> Q1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>       qr.R     <span class="token punctuation">(</span>qr.A   <span class="token punctuation">)</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">,</span> R1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>qrc <span class="token operator">&lt;-</span> qr.coef  <span class="token punctuation">(</span>qr.A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">,</span> solve<span class="token punctuation">(</span>R1 <span class="token percent-operator operator">%*%</span> P2.<span class="token punctuation">,</span> t<span class="token punctuation">(</span>qrQ<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%*%</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>qrf <span class="token operator">&lt;-</span> qr.fitted<span class="token punctuation">(</span>qr.A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>e.qr.A<span class="token punctuation">,</span> tcrossprod<span class="token punctuation">(</span>qrQ<span class="token punctuation">)</span> <span class="token percent-operator operator">%*%</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>qrr <span class="token operator">&lt;-</span> qr.resid <span class="token punctuation">(</span>qr.A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> b <span class="token operator">-</span> qrf<span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>qrq <span class="token operator">&lt;-</span> qr.qy    <span class="token punctuation">(</span>qr.A<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> with<span class="token punctuation">(</span>E.qr.A<span class="token punctuation">,</span> P1. <span class="token percent-operator operator">%*%</span> Q <span class="token percent-operator operator">%*%</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>qr.qty<span class="token punctuation">(</span>qr.A<span class="token punctuation">,</span> qrq<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Sparse and dense computations should agree here</span>
qr.Am <span class="token operator">&lt;-</span> qr<span class="token punctuation">(</span>as<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">"matrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># &lt;=&gt; qr.default(A)</span>
stopifnot<span class="token punctuation">(</span>exprs <span class="token operator">=</span> <span class="token punctuation">{</span>
    ae2<span class="token punctuation">(</span>qrX<span class="token punctuation">,</span> qr.X     <span class="token punctuation">(</span>qr.Am   <span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>qrc<span class="token punctuation">,</span> qr.coef  <span class="token punctuation">(</span>qr.Am<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>qrf<span class="token punctuation">,</span> qr.fitted<span class="token punctuation">(</span>qr.Am<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ae2<span class="token punctuation">(</span>qrr<span class="token punctuation">,</span> qr.resid <span class="token punctuation">(</span>qr.Am<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="sparseVector">

<a href="#sparseVector" class="help-page-title"><h2 id="sparseVector">Sparse Vector Construction from Nonzero Entries</h2></a>

<h3>Description</h3>

<p>User friendly construction of sparse vectors,
i.e., objects inheriting from <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code>
<code><a href="#sparseVector-class">sparseVector</a></code>, from indices and values of its
non-zero entries.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">sparseVector<span class="token punctuation">(</span>x<span class="token punctuation">,</span> i<span class="token punctuation">,</span> length<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="sparseVector_:_x">x</code></td>
<td>
<p>vector of the non zero entries; may be missing in which case a
<code>"nsparseVector"</code> will be returned.</p>
</td>
</tr>
<tr>
<td><code id="sparseVector_:_i">i</code></td>
<td>
<p>integer vector (of the same length as <code>x</code>) specifying
the indices of the non-zero (or non-<code>TRUE</code>) entries of the
sparse vector.</p>
</td>
</tr>
<tr>
<td><code id="sparseVector_:_length">length</code></td>
<td>
<p>length of the sparse vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>zero entries in <code>x</code> are dropped automatically, analogously as
<code><a href="#drop0">drop0</a>()</code> acts on sparse matrices.
</p>


<h3>Value</h3>

<p>a sparse vector, i.e., inheriting from <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code>
<code><a href="#sparseVector-class">sparseVector</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#sparseMatrix">sparseMatrix</a>()</code> constructor for sparse matrices;
the class <code><a href="#sparseVector-class">sparseVector</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">str<span class="token punctuation">(</span>sv <span class="token operator">&lt;-</span> sparseVector<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> i <span class="token operator">=</span> sample<span class="token punctuation">(</span><span class="token number">999</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

sx <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3.2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
ss <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sx<span class="token punctuation">,</span> <span class="token string">"sparseVector"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>ss<span class="token punctuation">,</span>
   sparseVector<span class="token punctuation">(</span>x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">15L</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span><span class="token number">12L</span><span class="token punctuation">,</span><span class="token number">8L</span><span class="token punctuation">,</span><span class="token number">18L</span><span class="token punctuation">,</span> <span class="token number">4L</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">20L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>ns <span class="token operator">&lt;-</span> sparseVector<span class="token punctuation">(</span>i<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>ns<span class="token punctuation">,</span>
      new<span class="token punctuation">(</span><span class="token string">"nsparseVector"</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="sparseVector-class">

<a href="#sparseVector-class" class="help-page-title"><h2 id="sparseVector-class">Sparse Vector Classes</h2></a>

<h3>Description</h3>

<p>Sparse Vector Classes: The virtual mother class
<code>"sparseVector"</code> has the five actual daughter classes
<code>"dsparseVector"</code>, <code>"isparseVector"</code>,
<code>"lsparseVector"</code>, <code>"nsparseVector"</code>, and
<code>"zsparseVector"</code>, where we've mainly implemented methods for
the <code>d*</code>, <code>l*</code> and <code>n*</code> ones.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>length</code>:</dt>
<dd>
<p>class <code>"numeric"</code> - the <code><a href="https://r-universe.dev/manuals/base.html#length">length</a></code>
of the sparse vector.  Note that <code>"numeric"</code> can be
considerably larger than the maximal <code>"integer"</code>,
<code><a href="https://r-universe.dev/manuals/base.html#zMachine">.Machine</a>$integer.max</code>, on purpose.</p>
</dd>
<dt>
<code>i</code>:</dt>
<dd>
<p>class <code>"numeric"</code> - the (1-based) indices of
the non-zero entries.  Must <em>not</em> be <code>NA</code> and strictly
sorted increasingly.
</p>
<p>Note that <code>"integer"</code> is “part of” <code>"numeric"</code>,
and can (and often will) be used for non-huge sparseVectors.</p>
</dd>
<dt>
<code>x</code>:</dt>
<dd>
<p>(for all but <code>"nsparseVector"</code>):
the non-zero entries.  This is of class <code>"numeric"</code> for class
<code>"dsparseVector"</code>,  <code>"logical"</code> for class
<code>"lsparseVector"</code>, etc.
</p>
<p>Note that <code>"nsparseVector"</code>s have no <code>x</code> slot.
Further, mainly for ease of method definitions, we've defined the
class union (see <code><a href="https://r-universe.dev/manuals/methods.html#setClassUnion">setClassUnion</a></code>) of all sparse vector
classes which <em>have</em> an <code>x</code> slot, as class <code>"xsparseVector"</code>.
</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>length</dt>
<dd>
<p><code>signature(x = "sparseVector")</code>: simply extracts
the <code>length</code> slot.</p>
</dd>
<dt>show</dt>
<dd>
<p><code>signature(object = "sparseVector")</code>: The
<code><a href="https://r-universe.dev/manuals/methods.html#show">show</a></code> method for sparse vectors prints
<em>“structural”</em> zeroes as <code>"."</code> using the
non-exported <code>prSpVector</code> function which allows further
customization such as replacing <code>"."</code> by <code>" "</code> (blank).
</p>
<p>Note that <code><a href="https://r-universe.dev/manuals/base.html#options">options</a>(max.print)</code> will influence how many
entries of large sparse vectors are printed at all.</p>
</dd>
<dt>as.vector</dt>
<dd>
<p><code>signature(x = "sparseVector", mode = "character")</code>
coerces sparse vectors to “regular”, i.e., atomic vectors.
This is the same as <code>as(x, "vector")</code>.</p>
</dd>
<dt>as</dt>
<dd>
<p>..: see <code>coerce</code> below</p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "sparseVector", to = "sparseMatrix")</code>, and</p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = "sparseMatrix", to = "sparseVector")</code>,
etc: coercions to and from sparse matrices (<code><a href="#sparseMatrix-class">sparseMatrix</a></code>) are
provided and work analogously as in standard <span class="rlang"><b>R</b></span>, i.e., a vector is
coerced to a 1-column matrix.</p>
</dd>
<dt>dim&lt;-</dt>
<dd>
<p><code>signature(x = "sparseVector", value = "integer")</code>
coerces a sparse vector to a sparse Matrix, i.e., an object
inheriting from <code><a href="#sparseMatrix-class">sparseMatrix</a></code>, of the
appropriate dimension.</p>
</dd>
<dt>head</dt>
<dd>
<p><code>signature(x = "sparseVector")</code>: as with <span class="rlang"><b>R</b></span>'s
(package <span class="pkg">util</span>) <code><a href="https://r-universe.dev/manuals/utils.html#head">head</a></code>, <code>head(x,n)</code> (for
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n &gt;= 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code>) is equivalent to <code>x[1:n]</code>, but here can be much
more efficient, see the example.</p>
</dd>
<dt>tail</dt>
<dd>
<p><code>signature(x = "sparseVector")</code>: analogous to
<code><a href="https://r-universe.dev/manuals/utils.html#head">head</a></code>, see above.</p>
</dd>
<dt>toeplitz</dt>
<dd>
<p><code>signature(x = "sparseVector")</code>: as
<code><a href="https://r-universe.dev/manuals/stats.html#toeplitz">toeplitz</a>(x)</code>, produce the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
Toeplitz matrix from <code>x</code>, where <code>n = length(x)</code>.</p>
</dd>
<dt>rep</dt>
<dd>
<p><code>signature(x = "sparseVector")</code> repeat <code>x</code>,
with the same argument list <code>(x, times, length.out, each,
	...)</code> as the default method for rep().</p>
</dd>
<dt>which</dt>
<dd>
<p><code>signature(x = "nsparseVector")</code> and</p>
</dd>
<dt>which</dt>
<dd>
<p><code>signature(x = "lsparseVector")</code> return the
indices of the non-zero entries (which is trivial for sparse vectors).</p>
</dd>
<dt>Ops</dt>
<dd>
<p><code>signature(e1 = "sparseVector", e2 = "*")</code>: define
arithmetic, compare and logic operations, (see
<code><a href="https://r-universe.dev/manuals/methods.html#S4groupGeneric">Ops</a></code>).</p>
</dd>
<dt>Summary</dt>
<dd>
<p><code>signature(x = "sparseVector")</code>: define
all the <code><a href="https://r-universe.dev/manuals/methods.html#S4groupGeneric">Summary</a></code> methods.</p>
</dd>
<dt>[</dt>
<dd>
<p><code>signature(x = "atomicVector", i = ...)</code>: not only can you
subset (aka <em>“index into”</em>) sparseVectors <code>x[i]</code>
using sparseVectors <code>i</code>, but we also support efficient
subsetting of traditional vectors <code>x</code> by logical sparse
vectors (i.e., <code>i</code> of class <code>"nsparseVector"</code> or
<code>"lsparseVector"</code>).</p>
</dd>
<dt>is.na, is.finite, is.infinite</dt>
<dd>
<p><code>(x = "sparseVector")</code>, and</p>
</dd>
<dt>is.na, is.finite, is.infinite</dt>
<dd>
<p><code>(x = "nsparseVector")</code>:
return <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> or <code>"nsparseVector"</code> of the same
length as <code>x</code>, indicating if/where <code>x</code> is
<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code> (or <code>NaN</code>), finite or infinite, entirely
analogously to the corresponding base <span class="rlang"><b>R</b></span> functions.</p>
</dd>
</dl>
<p><code>c.sparseVector()</code> is an S3 method for all
<code>"sparseVector"</code>s, but automatic dispatch only happens for the
first argument, so it is useful also as regular <span class="rlang"><b>R</b></span> function, see the
examples.
</p>


<h3>See Also</h3>

<p><code><a href="#sparseVector">sparseVector</a>()</code> for friendly construction of sparse
vectors (apart from <code>as(*, "sparseVector")</code>).
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">getClass<span class="token punctuation">(</span><span class="token string">"sparseVector"</span><span class="token punctuation">)</span>
getClass<span class="token punctuation">(</span><span class="token string">"dsparseVector"</span><span class="token punctuation">)</span>
getClass<span class="token punctuation">(</span><span class="token string">"xsparseVector"</span><span class="token punctuation">)</span><span class="token comment"># those with an 'x' slot</span>

sx <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3.2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>ss <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sx<span class="token punctuation">,</span> <span class="token string">"sparseVector"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ix <span class="token operator">&lt;-</span> as.integer<span class="token punctuation">(</span>round<span class="token punctuation">(</span>sx<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>is <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>ix<span class="token punctuation">,</span> <span class="token string">"sparseVector"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">## an "isparseVector" (!)</span>
<span class="token punctuation">(</span>ns <span class="token operator">&lt;-</span> sparseVector<span class="token punctuation">(</span>i<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># "nsparseVector"</span>
<span class="token comment">## rep() works too:</span>
<span class="token punctuation">(</span>ri <span class="token operator">&lt;-</span> rep<span class="token punctuation">(</span>is<span class="token punctuation">,</span> length.out<span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Using `dim&lt;-`  as in base R :</span>
r <span class="token operator">&lt;-</span> ss
dim<span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># becomes a sparse Matrix:</span>
r
<span class="token comment">## or coercion (as as.matrix() in base R):</span>
as<span class="token punctuation">(</span>ss<span class="token punctuation">,</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>ss <span class="token operator">==</span> print<span class="token punctuation">(</span>as<span class="token punctuation">(</span>ss<span class="token punctuation">,</span> <span class="token string">"CsparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## currently has "non-structural" FALSE -- printing as ":"</span>
<span class="token punctuation">(</span>lis <span class="token operator">&lt;-</span> is <span class="token operator">&amp;</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>nn <span class="token operator">&lt;-</span> is<span class="token punctuation">[</span>is <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># all "structural" FALSE</span>

<span class="token comment">## NA-case</span>
sN <span class="token operator">&lt;-</span> sx<span class="token punctuation">;</span> sN<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token keyword">NA</span>
<span class="token punctuation">(</span>svN <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>sN<span class="token punctuation">,</span> <span class="token string">"sparseVector"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

v <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3.2</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         <span class="token string">"sparseVector"</span><span class="token punctuation">)</span>
v <span class="token operator">&lt;-</span> rep<span class="token punctuation">(</span>rep<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> v<span class="token punctuation">[</span>sample<span class="token punctuation">(</span>v<span class="token operator">@</span>i<span class="token punctuation">,</span> <span class="token number">1e6</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
str<span class="token punctuation">(</span>v<span class="token punctuation">)</span>




system.time<span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> hv <span class="token operator">&lt;-</span> head<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">1e6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">##   user  system elapsed</span>
<span class="token comment">##  0.033   0.000   0.032</span>
system.time<span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> h2 <span class="token operator">&lt;-</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1e6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">##   user  system elapsed</span>
<span class="token comment">##  1.317   0.000   1.319</span>

stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>hv<span class="token punctuation">,</span> h2<span class="token punctuation">)</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>is <span class="token operator">|</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> is <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  validObject<span class="token punctuation">(</span>svN<span class="token punctuation">)</span><span class="token punctuation">,</span> validObject<span class="token punctuation">(</span>lis<span class="token punctuation">)</span><span class="token punctuation">,</span> as.logical<span class="token punctuation">(</span>is.na<span class="token punctuation">(</span>svN<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  identical<span class="token punctuation">(</span>is<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>	is <span class="token operator">&amp;</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  all<span class="token punctuation">(</span><span class="token operator">!</span>lis<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">!</span>any<span class="token punctuation">(</span>lis<span class="token punctuation">)</span><span class="token punctuation">,</span> length<span class="token punctuation">(</span>nn<span class="token operator">@</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">!</span>any<span class="token punctuation">(</span>nn<span class="token punctuation">)</span><span class="token punctuation">,</span> all<span class="token punctuation">(</span><span class="token operator">!</span>nn<span class="token punctuation">)</span><span class="token punctuation">,</span>
	  sum<span class="token punctuation">(</span>lis<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">!</span>prod<span class="token punctuation">(</span>lis<span class="token punctuation">)</span><span class="token punctuation">,</span> range<span class="token punctuation">(</span>lis<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## create and use the t(.) method:</span>
t<span class="token punctuation">(</span>x20 <span class="token operator">&lt;-</span> sparseVector<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>T20 <span class="token operator">&lt;-</span> toeplitz<span class="token punctuation">(</span>x20<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>is<span class="token punctuation">(</span>T20<span class="token punctuation">,</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> is<span class="token punctuation">(</span>T20<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	  identical<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>as.matrix<span class="token punctuation">(</span>T20<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    toeplitz<span class="token punctuation">(</span>as.vector<span class="token punctuation">(</span>x20<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## c() method for "sparseVector" - also available as regular function</span>
<span class="token punctuation">(</span>c1 <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>x20<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token operator">*</span>x20<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>c2 <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>ns<span class="token punctuation">,</span> is<span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>c3 <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>ns<span class="token punctuation">,</span> <span class="token operator">!</span>ns<span class="token punctuation">,</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>c4 <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>ns<span class="token punctuation">,</span> rev<span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## here, c() would produce a list {not dispatching to c.sparseVector()}</span>
<span class="token punctuation">(</span>c5 <span class="token operator">&lt;-</span> c.sparseVector<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> x20<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## checking (consistency)</span>
.v <span class="token operator">&lt;-</span> as.vector
.s <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> as<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token string">"sparseVector"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>
  all.equal<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> .s<span class="token punctuation">(</span>c<span class="token punctuation">(</span>.v<span class="token punctuation">(</span>x20<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token operator">*</span>.v<span class="token punctuation">(</span>x20<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      tol<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  all.equal<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> .s<span class="token punctuation">(</span>c<span class="token punctuation">(</span>.v<span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">,</span> .v<span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            tol<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  all.equal<span class="token punctuation">(</span>c3<span class="token punctuation">,</span> .s<span class="token punctuation">(</span>c<span class="token punctuation">(</span>.v<span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">!</span>.v<span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tol<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  all.equal<span class="token punctuation">(</span>c4<span class="token punctuation">,</span> .s<span class="token punctuation">(</span>c<span class="token punctuation">(</span>.v<span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">,</span> rev<span class="token punctuation">(</span>.v<span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              tol<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  all.equal<span class="token punctuation">(</span>c5<span class="token punctuation">,</span> .s<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> .v<span class="token punctuation">(</span>x20<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                     tol<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="spMatrix">

<a href="#spMatrix" class="help-page-title"><h2 id="spMatrix">Sparse Matrix Constructor From Triplet</h2></a>

<h3>Description</h3>

<p>User friendly construction of a sparse matrix (inheriting from class
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>) from the triplet representation.
</p>
<p>This is much less flexible than <code><a href="#sparseMatrix">sparseMatrix</a>()</code> and hence
somewhat <em>deprecated</em>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">spMatrix<span class="token punctuation">(</span>nrow<span class="token punctuation">,</span> ncol<span class="token punctuation">,</span> i <span class="token operator">=</span> integer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j <span class="token operator">=</span> integer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> double<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td>
<code id="spMatrix_:_nrow">nrow</code>, <code id="spMatrix_:_ncol">ncol</code>
</td>
<td>
<p>integers specifying the desired number of rows and
columns.</p>
</td>
</tr>
<tr>
<td>
<code id="spMatrix_:_i">i</code>, <code id="spMatrix_:_j">j</code>
</td>
<td>
<p>integer vectors of the same length specifying the locations
of the non-zero (or non-<code>TRUE</code>) entries of the matrix.</p>
</td>
</tr>
<tr>
<td><code id="spMatrix_:_x">x</code></td>
<td>
<p>atomic vector of the same length as <code>i</code> and <code>j</code>,
specifying the values of the non-zero entries.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A sparse matrix in triplet form, as an <span class="rlang"><b>R</b></span> object inheriting from both
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code> and
<code><a href="#generalMatrix-class">generalMatrix</a></code>.
</p>
<p>The matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></code> will have
<code>M[i[k], j[k]] == x[k]</code>, for <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">k = 1,2,\ldots, n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, where
<code>n = length(i)</code> and
<code>M[ i', j' ] == 0</code> for all other pairs <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i',j')</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#Matrix">Matrix</a>(*, sparse=TRUE)</code> for the more usual
constructor of such matrices.  Then, <code><a href="#sparseMatrix">sparseMatrix</a></code>
is more general and flexible than <code>spMatrix()</code> and by default
returns a <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> which is often slightly
more desirable.   Further, <code><a href="#bdiag">bdiag</a></code> and
<code><a href="#Diagonal">Diagonal</a></code> for (block-)diagonal matrix constructors.
</p>
<p>Consider <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code> and similar class
definition help files.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## simple example</span>
A <span class="token operator">&lt;-</span> spMatrix<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span> i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     j <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     x <span class="token operator">=</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
A <span class="token comment"># a "dgTMatrix"</span>
summary<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
str<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token comment"># note that *internally* 0-based indices (i,j) are used</span>

L <span class="token operator">&lt;-</span> spMatrix<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> i <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">27</span><span class="token punctuation">,</span>
              <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">27</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%%</span> <span class="token number">4</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span>
L <span class="token comment"># an "lgTMatrix"</span>


<span class="token comment">## A simplified predecessor of  Matrix'  rsparsematrix() function :</span>

 rSpMatrix <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>nrow<span class="token punctuation">,</span> ncol<span class="token punctuation">,</span> nnz<span class="token punctuation">,</span>
                       rand.x <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>nnz<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
     <span class="token comment">## Purpose: random sparse matrix</span>
     <span class="token comment">## --------------------------------------------------------------</span>
     <span class="token comment">## Arguments: (nrow,ncol): dimension</span>
     <span class="token comment">##          nnz  :  number of non-zero entries</span>
     <span class="token comment">##         rand.x:  random number generator for 'x' slot</span>
     <span class="token comment">## --------------------------------------------------------------</span>
     <span class="token comment">## Author: Martin Maechler, Date: 14.-16. May 2007</span>
     stopifnot<span class="token punctuation">(</span><span class="token punctuation">(</span>nnz <span class="token operator">&lt;-</span> as.integer<span class="token punctuation">(</span>nnz<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span>
               nrow <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> ncol <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> nnz <span class="token operator">&lt;=</span> nrow <span class="token operator">*</span> ncol<span class="token punctuation">)</span>
     spMatrix<span class="token punctuation">(</span>nrow<span class="token punctuation">,</span> ncol<span class="token punctuation">,</span>
              i <span class="token operator">=</span> sample<span class="token punctuation">(</span>nrow<span class="token punctuation">,</span> nnz<span class="token punctuation">,</span> replace <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              j <span class="token operator">=</span> sample<span class="token punctuation">(</span>ncol<span class="token punctuation">,</span> nnz<span class="token punctuation">,</span> replace <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              x <span class="token operator">=</span> rand.x<span class="token punctuation">(</span>nnz<span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 M1 <span class="token operator">&lt;-</span> rSpMatrix<span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> nnz <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span>
 summary<span class="token punctuation">(</span>M1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Subassign-methods">

<a href="#Subassign-methods" class="help-page-title"><h2 id="Subassign-methods">Methods for "[&lt;-" - Assigning to Subsets for 'Matrix'</h2></a>

<h3>Description</h3>

<p>Methods for <code>"[&lt;-"</code>, i.e., extraction or subsetting mostly of
matrices, in package <span class="pkg">Matrix</span>.
</p>
<p><b>Note</b>: Contrary to standard <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code> assignment in
base <span class="rlang"><b>R</b></span>, in <code>x[..] &lt;- val</code> it is typically an <b>error</b> (see
<code><a href="https://r-universe.dev/manuals/base.html#stop">stop</a></code>) when the <a href="https://r-universe.dev/manuals/base.html#typeof">type</a> or <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> of
<code>val</code> would require the class of <code>x</code> to be changed, e.g.,
when <code>x</code> is logical, say <code>"lsparseMatrix"</code>, and <code>val</code>
is numeric.
In other cases, e.g., when <code>x</code> is a <code>"nsparseMatrix"</code> and
<code>val</code> is not <code>TRUE</code> or <code>FALSE</code>, a warning is signalled,
and <code>val</code> is “interpreted” as <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code>, and
(logical) <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code> is interpreted as <code>TRUE</code>.
</p>


<h3>Methods</h3>

<p>There are <em>many many</em> more than these:
</p>

<dl>
<dt>x = "Matrix", i = "missing", j = "missing", value= "ANY"</dt>
<dd>
<p>is currently a simple fallback method implementation which ensures
“readable” error messages.</p>
</dd>
<dt>x = "Matrix", i = "ANY", j = "ANY", value= "ANY"</dt>
<dd>
<p> currently
gives an error </p>
</dd>
<dt>x = "denseMatrix", i = "index", j = "missing", value= "numeric"</dt>
<dd>
<p> ... </p>
</dd>
<dt>x = "denseMatrix", i = "index", j = "index", value= "numeric"</dt>
<dd>
<p> ... </p>
</dd>
<dt>x = "denseMatrix", i = "missing", j = "index", value= "numeric"</dt>
<dd>
<p> ... </p>
</dd>
</dl>
<h3>See Also</h3>


<p><code><a href="#Xtrct-methods">[-methods</a></code> for subsetting <code>"Matrix"</code> objects; the
<code><a href="#index-class">index</a></code> class;
<code><a href="https://r-universe.dev/manuals/base.html#Extract">Extract</a></code> about the standard subset assignment (and extraction).
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">set.seed<span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>a <span class="token operator">&lt;-</span> m <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">2.2</span> <span class="token comment"># &lt;&lt;- replaces **every** entry</span>
a
<span class="token comment">## as do these:</span>
a<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">3</span> <span class="token punctuation">;</span> a<span class="token punctuation">[</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">4</span>

m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>  <span class="token operator">&lt;-</span> <span class="token number">3.14</span> <span class="token comment"># simple number</span>
m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">&lt;-</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span>  <span class="token comment"># simple numeric of length 2</span>

<span class="token comment">## sub matrix assignment:</span>
m<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">#-&gt; upper right corner of 'm'</span>
m<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
m<span class="token punctuation">[</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> Diagonal<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
m

<span class="token comment">## rows or columns only:</span>
m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">10</span>
m<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span>
m<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">0</span> <span class="token comment"># not the first 6 rows, i.e. only the 7th</span>
as<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">"sparseMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Xtrct-methods">

<a href="#Xtrct-methods" class="help-page-title"><h2 id="Subscript-methods">Methods for "[": Extraction or Subsetting in Package 'Matrix'</h2></a>

<h3>Description</h3>

<p>Methods for <code>"["</code>, i.e., extraction or subsetting mostly of
matrices, in package <span class="pkg">Matrix</span>.
</p>


<h3>Methods</h3>

<p>There are more than these:
</p>

<dl>
<dt>x = "Matrix", i = "missing", j = "missing", drop= "ANY"</dt>
<dd>
<p> ... </p>
</dd>
<dt>x = "Matrix", i = "numeric", j = "missing", drop= "missing"</dt>
<dd>
<p> ... </p>
</dd>
<dt>x = "Matrix", i = "missing", j = "numeric", drop= "missing"</dt>
<dd>
<p> ... </p>
</dd>
<dt>x = "dsparseMatrix", i = "missing", j = "numeric", drop= "logical"</dt>
<dd>
<p> ... </p>
</dd>
<dt>x = "dsparseMatrix", i = "numeric", j = "missing", drop= "logical"</dt>
<dd>
<p> ... </p>
</dd>
<dt>x = "dsparseMatrix", i = "numeric", j = "numeric", drop= "logical"</dt>
<dd>
<p> ... </p>
</dd>
</dl>
<h3>See Also</h3>

<p><code><a href="#Subassign-methods">[&lt;–methods</a></code> for sub<em>assign</em>ment to <code>"Matrix"</code>
objects.
<code><a href="https://r-universe.dev/manuals/base.html#Extract">Extract</a></code> about the standard extraction.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">str<span class="token punctuation">(</span>m <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span>round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>m<span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>   <span class="token comment"># simple number</span>
m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token comment"># simple numeric of length 2</span>
m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> drop<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">]</span> <span class="token comment"># sub matrix of class 'dgeMatrix'</span>
<span class="token comment">## rows or columns only:</span>
m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span>     <span class="token comment"># first row, as simple numeric vector</span>
m<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span>   <span class="token comment"># sub matrix of first two columns</span>

showMethods<span class="token punctuation">(</span><span class="token string">"["</span><span class="token punctuation">,</span> inherited <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="symmetricMatrix-class">

<a href="#symmetricMatrix-class" class="help-page-title"><h2 id="symmetricMatrix-class">Virtual Class of Symmetric Matrices in Package Matrix</h2></a>

<h3>Description</h3>

<p>The virtual class of symmetric matrices, <code>"symmetricMatrix"</code>,
from the package <span class="pkg">Matrix</span> contains numeric and logical, dense and
sparse matrices, e.g., see the examples with the “actual”
subclasses.
</p>
<p>The main use is in methods (and C functions) that can deal with
all symmetric matrices, and in <code>as(*, "symmetricMatrix")</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>.  Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>


<dt>
<code>Dim, Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>),
inherited from the <code><a href="#Matrix-class">Matrix</a></code>, see there.  See below,
about storing only one of the two <code>Dimnames</code> components.</p>
</dd>
<dt>
<code>factors</code>:</dt>
<dd>
<p>a list of matrix factorizations, also from the
<code>Matrix</code> class.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"Matrix"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>dimnames</dt>
<dd>
<p><code>signature(object = "symmetricMatrix")</code>:
returns <em>symmetric</em> <code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>, even when the
<code>Dimnames</code> slot only has row or column names.  This allows to
save storage for large (typically sparse) symmetric matrices.</p>
</dd>
<dt>isSymmetric</dt>
<dd>
<p><code>signature(object = "symmetricMatrix")</code>:
returns <code>TRUE</code> trivially.</p>
</dd>
</dl>
<p>There's a C function <code>symmetricMatrix_validate()</code>
called by the internal validity checking functions, and also from
<code><a href="https://r-universe.dev/manuals/methods.html#validObject">getValidity</a>(getClass("symmetricMatrix"))</code>.
</p>


<h3>Validity and <code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code>
</h3>

<p>The validity checks do not require a symmetric <code>Dimnames</code> slot,
so it can be <code>list(NULL, &lt;character&gt;)</code>, e.g., for efficiency.
However, <code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a>()</code> and other functions and methods
should behave as if the dimnames were symmetric, i.e., with both list
components identical.
</p>


<h3>See Also</h3>

<p><code><a href="#isSymmetric-methods">isSymmetric</a></code> which has efficient methods
(<a href="#isSymmetric-methods">isSymmetric-methods</a>) for the <span class="pkg">Matrix</span> classes.
Classes <code><a href="#triangularMatrix-class">triangularMatrix</a></code>, and, e.g.,
<code><a href="#dsyMatrix-class">dsyMatrix</a></code> for numeric <em>dense</em> matrices, or
<code><a href="#lsparseMatrix-classes">lsCMatrix</a></code> for a logical <em>sparse</em> matrix class.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## An example about the symmetric Dimnames:</span>
sy <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> dims <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   symmetric<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> dimnames <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sy <span class="token comment"># shows symmetrical dimnames</span>
sy<span class="token operator">@</span>Dimnames  <span class="token comment"># internally only one part is stored</span>
dimnames<span class="token punctuation">(</span>sy<span class="token punctuation">)</span> <span class="token comment"># both parts - as sy *is* symmetrical</span>

showClass<span class="token punctuation">(</span><span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span>

<span class="token comment">## The names of direct subclasses:</span>
scl <span class="token operator">&lt;-</span> getClass<span class="token punctuation">(</span><span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span><span class="token operator">@</span>subclasses
directly <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>lapply<span class="token punctuation">(</span>scl<span class="token punctuation">,</span> slot<span class="token punctuation">,</span> <span class="token string">"by"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>
names<span class="token punctuation">(</span>scl<span class="token punctuation">)</span><span class="token punctuation">[</span>directly<span class="token punctuation">]</span>

<span class="token comment">## Methods -- applicaple to all subclasses above:</span>
showMethods<span class="token punctuation">(</span>classes <span class="token operator">=</span> <span class="token string">"symmetricMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="symmpart">

<a href="#symmpart" class="help-page-title"><h2 id="symmpart-methods">Symmetric Part and Skew(symmetric) Part of a Matrix</h2></a>

<h3>Description</h3>

<p><code>symmpart(x)</code> computes the symmetric part <code>(x + t(x))/2</code> and
<code>skewpart(x)</code> the
skew symmetric part <code>(x - t(x))/2</code> of a square matrix <code>x</code>,
more efficiently for specific Matrix classes.
</p>
<p>Note that <code>x == symmpart(x) + skewpart(x)</code> for all square
matrices – apart from extraneous <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code> values in the RHS.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">symmpart<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
skewpart<span class="token punctuation">(</span>x<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="symmpart-methods_:_x">x</code></td>
<td>
<p>a <em>square</em> matrix; either “traditional” of class
<code>"matrix"</code>, or typically, inheriting from the
<code><a href="#Matrix-class">Matrix</a></code> class.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>These are generic functions with several methods for different matrix
classes, use e.g., <code><a href="https://r-universe.dev/manuals/methods.html#showMethods">showMethods</a>(symmpart)</code> to see them.
</p>
<p>If the row and column names differ, the result will use the column
names unless they are (partly) <code>NULL</code> where the row names are
non-<code>NULL</code> (see also the examples).
</p>


<h3>Value</h3>

<p><code>symmpart()</code> returns a symmetric matrix, inheriting from
<code><a href="#symmetricMatrix-class">symmetricMatrix</a></code> iff <code>x</code> inherited from
<code>Matrix</code>.
</p>
<p><code>skewpart()</code> returns a skew-symmetric matrix,
typically of the same class as <code>x</code> (or the closest
“general” one, see <code><a href="#generalMatrix-class">generalMatrix</a></code>).
</p>


<h3>See Also</h3>

<p><code><a href="#isSymmetric-methods">isSymmetric</a></code>.</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">m <span class="token operator">&lt;-</span> Matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
symmpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
skewpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span>

stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>m <span class="token operator">==</span> symmpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">+</span> skewpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

dn <span class="token operator">&lt;-</span> dimnames<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>row <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"r1"</span><span class="token punctuation">,</span> <span class="token string">"r2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"var.1"</span><span class="token punctuation">,</span> <span class="token string">"var.2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>m <span class="token operator">==</span> symmpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">+</span> skewpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
colnames<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> <span class="token keyword">NULL</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>m <span class="token operator">==</span> symmpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">+</span> skewpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> unname<span class="token punctuation">(</span>dn<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all<span class="token punctuation">(</span>m <span class="token operator">==</span> symmpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">+</span> skewpart<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment">## investigate the current methods:</span>
showMethods<span class="token punctuation">(</span>skewpart<span class="token punctuation">,</span> include <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="triangularMatrix-class">

<a href="#triangularMatrix-class" class="help-page-title"><h2 id="triangularMatrix-class">Virtual Class of Triangular Matrices in Package Matrix</h2></a>

<h3>Description</h3>

<p>The virtual class of triangular matrices,<code>"triangularMatrix"</code>,
the package <span class="pkg">Matrix</span> contains <em>square</em> (<code><a href="https://r-universe.dev/manuals/base.html#nrow">nrow</a> ==
    <a href="https://r-universe.dev/manuals/base.html#nrow">ncol</a></code>) numeric and logical, dense and sparse matrices, e.g.,
see the examples.
A main use of the virtual class is in methods (and C functions) that
can deal with all triangular matrices.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>uplo</code>:</dt>
<dd>
<p>String (of class <code>"character"</code>).  Must be
either "U", for upper triangular, and "L", for lower triangular.</p>
</dd>
<dt>
<code>diag</code>:</dt>
<dd>
<p>String (of class <code>"character"</code>).  Must be
either <code>"U"</code>, for unit triangular (diagonal is all ones), or
<code>"N"</code> for non-unit.  The diagonal elements are not
accessed internally when <code>diag</code> is <code>"U"</code>. For
<code><a href="#denseMatrix-class">denseMatrix</a></code> classes, they need to be
allocated though, such that the length of the <code>x</code> slot does not
depend on <code>diag</code>.</p>
</dd>
<dt>
<code>Dim</code>, <code>Dimnames</code>:</dt>
<dd>
<p>The dimension (a length-2
<code>"integer"</code>) and corresponding names (or <code>NULL</code>),
inherited from the <code><a href="#Matrix-class">Matrix</a></code>, see there.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"Matrix"</code>, directly.
</p>


<h3>Methods</h3>

<p>There's a C function <code>triangularMatrix_validity()</code>
called by the internal validity checking functions.
</p>
<p>Currently, <code><a href="#Schur">Schur</a></code>, <code><a href="#isSymmetric-methods">isSymmetric</a></code> and
<code>as()</code> (i.e. <code><a href="https://r-universe.dev/manuals/methods.html#setAs">coerce</a></code>) have methods with
<code>triangularMatrix</code> in their signature.
</p>


<h3>See Also</h3>

<p><code><a href="#isTriangular">isTriangular</a>()</code> for testing any matrix for triangularity;
classes <code><a href="#symmetricMatrix-class">symmetricMatrix</a></code>, and, e.g.,
<code><a href="#dtrMatrix-class">dtrMatrix</a></code> for numeric <em>dense</em> matrices, or
<code><a href="#lsparseMatrix-classes">ltCMatrix</a></code> for a logical <em>sparse</em> matrix
subclass of <code>"triangularMatrix"</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"triangularMatrix"</span><span class="token punctuation">)</span>

<span class="token comment">## The names of direct subclasses:</span>
scl <span class="token operator">&lt;-</span> getClass<span class="token punctuation">(</span><span class="token string">"triangularMatrix"</span><span class="token punctuation">)</span><span class="token operator">@</span>subclasses
directly <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>lapply<span class="token punctuation">(</span>scl<span class="token punctuation">,</span> slot<span class="token punctuation">,</span> <span class="token string">"by"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>
names<span class="token punctuation">(</span>scl<span class="token punctuation">)</span><span class="token punctuation">[</span>directly<span class="token punctuation">]</span>

<span class="token punctuation">(</span>m <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
as<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">"triangularMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="TsparseMatrix-class">

<a href="#TsparseMatrix-class" class="help-page-title"><h2 id="TsparseMatrix-class">Class "TsparseMatrix" of Sparse Matrices in Triplet Form</h2></a>

<h3>Description</h3>

<p>The <code>"TsparseMatrix"</code> class is the virtual class of
all sparse matrices coded in triplet form.  Since it is a virtual class,
no objects may be created from it.  See
<code>showClass("TsparseMatrix")</code> for its subclasses.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>, <code>Dimnames</code>:</dt>
<dd>
<p>from the <code>"<a href="#Matrix-class">Matrix</a>"</code> class,</p>
</dd>
<dt>
<code>i</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the row indices
of non-zero entries <em>in 0-base</em>, i.e., must be in
<code>0:(nrow(.)-1)</code>.</p>
</dd>
<dt>
<code>j</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> - the column
indices of non-zero entries.  Must be the same length as slot
<code>i</code> and <em>0-based</em> as well, i.e., in
<code>0:(ncol(.)-1)</code>.   For numeric Tsparse matrices, <code>(i,j)</code>
pairs can occur more than once, see <code><a href="#dgTMatrix-class">dgTMatrix</a></code>.
</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"sparseMatrix"</code>, directly.
Class <code>"Matrix"</code>, by class <code>"sparseMatrix"</code>.
</p>


<h3>Methods</h3>

<p>Extraction (<code>"["</code>) methods, see
<code><a href="#Xtrct-methods">[-methods</a></code>.
</p>


<h3>Note</h3>

<p>Most operations with sparse matrices are performed using the
compressed, column-oriented or <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code>
representation.  The triplet representation is convenient for
creating a sparse matrix or for reading and writing such
matrices.  Once it is created, however, the matrix is generally
coerced to a <code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> for further
operations.
</p>
<p>Note that all <code>new(.)</code>, <code><a href="#spMatrix">spMatrix</a></code> and
<code><a href="#sparseMatrix">sparseMatrix</a>(*, repr="T")</code> constructors
for <code>"TsparseMatrix"</code> classes implicitly add (i.e., “sum up”)
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">x_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>'s that belong to identical <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>i</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>j</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i_k, j_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> pairs, see, the
example below, or also <code>"<a href="#dgTMatrix-class">dgTMatrix</a>"</code>.
</p>
<p>For convenience, methods for some operations such as <code>%*%</code>
and <code>crossprod</code> are defined for
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code> objects.  These methods simply
coerce the <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code> object to a
<code><a href="#CsparseMatrix-class">CsparseMatrix</a></code> object then perform the
operation.
</p>


<h3>See Also</h3>

<p>its superclass, <code><a href="#sparseMatrix-class">sparseMatrix</a></code>, and the
<code><a href="#dgTMatrix-class">dgTMatrix</a></code> class, for the links to other classes.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"TsparseMatrix"</span><span class="token punctuation">)</span>
<span class="token comment">## or just the subclasses' names</span>
names<span class="token punctuation">(</span>getClass<span class="token punctuation">(</span><span class="token string">"TsparseMatrix"</span><span class="token punctuation">)</span><span class="token operator">@</span>subclasses<span class="token punctuation">)</span>

T3 <span class="token operator">&lt;-</span> spMatrix<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span> i<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>
T3 <span class="token comment"># only 3 non-zero entries, 5 = 1+4 !</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="uniqTsparse">

<a href="#uniqTsparse" class="help-page-title"><h2 id="uniqTsparse">Unique (Sorted) TsparseMatrix Representations</h2></a>

<h3>Description</h3>

<p>Detect or “unify” (or “standardize”) non-unique
<code><a href="#TsparseMatrix-class">TsparseMatrix</a></code> matrices, prducing unique
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j,x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></code> triplets which are <em>sorted</em>, first in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></code>, then
in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> (in the sense of <code><a href="https://r-universe.dev/manuals/base.html#order">order</a>(j,i)</code>).
</p>
<p>Note that <code>new(.)</code>, <code><a href="#spMatrix">spMatrix</a></code> or
<code><a href="#sparseMatrix">sparseMatrix</a></code> constructors for <code>"dgTMatrix"</code> (and
other <code>"<a href="#TsparseMatrix-class">TsparseMatrix</a>"</code> classes) implicitly add
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">x_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>'s that belong to identical <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>i</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>j</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i_k, j_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> pairs.
</p>
<p><code>anyDuplicatedT()</code> reports the index of the first duplicated
pair, or <code>0</code> if there is none.
</p>
<p><code>uniqTsparse(x)</code> replaces duplicated index pairs <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></code> and their
corresponding <code>x</code> slot entries by the triple <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>s</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j, sx)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></code>
where <code>sx = sum(x [&lt;all pairs matching (i,j)&gt;])</code>, and for logical
<code>x</code>, addition is replaced by logical <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">or</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">uniqTsparse<span class="token punctuation">(</span>x<span class="token punctuation">,</span> class.x <span class="token operator">=</span> c<span class="token punctuation">(</span>class<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
anyDuplicatedT<span class="token punctuation">(</span>x<span class="token punctuation">,</span> di <span class="token operator">=</span> dim<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="uniqTsparse_:_x">x</code></td>
<td>
<p>a sparse matrix stored in triplet form, i.e., inheriting
from class <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="uniqTsparse_:_class.x">class.x</code></td>
<td>
<p>optional character string specifying <code>class(x)</code>.</p>
</td>
</tr>
<tr>
<td><code id="uniqTsparse_:_di">di</code></td>
<td>
<p>the matrix dimension of <code>x</code>, <code><a href="https://r-universe.dev/manuals/base.html#dim">dim</a>(x)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>uniqTsparse(x)</code> returns a <code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>
“like x”, of the same class and with the same elements, just
internally possibly changed to “unique” <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j,x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></code> triplets
in <em>sorted</em> order.
</p>
<p><code>anyDuplicatedT(x)</code> returns an <code><a href="https://r-universe.dev/manuals/base.html#integer">integer</a></code> as
<code><a href="https://r-universe.dev/manuals/base.html#duplicated">anyDuplicated</a></code>, the <em>index</em>
of the first duplicated entry (from the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></code> pairs)
if there is one, and <code>0</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="#TsparseMatrix-class">TsparseMatrix</a></code>, for uniqueness, notably
<code><a href="#dgTMatrix-class">dgTMatrix</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">example<span class="token punctuation">(</span><span class="token string">"dgTMatrix-class"</span><span class="token punctuation">,</span> echo<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
<span class="token comment">## -&gt; 'T2'  with (i,j,x) slots of length 5 each</span>
T2u <span class="token operator">&lt;-</span> uniqTsparse<span class="token punctuation">(</span>T2<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span><span class="token comment">## They "are" the same (and print the same):</span>
          all.equal<span class="token punctuation">(</span>T2<span class="token punctuation">,</span> T2u<span class="token punctuation">,</span> tol<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token comment">## but not internally:</span>
          anyDuplicatedT<span class="token punctuation">(</span>T2<span class="token punctuation">)</span>  <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>
          anyDuplicatedT<span class="token punctuation">(</span>T2u<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span>
          length<span class="token punctuation">(</span>T2 <span class="token operator">@</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">,</span>
          length<span class="token punctuation">(</span>T2u<span class="token operator">@</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment">## is 'x' a "uniq Tsparse" Matrix ?  [requires x to be TsparseMatrix!]</span>
non_uniqT <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> di <span class="token operator">=</span> dim<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
  is.unsorted<span class="token punctuation">(</span>x<span class="token operator">@</span>j<span class="token punctuation">)</span> <span class="token operator">||</span> anyDuplicatedT<span class="token punctuation">(</span>x<span class="token punctuation">,</span> di<span class="token punctuation">)</span>
non_uniqT<span class="token punctuation">(</span>T2 <span class="token punctuation">)</span> <span class="token comment"># TRUE</span>
non_uniqT<span class="token punctuation">(</span>T2u<span class="token punctuation">)</span> <span class="token comment"># FALSE</span>

T3 <span class="token operator">&lt;-</span> T2u
T3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token punctuation">;</span> T3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">20</span>
T3u <span class="token operator">&lt;-</span> uniqTsparse<span class="token punctuation">(</span>T3<span class="token punctuation">)</span>
str<span class="token punctuation">(</span>T3u<span class="token punctuation">)</span> <span class="token comment"># sorted in 'j', and within j, sorted in i</span>
stopifnot<span class="token punctuation">(</span><span class="token operator">!</span>non_uniqT<span class="token punctuation">(</span>T3u<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Logical l.TMatrix and n.TMatrix :</span>
<span class="token punctuation">(</span>L2 <span class="token operator">&lt;-</span> T2 <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
validObject<span class="token punctuation">(</span>L2u <span class="token operator">&lt;-</span> uniqTsparse<span class="token punctuation">(</span>L2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>N2 <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>L2<span class="token punctuation">,</span> <span class="token string">"nMatrix"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
validObject<span class="token punctuation">(</span>N2u <span class="token operator">&lt;-</span> uniqTsparse<span class="token punctuation">(</span>N2<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>N2u<span class="token operator">@</span>i <span class="token operator">==</span> L2u<span class="token operator">@</span>i<span class="token punctuation">,</span> L2u<span class="token operator">@</span>i <span class="token operator">==</span> T2u<span class="token operator">@</span>i<span class="token punctuation">,</span>  N2<span class="token operator">@</span>i <span class="token operator">==</span> L2<span class="token operator">@</span>i<span class="token punctuation">,</span> L2<span class="token operator">@</span>i <span class="token operator">==</span> T2<span class="token operator">@</span>i<span class="token punctuation">,</span>
          N2u<span class="token operator">@</span>j <span class="token operator">==</span> L2u<span class="token operator">@</span>j<span class="token punctuation">,</span> L2u<span class="token operator">@</span>j <span class="token operator">==</span> T2u<span class="token operator">@</span>j<span class="token punctuation">,</span>  N2<span class="token operator">@</span>j <span class="token operator">==</span> L2<span class="token operator">@</span>j<span class="token punctuation">,</span> L2<span class="token operator">@</span>j <span class="token operator">==</span> T2<span class="token operator">@</span>j<span class="token punctuation">)</span>
<span class="token comment"># now with a nasty NA  [partly failed in Matrix 1.1-5]:</span>
L.<span class="token number">0</span>N <span class="token operator">&lt;-</span> L.<span class="token number">1</span>N <span class="token operator">&lt;-</span> L2
L.<span class="token number">0</span>N<span class="token operator">@</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
L.<span class="token number">1</span>N<span class="token operator">@</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
validObject<span class="token punctuation">(</span>L.<span class="token number">0</span>N<span class="token punctuation">)</span>
validObject<span class="token punctuation">(</span>L.<span class="token number">1</span>N<span class="token punctuation">)</span>
<span class="token punctuation">(</span>m.<span class="token number">0</span>N <span class="token operator">&lt;-</span> as.matrix<span class="token punctuation">(</span>L.<span class="token number">0</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>m.<span class="token number">1</span>N <span class="token operator">&lt;-</span> as.matrix<span class="token punctuation">(</span>L.<span class="token number">1</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span><span class="token number">10L</span><span class="token punctuation">,</span> which<span class="token punctuation">(</span>is.na<span class="token punctuation">(</span>m.<span class="token number">0</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">!</span>anyNA<span class="token punctuation">(</span>m.<span class="token number">1</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>
symnum<span class="token punctuation">(</span>m.<span class="token number">0</span>N<span class="token punctuation">)</span>
symnum<span class="token punctuation">(</span>m.<span class="token number">1</span>N<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="unpackedMatrix-class">

<a href="#unpackedMatrix-class" class="help-page-title"><h2 id="unpackedMatrix-class">Virtual Class <code>"unpackedMatrix"</code> of Unpacked Dense Matrices</h2></a>

<h3>Description</h3>

<p>Class <code>"unpackedMatrix"</code> is the <em>virtual</em> class of dense
matrices in "unpacked" format, storing all <code>m*n</code> elements of
an <code>m</code>-by-<code>n</code> matrix. It is used to define common methods
for efficient subsetting, transposing, etc. of its <em>proper</em>
subclasses: currently <code>"[dln]geMatrix"</code> (unpacked general),
<code>"[dln]syMatrix"</code> (unpacked symmetric), <code>"[dln]trMatrix"</code>
(unpacked triangular), and subclasses of these, such as
<code>"<a href="#dpoMatrix-class">dpoMatrix</a>"</code>,
<code>"<a href="#Cholesky-class">Cholesky</a>"</code>, and
<code>"<a href="#BunchKaufman-class">BunchKaufman</a>"</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Dim</code>, <code>Dimnames</code>:</dt>
<dd>
<p>as all <code><a href="#Matrix-class">Matrix</a></code> objects.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>"<a href="#denseMatrix-class">denseMatrix</a>"</code>, directly.
Class <code>"<a href="#Matrix-class">Matrix</a>"</code>, by class <code>"denseMatrix"</code>,
distance 2.
Class <code>"mMatrix"</code>, by class <code>"Matrix"</code>, distance 3.
Class <code>"replValueSp"</code>, by class <code>"Matrix"</code>, distance 3.
</p>


<h3>Methods</h3>


<dl>
<dt>pack</dt>
<dd>
<p><code>signature(x = "unpackedMatrix")</code>: ... </p>
</dd>
<dt>unpack</dt>
<dd>
<p><code>signature(x = "unpackedMatrix")</code>: ... </p>
</dd>
<dt>isSymmetric</dt>
<dd>
<p><code>signature(object = "unpackedMatrix")</code>: ... </p>
</dd>
<dt>isTriangular</dt>
<dd>
<p><code>signature(object = "unpackedMatrix")</code>: ... </p>
</dd>
<dt>isDiagonal</dt>
<dd>
<p><code>signature(object = "unpackedMatrix")</code>: ... </p>
</dd>
<dt>t</dt>
<dd>
<p><code>signature(x = "unpackedMatrix")</code>: ... </p>
</dd>
<dt>diag</dt>
<dd>
<p><code>signature(x = "unpackedMatrix")</code>: ... </p>
</dd>
<dt>diag&lt;-</dt>
<dd>
<p><code>signature(x = "unpackedMatrix")</code>: ... </p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Mikael Jagan</p>


<h3>See Also</h3>

<p><code><a href="#unpack">pack</a></code> and <code><a href="#unpack">unpack</a></code>; its virtual "complement"
<code>"<a href="#packedMatrix-class">packedMatrix</a>"</code>; its proper subclasses
<code>"<a href="#dsyMatrix-class">dsyMatrix</a>"</code>, <code>"<a href="#ltrMatrix-class">ltrMatrix</a>"</code>, etc.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">showClass<span class="token punctuation">(</span><span class="token string">"unpackedMatrix"</span><span class="token punctuation">)</span>
showMethods<span class="token punctuation">(</span>classes <span class="token operator">=</span> <span class="token string">"unpackedMatrix"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="updown">

<a href="#updown" class="help-page-title"><h2 id="updown-methods">Updating and Downdating Sparse Cholesky Factorizations</h2></a>

<h3>Description</h3>

<p>Computes a rank-<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> update or downdate of a sparse Cholesky
factorization
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mi>A</mi><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mi>D</mi><msubsup><mi>L</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mi>L</mi><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">P_{1} A P_{1}' = L_{1} D L_{1}' = L L'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>which for some <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>-column matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></code> is the factorization
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mi>s</mi><mi>C</mi><msup><mi>C</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><msubsup><mi>P</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msub><mover accent="true"><mi>L</mi><mo>~</mo></mover><mn>1</mn></msub><mover accent="true"><mi>D</mi><mo>~</mo></mover><msubsup><mover accent="true"><mi>L</mi><mo>~</mo></mover><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mover accent="true"><mi>L</mi><mo>~</mo></mover><msup><mover accent="true"><mi>L</mi><mo>~</mo></mover><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">P_{1} (A + s C C') P_{1}' = \tilde{L}_{1} \tilde{D} \tilde{L}_{1}' = \tilde{L} \tilde{L}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1683em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">L</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">L</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">L</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">L</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></code>
</p>

<p>Here, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> for an update and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s = -1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></code> for a downdate.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">updown<span class="token punctuation">(</span>update<span class="token punctuation">,</span> C<span class="token punctuation">,</span> L<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="updown-methods_:_update">update</code></td>
<td>
<p>a logical (<code>TRUE</code> or <code>FALSE</code>) or
character (<code>"+"</code> or <code>"-"</code>) indicating if <code>L</code>
should be updated (or otherwise downdated).</p>
</td>
</tr>
<tr>
<td><code id="updown-methods_:_C">C</code></td>
<td>
<p>a <a href="#is.na-methods">finite</a> matrix or
<code><a href="#Matrix-class">Matrix</a></code> such that
<code><a href="#matrix-products">tcrossprod</a>(C)</code> has the dimensions of <code>L</code>.</p>
</td>
</tr>
<tr>
<td><code id="updown-methods_:_L">L</code></td>
<td>
<p>an object of class <code><a href="#CHMfactor-class">dCHMsimpl</a></code> or
<code><a href="#CHMfactor-class">dCHMsuper</a></code> specifying a sparse Cholesky
factorization.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A sparse Cholesky factorization with dimensions matching <code>L</code>,
typically of class <code><a href="#CHMfactor-class">dCHMsimpl</a></code>.
</p>


<h3>Author(s)</h3>

<p>Initial implementation by Nicholas Nagle, University of Tennessee.</p>


<h3>References</h3>

<p>Davis, T. A., Hager, W. W. (2001).
Multiple-rank modifications of a sparse Cholesky factorization.
<em>SIAM Journal on Matrix Analysis and Applications</em>,
<em>22</em>(4), 997-1013.
<a href="https://doi.org/10.1137/S0895479899357346" target="_blank">doi:10.1137/S0895479899357346</a>
</p>


<h3>See Also</h3>

<p>Classes
<code><a href="#CHMfactor-class">dCHMsimpl</a></code> and <code><a href="#CHMfactor-class">dCHMsuper</a></code>
and their methods, notably for generic function <code><a href="https://r-universe.dev/manuals/stats.html#update">update</a></code>,
which is <em>not</em> equivalent to <code>updown(update = TRUE)</code>.
</p>
<p>Generic function <code><a href="#Cholesky">Cholesky</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">m <span class="token operator">&lt;-</span> sparseMatrix<span class="token punctuation">(</span>i <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span>
                  dimnames <span class="token operator">=</span> list<span class="token punctuation">(</span>LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
uc0 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>A <span class="token operator">&lt;-</span> crossprod<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">+</span> Diagonal<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
uc1 <span class="token operator">&lt;-</span> updown<span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> uc0<span class="token punctuation">)</span>
uc2 <span class="token operator">&lt;-</span> updown<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> Diagonal<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> uc1<span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>uc0<span class="token punctuation">,</span> uc2<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="USCounties">

<a href="#USCounties" class="help-page-title"><h2 id="USCounties">Contiguity Matrix of U.S. Counties</h2></a>

<h3>Description</h3>

<p>This matrix gives the contiguities of 3111 U.S. counties,
using the queen criterion of at least one shared vertex
or edge.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>USCounties<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>A <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3111</mn><mo>×</mo><mn>3111</mn></mrow><annotation encoding="application/x-tex">3111 \times 3111</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3111</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3111</span></span></span></span></code> sparse, symmetric
matrix of class <code><a href="#dsCMatrix-class">dsCMatrix</a></code>, with 9101
nonzero entries.
</p>


<h3>Source</h3>

<p>GAL lattice file ‘<span class="file">usc_q.GAL</span>’
(retrieved in 2008 from
‘<span class="file">http://sal.uiuc.edu/weights/zips/usc.zip</span>’
with permission from Luc Anselin for use and distribution)
was read into <span class="rlang"><b>R</b></span> using function <code>read.gal</code>
from package <a href="https://CRAN.R-project.org/package=spdep" target="_blank"><span class="pkg">spdep</span></a>.
</p>
<p>Neighbour lists were augmented with row-standardized
(and then symmetrized) spatial weights, using functions
<code>nb2listw</code> and <code>similar.listw</code> from packages
<a href="https://CRAN.R-project.org/package=spdep" target="_blank"><span class="pkg">spdep</span></a> and <a href="https://CRAN.R-project.org/package=spatialreg" target="_blank"><span class="pkg">spatialreg</span></a>.
The resulting <code>listw</code> object was coerced to class
<code><a href="#dsCMatrix-class">dsTMatrix</a></code>
using <code>as_dsTMatrix_listw</code> from <a href="https://CRAN.R-project.org/package=spatialreg" target="_blank"><span class="pkg">spatialreg</span></a>,
and subsequently to class <code><a href="#dsCMatrix-class">dsCMatrix</a></code>.
</p>


<h3>References</h3>

<p>Ord, J. K. (1975).
Estimation methods for models of spatial interaction.
<em>Journal of the American Statistical Association</em>,
<em>70</em>(349), 120-126.
<a href="https://doi.org/10.2307/2285387" target="_blank">doi:10.2307/2285387</a>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>n <span class="token operator">&lt;-</span> ncol<span class="token punctuation">(</span>USCounties<span class="token punctuation">)</span><span class="token punctuation">)</span>
I <span class="token operator">&lt;-</span> .symDiagonal<span class="token punctuation">(</span>n<span class="token punctuation">)</span>

set.seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> <span class="token number">50L</span>
rho <span class="token operator">&lt;-</span> <span class="token number">1</span> <span class="token operator">/</span> runif<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>

system.time<span class="token punctuation">(</span>MJ0 <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>rho<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mult<span class="token punctuation">)</span>
    determinant<span class="token punctuation">(</span>USCounties <span class="token operator">+</span> mult <span class="token operator">*</span> I<span class="token punctuation">,</span> logarithm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>modulus<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Can be done faster by updating the Cholesky factor:</span>

C1 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> Imult <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
system.time<span class="token punctuation">(</span>MJ1 <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>rho<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mult<span class="token punctuation">)</span>
    determinant<span class="token punctuation">(</span>update<span class="token punctuation">(</span>C1<span class="token punctuation">,</span> USCounties<span class="token punctuation">,</span> mult<span class="token punctuation">)</span><span class="token punctuation">,</span> sqrt <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token operator">$</span>modulus<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>MJ0<span class="token punctuation">,</span> MJ1<span class="token punctuation">)</span><span class="token punctuation">)</span>

C2 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>USCounties<span class="token punctuation">,</span> super <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> Imult <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
system.time<span class="token punctuation">(</span>MJ2 <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>rho<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mult<span class="token punctuation">)</span>
    determinant<span class="token punctuation">(</span>update<span class="token punctuation">(</span>C2<span class="token punctuation">,</span> USCounties<span class="token punctuation">,</span> mult<span class="token punctuation">)</span><span class="token punctuation">,</span> sqrt <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token operator">$</span>modulus<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>MJ0<span class="token punctuation">,</span> MJ2<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="wrld_1deg">

<a href="#wrld_1deg" class="help-page-title"><h2 id="wrld_1deg">Contiguity Matrix of World One-Degree Grid Cells</h2></a>

<h3>Description</h3>

<p>This matrix gives the contiguities of 15260 one-degree
grid cells of world land areas, using a criterion based
on the great-circle distance between centers.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>wrld_1deg<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>A <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>15260</mn><mo>×</mo><mn>15260</mn></mrow><annotation encoding="application/x-tex">15260 \times 15260</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">15260</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">15260</span></span></span></span></code> sparse, symmetric
matrix of class <code><a href="#dsCMatrix-class">dsCMatrix</a></code>, with 55973
nonzero entries.
</p>


<h3>Source</h3>

<p>Shoreline data were read into <span class="rlang"><b>R</b></span> from the GSHHS database
using function <code>Rgshhs</code> from package <a href="https://CRAN.R-project.org/package=maptools" target="_blank"><span class="pkg">maptools</span></a>.
Antarctica was excluded.  An approximately one-degree grid
was generated using function <code>Sobj_SpatialGrid</code>, also
from <a href="https://CRAN.R-project.org/package=maptools" target="_blank"><span class="pkg">maptools</span></a>.  Grid cells with centers on land
were identified using the <code>over</code> method for classes
<code>SpatialPolygons</code> and <code>SpatialGrid</code>, defined in
package <a href="https://CRAN.R-project.org/package=sp" target="_blank"><span class="pkg">sp</span></a>.  Neighbours of these were identified
by passing the resulting <code>SpatialPixels</code> object to
function <code>dnearneigh</code> from package <a href="https://CRAN.R-project.org/package=spdep" target="_blank"><span class="pkg">spdep</span></a>,
using as a cut-off a great-circle distance of <code>sqrt(2)</code>
kilometers between centers.
</p>
<p>Neighbour lists were augmented with row-standardized
(and then symmetrized) spatial weights, using functions
<code>nb2listw</code> and <code>similar.listw</code> from packages
<a href="https://CRAN.R-project.org/package=spdep" target="_blank"><span class="pkg">spdep</span></a> and <a href="https://CRAN.R-project.org/package=spatialreg" target="_blank"><span class="pkg">spatialreg</span></a>.
The resulting <code>listw</code> object was coerced to class
<code><a href="#dsCMatrix-class">dsTMatrix</a></code>
using <code>as_dsTMatrix_listw</code> from <a href="https://CRAN.R-project.org/package=spatialreg" target="_blank"><span class="pkg">spatialreg</span></a>,
and subsequently to class <code><a href="#dsCMatrix-class">dsCMatrix</a></code>.
</p>


<h3>References</h3>

<p>Ord, J. K. (1975).
Estimation methods for models of spatial interaction.
<em>Journal of the American Statistical Association</em>,
<em>70</em>(349), 120-126.
<a href="https://doi.org/10.2307/2285387" target="_blank">doi:10.2307/2285387</a>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>wrld_1deg<span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"Matrix"</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>n <span class="token operator">&lt;-</span> ncol<span class="token punctuation">(</span>wrld_1deg<span class="token punctuation">)</span><span class="token punctuation">)</span>
I <span class="token operator">&lt;-</span> .symDiagonal<span class="token punctuation">(</span>n<span class="token punctuation">)</span>

doExtras <span class="token operator">&lt;-</span> interactive<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> nzchar<span class="token punctuation">(</span>Sys.getenv<span class="token punctuation">(</span><span class="token string">"R_MATRIX_CHECK_EXTRA"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> <span class="token keyword">if</span><span class="token punctuation">(</span>doExtras<span class="token punctuation">)</span> <span class="token number">20L</span> <span class="token keyword">else</span> <span class="token number">3L</span>
rho <span class="token operator">&lt;-</span> <span class="token number">1</span> <span class="token operator">/</span> runif<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>

system.time<span class="token punctuation">(</span>MJ0 <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>rho<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mult<span class="token punctuation">)</span>
    determinant<span class="token punctuation">(</span>wrld_1deg <span class="token operator">+</span> mult <span class="token operator">*</span> I<span class="token punctuation">,</span> logarithm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>modulus<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Can be done faster by updating the Cholesky factor:</span>

C1 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>wrld_1deg<span class="token punctuation">,</span> Imult <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
system.time<span class="token punctuation">(</span>MJ1 <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>rho<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mult<span class="token punctuation">)</span>
    determinant<span class="token punctuation">(</span>update<span class="token punctuation">(</span>C1<span class="token punctuation">,</span> wrld_1deg<span class="token punctuation">,</span> mult<span class="token punctuation">)</span><span class="token punctuation">,</span> sqrt <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token operator">$</span>modulus<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>MJ0<span class="token punctuation">,</span> MJ1<span class="token punctuation">)</span><span class="token punctuation">)</span>

C2 <span class="token operator">&lt;-</span> Cholesky<span class="token punctuation">(</span>wrld_1deg<span class="token punctuation">,</span> super <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> Imult <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
system.time<span class="token punctuation">(</span>MJ2 <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>rho<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mult<span class="token punctuation">)</span>
    determinant<span class="token punctuation">(</span>update<span class="token punctuation">(</span>C2<span class="token punctuation">,</span> wrld_1deg<span class="token punctuation">,</span> mult<span class="token punctuation">)</span><span class="token punctuation">,</span> sqrt <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token operator">$</span>modulus<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>MJ0<span class="token punctuation">,</span> MJ2<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
</div>
    <footer><p>Rendered with postdoc 1.2.2</p></footer>
  </body>
</html>
