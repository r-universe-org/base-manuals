<!DOCTYPE html>
<html>
  <head>
    <title>Package 'nlme' reference manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <!-- styling for math and syntax -->
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/katex.min.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/R.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/prism.css">

    <!-- for (future) customizations -->
    <script src="https://r-universe.dev/static/manual.js"></script>
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/manual.css?nocache=1">

  </head>

  <body class="macintosh">
    <h1 class="manual-title">Package 'nlme'</h1>
    <table class="description-table">
      <tr>
<th>Title:</th>
<td class="description-title">Linear and Nonlinear Mixed Effects Models</td>
</tr>
      <tr>
<th>Description:</th>
<td class="description-description">Fit and compare Gaussian linear and nonlinear mixed-effects models.</td>
</tr>
      <tr>
<th>Authors:</th>
<td class="description-author">José Pinheiro [aut] (S version),
  Douglas Bates [aut] (up to 2007),
  Saikat DebRoy [ctb] (up to 2002),
  Deepayan Sarkar [ctb] (up to 2005),
  EISPACK authors [ctb] (src/rs.f),
  Siem Heisterkamp [ctb] (Author fixed sigma),
  Bert Van Willigen [ctb] (Programmer fixed sigma),
  Johannes Ranke [ctb] (varConstProp()),
  R Core Team [aut, cre]</td>
</tr>
      <tr>
<th>Maintainer:</th>
<td class="description-maintainer">R Core Team &lt;R-core@R-project.org&gt;</td>
</tr>
      <tr>
<th>License:</th>
<td class="description-license">GPL (&gt;= 2)</td>
</tr>
      <tr>
<th>Version:</th>
<td class="description-version">3.1-160</td>
</tr>
      <tr>
<th>Built:</th>
<td class="description-date">2022-10-31 22:33:30 UTC</td>
</tr>
      <tr>
<th>Source:</th>
<td class="description-source">CRAN</td>
</tr>
    </table>

    <a href="#help-index" style="color:black;"><h2 id="help-index">Help Index</h2></a>
    <ul id="help-index-list">
<li class="help-index-item"><a href="#Extract.pdMat">Subscript a pdMat Object</a></li>
<li class="help-index-item"><a href="#ACF">Autocorrelation Function</a></li>
<li class="help-index-item"><a href="#ACF.gls">Autocorrelation Function for gls Residuals</a></li>
<li class="help-index-item"><a href="#ACF.lme">Autocorrelation Function for lme Residuals</a></li>
<li class="help-index-item"><a href="#Alfalfa">Split-Plot Experiment on Varieties of Alfalfa</a></li>
<li class="help-index-item"><a href="#allCoef">Extract Coefficients from a Set of Objects</a></li>
<li class="help-index-item"><a href="#anova.gls">Compare Likelihoods of Fitted Objects</a></li>
<li class="help-index-item"><a href="#anova.lme">Compare Likelihoods of Fitted Objects</a></li>
<li class="help-index-item"><a href="#as.matrix.corStruct">Matrix of a corStruct Object</a></li>
<li class="help-index-item"><a href="#as.matrix.pdMat">Matrix of a pdMat Object</a></li>
<li class="help-index-item"><a href="#as.matrix.reStruct">Matrices of an reStruct Object</a></li>
<li class="help-index-item"><a href="#asOneFormula">Combine Formulas of a Set of Objects</a></li>
<li class="help-index-item"><a href="#Assay">Bioassay on Cell Culture Plate</a></li>
<li class="help-index-item"><a href="#asTable">Convert groupedData to a matrix</a></li>
<li class="help-index-item"><a href="#augPred">Augmented Predictions</a></li>
<li class="help-index-item"><a href="#balancedGrouped">Create a groupedData object from a matrix</a></li>
<li class="help-index-item"><a href="#bdf">Language scores</a></li>
<li class="help-index-item"><a href="#BodyWeight">Rat weight over time for different diets</a></li>
<li class="help-index-item"><a href="#Cefamandole">Pharmacokinetics of Cefamandole</a></li>
<li class="help-index-item"><a href="#Coef">Assign Values to Coefficients</a></li>
<li class="help-index-item"><a href="#coef.corStruct">Coefficients of a corStruct Object</a></li>
<li class="help-index-item"><a href="#coef.gnls">Extract gnls Coefficients</a></li>
<li class="help-index-item"><a href="#coef.lme">Extract lme Coefficients</a></li>
<li class="help-index-item"><a href="#coef.lmList">Extract lmList Coefficients</a></li>
<li class="help-index-item"><a href="#coef.modelStruct">Extract modelStruct Object Coefficients</a></li>
<li class="help-index-item"><a href="#coef.pdMat">pdMat Object Coefficients</a></li>
<li class="help-index-item"><a href="#coef.reStruct">reStruct Object Coefficients</a></li>
<li class="help-index-item"><a href="#coef.varFunc">varFunc Object Coefficients</a></li>
<li class="help-index-item"><a href="#collapse">Collapse According to Groups</a></li>
<li class="help-index-item"><a href="#collapse.groupedData">Collapse a groupedData Object</a></li>
<li class="help-index-item"><a href="#compareFits">Compare Fitted Objects</a></li>
<li class="help-index-item"><a href="#comparePred">Compare Predictions</a></li>
<li class="help-index-item"><a href="#corAR1">AR(1) Correlation Structure</a></li>
<li class="help-index-item"><a href="#corARMA">ARMA(p,q) Correlation Structure</a></li>
<li class="help-index-item"><a href="#corCAR1">Continuous AR(1) Correlation Structure</a></li>
<li class="help-index-item"><a href="#corClasses">Correlation Structure Classes</a></li>
<li class="help-index-item"><a href="#corCompSymm">Compound Symmetry Correlation Structure</a></li>
<li class="help-index-item"><a href="#corExp">Exponential Correlation Structure</a></li>
<li class="help-index-item"><a href="#corFactor">Factor of a Correlation Matrix</a></li>
<li class="help-index-item"><a href="#corFactor.corStruct">Factor of a corStruct Object Matrix</a></li>
<li class="help-index-item"><a href="#corGaus">Gaussian Correlation Structure</a></li>
<li class="help-index-item"><a href="#corLin">Linear Correlation Structure</a></li>
<li class="help-index-item"><a href="#corMatrix">Extract Correlation Matrix</a></li>
<li class="help-index-item"><a href="#corMatrix.corStruct">Matrix of a corStruct Object</a></li>
<li class="help-index-item"><a href="#corMatrix.pdMat">Extract Correlation Matrix from a pdMat Object</a></li>
<li class="help-index-item"><a href="#corMatrix.reStruct">Extract Correlation Matrix from Components of an reStruct Object</a></li>
<li class="help-index-item"><a href="#corNatural">General correlation in natural parameterization</a></li>
<li class="help-index-item"><a href="#corRatio">Rational Quadratic Correlation Structure</a></li>
<li class="help-index-item"><a href="#corSpatial">Spatial Correlation Structure</a></li>
<li class="help-index-item"><a href="#corSpher">Spherical Correlation Structure</a></li>
<li class="help-index-item"><a href="#corSymm">General Correlation Structure</a></li>
<li class="help-index-item"><a href="#Covariate">Assign Covariate Values</a></li>
<li class="help-index-item"><a href="#Covariate.varFunc">Assign varFunc Covariate</a></li>
<li class="help-index-item"><a href="#Dialyzer">High-Flux Hemodialyzer</a></li>
<li class="help-index-item"><a href="#Dim">Extract Dimensions from an Object</a></li>
<li class="help-index-item"><a href="#Dim.corSpatial">Dimensions of a corSpatial Object</a></li>
<li class="help-index-item"><a href="#Dim.corStruct">Dimensions of a corStruct Object</a></li>
<li class="help-index-item"><a href="#Dim.pdMat">Dimensions of a pdMat Object</a></li>
<li class="help-index-item"><a href="#Earthquake">Earthquake Intensity</a></li>
<li class="help-index-item"><a href="#ergoStool">Ergometrics experiment with stool types</a></li>
<li class="help-index-item"><a href="#Fatigue">Cracks caused by metal fatigue</a></li>
<li class="help-index-item"><a href="#fdHess">Finite difference Hessian</a></li>
<li class="help-index-item"><a href="#fitted.glsStruct">Calculate glsStruct Fitted Values</a></li>
<li class="help-index-item"><a href="#fitted.gnlsStruct">Calculate gnlsStruct Fitted Values</a></li>
<li class="help-index-item"><a href="#fitted.lme">Extract lme Fitted Values</a></li>
<li class="help-index-item"><a href="#fitted.lmeStruct">Calculate lmeStruct Fitted Values</a></li>
<li class="help-index-item"><a href="#fitted.lmList">Extract lmList Fitted Values</a></li>
<li class="help-index-item"><a href="#fitted.nlmeStruct">Calculate nlmeStruct Fitted Values</a></li>
<li class="help-index-item"><a href="#fixed.effects">Extract Fixed Effects</a></li>
<li class="help-index-item"><a href="#fixef.lmList">Extract lmList Fixed Effects</a></li>
<li class="help-index-item"><a href="#formula.pdBlocked">Extract pdBlocked Formula</a></li>
<li class="help-index-item"><a href="#formula.pdMat">Extract pdMat Formula</a></li>
<li class="help-index-item"><a href="#formula.reStruct">Extract reStruct Object Formula</a></li>
<li class="help-index-item"><a href="#gapply">Apply a Function by Groups</a></li>
<li class="help-index-item"><a href="#Gasoline">Refinery yield of gasoline</a></li>
<li class="help-index-item"><a href="#getCovariate">Extract Covariate from an Object</a></li>
<li class="help-index-item"><a href="#getCovariate.corStruct">Extract corStruct Object Covariate</a></li>
<li class="help-index-item"><a href="#getCovariate.data.frame">Extract Data Frame Covariate</a></li>
<li class="help-index-item"><a href="#getCovariate.varFunc">Extract varFunc Covariate</a></li>
<li class="help-index-item"><a href="#getCovariateFormula">Extract Covariates Formula</a></li>
<li class="help-index-item"><a href="#getData">Extract Data from an Object</a></li>
<li class="help-index-item"><a href="#getData.gls">Extract gls Object Data</a></li>
<li class="help-index-item"><a href="#getData.lme">Extract lme Object Data</a></li>
<li class="help-index-item"><a href="#getData.lmList">Extract lmList Object Data</a></li>
<li class="help-index-item"><a href="#getGroups">Extract Grouping Factors from an Object</a></li>
<li class="help-index-item"><a href="#getGroups.corStruct">Extract corStruct Groups</a></li>
<li class="help-index-item"><a href="#getGroups.data.frame">Extract Groups from a Data Frame</a></li>
<li class="help-index-item"><a href="#getGroups.gls">Extract gls Object Groups</a></li>
<li class="help-index-item"><a href="#getGroups.lme">Extract lme Object Groups</a></li>
<li class="help-index-item"><a href="#getGroups.lmList">Extract lmList Object Groups</a></li>
<li class="help-index-item"><a href="#getGroups.varFunc">Extract varFunc Groups</a></li>
<li class="help-index-item"><a href="#getGroupsFormula">Extract Grouping Formula</a></li>
<li class="help-index-item"><a href="#getResponse">Extract Response Variable from an Object</a></li>
<li class="help-index-item"><a href="#getResponseFormula">Extract Formula Specifying Response Variable</a></li>
<li class="help-index-item"><a href="#getVarCov">Extract variance-covariance matrix</a></li>
<li class="help-index-item"><a href="#gls">Fit Linear Model Using Generalized Least Squares</a></li>
<li class="help-index-item"><a href="#gls-internal">Auxiliary functions used by gls</a></li>
<li class="help-index-item"><a href="#glsControl">Control Values for gls Fit</a></li>
<li class="help-index-item"><a href="#glsObject">Fitted gls Object</a></li>
<li class="help-index-item"><a href="#glsStruct">Generalized Least Squares Structure</a></li>
<li class="help-index-item"><a href="#Glucose">Glucose levels over time</a></li>
<li class="help-index-item"><a href="#Glucose2">Glucose Levels Following Alcohol Ingestion</a></li>
<li class="help-index-item"><a href="#gnls">Fit Nonlinear Model Using Generalized Least Squares</a></li>
<li class="help-index-item"><a href="#gnlsControl">Control Values for gnls Fit</a></li>
<li class="help-index-item"><a href="#gnlsObject">Fitted gnls Object</a></li>
<li class="help-index-item"><a href="#gnlsStruct">Generalized Nonlinear Least Squares Structure</a></li>
<li class="help-index-item"><a href="#groupedData">Construct a groupedData Object</a></li>
<li class="help-index-item"><a href="#gsummary">Summarize by Groups</a></li>
<li class="help-index-item"><a href="#Gun">Methods for firing naval guns</a></li>
<li class="help-index-item"><a href="#IGF">Radioimmunoassay of IGF-I Protein</a></li>
<li class="help-index-item"><a href="#Initialize">Initialize Object</a></li>
<li class="help-index-item"><a href="#Initialize.corStruct">Initialize corStruct Object</a></li>
<li class="help-index-item"><a href="#Initialize.glsStruct">Initialize a glsStruct Object</a></li>
<li class="help-index-item"><a href="#Initialize.lmeStruct">Initialize an lmeStruct Object</a></li>
<li class="help-index-item"><a href="#Initialize.reStruct">Initialize reStruct Object</a></li>
<li class="help-index-item"><a href="#Initialize.varFunc">Initialize varFunc Object</a></li>
<li class="help-index-item"><a href="#intervals">Confidence Intervals on Coefficients</a></li>
<li class="help-index-item"><a href="#intervals.gls">Confidence Intervals on gls Parameters</a></li>
<li class="help-index-item"><a href="#intervals.lme">Confidence Intervals on lme Parameters</a></li>
<li class="help-index-item"><a href="#intervals.lmList">Confidence Intervals on lmList Coefficients</a></li>
<li class="help-index-item"><a href="#isBalanced">Check a Design for Balance</a></li>
<li class="help-index-item"><a href="#isInitialized">Check if Object is Initialized</a></li>
<li class="help-index-item"><a href="#LDEsysMat">Generate system matrix for LDEs</a></li>
<li class="help-index-item"><a href="#lme">Linear Mixed-Effects Models</a></li>
<li class="help-index-item"><a href="#lme.groupedData">LME fit from groupedData Object</a></li>
<li class="help-index-item"><a href="#lme.lmList">LME fit from lmList Object</a></li>
<li class="help-index-item"><a href="#lmeControl">Specifying Control Values for lme Fit</a></li>
<li class="help-index-item"><a href="#lmeObject">Fitted lme Object</a></li>
<li class="help-index-item"><a href="#lmeStruct">Linear Mixed-Effects Structure</a></li>
<li class="help-index-item"><a href="#lmList">List of lm Objects with a Common Model</a></li>
<li class="help-index-item"><a href="#lmList.groupedData">lmList Fit from a groupedData Object</a></li>
<li class="help-index-item"><a href="#logDet">Extract the Logarithm of the Determinant</a></li>
<li class="help-index-item"><a href="#logDet.corStruct">Extract corStruct Log-Determinant</a></li>
<li class="help-index-item"><a href="#logDet.pdMat">Extract Log-Determinant from a pdMat Object</a></li>
<li class="help-index-item"><a href="#logDet.reStruct">Extract reStruct Log-Determinants</a></li>
<li class="help-index-item"><a href="#logLik.corStruct">Extract corStruct Log-Likelihood</a></li>
<li class="help-index-item"><a href="#logLik.glsStruct">Log-Likelihood of a glsStruct Object</a></li>
<li class="help-index-item"><a href="#logLik.gnls">Log-Likelihood of a gnls Object</a></li>
<li class="help-index-item"><a href="#logLik.gnlsStruct">Log-Likelihood of a gnlsStruct Object</a></li>
<li class="help-index-item"><a href="#logLik.lme">Log-Likelihood of an lme Object</a></li>
<li class="help-index-item"><a href="#logLik.lmeStruct">Log-Likelihood of an lmeStruct Object</a></li>
<li class="help-index-item"><a href="#logLik.lmList">Log-Likelihood of an lmList Object</a></li>
<li class="help-index-item"><a href="#logLik.reStruct">Calculate reStruct Log-Likelihood</a></li>
<li class="help-index-item"><a href="#logLik.varFunc">Extract varFunc logLik</a></li>
<li class="help-index-item"><a href="#Machines">Productivity Scores for Machines and Workers</a></li>
<li class="help-index-item"><a href="#MathAchieve">Mathematics achievement scores</a></li>
<li class="help-index-item"><a href="#MathAchSchool">School demographic data for MathAchieve</a></li>
<li class="help-index-item"><a href="#Matrix">Assign Matrix Values</a></li>
<li class="help-index-item"><a href="#Matrix.pdMat">Assign Matrix to a pdMat or pdBlocked Object</a></li>
<li class="help-index-item"><a href="#Matrix.reStruct">Assign reStruct Matrices</a></li>
<li class="help-index-item"><a href="#Meat">Tenderness of meat</a></li>
<li class="help-index-item"><a href="#Milk">Protein content of cows' milk</a></li>
<li class="help-index-item"><a href="#model.matrix.reStruct">reStruct Model Matrix</a></li>
<li class="help-index-item"><a href="#Muscle">Contraction of heart muscle sections</a></li>
<li class="help-index-item"><a href="#Names">Names Associated with an Object</a></li>
<li class="help-index-item"><a href="#Names.formula">Extract Names from a formula</a></li>
<li class="help-index-item"><a href="#Names.pdBlocked">Names of a pdBlocked Object</a></li>
<li class="help-index-item"><a href="#Names.pdMat">Names of a pdMat Object</a></li>
<li class="help-index-item"><a href="#Names.reStruct">Names of an reStruct Object</a></li>
<li class="help-index-item"><a href="#needUpdate">Check if Update is Needed</a></li>
<li class="help-index-item"><a href="#needUpdate.modelStruct">Check if a modelStruct Object Needs Updating</a></li>
<li class="help-index-item"><a href="#Nitrendipene">Assay of nitrendipene</a></li>
<li class="help-index-item"><a href="#nlme">Nonlinear Mixed-Effects Models</a></li>
<li class="help-index-item"><a href="#nlme.nlsList">NLME fit from nlsList Object</a></li>
<li class="help-index-item"><a href="#nlmeControl">Control Values for nlme Fit</a></li>
<li class="help-index-item"><a href="#nlmeObject">Fitted nlme Object</a></li>
<li class="help-index-item"><a href="#nlmeStruct">Nonlinear Mixed-Effects Structure</a></li>
<li class="help-index-item"><a href="#nlsList">List of nls Objects with a Common Model</a></li>
<li class="help-index-item"><a href="#nlsList.selfStart">nlsList Fit from a selfStart Function</a></li>
<li class="help-index-item"><a href="#Oats">Split-plot Experiment on Varieties of Oats</a></li>
<li class="help-index-item"><a href="#Orthodont">Growth curve data on an orthdontic measurement</a></li>
<li class="help-index-item"><a href="#Ovary">Counts of Ovarian Follicles</a></li>
<li class="help-index-item"><a href="#Oxboys">Heights of Boys in Oxford</a></li>
<li class="help-index-item"><a href="#Oxide">Variability in Semiconductor Manufacturing</a></li>
<li class="help-index-item"><a href="#pairs.compareFits">Pairs Plot of compareFits Object</a></li>
<li class="help-index-item"><a href="#pairs.lme">Pairs Plot of an lme Object</a></li>
<li class="help-index-item"><a href="#pairs.lmList">Pairs Plot of an lmList Object</a></li>
<li class="help-index-item"><a href="#PBG">Effect of Phenylbiguanide on Blood Pressure</a></li>
<li class="help-index-item"><a href="#pdBlocked">Positive-Definite Block Diagonal Matrix</a></li>
<li class="help-index-item"><a href="#pdClasses">Positive-Definite Matrix Classes</a></li>
<li class="help-index-item"><a href="#pdCompSymm">Positive-Definite Matrix with Compound Symmetry Structure</a></li>
<li class="help-index-item"><a href="#pdConstruct">Construct pdMat Objects</a></li>
<li class="help-index-item"><a href="#pdConstruct.pdBlocked">Construct pdBlocked Objects</a></li>
<li class="help-index-item"><a href="#pdDiag">Diagonal Positive-Definite Matrix</a></li>
<li class="help-index-item"><a href="#pdFactor">Square-Root Factor of a Positive-Definite Matrix</a></li>
<li class="help-index-item"><a href="#pdFactor.reStruct">Extract Square-Root Factor from Components of an reStruct Object</a></li>
<li class="help-index-item"><a href="#pdIdent">Multiple of the Identity Positive-Definite Matrix</a></li>
<li class="help-index-item"><a href="#pdLogChol">General Positive-Definite Matrix</a></li>
<li class="help-index-item"><a href="#pdMat">Positive-Definite Matrix</a></li>
<li class="help-index-item"><a href="#pdMatrix">Extract Matrix or Square-Root Factor from a pdMat Object</a></li>
<li class="help-index-item"><a href="#pdMatrix.reStruct">Extract Matrix or Square-Root Factor from Components of an
reStruct Object</a></li>
<li class="help-index-item"><a href="#pdNatural">General Positive-Definite Matrix in Natural Parametrization</a></li>
<li class="help-index-item"><a href="#pdSymm">General Positive-Definite Matrix</a></li>
<li class="help-index-item"><a href="#Phenobarb">Phenobarbitol Kinetics</a></li>
<li class="help-index-item"><a href="#phenoModel">Model function for the Phenobarb data</a></li>
<li class="help-index-item"><a href="#Pixel">X-ray pixel intensities over time</a></li>
<li class="help-index-item"><a href="#plot.ACF">Plot an ACF Object</a></li>
<li class="help-index-item"><a href="#plot.augPred">Plot an augPred Object</a></li>
<li class="help-index-item"><a href="#plot.compareFits">Plot a compareFits Object</a></li>
<li class="help-index-item"><a href="#plot.gls">Plot a gls Object</a></li>
<li class="help-index-item"><a href="#plot.intervals.lmList">Plot lmList Confidence Intervals</a></li>
<li class="help-index-item"><a href="#plot.lme">Plot an lme or nls object</a></li>
<li class="help-index-item"><a href="#plot.lmList">Plot an lmList Object</a></li>
<li class="help-index-item"><a href="#plot.nffGroupedData">Plot an nffGroupedData Object</a></li>
<li class="help-index-item"><a href="#plot.nfnGroupedData">Plot an nfnGroupedData Object</a></li>
<li class="help-index-item"><a href="#plot.nmGroupedData">Plot an nmGroupedData Object</a></li>
<li class="help-index-item"><a href="#plot.ranef.lme">Plot a ranef.lme Object</a></li>
<li class="help-index-item"><a href="#plot.ranef.lmList">Plot a ranef.lmList Object</a></li>
<li class="help-index-item"><a href="#plot.Variogram">Plot a Variogram Object</a></li>
<li class="help-index-item"><a href="#pooledSD">Extract Pooled Standard Deviation</a></li>
<li class="help-index-item"><a href="#predict.gls">Predictions from a gls Object</a></li>
<li class="help-index-item"><a href="#predict.gnls">Predictions from a gnls Object</a></li>
<li class="help-index-item"><a href="#predict.lme">Predictions from an lme Object</a></li>
<li class="help-index-item"><a href="#predict.lmList">Predictions from an lmList Object</a></li>
<li class="help-index-item"><a href="#predict.nlme">Predictions from an nlme Object</a></li>
<li class="help-index-item"><a href="#print.summary.pdMat">Print a summary.pdMat Object</a></li>
<li class="help-index-item"><a href="#print.varFunc">Print a varFunc Object</a></li>
<li class="help-index-item"><a href="#qqnorm.gls">Normal Plot of Residuals from a gls Object</a></li>
<li class="help-index-item"><a href="#qqnorm.lme">Normal Plot of Residuals or Random Effects from an lme Object</a></li>
<li class="help-index-item"><a href="#Quinidine">Quinidine Kinetics</a></li>
<li class="help-index-item"><a href="#quinModel">Model function for the Quinidine data</a></li>
<li class="help-index-item"><a href="#Rail">Evaluation of Stress in Railway Rails</a></li>
<li class="help-index-item"><a href="#random.effects">Extract Random Effects</a></li>
<li class="help-index-item"><a href="#ranef.lme">Extract lme Random Effects</a></li>
<li class="help-index-item"><a href="#ranef.lmList">Extract lmList Random Effects</a></li>
<li class="help-index-item"><a href="#RatPupWeight">The weight of rat pups</a></li>
<li class="help-index-item"><a href="#recalc">Recalculate Condensed Linear Model Object</a></li>
<li class="help-index-item"><a href="#recalc.corStruct">Recalculate for corStruct Object</a></li>
<li class="help-index-item"><a href="#recalc.modelStruct">Recalculate for a modelStruct Object</a></li>
<li class="help-index-item"><a href="#recalc.reStruct">Recalculate for an reStruct Object</a></li>
<li class="help-index-item"><a href="#recalc.varFunc">Recalculate for varFunc Object</a></li>
<li class="help-index-item"><a href="#Relaxin">Assay for Relaxin</a></li>
<li class="help-index-item"><a href="#Remifentanil">Pharmacokinetics of Remifentanil</a></li>
<li class="help-index-item"><a href="#residuals.gls">Extract gls Residuals</a></li>
<li class="help-index-item"><a href="#residuals.glsStruct">Calculate glsStruct Residuals</a></li>
<li class="help-index-item"><a href="#residuals.gnlsStruct">Calculate gnlsStruct Residuals</a></li>
<li class="help-index-item"><a href="#residuals.lme">Extract lme Residuals</a></li>
<li class="help-index-item"><a href="#residuals.lmeStruct">Calculate lmeStruct Residuals</a></li>
<li class="help-index-item"><a href="#residuals.lmList">Extract lmList Residuals</a></li>
<li class="help-index-item"><a href="#residuals.nlmeStruct">Calculate nlmeStruct Residuals</a></li>
<li class="help-index-item"><a href="#reStruct">Random Effects Structure</a></li>
<li class="help-index-item"><a href="#simulate.lme">Simulate Results from lme Models</a></li>
<li class="help-index-item"><a href="#solve.pdMat">Calculate Inverse of a Positive-Definite Matrix</a></li>
<li class="help-index-item"><a href="#solve.reStruct">Apply Solve to an reStruct Object</a></li>
<li class="help-index-item"><a href="#Soybean">Growth of soybean plants</a></li>
<li class="help-index-item"><a href="#splitFormula">Split a Formula</a></li>
<li class="help-index-item"><a href="#Spruce">Growth of Spruce Trees</a></li>
<li class="help-index-item"><a href="#summary.corStruct">Summarize a corStruct Object</a></li>
<li class="help-index-item"><a href="#summary.gls">Summarize a Generalized Least Squares gls Object</a></li>
<li class="help-index-item"><a href="#summary.lme">Summarize an lme Object</a></li>
<li class="help-index-item"><a href="#summary.lmList">Summarize an lmList Object</a></li>
<li class="help-index-item"><a href="#summary.modelStruct">Summarize a modelStruct Object</a></li>
<li class="help-index-item"><a href="#summary.nlsList">Summarize an nlsList Object</a></li>
<li class="help-index-item"><a href="#summary.pdMat">Summarize a pdMat Object</a></li>
<li class="help-index-item"><a href="#summary.varFunc">Summarize "varFunc" Object</a></li>
<li class="help-index-item"><a href="#Tetracycline1">Pharmacokinetics of tetracycline</a></li>
<li class="help-index-item"><a href="#Tetracycline2">Pharmacokinetics of tetracycline</a></li>
<li class="help-index-item"><a href="#update.modelStruct">Update a modelStruct Object</a></li>
<li class="help-index-item"><a href="#update.varFunc">Update varFunc Object</a></li>
<li class="help-index-item"><a href="#varClasses">Variance Function Classes</a></li>
<li class="help-index-item"><a href="#varComb">Combination of Variance Functions</a></li>
<li class="help-index-item"><a href="#varConstPower">Constant Plus Power Variance Function</a></li>
<li class="help-index-item"><a href="#varConstProp">Constant Plus Proportion Variance Function</a></li>
<li class="help-index-item"><a href="#VarCorr">Extract variance and correlation components</a></li>
<li class="help-index-item"><a href="#varExp">Exponential Variance Function</a></li>
<li class="help-index-item"><a href="#varFixed">Fixed Variance Function</a></li>
<li class="help-index-item"><a href="#varFunc">Variance Function Structure</a></li>
<li class="help-index-item"><a href="#varIdent">Constant Variance Function</a></li>
<li class="help-index-item"><a href="#Variogram">Calculate Semi-variogram</a></li>
<li class="help-index-item"><a href="#Variogram.corExp">Calculate Semi-variogram for a corExp Object</a></li>
<li class="help-index-item"><a href="#Variogram.corGaus">Calculate Semi-variogram for a corGaus Object</a></li>
<li class="help-index-item"><a href="#Variogram.corLin">Calculate Semi-variogram for a corLin Object</a></li>
<li class="help-index-item"><a href="#Variogram.corRatio">Calculate Semi-variogram for a corRatio Object</a></li>
<li class="help-index-item"><a href="#Variogram.corSpatial">Calculate Semi-variogram for a corSpatial Object</a></li>
<li class="help-index-item"><a href="#Variogram.corSpher">Calculate Semi-variogram for a corSpher Object</a></li>
<li class="help-index-item"><a href="#Variogram.default">Calculate Semi-variogram</a></li>
<li class="help-index-item"><a href="#Variogram.gls">Calculate Semi-variogram for Residuals from a gls Object</a></li>
<li class="help-index-item"><a href="#Variogram.lme">Calculate Semi-variogram for Residuals from an lme Object</a></li>
<li class="help-index-item"><a href="#varPower">Power Variance Function</a></li>
<li class="help-index-item"><a href="#varWeights">Extract Variance Function Weights</a></li>
<li class="help-index-item"><a href="#varWeights.glsStruct">Variance Weights for glsStruct Object</a></li>
<li class="help-index-item"><a href="#varWeights.lmeStruct">Variance Weights for lmeStruct Object</a></li>
<li class="help-index-item"><a href="#Wafer">Modeling of Analog MOS Circuits</a></li>
<li class="help-index-item"><a href="#Wheat">Yields by growing conditions</a></li>
<li class="help-index-item"><a href="#Wheat2">Wheat Yield Trials</a></li>
</ul>

    <hr>
  <div class="container manual-page" id="Extract.pdMat">

<a href="#Extract.pdMat" class="help-page-title"><h2>Subscript a pdMat Object</h2></a>

<h3>Description</h3>

<p>This method function extracts sub-matrices from the positive-definite
matrix represented by <code>x</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
x<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">]</span>
<span class="token comment">## S3 replacement method for class 'pdMat'</span>
x<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code> representing a
positive-definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i, j</code></td>
<td>
<p>optional subscripts applying respectively to the rows
and columns of the positive-definite matrix represented by
<code>object</code>. When <code>i</code> (<code>j</code>) is omitted, all rows (columns)
are extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, single rows or columns are
converted to vectors. If <code>FALSE</code> the returned value retains its
matrix representation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a vector, or matrix, with the replacement values for the
relevant piece of the matrix represented by <code>x</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>i</code> and <code>j</code> are identical, the returned value will be
<code>pdMat</code> object with the same class as <code>x</code>. Otherwise, the
returned value will be a matrix. In the case a single row (or column)
is selected, the returned value may be converted to a vector,
according to the rules above.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#Extract">[</a></code>, <code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pd1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> drop <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">]</span>
pd1<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">3</span> <span class="token operator">*</span> diag<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ACF">

<a href="#ACF" class="help-page-title"><h2>Autocorrelation Function</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include: <code>gls</code> and  <code>lme</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">ACF<span class="token punctuation">(</span>object<span class="token punctuation">,</span> maxLag<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object from which an autocorrelation function can be
obtained. Generally an object resulting from a model fit, from which
residuals can be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxLag</code></td>
<td>
<p>maximum lag for which the autocorrelation should be
calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:Bates@stat.wisc.edu">Bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day. 
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#ACF.gls">ACF.gls</a></code>,
<code><a href="#ACF.lme">ACF.lme</a></code>,
<code><a href="#plot.ACF">plot.ACF</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ACF.gls">

<a href="#ACF.gls" class="help-page-title"><h2>Autocorrelation Function for gls Residuals</h2></a>

<h3>Description</h3>

<p>This method function calculates the empirical autocorrelation function
for the residuals from a <code>gls</code> fit. If a grouping variable is
specified in <code>form</code>, the autocorrelation values
are calculated using pairs of residuals within the same group;
otherwise all possible residual pairs are used. The autocorrelation
function is useful for investigating serial correlation models for
equally spaced data.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
ACF<span class="token punctuation">(</span>object<span class="token punctuation">,</span> maxLag<span class="token punctuation">,</span> resType<span class="token punctuation">,</span> form<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gls">gls</a>"</code>, representing
a generalized least squares fitted  model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxLag</code></td>
<td>
<p>an optional integer giving the maximum lag for which the
autocorrelation should be calculated. Defaults to maximum lag in the
residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resType</code></td>
<td>
<p>an optional character string specifying the type of
residuals to be used. If <code>"response"</code>, the "raw" residuals
(observed - fitted) are used; else, if <code>"pearson"</code>, the
standardized residuals (raw residuals divided by the corresponding
standard errors) are used; else, if <code>"normalized"</code>, the
normalized residuals (standardized residuals pre-multiplied by the
inverse square-root factor of the estimated error correlation
matrix) are used. Partial matching of arguments is used, so only the
first character needs to be provided. Defaults to <code>"pearson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one sided formula of the form <code>~ t</code>, or
<code>~ t | g</code>, specifying a time covariate <code>t</code> and,  optionally, a
grouping factor <code>g</code>. The time covariate must be integer
valued. When a grouping factor is present in 
<code>form</code>, the autocorrelations are calculated using residual pairs
within the same group. Defaults to <code>~ 1</code>, which corresponds to
using the order of the observations in the data as a covariate, and
no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>ACF.gls</code> to print an error message and terminate if there are any
incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>lag</code> and <code>ACF</code> representing,
respectively, the lag between residuals within a pair and the corresponding
empirical autocorrelation. The returned value inherits from class
<code>ACF</code>.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#ACF.lme">ACF.lme</a></code>, <code><a href="#plot.ACF">plot.ACF</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">)</span>
ACF<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 255-257</span>
fm1Dial.gls <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>rate <span class="token operator">~</span>
  <span class="token punctuation">(</span>pressure<span class="token operator">+</span>I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span>I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span>I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>QB<span class="token punctuation">,</span>
                   Dialyzer<span class="token punctuation">)</span>

fm2Dial.gls <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Dial.gls<span class="token punctuation">,</span>
                 weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> pressure<span class="token punctuation">)</span><span class="token punctuation">)</span>

ACF<span class="token punctuation">(</span>fm2Dial.gls<span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ACF.lme">

<a href="#ACF.lme" class="help-page-title"><h2>Autocorrelation Function for lme Residuals</h2></a>

<h3>Description</h3>

<p>This method function calculates the empirical autocorrelation function
for the within-group residuals from an <code>lme</code> fit. The
autocorrelation values are calculated using pairs of residuals within
the innermost group level. The autocorrelation function is  useful for
investigating serial correlation models for equally spaced data. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
ACF<span class="token punctuation">(</span>object<span class="token punctuation">,</span> maxLag<span class="token punctuation">,</span> resType<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxLag</code></td>
<td>
<p>an optional integer giving the maximum lag for which the
autocorrelation should be calculated. Defaults to maximum lag in the
within-group residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resType</code></td>
<td>
<p>an optional character string specifying the type of
residuals to be used. If <code>"response"</code>, the "raw" residuals
(observed - fitted) are used; else, if <code>"pearson"</code>, the
standardized residuals (raw residuals divided by the corresponding
standard errors) are used; else, if <code>"normalized"</code>, the
normalized residuals (standardized residuals pre-multiplied by the
inverse square-root factor of the estimated error correlation
matrix) are used. Partial matching of arguments is used, so only the
first character needs to be provided. Defaults to <code>"pearson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments – not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>lag</code> and <code>ACF</code> representing,
respectively, the lag between residuals within a pair and the corresponding
empirical autocorrelation. The returned value inherits from class
<code>ACF</code>.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day. 
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#ACF.gls">ACF.gls</a></code>, <code><a href="#plot.ACF">plot.ACF</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span>
           Ovary<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span>
ACF<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> maxLag <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p240-241</span>
fm1Over.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>follicles  <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span>
           cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token operator">=</span>Ovary<span class="token punctuation">,</span>
     random<span class="token operator">=</span>pdDiag<span class="token punctuation">(</span><span class="token operator">~</span>sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token punctuation">(</span>ACF.fm1Over <span class="token operator">&lt;-</span> ACF<span class="token punctuation">(</span>fm1Over.lme<span class="token punctuation">,</span> maxLag<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>ACF.fm1Over<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Alfalfa">

<a href="#Alfalfa" class="help-page-title"><h2>Split-Plot Experiment on Varieties of Alfalfa</h2></a>

<h3>Description</h3>

<p>The <code>Alfalfa</code> data frame has 72 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Variety</dt>
<dd>
<p>a factor with levels
<code>Cossack</code>,
<code>Ladak</code>, and 
<code>Ranger</code> 
</p>
</dd>
<dt>Date</dt>
<dd>
<p>a factor with levels
<code>None</code> 
<code>S1</code> 
<code>S20</code> 
<code>O7</code> 
</p>
</dd>
<dt>Block</dt>
<dd>
<p>a factor with levels
<code>1</code> 
<code>2</code> 
<code>3</code> 
<code>4</code> 
<code>5</code> 
<code>6</code> 
</p>
</dd>
<dt>Yield</dt>
<dd>
<p>a numeric vector
</p>
</dd>
</dl>
<h3>Details</h3>

<p>These data are described in Snedecor and Cochran (1980) as
an example of a split-plot design. The treatment structure used in the
experiment was a 3<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code>4 full factorial, with three varieties of
alfalfa and four dates of third cutting in 1943. The experimental
units were arranged into six blocks, each subdivided into four plots.
The varieties of alfalfa (<em>Cossac</em>, <em>Ladak</em>, and
<em>Ranger</em>) were assigned randomly to the blocks and the dates of
third cutting (<em>None</em>, <em>S1</em>—September 1,
<em>S20</em>—September 20, and <em>O7</em>—October 7) were randomly
assigned to the plots.  All four dates were used on each block.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.1)
</p>
<p>Snedecor, G. W. and Cochran, W. G. (1980), <em>Statistical Methods (7th
ed)</em>, Iowa State University Press, Ames, IA
</p>

<hr>
</div>
<div class="container manual-page" id="allCoef">

<a href="#allCoef" class="help-page-title"><h2>Extract Coefficients from a Set of Objects</h2></a>

<h3>Description</h3>

<p>The extractor function is applied to each object in <code>...</code>, with
the result being converted to a vector. A <code>map</code> attribute is
included to indicate which pieces of the returned vector correspond to
the original objects in <code>dots</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">allCoef<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">,</span> extract<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>objects to which <code>extract</code> will be applied. Generally
these will be model components, such as <code>corStruct</code> and
<code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extract</code></td>
<td>
<p>an optional extractor function. Defaults to <code>coef</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with all elements, generally coefficients, obtained by
applying <code>extract</code> to the objects in <code>...</code>. 
</p>


<h3>Author(s)</h3>

<p>José' Pinheiro and Douglas Bates</p>


<h3>See Also</h3>

<p><code><a href="#lmeStruct">lmeStruct</a></code>,<code><a href="#nlmeStruct">nlmeStruct</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
allCoef<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> vf1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="anova.gls">

<a href="#anova.gls" class="help-page-title"><h2>Compare Likelihoods of Fitted Objects</h2></a>

<h3>Description</h3>

<p>When only one fitted model object is present, a data frame with the
numerator degrees of freedom, F-values, and P-values
for Wald tests for the terms in the model (when <code>Terms</code> and
<code>L</code> are <code>NULL</code>), a combination of model terms (when
<code>Terms</code> in not <code>NULL</code>), or linear combinations of the model
coefficients (when <code>L</code> is not <code>NULL</code>). Otherwise, when
multiple fitted objects are being compared, a data frame with
the degrees of freedom, the (restricted) log-likelihood, the 
Akaike Information Criterion (AIC), and the Bayesian Information
Criterion (BIC) of each object is returned. If <code>test=TRUE</code>,
whenever two consecutive  objects have different number of degrees of
freedom, a likelihood ratio statistic with the associated p-value is
included in the returned data frame.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
anova<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> test<span class="token punctuation">,</span> type<span class="token punctuation">,</span> adjustSigma<span class="token punctuation">,</span> Terms<span class="token punctuation">,</span> L<span class="token punctuation">,</span> verbose<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gls">gls</a>"</code>,
representing a generalized least squares fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other optional fitted model objects inheriting from
classes <code>"gls"</code>, <code>"gnls"</code>, <code>"lm"</code>, <code>"lme"</code>,
<code>"lmList"</code>, <code>"nlme"</code>, <code>"nlsList"</code>, or <code>"nls"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>an optional logical value controlling whether likelihood
ratio tests should be used to compare the fitted models represented
by <code>object</code> and the objects in <code>...</code>. Defaults to
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>an optional character string specifying the type of sum of
squares to be used in F-tests for the terms in the model. If 
<code>"sequential"</code>, the sequential sum of squares obtained by
including the terms in the order they appear in the model is used;
else, if <code>"marginal"</code>, the marginal sum of squares
obtained by deleting a term from the model at a time is used. This
argument is only used when a single fitted object is passed to the
function. Partial matching of arguments is used, so only the first
character needs to be provided. Defaults to <code>"sequential"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustSigma</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> and the
estimation method used to obtain <code>object</code> was maximum
likelihood, the residual standard error is multiplied by
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><msub><mi>n</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mo>−</mo><msub><mi>n</mi><mrow><mi>p</mi><mi>a</mi><mi>r</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{n_{obs}/(n_{obs} - n_{par})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.3231em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9169em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.8769em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3231em;"><span></span></span></span></span></span></span></span></span></code>,
converting it to a REML-like estimate. This argument is only used
when a single fitted object is passed to the function. Default is
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Terms</code></td>
<td>
<p>an optional integer or character vector specifying which
terms in the model should be jointly tested to be zero using a Wald
F-test. If given as a character vector, its elements must correspond
to term names; else, if given as an integer vector, its elements must
correspond to the order in which terms are included in the
model. This argument is only used when a single fitted object is
passed to the function. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>an optional numeric vector or array specifying linear
combinations of the coefficients in the model that should be tested
to be zero. If given as an array, its rows define the linear
combinations to be tested. If names are assigned to the vector
elements (array columns), they must correspond to coefficients
names and will be used to map the linear combination(s) to the
coefficients; else, if no names are available, the vector elements
(array columns) are assumed in the same order as the coefficients
appear in the model. This argument is only used when a single fitted
object is passed to the function. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, the calling
sequences for each fitted model object are printed with the rest of
the output, being omitted if <code>verbose = FALSE</code>. Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame inheriting from class <code>"anova.lme"</code>.
</p>


<h3>Note</h3>

<p>Likelihood comparisons are not meaningful for objects fit using
restricted maximum likelihood and with different fixed effects.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  
</p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>, <code><a href="#gnls">gnls</a></code>, <code><a href="#nlme">nlme</a></code>,
<code><a href="#lme">lme</a></code>, <code><a href="#logLik.lme">logLik.gls</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#AIC">AIC</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#AIC">BIC</a></code>,
<code><a href="#anova.lme">print.anova.lme</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># AR(1) errors within each Mare</span>
fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
<span class="token comment"># variance changes with a power of the absolute fitted values?</span>
fm2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> fm2<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 251-252</span>
fm1Orth.gls <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>distance <span class="token operator">~</span> Sex <span class="token operator">*</span> I<span class="token punctuation">(</span>age <span class="token operator">-</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span>
                correlation <span class="token operator">=</span> corSymm<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span><span class="token punctuation">,</span>
                weights <span class="token operator">=</span> varIdent<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> age<span class="token punctuation">)</span><span class="token punctuation">)</span>
fm2Orth.gls <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Orth.gls<span class="token punctuation">,</span>
                corr <span class="token operator">=</span> corCompSymm<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span><span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm1Orth.gls<span class="token punctuation">,</span> fm2Orth.gls<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, pp. 215-215, 255-260</span>
<span class="token comment">#p. 215</span>
fm1Dial.lme <span class="token operator">&lt;-</span>
  lme<span class="token punctuation">(</span>rate <span class="token operator">~</span><span class="token punctuation">(</span>pressure <span class="token operator">+</span> I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>QB<span class="token punctuation">,</span>
      Dialyzer<span class="token punctuation">,</span> <span class="token operator">~</span> pressure <span class="token operator">+</span> I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 216</span>
fm2Dial.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Dial.lme<span class="token punctuation">,</span>
                  weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> pressure<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 255</span>
fm1Dial.gls <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>rate <span class="token operator">~</span> <span class="token punctuation">(</span>pressure <span class="token operator">+</span>
     I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>QB<span class="token punctuation">,</span>
        Dialyzer<span class="token punctuation">)</span>
fm2Dial.gls <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Dial.gls<span class="token punctuation">,</span>
                 weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> pressure<span class="token punctuation">)</span><span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm1Dial.gls<span class="token punctuation">,</span> fm2Dial.gls<span class="token punctuation">)</span>
fm3Dial.gls <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm2Dial.gls<span class="token punctuation">,</span>
                    corr <span class="token operator">=</span> corAR1<span class="token punctuation">(</span><span class="token number">0.771</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span><span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm2Dial.gls<span class="token punctuation">,</span> fm3Dial.gls<span class="token punctuation">)</span>
<span class="token comment"># anova.gls to compare a gls and an lme fit </span>
anova<span class="token punctuation">(</span>fm3Dial.gls<span class="token punctuation">,</span> fm2Dial.lme<span class="token punctuation">,</span> test <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, pp. 261-266</span>
fm1Wheat2 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>yield <span class="token operator">~</span> variety <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Wheat2<span class="token punctuation">)</span>
fm3Wheat2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Wheat2<span class="token punctuation">,</span>
      corr <span class="token operator">=</span> corRatio<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">12.5</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        form <span class="token operator">=</span> <span class="token operator">~</span> latitude <span class="token operator">+</span> longitude<span class="token punctuation">,</span> nugget <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Test a specific contrast </span>
anova<span class="token punctuation">(</span>fm3Wheat2<span class="token punctuation">,</span> L <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="anova.lme">

<a href="#anova.lme" class="help-page-title"><h2>Compare Likelihoods of Fitted Objects</h2></a>

<h3>Description</h3>

<p>When only one fitted model object is present, a data frame with the
numerator degrees of freedom, denominator degrees of
freedom, F-values, and P-values for Wald tests for the terms in the
model (when <code>Terms</code> and <code>L</code> are <code>NULL</code>), a combination
of model terms (when <code>Terms</code> in not <code>NULL</code>), or linear
combinations of the model coefficients (when <code>L</code> is not
<code>NULL</code>).  Otherwise, when multiple fitted objects are being
compared, a data frame with the degrees of freedom, the (restricted)
log-likelihood, the Akaike Information Criterion (AIC), and the
Bayesian Information Criterion (BIC) of each object is returned.  If
<code>test=TRUE</code>, whenever two consecutive  objects have different
number of degrees of freedom, a likelihood ratio statistic with the
associated p-value is included in the returned data frame.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
anova<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> test<span class="token punctuation">,</span> type<span class="token punctuation">,</span> adjustSigma<span class="token punctuation">,</span> Terms<span class="token punctuation">,</span> L<span class="token punctuation">,</span> verbose<span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'anova.lme'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> verbose<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>,
representing a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other optional fitted model objects inheriting from
classes <code>"gls"</code>, <code>"gnls"</code>, <code>"lm"</code>, <code>"lme"</code>,
<code>"lmList"</code>, <code>"nlme"</code>, <code>"nlsList"</code>, or <code>"nls"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>an optional logical value controlling whether likelihood
ratio tests should be used to compare the fitted models represented
by <code>object</code> and the objects in <code>...</code>.  Defaults to
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>an optional character string specifying the type of sum of
squares to be used in F-tests for the terms in the model.  If
<code>"sequential"</code>, the sequential sum of squares obtained by
including the terms in the order they appear in the model is used;
else, if <code>"marginal"</code>, the marginal sum of squares
obtained by deleting a term from the model at a time is used.  This
argument is only used when a single fitted object is passed to the
function.  Partial matching of arguments is used, so only the first
character needs to be provided.  Defaults to <code>"sequential"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustSigma</code></td>
<td>
<p>an optional logical value.  If <code>TRUE</code> and the
estimation method used to obtain <code>object</code> was maximum
likelihood, the residual standard error is multiplied by
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><msub><mi>n</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mo>−</mo><msub><mi>n</mi><mrow><mi>p</mi><mi>a</mi><mi>r</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{n_{obs}/(n_{obs} - n_{par})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.3231em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9169em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.8769em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3231em;"><span></span></span></span></span></span></span></span></span></code>,
converting it to a REML-like estimate.  This argument is only used
when a single fitted object is passed to the function.  Default is
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Terms</code></td>
<td>
<p>an optional integer or character vector specifying which
terms in the model should be jointly tested to be zero using a Wald
F-test.  If given as a character vector, its elements must correspond
to term names; else, if given as an integer vector, its elements must
correspond to the order in which terms are included in the
model.  This argument is only used when a single fitted object is
passed to the function.  Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>an optional numeric vector or array specifying linear
combinations of the coefficients in the model that should be tested
to be zero.  If given as an array, its rows define the linear
combinations to be tested.  If names are assigned to the vector
elements (array columns), they must correspond to coefficients
names and will be used to map the linear combination(s) to the
coefficients; else, if no names are available, the vector elements
(array columns) are assumed in the same order as the coefficients
appear in the model.  This argument is only used when a single fitted
object is passed to the function.  Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"anova.lme"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value.  If <code>TRUE</code>, the calling
sequences for each fitted model object are printed with the rest of
the output, being omitted if <code>verbose = FALSE</code>.  Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame inheriting from class <code>"anova.lme"</code>.
</p>


<h3>Note</h3>

<p>Likelihood comparisons are not meaningful for objects fit using
restricted maximum likelihood and with different fixed effects.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>, <code><a href="#gnls">gnls</a></code>, <code><a href="#nlme">nlme</a></code>,
<code><a href="#lme">lme</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#AIC">AIC</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#AIC">BIC</a></code>,
<code><a href="#anova.lme">print.anova.lme</a></code>,
<code><a href="#logLik.lme">logLik.lme</a></code>,
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
fm2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> random <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span><span class="token operator">~</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> fm2<span class="token punctuation">)</span>

<span class="token comment">## Pinheiro and Bates, pp. 251-254 ------------------------------------------</span>
fm1Orth.gls <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>distance <span class="token operator">~</span> Sex <span class="token operator">*</span> I<span class="token punctuation">(</span>age <span class="token operator">-</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span>
		   correlation <span class="token operator">=</span> corSymm<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span><span class="token punctuation">,</span>
		   weights <span class="token operator">=</span> varIdent<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> age<span class="token punctuation">)</span><span class="token punctuation">)</span>
fm2Orth.gls <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Orth.gls<span class="token punctuation">,</span>
		      corr <span class="token operator">=</span> corCompSymm<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## anova.gls examples:</span>
anova<span class="token punctuation">(</span>fm1Orth.gls<span class="token punctuation">,</span> fm2Orth.gls<span class="token punctuation">)</span>
fm3Orth.gls <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm2Orth.gls<span class="token punctuation">,</span> weights <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm2Orth.gls<span class="token punctuation">,</span> fm3Orth.gls<span class="token punctuation">)</span>
fm4Orth.gls <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm3Orth.gls<span class="token punctuation">,</span> weights <span class="token operator">=</span> varIdent<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Sex<span class="token punctuation">)</span><span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm3Orth.gls<span class="token punctuation">,</span> fm4Orth.gls<span class="token punctuation">)</span>
<span class="token comment"># not in book but needed for the following command</span>
fm3Orth.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> Sex<span class="token operator">*</span>I<span class="token punctuation">(</span>age<span class="token operator">-</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">,</span>
                   random <span class="token operator">=</span> <span class="token operator">~</span> I<span class="token punctuation">(</span>age<span class="token operator">-</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> Subject<span class="token punctuation">,</span>
                   weights <span class="token operator">=</span> varIdent<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Sex<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Compare an "lme" object with a "gls" object (test would be non-sensical!)</span>
anova<span class="token punctuation">(</span>fm3Orth.lme<span class="token punctuation">,</span> fm4Orth.gls<span class="token punctuation">,</span> test <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment">## Pinheiro and Bates, pp. 222-225 ------------------------------------------</span>
op <span class="token operator">&lt;-</span> options<span class="token punctuation">(</span>contrasts <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"contr.treatment"</span><span class="token punctuation">,</span> <span class="token string">"contr.poly"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fm1BW.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>weight <span class="token operator">~</span> Time <span class="token operator">*</span> Diet<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span>
fm2BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1BW.lme<span class="token punctuation">,</span> weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Test a specific contrast</span>
anova<span class="token punctuation">(</span>fm2BW.lme<span class="token punctuation">,</span> L <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Time:Diet2"</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Time:Diet3"</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Pinheiro and Bates, pp. 352-365 ------------------------------------------</span>
fm1Theo.lis <span class="token operator">&lt;-</span> nlsList<span class="token punctuation">(</span>
     conc <span class="token operator">~</span> SSfol<span class="token punctuation">(</span>Dose<span class="token punctuation">,</span> Time<span class="token punctuation">,</span> lKe<span class="token punctuation">,</span> lKa<span class="token punctuation">,</span> lCl<span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token operator">=</span>Theoph<span class="token punctuation">)</span>
fm1Theo.lis
fm1Theo.nlme <span class="token operator">&lt;-</span> nlme<span class="token punctuation">(</span>fm1Theo.lis<span class="token punctuation">)</span>
fm2Theo.nlme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Theo.nlme<span class="token punctuation">,</span> random<span class="token operator">=</span> pdDiag<span class="token punctuation">(</span>lKe<span class="token operator">+</span>lKa<span class="token operator">+</span>lCl<span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
fm3Theo.nlme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm2Theo.nlme<span class="token punctuation">,</span> random<span class="token operator">=</span> pdDiag<span class="token punctuation">(</span>    lKa<span class="token operator">+</span>lCl<span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>

<span class="token comment"># Comparing the 3 nlme models</span>
anova<span class="token punctuation">(</span>fm1Theo.nlme<span class="token punctuation">,</span> fm3Theo.nlme<span class="token punctuation">,</span> fm2Theo.nlme<span class="token punctuation">)</span>

options<span class="token punctuation">(</span>op<span class="token punctuation">)</span> <span class="token comment"># (set back to previous state)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="as.matrix.corStruct">

<a href="#as.matrix.corStruct" class="help-page-title"><h2>Matrix of a corStruct Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the correlation matrix, or list of
correlation matrices, associated with <code>object</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
as.matrix<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>,
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If the correlation structure includes a grouping factor, the returned
value will be a list with components given by the correlation
matrices for each group. Otherwise, the returned value will be a
matrix representing the correlation structure associated with
<code>object</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  
</p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>, <code><a href="#corMatrix">corMatrix</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cst1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span><span class="token operator">|</span>Subject<span class="token punctuation">)</span>
cst1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cst1<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
as.matrix<span class="token punctuation">(</span>cst1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="as.matrix.pdMat">

<a href="#as.matrix.pdMat" class="help-page-title"><h2>Matrix of a pdMat Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the positive-definite matrix represented
by <code>x</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
as.matrix<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>,
representing a positive-definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a matrix corresponding to the positive-definite matrix represented by
<code>x</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  
</p>


<h3>See Also</h3>

<p><code><a href="#pdMat">pdMat</a></code>, <code><a href="#corMatrix">corMatrix</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">as.matrix<span class="token punctuation">(</span>pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="as.matrix.reStruct">

<a href="#as.matrix.reStruct" class="help-page-title"><h2>Matrices of an reStruct Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the positive-definite matrices
corresponding to the <code>pdMat</code> elements of <code>object</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
as.matrix<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>, representing
a random effects structure and consisting of a list of <code>pdMat</code>
objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components given by the positive-definite matrices
corresponding to the elements of <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>, <code><a href="#reStruct">reStruct</a></code>,
<code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">~</span>age<span class="token operator">+</span>Sex<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span><span class="token punctuation">)</span>
as.matrix<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="asOneFormula">

<a href="#asOneFormula" class="help-page-title"><h2>Combine Formulas of a Set of Objects</h2></a>

<h3>Description</h3>

<p>The names of all variables used in the formulas extracted from the
objects defined in <code>...</code> are converted into a single linear
formula, with the variables names separated by <code>+</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">asOneFormula<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">,</span> omit<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>objects, or lists of objects, from which a formula can be
extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit</code></td>
<td>
<p>an optional character vector with the names of variables to
be omitted from the returned formula. Defaults to c(".", "pi").</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a one-sided linear formula with all variables named in the formulas
extracted from the objects in <code>...</code>, except the ones listed in
<code>omit</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#formula">formula</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#allnames">all.vars</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">asOneFormula<span class="token punctuation">(</span>y <span class="token operator">~</span> x <span class="token operator">+</span> z <span class="token operator">|</span> g<span class="token punctuation">,</span> list<span class="token punctuation">(</span><span class="token operator">~</span> w<span class="token punctuation">,</span> <span class="token operator">~</span> t <span class="token operator">*</span> sin<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Assay">

<a href="#Assay" class="help-page-title"><h2>Bioassay on Cell Culture Plate</h2></a>

<h3>Description</h3>

<p>The <code>Assay</code> data frame has 60 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Block</dt>
<dd>
<p>an ordered factor with levels
<code>2</code> &lt; <code>1</code> identifying the block where the wells
are measured.
</p>
</dd>
<dt>sample</dt>
<dd>
<p>a factor with levels <code>a</code> to <code>f</code> identifying the
sample corresponding to the well.
</p>
</dd>
<dt>dilut</dt>
<dd>
<p>a factor with levels
<code>1</code> to <code>5</code>
indicating the dilution applied to the well
</p>
</dd>
<dt>logDens</dt>
<dd>
<p>a numeric vector of the log-optical density
</p>
</dd>
</dl>
<h3>Details</h3>

<p>These data, courtesy of Rich Wolfe and David Lansky from Searle,
Inc., come from a bioassay run on a 96-well cell culture plate.  The
assay is performed using a split-block design.  The 8 rows on the
plate are labeled A–H from top to bottom and the 12 columns on the
plate are labeled 1–12 from left to right.  Only the central 60 wells
of the plate are used for the bioassay (the intersection of rows B–G
and columns 2–11).  There are two blocks in the design: Block 1
contains columns 2–6 and Block 2 contains columns 7–11. Within each
block, six samples are assigned randomly to rows and five (serial)
dilutions are assigned randomly to columns. The response variable is
the logarithm of the optical density. The cells are treated with a
compound that they metabolize to produce the stain.  Only live cells
can make the stain, so the optical density is a measure of the number
of cells that are alive and healthy.</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York. (Appendix A.2)
</p>

<hr>
</div>
<div class="container manual-page" id="asTable">

<a href="#asTable" class="help-page-title"><h2>Convert groupedData to a matrix</h2></a>

<h3>Description</h3>

<p>Create a tabular representation of the response in a balanced
groupedData object.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">asTable<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A balanced <code>groupedData</code> object</p>
</td>
</tr></table>
<h3>Details</h3>

<p>A balanced groupedData object can be represented as a matrix or table
of response values corresponding to the values of a primary covariate
for each level of a grouping factor.  This function creates such a
matrix representation of the data in <code>object</code>.
</p>


<h3>Value</h3>

<p>A matrix.  The data in the matrix are the values of the response.  The
columns correspond to the distinct values of the primary covariate and
are labelled as such.  The rows correspond to the distinct levels of
the grouping factor and are labelled as such.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  
</p>


<h3>See Also</h3>

<p><code><a href="#groupedData">groupedData</a></code>, <code><a href="#isBalanced">isBalanced</a></code>,
<code><a href="#balancedGrouped">balancedGrouped</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">asTable<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 109</span>
ergoStool.mat <span class="token operator">&lt;-</span> asTable<span class="token punctuation">(</span>ergoStool<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="augPred">

<a href="#augPred" class="help-page-title"><h2>Augmented Predictions</h2></a>

<h3>Description</h3>

<p>Predicted values are obtained at the specified values of
<code>primary</code>.  If <code>object</code> has a grouping structure
(i.e. <code>getGroups(object)</code> is not <code>NULL</code>), predicted values
are obtained for each group.  If <code>level</code> has more than one
element, predictions are obtained for each level of the
<code>max(level)</code> grouping factor.  If other covariates besides
<code>primary</code> are used in the prediction model, their average
(numeric covariates) or most frequent value (categorical covariates)
are used to obtain the predicted values.  The original observations
are also included in the returned object.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">augPred<span class="token punctuation">(</span>object<span class="token punctuation">,</span> primary<span class="token punctuation">,</span> minimum<span class="token punctuation">,</span> maximum<span class="token punctuation">,</span> length.out<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'lme'</span>
augPred<span class="token punctuation">(</span>object<span class="token punctuation">,</span> primary <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
        minimum <span class="token operator">=</span> min<span class="token punctuation">(</span>primary<span class="token punctuation">)</span><span class="token punctuation">,</span> maximum <span class="token operator">=</span> max<span class="token punctuation">(</span>primary<span class="token punctuation">)</span><span class="token punctuation">,</span>
        length.out <span class="token operator">=</span> <span class="token number">51</span><span class="token punctuation">,</span> level <span class="token operator">=</span> Q<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted model object from which predictions can be
extracted, using a <code>predict</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>primary</code></td>
<td>
<p>an optional one-sided formula specifying the primary
covariate to be used to generate the augmented predictions. By
default, if a  covariate can be extracted from the data used to generate
<code>object</code> (using <code>getCovariate</code>), it will be used as
<code>primary</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimum</code></td>
<td>
<p>an optional lower limit for the primary
covariate. Defaults to <code>min(primary)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maximum</code></td>
<td>
<p>an optional upper limit for the primary
covariate. Defaults to <code>max(primary)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer with the number of primary
covariate values at which to evaluate the predictions.  Defaults to
51.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector specifying the desired
prediction levels.  Levels increase from outermost to innermost
grouping, with level 0 representing the population (fixed effects)
predictions.  Defaults to the innermost level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for the generic may require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with four columns representing, respectively, the values
of the primary covariate, the groups (if <code>object</code> does not have a
grouping structure, all elements will be <code>1</code>), the predicted or
observed values, and the type of value in the third column:
<code>original</code> for the observed values and <code>predicted</code> (single
or no grouping factor) or <code>predict.groupVar</code> (multiple levels of
grouping), with <code>groupVar</code> replaced by the actual grouping
variable name (<code>fixed</code> is used for population predictions). The
returned object inherits from class <code>"augPred"</code>.
</p>


<h3>Note</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include: <code>gls</code>, <code>lme</code>, and <code>lmList</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.augPred">plot.augPred</a></code>, <code><a href="#getGroups">getGroups</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#predict">predict</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span>
augPred<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> level <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="balancedGrouped">

<a href="#balancedGrouped" class="help-page-title"><h2>Create a groupedData object from a matrix</h2></a>

<h3>Description</h3>

<p>Create a <code>groupedData</code> object from a data matrix.  This function
can be used only with balanced data.  The opposite conversion, from a
<code>groupedData</code> object to a <code>matrix</code>, is done with <code>asTable</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">balancedGrouped<span class="token punctuation">(</span>form<span class="token punctuation">,</span> data<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> units<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>A formula of the form <code>y ~ x | g</code> giving the name of
the response, the primary covariate, and the grouping factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix or data frame containing the values of the
response grouped according to the levels of the grouping factor
(rows) and the distinct levels of the primary covariate (columns).
The <code>dimnames</code> of the matrix are used to construct the levels of
the grouping factor and the primary covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>an optional list of character strings giving labels for
the response and the primary covariate.  The label for the primary
covariate is named <code>x</code> and that for the response is named
<code>y</code>.  Either label can be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>an optional list of character strings giving the units for
the response and the primary covariate.  The units string for the
primary covariate is named <code>x</code> and that for the response is
named <code>y</code>.  Either units string can be omitted.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A balanced <code>groupedData</code> object.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York. 
</p>


<h3>See Also</h3>

<p><code><a href="#groupedData">groupedData</a></code>, <code><a href="#isBalanced">isBalanced</a></code>, <code><a href="#asTable">asTable</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">OrthoMat <span class="token operator">&lt;-</span> asTable<span class="token punctuation">(</span> Orthodont <span class="token punctuation">)</span>
Orth2 <span class="token operator">&lt;-</span> balancedGrouped<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> data <span class="token operator">=</span> OrthoMat<span class="token punctuation">,</span>
    labels <span class="token operator">=</span> list<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">"Age"</span><span class="token punctuation">,</span>
                  y <span class="token operator">=</span> <span class="token string">"Distance from pituitary to pterygomaxillary fissure"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    units <span class="token operator">=</span> list<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">"(yr)"</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">"(mm)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
Orth2<span class="token punctuation">[</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>        <span class="token comment">## check the first few entries</span>

<span class="token comment"># Pinheiro and Bates, p. 109</span>
ergoStool.mat <span class="token operator">&lt;-</span> asTable<span class="token punctuation">(</span>ergoStool<span class="token punctuation">)</span>
balancedGrouped<span class="token punctuation">(</span>effort<span class="token operator">~</span>Type<span class="token operator">|</span>Subject<span class="token punctuation">,</span>
                data<span class="token operator">=</span>ergoStool.mat<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="bdf">

<a href="#bdf" class="help-page-title"><h2>Language scores</h2></a>

<h3>Description</h3>

<p>The <code>bdf</code> data frame has 2287 rows and 25 columns of language
scores from grade 8 pupils in elementary schools in The Netherlands.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>bdf<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>


<dl>
<dt>schoolNR</dt>
<dd>
<p>a factor denoting the school.</p>
</dd>
<dt>pupilNR</dt>
<dd>
<p>a factor denoting the pupil.</p>
</dd>
<dt>IQ.verb</dt>
<dd>
<p>a numeric vector of verbal IQ scores</p>
</dd>
<dt>IQ.perf</dt>
<dd>
<p>a numeric vector of IQ scores.</p>
</dd>
<dt>sex</dt>
<dd>
<p>Sex of the student.</p>
</dd>
<dt>Minority</dt>
<dd>
<p>a factor indicating if the student is a member of a
minority group.</p>
</dd>
<dt>repeatgr</dt>
<dd>
<p>an ordered factor indicating if one or more grades
have been repeated.</p>
</dd>
<dt>aritPRET</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>classNR</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>aritPOST</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>langPRET</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>langPOST</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>ses</dt>
<dd>
<p>a numeric vector of socioeconomic status indicators.</p>
</dd>
<dt>denomina</dt>
<dd>
<p>a factor indicating of the school is a public
school, a Protestant private school, a Catholic private school, or
a non-denominational private school.</p>
</dd>
<dt>schoolSES</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>satiprin</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>natitest</dt>
<dd>
<p>a factor with levels <code>0</code> and <code>1</code></p>
</dd>
<dt>meetings</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>currmeet</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>mixedgra</dt>
<dd>
<p>a factor indicating if the class is a mixed-grade class.</p>
</dd>
<dt>percmino</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>aritdiff</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>homework</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>classsiz</dt>
<dd>
<p>a numeric vector</p>
</dd>
<dt>groupsiz</dt>
<dd>
<p>a numeric vector</p>
</dd>
</dl>
<h3>Source</h3>

<p>‘<span class="samp">⁠http://stat.gamma.rug.nl/snijders/multilevel.htm⁠</span>’, the first
edition of <a href="http://www.stats.ox.ac.uk/~snijders/mlbook.htm" target="_blank">http://www.stats.ox.ac.uk/~snijders/mlbook.htm</a>.
</p>


<h3>References</h3>

<p>Snijders, Tom and Bosker, Roel (1999), <em>Multilevel Analysis: An
Introduction to Basic and Advanced Multilevel Modeling</em>, Sage.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">summary<span class="token punctuation">(</span>bdf<span class="token punctuation">)</span>

<span class="token comment">## More examples, including lme() fits  reproducing parts in the above</span>
<span class="token comment">## book, are available in the R script files</span>
system.file<span class="token punctuation">(</span><span class="token string">"mlbook"</span><span class="token punctuation">,</span> <span class="token string">"ch04.R"</span><span class="token punctuation">,</span> package <span class="token operator">=</span><span class="token string">"nlme"</span><span class="token punctuation">)</span> <span class="token comment"># and</span>
system.file<span class="token punctuation">(</span><span class="token string">"mlbook"</span><span class="token punctuation">,</span> <span class="token string">"ch05.R"</span><span class="token punctuation">,</span> package <span class="token operator">=</span><span class="token string">"nlme"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="BodyWeight">

<a href="#BodyWeight" class="help-page-title"><h2>Rat weight over time for different diets</h2></a>

<h3>Description</h3>

<p>The <code>BodyWeight</code> data frame has 176 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>weight</dt>
<dd>
<p>a numeric vector giving the body weight of the rat (grams).
</p>
</dd>
<dt>Time</dt>
<dd>
<p>a numeric vector giving the time at which the measurement is
made (days).
</p>
</dd>
<dt>Rat</dt>
<dd>
<p>an ordered factor with levels <code>2</code> &lt; <code>3</code> &lt; <code>4</code>
&lt; <code>1</code> &lt; <code>8</code> &lt; <code>5</code> &lt; <code>6</code> &lt; <code>7</code> &lt;
<code>11</code> &lt; <code>9</code> &lt; <code>10</code> &lt; <code>12</code> &lt; <code>13</code> &lt;
<code>15</code> &lt; <code>14</code> &lt; <code>16</code> identifying the rat whose
weight is measured.
</p>
</dd>
<dt>Diet</dt>
<dd>
<p>a factor with levels
<code>1</code> to <code>3</code> indicating the diet that the rat receives.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Hand and Crowder (1996) describe data on the body weights of rats
measured over 64 days.  These data also appear in Table 2.4 of
Crowder and Hand (1990).  The body weights of the rats (in grams)
are measured on day 1 and every seven days thereafter until day 64,
with an extra measurement on day 44. The experiment started several
weeks before “day 1.”  There are three groups of rats, each on a
different diet.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York. (Appendix A.3)
</p>
<p>Crowder, M. and Hand, D. (1990), <em>Analysis of Repeated
Measures</em>, Chapman and Hall, London.
</p>
<p>Hand, D. and Crowder, M. (1996), <em>Practical Longitudinal Data
Analysis</em>, Chapman and Hall, London.
</p>

<hr>
</div>
<div class="container manual-page" id="Cefamandole">

<a href="#Cefamandole" class="help-page-title"><h2>Pharmacokinetics of Cefamandole</h2></a>

<h3>Description</h3>

<p>The <code>Cefamandole</code> data frame has 84 rows and 3 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Subject</dt>
<dd>
<p>a factor giving the subject from which the sample was drawn.
</p>
</dd>
<dt>Time</dt>
<dd>
<p>a numeric vector giving the time at which the sample was drawn
(minutes post-injection).
</p>
</dd>
<dt>conc</dt>
<dd>
<p>a numeric vector giving the observed plasma concentration of
cefamandole (mcg/ml).
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Davidian and Giltinan (1995, 1.1, p. 2) describe data
obtained during a pilot study to investigate the pharmacokinetics of
the drug cefamandole. Plasma concentrations of the drug were measured
on six healthy volunteers at 14 time points following an intraveneous
dose of 15 mg/kg body weight of cefamandole.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.4)
</p>
<p>Davidian, M. and Giltinan, D. M. (1995), <em>Nonlinear Models for
Repeated Measurement Data</em>,  Chapman and Hall, London.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span>Cefamandole<span class="token punctuation">)</span>
fm1 <span class="token operator">&lt;-</span> nlsList<span class="token punctuation">(</span>SSbiexp<span class="token punctuation">,</span> data <span class="token operator">=</span> Cefamandole<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Coef">

<a href="#Coef" class="help-page-title"><h2>Assign Values to Coefficients</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include all <code>"<a href="#pdMat">pdMat</a>"</code>,
<code>"<a href="#corClasses">corStruct</a>"</code> and <code>"<a href="#varFunc">varFunc</a>"</code> classes,
<code>"<a href="#reStruct">reStruct</a>"</code>, and <code>"modelStruct"</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span>  value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object representing a fitted model, or, by default,
any object with a <code>coef</code> component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function may require
additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a value to be assigned to the coefficients associated with
<code>object</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#coef">coef</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="coef.corStruct">

<a href="#coef.corStruct" class="help-page-title"><h2>Coefficients of a corStruct Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the coefficients associated with the
correlation structure represented by <code>object</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> unconstrained<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 replacement method for class 'corStruct'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>,
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconstrained</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the coefficients
are returned in unconstrained form (the same used in the optimization
algorithm). If <code>FALSE</code> the coefficients are returned in
"natural", possibly constrained, form. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a vector with the replacement values for the coefficients
associated with <code>object</code>. It must be a vector with the same length
of <code>coef{object}</code> and must be given in unconstrained form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the coefficients corresponding to <code>object</code>.
</p>


<h3>SIDE EFFECTS</h3>

<p>On the left side of an assignment, sets the values of the coefficients
of <code>object</code> to <code>value</code>. <code>Object</code> must be initialized (using
<code>Initialize</code>) before new values can be assigned to its
coefficients. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates </p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  
</p>


<h3>See Also</h3>

<p><code><a href="#corAR1">corAR1</a></code>, <code><a href="#corARMA">corARMA</a></code>,
<code><a href="#corCAR1">corCAR1</a></code>, <code><a href="#corCompSymm">corCompSymm</a></code>,
<code><a href="#corExp">corExp</a></code>, <code><a href="#corGaus">corGaus</a></code>, <code><a href="#corLin">corLin</a></code>,
<code><a href="#corRatio">corRatio</a></code>, <code><a href="#corSpatial">corSpatial</a></code>, <code><a href="#corSpher">corSpher</a></code>,
<code><a href="#corSymm">corSymm</a></code>,<code><a href="#Initialize">Initialize</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cst1 <span class="token operator">&lt;-</span> corARMA<span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>cst1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="coef.gnls">

<a href="#coef.gnls" class="help-page-title"><h2>Extract gnls Coefficients</h2></a>

<h3>Description</h3>

<p>The estimated coefficients for the nonlinear model represented by
<code>object</code> are extracted. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gnls'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gnls">gnls</a>"</code>, representing
a generalized nonlinear least squares fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the estimated coefficients for the nonlinear model
represented by <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gnls">gnls</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>weight <span class="token operator">~</span> SSlogis<span class="token punctuation">(</span>Time<span class="token punctuation">,</span> Asym<span class="token punctuation">,</span> xmid<span class="token punctuation">,</span> scal<span class="token punctuation">)</span><span class="token punctuation">,</span> Soybean<span class="token punctuation">,</span>
            weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="coef.lme">

<a href="#coef.lme" class="help-page-title"><h2>Extract lme Coefficients</h2></a>

<h3>Description</h3>

<p>The estimated coefficients at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by adding
together the fixed effects estimates and the corresponding random
effects estimates at grouping levels less or equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>. The
resulting estimates are returned as a data frame, with rows
corresponding to groups and columns to coefficients. Optionally, the
returned data frame may be augmented with covariates summarized over
groups.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> augFrame<span class="token punctuation">,</span> level<span class="token punctuation">,</span> data<span class="token punctuation">,</span> which<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span> 
       omitGroupingFactor<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>augFrame</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, the returned
data frame is augmented with variables defined in <code>data</code>; else,
if <code>FALSE</code>, only the coefficients are returned. Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional positive integer giving the level of grouping
to be used in extracting the coefficients from an object with
multiple nested grouping levels. Defaults to the highest or innermost
level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame with the variables to be used for
augmenting the returned data frame when <code>augFrame =
     TRUE</code>. Defaults to the data frame used to fit <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an optional positive integer or character vector
specifying which columns of <code>data</code> should be used in the
augmentation of the returned data frame. Defaults to all columns in
<code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>an optional summary function or a list of summary functions
to be applied to group-varying variables, when collapsing <code>data</code>
by groups.  Group-invariant variables are always summarized by the
unique value that they assume within that group. If <code>FUN</code> is a
single function it will be applied to each non-invariant variable by
group to produce the summary for that variable.  If <code>FUN</code> is a
list of functions, the names in the list should designate classes of
variables in the frame such as <code>ordered</code>, <code>factor</code>, or
<code>numeric</code>.  The indicated function will be applied to any
group-varying variables of that class.  The default functions to be
used are <code>mean</code> for numeric factors, and <code>Mode</code> for both
<code>factor</code> and <code>ordered</code>.  The <code>Mode</code> function, defined
internally in <code>gsummary</code>, returns the modal or most popular
value of the variable.  It is different from the <code>mode</code> function
that returns the S-language mode of the variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omitGroupingFactor</code></td>
<td>
<p>an optional logical value.  When <code>TRUE</code>
the grouping factor itself will be omitted from the group-wise
summary of <code>data</code> but the levels of the grouping factor will
continue to be used as the row names for the returned data frame.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression specifying a subset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame inheriting from class <code>"coef.lme"</code> with the estimated
coefficients at level <code>level</code> and, optionally, other covariates
summarized over groups. The returned object also inherits from classes
<code>"ranef.lme"</code> and <code>"data.frame"</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York, esp. pp. 455-457.   
</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, 
<code><a href="#ranef.lme">ranef.lme</a></code>,
<code><a href="#plot.ranef.lme">plot.ranef.lme</a></code>, <code><a href="#gsummary">gsummary</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> augFrame <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="coef.lmList">

<a href="#coef.lmList" class="help-page-title"><h2>Extract lmList Coefficients</h2></a>

<h3>Description</h3>

<p>The coefficients of each <code>lm</code> object in the <code>object</code> list are
extracted and organized into a data frame, with rows corresponding to
the <code>lm</code> components and columns corresponding to the
coefficients.  Optionally, the returned data frame may be augmented
with covariates summarized over the groups associated with the
<code>lm</code> components.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> augFrame<span class="token punctuation">,</span> data<span class="token punctuation">,</span> which<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span>
   omitGroupingFactor<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>augFrame</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, the returned
data frame is augmented with variables defined in the data frame used
to produce <code>object</code>; else, if <code>FALSE</code>, only the coefficients
are returned. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame with the variables to be used for
augmenting the returned data frame when <code>augFrame =
     TRUE</code>. Defaults to the data frame used to fit <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an optional positive integer or character vector
specifying which columns of the data frame used to produce <code>object</code>
should be used in the augmentation of the returned data
frame. Defaults to all variables in the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>an optional summary function or a list of summary functions
to be applied to group-varying variables, when collapsing the data
by groups.  Group-invariant variables are always summarized by the
unique value that they assume within that group. If <code>FUN</code> is a
single function it will be applied to each non-invariant variable by
group to produce the summary for that variable.  If <code>FUN</code> is a
list of functions, the names in the list should designate classes of
variables in the frame such as <code>ordered</code>, <code>factor</code>, or
<code>numeric</code>.  The indicated function will be applied to any
group-varying variables of that class.  The default functions to be
used are <code>mean</code> for numeric factors, and <code>Mode</code> for both
<code>factor</code> and <code>ordered</code>.  The <code>Mode</code> function, defined
internally in <code>gsummary</code>, returns the modal or most popular
value of the variable.  It is different from the <code>mode</code> function
that returns the S-language mode of the variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omitGroupingFactor</code></td>
<td>
<p>an optional logical value.  When <code>TRUE</code>
the grouping factor itself will be omitted from the group-wise
summary of <code>data</code> but the levels of the grouping factor will
continue to be used as the row names for the returned data frame.
Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame inheriting from class <code>"coef.lmList"</code> with the estimated
coefficients for each <code>"lm"</code> component of <code>object</code> and,
optionally, other covariates summarized over the groups corresponding
to the <code>"lm"</code> components. The returned object also inherits from
classes <code>"ranef.lmList"</code> and <code>"data.frame"</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York, esp. pp. 457-458.   
</p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>, <code><a href="#fixef.lmList">fixed.effects.lmList</a></code>,
<code><a href="#ranef.lmList">ranef.lmList</a></code>,
<code><a href="#plot.ranef.lmList">plot.ranef.lmList</a></code>, <code><a href="#gsummary">gsummary</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token operator">|</span>Subject<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> augFrame <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="coef.modelStruct">

<a href="#coef.modelStruct" class="help-page-title"><h2>Extract modelStruct Object Coefficients</h2></a>

<h3>Description</h3>

<p>This method function extracts the coefficients associated with each
component of the <code>modelStruct</code> list.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'modelStruct'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> unconstrained<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 replacement method for class 'modelStruct'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"modelStruct"</code>,
representing a list of model components, such as <code>"<a href="#corClasses">corStruct</a>"</code> and
<code>"<a href="#varFunc">varFunc</a>"</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconstrained</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the coefficients
are returned in unconstrained form (the same used in the optimization
algorithm). If <code>FALSE</code> the coefficients are returned in
"natural", possibly constrained, form. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a vector with the replacement values for the coefficients
associated with <code>object</code>. It must be a vector with the same length
of <code>coef{object}</code> and must be given in unconstrained form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with all coefficients corresponding to the components of
<code>object</code>.
</p>


<h3>SIDE EFFECTS</h3>

<p>On the left side of an assignment, sets the values of the coefficients
of <code>object</code> to <code>value</code>. <code>Object</code> must be initialized (using
<code>Initialize</code>) before new values can be assigned to its
coefficients. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Initialize">Initialize</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">lms1 <span class="token operator">&lt;-</span> lmeStruct<span class="token punctuation">(</span>reStruct <span class="token operator">=</span> reStruct<span class="token punctuation">(</span>pdDiag<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">~</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   corStruct <span class="token operator">=</span> corAR1<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>lms1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="coef.pdMat">

<a href="#coef.pdMat" class="help-page-title"><h2>pdMat Object Coefficients</h2></a>

<h3>Description</h3>

<p>This method function extracts the coefficients associated with the
positive-definite matrix represented by <code>object</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> unconstrained<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 replacement method for class 'pdMat'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>,
representing a positive-definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconstrained</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the coefficients
are returned in unconstrained form (the same used in the optimization
algorithm). If <code>FALSE</code> the upper triangular elements of the
positive-definite matrix represented by <code>object</code> are
returned. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a vector with the replacement values for the coefficients
associated with <code>object</code>. It must be a vector with the same length
of <code>coef{object}</code> and must be given in unconstrained form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the coefficients corresponding to <code>object</code>.
</p>


<h3>SIDE EFFECTS</h3>

<p>On the left side of an assignment, sets the values of the coefficients
of <code>object</code> to <code>value</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates </p>


<h3>References</h3>

<p>Pinheiro, J.C. and Bates., D.M.  (1996) "Unconstrained Parametrizations
for Variance-Covariance Matrices", Statistics and Computing, 6, 289-296.
</p>


<h3>See Also</h3>

<p><code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">coef<span class="token punctuation">(</span>pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="coef.reStruct">

<a href="#coef.reStruct" class="help-page-title"><h2>reStruct Object Coefficients</h2></a>

<h3>Description</h3>

<p>This method function extracts the coefficients associated with the
positive-definite matrix represented by <code>object</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> unconstrained<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 replacement method for class 'reStruct'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconstrained</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the coefficients
are returned in unconstrained form (the same used in the optimization
algorithm). If <code>FALSE</code> the coefficients are returned in
"natural", possibly constrained, form. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a vector with the replacement values for the coefficients
associated with <code>object</code>. It must be a vector with the same length
of <code>coef(object)</code> and must be given in unconstrained form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the coefficients corresponding to <code>object</code>.
</p>


<h3>SIDE EFFECTS</h3>

<p>On the left side of an assignment, sets the values of the coefficients
of <code>object</code> to <code>value</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#coef.pdMat">coef.pdMat</a></code>, <code><a href="#reStruct">reStruct</a></code>,
<code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>list<span class="token punctuation">(</span>A <span class="token operator">=</span> pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>Score<span class="token punctuation">)</span><span class="token punctuation">,</span>
  B <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> diag<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>Educ<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="coef.varFunc">

<a href="#coef.varFunc" class="help-page-title"><h2>varFunc Object Coefficients</h2></a>

<h3>Description</h3>

<p>This method function extracts the coefficients associated with the
variance function structure represented by <code>object</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'varFunc'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> unconstrained<span class="token punctuation">,</span> allCoef<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 replacement method for class 'varIdent'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#varFunc">varFunc</a>"</code>
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconstrained</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the coefficients
are returned in unconstrained form (the same used in the optimization
algorithm). If <code>FALSE</code> the coefficients are returned in
"natural", generally constrained form. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allCoef</code></td>
<td>
<p>a logical value. If <code>FALSE</code> only the coefficients
which may vary during the optimization are returned. If <code>TRUE</code>
all coefficients are returned. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a vector with the replacement values for the coefficients
associated with <code>object</code>. It must be have the same length of
<code>coef{object}</code> and must be given in unconstrained
form. <code>Object</code> must be initialized before new values can be
assigned to its coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the coefficients corresponding to <code>object</code>.
</p>


<h3>SIDE EFFECTS</h3>

<p>On the left side of an assignment, sets the values of the coefficients
of <code>object</code> to <code>value</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates </p>


<h3>See Also</h3>

<p><code><a href="#varFunc">varFunc</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span>

coef<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> <span class="token number">2</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="collapse">

<a href="#collapse" class="help-page-title"><h2>Collapse According to Groups</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Currently, only a <code>groupedData</code>
method is available. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">collapse<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object to be collapsed, usually a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for the generic may require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#collapse.groupedData">collapse.groupedData</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="collapse.groupedData">

<a href="#collapse.groupedData" class="help-page-title"><h2>Collapse a groupedData Object</h2></a>

<h3>Description</h3>

<p>If <code>object</code> has a single grouping factor, it is returned
unchanged. Else, it is summarized by the values of the
<code>displayLevel</code> grouping factor (or the combination of its values
and the values of the covariate indicated in <code>preserve</code>, if any is
present). The collapsed data is used to produce a new
<code>groupedData</code> object, with grouping factor given by the
<code>displayLevel</code> factor. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'groupedData'</span>
collapse<span class="token punctuation">(</span>object<span class="token punctuation">,</span> collapseLevel<span class="token punctuation">,</span> displayLevel<span class="token punctuation">,</span>
       outer<span class="token punctuation">,</span> inner<span class="token punctuation">,</span> preserve<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>groupedData</code>,
generally with multiple grouping factors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapseLevel</code></td>
<td>
<p>an optional positive integer or character string
indicating the grouping level to use when collapsing the data. Level
values increase from outermost to innermost grouping. Default is the
highest or innermost level of grouping.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displayLevel</code></td>
<td>
<p>an optional positive integer or character string
indicating the grouping level to use as the grouping factor for the
collapsed data. Default is <code>collapseLevel</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer</code></td>
<td>
<p>an optional logical value or one-sided formula,
indicating covariates that are outer to the <code>displayLevel</code>
grouping factor. If equal to <code>TRUE</code>, the <code>displayLevel</code>
element <code>attr(object, "outer")</code> is used to indicate the 
outer covariates. An outer covariate is invariant within the sets
of rows defined by the grouping factor.  Ordering of the groups is
done in such a way as to preserve adjacency of groups with the same
value of the outer variables. Defaults to <code>NULL</code>, meaning that
no outer covariates are to be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner</code></td>
<td>
<p>an optional logical value or one-sided formula, indicating
a covariate that is inner to the <code>displayLevel</code> grouping
factor. If equal to <code>TRUE</code>, <code>attr(object, "outer")</code> is used
to indicate the inner covariate. An inner covariate can change within
the sets of rows defined by the grouping  factor. Defaults to
<code>NULL</code>, meaning that no inner covariate is present.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preserve</code></td>
<td>
<p>an optional one-sided formula indicating a covariate
whose levels should be preserved when collapsing the data according
to the <code>collapseLevel</code> grouping factor. The collapsing factor is
obtained by pasting together the levels of the <code>collapseLevel</code>
grouping factor and the values of the covariate to be
preserved. Default is <code>NULL</code>, meaning that no covariates need to
be preserved.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>an optional summary function or a list of summary functions
to be used for collapsing the data.  The function or functions are
applied only to variables in <code>object</code> that vary within the
groups defined by <code>collapseLevel</code>.  Invariant variables are 
always summarized by group using the unique value that they assume
within that group.  If <code>FUN</code> is a single
function it will be applied to each non-invariant variable by group
to produce the summary for that variable.  If <code>FUN</code> is a list of
functions, the names in the list should designate classes of
variables in the data such as <code>ordered</code>, <code>factor</code>, or
<code>numeric</code>.  The indicated function will be applied to any
non-invariant variables of that class.  The default functions to be
used are <code>mean</code> for numeric factors, and <code>Mode</code> for both
<code>factor</code> and <code>ordered</code>.  The <code>Mode</code> function, defined
internally in <code>gsummary</code>, returns the modal or most popular
value of the variable.  It is different from the <code>mode</code> function
that returns the S-language mode of the variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional named list. Names can be either positive
integers representing grouping levels, or names of grouping
factors. Each element in the list is a vector indicating the levels
of the corresponding grouping factor to be preserved in the collapsed
data. Default is <code>NULL</code>, meaning that all levels are
used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>groupedData</code> object with a single grouping factor given by the
<code>displayLevel</code> grouping factor, resulting from collapsing
<code>object</code> over the levels of the <code>collapseLevel</code> grouping
factor. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#groupedData">groupedData</a></code>, <code><a href="#plot.nmGroupedData">plot.nmGroupedData</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># collapsing by Dog</span>
collapse<span class="token punctuation">(</span>Pixel<span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># same as collapse(Pixel, collapse = "Dog")</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="compareFits">

<a href="#compareFits" class="help-page-title"><h2>Compare Fitted Objects</h2></a>

<h3>Description</h3>

<p>The columns in <code>object1</code> and <code>object2</code> are put together in
matrices which allow direct comparison of the individual elements for
each object. Missing columns in either object are replaced by
<code>NA</code>s.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">compareFits<span class="token punctuation">(</span>object1<span class="token punctuation">,</span> object2<span class="token punctuation">,</span> which<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object1,object2</code></td>
<td>
<p>data frames, or matrices, with the same
row names, but possibly different column names. These will usually
correspond to coefficients from fitted objects with a grouping
structure (e.g. <code>lme</code> and <code>lmList</code> objects).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an optional integer or character vector indicating which
columns in <code>object1</code> and <code>object2</code> are to be used in the
returned object. Defaults to all columns.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a three-dimensional array, with the third dimension given by the number
of unique column names in either <code>object1</code> or <code>object2</code>. To
each column name there corresponds a matrix with as many rows as the
rows in <code>object1</code> and two columns, corresponding to <code>object1</code>
and <code>object2</code>. The returned object inherits from class
<code>compareFits</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#plot.compareFits">plot.compareFits</a></code>,
<code><a href="#pairs.compareFits">pairs.compareFits</a></code>,
<code><a href="#comparePred">comparePred</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#coef">coef</a></code>,
<code><a href="#random.effects">random.effects</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>
fm2 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>cF12 <span class="token operator">&lt;-</span> compareFits<span class="token punctuation">(</span>coef<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span><span class="token punctuation">,</span> coef<span class="token punctuation">(</span>fm2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="comparePred">

<a href="#comparePred" class="help-page-title"><h2>Compare Predictions</h2></a>

<h3>Description</h3>

<p>Predicted values are obtained at the specified values of
<code>primary</code> for each object. If either <code>object1</code> or
<code>object2</code> have a grouping structure
(i.e. <code>getGroups(object)</code> is not <code>NULL</code>), predicted values
are obtained for each group. When both objects determine groups, the
group levels must be the same. If other covariates besides
<code>primary</code> are used in the prediction model, their group-wise averages
(numeric covariates) or most frequent values (categorical covariates)
are used to obtain the predicted values. The original observations are
also included in the returned object. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">comparePred<span class="token punctuation">(</span>object1<span class="token punctuation">,</span> object2<span class="token punctuation">,</span> primary<span class="token punctuation">,</span> minimum<span class="token punctuation">,</span> maximum<span class="token punctuation">,</span>
    length.out<span class="token punctuation">,</span> level<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object1,object2</code></td>
<td>
<p>fitted model objects, from which predictions can
be extracted using the <code>predict</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>primary</code></td>
<td>
<p>an optional one-sided formula specifying the primary
covariate to be used to generate the augmented predictions. By
default, if a  covariate can be extracted from the data used to generate
the objects (using <code>getCovariate</code>), it will be used as
<code>primary</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimum</code></td>
<td>
<p>an optional lower limit for the primary
covariate. Defaults to <code>min(primary)</code>, after <code>primary</code> is 
evaluated in the <code>data</code> used in fitting <code>object1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maximum</code></td>
<td>
<p>an optional upper limit for the primary
covariate. Defaults to <code>max(primary)</code>, after <code>primary</code> is
evaluated in the <code>data</code> used in fitting <code>object1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer with the number of primary
covariate values at which to evaluate the predictions. Defaults to
51.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer specifying the desired
prediction level. Levels increase from outermost to innermost
grouping, with level 0 representing the population (fixed effects)
predictions. Only one level can be specified. Defaults to the
innermost level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for the generic may require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with four columns representing, respectively, the values
of the primary covariate, the groups (if <code>object</code> does not have a
grouping structure, all elements will be <code>1</code>), the predicted or
observed values, and the type of value in the third column: the
objects' names are used to classify the predicted values and
<code>original</code> is used for the observed values. The returned object
inherits from classes <code>comparePred</code> and <code>augPred</code>.
</p>


<h3>Note</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include: <code>gls</code>, <code>lme</code>, and <code>lmList</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#augPred">augPred</a></code>, <code><a href="#getGroups">getGroups</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">*</span> Sex<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age<span class="token punctuation">)</span>
fm2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> distance <span class="token operator">~</span> age<span class="token punctuation">)</span>
comparePred<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> fm2<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corAR1">

<a href="#corAR1" class="help-page-title"><h2>AR(1) Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corAR1</code> class,
representing an autocorrelation structure of order 1. Objects
created using this constructor must later be initialized using the
appropriate <code>Initialize</code> method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corAR1<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>the value of the lag 1 autocorrelation, which must be
between -1 and 1. Defaults to 0 (no autocorrelation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ t</code>, or <code>~ t |
     g</code>, specifying a time covariate <code>t</code> and,  optionally, a
grouping factor <code>g</code>. A covariate for this correlation structure
must be integer valued. When a grouping factor is present in
<code>form</code>, the correlation structure is assumed to apply only
to observations within the same grouping level; observations with
different grouping levels are assumed to be uncorrelated. Defaults to
<code>~ 1</code>, which corresponds to using the order of the observations
in the data as a covariate, and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corAR1</code>, representing an autocorrelation
structure of order 1. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 235, 397.  
</p>


<h3>See Also</h3>

<p><code><a href="#ACF.lme">ACF.lme</a></code>,
<code><a href="#corARMA">corARMA</a></code>, 
<code><a href="#corClasses">corClasses</a></code>,
<code><a href="#Dim.corSpatial">Dim.corSpatial</a></code>, 
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>, 
<code><a href="#summary.corStruct">summary.corStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## covariate is observation order and grouping factor is Mare</span>
cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 236</span>
cs1AR1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs1AR1. <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1AR1<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1AR1.<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 240</span>
fm1Ovar.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span>
                   data <span class="token operator">=</span> Ovary<span class="token punctuation">,</span> random <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span><span class="token operator">~</span>sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fm2Ovar.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Ovar.lme<span class="token punctuation">,</span> correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, pp. 255-258:  use in gls</span>
fm1Dial.gls <span class="token operator">&lt;-</span>
  gls<span class="token punctuation">(</span>rate <span class="token operator">~</span><span class="token punctuation">(</span>pressure <span class="token operator">+</span> I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> I<span class="token punctuation">(</span>pressure<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>QB<span class="token punctuation">,</span>
      Dialyzer<span class="token punctuation">)</span>
fm2Dial.gls <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Dial.gls<span class="token punctuation">,</span>
                 weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> pressure<span class="token punctuation">)</span><span class="token punctuation">)</span>
fm3Dial.gls <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm2Dial.gls<span class="token punctuation">,</span>
                    corr <span class="token operator">=</span> corAR1<span class="token punctuation">(</span><span class="token number">0.771</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates use in nlme:  </span>
<span class="token comment"># from p. 240 needed on p. 396</span>
fm1Ovar.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span>
                   data <span class="token operator">=</span> Ovary<span class="token punctuation">,</span> random <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span><span class="token operator">~</span>sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fm5Ovar.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Ovar.lme<span class="token punctuation">,</span>
                corr <span class="token operator">=</span> corARMA<span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 396</span>
fm1Ovar.nlme <span class="token operator">&lt;-</span> nlme<span class="token punctuation">(</span>follicles<span class="token operator">~</span>
     A<span class="token operator">+</span>B<span class="token operator">*</span>sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>w<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token operator">+</span>C<span class="token operator">*</span>cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>w<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span>
   data<span class="token operator">=</span>Ovary<span class="token punctuation">,</span> fixed<span class="token operator">=</span>A<span class="token operator">+</span>B<span class="token operator">+</span>C<span class="token operator">+</span>w<span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">,</span>
   random<span class="token operator">=</span>pdDiag<span class="token punctuation">(</span>A<span class="token operator">+</span>B<span class="token operator">+</span>w<span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   start<span class="token operator">=</span>c<span class="token punctuation">(</span>fixef<span class="token punctuation">(</span>fm5Ovar.lme<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment"># p. 397</span>
fm2Ovar.nlme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Ovar.nlme<span class="token punctuation">,</span>
         corr<span class="token operator">=</span>corAR1<span class="token punctuation">(</span><span class="token number">0.311</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corARMA">

<a href="#corARMA" class="help-page-title"><h2>ARMA(p,q) Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corARMA</code> class,
representing an autocorrelation-moving average correlation structure
of order (p, q). Objects created using this constructor must later
be initialized using the appropriate <code>Initialize</code> method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corARMA<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a vector with the values of the autoregressive and moving
average parameters, which must have length <code>p + q</code> and all
elements between -1 and 1. Defaults to a vector of zeros,
corresponding to uncorrelated observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ t</code>, or <code>~ t |
     g</code>, specifying a time covariate <code>t</code> and,  optionally, a
grouping factor <code>g</code>. A covariate for this correlation structure
must be integer valued. When a grouping factor is present in
<code>form</code>, the correlation structure is assumed to apply only
to observations within the same grouping level; observations with
different grouping levels are assumed to be uncorrelated. Defaults to
<code>~ 1</code>, which corresponds to using the order of the observations
in the data as a covariate, and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p, q</code></td>
<td>
<p>non-negative integers specifying respectively the
autoregressive order and the moving average order of the <code>ARMA</code>
structure. Both default to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corARMA</code>, representing an
autocorrelation-moving average correlation structure. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 236, 397.  
</p>


<h3>See Also</h3>

<p><code><a href="#corAR1">corAR1</a></code>,
<code><a href="#corClasses">corClasses</a></code>
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## ARMA(1,2) structure, with observation order as a covariate and</span><span class="token comment">## Mare as grouping factor</span>
cs1 <span class="token operator">&lt;-</span> corARMA<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">,</span> p <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 237 </span>
cs1ARMA <span class="token operator">&lt;-</span> corARMA<span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
cs1ARMA <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1ARMA<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1ARMA<span class="token punctuation">)</span>

cs2ARMA <span class="token operator">&lt;-</span> corARMA<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">,</span> p<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> q<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
cs2ARMA <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs2ARMA<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs2ARMA<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates use in nlme:  </span>
<span class="token comment"># from p. 240 needed on p. 396</span>
fm1Ovar.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span>
                   data <span class="token operator">=</span> Ovary<span class="token punctuation">,</span> random <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span><span class="token operator">~</span>sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fm5Ovar.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Ovar.lme<span class="token punctuation">,</span>
                corr <span class="token operator">=</span> corARMA<span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 396</span>
fm1Ovar.nlme <span class="token operator">&lt;-</span> nlme<span class="token punctuation">(</span>follicles<span class="token operator">~</span>
     A<span class="token operator">+</span>B<span class="token operator">*</span>sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>w<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token operator">+</span>C<span class="token operator">*</span>cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>w<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span>
   data<span class="token operator">=</span>Ovary<span class="token punctuation">,</span> fixed<span class="token operator">=</span>A<span class="token operator">+</span>B<span class="token operator">+</span>C<span class="token operator">+</span>w<span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">,</span>
   random<span class="token operator">=</span>pdDiag<span class="token punctuation">(</span>A<span class="token operator">+</span>B<span class="token operator">+</span>w<span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   start<span class="token operator">=</span>c<span class="token punctuation">(</span>fixef<span class="token punctuation">(</span>fm5Ovar.lme<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment"># p. 397</span>
fm3Ovar.nlme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Ovar.nlme<span class="token punctuation">,</span>
         corr<span class="token operator">=</span>corARMA<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> q<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corCAR1">

<a href="#corCAR1" class="help-page-title"><h2>Continuous AR(1) Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corCAR1</code> class,
representing an autocorrelation structure of order 1, with a
continuous time covariate. Objects created using this constructor must
be later initialized using the appropriate <code>Initialize</code>
method.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corCAR1<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>the correlation between two observations one unit of time
apart. Must be between 0 and 1. Defaults to 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ t</code>, or <code>~ t |
     g</code>, specifying a time covariate <code>t</code> and,  optionally, a
grouping factor <code>g</code>. Covariates for this correlation structure
need not be integer valued.  When a grouping factor is present in
<code>form</code>, the correlation structure is assumed to apply only
to observations within the same grouping level; observations with
different grouping levels are assumed to be uncorrelated. Defaults to
<code>~ 1</code>, which corresponds to using the order of the observations
in the data as a covariate, and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corCAR1</code>, representing an autocorrelation
structure of order 1, with a continuous time covariate. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day.
</p>
<p>Jones, R.H. (1993) "Longitudinal Data with Serial Correlation: A
State-space Approach", Chapman and Hall.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 236, 243.  
</p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>, 
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## covariate is Time and grouping factor is Mare</span>
cs1 <span class="token operator">&lt;-</span> corCAR1<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Mare<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, pp. 240, 243</span>
fm1Ovar.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>follicles <span class="token operator">~</span>
           sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span>
   data <span class="token operator">=</span> Ovary<span class="token punctuation">,</span> random <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span><span class="token operator">~</span>sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fm4Ovar.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Ovar.lme<span class="token punctuation">,</span>
          correlation <span class="token operator">=</span> corCAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span>Time<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corClasses">

<a href="#corClasses" class="help-page-title"><h2>Correlation Structure Classes</h2></a>

<h3>Description</h3>

<p>Standard classes of correlation structures (<code>corStruct</code>)
available in the <code>nlme</code> package. 
</p>


<h3>Value</h3>

<p>Available standard classes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>corAR1</code></td>
<td>
<p>autoregressive process of order 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corARMA</code></td>
<td>
<p>autoregressive moving average process, with arbitrary
orders for the autoregressive and moving average components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corCAR1</code></td>
<td>
<p>continuous autoregressive process (AR(1) process for a
continuous time covariate).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corCompSymm</code></td>
<td>
<p>compound symmetry structure corresponding to a
constant correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corExp</code></td>
<td>
<p>exponential spatial correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corGaus</code></td>
<td>
<p>Gaussian spatial correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corLin</code></td>
<td>
<p>linear spatial correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corRatio</code></td>
<td>
<p>Rational quadratics spatial correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corSpher</code></td>
<td>
<p>spherical spatial correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corSymm</code></td>
<td>
<p>general correlation matrix, with no additional
structure.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Users may define their own <code>corStruct</code> classes by specifying a
<code>constructor</code> function and, at a minimum, methods for the
functions <code>corMatrix</code> and <code>coef</code>. For
examples of these functions, see the methods for classes <code>corSymm</code>
and <code>corAR1</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#corAR1">corAR1</a></code>, <code><a href="#corARMA">corARMA</a></code>,
<code><a href="#corCAR1">corCAR1</a></code>, <code><a href="#corCompSymm">corCompSymm</a></code>,
<code><a href="#corExp">corExp</a></code>, <code><a href="#corGaus">corGaus</a></code>,
<code><a href="#corLin">corLin</a></code>,
<code><a href="#corRatio">corRatio</a></code>, <code><a href="#corSpher">corSpher</a></code>,
<code><a href="#corSymm">corSymm</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code></p>

<hr>
</div>
<div class="container manual-page" id="corCompSymm">

<a href="#corCompSymm" class="help-page-title"><h2>Compound Symmetry Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corCompSymm</code> class,
representing a compound symmetry structure corresponding to uniform
correlation. Objects created using this constructor must later be
initialized using the appropriate <code>Initialize</code> method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corCompSymm<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>the correlation between any two correlated
observations. Defaults to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ t</code>, or <code>~ t |
     g</code>, specifying a time covariate <code>t</code> and,  optionally, a
grouping factor <code>g</code>. When a grouping factor is present in
<code>form</code>, the correlation structure is assumed to apply only
to observations within the same grouping level; observations with
different grouping levels are assumed to be uncorrelated. Defaults to
<code>~ 1</code>, which corresponds to using the order of the observations
in the data as a covariate, and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corCompSymm</code>, representing a compound
symmetry correlation structure. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Milliken, G. A. and Johnson, D. E. (1992) "Analysis of Messy Data,
Volume I: Designed Experiments", Van Nostrand Reinhold.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 233-234.  
</p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>, 
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## covariate is observation order and grouping factor is Subject</span>
cs1 <span class="token operator">&lt;-</span> corCompSymm<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, pp. 222-225 </span>
fm1BW.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>weight <span class="token operator">~</span> Time <span class="token operator">*</span> Diet<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">,</span>
                   random <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span>
<span class="token comment"># p. 223</span>
fm2BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1BW.lme<span class="token punctuation">,</span> weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 225</span>
cs1CompSymm <span class="token operator">&lt;-</span> corCompSymm<span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs2CompSymm <span class="token operator">&lt;-</span> corCompSymm<span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs1CompSymm <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1CompSymm<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1CompSymm<span class="token punctuation">)</span>

<span class="token comment">## Print/Summary methods for the empty case:</span>
<span class="token punctuation">(</span>cCS <span class="token operator">&lt;-</span> corCompSymm<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># Uninitialized correlation struc..</span>
summary<span class="token punctuation">(</span>cCS<span class="token punctuation">)</span>           <span class="token comment">#    (ditto)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corExp">

<a href="#corExp" class="help-page-title"><h2>Exponential Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>"corExp"</code> class,
representing an exponential spatial correlation structure. Letting
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> denote the range and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> denote the nugget
effect, the correlation between two observations a distance
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></code> apart is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\exp(-r/d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span></code> when no nugget effect
is present and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>n</mi><mo stretchy="false">)</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-n) \exp(-r/d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span></code> when a nugget
effect is assumed. Objects created using this constructor must later be
initialized using the appropriate <code>Initialize</code> method.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corExp<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nugget<span class="token punctuation">,</span> metric<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional vector with the parameter values in
constrained form. If <code>nugget</code> is <code>FALSE</code>, <code>value</code> can
have only one element, corresponding to the "range" of the
exponential correlation structure, which must be greater than
zero. If <code>nugget</code> is <code>TRUE</code>, meaning that a nugget effect
is present, <code>value</code> can contain one or two elements, the first
being the "range" and the second the "nugget effect" (one minus the
correlation between two observations taken arbitrarily close
together); the first must be greater than zero and the second must be
between zero and one. Defaults to <code>numeric(0)</code>, which results in
a range of 90% of the minimum distance and a nugget effect of 0.1
being assigned to the parameters when <code>object</code> is initialized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ S1+...+Sp</code>, or
<code>~ S1+...+Sp | g</code>, specifying spatial covariates <code>S1</code>
through <code>Sp</code> and,  optionally, a grouping factor <code>g</code>. 
When a grouping factor is present in <code>form</code>, the correlation
structure is assumed to apply only to observations within the same
grouping level; observations with different grouping levels are
assumed to be uncorrelated. Defaults to <code>~ 1</code>, which corresponds
to using the order of the observations in the data as a covariate,
and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>an optional logical value indicating whether a nugget
effect is present. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>an optional character string specifying the distance
metric to be used. The currently available options are
<code>"euclidean"</code> for the root sum-of-squares of distances;
<code>"maximum"</code> for the maximum difference; and <code>"manhattan"</code>
for the sum of the absolute differences. Partial matching of
arguments is used, so only the first three characters need to be
provided. Defaults to <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>"corExp"</code>, also inheriting from class
<code>"corSpatial"</code>, representing an exponential spatial correlation
structure. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp;
Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>
<p>Littel, Milliken, Stroup, and Wolfinger (1996) "SAS Systems for Mixed
Models", SAS Institute.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. p. 238.      
</p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>,
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">sp1 <span class="token operator">&lt;-</span> corExp<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 238</span>
spatDat <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span>

cs1Exp <span class="token operator">&lt;-</span> corExp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y<span class="token punctuation">)</span>
cs1Exp <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1Exp<span class="token punctuation">,</span> spatDat<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1Exp<span class="token punctuation">)</span>

cs2Exp <span class="token operator">&lt;-</span> corExp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"man"</span><span class="token punctuation">)</span>
cs2Exp <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs2Exp<span class="token punctuation">,</span> spatDat<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs2Exp<span class="token punctuation">)</span>

cs3Exp <span class="token operator">&lt;-</span> corExp<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y<span class="token punctuation">,</span>
                 nugget <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
cs3Exp <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs3Exp<span class="token punctuation">,</span> spatDat<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs3Exp<span class="token punctuation">)</span>

<span class="token comment"># example lme(..., corExp ...)</span>
<span class="token comment"># Pinheiro and Bates, pp. 222-247</span>
<span class="token comment"># p. 222</span>
options<span class="token punctuation">(</span>contrasts <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"contr.treatment"</span><span class="token punctuation">,</span> <span class="token string">"contr.poly"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fm1BW.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>weight <span class="token operator">~</span> Time <span class="token operator">*</span> Diet<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">,</span>
                   random <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span>
<span class="token comment"># p. 223</span>
fm2BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1BW.lme<span class="token punctuation">,</span> weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 246</span>
fm3BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm2BW.lme<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corExp<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 247</span>
fm4BW.lme <span class="token operator">&lt;-</span>
      update<span class="token punctuation">(</span>fm3BW.lme<span class="token punctuation">,</span> correlation <span class="token operator">=</span> corExp<span class="token punctuation">(</span>form <span class="token operator">=</span>  <span class="token operator">~</span> Time<span class="token punctuation">,</span>
                        nugget <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>fm3BW.lme<span class="token punctuation">,</span> fm4BW.lme<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corFactor">

<a href="#corFactor" class="help-page-title"><h2>Factor of a Correlation Matrix</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include all <code>corStruct</code> classes.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corFactor<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object from which a correlation matrix can be
extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate
documentation. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#corFactor.corStruct">corFactor.corStruct</a></code>,
<code><a href="#recalc.corStruct">recalc.corStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corFactor.corStruct">

<a href="#corFactor.corStruct" class="help-page-title"><h2>Factor of a corStruct Object Matrix</h2></a>

<h3>Description</h3>

<p>This method function extracts a transpose inverse square-root factor,
or a series of transpose inverse square-root factors, of the
correlation matrix, or list of correlation matrices,  represented by
<code>object</code>. Letting <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></code> denote a correlation
matrix, a square-root factor of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></code> is any square
matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> such that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi><mo>=</mo><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>L</mi></mrow><annotation encoding="application/x-tex">\Sigma = L'L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">L</span></span></span></span></code>. This method
extracts <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mrow><mo>−</mo><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">L^{-t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
corFactor<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>
representing a correlation structure, which must have been
initialized (using <code>Initialize</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If the correlation structure does not include a grouping factor, the
returned value will be a vector with a transpose inverse square-root
factor of the correlation matrix associated with <code>object</code> stacked
column-wise.  If the correlation structure includes a grouping factor,
the returned value will be a vector with transpose inverse
square-root factors of the correlation matrices for each group, stacked
by group and stacked column-wise within each group.  
</p>


<h3>Note</h3>

<p>This method function is used intensively in optimization
algorithms and its value is returned as a vector for efficiency
reasons. The <code>corMatrix</code> method function can be used to obtain
transpose inverse square-root factors in matrix form.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and
Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#corFactor">corFactor</a></code>,
<code><a href="#corMatrix.corStruct">corMatrix.corStruct</a></code>,
<code><a href="#recalc.corStruct">recalc.corStruct</a></code>,
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corFactor<span class="token punctuation">(</span>cs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corGaus">

<a href="#corGaus" class="help-page-title"><h2>Gaussian Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corGaus</code> class,
representing a Gaussian spatial correlation structure. Letting
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> denote the range and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> denote the nugget
effect, the correlation between two observations a distance
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></code> apart is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\exp(-(r/d)^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> when no nugget
effect is present and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>n</mi><mo stretchy="false">)</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-n) \exp(-(r/d)^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code>
when a nugget effect is assumed. Objects created using this
constructor must later be initialized using the appropriate
'  <code>Initialize</code> method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corGaus<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nugget<span class="token punctuation">,</span> metric<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional vector with the parameter values in
constrained form. If <code>nugget</code> is <code>FALSE</code>, <code>value</code> can
have only one element, corresponding to the "range" of the
Gaussian correlation structure, which must be greater than
zero. If <code>nugget</code> is <code>TRUE</code>, meaning that a nugget effect
is present, <code>value</code> can contain one or two elements, the first
being the "range" and the second the "nugget effect" (one minus the
correlation between two observations taken arbitrarily close
together); the first must be greater than zero and the second must be
between zero and one. Defaults to <code>numeric(0)</code>, which results in
a range of 90% of the minimum distance and a nugget effect of 0.1
being assigned to the parameters when <code>object</code> is initialized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ S1+...+Sp</code>, or
<code>~ S1+...+Sp | g</code>, specifying spatial covariates <code>S1</code>
through <code>Sp</code> and,  optionally, a grouping factor <code>g</code>. 
When a grouping factor is present in <code>form</code>, the correlation
structure is assumed to apply only to observations within the same
grouping level; observations with different grouping levels are
assumed to be uncorrelated. Defaults to <code>~ 1</code>, which corresponds
to using the order of the observations in the data as a covariate,
and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>an optional logical value indicating whether a nugget
effect is present. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>an optional character string specifying the distance
metric to be used. The currently available options are
<code>"euclidean"</code> for the root sum-of-squares of distances;
<code>"maximum"</code> for the maximum difference; and <code>"manhattan"</code>
for the sum of the absolute differences. Partial matching of
arguments is used, so only the first three characters need to be
provided. Defaults to <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corGaus</code>, also inheriting from class
<code>corSpatial</code>, representing a Gaussian spatial correlation
structure. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp;
Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>
<p>Littel, Milliken, Stroup, and Wolfinger (1996) "SAS Systems for Mixed
Models", SAS Institute.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">sp1 <span class="token operator">&lt;-</span> corGaus<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">)</span>

<span class="token comment"># example lme(..., corGaus ...)</span>
<span class="token comment"># Pinheiro and Bates, pp. 222-249</span>
fm1BW.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>weight <span class="token operator">~</span> Time <span class="token operator">*</span> Diet<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">,</span>
                   random <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span>
<span class="token comment"># p. 223</span>
fm2BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1BW.lme<span class="token punctuation">,</span> weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p 246 </span>
fm3BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm2BW.lme<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corExp<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 249</span>
fm8BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm3BW.lme<span class="token punctuation">,</span> correlation <span class="token operator">=</span> corGaus<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corLin">

<a href="#corLin" class="help-page-title"><h2>Linear Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corLin</code> class,
representing a linear spatial correlation structure. Letting
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> denote the range and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> denote the nugget
effect, the correlation between two observations a distance
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>&lt;</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">r &lt; d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> apart is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1-(r/d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span></code> when no nugget effect
is present and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-n) (1 -(r/d))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">))</span></span></span></span></code> when a nugget
effect is assumed. If <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>≥</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">r \geq d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> the correlation is
zero. Objects created using this constructor must later be
initialized using the appropriate <code>Initialize</code> method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corLin<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nugget<span class="token punctuation">,</span> metric<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional vector with the parameter values in
constrained form. If <code>nugget</code> is <code>FALSE</code>, <code>value</code> can
have only one element, corresponding to the "range" of the
linear correlation structure, which must be greater than
zero. If <code>nugget</code> is <code>TRUE</code>, meaning that a nugget effect
is present, <code>value</code> can contain one or two elements, the first
being the "range" and the second the "nugget effect" (one minus the
correlation between two observations taken arbitrarily close
together); the first must be greater than zero and the second must be
between zero and one. Defaults to <code>numeric(0)</code>, which results in
a range of 90% of the minimum distance and a nugget effect of 0.1
being assigned to the parameters when <code>object</code> is initialized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ S1+...+Sp</code>, or
<code>~ S1+...+Sp | g</code>, specifying spatial covariates <code>S1</code>
through <code>Sp</code> and,  optionally, a grouping factor <code>g</code>. 
When a grouping factor is present in <code>form</code>, the correlation
structure is assumed to apply only to observations within the same
grouping level; observations with different grouping levels are
assumed to be uncorrelated. Defaults to <code>~ 1</code>, which corresponds
to using the order of the observations in the data as a covariate,
and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>an optional logical value indicating whether a nugget
effect is present. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>an optional character string specifying the distance
metric to be used. The currently available options are
<code>"euclidean"</code> for the root sum-of-squares of distances;
<code>"maximum"</code> for the maximum difference; and <code>"manhattan"</code>
for the sum of the absolute differences. Partial matching of
arguments is used, so only the first three characters need to be
provided. Defaults to <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corLin</code>, also inheriting from class
<code>corSpatial</code>, representing a linear spatial correlation
structure. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>
<p>Littel, Milliken, Stroup, and Wolfinger (1996) "SAS Systems for Mixed
Models", SAS Institute.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">sp1 <span class="token operator">&lt;-</span> corLin<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y<span class="token punctuation">)</span>

<span class="token comment"># example lme(..., corLin ...)</span>
<span class="token comment"># Pinheiro and Bates, pp. 222-249</span>
fm1BW.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>weight <span class="token operator">~</span> Time <span class="token operator">*</span> Diet<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">,</span>
                   random <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span>
<span class="token comment"># p. 223</span>
fm2BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1BW.lme<span class="token punctuation">,</span> weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p 246 </span>
fm3BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm2BW.lme<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corExp<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 249</span>
fm7BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm3BW.lme<span class="token punctuation">,</span> correlation <span class="token operator">=</span> corLin<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corMatrix">

<a href="#corMatrix" class="help-page-title"><h2>Extract Correlation Matrix</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include all <code>corStruct</code> classes.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corMatrix<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object for which a correlation matrix can be
extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate
documentation. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#corMatrix.corStruct">corMatrix.corStruct</a></code>,
<code><a href="#corMatrix.pdMat">corMatrix.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corMatrix.corStruct">

<a href="#corMatrix.corStruct" class="help-page-title"><h2>Matrix of a corStruct Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the correlation matrix (or its transpose
inverse square-root factor), or list of correlation matrices (or their
transpose inverse square-root factors) corresponding to
<code>covariate</code> and <code>object</code>. Letting <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></code> denote
a correlation matrix, a square-root factor of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></code> is
any square matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> such that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi><mo>=</mo><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>L</mi></mrow><annotation encoding="application/x-tex">\Sigma =  L'L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">L</span></span></span></span></code>. When
<code>corr = FALSE</code>, this method extracts <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mrow><mo>−</mo><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">L^{-t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span></code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
corMatrix<span class="token punctuation">(</span>object<span class="token punctuation">,</span> covariate<span class="token punctuation">,</span> corr<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>an optional covariate vector (matrix), or list of
covariate vectors (matrices), at which values the correlation matrix,
or list of correlation  matrices, are to be evaluated. Defaults to
<code>getCovariate(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the function returns the
correlation matrix, or list of correlation matrices, represented by
<code>object</code>. If <code>FALSE</code> the function returns a transpose
inverse square-root of the correlation matrix, or a list of transpose
inverse square-root factors of the correlation matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>covariate</code> is a vector (matrix), the returned value will be
an array with the corresponding correlation matrix (or its transpose
inverse square-root factor). If the <code>covariate</code> is a list of
vectors (matrices), the returned value will be a list with the
correlation matrices (or their transpose inverse square-root factors)
corresponding to each component of <code>covariate</code>.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#corFactor.corStruct">corFactor.corStruct</a></code>, <code><a href="#Initialize.corStruct">Initialize.corStruct</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> covariate <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> covariate <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> corr <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 225</span>
cs1CompSymm <span class="token operator">&lt;-</span> corCompSymm<span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs1CompSymm <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1CompSymm<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1CompSymm<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 226</span>
cs1Symm <span class="token operator">&lt;-</span> corSymm<span class="token punctuation">(</span>value <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs1Symm <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1Symm<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1Symm<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 236 </span>
cs1AR1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs1AR1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1AR1<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1AR1<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 237 </span>
cs1ARMA <span class="token operator">&lt;-</span> corARMA<span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
cs1ARMA <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1ARMA<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1ARMA<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 238 </span>
spatDat <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span>
cs1Exp <span class="token operator">&lt;-</span> corExp<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y<span class="token punctuation">)</span>
cs1Exp <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1Exp<span class="token punctuation">,</span> spatDat<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1Exp<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corMatrix.pdMat">

<a href="#corMatrix.pdMat" class="help-page-title"><h2>Extract Correlation Matrix from a pdMat Object</h2></a>

<h3>Description</h3>

<p>The correlation matrix corresponding to the positive-definite matrix
represented by <code>object</code> is obtained. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
corMatrix<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>, representing
a positive definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the correlation matrix corresponding to the positive-definite matrix
represented by <code>object</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>, <code><a href="#pdMatrix">pdMatrix</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corMatrix.reStruct">

<a href="#corMatrix.reStruct" class="help-page-title"><h2>Extract Correlation Matrix from Components of an reStruct Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the correlation matrices
corresponding to the <code>pdMat</code> elements of <code>object</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
corMatrix<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components given by the correlation matrices
corresponding to the elements of <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.reStruct">as.matrix.reStruct</a></code>,
<code><a href="#corMatrix">corMatrix</a></code>, <code><a href="#reStruct">reStruct</a></code>,
<code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">~</span>age<span class="token operator">+</span>Sex<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span><span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corNatural">

<a href="#corNatural" class="help-page-title"><h2>General correlation in natural parameterization</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corNatural</code> class,
representing a general correlation structure in the “natural”
parameterization, which is described under <code><a href="#pdNatural">pdNatural</a></code>.
Objects created using this constructor must later be
initialized using the  appropriate <code>Initialize</code> method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corNatural<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional vector with the parameter values. Default is
<code>numeric(0)</code>, which results in a vector of zeros of appropriate
dimension being assigned to the parameters when <code>object</code> is
initialized (corresponding to an identity correlation structure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ t</code>, or <code>~ t |
     g</code>, specifying a time covariate <code>t</code> and,  optionally, a
grouping factor <code>g</code>. A covariate for this correlation structure
must be integer valued. When a grouping factor is present in
<code>form</code>, the correlation structure is assumed to apply only
to observations within the same grouping level; observations with
different grouping levels are assumed to be uncorrelated. Defaults to
<code>~ 1</code>, which corresponds to using the order of the observations
in the data as a covariate, and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corNatural</code> representing a general correlation
structure.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Initialize.corStruct">Initialize.corNatural</a></code>,
<code><a href="#pdNatural">pdNatural</a></code>, 
<code><a href="#summary.corStruct">summary.corNatural</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## covariate is observation order and grouping factor is Subject</span>
cs1 <span class="token operator">&lt;-</span> corNatural<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corRatio">

<a href="#corRatio" class="help-page-title"><h2>Rational Quadratic Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corRatio</code> class,
representing a rational quadratic spatial correlation structure. Letting
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> denote the range and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> denote the nugget
effect, the correlation between two observations a distance
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></code> apart is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1/(1+(r/d)^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> when no nugget effect
is present and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>n</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-n)/(1+(r/d)^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> when a
nugget effect is  assumed. Objects created using this constructor need
to be later initialized using the appropriate <code>Initialize</code>
method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corRatio<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nugget<span class="token punctuation">,</span> metric<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional vector with the parameter values in
constrained form. If <code>nugget</code> is <code>FALSE</code>, <code>value</code> can
have only one element, corresponding to the "range" of the
rational quadratic correlation structure, which must be greater than
zero. If <code>nugget</code> is <code>TRUE</code>, meaning that a nugget effect
is present, <code>value</code> can contain one or two elements, the first
being the "range" and the second the "nugget effect" (one minus the
correlation between two observations taken arbitrarily close
together); the first must be greater than zero and the second must be
between zero and one. Defaults to <code>numeric(0)</code>, which results in
a range of 90% of the minimum distance and a nugget effect of 0.1
being assigned to the parameters when <code>object</code> is initialized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ S1+...+Sp</code>, or
<code>~ S1+...+Sp | g</code>, specifying spatial covariates <code>S1</code>
through <code>Sp</code> and,  optionally, a grouping factor <code>g</code>. 
When a grouping factor is present in <code>form</code>, the correlation
structure is assumed to apply only to observations within the same
grouping level; observations with different grouping levels are
assumed to be uncorrelated. Defaults to <code>~ 1</code>, which corresponds
to using the order of the observations in the data as a covariate,
and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>an optional logical value indicating whether a nugget
effect is present. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>an optional character string specifying the distance
metric to be used. The currently available options are
<code>"euclidean"</code> for the root sum-of-squares of distances;
<code>"maximum"</code> for the maximum difference; and <code>"manhattan"</code>
for the sum of the absolute differences. Partial matching of
arguments is used, so only the first three characters need to be
provided. Defaults to <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corRatio</code>, also inheriting from class
<code>corSpatial</code>, representing a rational quadratic spatial correlation
structure. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>
<p>Littel, Milliken, Stroup, and Wolfinger (1996) "SAS Systems for Mixed
Models", SAS Institute.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer. 
</p>


<h3>See Also</h3>

<p><code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">sp1 <span class="token operator">&lt;-</span> corRatio<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">)</span>

<span class="token comment"># example lme(..., corRatio ...)</span>
<span class="token comment"># Pinheiro and Bates, pp. 222-249</span>
fm1BW.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>weight <span class="token operator">~</span> Time <span class="token operator">*</span> Diet<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">,</span>
                   random <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span>
<span class="token comment"># p. 223</span>
fm2BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1BW.lme<span class="token punctuation">,</span> weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p 246 </span>
fm3BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm2BW.lme<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corExp<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 249</span>
fm5BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm3BW.lme<span class="token punctuation">,</span> correlation <span class="token operator">=</span>
                   corRatio<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># example gls(..., corRatio ...)</span>
<span class="token comment"># Pinheiro and Bates, pp. 261, 263</span>
fm1Wheat2 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>yield <span class="token operator">~</span> variety <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Wheat2<span class="token punctuation">)</span>
<span class="token comment"># p. 263 </span>
fm3Wheat2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Wheat2<span class="token punctuation">,</span> corr <span class="token operator">=</span> 
    corRatio<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">12.5</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       form <span class="token operator">=</span> <span class="token operator">~</span> latitude <span class="token operator">+</span> longitude<span class="token punctuation">,</span>
             nugget <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corSpatial">

<a href="#corSpatial" class="help-page-title"><h2>Spatial Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corSpatial</code> class,
representing a spatial correlation structure. This class is "virtual",
having four "real" classes, corresponding to specific spatial
correlation structures, associated with it: <code>corExp</code>,
<code>corGaus</code>, <code>corLin</code>, <code>corRatio</code>, and
<code>corSpher</code>. The returned object will inherit from one of these
"real" classes, determined by the <code>type</code> argument, and from the
"virtual" <code>corSpatial</code> class. Objects created using this
constructor must later be initialized using the appropriate
<code>Initialize</code> method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corSpatial<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nugget<span class="token punctuation">,</span> type<span class="token punctuation">,</span> metric<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional vector with the parameter values in
constrained form. If <code>nugget</code> is <code>FALSE</code>, <code>value</code> can
have only one element, corresponding to the "range" of the
spatial correlation structure, which must be greater than
zero. If <code>nugget</code> is <code>TRUE</code>, meaning that a nugget effect
is present, <code>value</code> can contain one or two elements, the first
being the "range" and the second the "nugget effect" (one minus the
correlation between two observations taken arbitrarily close
together); the first must be greater than zero and the second must be
between zero and one. Defaults to <code>numeric(0)</code>, which results in
a range of 90% of the minimum distance and a nugget effect of 0.1
being assigned to the parameters when <code>object</code> is initialized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ S1+...+Sp</code>, or
<code>~ S1+...+Sp | g</code>, specifying spatial covariates <code>S1</code>
through <code>Sp</code> and,  optionally, a grouping factor <code>g</code>. 
When a grouping factor is present in <code>form</code>, the correlation
structure is assumed to apply only to observations within the same
grouping level; observations with different grouping levels are
assumed to be uncorrelated. Defaults to <code>~ 1</code>, which corresponds
to using the order of the observations in the data as a covariate,
and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>an optional logical value indicating whether a nugget
effect is present. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>an optional character string specifying the desired type of
correlation structure. Available types include <code>"spherical"</code>,
<code>"exponential"</code>, <code>"gaussian"</code>, <code>"linear"</code>, and
<code>"rational"</code>. See the documentation on the functions
<code>corSpher</code>, <code>corExp</code>, <code>corGaus</code>, <code>corLin</code>, and
<code>corRatio</code> for a description of these correlation
structures. Partial matching of arguments is used, so only the first
character needs to be provided.Defaults to <code>"spherical"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>an optional character string specifying the distance
metric to be used. The currently available options are
<code>"euclidean"</code> for the root sum-of-squares of distances;
<code>"maximum"</code> for the maximum difference; and <code>"manhattan"</code>
for the sum of the absolute differences. Partial matching of
arguments is used, so only the first three characters need to be
provided. Defaults to <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class determined by the <code>type</code> argument and also
inheriting from class <code>corSpatial</code>, representing a spatial
correlation structure.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>
<p>Littel, Milliken, Stroup, and Wolfinger (1996) "SAS Systems for Mixed
Models", SAS Institute.
</p>


<h3>See Also</h3>

<p><code><a href="#corExp">corExp</a></code>,
<code><a href="#corGaus">corGaus</a></code>,
<code><a href="#corLin">corLin</a></code>,
<code><a href="#corRatio">corRatio</a></code>,
<code><a href="#corSpher">corSpher</a></code>,
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">sp1 <span class="token operator">&lt;-</span> corSpatial<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"g"</span><span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"man"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corSpher">

<a href="#corSpher" class="help-page-title"><h2>Spherical Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corSpher</code> class,
representing a spherical spatial correlation structure. Letting
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> denote the range and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> denote the nugget
effect, the correlation between two observations a distance
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>&lt;</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">r &lt; d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> apart is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mn>1.5</mn><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo>+</mo><mn>0.5</mn><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">1-1.5(r/d)+0.5(r/d)^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1.5</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">0.5</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></code> when no
nugget effect is present and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>1.5</mn><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo>+</mo><mn>0.5</mn><mo stretchy="false">(</mo><mi>r</mi><mi mathvariant="normal">/</mi><mi>d</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-n)
    (1-1.5(r/d)+0.5(r/d)^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1.5</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">0.5</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code>  
when a nugget effect is assumed. If <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>≥</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">r \geq d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></code> the
correlation is zero. Objects created using this constructor must later
be initialized using the appropriate <code>Initialize</code> method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corSpher<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nugget<span class="token punctuation">,</span> metric<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional vector with the parameter values in
constrained form. If <code>nugget</code> is <code>FALSE</code>, <code>value</code> can
have only one element, corresponding to the "range" of the
spherical correlation structure, which must be greater than
zero. If <code>nugget</code> is <code>TRUE</code>, meaning that a nugget effect
is present, <code>value</code> can contain one or two elements, the first
being the "range" and the second the "nugget effect" (one minus the
correlation between two observations taken arbitrarily close
together); the first must be greater than zero and the second must be
between zero and one. Defaults to <code>numeric(0)</code>, which results in
a range of 90% of the minimum distance and a nugget effect of 0.1
being assigned to the parameters when <code>object</code> is initialized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ S1+...+Sp</code>, or
<code>~ S1+...+Sp | g</code>, specifying spatial covariates <code>S1</code>
through <code>Sp</code> and,  optionally, a grouping factor <code>g</code>. 
When a grouping factor is present in <code>form</code>, the correlation
structure is assumed to apply only to observations within the same
grouping level; observations with different grouping levels are
assumed to be uncorrelated. Defaults to <code>~ 1</code>, which corresponds
to using the order of the observations in the data as a covariate,
and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>an optional logical value indicating whether a nugget
effect is present. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>an optional character string specifying the distance
metric to be used. The currently available options are
<code>"euclidean"</code> for the root sum-of-squares of distances;
<code>"maximum"</code> for the maximum difference; and <code>"manhattan"</code>
for the sum of the absolute differences. Partial matching of
arguments is used, so only the first three characters need to be
provided. Defaults to <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corSpher</code>, also inheriting from class
<code>corSpatial</code>, representing a spherical spatial correlation
structure. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>
<p>Littel, Milliken, Stroup, and Wolfinger (1996) "SAS Systems for Mixed
Models", SAS Institute.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#summary.corStruct">summary.corStruct</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">sp1 <span class="token operator">&lt;-</span> corSpher<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> x <span class="token operator">+</span> y<span class="token punctuation">)</span>

<span class="token comment"># example lme(..., corSpher ...)</span>
<span class="token comment"># Pinheiro and Bates, pp. 222-249</span>
fm1BW.lme <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>weight <span class="token operator">~</span> Time <span class="token operator">*</span> Diet<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">,</span>
                   random <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span>
<span class="token comment"># p. 223</span>
fm2BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1BW.lme<span class="token punctuation">,</span> weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p 246 </span>
fm3BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm2BW.lme<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corExp<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># p. 249</span>
fm6BW.lme <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm3BW.lme<span class="token punctuation">,</span>
          correlation <span class="token operator">=</span> corSpher<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> Time<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># example gls(..., corSpher ...)</span>
<span class="token comment"># Pinheiro and Bates, pp. 261, 263</span>
fm1Wheat2 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>yield <span class="token operator">~</span> variety <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Wheat2<span class="token punctuation">)</span>
<span class="token comment"># p. 262 </span>
fm2Wheat2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Wheat2<span class="token punctuation">,</span> corr <span class="token operator">=</span>
   corSpher<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     form <span class="token operator">=</span> <span class="token operator">~</span> latitude <span class="token operator">+</span> longitude<span class="token punctuation">,</span> nugget <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="corSymm">

<a href="#corSymm" class="help-page-title"><h2>General Correlation Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>corSymm</code> class,
representing a general correlation structure. The internal
representation of this structure, in terms of unconstrained
parameters, uses the spherical parametrization defined in Pinheiro and
Bates (1996).  Objects created using this constructor must later be
initialized using the  appropriate <code>Initialize</code> method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">corSymm<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional vector with the parameter values. Default is
<code>numeric(0)</code>, which results in a vector of zeros of appropriate
dimension being assigned to the parameters when <code>object</code> is
initialized (corresponding to an identity correlation structure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form <code>~ t</code>, or <code>~ t |
     g</code>, specifying a time covariate <code>t</code> and,  optionally, a
grouping factor <code>g</code>. A covariate for this correlation structure
must be integer valued. When a grouping factor is present in
<code>form</code>, the correlation structure is assumed to apply only
to observations within the same grouping level; observations with
different grouping levels are assumed to be uncorrelated. Defaults to
<code>~ 1</code>, which corresponds to using the order of the observations
in the data as a covariate, and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to <code>FALSE</code>, in which case
the coefficients are allowed to vary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>corSymm</code> representing a general correlation
structure.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

 
<p>Pinheiro, J.C. and Bates., D.M.  (1996) "Unconstrained
Parametrizations for Variance-Covariance Matrices", Statistics and
Computing, 6, 289-296.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#Initialize.corStruct">Initialize.corSymm</a></code>, 
<code><a href="#summary.corStruct">summary.corSymm</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## covariate is observation order and grouping factor is Subject</span>
cs1 <span class="token operator">&lt;-</span> corSymm<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 225 </span>
cs1CompSymm <span class="token operator">&lt;-</span> corCompSymm<span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs1CompSymm <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1CompSymm<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1CompSymm<span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 226</span>
cs1Symm <span class="token operator">&lt;-</span> corSymm<span class="token punctuation">(</span>value <span class="token operator">=</span>
        c<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs1Symm <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1Symm<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
corMatrix<span class="token punctuation">(</span>cs1Symm<span class="token punctuation">)</span>

<span class="token comment"># example gls(..., corSpher ...)</span>
<span class="token comment"># Pinheiro and Bates, pp. 261, 263</span>
fm1Wheat2 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>yield <span class="token operator">~</span> variety <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Wheat2<span class="token punctuation">)</span>
<span class="token comment"># p. 262 </span>
fm2Wheat2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1Wheat2<span class="token punctuation">,</span> corr <span class="token operator">=</span>
   corSpher<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     form <span class="token operator">=</span> <span class="token operator">~</span> latitude <span class="token operator">+</span> longitude<span class="token punctuation">,</span> nugget <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># example gls(..., corSymm ... )</span>
<span class="token comment"># Pinheiro and Bates, p. 251</span>
fm1Orth.gls <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>distance <span class="token operator">~</span> Sex <span class="token operator">*</span> I<span class="token punctuation">(</span>age <span class="token operator">-</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span>
                   correlation <span class="token operator">=</span> corSymm<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span><span class="token punctuation">,</span>
                   weights <span class="token operator">=</span> varIdent<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> age<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Covariate">

<a href="#Covariate" class="help-page-title"><h2>Assign Covariate Values</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include all <code>"<a href="#varFunc">varFunc</a>"</code> classes.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">covariate<span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object with a <code>covariate</code> component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a value to be assigned to the covariate associated with
<code>object</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#getCovariate">getCovariate</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Covariate.varFunc">

<a href="#Covariate.varFunc" class="help-page-title"><h2>Assign varFunc Covariate</h2></a>

<h3>Description</h3>

<p>The covariate(s) used in the calculation of the weights of the
variance function represented by <code>object</code> is (are) replaced by
<code>value</code>. If <code>object</code> has been initialized, <code>value</code> must
have the same dimensions as <code>getCovariate(object)</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 replacement method for class 'varFunc'</span>
covariate<span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#varFunc">varFunc</a>"</code>,
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a value to be assigned to the covariate associated with
<code>object</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>varFunc</code> object similar to <code>object</code>, but with its
<code>covariate</code> attribute replaced by <code>value</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#getCovariate.varFunc">getCovariate.varFunc</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token punctuation">)</span>
covariate<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> Orthodont<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"age"</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Dialyzer">

<a href="#Dialyzer" class="help-page-title"><h2>High-Flux Hemodialyzer</h2></a>

<h3>Description</h3>

<p>The <code>Dialyzer</code> data frame has 140 rows and 5 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Subject</dt>
<dd>
<p>an ordered factor with levels
<code>10</code> &lt; <code>8</code> &lt; <code>2</code> &lt; <code>6</code> &lt; <code>3</code> &lt;
<code>5</code> &lt; <code>9</code> &lt; <code>7</code> &lt; <code>1</code> &lt; <code>4</code> &lt;
<code>17</code> &lt; <code>20</code> &lt; <code>11</code> &lt; <code>12</code> &lt; <code>16</code> &lt;
<code>13</code> &lt; <code>14</code> &lt; <code>18</code> &lt; <code>15</code> &lt; <code>19</code>
giving the unique identifier for each subject
</p>
</dd>
<dt>QB</dt>
<dd>
<p>a factor with levels
<code>200</code> and 
<code>300</code> giving the bovine blood flow rate (dL/min).
</p>
</dd>
<dt>pressure</dt>
<dd>
<p>a numeric vector giving the transmembrane pressure (dmHg).
</p>
</dd>
<dt>rate</dt>
<dd>
<p>the hemodialyzer ultrafiltration rate (mL/hr).
</p>
</dd>
<dt>index</dt>
<dd>
<p>index of observation within subject—1 through 7.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Vonesh and Carter (1992) describe data measured on high-flux
hemodialyzers to assess their <em>in vivo</em> ultrafiltration
characteristics. The ultrafiltration rates (in mL/hr) of 20 high-flux
dialyzers were measured at seven different transmembrane pressures (in
dmHg). The <em>in vitro</em> evaluation of the dialyzers used bovine
blood at flow rates of either 200~dl/min or 300~dl/min. The data,
are also analyzed in Littell, Milliken, Stroup, and Wolfinger (1996).
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York. (Appendix A.6)
</p>
<p>Vonesh, E. F. and Carter, R. L. (1992), Mixed-effects nonlinear
regression for unbalanced repeated measures, <em>Biometrics</em>,
<b>48</b>, 1-18.
</p>
<p>Littell, R. C., Milliken, G. A., Stroup, W. W. and Wolfinger,
R. D. (1996), <em>SAS System for Mixed Models</em>, SAS Institute,
Cary, NC.
</p>

<hr>
</div>
<div class="container manual-page" id="Dim">

<a href="#Dim" class="help-page-title"><h2>Extract Dimensions from an Object</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include: <code>"<a href="#corSpatial">corSpatial</a>"</code>, <code>"<a href="#corClasses">corStruct</a>"</code>,
<code>"pdCompSymm"</code>, <code>"pdDiag"</code>, <code>"pdIdent"</code>, <code>"pdMat"</code>,
and <code>"pdSymm"</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Dim<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object for which dimensions can be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>Note</h3>

<p>If <code>dim</code> allowed more than one argument, there would be no
need for this generic function.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Dim.pdMat">Dim.pdMat</a></code>, <code><a href="#Dim.corStruct">Dim.corStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Dim.corSpatial">

<a href="#Dim.corSpatial" class="help-page-title"><h2>Dimensions of a corSpatial Object</h2></a>

<h3>Description</h3>

<p>if <code>groups</code> is missing, it returns the <code>Dim</code> attribute of
<code>object</code>; otherwise, calculates the dimensions associated with
the grouping factor.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corSpatial'</span>
Dim<span class="token punctuation">(</span>object<span class="token punctuation">,</span> groups<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corSpatial">corSpatial</a>"</code>,
representing a spatial correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>an optional factor defining the grouping of the
observations; observations within a group are correlated and
observations in different groups are uncorrelated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>length of <code>groups</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spClass</code></td>
<td>
<p>an integer representing the spatial correlation class;
0 = user defined class, 1 = <code>corSpher</code>, 2 = <code>corExp</code>, 3 =
<code>corGaus</code>, 4 = <code>corLin</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumLenSq</code></td>
<td>
<p>sum of the squares of the number of observations per
group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len</code></td>
<td>
<p>an integer vector with the number of observations per
group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an integer vector with the starting position for the
distance vectors in each group, beginning from zero</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Dim">Dim</a></code>,
<code><a href="#Dim.corStruct">Dim.corStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">Dim<span class="token punctuation">(</span>corGaus<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getGroups<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span><span class="token punctuation">)</span>

cs1ARMA <span class="token operator">&lt;-</span> corARMA<span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
cs1ARMA <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1ARMA<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
Dim<span class="token punctuation">(</span>cs1ARMA<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Dim.corStruct">

<a href="#Dim.corStruct" class="help-page-title"><h2>Dimensions of a corStruct Object</h2></a>

<h3>Description</h3>

<p>if <code>groups</code> is missing, it returns the <code>Dim</code> attribute of
<code>object</code>; otherwise, calculates the dimensions associated with
the grouping factor.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
Dim<span class="token punctuation">(</span>object<span class="token punctuation">,</span> groups<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>,
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>an optional factor defining the grouping of the
observations; observations within a group are correlated and
observations in different groups are uncorrelated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>length of <code>groups</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxLen</code></td>
<td>
<p>maximum number of observations in a group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumLenSq</code></td>
<td>
<p>sum of the squares of the number of observations per
group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len</code></td>
<td>
<p>an integer vector with the number of observations per
group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an integer vector with the starting position for the
observations in each group, beginning from zero</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Dim">Dim</a></code>, <code><a href="#Dim.corSpatial">Dim.corSpatial</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">Dim<span class="token punctuation">(</span>corAR1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getGroups<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Dim.pdMat">

<a href="#Dim.pdMat" class="help-page-title"><h2>Dimensions of a pdMat Object</h2></a>

<h3>Description</h3>

<p>This method function returns the dimensions of the matrix represented
by <code>object</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
Dim<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>,
representing a positive-definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an integer vector with the number of rows and columns of the
matrix represented by <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Dim">Dim</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">Dim<span class="token punctuation">(</span>pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Earthquake">

<a href="#Earthquake" class="help-page-title"><h2>Earthquake Intensity</h2></a>

<h3>Description</h3>

<p>The <code>Earthquake</code> data frame has 182 rows and 5 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Quake</dt>
<dd>
<p>an ordered factor with levels
<code>20</code> &lt; <code>16</code> &lt; <code>14</code> &lt; <code>10</code> &lt; <code>3</code> &lt;
<code>8</code> &lt; <code>23</code> &lt; <code>22</code> &lt; <code>6</code> &lt; <code>13</code> &lt;
<code>7</code> &lt; <code>21</code> &lt; <code>18</code> &lt; <code>15</code> &lt; <code>4</code> &lt;
<code>12</code> &lt; <code>19</code> &lt; <code>5</code> &lt; <code>9</code> &lt; <code>1</code> &lt;
<code>2</code> &lt; <code>17</code> &lt; <code>11</code> indicating the earthquake
on which the measurements were made.
</p>
</dd>
<dt>Richter</dt>
<dd>
<p>a numeric vector giving the intensity of the earthquake on
the Richter scale.
</p>
</dd>
<dt>distance</dt>
<dd>
<p>the distance from the seismological measuring station to the
epicenter of the earthquake (km).
</p>
</dd>
<dt>soil</dt>
<dd>
<p>a factor with levels <code>0</code> and <code>1</code>
giving the soil condition at the measuring station, either
soil or rock.
</p>
</dd>
<dt>accel</dt>
<dd>
<p>maximum horizontal acceleration observed (g).
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Measurements recorded at available seismometer locations for 23
large earthquakes in western North America between 1940 and 1980.
They were originally given in Joyner and Boore (1981); are
mentioned in Brillinger (1987); and are analyzed in Davidian
and Giltinan (1995).
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.8)
</p>
<p>Davidian, M. and Giltinan, D. M. (1995), <em>Nonlinear Models for
Repeated Measurement Data</em>,  Chapman and Hall, London.
</p>
<p>Joyner and Boore (1981), Peak horizontal acceleration and velocity from
strong-motion records including records from the 1979 Imperial
Valley, California, earthquake, <em>Bulletin of the Seismological
Society of America</em>, <b>71</b>, 2011-2038.
</p>
<p>Brillinger, D. (1987), Comment on a paper by C. R. Rao,
<em>Statistical Science</em>, <b>2</b>, 448-450.
</p>

<hr>
</div>
<div class="container manual-page" id="ergoStool">

<a href="#ergoStool" class="help-page-title"><h2>Ergometrics experiment with stool types</h2></a>

<h3>Description</h3>

<p>The <code>ergoStool</code> data frame has 36 rows and 3 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>effort</dt>
<dd>
<p>a numeric vector giving the effort (Borg scale) required to
arise from a stool.
</p>
</dd>
<dt>Type</dt>
<dd>
<p>a factor with levels
<code>T1</code>, 
<code>T2</code>, 
<code>T3</code>, and 
<code>T4</code> giving the stool type.
</p>
</dd>
<dt>Subject</dt>
<dd>
<p>an ordered factor giving a unique identifier for the subject
in the experiment.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Devore (2000) cites data from an article in <em>Ergometrics</em> (1993,
pp. 519-535) on “The Effects of a Pneumatic Stool and a One-Legged
Stool on Lower Limb Joint Load and Muscular Activity.”
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.9)
</p>
<p>Devore, J. L. (2000), <em>Probability and Statistics for
Engineering and the Sciences (5th ed)</em>, Duxbury, Boston, MA.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span>
   lme<span class="token punctuation">(</span>effort <span class="token operator">~</span> Type<span class="token punctuation">,</span> data <span class="token operator">=</span> ergoStool<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
anova<span class="token punctuation">(</span> fm1 <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Fatigue">

<a href="#Fatigue" class="help-page-title"><h2>Cracks caused by metal fatigue</h2></a>

<h3>Description</h3>

<p>The <code>Fatigue</code> data frame has 262 rows and 3 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Path</dt>
<dd>
<p>an ordered factor with levels
<code>1</code> &lt; <code>2</code> &lt; <code>3</code> &lt; <code>4</code> &lt; <code>5</code> &lt;
<code>6</code> &lt; <code>7</code> &lt; <code>8</code> &lt; <code>9</code> &lt; <code>10</code> &lt;
<code>11</code> &lt; <code>12</code> &lt; <code>13</code> &lt; <code>14</code> &lt; <code>15</code> &lt;
<code>16</code> &lt; <code>17</code> &lt; <code>18</code> &lt; <code>19</code> &lt; <code>20</code> &lt;
<code>21</code> giving the test path (or test unit) number.  The
order is in terms of increasing failure time or decreasing
terminal crack length.
</p>
</dd>
<dt>cycles</dt>
<dd>
<p>number of test cycles at which the measurement is made
(millions of cycles).
</p>
</dd>
<dt>relLength</dt>
<dd>
<p>relative crack length (dimensionless).
</p>
</dd>
</dl>
<h3>Details</h3>

<p>These data are given in Lu and Meeker (1993) where they state
“We obtained the data in Table 1 visually from figure 4.5.2 on page 242
of Bogdanoff and Kozin (1985).”
The data represent the growth of cracks in metal for 21 test units.
An initial notch of length 0.90 inches was made on each unit which then
was subjected to several thousand test cycles.  After every 10,000
test cycles the crack length was measured.  Testing was stopped if the
crack length exceeded 1.60 inches, defined as a failure, or at 120,000
cycles.
</p>


<h3>Source</h3>

<p>Lu, C. Joséph , and Meeker, William Q. (1993), Using degradation
measures to estimate a time-to-failure distribution,
<em>Technometrics</em>, <b>35</b>, 161-174 
</p>

<hr>
</div>
<div class="container manual-page" id="fdHess">

<a href="#fdHess" class="help-page-title"><h2>Finite difference Hessian</h2></a>

<h3>Description</h3>

<p>Evaluate an approximate Hessian and gradient of a scalar function
using finite differences.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">fdHess<span class="token punctuation">(</span>pars<span class="token punctuation">,</span> fun<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
       .relStep <span class="token operator">=</span> .Machine<span class="token operator">$</span>double.eps<span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> minAbsPar <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>the numeric values of the parameters at which to evaluate the
function <code>fun</code> and its derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a function depending on the parameters <code>pars</code> that
returns a numeric scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional additional arguments to <code>fun</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.relStep</code></td>
<td>
<p>The relative step size to use in the finite
differences.  It defaults to the cube root of <code>.Machine$double.eps</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minAbsPar</code></td>
<td>
<p>The minimum magnitude of a parameter value that is
considered non-zero.  It defaults to zero meaning that any non-zero
value will be considered different from zero.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses a second-order response surface design known as a
“Koschal design” to determine the parameter values at which the
function is evaluated.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>the value of function <code>fun</code> evaluated at the
parameter values <code>pars</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>an approximate gradient (of length <code>length(pars)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hessian</code></td>
<td>
<p>a matrix whose upper triangle contains an approximate Hessian.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>fdH <span class="token operator">&lt;-</span> fdHess<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">12.3</span><span class="token punctuation">,</span> <span class="token number">2.34</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.4</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>length<span class="token punctuation">(</span>fdH<span class="token operator">$</span> mean<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>
          length<span class="token punctuation">(</span>fdH<span class="token operator">$</span> gradient<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>
          identical<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>fdH<span class="token operator">$</span> Hessian<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="fitted.glsStruct">

<a href="#fitted.glsStruct" class="help-page-title"><h2>Calculate glsStruct Fitted Values</h2></a>

<h3>Description</h3>

<p>The fitted values for the linear model represented by <code>object</code>
are extracted.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'glsStruct'</span>
fitted<span class="token punctuation">(</span>object<span class="token punctuation">,</span> glsFit<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#glsStruct">glsStruct</a>"</code>,
representing a list of linear model components, such as
<code>corStruct</code> and <code>"<a href="#varFunc">varFunc</a>"</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glsFit</code></td>
<td>
<p>an optional list with components <code>logLik</code>
(log-likelihood), <code>beta</code> (coefficients), <code>sigma</code> (standard
deviation for error term), <code>varBeta</code> (coefficients' covariance
matrix), <code>fitted</code> (fitted values), and <code>residuals</code>
(residuals). Defaults to <code>attr(object, "glsFit")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the fitted values for the linear model represented by
<code>object</code>. 
</p>


<h3>Note</h3>

<p>This method function is generally only used inside <code>gls</code> and 
<code>fitted.gls</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>, 
<code><a href="#residuals.glsStruct">residuals.glsStruct</a></code> </p>

<hr>
</div>
<div class="container manual-page" id="fitted.gnlsStruct">

<a href="#fitted.gnlsStruct" class="help-page-title"><h2>Calculate gnlsStruct Fitted Values</h2></a>

<h3>Description</h3>

<p>The fitted values for the nonlinear model represented by <code>object</code>
are extracted.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gnlsStruct'</span>
fitted<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gnlsStruct">gnlsStruct</a>"</code>,
representing a list of model components, such as
<code>corStruct</code> and <code>varFunc</code> objects, and attributes
specifying the underlying nonlinear model and the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the fitted values for the nonlinear model represented by
<code>object</code>. 
</p>


<h3>Note</h3>

<p>This method function is generally only used inside <code>gnls</code> and 
<code>fitted.gnls</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gnls">gnls</a></code>, 
<code><a href="#residuals.gnlsStruct">residuals.gnlsStruct</a></code> </p>

<hr>
</div>
<div class="container manual-page" id="fitted.lme">

<a href="#fitted.lme" class="help-page-title"><h2>Extract lme Fitted Values</h2></a>

<h3>Description</h3>

<p>The fitted values at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by adding together the
population fitted values (based only on the fixed effects estimates)
and the estimated contributions of the random effects to the fitted
values at grouping levels less or equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>. The resulting
values estimate the best linear unbiased predictions (BLUPs) at level
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
fitted<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level<span class="token punctuation">,</span> asList<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping
to be used in extracting the fitted values from <code>object</code>. Level
values increase from outermost to innermost grouping, with
level zero corresponding to the population fitted values. Defaults to
the highest or innermost level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> and a single
value is given in <code>level</code>, the returned object is a list with
the fitted values split by groups; else the returned value is
either a vector or a data frame, according to the length of
<code>level</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If a single level of grouping is specified in <code>level</code>, the
returned value is either a list with the fitted values split by groups
(<code>asList = TRUE</code>) or a vector with the fitted values
(<code>asList = FALSE</code>); else, when multiple grouping levels are
specified in <code>level</code>, the returned object is a data frame with
columns given by the fitted values at different levels and the
grouping factors.  For a vector or data frame result the
<code><a href="https://r-universe.dev/manuals/stats.html#nafns">napredict</a></code> method is applied.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Bates, D.M. and Pinheiro, J.C. (1998) "Computational methods for
multilevel models" available in PostScript or PDF formats at
http://nlme.stat.wisc.edu/pub/NLME/
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 235, 397.    
</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#residuals.lme">residuals.lme</a></code> </p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">+</span> Sex<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">)</span>
fitted<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="fitted.lmeStruct">

<a href="#fitted.lmeStruct" class="help-page-title"><h2>Calculate lmeStruct Fitted Values</h2></a>

<h3>Description</h3>

<p>The fitted values at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by adding together the
population fitted values (based only on the fixed effects estimates)
and the estimated contributions of the random effects to the fitted
values at grouping levels less or equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>. The resulting
values estimate the best linear unbiased predictions (BLUPs) at level
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmeStruct'</span>
fitted<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> lmeFit<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmeStruct">lmeStruct</a>"</code>,
representing a list of linear mixed-effects model components, such as
<code>reStruct</code>, <code>corStruct</code>, and <code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping
to be used in extracting the fitted values from <code>object</code>. Level
values increase from outermost to innermost grouping, with
level zero corresponding to the population fitted values. Defaults to
the highest or innermost level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>an optional condensed linear model object, consisting of
a list with components <code>"Xy"</code>, corresponding to a regression
matrix (<code>X</code>) combined with a response vector (<code>y</code>), and 
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying lme model. Defaults to <code>attr(object, "conLin")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmeFit</code></td>
<td>
<p>an optional list with components <code>beta</code> and <code>b</code>
containing respectively the fixed effects estimates and the random
effects estimates to be used to calculate the fitted values. Defaults
to <code>attr(object, "lmeFit")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic accept other optional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if a single level of grouping is specified in <code>level</code>,
the returned value is a vector with the fitted values at the desired
level; else, when multiple grouping levels are specified in
<code>level</code>, the returned object is a matrix with 
columns given by the fitted values at different levels. 
</p>


<h3>Note</h3>

<p>This method function is generally only used inside <code>lme</code> and 
<code>fitted.lme</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#fitted.lme">fitted.lme</a></code>,
<code><a href="#residuals.lmeStruct">residuals.lmeStruct</a></code> </p>

<hr>
</div>
<div class="container manual-page" id="fitted.lmList">

<a href="#fitted.lmList" class="help-page-title"><h2>Extract lmList Fitted Values</h2></a>

<h3>Description</h3>

<p>The fitted values are extracted from each <code>lm</code> component of
<code>object</code> and arranged into a list with as many components as
<code>object</code>, or combined into a single vector.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
fitted<span class="token punctuation">(</span>object<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> asList<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional character or integer vector naming the
<code>lm</code> components of <code>object</code> from which the fitted values
are to be extracted. Default is <code>NULL</code>, in which case all
components are used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, the returned
object is a list with the fitted values split by groups; else the
returned value is a vector. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components given by the fitted values of each <code>lm</code>
component of <code>object</code>, or a vector with the fitted values for all
<code>lm</code> components of <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>, <code><a href="#residuals.lmList">residuals.lmList</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
fitted<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="fitted.nlmeStruct">

<a href="#fitted.nlmeStruct" class="help-page-title"><h2>Calculate nlmeStruct Fitted Values</h2></a>

<h3>Description</h3>

<p>The fitted values at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by adding together the
contributions from the estimated fixed effects and the estimated
random effects at levels less or equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> and evaluating the
model function at the resulting estimated parameters. The resulting
values estimate the predictions at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'nlmeStruct'</span>
fitted<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#nlmeStruct">nlmeStruct</a>"</code>,
representing a list of mixed-effects model components, such as
<code>reStruct</code>, <code>corStruct</code>, and <code>varFunc</code> objects, plus
attributes  specifying the underlying nonlinear model and the
response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping
to be used in extracting the fitted values from <code>object</code>. Level
values increase from outermost to innermost grouping, with
level zero corresponding to the population fitted values. Defaults to
the highest or innermost level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>an optional condensed linear model object, consisting of
a list with components <code>"Xy"</code>, corresponding to a regression
matrix (<code>X</code>) combined with a response vector (<code>y</code>), and 
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying nlme model. Defaults to <code>attr(object, "conLin")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments that could be given to this method.
None are used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if a single level of grouping is specified in <code>level</code>,
the returned value is a vector with the fitted values at the desired
level; else, when multiple grouping levels are specified in
<code>level</code>, the returned object is a matrix with 
columns given by the fitted values at different levels. 
</p>


<h3>Note</h3>

<p>This method function is generally only used inside <code>nlme</code> and 
<code>fitted.nlme</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Bates, D.M. and Pinheiro, J.C. (1998) "Computational methods for
multilevel models" available in PostScript or PDF formats at
http://nlme.stat.wisc.edu/pub/NLME/
</p>


<h3>See Also</h3>

<p><code><a href="#nlme">nlme</a></code>, <code><a href="#residuals.nlmeStruct">residuals.nlmeStruct</a></code></p>

<hr>
</div>
<div class="container manual-page" id="fixed.effects">

<a href="#fixed.effects" class="help-page-title"><h2>Extract Fixed Effects</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include <code>lmList</code> and <code>lme</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">fixed.effects<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
fixef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any fitted model object from which fixed effects
estimates can be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#fixef.lmList">fixef.lmList</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="fixef.lmList">

<a href="#fixef.lmList" class="help-page-title"><h2>Extract lmList Fixed Effects</h2></a>

<h3>Description</h3>

<p>The average of the coefficients corresponding to the <code>lm</code>
components of <code>object</code> is calculated.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
fixef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the average of the individual <code>lm</code> coefficients in
<code>object</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>, <code><a href="#ranef.lmList">random.effects.lmList</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
fixed.effects<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="formula.pdBlocked">

<a href="#formula.pdBlocked" class="help-page-title"><h2>Extract pdBlocked Formula</h2></a>

<h3>Description</h3>

<p>The <code>formula</code> attributes of the <code>pdMat</code> elements of
<code>x</code> are extracted and returned as a list, in case
<code>asList=TRUE</code>, or converted to a single one-sided formula when
<code>asList=FALSE</code>. If the <code>pdMat</code> elements do not have a
<code>formula</code> attribute, a <code>NULL</code> value is returned.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdBlocked'</span>
formula<span class="token punctuation">(</span>x<span class="token punctuation">,</span> asList<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"pdBlocked"</code>,
representing a positive definite block diagonal matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, a list with
the formulas for the individual block diagonal elements of
<code>x</code> is returned; else, if <code>FALSE</code>, a one-sided formula
combining all individual formulas is returned. Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of one-sided formulas, or a single one-sided formula, or
<code>NULL</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#pdBlocked">pdBlocked</a></code>, <code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdBlocked<span class="token punctuation">(</span>list<span class="token punctuation">(</span><span class="token operator">~</span> age<span class="token punctuation">,</span> <span class="token operator">~</span> Sex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
formula<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span>
formula<span class="token punctuation">(</span>pd1<span class="token punctuation">,</span> asList <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="formula.pdMat">

<a href="#formula.pdMat" class="help-page-title"><h2>Extract pdMat Formula</h2></a>

<h3>Description</h3>

<p>This method function extracts the formula associated with a
<code>pdMat</code> object, in which the column and row names are specified.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
formula<span class="token punctuation">(</span>x<span class="token punctuation">,</span> asList<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>, representing
a positive definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>logical.  Should the asList argument be applied to each
of the components?  Never used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>x</code> has a <code>formula</code> attribute, its value is
returned, else <code>NULL</code> is returned.
</p>


<h3>Note</h3>

<p>Because factors may be present in <code>formula(x)</code>, the
<code>pdMat</code> object needs to have access to a data frame where the
variables named in the formula can be evaluated, before it can resolve
its row and column names from the formula.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdSymm<span class="token punctuation">(</span><span class="token operator">~</span>Sex<span class="token operator">*</span>age<span class="token punctuation">)</span>
formula<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="formula.reStruct">

<a href="#formula.reStruct" class="help-page-title"><h2>Extract reStruct Object Formula</h2></a>

<h3>Description</h3>

<p>This method function extracts a formula from each of the 
components of <code>x</code>, returning a list of formulas.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
formula<span class="token punctuation">(</span>x<span class="token punctuation">,</span> asList<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>logical.  Should the asList argument be applied to each
of the components?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the formulas of each component of <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#formula">formula</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>list<span class="token punctuation">(</span>A <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">~</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> B <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
formula<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="gapply">

<a href="#gapply" class="help-page-title"><h2>Apply a Function by Groups</h2></a>

<h3>Description</h3>

<p>Applies the function to the distinct sets of rows of the data frame
defined by <code>groups</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">gapply<span class="token punctuation">(</span>object<span class="token punctuation">,</span> which<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span> form<span class="token punctuation">,</span> level<span class="token punctuation">,</span> groups<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object to which the function will be applied - usually
a <code>groupedData</code> object or a <code>data.frame</code>. Must inherit from
class <code>"data.frame"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an optional character or positive integer vector
specifying which columns of <code>object</code> should be used with
<code>FUN</code>. Defaults to all columns in <code>object</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>function to apply to the distinct sets of rows
of the data frame <code>object</code> defined by the values of
<code>groups</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula that defines the groups.
When this formula is given the right-hand side is evaluated in
<code>object</code>, converted to a factor if necessary, and the unique
levels are used to define the groups.  Defaults to
<code>formula(object)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional positive integer giving the level of grouping
to be used in an object with multiple nested grouping levels.
Defaults to the highest or innermost level of grouping.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>an optional factor that will be used to split the 
rows into groups.  Defaults to <code>getGroups(object, form, level)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional additional arguments to the summary function
<code>FUN</code>.  Often it is helpful to specify <code>na.rm = TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a data frame with as many rows as there are levels in the
<code>groups</code> argument.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. sec. 3.4.  
</p>


<h3>See Also</h3>

<p><code><a href="#gsummary">gsummary</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Find number of non-missing "conc" observations for each Subject</span>
gapply<span class="token punctuation">(</span> Phenobarb<span class="token punctuation">,</span> FUN <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> sum<span class="token punctuation">(</span><span class="token operator">!</span>is.na<span class="token punctuation">(</span>x<span class="token operator">$</span>conc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>

<span class="token comment"># Pinheiro and Bates, p. 127 </span>
table<span class="token punctuation">(</span> gapply<span class="token punctuation">(</span>Quinidine<span class="token punctuation">,</span> <span class="token string">"conc"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> sum<span class="token punctuation">(</span><span class="token operator">!</span>is.na<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
changeRecords <span class="token operator">&lt;-</span> gapply<span class="token punctuation">(</span> Quinidine<span class="token punctuation">,</span> FUN <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>frm<span class="token punctuation">)</span>
    any<span class="token punctuation">(</span>is.na<span class="token punctuation">(</span>frm<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"conc"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> is.na<span class="token punctuation">(</span>frm<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"dose"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Gasoline">

<a href="#Gasoline" class="help-page-title"><h2>Refinery yield of gasoline</h2></a>

<h3>Description</h3>

<p>The <code>Gasoline</code> data frame has 32 rows and 6 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>yield</dt>
<dd>
<p>a numeric vector giving the percentage of crude oil converted to
gasoline after distillation and fractionation
</p>
</dd>
<dt>endpoint</dt>
<dd>
<p>a numeric vector giving the temperature (degrees F) at which all
the gasoline is vaporized
</p>
</dd>
<dt>Sample</dt>
<dd>
<p>an ordered factor giving the inferred crude oil sample number
</p>
</dd>
<dt>API</dt>
<dd>
<p>a numeric vector giving the crude oil gravity (degrees API)
</p>
</dd>
<dt>vapor</dt>
<dd>
<p>a numeric vector giving the vapor pressure of the crude oil
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">f</mi></mrow><mi mathvariant="normal">/</mi><msup><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathrm{lbf}/\mathrm{in}^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1219em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm" style="margin-right:0.07778em;">lbf</span></span><span class="mord">/</span><span class="mord"><span class="mord"><span class="mord mathrm">in</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8719em;"><span style="top:-3.1208em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code>
</p>
</dd>
<dt>ASTM</dt>
<dd>
<p>a numeric vector giving the crude oil 10% point ASTM—the
temperature at which 10% of the crude oil has become vapor. 
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Prater (1955) provides data on crude oil properties and
gasoline yields.  Atkinson (1985)
uses these data to illustrate the use of diagnostics in multiple
regression analysis.  Three of the covariates—<code>API</code>,
<code>vapor</code>, and <code>ASTM</code>—measure characteristics of the
crude oil used to produce the gasoline.  The other covariate —
<code>endpoint</code>—is a characteristic of the refining process.
Daniel and Wood (1980) notice that the covariates characterizing
the crude oil occur in only ten distinct groups and conclude that the
data represent responses measured on ten different crude oil samples.
</p>


<h3>Source</h3>

<p>Prater, N. H. (1955), Estimate gasoline yields from crudes,
<em>Petroleum Refiner</em>, <b>35</b> (5).
</p>
<p>Atkinson, A. C. (1985), <em>Plots, Transformations, and
Regression</em>, Oxford Press, New York.
</p>
<p>Daniel, C. and Wood, F. S. (1980), <em>Fitting Equations to Data</em>,
Wiley, New York
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) <em>Modern Applied
Statistics with S (4th ed)</em>, Springer, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="getCovariate">

<a href="#getCovariate" class="help-page-title"><h2>Extract Covariate from an Object</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include <code>corStruct</code>, <code>corSpatial</code>,
<code>data.frame</code>, and <code>varFunc</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">getCovariate<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object with a <code>covariate</code> component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula specifying the covariate(s)
to be extracted. Defaults to <code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to evaluate the variables defined in
<code>form</code>. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. p. 100.  
</p>


<h3>See Also</h3>

<p><code><a href="#getCovariate.corStruct">getCovariate.corStruct</a></code>,
<code><a href="#getCovariate.data.frame">getCovariate.data.frame</a></code>,
<code><a href="#getCovariate.varFunc">getCovariate.varFunc</a></code>,
<code><a href="#getCovariateFormula">getCovariateFormula</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getCovariate.corStruct">

<a href="#getCovariate.corStruct" class="help-page-title"><h2>Extract corStruct Object Covariate</h2></a>

<h3>Description</h3>

<p>This method function extracts the covariate(s) associated with
<code>object</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
getCovariate<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>corStruct</code>
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>this argument is included to make the method function
compatible with the generic. It will be assigned the value of
<code>formula(object)</code> and should not be modified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
defined in <code>form</code>, in case <code>object</code> is not initialized and
the covariate needs to be evaluated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>when the correlation structure does not include a grouping factor, the
returned value will be a vector or a matrix with the covariate(s)
associated with <code>object</code>. If a grouping factor is present, the
returned value will be a list of vectors or matrices with the
covariate(s) corresponding to each grouping level.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#getCovariate">getCovariate</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
getCovariate<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getCovariate.data.frame">

<a href="#getCovariate.data.frame" class="help-page-title"><h2>Extract Data Frame Covariate</h2></a>

<h3>Description</h3>

<p>The right hand side of <code>form</code>, stripped of any conditioning
expression (i.e. an expression following a <code>|</code> operator), is
evaluated in <code>object</code>.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'data.frame'</span>
getCovariate<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula specifying the covariate to be
evaluated in <code>object</code>. Defaults to <code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>some methods for this generic require a separate data
frame. Not used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the value of the right hand side of <code>form</code>, stripped of
any conditional expression, evaluated in <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#getCovariateFormula">getCovariateFormula</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">getCovariate<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getCovariate.varFunc">

<a href="#getCovariate.varFunc" class="help-page-title"><h2>Extract varFunc Covariate</h2></a>

<h3>Description</h3>

<p>This method function extracts the covariate(s) associated with the
variance function represented by <code>object</code>, if any is present.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'varFunc'</span>
getCovariate<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>varFunc</code>,
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula specifying the covariate to be
evaluated in <code>object</code>. Defaults to <code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>some methods for this generic require a <code>data</code>
object.  Not used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>object</code> has a <code>covariate</code> attribute, its value is
returned; else <code>NULL</code> is returned.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Covariate.varFunc">covariate&lt;-.varFunc</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token punctuation">)</span>
covariate<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> Orthodont<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"age"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
getCovariate<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getCovariateFormula">

<a href="#getCovariateFormula" class="help-page-title"><h2>Extract Covariates Formula</h2></a>

<h3>Description</h3>

<p>The right hand side of <code>formula(object)</code>, without any
conditioning expressions (i.e. any expressions after a <code>|</code>
operator) is returned as a one-sided formula.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">getCovariateFormula<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object from which a formula can be extracted.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a one-sided formula describing the covariates associated with
<code>formula(object)</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#getCovariate">getCovariate</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">getCovariateFormula<span class="token punctuation">(</span>y <span class="token operator">~</span> x <span class="token operator">|</span> g<span class="token punctuation">)</span>
getCovariateFormula<span class="token punctuation">(</span>y <span class="token operator">~</span> x<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getData">

<a href="#getData" class="help-page-title"><h2>Extract Data from an Object</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include <code>gls</code>, <code>lme</code>,
and <code>lmList</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">getData<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object from which a data.frame can be extracted,
generally a fitted model object.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#getData.gls">getData.gls</a></code>,
<code><a href="#getData.lme">getData.lme</a></code>,
<code><a href="#getData.lmList">getData.lmList</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getData.gls">

<a href="#getData.gls" class="help-page-title"><h2>Extract gls Object Data</h2></a>

<h3>Description</h3>

<p>If present in the calling sequence used to produce <code>object</code>, the
data frame used to fit the model is obtained. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
getData<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>gls</code>, representing
a generalized least squares fitted linear model.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>if a <code>data</code> argument is present in the calling sequence that
produced <code>object</code>, the corresponding data frame (with
<code>na.action</code> and <code>subset</code> applied to it, if also present in
the call that produced <code>object</code>) is returned;
else, <code>NULL</code> is returned.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>, 
<code><a href="#getData">getData</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
getData<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getData.lme">

<a href="#getData.lme" class="help-page-title"><h2>Extract lme Object Data</h2></a>

<h3>Description</h3>

<p>If present in the calling sequence used to produce <code>object</code>, the
data frame used to fit the model is obtained. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
getData<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>lme</code>, representing
a linear mixed-effects fitted model.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>if a <code>data</code> argument is present in the calling sequence that
produced <code>object</code>, the corresponding data frame (with
<code>na.action</code> and <code>subset</code> applied to it, if also present in
the call that produced <code>object</code>) is returned;
else, <code>NULL</code> is returned.
</p>
<p>Note that as from version 3.1-102, this only omits rows omitted in the
fit if <code>na.action = na.omit</code>, and does not omit at all if
<code>na.action = na.exclude</code>.  That is generally what is wanted for
plotting, the main use of this function.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, 
<code><a href="#getData">getData</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Ovary<span class="token punctuation">,</span>
           random <span class="token operator">=</span> <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">)</span>
getData<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getData.lmList">

<a href="#getData.lmList" class="help-page-title"><h2>Extract lmList Object Data</h2></a>

<h3>Description</h3>

<p>If present in the calling sequence used to produce <code>object</code>, the
data frame used to fit the model is obtained. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
getData<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>lmList</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr></table>
<h3>Value</h3>

<p>if a <code>data</code> argument is present in the calling sequence that
produced <code>object</code>, the corresponding data frame (with
<code>na.action</code> and <code>subset</code> applied to it, if also present in
the call that produced <code>object</code>) is returned;
else, <code>NULL</code> is returned.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>, 
<code><a href="#getData">getData</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
getData<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getGroups">

<a href="#getGroups" class="help-page-title"><h2>Extract Grouping Factors from an Object</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include <code>corStruct</code>, <code>data.frame</code>,
<code>gls</code>, <code>lme</code>, <code>lmList</code>, and <code>varFunc</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">getGroups<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> level<span class="token punctuation">,</span> data<span class="token punctuation">,</span> sep<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula with a conditioning expression on its
right hand side (i.e. an expression involving the <code>|</code>
operator). Defaults to <code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a positive integer vector with the level(s) of grouping to
be used when multiple nested levels of grouping are present. This
argument is optional for most methods of this generic function and
defaults to all levels of nesting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to interpret the variables named in
<code>form</code>. Optional for most methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>character, the separator to use between group levels when
multiple levels are collapsed.  The default is <code>'/'</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 100, 461.  
</p>


<h3>See Also</h3>

<p><code><a href="#getGroupsFormula">getGroupsFormula</a></code>, <code><a href="#getGroups.data.frame">getGroups.data.frame</a></code>,
<code><a href="#getGroups.gls">getGroups.gls</a></code>, <code><a href="#getGroups.lmList">getGroups.lmList</a></code>,
<code><a href="#getGroups.lme">getGroups.lme</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getGroups.corStruct">

<a href="#getGroups.corStruct" class="help-page-title"><h2>Extract corStruct Groups</h2></a>

<h3>Description</h3>

<p>This method function extracts the grouping factor associated with
<code>object</code>, if any is present.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
getGroups<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> level<span class="token punctuation">,</span> data<span class="token punctuation">,</span> sep<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>corStruct</code>
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>this argument is included to make the method function
compatible with the generic. It will be assigned the value of
<code>formula(object)</code> and should not be modified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>this argument is included to make the method function
compatible with the generic and is not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
defined in <code>form</code>, in case <code>object</code> is not initialized and
the grouping factor needs to be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>character, the separator to use between group levels when
multiple levels are collapsed.  The default is <code>'/'</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if a grouping factor is present in the correlation structure
represented by <code>object</code>, the function returns the corresponding
factor vector; else the function returns <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#getGroups">getGroups</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
getGroups<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getGroups.data.frame">

<a href="#getGroups.data.frame" class="help-page-title"><h2>Extract Groups from a Data Frame</h2></a>

<h3>Description</h3>

<p>Each variable named in the expression after the <code>|</code> operator on
the right hand side of <code>form</code> is evaluated in <code>object</code>. If
more than one variable is indicated in <code>level</code> they are combined
into a data frame; else the selected variable is returned as a vector.
When multiple grouping levels are defined in <code>form</code> and
<code>level &gt; 1</code>, the levels of the returned factor are obtained by
pasting together the levels of the grouping factors of level greater
or equal to <code>level</code>, to ensure their uniqueness. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'data.frame'</span>
getGroups<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> level<span class="token punctuation">,</span> data<span class="token punctuation">,</span> sep<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula with a conditioning expression on its
right hand side (i.e. an expression involving the <code>|</code>
operator). Defaults to <code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a positive integer vector with the level(s) of grouping to
be used when multiple nested levels of grouping are present. Defaults
to all levels of nesting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>unused</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>character, the separator to use between group levels when
multiple levels are collapsed.  The default is <code>'/'</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>either a data frame with columns given by the grouping factors
indicated in <code>level</code>, from outer to inner, or, when a single
level is requested, a factor representing the selected grouping
factor. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 100, 461.  
</p>


<h3>See Also</h3>

<p><code><a href="#getGroupsFormula">getGroupsFormula</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">getGroups<span class="token punctuation">(</span>Pixel<span class="token punctuation">)</span>
getGroups<span class="token punctuation">(</span>Pixel<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getGroups.gls">

<a href="#getGroups.gls" class="help-page-title"><h2>Extract gls Object Groups</h2></a>

<h3>Description</h3>

<p>If present, the grouping factor associated to the correlation
structure for the linear model represented by <code>object</code> is extracted. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
getGroups<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> level<span class="token punctuation">,</span> data<span class="token punctuation">,</span> sep<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>gls</code>, representing
a generalized least squares fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula with a conditioning expression on its
right hand side (i.e. an expression involving the <code>|</code>
operator). Defaults to <code>formula(object)</code>.  Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a positive integer vector with the level(s) of grouping to
be used when multiple nested levels of grouping are present. This
argument is optional for most methods of this generic function and
defaults to all levels of nesting.  Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to interpret the variables named in
<code>form</code>. Optional for most methods.  Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>character, the separator to use between group levels when
multiple levels are collapsed.  The default is <code>'/'</code>.  Not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if the linear model represented by <code>object</code> incorporates a
correlation structure and the corresponding <code>corStruct</code> object
has a grouping factor, a vector with the group values is returned;
else, <code>NULL</code> is returned.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>, <code><a href="#corClasses">corClasses</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
getGroups<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getGroups.lme">

<a href="#getGroups.lme" class="help-page-title"><h2>Extract lme Object Groups</h2></a>

<h3>Description</h3>

<p>The grouping factors corresponding to the linear mixed-effects model
represented by <code>object</code> are extracted. If more than one level is
indicated in <code>level</code>, the corresponding grouping factors are
combined  into a data frame; else the selected grouping factor is
returned as a vector. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
getGroups<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> level<span class="token punctuation">,</span> data<span class="token punctuation">,</span> sep<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>lme</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>this argument is included to make the method function
compatible with the generic and is ignored in this method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping
to be extracted from <code>object</code>. Defaults to the highest or
innermost level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>unused</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>character, the separator to use between group levels when
multiple levels are collapsed.  The default is <code>'/'</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>either a data frame with columns given by the grouping factors
indicated in <code>level</code>, or, when a single level is requested, a
factor representing the selected grouping factor. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>pixel <span class="token operator">~</span> day <span class="token operator">+</span> day<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> Pixel<span class="token punctuation">,</span>
  random <span class="token operator">=</span> list<span class="token punctuation">(</span>Dog <span class="token operator">=</span> <span class="token operator">~</span>day<span class="token punctuation">,</span> Side <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
getGroups<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getGroups.lmList">

<a href="#getGroups.lmList" class="help-page-title"><h2>Extract lmList Object Groups</h2></a>

<h3>Description</h3>

<p>The grouping factor determining the partitioning of the observations
used to produce the <code>lm</code> components of <code>object</code> is
extracted.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
getGroups<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> level<span class="token punctuation">,</span> data<span class="token punctuation">,</span> sep<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>lmList</code>, representing
a list of <code>lm</code> objects with a common model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula with a conditioning expression on its
right hand side (i.e. an expression involving the <code>|</code>
operator). Defaults to <code>formula(object)</code>.  Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a positive integer vector with the level(s) of grouping to
be used when multiple nested levels of grouping are present. This
argument is optional for most methods of this generic function and
defaults to all levels of nesting.  Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to interpret the variables named in
<code>form</code>. Optional for most methods.  Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>character, the separator to use between group levels when
multiple levels are collapsed.  The default is <code>'/'</code>.  Not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the grouping factor corresponding to the <code>lm</code>
components of <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
getGroups<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getGroups.varFunc">

<a href="#getGroups.varFunc" class="help-page-title"><h2>Extract varFunc Groups</h2></a>

<h3>Description</h3>

<p>This method function extracts the grouping factor associated with the
variance function represented by <code>object</code>, if any is present.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'varFunc'</span>
getGroups<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">,</span> level<span class="token punctuation">,</span> data<span class="token punctuation">,</span> sep<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>varFunc</code>,
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula with a conditioning expression on its
right hand side (i.e. an expression involving the <code>|</code>
operator). Defaults to <code>formula(object)</code>.  Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a positive integer vector with the level(s) of grouping to
be used when multiple nested levels of grouping are present. This
argument is optional for most methods of this generic function and
defaults to all levels of nesting.  Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to interpret the variables named in
<code>form</code>. Optional for most methods.  Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>character, the separator to use between group levels when
multiple levels are collapsed.  The default is <code>'/'</code>.  Not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>object</code> has a <code>groups</code> attribute, its value is
returned; else <code>NULL</code> is returned.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Sex<span class="token punctuation">)</span>
vf1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>vf1<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
getGroups<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getGroupsFormula">

<a href="#getGroupsFormula" class="help-page-title"><h2>Extract Grouping Formula</h2></a>

<h3>Description</h3>

<p>The conditioning expression associated with <code>formula(object)</code>
(i.e. the expression after the <code>|</code> operator) is returned either as
a named list of one-sided formulas, or a single one-sided formula,
depending on the value of <code>asList</code>. The components of the
returned list are ordered from outermost to innermost level and are
named after the grouping factor expression.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">getGroupsFormula<span class="token punctuation">(</span>object<span class="token punctuation">,</span> asList<span class="token punctuation">,</span> sep<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object from which a formula can be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> the returned
value with be a list of formulas; else, if <code>FALSE</code> the returned
value will be a one-sided formula. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>character, the separator to use between group levels when
multiple levels are collapsed.  The default is <code>'/'</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a one-sided formula, or a list of one-sided formulas, with the
grouping structure associated with <code>formula(object)</code>. If no
conditioning expression is present in <code>formula(object)</code> a
<code>NULL</code> value is returned.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#getGroupsFormula">getGroupsFormula.gls</a></code>,
<code><a href="#getGroupsFormula">getGroupsFormula.lmList</a></code>,
<code><a href="#getGroupsFormula">getGroupsFormula.lme</a></code>,
<code><a href="#getGroupsFormula">getGroupsFormula.reStruct</a></code>,
<code><a href="#getGroups">getGroups</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">getGroupsFormula<span class="token punctuation">(</span>y <span class="token operator">~</span> x <span class="token operator">|</span> g1<span class="token operator">/</span>g2<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getResponse">

<a href="#getResponse" class="help-page-title"><h2>Extract Response Variable from an Object</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include <code>data.frame</code>, <code>gls</code>, <code>lme</code>,
and <code>lmList</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">getResponse<span class="token punctuation">(</span>object<span class="token punctuation">,</span> form<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional two-sided formula. Defaults to
<code>formula(object)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#getResponseFormula">getResponseFormula</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">getResponse<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getResponseFormula">

<a href="#getResponseFormula" class="help-page-title"><h2>Extract Formula Specifying Response Variable</h2></a>

<h3>Description</h3>

<p>The left hand side of <code>formula{object}</code> is returned as a
one-sided formula. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">getResponseFormula<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object from which a formula can be extracted.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a one-sided formula with the response variable associated with
<code>formula{object}</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#getResponse">getResponse</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">getResponseFormula<span class="token punctuation">(</span>y <span class="token operator">~</span> x <span class="token operator">|</span> g<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="getVarCov">

<a href="#getVarCov" class="help-page-title"><h2>Extract variance-covariance matrix</h2></a>

<h3>Description</h3>

<p>Extract the variance-covariance matrix from a fitted model, such as a
mixed-effects model.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">getVarCov<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'lme'</span>
getVarCov<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> individuals<span class="token punctuation">,</span>
    type <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"random.effects"</span><span class="token punctuation">,</span> <span class="token string">"conditional"</span><span class="token punctuation">,</span> <span class="token string">"marginal"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'gls'</span>
getVarCov<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> individual <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A fitted model.  Methods are available for models fit by
<code><a href="#lme">lme</a></code> and by <code><a href="#gls">gls</a></code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individuals</code></td>
<td>
<p>For models fit by <code><a href="#lme">lme</a></code> a vector of
levels of the grouping factor can be specified for the conditional
or marginal variance-covariance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individual</code></td>
<td>
<p>For models fit by <code><a href="#gls">gls</a></code> the only type of
variance-covariance matrix provided is the marginal
variance-covariance of the responses by group.  The
optional argument <code>individual</code> specifies the group of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>For models fit by <code><a href="#lme">lme</a></code> the <code>type</code>
argument specifies the type of variance-covariance matrix, either
<code>"random.effects"</code> for the random-effects variance-covariance
(the default), or <code>"conditional"</code> for the conditional.
variance-covariance of the responses or <code>"marginal"</code> for the
the marginal variance-covariance of the responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments for some methods, as described above</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A variance-covariance matrix or a list of variance-covariance matrices.
</p>


<h3>Author(s)</h3>

<p>Mary Lindstrom <a href="mailto:lindstro@biostat.wisc.edu">lindstro@biostat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#gls">gls</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">,</span> subset <span class="token operator">=</span> Sex <span class="token operator">==</span> <span class="token string">"Female"</span><span class="token punctuation">)</span>
getVarCov<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
getVarCov<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> individual <span class="token operator">=</span> <span class="token string">"F01"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"marginal"</span><span class="token punctuation">)</span>
getVarCov<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"conditional"</span><span class="token punctuation">)</span>
fm2 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
getVarCov<span class="token punctuation">(</span>fm2<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="gls">

<a href="#gls" class="help-page-title"><h2>Fit Linear Model Using Generalized Least Squares</h2></a>

<h3>Description</h3>

<p>This function fits a linear model using generalized least
squares. The errors are allowed to be correlated and/or have unequal
variances.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">gls<span class="token punctuation">(</span>model<span class="token punctuation">,</span> data<span class="token punctuation">,</span> correlation<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> method<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span>
    control<span class="token punctuation">,</span> verbose<span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'gls'</span>
update<span class="token punctuation">(</span>object<span class="token punctuation">,</span> model.<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> evaluate <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"gls"</code>, representing
a generalized least squares fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a two-sided linear formula object describing the
model, with the response on the left of a <code>~</code> operator and the
terms, separated by <code>+</code> operators, on the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.</code></td>
<td>
<p>Changes to the model – see <code><a href="https://r-universe.dev/manuals/stats.html#update.formula">update.formula</a></code> for
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables named in
<code>model</code>, <code>correlation</code>, <code>weights</code>, and
<code>subset</code>. By default the variables are taken from the
environment from which <code>gls</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional <code><a href="#corClasses">corStruct</a></code> object describing the
within-group correlation structure. See the documentation of
<code><a href="#corClasses">corClasses</a></code> for a description of the available <code>corStruct</code>
classes. If a grouping variable is to be used, it must be specified in
the <code>form</code> argument to the <code>corStruct</code>
constructor. Defaults to <code>NULL</code>, corresponding to uncorrelated 
errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional <code><a href="#varFunc">varFunc</a></code> object or one-sided formula
describing the within-group heteroscedasticity structure. If given as
a formula, it is used as the argument to <code><a href="#varFixed">varFixed</a></code>,
corresponding to fixed variance weights. See the documentation on
<code><a href="#varClasses">varClasses</a></code> for a description of the available <code><a href="#varFunc">varFunc</a></code>
classes. Defaults to <code>NULL</code>, corresponding to homoscedastic
errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating which subset of the rows of
<code>data</code> should  be  used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string.  If <code>"REML"</code> the model is fit by
maximizing the restricted log-likelihood.  If <code>"ML"</code> the
log-likelihood is maximized.  Defaults to <code>"REML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code><a href="https://r-universe.dev/manuals/stats.html#na.fail">na.fail</a></code>) causes
<code>gls</code> to print an error message and terminate if there are any
incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to
replace the default values returned by the function <code><a href="#glsControl">glsControl</a></code>.
Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> information on
the evolution of the iterative algorithm is printed. Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evaluate</code></td>
<td>
<p>If <code>TRUE</code> evaluate the new call else return the call.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#offset">offset</a></code> terms in <code>model</code> are an error since 3.1-157
(2022-03): previously they were silently ignored.
</p>


<h3>Value</h3>

<p>an object of class <code>"gls"</code> representing the linear model
fit. Generic functions such as <code>print</code>, <code>plot</code>, and 
<code>summary</code> have methods to show the results of the fit. See
<code><a href="#glsObject">glsObject</a></code> for the components of the fit. The functions
<code><a href="https://r-universe.dev/manuals/stats.html#residuals">resid</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#coef">coef</a></code> and <code><a href="https://r-universe.dev/manuals/stats.html#fitted.values">fitted</a></code>,
can be used to extract some of its components. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>The different correlation structures available for the
<code>correlation</code> argument are described in Box, G.E.P., Jenkins,
G.M., and Reinsel G.C. (1994), Littel, R.C., Milliken, G.A., Stroup,
W.W., and Wolfinger, R.D. (1996), and Venables, W.N. and Ripley,
B.D. (2002). The use of variance functions for linear 
and nonlinear models is presented in detail in Carroll, R.J. and Ruppert,
D. (1988) and Davidian, M. and Giltinan, D.M. (1995).  
</p>
<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day. 
</p>
<p>Carroll, R.J. and Ruppert, D. (1988) "Transformation and Weighting in
Regression", Chapman and Hall.
</p>
<p>Davidian, M. and Giltinan, D.M. (1995) "Nonlinear Mixed Effects Models
for Repeated Measurement Data", Chapman and Hall.
</p>
<p>Littel, R.C., Milliken, G.A., Stroup, W.W., and Wolfinger, R.D. (1996)
"SAS Systems for Mixed Models", SAS Institute.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 100, 461.  
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>,
<code><a href="#glsControl">glsControl</a></code>,
<code><a href="#glsObject">glsObject</a></code>,
<code><a href="#glsStruct">glsStruct</a></code>,
<code><a href="#plot.gls">plot.gls</a></code>, 
<code><a href="#predict.gls">predict.gls</a></code>, 
<code><a href="#qqnorm.gls">qqnorm.gls</a></code>, 
<code><a href="#residuals.gls">residuals.gls</a></code>, 
<code><a href="#summary.gls">summary.gls</a></code>, 
<code><a href="#varClasses">varClasses</a></code>,
<code><a href="#varFunc">varFunc</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># AR(1) errors within each Mare</span>
fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># variance increases as a power of the absolute fitted values</span>
fm2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="gls-internal">

<a href="#gls-internal" class="help-page-title"><h2>Auxiliary functions used by gls</h2></a>

<h3>Description</h3>

<p>These are functions used by <code>gls</code> to call its compiled C
code. They are exported to allow experimentation with modified versions.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">glsApVar<span class="token punctuation">(</span>glsSt<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> conLin <span class="token operator">=</span> attr<span class="token punctuation">(</span>glsSt<span class="token punctuation">,</span> <span class="token string">"conLin"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         .relStep <span class="token operator">=</span> .Machine<span class="token operator">$</span>double.eps<span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> minAbsPar <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> natural <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
glsEstimate<span class="token punctuation">(</span>object<span class="token punctuation">,</span> conLin <span class="token operator">=</span> attr<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">"conLin"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            control <span class="token operator">=</span> list<span class="token punctuation">(</span>singular.ok <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>glsSt, object</code></td>
<td>
<p>An object inheriting from  class
<code>"<a href="#glsStruct">glsStruct</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the estimated residual standard error: see
<code><a href="#glsObject">glsObject</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>A ‘condensed linear model’: see
<code><a href="#logLik.glsStruct">logLik.glsStruct</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.relStep, minAbsPar, natural</code></td>
<td>
<p>Control values: see 
<code><a href="#glsControl">glsControl</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>The relevant part of a <code><a href="#glsControl">glsControl</a></code> return value.</p>
</td>
</tr>
</table>
<hr>
</div>
<div class="container manual-page" id="glsControl">

<a href="#glsControl" class="help-page-title"><h2>Control Values for gls Fit</h2></a>

<h3>Description</h3>

<p>The values supplied in the function call replace the defaults and a
list with all possible arguments is returned. The returned list is
used as the <code>control</code> argument to the <code>gls</code> function.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">glsControl<span class="token punctuation">(</span>maxIter<span class="token punctuation">,</span> msMaxIter<span class="token punctuation">,</span> tolerance<span class="token punctuation">,</span> msTol<span class="token punctuation">,</span> msVerbose<span class="token punctuation">,</span>
           singular.ok<span class="token punctuation">,</span> returnObject <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> apVar<span class="token punctuation">,</span> .relStep<span class="token punctuation">,</span>
           opt <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"nlminb"</span><span class="token punctuation">,</span> <span class="token string">"optim"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> optimMethod<span class="token punctuation">,</span>
           minAbsParApVar<span class="token punctuation">,</span> natural<span class="token punctuation">,</span> sigma <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>maximum number of iterations for the <code>gls</code>
optimization algorithm. Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msMaxIter</code></td>
<td>
<p>maximum number of iterations
for the <code>opt</code>imization step inside the <code>gls</code>
optimization. Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>tolerance for the convergence criterion in the
<code>gls</code> algorithm. Default is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msTol</code></td>
<td>
<p>tolerance for the convergence criterion of the first outer
iteration when <code>optim</code> is used.  Default is 1e-7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msVerbose</code></td>
<td>
<p>a logical value passed as the <code>trace</code> control value to
the chosen <code>opt</code>imizer (see documentation on that function). Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>a logical value indicating whether non-estimable
coefficients (resulting from linear dependencies among the columns of
the regression matrix) should be allowed. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnObject</code></td>
<td>
<p>a logical value indicating whether the fitted
object should be returned when the maximum number of iterations is
reached without convergence of the algorithm. Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apVar</code></td>
<td>
<p>a logical value indicating whether the approximate
covariance matrix of the variance-covariance parameters should be
calculated.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.relStep</code></td>
<td>
<p>relative step for numerical derivatives
calculations. Default is <code>.Machine$double.eps^(1/3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>the optimizer to be used, either <code>"<a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a>"</code> (the
current default) or <code>"<a href="https://r-universe.dev/manuals/stats.html#optim">optim</a>"</code> (the previous default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimMethod</code></td>
<td>
<p>character - the optimization method to be used with
the <code><a href="https://r-universe.dev/manuals/stats.html#optim">optim</a></code> optimizer. The default is
<code>"BFGS"</code>.  An alternative is <code>"L-BFGS-B"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minAbsParApVar</code></td>
<td>
<p>numeric value - minimum absolute parameter value
in the approximate variance calculation.  The default is <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>natural</code></td>
<td>
<p>logical.  Should the natural parameterization be used
for the approximate variance calculations?  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>optionally a positive number to fix the residual error at.
If <code>NULL</code>, as by default, or <code>0</code>, sigma is estimated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components for each of the possible arguments.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>; the
<code>sigma</code> option: Siem Heisterkamp and Bert van Willigen.</p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># decrease the maximum number of iterations and request tracing</span>
glsControl<span class="token punctuation">(</span>msMaxIter <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> msVerbose <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="glsObject">

<a href="#glsObject" class="help-page-title"><h2>Fitted gls Object</h2></a>

<h3>Description</h3>

<p>An object returned by the <code><a href="#gls">gls</a></code> function, inheriting from class
<code>"gls"</code> and representing a generalized least squares fitted linear 
model. Objects of this class have methods for the generic functions 
<code>anova</code>, <code>coef</code>, <code>fitted</code>, <code>formula</code>,
<code>getGroups</code>, <code>getResponse</code>, <code>intervals</code>, <code>logLik</code>,
<code>plot</code>, <code>predict</code>, <code>print</code>, <code>residuals</code>,
<code>summary</code>, and <code>update</code>.   
</p>


<h3>Value</h3>

<p>The following components must be included in a legitimate <code>"gls"</code>
object. 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>apVar</code></td>
<td>
<p>an approximate covariance matrix for the
variance-covariance coefficients. If <code>apVar = FALSE</code> in the list
of control values used in the call to <code>gls</code>, this
component is equal to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a list containing an image of the <code>gls</code> call that
produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a vector with the estimated linear model
coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>a list of the contrast matrices used to represent factors
in the model formula. This information is important for making
predictions from a new data frame in which not all levels of the
original factors are observed. If no factors are used in the model,
this component will be an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dims</code></td>
<td>
<p>a list with basic dimensions used in the model fit,
including the components <code>N</code> - the number of observations in
the data and <code>p</code> - the number of coefficients in the linear
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>a vector with the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelStruct</code></td>
<td>
<p>an object inheriting from class <code>glsStruct</code>,
representing a list of linear model components, such as
<code>corStruct</code> and <code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a vector with the correlation structure grouping factor,
if any is present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the log-likelihood at convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the estimation method: either <code>"ML"</code> for maximum
likelihood, or <code>"REML"</code> for restricted maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numIter</code></td>
<td>
<p>the number of iterations used in the iterative
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>a vector with the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the estimated residual standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varBeta</code></td>
<td>
<p>an approximate covariance matrix of the
coefficients estimates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>, <code><a href="#glsStruct">glsStruct</a></code></p>

<hr>
</div>
<div class="container manual-page" id="glsStruct">

<a href="#glsStruct" class="help-page-title"><h2>Generalized Least Squares Structure</h2></a>

<h3>Description</h3>

<p>A generalized least squares structure is a list of model components
representing different sets of parameters in the linear 
model. A <code>glsStruct</code>  may contain <code>corStruct</code> and
<code>varFunc</code> objects. <code>NULL</code> arguments are not included in the
<code>glsStruct</code> list. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">glsStruct<span class="token punctuation">(</span>corStruct<span class="token punctuation">,</span> varStruct<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>corStruct</code></td>
<td>
<p>an optional <code>corStruct</code> object, representing a
correlation structure. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varStruct</code></td>
<td>
<p>an optional <code>varFunc</code> object, representing a
variance function structure. Default is <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of model variance-covariance components determining the
parameters to be estimated for the associated linear model.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>,
<code><a href="#gls">gls</a></code>,
<code><a href="#residuals.glsStruct">residuals.glsStruct</a></code>,
<code><a href="#varFunc">varFunc</a></code> </p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">gls1 <span class="token operator">&lt;-</span> glsStruct<span class="token punctuation">(</span>corAR1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Glucose">

<a href="#Glucose" class="help-page-title"><h2>Glucose levels over time</h2></a>

<h3>Description</h3>

<p>The <code>Glucose</code> data frame has 378 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Subject</dt>
<dd>
<p>an ordered factor with levels
<code>6</code> &lt; <code>2</code> &lt; <code>3</code> &lt; <code>5</code> &lt; <code>1</code> &lt; <code>4</code>
</p>
</dd>
<dt>Time</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>conc</dt>
<dd>
<p>a numeric vector of glucose levels
</p>
</dd>
<dt>Meal</dt>
<dd>
<p>an ordered factor with levels
<code>2am</code> &lt; <code>6am</code> &lt; <code>10am</code> &lt; <code>2pm</code> &lt; <code>6pm</code> &lt; <code>10pm</code>
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Hand, D. and Crowder, M. (1996), <em>Practical Longitudinal Data
Analysis</em>, Chapman and Hall, London.
</p>

<hr>
</div>
<div class="container manual-page" id="Glucose2">

<a href="#Glucose2" class="help-page-title"><h2>Glucose Levels Following Alcohol Ingestion</h2></a>

<h3>Description</h3>

<p>The <code>Glucose2</code> data frame has 196 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Subject</dt>
<dd>
<p>a factor with levels
<code>1</code> to <code>7</code> identifying the subject whose glucose
level is measured. 
</p>
</dd>
<dt>Date</dt>
<dd>
<p>a factor with levels
<code>1</code> 
<code>2</code>
indicating the occasion in which the experiment was conducted.
</p>
</dd>
<dt>Time</dt>
<dd>
<p>a numeric vector giving the time since alcohol ingestion (in min/10).
</p>
</dd>
<dt>glucose</dt>
<dd>
<p>a numeric vector giving the blood glucose level (in mg/dl).
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Hand and Crowder (Table A.14, pp. 180-181, 1996) describe data on
the blood glucose levels measured at 14 time points over 5 hours for 7
volunteers who took alcohol at time 0. The same experiment was
repeated on a second date with the same subjects but with a dietary
additive used for all subjects.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.10)
</p>
<p>Hand, D. and Crowder, M. (1996), <em>Practical Longitudinal Data
Analysis</em>, Chapman and Hall, London.
</p>

<hr>
</div>
<div class="container manual-page" id="gnls">

<a href="#gnls" class="help-page-title"><h2>Fit Nonlinear Model Using Generalized Least Squares</h2></a>

<h3>Description</h3>

<p>This function fits a nonlinear model using generalized least
squares. The errors are allowed to be correlated and/or have unequal
variances.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">gnls<span class="token punctuation">(</span>model<span class="token punctuation">,</span> data<span class="token punctuation">,</span> params<span class="token punctuation">,</span> start<span class="token punctuation">,</span> correlation<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> subset<span class="token punctuation">,</span>
     na.action<span class="token punctuation">,</span> naPattern<span class="token punctuation">,</span> control<span class="token punctuation">,</span> verbose<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a two-sided formula object describing the
model, with the response on the left of a <code>~</code> operator and 
a nonlinear expression involving parameters and covariates on the
right. If <code>data</code> is given, all names used in the formula should
be defined as parameters or variables in the data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables named in
<code>model</code>, <code>correlation</code>, <code>weights</code>, 
<code>subset</code>, and <code>naPattern</code>. By default the variables are 
taken from the environment from which <code>gnls</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>an optional two-sided linear formula of the form
<code>p1+...+pn~x1+...+xm</code>, or list of two-sided formulas of the form
<code>p1~x1+...+xm</code>, with possibly different models for each
parameter. The <code>p1,...,pn</code> represent parameters included on the
right hand side of <code>model</code> and <code>x1+...+xm</code> define a linear
model for the parameters (when the left hand side of the formula
contains several parameters, they are all assumed to follow the same
linear model described by the right hand side expression). A <code>1</code>
on the right hand side of the formula(s) indicates a single fixed
effects for the corresponding parameter(s). By default, the
parameters are obtained from the names of <code>start</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an optional named list, or numeric vector, with the
initial values for the parameters in <code>model</code>. It can be omitted
when a <code>selfStarting</code> function is used in <code>model</code>, in which
case the starting estimates will be obtained from a single call to the
<code>nls</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional <code>corStruct</code> object describing the
within-group correlation structure. See the documentation of
<code>corClasses</code> for a description of the available <code>corStruct</code>
classes. If a grouping variable is to be used, it must be specified
in the <code>form</code> argument to the <code>corStruct</code>
constructor. Defaults to <code>NULL</code>, corresponding to uncorrelated 
errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional <code>varFunc</code> object or one-sided formula
describing the within-group heteroscedasticity structure. If given as
a formula, it is used as the argument to <code>varFixed</code>,
corresponding to fixed variance weights. See the documentation on
<code>varClasses</code> for a description of the available <code>varFunc</code>
classes. Defaults to <code>NULL</code>, corresponding to homoscedastic
errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating which subset of the rows of
<code>data</code> should  be  used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>gnls</code> to print an error message and terminate if there are any
incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naPattern</code></td>
<td>
<p>an expression or formula object, specifying which returned
values are to be regarded as missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to
replace the default values returned by the function <code>gnlsControl</code>.
Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> information on
the evolution of the iterative algorithm is printed. Default is
<code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>gnls</code>, also inheriting from class <code>gls</code>,
representing the nonlinear model fit. Generic functions such as
<code>print</code>, <code>plot</code> and  <code>summary</code> have methods to show the
results of the fit. See <code>gnlsObject</code> for the components of the
fit. The functions <code>resid</code>, <code>coef</code>, and <code>fitted</code> can be
used to extract some of its components.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>The different correlation structures available for the
<code>correlation</code> argument are described in Box, G.E.P., Jenkins,
G.M., and Reinsel G.C. (1994), Littel, R.C., Milliken, G.A., Stroup,
W.W., and Wolfinger, R.D. (1996), and Venables, W.N. and Ripley,
B.D. (2002). The use of variance functions for linear 
and nonlinear models is presented in detail in Carrol, R.J. and Rupert,
D. (1988) and Davidian, M. and Giltinan, D.M. (1995).  
</p>
<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day. 
</p>
<p>Carrol, R.J. and Rupert, D. (1988) "Transformation and Weighting in
Regression", Chapman and Hall.
</p>
<p>Davidian, M. and Giltinan, D.M. (1995) "Nonlinear Mixed Effects Models
for Repeated Measurement Data", Chapman and Hall.
</p>
<p>Littel, R.C., Milliken, G.A., Stroup, W.W., and Wolfinger, R.D. (1996)
"SAS Systems for Mixed Models", SAS Institute.
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>,
<code><a href="#gnlsControl">gnlsControl</a></code>, <code><a href="#gnlsObject">gnlsObject</a></code>,
<code><a href="#gnlsStruct">gnlsStruct</a></code>,
<code><a href="#predict.gnls">predict.gnls</a></code>,
<code><a href="#varClasses">varClasses</a></code>,
<code><a href="#varFunc">varFunc</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># variance increases with a power of the absolute fitted values</span>
fm1 <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>weight <span class="token operator">~</span> SSlogis<span class="token punctuation">(</span>Time<span class="token punctuation">,</span> Asym<span class="token punctuation">,</span> xmid<span class="token punctuation">,</span> scal<span class="token punctuation">)</span><span class="token punctuation">,</span> Soybean<span class="token punctuation">,</span>
            weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="gnlsControl">

<a href="#gnlsControl" class="help-page-title"><h2>Control Values for gnls Fit</h2></a>

<h3>Description</h3>

<p>The values supplied in the function call replace the defaults and a
list with all possible arguments is returned. The returned list is
used as the <code>control</code> argument to the <code>gnls</code> function.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">gnlsControl<span class="token punctuation">(</span>maxIter <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> nlsMaxIter <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> msMaxIter <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> minScale <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">,</span>
            tolerance <span class="token operator">=</span> <span class="token number">1e-6</span><span class="token punctuation">,</span> nlsTol <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">,</span> msTol <span class="token operator">=</span> <span class="token number">1e-7</span><span class="token punctuation">,</span>
            returnObject <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> msVerbose <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
            apVar <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> .relStep <span class="token operator">=</span><span class="token punctuation">,</span>
            opt <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"nlminb"</span><span class="token punctuation">,</span> <span class="token string">"optim"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> optimMethod <span class="token operator">=</span> <span class="token string">"BFGS"</span><span class="token punctuation">,</span>
            minAbsParApVar <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">,</span> sigma <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>maximum number of iterations for the <code>gnls</code>
optimization algorithm.  Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlsMaxIter</code></td>
<td>
<p>maximum number of iterations
for the <code>nls</code> optimization step <em>inside</em> the <code>gnls</code>
optimization.  Default is 7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msMaxIter</code></td>
<td>
<p>maximum number of iterations
for the <code>opt</code>imization step inside the <code>gnls</code>
optimization.  Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minScale</code></td>
<td>
<p>minimum factor by which to shrink the default step size
in an attempt to decrease the sum of squares in the <code>nls</code> step.
Default 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>tolerance for the convergence criterion in the
<code>gnls</code> algorithm. Default is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlsTol</code></td>
<td>
<p>tolerance for the convergence criterion in <code>nls</code>
step. Default is 1e-3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msTol</code></td>
<td>
<p>tolerance for the convergence criterion of the first outer
iteration when <code>optim</code> is used.  Default is 1e-7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnObject</code></td>
<td>
<p>a logical value indicating whether the fitted
object should be returned with a <code><a href="https://r-universe.dev/manuals/base.html#warning">warning</a></code> (instead of an
error via <code><a href="https://r-universe.dev/manuals/base.html#stop">stop</a>()</code>) when the maximum number of
iterations is reached without convergence of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msVerbose</code></td>
<td>
<p>a logical value passed as the <code>trace</code> argument to
the optimizer chosen by <code>opt</code>; see documentation on that.
Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apVar</code></td>
<td>
<p>a logical value indicating whether the approximate
covariance matrix of the variance-covariance parameters should be
calculated.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.relStep</code></td>
<td>
<p>relative step for numerical derivatives
calculations.  Default is <code>.Machine$double.eps^(1/3)</code> (about 6e-6).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>the optimizer to be used, either <code>"<a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a>"</code> (the
current default) or <code>"<a href="https://r-universe.dev/manuals/stats.html#optim">optim</a>"</code> (the previous default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimMethod</code></td>
<td>
<p>character - the optimization method to be used with
the <code><a href="https://r-universe.dev/manuals/stats.html#optim">optim</a></code> optimizer. The default is
<code>"BFGS"</code>.  An alternative is <code>"L-BFGS-B"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minAbsParApVar</code></td>
<td>
<p>numeric value - minimum absolute parameter value
in the approximate variance calculation.  The default is <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>optionally a positive number to fix the residual error at.
If <code>NULL</code>, as by default, or <code>0</code>, sigma is estimated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components for each of the possible arguments.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>; the
<code>sigma</code> option: Siem Heisterkamp and Bert van Willigen.</p>


<h3>See Also</h3>

<p><code><a href="#gnls">gnls</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># decrease the maximum number of iterations and request tracing</span>
gnlsControl<span class="token punctuation">(</span>msMaxIter <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> msVerbose <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="gnlsObject">

<a href="#gnlsObject" class="help-page-title"><h2>Fitted gnls Object</h2></a>

<h3>Description</h3>

<p>An object returned by the <code>gnls</code> function, inheriting from class
<code>"gnls"</code> and also from class <code>"gls"</code>, and representing a
generalized nonlinear least squares fitted model. Objects of this
class have methods for the generic functions  <code>anova</code>,
<code>coef</code>, <code>fitted</code>, <code>formula</code>, <code>getGroups</code>,
<code>getResponse</code>, <code>intervals</code>, <code>logLik</code>, <code>plot</code>,
<code>predict</code>, <code>print</code>, <code>residuals</code>, <code>summary</code>, and
<code>update</code>.
</p>


<h3>Value</h3>

<p>The following components must be included in a legitimate <code>"gnls"</code>
object.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>apVar</code></td>
<td>
<p>an approximate covariance matrix for the
variance-covariance coefficients.  If <code>apVar = FALSE</code> in the
control values used in the call to <code>gnls</code>, this
component is equal to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a list containing an image of the <code>gnls</code> call that
produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a vector with the estimated nonlinear model
coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>a list of the contrast matrices used to represent factors
in the model formula. This information is important for making
predictions from a new data frame in which not all levels of the
original factors are observed. If no factors are used in the model,
this component will be an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dims</code></td>
<td>
<p>a list with basic dimensions used in the model fit,
including the components <code>N</code> - the number of observations used in
the fit and <code>p</code> - the number of coefficients in the nonlinear
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>a vector with the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelStruct</code></td>
<td>
<p>an object inheriting from class <code>gnlsStruct</code>,
representing a list of model components, such as <code>corStruct</code> and
<code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a vector with the correlation structure grouping factor,
if any is present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the log-likelihood at convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numIter</code></td>
<td>
<p>the number of iterations used in the iterative
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plist</code></td>
<td>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmap</code></td>
<td>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>a vector with the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the estimated residual standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varBeta</code></td>
<td>
<p>an approximate covariance matrix of the
coefficients estimates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gnls">gnls</a></code>, <code>gnlsStruct</code></p>

<hr>
</div>
<div class="container manual-page" id="gnlsStruct">

<a href="#gnlsStruct" class="help-page-title"><h2>Generalized Nonlinear Least Squares Structure</h2></a>

<h3>Description</h3>

<p>A generalized nonlinear least squares structure is a list of model
components representing different sets of parameters in the nonlinear 
model. A <code>gnlsStruct</code>  may contain <code>corStruct</code> and
<code>varFunc</code> objects. <code>NULL</code> arguments are not included in the
<code>gnlsStruct</code> list. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">gnlsStruct<span class="token punctuation">(</span>corStruct<span class="token punctuation">,</span> varStruct<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>corStruct</code></td>
<td>
<p>an optional <code>corStruct</code> object, representing a
correlation structure. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varStruct</code></td>
<td>
<p>an optional <code>varFunc</code> object, representing a
variance function structure. Default is <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of model variance-covariance components determining the
parameters to be estimated for the associated nonlinear model.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gnls">gnls</a></code>, <code><a href="#corClasses">corClasses</a></code>,
<code><a href="#residuals.gnlsStruct">residuals.gnlsStruct</a></code>
<code><a href="#varFunc">varFunc</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">gnls1 <span class="token operator">&lt;-</span> gnlsStruct<span class="token punctuation">(</span>corAR1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="groupedData">

<a href="#groupedData" class="help-page-title"><h2>Construct a groupedData Object</h2></a>

<h3>Description</h3>

<p>An object of the <code>groupedData</code> class is constructed from the
<code>formula</code> and <code>data</code> by attaching the <code>formula</code> as an
attribute of the data, along with any of <code>outer</code>, <code>inner</code>,
<code>labels</code>, and <code>units</code> that are given.  If
<code>order.groups</code> is <code>TRUE</code> the grouping factor is converted to
an ordered factor with the ordering determined by
<code>FUN</code>. Depending on the number of grouping levels and the type of
primary covariate, the returned object will be of one of three
classes: <code>nfnGroupedData</code> - numeric covariate, single level of
nesting; <code>nffGroupedData</code> - factor covariate, single level of
nesting; and <code>nmGroupedData</code> - multiple levels of
nesting. Several modeling and plotting functions can use the formula
stored with a <code>groupedData</code> object to construct default plots and
models. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">groupedData<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data<span class="token punctuation">,</span> order.groups<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span> outer<span class="token punctuation">,</span> inner<span class="token punctuation">,</span>
            labels<span class="token punctuation">,</span> units<span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'groupedData'</span>
update<span class="token punctuation">(</span>object<span class="token punctuation">,</span> formula<span class="token punctuation">,</span> data<span class="token punctuation">,</span> order.groups<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span>
       outer<span class="token punctuation">,</span> inner<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> units<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>groupedData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>resp ~ cov | group</code> where
<code>resp</code> is the response, <code>cov</code> is the primary covariate, and
<code>group</code> is the grouping factor.  The expression <code>1</code> can be
used for the primary covariate when there is no other suitable
candidate.  Multiple nested grouping factors can be listed separated
by the <code>/</code> symbol as in <code>fact1/fact2</code>.  In an expression
like this the <code>fact2</code> factor is nested within the <code>fact1</code>
factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which the expressions in <code>formula</code> can
be evaluated.  The resulting <code>groupedData</code> object will consist
of the same data values in the same order but with additional
attributes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.groups</code></td>
<td>
<p>an optional logical value, or list of logical
values, indicating if the grouping factors should be converted to
ordered factors according to the function <code>FUN</code> applied to the
response from each group. If multiple levels of grouping are present,
this argument can be either a single logical value (which will be
repeated for all grouping levels) or a list of logical values. If no
names are assigned to the list elements, they are assumed in the same
order as the group levels (outermost to innermost grouping). Ordering
within a level of grouping is done within the levels of the grouping
factors which are outer to it. Changing the grouping factor to an
ordered factor does not affect the ordering of the rows in the data
frame but it does affect the order of the panels in a trellis display
of the data or models fitted to the data.  Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>an optional summary function that will be applied to the
values of the response for each level of the grouping factor, when
<code>order.groups = TRUE</code>, to determine the ordering.  Defaults to
the <code>max</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer</code></td>
<td>
<p>an optional one-sided formula, or list of one-sided
formulas, indicating covariates that are outer to the grouping
factor(s).  If multiple levels of grouping are present,
this argument can be either a single one-sided formula, or a list of
one-sided formulas. If no names are assigned to the list elements,
they are assumed in the same order as the group levels (outermost to
innermost grouping). An outer covariate is invariant within the sets
of rows defined by the grouping factor.  Ordering of the groups is
done in such a way as to preserve adjacency of groups with the same
value of the outer variables.  When plotting a  groupedData object,
the argument <code>outer = TRUE</code> causes the panels to be determined
by the <code>outer</code> formula.  The points within the panels are 
associated by level of the grouping factor. Defaults to <code>NULL</code>,
meaning that no outer covariates are present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner</code></td>
<td>
<p>an optional one-sided formula, or list of one-sided
formulas, indicating covariates that are inner to the grouping
factor(s). If multiple levels of grouping are present,
this argument can be either a single one-sided formula, or a list of
one-sided formulas. If no names are assigned to the list elements,
they are assumed in the same order as the group levels (outermost to
innermost grouping). An inner covariate can change 
within the sets of rows defined by the grouping factor.  An inner
formula can be used to associate points in a plot of a groupedData
object.  Defaults to <code>NULL</code>, meaning that no inner covariates
are present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>an optional list of character strings giving labels for
the response and the primary covariate.  The label for the primary
covariate is named <code>x</code> and that for the response is named
<code>y</code>.  Either label can be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>an optional list of character strings giving the units for
the response and the primary covariate.  The units string for the
primary covariate is named <code>x</code> and that for the response is
named <code>y</code>.  Either units string can be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of one of the classes <code>nfnGroupedData</code>,
<code>nffGroupedData</code>, or <code>nmGroupedData</code>, and also inheriting
from  classes <code>groupedData</code> and <code>data.frame</code>. 
</p>


<h3>Author(s)</h3>

<p>Douglas Bates and José Pinheiro</p>


<h3>References</h3>

<p>Bates, D.M. and Pinheiro, J.C. (1997), "Software Design for Longitudinal
Data", in "Modelling Longitudinal and Spatially Correlated Data:
Methods, Applications and Future Directions", T.G. Gregoire (ed.),
Springer-Verlag, New York.
</p>
<p>Pinheiro, J.C. and Bates, D.M. (1997) "Future Directions in
Mixed-Effects Software: Design of NLME 3.0" available at
http://nlme.stat.wisc.edu/ 
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#formula">formula</a></code>, <code><a href="#gapply">gapply</a></code>,
<code><a href="#gsummary">gsummary</a></code>,
<code><a href="#lme">lme</a></code>,
<code><a href="#plot.nffGroupedData">plot.nffGroupedData</a></code>,
<code><a href="#plot.nfnGroupedData">plot.nfnGroupedData</a></code>,
<code><a href="#plot.nmGroupedData">plot.nmGroupedData</a></code>,
<code><a href="#reStruct">reStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">Orth.new <span class="token operator">&lt;-</span>  <span class="token comment"># create a new copy of the groupedData object</span>
  groupedData<span class="token punctuation">(</span> distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span>
              data <span class="token operator">=</span> as.data.frame<span class="token punctuation">(</span> Orthodont <span class="token punctuation">)</span><span class="token punctuation">,</span>
              FUN <span class="token operator">=</span> mean<span class="token punctuation">,</span>
              outer <span class="token operator">=</span> <span class="token operator">~</span> Sex<span class="token punctuation">,</span>
              labels <span class="token operator">=</span> list<span class="token punctuation">(</span> x <span class="token operator">=</span> <span class="token string">"Age"</span><span class="token punctuation">,</span>
                y <span class="token operator">=</span> <span class="token string">"Distance from pituitary to pterygomaxillary fissure"</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
              units <span class="token operator">=</span> list<span class="token punctuation">(</span> x <span class="token operator">=</span> <span class="token string">"(yr)"</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">"(mm)"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
plot<span class="token punctuation">(</span> Orth.new <span class="token punctuation">)</span>         <span class="token comment"># trellis plot by Subject</span>
formula<span class="token punctuation">(</span> Orth.new <span class="token punctuation">)</span>      <span class="token comment"># extractor for the formula</span>
gsummary<span class="token punctuation">(</span> Orth.new <span class="token punctuation">)</span>     <span class="token comment"># apply summary by Subject</span>
fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span> Orth.new <span class="token punctuation">)</span>   <span class="token comment"># fixed and groups formulae extracted from object</span>
Orthodont2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>Orthodont<span class="token punctuation">,</span> FUN <span class="token operator">=</span> mean<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="gsummary">

<a href="#gsummary" class="help-page-title"><h2>Summarize by Groups</h2></a>

<h3>Description</h3>

<p>Provide a summary of the variables in a data frame by groups of rows.
This is most useful with a <code>groupedData</code> object to examine the
variables by group.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">gsummary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span> omitGroupingFactor<span class="token punctuation">,</span> form<span class="token punctuation">,</span> level<span class="token punctuation">,</span>
   groups<span class="token punctuation">,</span> invariantsOnly<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object to be summarized - usually a <code>groupedData</code>
object or a <code>data.frame</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>an optional summary function or a list of summary functions
to be applied to each variable in the frame.  The function or
functions are applied only to variables in <code>object</code> that vary
within the groups defined by <code>groups</code>.  Invariant variables are
always summarized by group using the unique value that they assume
within that group.  If <code>FUN</code> is a single
function it will be applied to each non-invariant variable by group
to produce the summary for that variable.  If <code>FUN</code> is a list of
functions, the names in the list should designate classes of
variables in the frame such as <code>ordered</code>, <code>factor</code>, or
<code>numeric</code>.  The indicated function will be applied to any
non-invariant variables of that class.  The default functions to be
used are <code>mean</code> for numeric factors, and <code>Mode</code> for both
<code>factor</code> and <code>ordered</code>.  The <code>Mode</code> function, defined
internally in <code>gsummary</code>, returns the modal or most popular
value of the variable.  It is different from the <code>mode</code> function
that returns the S-language mode of the variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omitGroupingFactor</code></td>
<td>
<p>an optional logical value.  When <code>TRUE</code>
the grouping factor itself will be omitted from the group-wise
summary but the levels of the grouping factor will continue to be
used as the row names for the data frame that is produced by the
summary. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula that defines the groups.
When this formula is given, the right-hand side is evaluated in
<code>object</code>, converted to a factor if necessary, and the unique
levels are used to define the groups.  Defaults to
<code>formula(object)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional positive integer giving the level of grouping
to be used in an object with multiple nested grouping levels.
Defaults to the highest or innermost level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>an optional factor that will be used to split the 
rows into groups.  Defaults to <code>getGroups(object, form, level)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invariantsOnly</code></td>
<td>
<p>an optional logical value.  When <code>TRUE</code> only 
those covariates that are invariant within each group will be
summarized.  The summary value for the group is always the unique
value taken on by that covariate within the group.  The columns in
the summary are of the same class as the corresponding columns in
<code>object</code>. By definition, the grouping factor itself must be an
invariant.   When combined with <code>omitGroupingFactor = TRUE</code>,
this option can be used to discover is there are invariant covariates 
in the data frame.  Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional additional arguments to the summary functions
that are invoked on the variables by group.  Often it is helpful to
specify <code>na.rm = TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.frame</code> with one row for each level of the grouping
factor.  The number of columns is at most the number of columns in
<code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#summary">summary</a></code>, <code><a href="#groupedData">groupedData</a></code>,
<code><a href="#getGroups">getGroups</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">gsummary<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>  <span class="token comment"># default summary by Subject</span>
<span class="token comment">## gsummary with invariantsOnly = TRUE and omitGroupingFactor = TRUE</span>
<span class="token comment">## determines whether there are covariates like Sex that are invariant</span>
<span class="token comment">## within the repeated observations on the same Subject.</span>
gsummary<span class="token punctuation">(</span>Orthodont<span class="token punctuation">,</span> inv <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> omit <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Gun">

<a href="#Gun" class="help-page-title"><h2>Methods for firing naval guns</h2></a>

<h3>Description</h3>

<p>The <code>Gun</code> data frame has 36 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>rounds</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>Method</dt>
<dd>
<p>a factor with levels
<code>M1</code> 
<code>M2</code> 
</p>
</dd>
<dt>Team</dt>
<dd>
<p>an ordered factor with levels
<code>T1S</code> &lt; <code>T3S</code> &lt; <code>T2S</code> &lt; <code>T1A</code> &lt;
<code>T2A</code> &lt; <code>T3A</code> &lt; <code>T1H</code> &lt; <code>T3H</code> &lt;
<code>T2H</code>
</p>
</dd>
<dt>Physique</dt>
<dd>
<p>an ordered factor with levels
<code>Slight</code> &lt; <code>Average</code> &lt; <code>Heavy</code>
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Hicks (p.180, 1993) reports data from an experiment on
methods for firing naval guns. Gunners of three different physiques
(slight, average, and heavy) tested two firing methods. Both methods
were tested twice by each of nine teams of three gunners with
identical physique. The response was the number of rounds fired per
minute.</p>


<h3>Source</h3>

<p>Hicks, C. R. (1993), <em>Fundamental Concepts in the Design of
Experiments (4th ed)</em>, Harcourt Brace, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="IGF">

<a href="#IGF" class="help-page-title"><h2>Radioimmunoassay of IGF-I Protein</h2></a>

<h3>Description</h3>

<p>The <code>IGF</code> data frame has 237 rows and 3 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Lot</dt>
<dd>
<p>an ordered factor giving the radioactive tracer lot.
</p>
</dd>
<dt>age</dt>
<dd>
<p>a numeric vector giving the age (in days) of the radioactive
tracer.
</p>
</dd>
<dt>conc</dt>
<dd>
<p>a numeric vector giving the estimated concentration of IGF-I
protein (ng/ml)
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Davidian and Giltinan (1995) describe data obtained during quality
control radioimmunoassays for ten different lots of radioactive
tracer used to calibrate the Insulin-like Growth Factor (IGF-I)
protein concentration measurements. 
</p>


<h3>Source</h3>

<p>Davidian, M. and Giltinan, D. M. (1995), <em>Nonlinear Models for
Repeated Measurement Data</em>,  Chapman and Hall, London.
</p>
<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.11)
</p>

<hr>
</div>
<div class="container manual-page" id="Initialize">

<a href="#Initialize" class="help-page-title"><h2>Initialize Object</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include: <code>corStruct</code>, <code>lmeStruct</code>,
<code>reStruct</code>, and <code>varFunc</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Initialize<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object requiring initialization, e.g. "plug-in"
structures such as <code>corStruct</code> and <code>varFunc</code> objects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame to be used in the initialization procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an initialized object with the same class as <code>object</code>. Changes
introduced by the initialization procedure will depend on the method
function used; see the appropriate documentation. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#Initialize.lmeStruct">Initialize.lmeStruct</a></code>,
<code><a href="#Initialize.glsStruct">Initialize.glsStruct</a></code>, 
<code><a href="#Initialize.varFunc">Initialize.varFunc</a></code>, 
<code><a href="#isInitialized">isInitialized</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Initialize.corStruct">

<a href="#Initialize.corStruct" class="help-page-title"><h2>Initialize corStruct Object</h2></a>

<h3>Description</h3>

<p>This method initializes <code>object</code> by evaluating its associated
covariate(s) and grouping factor, if any is present, in <code>data</code>,
calculating various dimensions and constants used by optimization
algorithms involving <code>corStruct</code> objects (see the appropriate
<code>Dim</code> method documentation), and assigning initial values for
the coefficients in <code>object</code>, if none were present.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
Initialize<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to evaluate the variables defined in
<code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>this argument is included to make this method compatible
with the generic.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an initialized object with the same class as <code>object</code>
representing a correlation structure.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#Dim.corStruct">Dim.corStruct</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Initialize.glsStruct">

<a href="#Initialize.glsStruct" class="help-page-title"><h2>Initialize a glsStruct Object</h2></a>

<h3>Description</h3>

<p>The individual linear model components of the <code>glsStruct</code> list
are initialized.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'glsStruct'</span>
Initialize<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> control<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#glsStruct">glsStruct</a>"</code>,
representing a list of linear model components, such as
<code>corStruct</code> and <code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to evaluate the variables defined in
<code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>an optional list with control parameters for the
initialization and optimization algorithms used in
<code>gls</code>. Defaults to <code>list(singular.ok = FALSE)</code>, implying that linear dependencies are not allowed in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>glsStruct</code> object similar to <code>object</code>, but with
initialized model components. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>,
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#Initialize.varFunc">Initialize.varFunc</a></code>,
<code><a href="#Initialize">Initialize</a></code></p>

<hr>
</div>
<div class="container manual-page" id="Initialize.lmeStruct">

<a href="#Initialize.lmeStruct" class="help-page-title"><h2>Initialize an lmeStruct Object</h2></a>

<h3>Description</h3>

<p>The individual linear mixed-effects model components of the
<code>lmeStruct</code> list are initialized. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmeStruct'</span>
Initialize<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> groups<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> control<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmeStruct">lmeStruct</a>"</code>,
representing a list of linear mixed-effects model components, such as
<code>reStruct</code>, <code>corStruct</code>, and <code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to evaluate the variables defined in
<code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a data frame with the grouping factors corresponding to
the lme model associated with <code>object</code> as columns, sorted from
innermost to outermost grouping level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>an optional condensed linear model object, consisting of
a list with components <code>"Xy"</code>, corresponding to a regression
matrix (<code>X</code>) combined with a response vector (<code>y</code>), and 
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying lme model. Defaults to <code>attr(object, "conLin")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>an optional list with control parameters for the
initialization and optimization algorithms used in
<code>lme</code>. Defaults to <code>list(niterEM=20, gradHess=TRUE)</code>,
implying that 20 EM iterations are to be used in the derivation of
initial estimates for the coefficients of the <code>reStruct</code>
component of <code>object</code> and, if possible, numerical gradient
vectors and Hessian matrices for the log-likelihood function are to
be used in the optimization algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an <code>lmeStruct</code> object similar to <code>object</code>, but with
initialized model components. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#Initialize.reStruct">Initialize.reStruct</a></code>,
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>,
<code><a href="#Initialize.varFunc">Initialize.varFunc</a></code>, <code><a href="#Initialize">Initialize</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="Initialize.reStruct">

<a href="#Initialize.reStruct" class="help-page-title"><h2>Initialize reStruct Object</h2></a>

<h3>Description</h3>

<p>Initial estimates for the parameters in the <code>pdMat</code> objects
forming <code>object</code>, which have not yet been initialized, are
obtained using the methodology described in Bates and Pinheiro
(1998). These estimates may be refined using a series of EM
iterations, as described in Bates and Pinheiro (1998). The number of
EM iterations to be used is defined in <code>control</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
Initialize<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> control<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to evaluate the variables defined in
<code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>a condensed linear model object, consisting of a list
with components <code>"Xy"</code>, corresponding to a regression matrix
(<code>X</code>) combined with a response vector (<code>y</code>), and
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>an optional list with a single component <code>niterEM</code>
controlling the number of iterations for the EM algorithm used to
refine initial parameter estimates. It is given as a list for
compatibility with other <code>Initialize</code> methods. Defaults to
<code>list(niterEM = 20)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an <code>reStruct</code> object similar to <code>object</code>, but with all
<code>pdMat</code> components initialized.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#reStruct">reStruct</a></code>, <code><a href="#pdMat">pdMat</a></code>,
<code><a href="#Initialize">Initialize</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="Initialize.varFunc">

<a href="#Initialize.varFunc" class="help-page-title"><h2>Initialize varFunc Object</h2></a>

<h3>Description</h3>

<p>This method initializes <code>object</code> by evaluating its associated
covariate(s) and grouping factor, if any is present, in <code>data</code>;
determining if the covariate(s) need to be updated when the
values of the coefficients associated with <code>object</code> change;
initializing the log-likelihood and the weights associated with
<code>object</code>; and assigning initial values for the coefficients in
<code>object</code>, if none were present. The covariate(s) will only be
initialized if no update is needed when <code>coef(object)</code> changes. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'varFunc'</span>
Initialize<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#varFunc">varFunc</a>"</code>,
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to evaluate the variables named in
<code>formula(object)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>this argument is included to make this method compatible
with the generic.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an initialized object with the same class as <code>object</code>
representing a variance function structure.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Initialize">Initialize</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span> form <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Sex <span class="token punctuation">)</span>
vf1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span> vf1<span class="token punctuation">,</span> Orthodont <span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="intervals">

<a href="#intervals" class="help-page-title"><h2>Confidence Intervals on Coefficients</h2></a>

<h3>Description</h3>

<p>Confidence intervals on the parameters associated with the model
represented by <code>object</code> are obtained. This function is generic;
method functions can be written to handle specific classes of
objects. Classes which already have methods for this function include:
<code>gls</code>, <code>lme</code>, and <code>lmList</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">intervals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted model object from which parameter estimates can
be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional numeric value for the interval confidence
level. Defaults to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for the generic may require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#intervals.lme">intervals.lme</a></code>,
<code><a href="#intervals.lmList">intervals.lmList</a></code>,
<code><a href="#intervals.gls">intervals.gls</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="intervals.gls">

<a href="#intervals.gls" class="help-page-title"><h2>Confidence Intervals on gls Parameters</h2></a>

<h3>Description</h3>

<p>Approximate confidence intervals for the parameters in the linear
model represented by <code>object</code> are obtained, using
a normal approximation to the distribution of the (restricted)
maximum likelihood estimators (the estimators are assumed to have a
normal distribution centered at the true parameter values and with
covariance matrix equal to the negative inverse Hessian matrix of the
(restricted) log-likelihood evaluated at the estimated parameters).
Confidence intervals are obtained in an unconstrained scale first,
using the normal approximation, and, if necessary, transformed to the
constrained scale.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
intervals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level<span class="token punctuation">,</span> which<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gls">gls</a>"</code>, representing
a generalized least squares fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional numeric value for the interval confidence
level. Defaults to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an optional character string specifying the subset
of parameters for which to construct the confidence
intervals. Possible values are <code>"all"</code> for all parameters,
<code>"var-cov"</code> for the variance-covariance parameters only, and
<code>"coef"</code> for the linear model coefficients  only. Defaults to
<code>"all"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components given by data frames with rows corresponding to
parameters and columns <code>lower</code>, <code>est.</code>, and <code>upper</code>
representing respectively lower confidence limits, the estimated
values, and upper confidence limits for the parameters. Possible
components are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>linear model coefficients, only present when <code>which</code>
is not equal to <code>"var-cov"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corStruct</code></td>
<td>
<p>correlation parameters, only present when
<code>which</code> is not equal to <code>"coef"</code> and a 
correlation structure is used in <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varFunc</code></td>
<td>
<p>variance function parameters, only present when
<code>which</code> is not equal to <code>"coef"</code> and a variance function
structure is used in <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>residual standard error.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>, <code><a href="#intervals">intervals</a></code>,
<code><a href="#intervals.gls">print.intervals.gls</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
intervals<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="intervals.lme">

<a href="#intervals.lme" class="help-page-title"><h2>Confidence Intervals on lme Parameters</h2></a>

<h3>Description</h3>

<p>Approximate confidence intervals for the parameters in the linear
mixed-effects model represented by <code>object</code> are obtained, using
a normal approximation to the distribution of the (restricted)
maximum likelihood estimators (the estimators are assumed to have a
normal distribution centered at the true parameter values and with
covariance matrix equal to the negative inverse Hessian matrix of the
(restricted) log-likelihood evaluated at the estimated parameters).
Confidence intervals are obtained in an unconstrained scale first,
using the normal approximation, and, if necessary, transformed to the
constrained scale. The <code>pdNatural</code> parametrization is used for
general positive-definite matrices.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
intervals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0.95</span><span class="token punctuation">,</span>
          which <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"all"</span><span class="token punctuation">,</span> <span class="token string">"var-cov"</span><span class="token punctuation">,</span> <span class="token string">"fixed"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional numeric value with the confidence level for
the intervals.  Defaults to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an optional character string specifying the  subset
of parameters for which to construct the confidence
intervals. Possible values are <code>"all"</code> for all parameters,
<code>"var-cov"</code> for the variance-covariance parameters only, and
<code>"fixed"</code> for the fixed effects only.  Defaults to <code>"all"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components given by data frames with rows corresponding to
parameters and columns <code>lower</code>, <code>est.</code>, and <code>upper</code>
representing respectively lower confidence limits, the estimated
values, and upper confidence limits for the parameters. Possible
components are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>fixed effects, only present when <code>which</code> is not
equal to <code>"var-cov"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reStruct</code></td>
<td>
<p>random effects variance-covariance parameters, only
present when <code>which</code> is not equal to <code>"fixed"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corStruct</code></td>
<td>
<p>within-group correlation parameters, only
present when <code>which</code> is not equal to <code>"fixed"</code> and a
correlation structure is used in <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varFunc</code></td>
<td>
<p>within-group variance function parameters, only
present when <code>which</code> is not equal to <code>"fixed"</code> and a
variance function structure is used in <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>within-group standard deviation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#intervals">intervals</a></code>,
<code><a href="#intervals.lme">print.intervals.lme</a></code>,
<code><a href="#pdNatural">pdNatural</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
intervals<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="intervals.lmList">

<a href="#intervals.lmList" class="help-page-title"><h2>Confidence Intervals on lmList Coefficients</h2></a>

<h3>Description</h3>

<p>Confidence intervals on the linear model coefficients are obtained for
each <code>lm</code> component of <code>object</code> and organized into a three
dimensional array. The first dimension corresponding to the names
of the <code>object</code> components. The second dimension is given by
<code>lower</code>, <code>est.</code>, and <code>upper</code> corresponding,
respectively, to the lower confidence limit, estimated coefficient,
and upper confidence limit. The third dimension is given by the
coefficients names.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
intervals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0.95</span><span class="token punctuation">,</span> pool <span class="token operator">=</span> attr<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">"pool"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional numeric value with the confidence level for
the intervals.  Defaults to 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>an optional logical value indicating whether a pooled
estimate of the residual standard error should be used. Default is
<code>attr(object, "pool")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a three dimensional array with the confidence intervals and estimates
for the coefficients of each <code>lm</code> component of <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>, <code><a href="#intervals">intervals</a></code>,
<code><a href="#plot.intervals.lmList">plot.intervals.lmList</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
intervals<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="isBalanced">

<a href="#isBalanced" class="help-page-title"><h2>Check a Design for Balance</h2></a>

<h3>Description</h3>

<p>Check the design of the experiment or study for balance.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">isBalanced<span class="token punctuation">(</span>object<span class="token punctuation">,</span> countOnly<span class="token punctuation">,</span> level<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>groupedData</code> object containing a data frame and a
formula that describes the roles of variables in the data frame.  The
object will have one or more nested grouping factors and a primary
covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>countOnly</code></td>
<td>
<p>A logical value indicating if the check for balance
should only consider the number of observations at each level of the
grouping factor(s).  Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector specifying the desired
prediction levels. Levels increase from outermost to innermost
grouping, with level 0 representing the population (fixed effects)
predictions. Defaults to the innermost level.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A design is
balanced with respect to the grouping factor(s) if there are the same
number of observations at each distinct value of the grouping factor or
each combination of distinct levels of the nested grouping factors.  If
<code>countOnly</code> is <code>FALSE</code> the design is also checked for balance
with respect to the primary covariate, which is often the time of the
observation.  A design is balanced with respect to the grouping factor
and the covariate if the number of observations at each distinct level
(or combination of levels for nested factors) is constant and the times
at which the observations are taken (in general, the values of the
primary covariates) also are constant.
</p>


<h3>Value</h3>

<p><code>TRUE</code> or <code>FALSE</code> according to whether the data are balanced
or not
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#table">table</a></code>, <code><a href="#groupedData">groupedData</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">isBalanced<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>                    <span class="token comment"># should return TRUE</span>
isBalanced<span class="token punctuation">(</span>Orthodont<span class="token punctuation">,</span> countOnly <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>  <span class="token comment"># should return TRUE</span>
isBalanced<span class="token punctuation">(</span>Pixel<span class="token punctuation">)</span>                        <span class="token comment"># should return FALSE</span>
isBalanced<span class="token punctuation">(</span>Pixel<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>             <span class="token comment"># should return FALSE</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="isInitialized">

<a href="#isInitialized" class="help-page-title"><h2>Check if Object is Initialized</h2></a>

<h3>Description</h3>

<p>Checks if <code>object</code> has been initialized (generally through a call
to <code>Initialize</code>), by searching for components and attributes
which are modified during initialization.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">isInitialized<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object requiring initialization.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a logical value indicating whether <code>object</code> has been
initialized. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates </p>


<h3>See Also</h3>

<p><code><a href="#Initialize">Initialize</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdDiag<span class="token punctuation">(</span><span class="token operator">~</span>age<span class="token punctuation">)</span>
isInitialized<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="LDEsysMat">

<a href="#LDEsysMat" class="help-page-title"><h2>Generate system matrix for LDEs</h2></a>

<h3>Description</h3>

<p>Generate the system matrix for the linear differential equations
determined by a compartment model.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">LDEsysMat<span class="token punctuation">(</span>pars<span class="token punctuation">,</span> incidence<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>a numeric vector of parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incidence</code></td>
<td>
<p>an integer matrix with columns named <code>From</code>,
<code>To</code>, and <code>Par</code>.  Values in the <code>Par</code> column must
be in the range 1 to <code>length(pars)</code>.  
Values in the <code>From</code>
column must be between 1 and the number of compartments.
Values in the <code>To</code>
column must be between 0 and the number of compartments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A compartment model describes material transfer between <code>k</code>
in a system of <code>k</code> compartments to a linear system of differential
equations. Given a description of the system and a vector of parameter
values this function returns the system matrix.
</p>
<p>This function is intended for use in a general system for solving
compartment models, as described in Bates and Watts (1988).
</p>


<h3>Value</h3>

<p>A <code>k</code> by <code>k</code> numeric matrix.
</p>


<h3>Author(s)</h3>

<p>Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Bates, D. M. and Watts, D. G. (1988), <em>Nonlinear Regression
Analysis and Its Applications</em>, Wiley, New York.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># incidence matrix for a two compartment open system</span>
incidence <span class="token operator">&lt;-</span>
  matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> byrow <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
   dimnames <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"Par"</span><span class="token punctuation">,</span> <span class="token string">"From"</span><span class="token punctuation">,</span> <span class="token string">"To"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
incidence
LDEsysMat<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> incidence<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lme">

<a href="#lme" class="help-page-title"><h2>Linear Mixed-Effects Models</h2></a>

<h3>Description</h3>

<p>This generic function fits a linear mixed-effects model in the
formulation described in Laird and Ware (1982) but allowing for nested
random effects. The within-group errors are allowed to be correlated
and/or have unequal variances.
</p>
<p>The methods <code><a href="#lme.lmList">lme.lmList</a></code> and <code><a href="#lme.groupedData">lme.groupedData</a></code>
are documented separately.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">lme<span class="token punctuation">(</span>fixed<span class="token punctuation">,</span> data<span class="token punctuation">,</span> random<span class="token punctuation">,</span> correlation<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> method<span class="token punctuation">,</span>
    na.action<span class="token punctuation">,</span> control<span class="token punctuation">,</span> contrasts <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> keep.data <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'lme'</span>
update<span class="token punctuation">(</span>object<span class="token punctuation">,</span> fixed.<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> evaluate <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>lme</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>a two-sided linear formula object describing the
fixed-effects part of the model, with the response on the left of a
<code>~</code> operator and the terms, separated by <code>+</code> operators, on
the right, an <code>"<a href="#lmList">lmList</a>"</code> object, or a
<code>"<a href="#groupedData">groupedData</a>"</code> object.
</p>
<p>There is limited support for formulae such as <code>resp ~ 1</code> and
<code>resp ~ 0</code>, and less prior to version ‘<span class="samp">⁠3.1-112⁠</span>’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.</code></td>
<td>
<p>Changes to the fixed-effects formula – see
<code><a href="https://r-universe.dev/manuals/stats.html#update.formula">update.formula</a></code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables named in
<code>fixed</code>, <code>random</code>, <code>correlation</code>, <code>weights</code>, and
<code>subset</code>.  By default the variables are taken from the
environment from which <code>lme</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>optionally, any of the following: (i) a one-sided formula
of the form <code>~ x1 + ... + xn | g1/.../gm</code>, with <code>x1 + ... + xn</code>
specifying the model for the random effects and <code>g1/.../gm</code> the
grouping structure (<code>m</code> may be equal to 1, in which case no
<code>/</code> is required). The random effects formula will be repeated
for all levels of grouping, in the case of multiple levels of
grouping; (ii) a list of one-sided formulas of the form
<code>~ x1 + ... + xn | g</code>, with possibly different random effects models
for each grouping level. The order of nesting will be assumed the
same as the order of the elements in the list; (iii) a one-sided
formula of the form <code>~ x1 + ... + xn</code>, or a <code><a href="#pdMat">pdMat</a></code> object with
a formula (i.e. a non-<code>NULL</code> value for <code>formula(object)</code>),
or a list of such formulas or <code><a href="#pdMat">pdMat</a></code> objects. In this case, the
grouping structure formula will be derived from the data used to
fit the linear mixed-effects model, which should inherit from class
<code>"<a href="#groupedData">groupedData</a>"</code>; (iv) a named list of formulas or <code><a href="#pdMat">pdMat</a></code>
objects as in (iii), with the grouping factors as names. The order of
nesting will be assumed the same as the order of the order of the
elements in the list; (v) an <code><a href="#reStruct">reStruct</a></code> object. See the
documentation on <code>pdClasses</code> for a description of the available
<code><a href="#pdMat">pdMat</a></code> classes. Defaults to a formula consisting of the right
hand side of <code>fixed</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional <code><a href="#corClasses">corStruct</a></code> object describing the
within-group correlation structure. See the documentation of
<code><a href="#corClasses">corClasses</a></code> for a description of the available <code>corStruct</code>
classes. Defaults to <code>NULL</code>,
corresponding to no within-group correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional <code><a href="#varFunc">varFunc</a></code> object or one-sided formula
describing the within-group heteroscedasticity structure. If given as
a formula, it is used as the argument to <code><a href="#varFixed">varFixed</a></code>,
corresponding to fixed variance weights. See the documentation on
<code><a href="#varClasses">varClasses</a></code> for a description of the available <code><a href="#varFunc">varFunc</a></code>
classes. Defaults to <code>NULL</code>, corresponding to homoscedastic
within-group errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of
<code>data</code> that should be used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string.  If <code>"REML"</code> the model is fit by
maximizing the restricted log-likelihood.  If <code>"ML"</code> the
log-likelihood is maximized.  Defaults to <code>"REML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code><a href="https://r-universe.dev/manuals/stats.html#na.fail">na.fail</a></code>) causes
<code>lme</code> to print an error message and terminate if there are any
incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to
replace the default values returned by the function <code><a href="#lmeControl">lmeControl</a></code>.
Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code>
of <code><a href="https://r-universe.dev/manuals/stats.html#model.matrix">model.matrix.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.data</code></td>
<td>
<p>logical: should the <code>data</code> argument (if supplied
and a data frame) be saved as part of the model object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evaluate</code></td>
<td>
<p>If <code>TRUE</code> evaluate the new call else return the call.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#offset">offset</a></code> terms in <code>fixed</code> are an error since 3.1-157
(2022-03): previously they were silently ignored.
</p>


<h3>Value</h3>

<p>An object of class <code>"lme"</code> representing the linear mixed-effects
model fit. Generic functions such as <code>print</code>, <code>plot</code> and
<code>summary</code> have methods to show the results of the fit. See
<code><a href="#lmeObject">lmeObject</a></code> for the components of the fit. The functions
<code><a href="https://r-universe.dev/manuals/stats.html#residuals">resid</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#coef">coef</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#fitted.values">fitted</a></code>,
<code><a href="#fixed.effects">fixed.effects</a></code>, and
<code><a href="#random.effects">random.effects</a></code>  can be used to extract some of its components.
</p>


<h3>Note</h3>

<p>The function does not do any scaling internally: the optimization will
work best when the response is scaled so its variance is of the order
of one.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>The computational methods follow the general framework of Lindstrom
and Bates (1988). The model formulation is described in Laird and Ware
(1982).  The variance-covariance parametrizations are described in
Pinheiro and Bates (1996).  The different correlation structures
available for the <code>correlation</code> argument are described in Box,
Jenkins and Reinsel (1994), Littell <em>et al</em> (1996), and Venables and
Ripley (2002). The use of variance functions for linear and nonlinear
mixed effects models is presented in detail in Davidian and Giltinan
(1995).
</p>
<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden–Day. 
</p>
<p>Davidian, M. and Giltinan, D.M. (1995) "Nonlinear Mixed Effects Models
for Repeated Measurement Data", Chapman and Hall.
</p>
<p>Laird, N.M. and Ware, J.H. (1982) "Random-Effects Models for
Longitudinal Data", Biometrics, 38, 963–974.  
</p>
<p>Lindstrom, M.J. and Bates, D.M. (1988) "Newton-Raphson and EM
Algorithms for Linear Mixed-Effects Models for Repeated-Measures
Data", Journal of the American Statistical Association, 83,
1014–1022. 
</p>
<p>Littell, R.C., Milliken, G.A., Stroup, W.W., and Wolfinger, R.D. (1996)
"SAS Systems for Mixed Models", SAS Institute.
</p>
<p>Pinheiro, J.C. and Bates., D.M.  (1996) "Unconstrained
Parametrizations for Variance-Covariance Matrices", Statistics and
Computing, 6, 289–296.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>,
<code><a href="#lme.lmList">lme.lmList</a></code>,
<code><a href="#lme.groupedData">lme.groupedData</a></code>,
<code><a href="#lmeControl">lmeControl</a></code>,
<code><a href="#lmeObject">lmeObject</a></code>,
<code><a href="#lmeStruct">lmeStruct</a></code>,
<code><a href="#lmList">lmList</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#plot.lme">plot.lme</a></code>,
<code><a href="#predict.lme">predict.lme</a></code>,
<code><a href="#qqnorm.lme">qqnorm.lme</a></code>,
<code><a href="#residuals.lme">residuals.lme</a></code>,
<code><a href="#reStruct">reStruct</a></code>,
<code><a href="#simulate.lme">simulate.lme</a></code>,
<code><a href="#summary.lme">summary.lme</a></code>,
<code><a href="#varClasses">varClasses</a></code>, 
<code><a href="#varFunc">varFunc</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span> <span class="token comment"># random is ~ age</span>
fm2 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">+</span> Sex<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm2<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lme.groupedData">

<a href="#lme.groupedData" class="help-page-title"><h2>LME fit from groupedData Object</h2></a>

<h3>Description</h3>

<p>The response variable and primary covariate in <code>formula(fixed)</code>
are used to construct the fixed effects model formula. This formula
and the   <code>groupedData</code> object are passed as the <code>fixed</code> and
<code>data</code> arguments to <code>lme.formula</code>, together with any other
additional arguments in the function call. See the documentation on
<code>lme.formula</code> for a description of that function.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'groupedData'</span>
lme<span class="token punctuation">(</span>fixed<span class="token punctuation">,</span> data<span class="token punctuation">,</span> random<span class="token punctuation">,</span> correlation<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> 
    subset<span class="token punctuation">,</span> method<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span> control<span class="token punctuation">,</span> contrasts<span class="token punctuation">,</span> keep.data <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>a data frame inheriting from class <code>"<a href="#groupedData">groupedData</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>this argument is included for consistency with the generic
function. It is ignored in this method function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>optionally, any of the following: (i) a one-sided formula
of the form <code>~x1+...+xn | g1/.../gm</code>, with <code>x1+...+xn</code>
specifying the model for the random effects and <code>g1/.../gm</code> the
grouping structure (<code>m</code> may be equal to 1, in which case no
<code>/</code> is required). The random effects formula will be repeated
for all levels of grouping, in the case of multiple levels of
grouping; (ii) a list of one-sided formulas of the form
<code>~x1+...+xn | g</code>, with possibly different random effects models
for each grouping level. The order of nesting will be assumed the
same as the order of the elements in the list; (iii) a one-sided
formula of the form <code>~x1+...+xn</code>, or a <code>pdMat</code> object with
a formula (i.e. a non-<code>NULL</code> value for <code>formula(object)</code>),
or a list of such formulas or <code>pdMat</code> objects. In this case, the
grouping structure formula will be derived from the data used to
fit the linear mixed-effects model, which should inherit from class
<code>groupedData</code>; (iv) a named list of formulas or <code>pdMat</code>
objects as in (iii), with the grouping factors as names. The order of
nesting will be assumed the same as the order of the order of the
elements in the list; (v) an <code>reStruct</code> object. See the
documentation on <code>pdClasses</code> for a description of the available
<code>pdMat</code> classes. Defaults to a formula consisting of the right
hand side of <code>fixed</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional <code>corStruct</code> object describing the
within-group correlation structure. See the documentation of
<code>corClasses</code> for a description of the available <code>corStruct</code>
classes. Defaults to <code>NULL</code>,
corresponding to no within-group correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional <code>varFunc</code> object or one-sided formula
describing the within-group heteroscedasticity structure. If given as
a formula, it is used as the argument to <code>varFixed</code>,
corresponding to fixed variance weights. See the documentation on
<code>varClasses</code> for a description of the available <code>varFunc</code>
classes. Defaults to <code>NULL</code>, corresponding to homoscedastic
within-group errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of
<code>data</code> that should be used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string.  If <code>"REML"</code> the model is fit by
maximizing the restricted log-likelihood.  If <code>"ML"</code> the
log-likelihood is maximized.  Defaults to <code>"REML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>lme</code> to print an error message and terminate if there are any
incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to
replace the default values returned by the function <code>lmeControl</code>.
Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code>
of <code>model.matrix.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.data</code></td>
<td>
<p>logical: should the <code>data</code> argument (if supplied
and a data frame) be saved as part of the model object?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>lme</code> representing the linear mixed-effects
model fit. Generic functions such as <code>print</code>, <code>plot</code> and
<code>summary</code> have methods to show the results of the fit. See
<code>lmeObject</code> for the components of the fit. The functions
<code>resid</code>, <code>coef</code>, <code>fitted</code>, <code>fixed.effects</code>, and
<code>random.effects</code>  can be used to extract some of its components.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>The computational methods follow on the general framework of Lindstrom,
M.J. and Bates, D.M. (1988). The model formulation is described in
Laird, N.M. and Ware, J.H. (1982).  The variance-covariance
parametrizations are described in Pinheiro, J.C. and Bates., D.M.
(1996).  The different correlation structures available for the
<code>correlation</code> argument are described in Box, G.E.P., Jenkins,
G.M., and Reinsel G.C. (1994), Littel, R.C., Milliken, G.A., Stroup,
W.W., and Wolfinger, R.D. (1996), and Venables, W.N. and Ripley,
B.D. (2002). The use of variance functions for linear and nonlinear
mixed effects models is presented in detail in Davidian, M. and
Giltinan, D.M. (1995).
</p>
<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day. 
</p>
<p>Davidian, M. and Giltinan, D.M. (1995) "Nonlinear Mixed Effects Models
for Repeated Measurement Data", Chapman and Hall.
</p>
<p>Laird, N.M. and Ware, J.H. (1982) "Random-Effects Models for
Longitudinal Data", Biometrics, 38, 963-974.  
</p>
<p>Lindstrom, M.J. and Bates, D.M. (1988) "Newton-Raphson and EM
Algorithms for Linear Mixed-Effects Models for Repeated-Measures
Data", Journal of the American Statistical Association, 83,
1014-1022. 
</p>
<p>Littel, R.C., Milliken, G.A., Stroup, W.W., and Wolfinger, R.D. (1996)
"SAS Systems for Mixed Models", SAS Institute.
</p>
<p>Pinheiro, J.C. and Bates., D.M.  (1996) "Unconstrained
Parametrizations for Variance-Covariance Matrices", Statistics and
Computing, 6, 289-296.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#groupedData">groupedData</a></code>,
<code><a href="#lmeObject">lmeObject</a></code> </p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lme.lmList">

<a href="#lme.lmList" class="help-page-title"><h2>LME fit from lmList Object</h2></a>

<h3>Description</h3>

<p>If the random effects names defined in <code>random</code> are a subset of
the <code>lmList</code> object coefficient names, initial estimates for the
covariance matrix of the random effects are obtained (overwriting any
values given in <code>random</code>). <code>formula(fixed)</code> and the
<code>data</code> argument in the calling sequence used to obtain
<code>fixed</code> are passed as the <code>fixed</code> and <code>data</code> arguments
to <code>lme.formula</code>, together with any other additional arguments in
the function call. See the documentation on <code>lme.formula</code> for a
description of that function. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
lme<span class="token punctuation">(</span>fixed<span class="token punctuation">,</span> data<span class="token punctuation">,</span> random<span class="token punctuation">,</span> correlation<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> method<span class="token punctuation">,</span>
    na.action<span class="token punctuation">,</span> control<span class="token punctuation">,</span> contrasts<span class="token punctuation">,</span> keep.data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>."</code>,
representing a list of <code>lm</code> fits with a common model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>this argument is included for consistency with the generic
function. It is ignored in this method function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>an optional one-sided linear formula with no conditioning
expression, or a <code>pdMat</code> object with a <code>formula</code>
attribute. Multiple levels of grouping are not allowed with this
method function.  Defaults to a formula consisting of the right hand
side of <code>formula(fixed)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional <code>corStruct</code> object describing the
within-group correlation structure. See the documentation of
<code>corClasses</code> for a description of the available <code>corStruct</code>
classes. Defaults to <code>NULL</code>,
corresponding to no within-group correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional <code>varFunc</code> object or one-sided formula
describing the within-group heteroscedasticity structure. If given as
a formula, it is used as the argument to <code>varFixed</code>,
corresponding to fixed variance weights. See the documentation on
<code>varClasses</code> for a description of the available <code>varFunc</code>
classes. Defaults to <code>NULL</code>, corresponding to homoscedastic
within-group errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of
<code>data</code> that should be used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string.  If <code>"REML"</code> the model is fit by
maximizing the restricted log-likelihood.  If <code>"ML"</code> the
log-likelihood is maximized.  Defaults to <code>"REML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>lme</code> to print an error message and terminate if there are any
incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to
replace the default values returned by the function <code>lmeControl</code>.
Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code>
of <code>model.matrix.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.data</code></td>
<td>
<p>logical: should the <code>data</code> argument (if supplied
and a data frame) be saved as part of the model object?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>lme</code> representing the linear mixed-effects
model fit. Generic functions such as <code>print</code>, <code>plot</code> and
<code>summary</code> have methods to show the results of the fit. See
<code>lmeObject</code> for the components of the fit. The functions
<code>resid</code>, <code>coef</code>, <code>fitted</code>, <code>fixed.effects</code>, and
<code>random.effects</code>  can be used to extract some of its components.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas
Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>
</p>


<h3>References</h3>

<p>The computational methods follow the general framework of Lindstrom
and Bates (1988). The model formulation is described in Laird and Ware
(1982).  The variance-covariance parametrizations are described in
Pinheiro and Bates (1996).  The different correlation structures
available for the <code>correlation</code> argument are described in Box,
Jenkins and Reinse (1994), Littel <em>et al</em> (1996), and Venables and
Ripley, (2002). The use of variance functions for linear and nonlinear
mixed effects models is presented in detail in Davidian and Giltinan
(1995).
</p>
<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden–Day. 
</p>
<p>Davidian, M. and Giltinan, D.M. (1995) "Nonlinear Mixed Effects Models
for Repeated Measurement Data", Chapman and Hall.
</p>
<p>Laird, N.M. and Ware, J.H. (1982) "Random-Effects Models for
Longitudinal Data", Biometrics, 38, 963–974.  
</p>
<p>Lindstrom, M.J. and Bates, D.M. (1988) "Newton-Raphson and EM
Algorithms for Linear Mixed-Effects Models for Repeated-Measures
Data", Journal of the American Statistical Association, 83,
1014–1022. 
</p>
<p>Littel, R.C., Milliken, G.A., Stroup, W.W., and Wolfinger, R.D. (1996)
"SAS Systems for Mixed Models", SAS Institute.
</p>
<p>Pinheiro, J.C. and Bates., D.M.  (1996) "Unconstrained
Parametrizations for Variance-Covariance Matrices", Statistics and
Computing, 6, 289–296.
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#lmList">lmList</a></code>,
<code><a href="#lmeObject">lmeObject</a></code> </p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>
fm2 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm2<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lmeControl">

<a href="#lmeControl" class="help-page-title"><h2>Specifying Control Values for lme Fit</h2></a>

<h3>Description</h3>

<p>The values supplied in the <code>lmeControl()</code> call replace the
defaults, and a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> with all settings (i.e., values for
all possible arguments) is returned.  The returned list is
used as the <code>control</code> argument to the <code>lme</code> function.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">lmeControl<span class="token punctuation">(</span>maxIter <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> msMaxIter <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">1e-6</span><span class="token punctuation">,</span> niterEM <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">,</span>
           msMaxEval <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span>
	   msTol <span class="token operator">=</span> <span class="token number">1e-7</span><span class="token punctuation">,</span> msVerbose <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
           returnObject <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> gradHess <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> apVar <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
	   .relStep <span class="token operator">=</span> .Machine<span class="token operator">$</span>double.eps<span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> minAbsParApVar <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">,</span>
           opt <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"nlminb"</span><span class="token punctuation">,</span> <span class="token string">"optim"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	   optimMethod <span class="token operator">=</span> <span class="token string">"BFGS"</span><span class="token punctuation">,</span> natural <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
	   sigma <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
           allow.n.lt.q <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
           <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>maximum number of iterations for the <code>lme</code>
optimization algorithm.  Default is <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msMaxIter</code></td>
<td>
<p>maximum number of iterations
for the optimization step inside the <code>lme</code> optimization.
Default is <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>tolerance for the convergence criterion in the
<code>lme</code> algorithm. Default is <code>1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niterEM</code></td>
<td>
<p>number of iterations for the EM algorithm used to refine
the initial estimates of the random effects variance-covariance
coefficients.  Default is <code>25</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msMaxEval</code></td>
<td>
<p>maximum number of evaluations of the objective
function permitted for nlminb.  Default is <code>200</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msTol</code></td>
<td>
<p>tolerance for the convergence criterion on the first
iteration when <code>optim</code> is used.  Default is <code>1e-7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msVerbose</code></td>
<td>
<p>a logical value passed as the <code>trace</code> argument to
<code><a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a></code> or <code><a href="https://r-universe.dev/manuals/stats.html#optim">optim</a></code>.  Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnObject</code></td>
<td>
<p>a logical value indicating whether the fitted
object should be returned with a <code><a href="https://r-universe.dev/manuals/base.html#warning">warning</a></code> (instead of an
error via <code><a href="https://r-universe.dev/manuals/base.html#stop">stop</a>()</code>) when the maximum number of
iterations is reached without convergence of the algorithm.  Default
is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradHess</code></td>
<td>
<p>a logical value indicating whether numerical gradient
vectors and Hessian matrices of the log-likelihood function should
be used in the internal optimization.  This option is only available
when the correlation structure (<code>corStruct</code>) and the variance
function structure (<code>varFunc</code>) have no "varying" parameters and
the <code>pdMat</code> classes used in the random effects structure are
<code>pdSymm</code> (general positive-definite), <code>pdDiag</code> (diagonal),
<code>pdIdent</code> (multiple of the identity),  or
<code>pdCompSymm</code> (compound symmetry).  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apVar</code></td>
<td>
<p>a logical value indicating whether the approximate
covariance matrix of the variance-covariance parameters should be
calculated.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.relStep</code></td>
<td>
<p>relative step for numerical derivatives
calculations.  Default is <code>.Machine$double.eps^(1/3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>the optimizer to be used, either <code>"<a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a>"</code> (the
default) or <code>"<a href="https://r-universe.dev/manuals/stats.html#optim">optim</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimMethod</code></td>
<td>
<p>character - the optimization method to be used with
the <code><a href="https://r-universe.dev/manuals/stats.html#optim">optim</a></code> optimizer.  The default is
<code>"BFGS"</code>.  An alternative is <code>"L-BFGS-B"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minAbsParApVar</code></td>
<td>
<p>numeric value - minimum absolute parameter value
in the approximate variance calculation.  The default is <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>natural</code></td>
<td>
<p>a logical value indicating whether the <code>pdNatural</code>
parametrization should be used for general positive-definite matrices
(<code>pdSymm</code>) in <code>reStruct</code>, when the approximate covariance
matrix of the estimators is calculated.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>optionally a positive number to fix the residual error at.
If <code>NULL</code>, as by default, or <code>0</code>, sigma is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow.n.lt.q</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if it is ok to have
less observations than random effects for each group.  The default,
<code>FALSE</code> signals an error; if <code>NA</code>, such a situation only gives
a warning, as in <span class="pkg">nlme</span> versions prior to 2019; if true, no message
is given at all.</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further named control arguments to be passed, depending on
<code>opt</code>, to <code><a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a></code> (those from <code>abs.tol</code> down)
or <code><a href="https://r-universe.dev/manuals/stats.html#optim">optim</a></code> (those except <code>trace</code> and <code>maxit</code>;
<code>reltol</code> is used only from the second iteration).</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a list with components for each of the possible arguments.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>; the
<code>sigma</code> option: Siem Heisterkamp and Bert van Willigen.</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#optim">optim</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># decrease the maximum number iterations in the ms call and</span><span class="token comment"># request that information on the evolution of the ms iterations be printed</span>
str<span class="token punctuation">(</span>lCtr <span class="token operator">&lt;-</span> lmeControl<span class="token punctuation">(</span>msMaxIter <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> msVerbose <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## This should always work:</span>
do.call<span class="token punctuation">(</span>lmeControl<span class="token punctuation">,</span> lCtr<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lmeObject">

<a href="#lmeObject" class="help-page-title"><h2>Fitted lme Object</h2></a>

<h3>Description</h3>

<p>An object returned by the <code>lme</code> function, inheriting from class
<code>"lme"</code> and representing a fitted linear mixed-effects
model.  Objects of this class have methods for the generic functions
<code>anova</code>, <code>coef</code>, <code>fitted</code>, <code>fixed.effects</code>,
<code>formula</code>, <code>getGroups</code>, <code>getResponse</code>,
<code>intervals</code>, <code>logLik</code>, <code>pairs</code>, <code>plot</code>,
<code>predict</code>, <code>print</code>, <code>random.effects</code>, <code>residuals</code>,
<code>sigma</code>, <code>summary</code>, <code>update</code>, and <code>vcov</code>.
</p>


<h3>Value</h3>

<p>The following components must be included in a legitimate <code>"lme"</code>
object.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>apVar</code></td>
<td>
<p>an approximate covariance matrix for the
variance-covariance coefficients.  If <code>apVar = FALSE</code> in the
control values used in the call to <code>lme</code>, this component is
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a list containing an image of the <code>lme</code> call that
produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a list with two components, <code>fixed</code> and
<code>random</code>, where the first is a vector containing the estimated
fixed effects and the second is a list of matrices with the estimated
random effects for each level of grouping. For each matrix in the
<code>random</code> list, the columns refer to the random effects and the
rows to the groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>a list of the contrast matrices used to represent factors
in the fixed effects formula  and/or random effects formula. This
information is important for making predictions from a new data
frame in which not all levels of the original factors are
observed. If no factors are used in the lme model, this component
will be an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dims</code></td>
<td>
<p>a list with basic dimensions used in the lme fit,
including the components <code>N</code> - the number of observations in
the data, <code>Q</code> - the number of grouping levels, <code>qvec</code> -
the number of random effects at each level from innermost to
outermost (last two values are equal to zero and correspond to the
fixed effects and the response), <code>ngrps</code> - the number of groups
at each level from innermost to outermost (last two values are one
and correspond to the fixed effects and the response), and
<code>ncol</code> - the number of columns in the model matrix for each
level of grouping from innermost to outermost (last two values are
equal to the number of fixed effects and one).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>a data frame with the fitted values as columns. The
leftmost column corresponds to the population fixed effects
(corresponding to the fixed effects only) and successive columns
from left to right correspond to increasing levels of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixDF</code></td>
<td>
<p>a list with components <code>X</code> and <code>terms</code>
specifying the denominator degrees of freedom for, respectively,
t-tests for the individual fixed effects and F-tests for the
fixed-effects terms in the models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a data frame with the grouping factors as
columns. The grouping level increases from left to right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the (restricted) log-likelihood at convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the estimation method: either <code>"ML"</code> for maximum
likelihood, or <code>"REML"</code> for restricted maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelStruct</code></td>
<td>
<p>an object inheriting from class <code>lmeStruct</code>,
representing a list of mixed-effects model components, such
as <code>reStruct</code>, <code>corStruct</code>, and <code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numIter</code></td>
<td>
<p>the number of iterations used in the iterative
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>a data frame with the residuals as columns. The
leftmost column corresponds to the population residuals
and successive columns from left to right correspond to increasing
levels of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the estimated within-group error standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varFix</code></td>
<td>
<p>an approximate covariance matrix of the
fixed effects estimates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code>lmeStruct</code></p>

<hr>
</div>
<div class="container manual-page" id="lmeStruct">

<a href="#lmeStruct" class="help-page-title"><h2>Linear Mixed-Effects Structure</h2></a>

<h3>Description</h3>

<p>A linear mixed-effects structure is a list of model components
representing different sets of parameters in the linear mixed-effects
model. An <code>lmeStruct</code> list must contain at least a
<code>reStruct</code> object, but may also contain <code>corStruct</code> and
<code>varFunc</code> objects. <code>NULL</code> arguments are not included in the
<code>lmeStruct</code> list. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">lmeStruct<span class="token punctuation">(</span>reStruct<span class="token punctuation">,</span> corStruct<span class="token punctuation">,</span> varStruct<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reStruct</code></td>
<td>
<p>a <code>reStruct</code> representing a random effects
structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corStruct</code></td>
<td>
<p>an optional <code>corStruct</code> object, representing a
correlation structure. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varStruct</code></td>
<td>
<p>an optional <code>varFunc</code> object, representing a
variance function structure. Default is <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of model components determining the parameters to be estimated
for the associated linear mixed-effects model.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>,
<code><a href="#lme">lme</a></code>,
<code><a href="#residuals.lmeStruct">residuals.lmeStruct</a></code>,
<code><a href="#reStruct">reStruct</a></code>,
<code><a href="#varFunc">varFunc</a></code> </p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">lms1 <span class="token operator">&lt;-</span> lmeStruct<span class="token punctuation">(</span>reStruct<span class="token punctuation">(</span><span class="token operator">~</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> corAR1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lmList">

<a href="#lmList" class="help-page-title"><h2>List of lm Objects with a Common Model</h2></a>

<h3>Description</h3>

<p><code>Data</code> is partitioned according to the levels of the grouping
factor <code>g</code> and individual <code>lm</code> fits are obtained for each
<code>data</code> partition, using the model defined in <code>object</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">lmList<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> level<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> na.action <span class="token operator">=</span> na.fail<span class="token punctuation">,</span>
       pool <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> warn.lm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'lmList'</span>
update<span class="token punctuation">(</span>object<span class="token punctuation">,</span> formula.<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> evaluate <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'lmList'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> pool<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>For <code>lmList</code>,
either a linear formula object of the form <code>y ~ x1+...+xn | g</code>
or a <code>groupedData</code> object. In the formula object, <code>y</code>
represents the response, <code>x1,...,xn</code> the covariates, and
<code>g</code> the grouping factor specifying the partitioning of the data
according to which different <code>lm</code> fits should be performed. The
grouping factor <code>g</code> may be omitted from the formula, in which
case the grouping structure will be obtained from <code>data</code>, which
must inherit from class <code>groupedData</code>.  The method function
<code><a href="#lmList.groupedData">lmList.groupedData</a></code> is documented separately.
For the method <code>update.lmList</code>, <code>object</code> is an object
inheriting from class <code>lmList</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>(used in <code>update.lmList</code> only)
a two-sided linear formula with the common model for the individuals
<code>lm</code> fits.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.</code></td>
<td>
<p>Changes to the formula – see <code>update.formula</code> for
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame in which to interpret the variables named in
<code>object</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>an optional integer specifying the level of grouping to be used when
multiple nested levels of grouping are present.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating which subset of the rows of
<code>data</code> should  be  used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>lmList</code> to print an error message and terminate if there are any
incomplete observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>

<p>an optional logical value indicating whether a pooled
estimate of the residual standard error should be used
in calculations of standard deviations or standard errors for
summaries.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn.lm</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if <code><a href="https://r-universe.dev/manuals/stats.html#lm">lm</a>()</code>
errors (all of which are caught by <code><a href="https://r-universe.dev/manuals/base.html#conditions">tryCatch</a></code>) should be
signalled as a “summarizing” <code><a href="https://r-universe.dev/manuals/base.html#warning">warning</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>lmList</code> to be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evaluate</code></td>
<td>
<p>If <code>TRUE</code> evaluate the new call else return the call.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of <code>lm</code> objects with as many components as the number of
groups defined by the grouping factor. Generic functions such as
<code>coef</code>, <code>fixed.effects</code>, <code>lme</code>, <code>pairs</code>,
<code>plot</code>, <code>predict</code>, <code>random.effects</code>, <code>summary</code>,
and <code>update</code> have methods that can be applied to an <code>lmList</code>
object.
</p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#lm">lm</a></code>,
<code><a href="#lme.lmList">lme.lmList</a></code>,
<code><a href="#plot.lmList">plot.lmList</a></code>,
<code><a href="#pooledSD">pooledSD</a></code>,
<code><a href="#predict.lmList">predict.lmList</a></code>,
<code><a href="#residuals.lmList">residuals.lmList</a></code>,
<code><a href="#summary.lmList">summary.lmList</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lmList.groupedData">

<a href="#lmList.groupedData" class="help-page-title"><h2>lmList Fit from a groupedData Object</h2></a>

<h3>Description</h3>

<p>The response variable and primary covariate in <code>formula(object)</code>
are used to construct the linear model formula. This formula
and the <code>groupedData</code> object are passed as the <code>object</code> and
<code>data</code> arguments to <code>lmList.formula</code>, together with any other
additional arguments in the function call. See the documentation on
<code>lmList.formula</code> for a description of that function.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'groupedData'</span>
lmList<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> level<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> na.action <span class="token operator">=</span> na.fail<span class="token punctuation">,</span>
       pool <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> warn.lm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a data frame inheriting from class <code>"<a href="#groupedData">groupedData</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>this argument is included for consistency with the generic
function. It is ignored in this method function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>an optional integer specifying the level of grouping to be used when
multiple nested levels of grouping are present.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating which subset of the rows of
<code>data</code> should  be  used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>lmList</code> to print an error message and terminate if there are any
incomplete observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool, warn.lm</code></td>
<td>
<p>optional <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code>s, see <code><a href="#lmList">lmList</a></code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of <code>lm</code> objects with as many components as the number of
groups defined by the grouping factor. Generic functions such as
<code>coef</code>, <code>fixed.effects</code>, <code>lme</code>, <code>pairs</code>,
<code>plot</code>, <code>predict</code>, <code>random.effects</code>, <code>summary</code>,
and <code>update</code> have methods that can be applied to an <code>lmList</code>
object.
</p>


<h3>See Also</h3>

<p><code><a href="#groupedData">groupedData</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#lm">lm</a></code>,
<code><a href="#lme.lmList">lme.lmList</a></code>, <code><a href="#lmList">lmList</a></code>,
<code><a href="#lmList">lmList.formula</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="logDet">

<a href="#logDet" class="help-page-title"><h2>Extract the Logarithm of the Determinant</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include: <code>corStruct</code>, several <code>pdMat</code> classes,
and <code>reStruct</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">logDet<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object from which a matrix, or list of matrices, can
be extracted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate
documentation. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#logLik">logLik</a></code>,
<code><a href="#logDet.corStruct">logDet.corStruct</a></code>,
<code><a href="#logDet.pdMat">logDet.pdMat</a></code>,
<code><a href="#logDet.reStruct">logDet.reStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="logDet.corStruct">

<a href="#logDet.corStruct" class="help-page-title"><h2>Extract corStruct Log-Determinant</h2></a>

<h3>Description</h3>

<p>This method function extracts the logarithm of the determinant of a
square-root factor of the correlation matrix associated with
<code>object</code>, or the sum of the log-determinants of square-root
factors of the list of correlation matrices associated with
<code>object</code>.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
logDet<span class="token punctuation">(</span>object<span class="token punctuation">,</span> covariate<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>,
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>an optional covariate vector (matrix), or list of
covariate vectors (matrices), at which values the correlation matrix,
or list of correlation  matrices, are to be evaluated. Defaults to
<code>getCovariate(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the log-determinant of a square-root factor of the correlation matrix
associated with <code>object</code>, or the sum of the log-determinants of
square-root factors of the list of correlation matrices associated
with <code>object</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#logLik.corStruct">logLik.corStruct</a></code>,
<code><a href="#corMatrix.corStruct">corMatrix.corStruct</a></code>,
<code><a href="#logDet">logDet</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>
logDet<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> covariate <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="logDet.pdMat">

<a href="#logDet.pdMat" class="help-page-title"><h2>Extract Log-Determinant from a pdMat Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the logarithm of the determinant of a
square-root factor of the positive-definite matrix represented by
<code>object</code>.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
logDet<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>, representing
a positive definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the log-determinant of a square-root factor of the positive-definite
matrix represented by <code>object</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#pdMat">pdMat</a></code>,
<code><a href="#logDet">logDet</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
logDet<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="logDet.reStruct">

<a href="#logDet.reStruct" class="help-page-title"><h2>Extract reStruct Log-Determinants</h2></a>

<h3>Description</h3>

<p>Calculates, for each of the <code>pdMat</code> components of <code>object</code>,
the logarithm of the determinant of a square-root factor.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
logDet<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the log-determinants of square-root factors of the
<code>pdMat</code> components of <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro</p>


<h3>See Also</h3>

<p><code><a href="#reStruct">reStruct</a></code>,
<code><a href="#pdMat">pdMat</a></code>, <code><a href="#logDet">logDet</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>list<span class="token punctuation">(</span>A <span class="token operator">=</span> pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>Score<span class="token punctuation">)</span><span class="token punctuation">,</span>
  B <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> diag<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>Educ<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
logDet<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="logLik.corStruct">

<a href="#logLik.corStruct" class="help-page-title"><h2>Extract corStruct Log-Likelihood</h2></a>

<h3>Description</h3>

<p>This method function extracts the component of a Gaussian
log-likelihood associated with the correlation structure, which is
equal to the negative of the logarithm of the determinant (or sum of
the logarithms of the determinants) of the matrix (or matrices)
represented by <code>object</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
logLik<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>,
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>this argument is included to make this method function
compatible with other <code>logLik</code> methods and will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the negative of the logarithm of the determinant (or sum of
the logarithms of the determinants) of the correlation matrix (or
matrices) represented by <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#logDet.corStruct">logDet.corStruct</a></code>,
<code><a href="#logLik.lme">logLik.lme</a></code>,
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
logLik<span class="token punctuation">(</span>cs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="logLik.glsStruct">

<a href="#logLik.glsStruct" class="help-page-title"><h2>Log-Likelihood of a glsStruct Object</h2></a>

<h3>Description</h3>

<p><code>Pars</code> is used to update the coefficients of the model components
of <code>object</code> and the individual (restricted) log-likelihood
contributions of each component are added together. The type of
log-likelihood (restricted or not) is determined by the
<code>settings</code> attribute of <code>object</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'glsStruct'</span>
logLik<span class="token punctuation">(</span>object<span class="token punctuation">,</span> Pars<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#glsStruct">glsStruct</a>"</code>,
representing a list of linear model components, such as
<code>corStruct</code> and <code>"<a href="#varFunc">varFunc</a>"</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pars</code></td>
<td>
<p>the parameter values at which the (restricted)
log-likelihood is to be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>an optional condensed linear model object, consisting of
a list with components <code>"Xy"</code>, corresponding to a regression
matrix (<code>X</code>) combined with a response vector (<code>y</code>), and 
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying linear model. Defaults to <code>attr(object, "conLin")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the (restricted) log-likelihood for the linear model described by
<code>object</code>, evaluated at <code>Pars</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>,
<code><a href="#glsStruct">glsStruct</a></code>,
<code><a href="#logLik.lme">logLik.lme</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="logLik.gnls">

<a href="#logLik.gnls" class="help-page-title"><h2>Log-Likelihood of a gnls Object</h2></a>

<h3>Description</h3>

<p>Returns the log-likelihood value of the nonlinear model represented by
<code>object</code> evaluated at the estimated coefficients.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gnls'</span>
logLik<span class="token punctuation">(</span>object<span class="token punctuation">,</span> REML<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gnls">gnls</a>"</code>, representing
a generalized nonlinear least squares fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>an logical value for consistency with <code>logLik,gls</code>,
but only <code>FALSE</code> is accepted.. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the log-likelihood of the linear model represented by
<code>object</code> evaluated at the estimated coefficients.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gnls">gnls</a></code>,
<code><a href="#logLik.lme">logLik.lme</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>weight <span class="token operator">~</span> SSlogis<span class="token punctuation">(</span>Time<span class="token punctuation">,</span> Asym<span class="token punctuation">,</span> xmid<span class="token punctuation">,</span> scal<span class="token punctuation">)</span><span class="token punctuation">,</span> Soybean<span class="token punctuation">,</span>
            weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
logLik<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="logLik.gnlsStruct">

<a href="#logLik.gnlsStruct" class="help-page-title"><h2>Log-Likelihood of a gnlsStruct Object</h2></a>

<h3>Description</h3>

<p><code>Pars</code> is used to update the coefficients of the model components
of <code>object</code> and the individual log-likelihood
contributions of each component are added together.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gnlsStruct'</span>
logLik<span class="token punctuation">(</span>object<span class="token punctuation">,</span> Pars<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>gnlsStruct</code>,
representing a list of model components, such as
<code>corStruct</code> and <code>varFunc</code> objects, and attributes
specifying the underlying nonlinear model and the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pars</code></td>
<td>
<p>the parameter values at which the log-likelihood is to be
evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>an optional condensed linear model object, consisting of
a list with components <code>"Xy"</code>, corresponding to a regression
matrix (<code>X</code>) combined with a response vector (<code>y</code>), and 
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying nonlinear model. Defaults to <code>attr(object,
     "conLin")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the log-likelihood for the linear model described by <code>object</code>,
evaluated at <code>Pars</code>.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gnls">gnls</a></code>, <code><a href="#gnlsStruct">gnlsStruct</a></code>,
<code><a href="#logLik.gnls">logLik.gnls</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="logLik.lme">

<a href="#logLik.lme" class="help-page-title"><h2>Log-Likelihood of an lme Object</h2></a>

<h3>Description</h3>

<p>If <code>REML=FALSE</code>, returns the log-likelihood value of the linear
mixed-effects model represented by <code>object</code> evaluated at the
estimated  coefficients; else, the restricted log-likelihood evaluated
at the estimated coefficients is returned.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
logLik<span class="token punctuation">(</span>object<span class="token punctuation">,</span> REML<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>an optional logical value.  If <code>TRUE</code> the restricted
log-likelihood is returned, else, if <code>FALSE</code>, the log-likelihood
is returned. Defaults to the method of estimation used, that is
<code>TRUE</code> if and only <code>object</code> was fitted with <code>method =
     "REML"</code> (the default for these fitting functions) . </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the (restricted) log-likelihood of the model represented by
<code>object</code> evaluated at the estimated coefficients.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates</p>


<h3>References</h3>

<p>Harville, D.A. (1974) “Bayesian Inference for Variance Components
Using Only Error Contrasts”, <em>Biometrika</em>, <b>61</b>, 383–385.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>,<code><a href="#gls">gls</a></code>,
<code><a href="#logLik.corStruct">logLik.corStruct</a></code>,
<code><a href="#logLik.glsStruct">logLik.glsStruct</a></code>,
<code><a href="#logLik.lmeStruct">logLik.lmeStruct</a></code>,
<code><a href="#logLik.lmList">logLik.lmList</a></code>,
<code><a href="#logLik.reStruct">logLik.reStruct</a></code>,
<code><a href="#logLik.varFunc">logLik.varFunc</a></code>,
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> Sex <span class="token operator">*</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"ML"</span><span class="token punctuation">)</span>
logLik<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
logLik<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> REML <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="logLik.lmeStruct">

<a href="#logLik.lmeStruct" class="help-page-title"><h2>Log-Likelihood of an lmeStruct Object</h2></a>

<h3>Description</h3>

<p><code>Pars</code> is used to update the coefficients of the model components
of <code>object</code> and the individual (restricted) log-likelihood
contributions of each component are added together. The type of
log-likelihood (restricted or not) is determined by the
<code>settings</code> attribute of <code>object</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmeStruct'</span>
logLik<span class="token punctuation">(</span>object<span class="token punctuation">,</span> Pars<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmeStruct">lmeStruct</a>"</code>,
representing a list of linear mixed-effects model components, such as
<code>reStruct</code>, <code>corStruct</code>, and <code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pars</code></td>
<td>
<p>the parameter values at which the (restricted)
log-likelihood is to be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>an optional condensed linear model object, consisting of
a list with components <code>"Xy"</code>, corresponding to a regression
matrix (<code>X</code>) combined with a response vector (<code>y</code>), and 
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying lme model. Defaults to <code>attr(object, "conLin")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the (restricted) log-likelihood for the linear mixed-effects model
described by <code>object</code>, evaluated at <code>Pars</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>,
<code><a href="#lmeStruct">lmeStruct</a></code>,
<code><a href="#logLik.lme">logLik.lme</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="logLik.lmList">

<a href="#logLik.lmList" class="help-page-title"><h2>Log-Likelihood of an lmList Object</h2></a>

<h3>Description</h3>

<p>If <code>pool=FALSE</code>, the (restricted) log-likelihoods of the <code>lm</code>
components of <code>object</code> are summed together. Else, the (restricted)
log-likelihood of the <code>lm</code> fit with different coefficients for
each level of the grouping factor associated with the partitioning of
the <code>object</code> components is obtained.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
logLik<span class="token punctuation">(</span>object<span class="token punctuation">,</span> REML<span class="token punctuation">,</span> pool<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> the restricted
log-likelihood is returned, else, if <code>FALSE</code>, the log-likelihood
is returned. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>an optional logical value indicating whether all <code>lm</code>
components of <code>object</code> may be assumed to have the same error
variance. Default is <code>attr(object, "pool")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>either the sum of the (restricted) log-likelihoods of each <code>lm</code>
component in <code>object</code>, or the (restricted) log-likelihood for the
<code>lm</code> fit with separate coefficients for each component of
<code>object</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>,
<code><a href="#logLik.lme">logLik.lme</a></code>,
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
logLik<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>   <span class="token comment"># returns NA when it should not</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="logLik.reStruct">

<a href="#logLik.reStruct" class="help-page-title"><h2>Calculate reStruct Log-Likelihood</h2></a>

<h3>Description</h3>

<p>Calculates the log-likelihood, or restricted log-likelihood, of the
Gaussian linear mixed-effects model represented by <code>object</code> and
<code>conLin</code> (assuming spherical within-group covariance structure),
evaluated at <code>coef(object)</code>. The <code>settings</code> attribute of
<code>object</code> determines whether the log-likelihood, or the restricted
log-likelihood, is to be calculated. The computational methods are 
described in Bates and Pinheiro (1998).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
logLik<span class="token punctuation">(</span>object<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>a condensed linear model object, consisting of a list
with components <code>"Xy"</code>, corresponding to a regression matrix
(<code>X</code>) combined with a response vector (<code>y</code>), and
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the log-likelihood, or restricted log-likelihood, of linear
mixed-effects model represented by <code>object</code> and <code>conLin</code>,
evaluated at <code>coef{object}</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#reStruct">reStruct</a></code>,
<code><a href="#pdMat">pdMat</a></code>,
<code><a href="#logLik.lme">logLik.lme</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="logLik.varFunc">

<a href="#logLik.varFunc" class="help-page-title"><h2>Extract varFunc logLik</h2></a>

<h3>Description</h3>

<p>This method function extracts the component of a Gaussian
log-likelihood associated with the variance function structure
represented by <code>object</code>, which is equal to the sum of the
logarithms of the corresponding weights. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'varFunc'</span>
logLik<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#varFunc">varFunc</a>"</code>,
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>this argument is included to make this method function
compatible with other <code>logLik</code> methods and will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the sum of the logarithms of the weights corresponding to the variance
function structure represented by <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#logLik.lme">logLik.lme</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token punctuation">)</span>
vf1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>vf1<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> <span class="token number">0.1</span>
logLik<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Machines">

<a href="#Machines" class="help-page-title"><h2>Productivity Scores for Machines and Workers</h2></a>

<h3>Description</h3>

<p>The <code>Machines</code> data frame has 54 rows and 3 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Worker</dt>
<dd>
<p>an ordered factor giving the unique identifier for the worker.
</p>
</dd>
<dt>Machine</dt>
<dd>
<p>a factor with levels
<code>A</code>, 
<code>B</code>, and 
<code>C</code> identifying the machine brand.
</p>
</dd>
<dt>score</dt>
<dd>
<p>a productivity score.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Data on an experiment to compare three brands of machines used in an
industrial process are presented in Milliken and Johnson (p. 285,
1992). Six workers were chosen randomly among the
employees of a factory to operate each machine three times. The
response is an overall productivity score taking into account the
number and quality of components produced.</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models
in S and S-PLUS</em>, Springer, New York.  (Appendix A.14)
</p>
<p>Milliken, G. A. and Johnson, D. E. (1992), <em>Analysis of Messy Data,
Volume I: Designed Experiments</em>, Chapman and Hall, London.
</p>

<hr>
</div>
<div class="container manual-page" id="MathAchieve">

<a href="#MathAchieve" class="help-page-title"><h2>Mathematics achievement scores</h2></a>

<h3>Description</h3>

<p>The <code>MathAchieve</code> data frame has 7185 rows and 6 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>School</dt>
<dd>
<p>an ordered factor identifying the school that the student attends
</p>
</dd>
<dt>Minority</dt>
<dd>
<p>a factor with levels
<code>No</code> 
<code>Yes</code>
indicating if the student is a member of a minority racial group.
</p>
</dd>
<dt>Sex</dt>
<dd>
<p>a factor with levels
<code>Male</code> 
<code>Female</code> 
</p>
</dd>
<dt>SES</dt>
<dd>
<p>a numeric vector of socio-economic status.
</p>
</dd>
<dt>MathAch</dt>
<dd>
<p>a numeric vector of mathematics achievement scores.
</p>
</dd>
<dt>MEANSES</dt>
<dd>
<p>a numeric vector of the mean SES for the school.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Each row in this data frame contains the data for one student.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">summary<span class="token punctuation">(</span>MathAchieve<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="MathAchSchool">

<a href="#MathAchSchool" class="help-page-title"><h2>School demographic data for MathAchieve</h2></a>

<h3>Description</h3>

<p>The <code>MathAchSchool</code> data frame has 160 rows and 7 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>School</dt>
<dd>
<p>a factor giving the school on which the measurement is made.
</p>
</dd>
<dt>Size</dt>
<dd>
<p>a numeric vector giving the number of students in the school
</p>
</dd>
<dt>Sector</dt>
<dd>
<p>a factor with levels
<code>Public</code> 
<code>Catholic</code> 
</p>
</dd>
<dt>PRACAD</dt>
<dd>
<p>a numeric vector giving the percentage of students on the
academic track
</p>
</dd>
<dt>DISCLIM</dt>
<dd>
<p>a numeric vector measuring the discrimination climate
</p>
</dd>
<dt>HIMINTY</dt>
<dd>
<p>a factor with levels
<code>0</code> 
<code>1</code> 
</p>
</dd>
<dt>MEANSES</dt>
<dd>
<p>a numeric vector giving the mean SES score.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>These variables give the school-level demographic data to accompany
the <code>MathAchieve</code> data.
</p>

<hr>
</div>
<div class="container manual-page" id="Matrix">

<a href="#Matrix" class="help-page-title"><h2>Assign Matrix Values</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects.  Classes which already have methods for
this function include <code>pdMat</code>, <code>pdBlocked</code>, and
<code>reStruct</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">matrix<span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object to which <code>as.matrix</code> can be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a matrix, or list of matrices, with the same dimensions as
<code>as.matrix(object)</code> with the new values to be assigned to the
matrix associated with <code>object</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#matrix">as.matrix</a></code>, also for examples,
<code><a href="#Matrix.pdMat">matrix&lt;-.pdMat</a></code>,
<code><a href="#Matrix.reStruct">matrix&lt;-.reStruct</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="Matrix.pdMat">

<a href="#Matrix.pdMat" class="help-page-title"><h2>Assign Matrix to a pdMat or pdBlocked Object</h2></a>

<h3>Description</h3>

<p>The positive-definite matrix represented by <code>object</code> is replaced
by <code>value</code>.  If the original matrix had row and/or column names,
the corresponding names for <code>value</code> can either be <code>NULL</code>, or
a permutation of the original names.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 replacement method for class 'pdMat'</span>
matrix<span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value
<span class="token comment">## S3 replacement method for class 'pdBlocked'</span>
matrix<span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>,
representing a positive definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a matrix with the new values to be assigned to the
positive-definite matrix represented by <code>object</code>.  Must have the
same dimensions as <code>as.matrix(object)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdMat</code> or <code>pdBlocked</code> object similar to <code>object</code>,
but with its coefficients modified to produce the matrix in
<code>value</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#pdMat">pdMat</a></code>, <code>"<a href="#Matrix">matrix&lt;-</a>"</code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">class<span class="token punctuation">(</span>pd1 <span class="token operator">&lt;-</span> pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># "pdSymm" "pdMat"</span>
matrix<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>
pd1</code></pre>

<hr>
</div>
<div class="container manual-page" id="Matrix.reStruct">

<a href="#Matrix.reStruct" class="help-page-title"><h2>Assign reStruct Matrices</h2></a>

<h3>Description</h3>

<p>The individual matrices in <code>value</code> are assigned to each
<code>pdMat</code> component of <code>object</code>, in the order they are listed. The
new matrices must have the same dimensions as the matrices they are
meant to replace.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 replacement method for class 'reStruct'</span>
matrix<span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token operator">&lt;-</span>  value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a matrix, or list of matrices, with the new values to be
assigned to the matrices associated with the <code>pdMat</code> components
of <code>object</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an <code>reStruct</code> object similar to <code>object</code>, but with the
coefficients of the individual <code>pdMat</code> components modified to
produce the matrices listed in <code>value</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#reStruct">reStruct</a></code>, <code><a href="#pdMat">pdMat</a></code>, <code>"<a href="#Matrix">matrix&lt;-</a>"</code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>list<span class="token punctuation">(</span>Dog <span class="token operator">=</span> <span class="token operator">~</span>day<span class="token punctuation">,</span> Side <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Pixel<span class="token punctuation">)</span>
matrix<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Meat">

<a href="#Meat" class="help-page-title"><h2>Tenderness of meat</h2></a>

<h3>Description</h3>

<p>The <code>Meat</code> data frame has 30 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Storage</dt>
<dd>
<p>an ordered factor specifying the storage treatment - 1 (0
days), 2 (1 day),  3 (2 days), 4 (4 days), 5 (9 days), and 6
(18 days)
</p>
</dd>
<dt>score</dt>
<dd>
<p>a numeric vector giving the tenderness score of beef roast.
</p>
</dd>
<dt>Block</dt>
<dd>
<p>an ordered factor identifying the muscle from which the
roast was extracted with levels 
<code>II</code> &lt; <code>V</code> &lt; <code>I</code> &lt; <code>III</code> &lt; <code>IV</code>
</p>
</dd>
<dt>Pair</dt>
<dd>
<p>an ordered factor giving the unique identifier for each pair
of beef roasts with levels <code>II-1</code> &lt; ... &lt; <code>IV-1</code>
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Cochran and Cox (section 11.51, 1957) describe data from an
experiment conducted at Iowa State College (Paul, 1943) to
compare the effects of length of cold storage on the tenderness of
beef roasts.  Six storage periods ranging from 0 to 18 days were used.
Thirty roasts were scored by four judges on a scale from 0 to 10, with
the score increasing with tenderness. The response was the sum of all
four scores. Left and right roasts from the same animal were grouped
into pairs, which were further grouped into five blocks, according to
the muscle from which they were extracted. Different storage periods
were applied to each roast within a pair according to a balanced
incomplete block design.</p>


<h3>Source</h3>

<p>Cochran, W. G. and Cox, G. M. (1957), <em>Experimental Designs</em>,
Wiley, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="Milk">

<a href="#Milk" class="help-page-title"><h2>Protein content of cows' milk</h2></a>

<h3>Description</h3>

<p>The <code>Milk</code> data frame has 1337 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>protein</dt>
<dd>
<p>a numeric vector giving the protein content of the milk.
</p>
</dd>
<dt>Time</dt>
<dd>
<p>a numeric vector giving the time since calving (weeks).
</p>
</dd>
<dt>Cow</dt>
<dd>
<p>an ordered factor giving a unique identifier for each cow.
</p>
</dd>
<dt>Diet</dt>
<dd>
<p>a factor with levels
<code>barley</code>, 
<code>barley+lupins</code>, and 
<code>lupins</code> identifying the diet for each cow.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Diggle, Liang, and Zeger (1994) describe data on the protein content
of cows' milk in the weeks following calving.  The cattle are grouped
according to whether they are fed a diet with barley alone, with
barley and lupins, or with lupins alone. 
</p>


<h3>Source</h3>

<p>Diggle, Peter J., Liang, Kung-Yee and Zeger, Scott L. (1994),
<em>Analysis of longitudinal data</em>, Oxford University Press,
Oxford.
</p>

<hr>
</div>
<div class="container manual-page" id="model.matrix.reStruct">

<a href="#model.matrix.reStruct" class="help-page-title"><h2>reStruct Model Matrix</h2></a>

<h3>Description</h3>

<p>The model matrices for each element of <code>formula(object)</code>,
calculated using <code>data</code>, are bound together column-wise. When
multiple grouping levels are present (i.e. when <code>length(object) &gt;
    1</code>), the individual model matrices are combined from innermost (at
the leftmost position) to outermost (at the rightmost position). 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
model.matrix<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> contrast<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to evaluate the variables defined in
<code>formula(object)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>an optional named list specifying the contrasts to be used
for representing the <code>factor</code> variables in <code>data</code>. The
components names should match the names of the variables in
<code>data</code> for which the contrasts are to be specified. The
components of this list will be used as the <code>contrasts</code>
attribute of the corresponding factor. If missing, the default
contrast specification is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a matrix obtained by binding together, column-wise, the model matrices
for each element of <code>formula(object)</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#model.matrix">model.matrix</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#contrasts">contrasts</a></code>,
<code><a href="#reStruct">reStruct</a></code>, <code><a href="#formula.reStruct">formula.reStruct</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>list<span class="token punctuation">(</span>Dog <span class="token operator">=</span> <span class="token operator">~</span>day<span class="token punctuation">,</span> Side <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Pixel<span class="token punctuation">)</span>
model.matrix<span class="token punctuation">(</span>rs1<span class="token punctuation">,</span> Pixel<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Muscle">

<a href="#Muscle" class="help-page-title"><h2>Contraction of heart muscle sections</h2></a>

<h3>Description</h3>

<p>The <code>Muscle</code> data frame has 60 rows and 3 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Strip</dt>
<dd>
<p>an ordered factor indicating the strip of muscle being measured.
</p>
</dd>
<dt>conc</dt>
<dd>
<p>a numeric vector giving the concentration of CaCl2
</p>
</dd>
<dt>length</dt>
<dd>
<p>a numeric vector giving the shortening of the heart muscle strip.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Baumann and Waldvogel (1963) describe data on the shortening of heart
muscle strips dipped in a <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>CaCl</mtext><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mbox{CaCl}{}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord text"><span class="mord">CaCl</span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> solution.
The muscle strips are taken from the left auricle of a rat's heart.</p>


<h3>Source</h3>

<p>Baumann, F. and Waldvogel, F. (1963), La restitution pastsystolique
de la contraction de l'oreillette gauche du rat. Effets de divers
ions et de l'acetylcholine, <em>Helvetica Physiologica Acta</em>,
<b>21</b>.
</p>

<hr>
</div>
<div class="container manual-page" id="Names">

<a href="#Names" class="help-page-title"><h2>Names Associated with an Object</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include: <code>formula</code>, <code>modelStruct</code>,
<code>pdBlocked</code>, <code>pdMat</code>, and <code>reStruct</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Names<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
Names<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object for which names can be extracted and/or assigned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>names to be assigned to <code>object</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>SIDE EFFECTS</h3>

<p>On the left side of an assignment, sets the names associated with
<code>object</code> to <code>value</code>, which must have an appropriate length. 
</p>


<h3>Note</h3>

<p>If <code>names</code> were generic, there would be no need for this generic
function. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Names.formula">Names.formula</a></code>,
<code><a href="#Names.pdMat">Names.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Names.formula">

<a href="#Names.formula" class="help-page-title"><h2>Extract Names from a formula</h2></a>

<h3>Description</h3>

<p>This method function returns the names of the terms corresponding to
the right hand side of <code>object</code> (treated as a linear formula),
obtained as the column names of the corresponding
<code>model.matrix</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'formula'</span>
Names<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> exclude<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="https://r-universe.dev/manuals/stats.html#formula">formula</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables specified
in <code>object</code>. By default the variables are taken from the
environment from which <code>Names.formula</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>an optional character vector with names to be excluded
from the returned value. Default is <code>c("pi",".")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a character vector with the column names of the <code>model.matrix</code>
corresponding to the right hand side of <code>object</code> which are not
listed in <code>excluded</code>.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#model.matrix">model.matrix</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#terms">terms</a></code>,
<code><a href="#Names">Names</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">Names<span class="token punctuation">(</span>distance <span class="token operator">~</span> Sex <span class="token operator">*</span> age<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Names.pdBlocked">

<a href="#Names.pdBlocked" class="help-page-title"><h2>Names of a pdBlocked Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the first element of the <code>Dimnames</code>
attribute, which contains the column names, for each block diagonal
element in the matrix represented by <code>object</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdBlocked'</span>
Names<span class="token punctuation">(</span>object<span class="token punctuation">,</span> asList<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdBlocked">pdBlocked</a>"</code>
representing a positive-definite matrix with block diagonal
structure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>a logical value. If <code>TRUE</code> a <code>list</code> with the
names for each block diagonal element is returned. If <code>FALSE</code>
a character vector with all column names is returned. Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>asList</code> is <code>FALSE</code>, a character vector with column names
of the matrix represented by <code>object</code>; otherwise, if
<code>asList</code> is <code>TRUE</code>, a list with components given by the
column names of the individual block diagonal elements in the matrix
represented by <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Names">Names</a></code>,
<code><a href="#Names.pdMat">Names.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdBlocked<span class="token punctuation">(</span>list<span class="token punctuation">(</span><span class="token operator">~</span>Sex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">~</span>age <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
Names<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Names.pdMat">

<a href="#Names.pdMat" class="help-page-title"><h2>Names of a pdMat Object</h2></a>

<h3>Description</h3>

<p>This method function returns the fist element of the <code>Dimnames</code>
attribute of <code>object</code>, which contains the column names of the
matrix represented by <code>object</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
Names<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 replacement method for class 'pdMat'</span>
Names<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>,
representing a positive-definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a character vector with the replacement values for the
column and row names of the matrix represented by <code>object</code>. It
must have length equal to the dimension of the matrix
represented by <code>object</code> and, if names have been previously
assigned to <code>object</code>, it must correspond to a permutation of the
original names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>object</code> has a <code>Dimnames</code> attribute then the first
element of this attribute is returned; otherwise <code>NULL</code>. 
</p>


<h3>SIDE EFFECTS</h3>

<p>On the left side of an assignment, sets the <code>Dimnames</code> attribute
of <code>object</code> to <code>list(value, value)</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Names">Names</a></code>, <code><a href="#Names.pdBlocked">Names.pdBlocked</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdSymm<span class="token punctuation">(</span><span class="token operator">~</span>age<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
Names<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Names.reStruct">

<a href="#Names.reStruct" class="help-page-title"><h2>Names of an reStruct Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the column names of each of the
positive-definite matrices represented the <code>pdMat</code>
elements of <code>object</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
Names<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 replacement method for class 'reStruct'</span>
Names<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> value</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a list of character vectors with the replacement values
for the names of the individual <code>pdMat</code> objects that form
<code>object</code>. It must have the same length as <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the column names of each of the positive-definite
matrices represented by the <code>pdMat</code> elements of <code>object</code>. 
</p>


<h3>SIDE EFFECTS</h3>

<p>On the left side of an assignment, sets the <code>Names</code> of the
<code>pdMat</code> elements of <code>object</code> to the corresponding element of
<code>value</code>.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#reStruct">reStruct</a></code>, <code><a href="#pdMat">pdMat</a></code>,
<code><a href="#Names.pdMat">Names.pdMat</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>list<span class="token punctuation">(</span>Dog <span class="token operator">=</span> <span class="token operator">~</span>day<span class="token punctuation">,</span> Side <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Pixel<span class="token punctuation">)</span>
Names<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="needUpdate">

<a href="#needUpdate" class="help-page-title"><h2>Check if Update is Needed</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. By default, it tries to extract a
<code>needUpdate</code> attribute of <code>object</code>. If this is <code>NULL</code>
or <code>FALSE</code> it returns <code>FALSE</code>; else it returns <code>TRUE</code>.
Updating of objects usually takes place in iterative algorithms in
which auxiliary quantities associated with the object, and not being
optimized over, may change.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">needUpdate<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a logical value indicating whether <code>object</code> needs to be updated. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#needUpdate.modelStruct">needUpdate.modelStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varExp<span class="token punctuation">(</span><span class="token punctuation">)</span>
vf1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>vf1<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
needUpdate<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="needUpdate.modelStruct">

<a href="#needUpdate.modelStruct" class="help-page-title"><h2>Check if a modelStruct Object Needs Updating</h2></a>

<h3>Description</h3>

<p>This method function checks if any of the elements of <code>object</code>
needs to be updated. Updating of objects usually takes place in
iterative algorithms in which auxiliary quantities associated with the
object, and not being optimized over, may change.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'modelStruct'</span>
needUpdate<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"modelStruct"</code>,
representing a list of model components, such as <code>corStruct</code> and
<code>varFunc</code> objects.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a logical value indicating whether any element of <code>object</code> needs
to be updated.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#needUpdate">needUpdate</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">lms1 <span class="token operator">&lt;-</span> lmeStruct<span class="token punctuation">(</span>reStruct <span class="token operator">=</span> reStruct<span class="token punctuation">(</span>pdDiag<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">~</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   varStruct <span class="token operator">=</span> varPower<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span>
needUpdate<span class="token punctuation">(</span>lms1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Nitrendipene">

<a href="#Nitrendipene" class="help-page-title"><h2>Assay of nitrendipene</h2></a>

<h3>Description</h3>

<p>The <code>Nitrendipene</code> data frame has 89 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>activity</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>NIF</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>Tissue</dt>
<dd>
<p>an ordered factor with levels
<code>2</code> &lt; <code>1</code> &lt; <code>3</code> &lt; <code>4</code>
</p>
</dd>
<dt>log.NIF</dt>
<dd>
<p>a numeric vector
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Bates, D. M. and Watts, D. G. (1988), <em>Nonlinear Regression
Analysis and Its Applications</em>, Wiley, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="nlme">

<a href="#nlme" class="help-page-title"><h2>Nonlinear Mixed-Effects Models</h2></a>

<h3>Description</h3>

<p>This generic function fits a nonlinear mixed-effects model in the
formulation described in Lindstrom and Bates (1990) but allowing for nested
random effects. The within-group errors are allowed to be correlated
and/or have unequal variances. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">nlme<span class="token punctuation">(</span>model<span class="token punctuation">,</span> data<span class="token punctuation">,</span> fixed<span class="token punctuation">,</span> random<span class="token punctuation">,</span> groups<span class="token punctuation">,</span> start<span class="token punctuation">,</span> correlation<span class="token punctuation">,</span> weights<span class="token punctuation">,</span>
     subset<span class="token punctuation">,</span> method<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span> naPattern<span class="token punctuation">,</span> control<span class="token punctuation">,</span> verbose<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a nonlinear model formula, with the response on the left
of a <code>~</code> operator and an expression involving parameters and
covariates on the right, or an <code>nlsList</code> object.  If
<code>data</code> is given, all names used in the formula should be
defined as parameters or variables in the data frame. The method
function <code>nlme.nlsList</code> is documented separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables named in
<code>model</code>, <code>fixed</code>, <code>random</code>, <code>correlation</code>,
<code>weights</code>, <code>subset</code>, and <code>naPattern</code>.  By default the
variables are taken from the environment from which <code>nlme</code> is
called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>a two-sided linear formula of the form
<code>f1+...+fn~x1+...+xm</code>, or a list of two-sided formulas of the form
<code>f1~x1+...+xm</code>, with possibly different models for different
parameters. The <code>f1,...,fn</code> are the names of parameters included on
the right hand side of <code>model</code> and the <code>x1+...+xm</code>
expressions define linear models for these parameters (when the left
hand side of the formula contains several parameters, they all are
assumed to follow the same linear model, described by the right hand
side expression).
A <code>1</code> on the right hand side of the formula(s) indicates a single
fixed effects for the corresponding parameter(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>optionally, any of the following: (i) a two-sided formula
of the form <code>r1+...+rn~x1+...+xm | g1/.../gQ</code>, with
<code>r1,...,rn</code> naming parameters included on the right
hand side of <code>model</code>, <code>x1+...+xm</code> specifying the
random-effects model for
these parameters and <code>g1/.../gQ</code> the grouping structure
(<code>Q</code> may be equal to 1, in which case no <code>/</code> is
required). The random effects formula will be repeated 
for all levels of grouping, in the case of multiple levels of
grouping; (ii) a two-sided formula of the form
<code>r1+...+rn~x1+..+xm</code>, a list of two-sided formulas of the form
<code>r1~x1+...+xm</code>, with possibly different random-effects models
for different parameters, a <code>pdMat</code> object with a two-sided
formula, or list of two-sided formulas (i.e. a non-<code>NULL</code> value for
<code>formula(random)</code>), or a list of pdMat objects with two-sided
formulas, or lists of two-sided formulas. In this case, the grouping
structure formula will be given in <code>groups</code>, or derived from the
data used to fit the nonlinear mixed-effects model, which should
inherit from class  <code>groupedData</code>,; (iii) a named list
of formulas, lists of formulas, or <code>pdMat</code> objects as in (ii),
with the grouping factors as names. The order of nesting will be
assumed the same as the order of the order of the elements in the
list; (iv) an <code>reStruct</code> object. See the documentation on
<code>pdClasses</code> for a description of the available <code>pdMat</code>
classes. Defaults to <code>fixed</code>, 
resulting in all fixed effects having also random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>an optional one-sided formula of the form <code>~g1</code>
(single level of nesting) or <code>~g1/.../gQ</code> (multiple levels of
nesting), specifying the partitions of the data over which the random
effects vary. <code>g1,...,gQ</code> must evaluate to factors in
<code>data</code>. The order of nesting, when multiple levels are present,
is taken from left to right (i.e. <code>g1</code> is the first level,
<code>g2</code> the second, etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an optional numeric vector, or list of initial estimates
for the fixed effects and random effects. If declared as a numeric
vector, it is converted internally to a list with a single component
<code>fixed</code>, given by the vector. The <code>fixed</code> component
is required, unless the model function inherits from class
<code>selfStart</code>, in which case initial values will be derived from a
call to <code>nlsList</code>. An optional <code>random</code> component is used to specify
initial values for the random effects and should consist of a matrix,
or a list of matrices with length equal to the number of grouping
levels. Each matrix should have as many rows as the number of groups
at the corresponding level and as many columns as the number of
random effects in that level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional <code>corStruct</code> object describing the
within-group correlation structure. See the documentation of
<code>corClasses</code> for a description of the available <code>corStruct</code>
classes. Defaults to <code>NULL</code>, corresponding to no within-group
correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional <code>varFunc</code> object or one-sided formula
describing the within-group heteroscedasticity structure. If given as
a formula, it is used as the argument to <code>varFixed</code>,
corresponding to fixed variance weights. See the documentation on
<code>varClasses</code> for a description of the available <code>varFunc</code>
classes. Defaults to <code>NULL</code>, corresponding to homoscedastic
within-group errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of
<code>data</code> that should be used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string.  If <code>"REML"</code> the model is fit by
maximizing the restricted log-likelihood.  If <code>"ML"</code> the
log-likelihood is maximized.  Defaults to <code>"ML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>nlme</code> to print an error message and terminate if there are any
incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naPattern</code></td>
<td>
<p>an expression or formula object, specifying which returned
values are to be regarded as missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to
replace the default values returned by the function <code>nlmeControl</code>.
Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> information on
the evolution of the iterative algorithm is printed. Default is
<code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>nlme</code> representing the nonlinear
mixed-effects model fit. Generic functions such as <code>print</code>,
<code>plot</code> and <code>summary</code> have methods to show the results of the
fit. See <code>nlmeObject</code> for the components of the fit. The functions
<code>resid</code>, <code>coef</code>, <code>fitted</code>, <code>fixed.effects</code>, and
<code>random.effects</code>  can be used to extract some of its components.
</p>


<h3>Note</h3>

<p>The function does not do any scaling internally: the optimization will
work best when the response is scaled so its variance is of the order
of one.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>The model formulation and computational methods are described in
Lindstrom, M.J. and Bates, D.M. (1990). The variance-covariance
parametrizations are described in Pinheiro, J.C. and Bates., D.M.
(1996).   The different correlation structures available for the
<code>correlation</code> argument are described in Box, G.E.P., Jenkins,
G.M., and Reinsel G.C. (1994), Littel, R.C., Milliken, G.A., Stroup,
W.W., and Wolfinger, R.D. (1996), and Venables, W.N. and Ripley,
B.D. (2002). The use of variance functions for linear and nonlinear
mixed effects models is presented in detail in Davidian, M. and
Giltinan, D.M. (1995).  
</p>
<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day. 
</p>
<p>Davidian, M. and Giltinan, D.M. (1995) "Nonlinear Mixed Effects Models
for Repeated Measurement Data", Chapman and Hall.
</p>
<p>Laird, N.M. and Ware, J.H. (1982) "Random-Effects Models for
Longitudinal Data", Biometrics, 38, 963-974.  
</p>
<p>Littel, R.C., Milliken, G.A., Stroup, W.W., and Wolfinger, R.D. (1996)
"SAS Systems for Mixed Models", SAS Institute.
</p>
<p>Lindstrom, M.J. and Bates, D.M. (1990) "Nonlinear Mixed Effects Models
for Repeated Measures Data", Biometrics, 46, 673-687.
</p>
<p>Pinheiro, J.C. and Bates., D.M.  (1996) "Unconstrained
Parametrizations for Variance-Covariance Matrices", Statistics and
Computing, 6, 289-296.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#nlmeControl">nlmeControl</a></code>, <code><a href="#nlme.nlsList">nlme.nlsList</a></code>,
<code><a href="#nlmeObject">nlmeObject</a></code>, <code><a href="#nlsList">nlsList</a></code>,
<code><a href="#nlmeStruct">nlmeStruct</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#reStruct">reStruct</a></code>, <code><a href="#varFunc">varFunc</a></code>,
<code><a href="#corClasses">corClasses</a></code>, <code><a href="#varClasses">varClasses</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> nlme<span class="token punctuation">(</span>height <span class="token operator">~</span> SSasymp<span class="token punctuation">(</span>age<span class="token punctuation">,</span> Asym<span class="token punctuation">,</span> R0<span class="token punctuation">,</span> lrc<span class="token punctuation">)</span><span class="token punctuation">,</span>
            data <span class="token operator">=</span> Loblolly<span class="token punctuation">,</span>
            fixed <span class="token operator">=</span> Asym <span class="token operator">+</span> R0 <span class="token operator">+</span> lrc <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">,</span>
            random <span class="token operator">=</span> Asym <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">,</span>
            start <span class="token operator">=</span> c<span class="token punctuation">(</span>Asym <span class="token operator">=</span> <span class="token number">103</span><span class="token punctuation">,</span> R0 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">8.5</span><span class="token punctuation">,</span> lrc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
fm2 <span class="token operator">&lt;-</span> update<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> random <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span>Asym <span class="token operator">+</span> lrc <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm2<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nlme.nlsList">

<a href="#nlme.nlsList" class="help-page-title"><h2>NLME fit from nlsList Object</h2></a>

<h3>Description</h3>

<p>If the random effects names defined in <code>random</code> are a subset of
the <code>lmList</code> object coefficient names, initial estimates for the
covariance matrix of the random effects are obtained (overwriting any
values given in <code>random</code>). <code>formula(fixed)</code> and the
<code>data</code> argument in the calling sequence used to obtain
<code>fixed</code> are passed as the <code>fixed</code> and <code>data</code> arguments
to <code>nlme.formula</code>, together with any other additional arguments in
the function call. See the documentation on <code>nlme.formula</code> for a
description of that function. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'nlsList'</span>
nlme<span class="token punctuation">(</span>model<span class="token punctuation">,</span> data<span class="token punctuation">,</span> fixed<span class="token punctuation">,</span> random<span class="token punctuation">,</span> groups<span class="token punctuation">,</span> start<span class="token punctuation">,</span> correlation<span class="token punctuation">,</span> weights<span class="token punctuation">,</span>
     subset<span class="token punctuation">,</span> method<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span> naPattern<span class="token punctuation">,</span> control<span class="token punctuation">,</span> verbose<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#nlsList">nlsList</a>"</code>,
representing a list of <code>nls</code> fits with a common model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>this argument is included for consistency with the generic
function. It is ignored in this method function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>this argument is included for consistency with the generic
function. It is ignored in this method function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>an optional one-sided linear formula with no conditioning
expression, or a <code>pdMat</code> object with a <code>formula</code>
attribute. Multiple levels of grouping are not allowed with this
method function.  Defaults to a formula consisting of the right hand
side of <code>formula(fixed)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>an optional one-sided formula of the form <code>~g1</code>
(single level of nesting) or <code>~g1/.../gQ</code> (multiple levels of
nesting), specifying the partitions of the data over which the random
effects vary. <code>g1,...,gQ</code> must evaluate to factors in
<code>data</code>. The order of nesting, when multiple levels are present,
is taken from left to right (i.e. <code>g1</code> is the first level,
<code>g2</code> the second, etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an optional numeric vector, or list of initial estimates
for the fixed effects and random effects. If declared as a numeric
vector, it is converted internally to a list with a single component
<code>fixed</code>, given by the vector. The <code>fixed</code> component
is required, unless the model function inherits from class
<code>selfStart</code>, in which case initial values will be derived from a
call to <code>nlsList</code>. An optional <code>random</code> component is used to specify
initial values for the random effects and should consist of a matrix,
or a list of matrices with length equal to the number of grouping
levels. Each matrix should have as many rows as the number of groups
at the corresponding level and as many columns as the number of
random effects in that level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional <code>corStruct</code> object describing the
within-group correlation structure. See the documentation of
<code>corClasses</code> for a description of the available <code>corStruct</code>
classes. Defaults to <code>NULL</code>, corresponding to no within-group
correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional <code>varFunc</code> object or one-sided formula
describing the within-group heteroscedasticity structure. If given as
a formula, it is used as the argument to <code>varFixed</code>,
corresponding to fixed variance weights. See the documentation on
<code>varClasses</code> for a description of the available <code>varFunc</code>
classes. Defaults to <code>NULL</code>, corresponding to homoscedastic
within-group errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of
<code>data</code> that should be used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string.  If <code>"REML"</code> the model is fit by
maximizing the restricted log-likelihood.  If <code>"ML"</code> the
log-likelihood is maximized.  Defaults to <code>"ML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>nlme</code> to print an error message and terminate if there are any
incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naPattern</code></td>
<td>
<p>an expression or formula object, specifying which returned
values are to be regarded as missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to
replace the default values returned by the function <code>nlmeControl</code>.
Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> information on
the evolution of the iterative algorithm is printed. Default is
<code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>nlme</code> representing the linear mixed-effects
model fit. Generic functions such as <code>print</code>, <code>plot</code> and
<code>summary</code> have methods to show the results of the fit. See
<code>nlmeObject</code> for the components of the fit. The functions
<code>resid</code>, <code>coef</code>, <code>fitted</code>, <code>fixed.effects</code>, and
<code>random.effects</code>  can be used to extract some of its components.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>The computational methods follow on the general framework of Lindstrom,
M.J. and Bates, D.M. (1988). The model formulation is described in
Laird, N.M. and Ware, J.H. (1982).  The variance-covariance
parametrizations are described in &lt;Pinheiro, J.C. and Bates., D.M.
(1996).  The different correlation structures available for the
<code>correlation</code> argument are described in Box, G.E.P., Jenkins,
G.M., and Reinsel G.C. (1994), Littel, R.C., Milliken, G.A., Stroup,
W.W., and Wolfinger, R.D. (1996), and Venables, W.N. and Ripley,
B.D. (2002). The use of variance functions for linear and nonlinear
mixed effects models is presented in detail in Davidian, M. and
Giltinan, D.M. (1995).
</p>
<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day. 
</p>
<p>Davidian, M. and Giltinan, D.M. (1995) "Nonlinear Mixed Effects Models
for Repeated Measurement Data", Chapman and Hall.
</p>
<p>Laird, N.M. and Ware, J.H. (1982) "Random-Effects Models for
Longitudinal Data", Biometrics, 38, 963-974.  
</p>
<p>Lindstrom, M.J. and Bates, D.M. (1988) "Newton-Raphson and EM
Algorithms for Linear Mixed-Effects Models for Repeated-Measures
Data", Journal of the American Statistical Association, 83,
1014-1022. 
</p>
<p>Littel, R.C., Milliken, G.A., Stroup, W.W., and Wolfinger, R.D. (1996)
"SAS Systems for Mixed Models", SAS Institute.
</p>
<p>Pinheiro, J.C. and Bates., D.M.  (1996) "Unconstrained
Parametrizations for Variance-Covariance Matrices", Statistics and
Computing, 6, 289-296.
</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
S", 4th Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#nlme">nlme</a></code>, <code><a href="#lmList">lmList</a></code>,
<code><a href="#nlmeObject">nlmeObject</a></code> </p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> nlsList<span class="token punctuation">(</span>SSasymp<span class="token punctuation">,</span> data <span class="token operator">=</span> Loblolly<span class="token punctuation">)</span>
fm2 <span class="token operator">&lt;-</span> nlme<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> random <span class="token operator">=</span> Asym <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm2<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nlmeControl">

<a href="#nlmeControl" class="help-page-title"><h2>Control Values for nlme Fit</h2></a>

<h3>Description</h3>

<p>The values supplied in the function call replace the defaults and a
list with all possible arguments is returned.  The returned list is
used as the <code>control</code> argument to the <code>nlme</code> function.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">nlmeControl<span class="token punctuation">(</span>maxIter<span class="token punctuation">,</span> pnlsMaxIter<span class="token punctuation">,</span> msMaxIter<span class="token punctuation">,</span> minScale<span class="token punctuation">,</span>
            tolerance<span class="token punctuation">,</span> niterEM<span class="token punctuation">,</span> pnlsTol<span class="token punctuation">,</span> msTol<span class="token punctuation">,</span>
            returnObject<span class="token punctuation">,</span> msVerbose<span class="token punctuation">,</span> msWarnNoConv<span class="token punctuation">,</span>
            gradHess<span class="token punctuation">,</span> apVar<span class="token punctuation">,</span> .relStep<span class="token punctuation">,</span> minAbsParApVar <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">,</span>
            opt <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"nlminb"</span><span class="token punctuation">,</span> <span class="token string">"nlm"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> natural <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> sigma <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>maximum number of iterations for the <code>nlme</code>
optimization algorithm.  Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnlsMaxIter</code></td>
<td>
<p>maximum number of iterations
for the <code>PNLS</code> optimization step inside the <code>nlme</code>
optimization.  Default is 7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msMaxIter</code></td>
<td>
<p>maximum number of iterations for <code><a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a></code>
(<code>iter.max</code>) or the <code><a href="https://r-universe.dev/manuals/stats.html#nlm">nlm</a></code> (<code>iterlim</code>, from the
10-th step) optimization step inside the <code>nlme</code>
optimization.  Default is 50 (which may be too small for e.g. for
overparametrized cases).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minScale</code></td>
<td>
<p>minimum factor by which to shrink the default step size
in an attempt to decrease the sum of squares in the <code>PNLS</code> step.
Default <code>0.001</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>tolerance for the convergence criterion in the
<code>nlme</code> algorithm.  Default is <code>1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niterEM</code></td>
<td>
<p>number of iterations for the EM algorithm used to refine
the initial estimates of the random effects variance-covariance
coefficients.  Default is 25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnlsTol</code></td>
<td>
<p>tolerance for the convergence criterion in <code>PNLS</code>
step.  Default is <code>1e-3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msTol</code></td>
<td>
<p>tolerance for the convergence criterion in <code>nlm</code>,
passed as the <code>gradtol</code> argument to the function (see
documentation on <code>nlm</code>).  Default is <code>1e-7</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnObject</code></td>
<td>
<p>a logical value indicating whether the fitted
object should be returned when the maximum number of iterations is
reached without convergence of the algorithm.  Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msVerbose</code></td>
<td>
<p>a logical value passed as the <code>trace</code> to
<code><a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a>(.., control= list(trace = *, ..))</code> or
as argument <code>print.level</code> to <code><a href="https://r-universe.dev/manuals/stats.html#nlm">nlm</a>()</code>.  Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msWarnNoConv</code></td>
<td>
<p>logical indicating if a <code><a href="https://r-universe.dev/manuals/base.html#warning">warning</a></code>
should be signalled whenever the minimization (by <code>opt</code>) in the
LME step does not converge; defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradHess</code></td>
<td>
<p>a logical value indicating whether numerical gradient
vectors and Hessian matrices of the log-likelihood function should
be used in the <code>nlm</code> optimization. This option is only available
when the correlation structure (<code>corStruct</code>) and the variance
function structure (<code>varFunc</code>) have no "varying" parameters and
the <code>pdMat</code> classes used in the random effects structure are
<code>pdSymm</code> (general positive-definite), <code>pdDiag</code> (diagonal),
<code>pdIdent</code> (multiple of the identity),  or
<code>pdCompSymm</code> (compound symmetry).  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apVar</code></td>
<td>
<p>a logical value indicating whether the approximate
covariance matrix of the variance-covariance parameters should be
calculated.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.relStep</code></td>
<td>
<p>relative step for numerical derivatives
calculations.  Default is <code>.Machine$double.eps^(1/3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minAbsParApVar</code></td>
<td>
<p>numeric value - minimum absolute parameter value
in the approximate variance calculation.  The default is <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>the optimizer to be used, either <code>"<a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a>"</code> (the
default) or <code>"<a href="https://r-universe.dev/manuals/stats.html#nlm">nlm</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>natural</code></td>
<td>
<p>a logical value indicating whether the <code>pdNatural</code>
parametrization should be used for general positive-definite matrices
(<code>pdSymm</code>) in <code>reStruct</code>, when the approximate covariance
matrix of the estimators is calculated.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>optionally a positive number to fix the residual error at.
If <code>NULL</code>, as by default, or <code>0</code>, sigma is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further, named control arguments to be passed to
<code><a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a></code> (apart from <code>trace</code> and <code>iter.max</code>
mentioned above), where used (<code>eval.max</code> and those from
<code>abs.tol</code> down).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components for each of the possible arguments.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>; the
<code>sigma</code> option: Siem Heisterkamp and Bert van Willigen.</p>


<h3>See Also</h3>

<p><code><a href="#nlme">nlme</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#nlm">nlm</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#optim">optim</a></code>,
<code><a href="#nlmeStruct">nlmeStruct</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># decrease the maximum number of iterations and request tracing</span>
nlmeControl<span class="token punctuation">(</span>msMaxIter <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> msVerbose <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nlmeObject">

<a href="#nlmeObject" class="help-page-title"><h2>Fitted nlme Object</h2></a>

<h3>Description</h3>

<p>An object returned by the <code><a href="#nlme">nlme</a></code> function, inheriting from class
<code>"nlme"</code>, also inheriting from class <code>"lme"</code>, and representing a
fitted nonlinear mixed-effects model. Objects of this class have
methods for the generic functions  <code>anova</code>, <code>coef</code>,
<code>fitted</code>, <code>fixed.effects</code>, <code>formula</code>, <code>getGroups</code>,
<code>getResponse</code>, <code>intervals</code>, <code>logLik</code>, <code>pairs</code>,
<code>plot</code>, <code>predict</code>, <code>print</code>, <code>random.effects</code>,
<code>residuals</code>, <code>summary</code>, and <code>update</code>.
</p>


<h3>Value</h3>

<p>The following components must be included in a legitimate <code>"nlme"</code>
object.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>apVar</code></td>
<td>
<p>an approximate covariance matrix for the
variance-covariance coefficients. If <code>apVar = FALSE</code> in the
control values used in the call to <code>nlme</code>, this component is
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a list containing an image of the <code>nlme</code> call that
produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a list with two components, <code>fixed</code> and
<code>random</code>, where the first is a vector containing the estimated
fixed effects and the second is a list of matrices with the estimated
random effects for each level of grouping. For each matrix in the
<code>random</code> list, the columns refer to the random effects and the
rows to the groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>a list of the contrast matrices used to represent factors
in the fixed effects formula  and/or random effects formula. This
information is important for making predictions from a new data
frame in which not all levels of the original factors are
observed. If no factors are used in the nlme model, this component
will be an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dims</code></td>
<td>
<p>a list with basic dimensions used in the nlme fit,
including the components <code>N</code> - the number of observations in
the data, <code>Q</code> - the number of grouping levels, <code>qvec</code> -
the number of random effects at each level from innermost to
outermost (last two values are equal to zero and correspond to the
fixed effects and the response), <code>ngrps</code> - the number of groups
at each level from innermost to outermost (last two values are one
and correspond to the fixed effects and the response), and
<code>ncol</code> - the number of columns in the model matrix for each
level of grouping from innermost to outermost (last two values are
equal to the number of fixed effects and one).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>a data frame with the fitted values as columns. The
leftmost column corresponds to the population fixed effects
(corresponding to the fixed effects only) and successive columns
from left to right correspond to increasing levels of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixDF</code></td>
<td>
<p>a list with components <code>X</code> and <code>terms</code>
specifying the denominator degrees of freedom for, respectively,
t-tests for the individual fixed effects and F-tests for the
fixed-effects terms in the models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a data frame with the grouping factors as
columns. The grouping level increases from left to right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the (restricted) log-likelihood at convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>a list with components <code>fmap</code>, <code>rmap</code>,
<code>rmapRel</code>, and <code>bmap</code>, specifying various mappings for the
fixed and random effects, used to generate predictions from the
fitted object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the estimation method: either <code>"ML"</code> for maximum
likelihood, or <code>"REML"</code> for restricted maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelStruct</code></td>
<td>
<p>an object inheriting from class <code>nlmeStruct</code>,
representing a list of mixed-effects model components, such
as <code>reStruct</code>, <code>corStruct</code>, and <code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numIter</code></td>
<td>
<p>the number of iterations used in the iterative
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>a data frame with the residuals as columns. The
leftmost column corresponds to the population residuals
and successive columns from left to right correspond to increasing
levels of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the estimated within-group error standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varFix</code></td>
<td>
<p>an approximate covariance matrix of the
fixed effects estimates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#nlme">nlme</a></code>, <code>nlmeStruct</code></p>

<hr>
</div>
<div class="container manual-page" id="nlmeStruct">

<a href="#nlmeStruct" class="help-page-title"><h2>Nonlinear Mixed-Effects Structure</h2></a>

<h3>Description</h3>

<p>A nonlinear mixed-effects structure is a list of model components
representing different sets of parameters in the nonlinear mixed-effects
model. An <code>nlmeStruct</code> list must contain at least a
<code>reStruct</code> object, but may also contain <code>corStruct</code> and
<code>varFunc</code> objects. <code>NULL</code> arguments are not included in the
<code>nlmeStruct</code> list. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">nlmeStruct<span class="token punctuation">(</span>reStruct<span class="token punctuation">,</span> corStruct<span class="token punctuation">,</span> varStruct<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reStruct</code></td>
<td>
<p>a <code>reStruct</code> representing a random effects
structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corStruct</code></td>
<td>
<p>an optional <code>corStruct</code> object, representing a
correlation structure. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varStruct</code></td>
<td>
<p>an optional <code>varFunc</code> object, representing a
variance function structure. Default is <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of model components determining the parameters to be estimated
for the associated nonlinear mixed-effects model.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>,
<code><a href="#nlme">nlme</a></code>,
<code><a href="#residuals.nlmeStruct">residuals.nlmeStruct</a></code>,
<code><a href="#reStruct">reStruct</a></code>,
<code><a href="#varFunc">varFunc</a></code> </p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">nlms1 <span class="token operator">&lt;-</span> nlmeStruct<span class="token punctuation">(</span>reStruct<span class="token punctuation">(</span><span class="token operator">~</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> corAR1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nlsList">

<a href="#nlsList" class="help-page-title"><h2>List of nls Objects with a Common Model</h2></a>

<h3>Description</h3>

<p><code>Data</code> is partitioned according to the levels of the grouping
factor defined in <code>model</code> and individual <code>nls</code> fits are
obtained for each <code>data</code> partition, using the model defined in
<code>model</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">nlsList<span class="token punctuation">(</span>model<span class="token punctuation">,</span> data<span class="token punctuation">,</span> start<span class="token punctuation">,</span> control<span class="token punctuation">,</span> level<span class="token punctuation">,</span> subset<span class="token punctuation">,</span>
        na.action <span class="token operator">=</span> na.fail<span class="token punctuation">,</span> pool <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> warn.nls <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'nlsList'</span>
update<span class="token punctuation">(</span>object<span class="token punctuation">,</span> model.<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> evaluate <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>nlsList</code>, representing
a list of fitted <code>nls</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>either a nonlinear model formula, with the response on
the left of a <code>~</code> operator and an expression involving
parameters, covariates, and a grouping factor separated by the
<code>|</code> operator on the right, or a <code>selfStart</code> function.  The
method function <code><a href="#nlsList.selfStart">nlsList.selfStart</a></code> is documented separately.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.</code></td>
<td>
<p>changes to the model – see <code><a href="https://r-universe.dev/manuals/stats.html#update.formula">update.formula</a></code>
for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to interpret the variables named in
<code>model</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an optional named list with initial values for the
parameters to be estimated in <code>model</code>. It is passed as the
<code>start</code> argument to each <code>nls</code> call and is required when
the nonlinear function in <code>model</code> does not inherit from class
<code>selfStart</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values passed as the <code>control</code>
argument to <code>nls</code>.  Defaults to an empty list.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer specifying the level of grouping to
be used when multiple nested levels of grouping are present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of
<code>data</code> that should be used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>nlsList</code> to print an error message and terminate if there are any
incomplete observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>

<p>an optional logical value that is preserved as an attribute of the
returned value.  This will be used as the default for <code>pool</code> in
calculations of standard deviations or standard errors for summaries.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn.nls</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if <code><a href="https://r-universe.dev/manuals/stats.html#nls">nls</a>()</code>
errors (all of which are caught by <code><a href="https://r-universe.dev/manuals/base.html#conditions">tryCatch</a></code>) should be
signalled as a “summarizing” <code><a href="https://r-universe.dev/manuals/base.html#warning">warning</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evaluate</code></td>
<td>
<p>If <code>TRUE</code> evaluate the new call else return the call.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As <code><a href="https://r-universe.dev/manuals/stats.html#nls">nls</a>(.)</code> is called on each sub group, and convergence
of these may be problematic, these calls happen with error catching.
</p>
<p>Since <span class="pkg">nlme</span> version <code>3.1-127</code> (2016-04), all the errors are
caught (via <code><a href="https://r-universe.dev/manuals/base.html#conditions">tryCatch</a></code>) and if present, a “summarizing”
<code><a href="https://r-universe.dev/manuals/base.html#warning">warning</a></code> is stored as attribute of the resulting
<code>"nlsList"</code> object and signalled unless suppressed by
<code>warn.nls = FALSE</code> or currently also when <code>warn.nls = NA</code>
(default) <em>and</em> <code><a href="https://r-universe.dev/manuals/base.html#options">getOption</a>("show.error.messages")</code> is
false.
</p>
<p><code>nlsList()</code> originally had used <code><a href="https://r-universe.dev/manuals/base.html#try">try</a>(*)</code> (with its default
<code>silent=FALSE)</code> and hence all errors were printed to the console
<em>unless</em> the global option <code>show.error.messages</code> was set to true.
This still works, but has been <em>deprecated</em>.
</p>


<h3>Value</h3>

<p>a list of <code>nls</code> objects with as many components as the number of
groups defined by the grouping factor.  Generic functions such as
<code>coef</code>, <code>fixed.effects</code>, <code>lme</code>, <code>pairs</code>,
<code>plot</code>, <code>predict</code>, <code>random.effects</code>, <code>summary</code>,
and <code>update</code> have methods that can be applied to an <code>nlsList</code>
object.
</p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000), <em>Mixed-Effects Models
in S and S-PLUS</em>, Springer.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#nls">nls</a></code>, <code><a href="#nlme.nlsList">nlme.nlsList</a></code>,
<code><a href="#nlsList.selfStart">nlsList.selfStart</a></code>,
<code><a href="#summary.nlsList">summary.nlsList</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> nlsList<span class="token punctuation">(</span>uptake <span class="token operator">~</span> SSasympOff<span class="token punctuation">(</span>conc<span class="token punctuation">,</span> Asym<span class="token punctuation">,</span> lrc<span class="token punctuation">,</span> c0<span class="token punctuation">)</span><span class="token punctuation">,</span>
   data <span class="token operator">=</span> CO2<span class="token punctuation">,</span> start <span class="token operator">=</span> c<span class="token punctuation">(</span>Asym <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> lrc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">4.5</span><span class="token punctuation">,</span> c0 <span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
cfm1 <span class="token operator">&lt;-</span> confint<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span> <span class="token comment"># via profiling each % FIXME: only *one* message instead of one *each*</span>
mat.class <span class="token operator">&lt;-</span> class<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># ("matrix", "array") for R &gt;= 4.0.0;  ("matrix" in older R)</span>
i.ok <span class="token operator">&lt;-</span> which<span class="token punctuation">(</span>vapply<span class="token punctuation">(</span>cfm1<span class="token punctuation">,</span>
                <span class="token keyword">function</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> identical<span class="token punctuation">(</span>class<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span> mat.class<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>length<span class="token punctuation">(</span>i.ok<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">!</span>anyNA<span class="token punctuation">(</span>match<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i.ok<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## where as (some of) the others gave errors during profile re-fitting :</span>
str<span class="token punctuation">(</span>cfm1<span class="token punctuation">[</span><span class="token operator">-</span> i.ok<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="nlsList.selfStart">

<a href="#nlsList.selfStart" class="help-page-title"><h2>nlsList Fit from a selfStart Function</h2></a>

<h3>Description</h3>

<p>The response variable and primary covariate in <code>formula(data)</code>
are used together with <code>model</code> to construct the nonlinear model
formula. This is used in the <code>nls</code> calls and, because a
selfStarting model function can calculate initial estimates for its
parameters from the data, no starting estimates need to be provided.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'selfStart'</span>
nlsList<span class="token punctuation">(</span>model<span class="token punctuation">,</span> data<span class="token punctuation">,</span> start<span class="token punctuation">,</span> control<span class="token punctuation">,</span> level<span class="token punctuation">,</span> subset<span class="token punctuation">,</span>
        na.action <span class="token operator">=</span> na.fail<span class="token punctuation">,</span> pool <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> warn.nls <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a <code>"<a href="https://r-universe.dev/manuals/stats.html#selfStart">selfStart</a>"</code> model function, which calculates
initial estimates for the model parameters from <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to interpret the variables in
<code>model</code>. Because no grouping factor can be specified in
<code>model</code>, <code>data</code> must inherit from class
<code>"<a href="#groupedData">groupedData</a>"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an optional named list with initial values for the
parameters to be estimated in <code>model</code>. It is passed as the
<code>start</code> argument to each <code>nls</code> call and is required when
the nonlinear function in <code>model</code> does not inherit from class
<code>selfStart</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values passed as the <code>control</code>
argument to <code>nls</code>. Defaults to an empty list.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer specifying the level of grouping to
be used when multiple nested levels of grouping are present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of
<code>data</code> that should be used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>nlsList</code> to print an error message and terminate if there are any
incomplete observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool, warn.nls</code></td>
<td>
<p>optional <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code>s, see <code><a href="#nlsList">nlsList</a></code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of <code>nls</code> objects with as many components as the number of
groups defined by the grouping factor. A <code>NULL</code> value is assigned
to the components corresponding to clusters for which the <code>nls</code>
algorithm failed to converge. Generic functions such as <code>coef</code>,
<code>fixed.effects</code>, <code>lme</code>, <code>pairs</code>, <code>plot</code>,
<code>predict</code>, <code>random.effects</code>, <code>summary</code>, and
<code>update</code> have methods that can be applied to an <code>nlsList</code>
object.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#selfStart">selfStart</a></code>, <code><a href="#groupedData">groupedData</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#nls">nls</a></code>, <code><a href="#nlsList">nlsList</a></code>,
<code><a href="#nlme.nlsList">nlme.nlsList</a></code>, <code><a href="#nlsList">nlsList.formula</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> nlsList<span class="token punctuation">(</span>SSasympOff<span class="token punctuation">,</span> CO2<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Oats">

<a href="#Oats" class="help-page-title"><h2>Split-plot Experiment on Varieties of Oats</h2></a>

<h3>Description</h3>

<p>The <code>Oats</code> data frame has 72 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Block</dt>
<dd>
<p>an ordered factor with levels
<code>VI</code> &lt; <code>V</code> &lt; <code>III</code> &lt; <code>IV</code> &lt; <code>II</code> &lt; <code>I</code>
</p>
</dd>
<dt>Variety</dt>
<dd>
<p>a factor with levels
<code>Golden Rain</code> 
<code>Marvellous</code> 
<code>Victory</code> 
</p>
</dd>
<dt>nitro</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>yield</dt>
<dd>
<p>a numeric vector
</p>
</dd>
</dl>
<h3>Details</h3>

<p>These data have been introduced by Yates (1935) as an example of a
split-plot design. The treatment structure used in the experiment was
a <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">3 \times 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></code> full factorial, with three varieties of oats
and four concentrations of nitrogen. The experimental units were
arranged into six blocks, each with three whole-plots subdivided into
four subplots. The varieties of oats were assigned randomly to the
whole-plots and the concentrations of nitrogen to the subplots.  All
four concentrations of nitrogen were used on each whole-plot.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.15)
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) <em>Modern Applied
Statistics with S. (4th ed)</em>, Springer, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="Orthodont">

<a href="#Orthodont" class="help-page-title"><h2>Growth curve data on an orthdontic measurement</h2></a>

<h3>Description</h3>

<p>The <code>Orthodont</code> data frame has 108 rows and 4 columns of the
change in an orthdontic measurement over time for several young subjects.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>distance</dt>
<dd>
<p>a numeric vector of distances from the pituitary to the
pterygomaxillary fissure (mm).  These distances are measured
on x-ray images of the skull.
</p>
</dd>
<dt>age</dt>
<dd>
<p>a numeric vector of ages of the subject (yr).
</p>
</dd>
<dt>Subject</dt>
<dd>
<p>an ordered factor indicating the subject on which the
measurement was made.  The levels are labelled <code>M01</code>
to <code>M16</code> for the males and <code>F01</code> to <code>F13</code> for
the females.  The ordering is by increasing average distance
within sex.
</p>
</dd>
<dt>Sex</dt>
<dd>
<p>a factor with levels
<code>Male</code> and
<code>Female</code> 
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Investigators at the University of North Carolina Dental School
followed the growth of 27 children (16 males, 11 females) from age 8
until age 14.  Every two years they measured the distance between the
pituitary and the pterygomaxillary fissure, two points that are easily
identified on x-ray exposures of the side of the head.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.17)
</p>
<p>Potthoff, R. F. and Roy,  S. N. (1964), “A generalized multivariate
analysis of variance model useful especially for growth curve
problems”, <em>Biometrika</em>, <b>51</b>, 313–326.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">formula<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Ovary">

<a href="#Ovary" class="help-page-title"><h2>Counts of Ovarian Follicles</h2></a>

<h3>Description</h3>

<p>The <code>Ovary</code> data frame has 308 rows and 3 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Mare</dt>
<dd>
<p>an ordered factor indicating the mare on which the
measurement is made.
</p>
</dd>
<dt>Time</dt>
<dd>
<p>time in the estrus cycle.  The data were recorded daily from 3
days before ovulation until 3 days after the next ovulation. The
measurement times for each mare are scaled so that the ovulations for
each mare occur at times 0 and 1.
</p>
</dd>
<dt>follicles</dt>
<dd>
<p>the number of ovarian follicles greater than 10 mm in diameter.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Pierson and Ginther (1987) report on a study of the number of large
ovarian follicles detected in different mares at several times in
their estrus cycles.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.18)
</p>
<p>Pierson, R. A. and Ginther, O. J. (1987), Follicular population
dynamics during the estrus cycle of the mare, <em>Animal
Reproduction Science</em>, <b>14</b>, 219-231.
</p>

<hr>
</div>
<div class="container manual-page" id="Oxboys">

<a href="#Oxboys" class="help-page-title"><h2>Heights of Boys in Oxford</h2></a>

<h3>Description</h3>

<p>The <code>Oxboys</code> data frame has 234 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Subject</dt>
<dd>
<p>an ordered factor giving a unique identifier for each boy in
the experiment
</p>
</dd>
<dt>age</dt>
<dd>
<p>a numeric vector giving the standardized age (dimensionless)
</p>
</dd>
<dt>height</dt>
<dd>
<p>a numeric vector giving the height of the boy (cm)
</p>
</dd>
<dt>Occasion</dt>
<dd>
<p>an ordered factor - the result of converting <code>age</code> from a
continuous variable to a count so these slightly unbalanced
data can be analyzed as balanced.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>These data are described in Goldstein (1987) as data on the
height of a selection of boys from Oxford, England versus a
standardized age.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in
S and S-PLUS</em>, Springer, New York.  (Appendix A.19)
</p>

<hr>
</div>
<div class="container manual-page" id="Oxide">

<a href="#Oxide" class="help-page-title"><h2>Variability in Semiconductor Manufacturing</h2></a>

<h3>Description</h3>

<p>The <code>Oxide</code> data frame has 72 rows and 5 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Source</dt>
<dd>
<p>a factor with levels
<code>1</code> and
<code>2</code> 
</p>
</dd>
<dt>Lot</dt>
<dd>
<p>a factor giving a unique identifier for each lot.
</p>
</dd>
<dt>Wafer</dt>
<dd>
<p>a factor giving a unique identifier for each wafer within a lot.
</p>
</dd>
<dt>Site</dt>
<dd>
<p>a factor with levels
<code>1</code>, 
<code>2</code>, and 
<code>3</code> 
</p>
</dd>
<dt>Thickness</dt>
<dd>
<p>a numeric vector giving the thickness of the oxide layer.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>These data are described in Littell et al. (1996, p. 155) as coming
“from a passive data collection study in the semiconductor industry
where the objective is to estimate the variance components to
determine the assignable causes of the observed variability.” The
observed response is the thickness of the oxide layer on silicon
wafers, measured at three different sites of each of three wafers
selected from each of eight lots sampled from the population of
lots.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.20)
</p>
<p>Littell, R. C., Milliken, G. A., Stroup, W. W. and Wolfinger,
R. D. (1996), <em>SAS System for Mixed Models</em>, SAS Institute,
Cary, NC.
</p>

<hr>
</div>
<div class="container manual-page" id="pairs.compareFits">

<a href="#pairs.compareFits" class="help-page-title"><h2>Pairs Plot of compareFits Object</h2></a>

<h3>Description</h3>

<p>Scatter plots of the values being compared are generated for each pair
of coefficients in <code>x</code>. Different symbols (colors) are used
for each object being compared and values corresponding to the same
group are joined by a line, to facilitate comparison of fits. If only
two coefficients are present, the <code>trellis</code> function
<code>xyplot</code> is used; otherwise the <code>trellis</code> function <code>splom</code>
is used.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'compareFits'</span>
pairs<span class="token punctuation">(</span>x<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>compareFits</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional logical or integer vector specifying which
rows of <code>x</code> should be used in the plots. If missing, all
rows are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>an optional logical value, or list. If <code>TRUE</code>, a legend
is included at the top of the plot indicating which symbols (colors)
correspond to which objects being compared. If <code>FALSE</code>, no legend
is included. If given as a list, <code>key</code> is passed down as an
argument to the <code>trellis</code> function generating the plots
(<code>splom</code> or  <code>xyplot</code>). Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed down to the <code>trellis</code>
function generating the plots.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Pairwise scatter plots of the values being compared, with different
symbols (colors) used for each object under comparison.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates </p>


<h3>See Also</h3>

<p><code><a href="#compareFits">compareFits</a></code>,
<code><a href="#plot.compareFits">plot.compareFits</a></code>,
<code><a href="#pairs.lme">pairs.lme</a></code>,
<code><a href="#pairs.lmList">pairs.lmList</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#splom">splom</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">example<span class="token punctuation">(</span>compareFits<span class="token punctuation">)</span> <span class="token comment"># cF12 &lt;- compareFits(coef(lmList(Orthodont)), .. lme(*))</span>
pairs<span class="token punctuation">(</span>cF12<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pairs.lme">

<a href="#pairs.lme" class="help-page-title"><h2>Pairs Plot of an lme Object</h2></a>

<h3>Description</h3>

<p>Diagnostic plots for the linear mixed-effects fit are obtained. The
<code>form</code> argument gives considerable flexibility in the type of
plot specification. A conditioning expression (on the right side of a
<code>|</code> operator) always implies that different panels are used for
each level of the conditioning factor, according to a Trellis
display. The expression on the right hand side of the formula, before
a <code>|</code> operator, must evaluate to a data frame with at least two
columns. If the data frame has two columns, a scatter plot of the two
variables is displayed (the Trellis function <code>xyplot</code> is
used). Otherwise, if more than two columns are present, a scatter plot
matrix with pairwise scatter plots of the columns in the data frame is
displayed (the Trellis function <code>splom</code> is used). 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
pairs<span class="token punctuation">(</span>x<span class="token punctuation">,</span> form<span class="token punctuation">,</span> label<span class="token punctuation">,</span> id<span class="token punctuation">,</span> idLabels<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula specifying the desired type of
plot. Any variable present in the original data frame used to obtain
<code>x</code> can be referenced. In addition, <code>x</code> itself
can be referenced in the formula using the symbol
<code>"."</code>. Conditional expressions on the right of a <code>|</code>
operator can be used to define separate panels in a Trellis
display. The expression on the right hand side of <code>form</code>, and to
the left of the <code>|</code> operator, must evaluate to a data frame with
at least two columns. Default is <code>~ coef(.) </code>, corresponding to
a pairs plot of the coefficients evaluated at the innermost level of
nesting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>an optional character vector of labels for the variables
in the pairs plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>an optional numeric value, or one-sided formula. If given as
a value, it is used as a significance level for an outlier
test based on the Mahalanobis distances of the estimated random
effects. Groups with random effects distances greater than the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">1-value</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span></code> percentile of the appropriate chi-square distribution
are identified in the plot using <code>idLabels</code>. If given as a
one-sided formula, its right hand side must evaluate to a  logical,
integer, or character vector which is used to identify points in the
plot. If missing, no points are identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idLabels</code></td>
<td>
<p>an optional vector, or one-sided formula. If given as a
vector, it is converted to character and used to label the
points identified according to <code>id</code>. If given as a
one-sided formula, its right hand side must evaluate to a vector
which is converted to character and used to label the identified
points. Default is the innermost grouping factor. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis plot function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a diagnostic Trellis plot.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>,
<code><a href="#pairs.compareFits">pairs.compareFits</a></code>, 
<code><a href="#pairs.lmList">pairs.lmList</a></code>, 
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#splom">splom</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>

<span class="token comment"># scatter plot of coefficients by gender, identifying unusual subjects</span>
pairs<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> <span class="token operator">~</span>coef<span class="token punctuation">(</span>.<span class="token punctuation">,</span> augFrame <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token operator">|</span> Sex<span class="token punctuation">,</span> id <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">)</span>    

<span class="token comment"># scatter plot of estimated random effects :</span>
pairs<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> <span class="token operator">~</span>ranef<span class="token punctuation">(</span>.<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pairs.lmList">

<a href="#pairs.lmList" class="help-page-title"><h2>Pairs Plot of an lmList Object</h2></a>

<h3>Description</h3>

<p>Diagnostic plots for the linear model fits corresponding to the
<code>x</code>  components  are obtained. The <code>form</code> argument
gives considerable  flexibility in the type of plot specification. A
conditioning  expression (on the right side of a <code>|</code> operator)
always implies  that different panels are used for  each level of the
conditioning  factor, according to a Trellis display. The expression
on the right  hand side of the formula, before a <code>|</code> operator,
must evaluate to  a data frame with at least two columns. If the data
frame has two  columns, a scatter plot of the two variables is
displayed (the Trellis  function <code>xyplot</code> is used). Otherwise, if
more than two columns  are present, a scatter plot matrix with
pairwise scatter plots of the  columns in the data frame is displayed
(the Trellis function  <code>splom</code> is used).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
pairs<span class="token punctuation">(</span>x<span class="token punctuation">,</span> form<span class="token punctuation">,</span> label<span class="token punctuation">,</span> id<span class="token punctuation">,</span> idLabels<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula specifying the desired type of
plot. Any variable present in the original data frame used to obtain
<code>x</code> can be referenced. In addition, <code>x</code> itself
can be referenced in the formula using the symbol
<code>"."</code>. Conditional expressions on the right of a <code>|</code>
operator can be used to define separate panels in a Trellis
display. The expression on the right hand side of <code>form</code>, and to
the left of the <code>|</code> operator, must evaluate to a data frame with
at least two columns. Default is <code>~ coef(.) </code>, corresponding to
a pairs plot of the coefficients of <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>an optional character vector of labels for the variables
in the pairs plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>an optional numeric value, or one-sided formula. If given as
a value, it is used as a significance level for an outlier
test based on the Mahalanobis distances of the estimated random
effects. Groups with random effects distances greater than the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">1-value</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span></code> percentile of the appropriate chi-square distribution
are identified in the plot using <code>idLabels</code>. If given as a
one-sided formula, its right hand side must evaluate to a  logical,
integer, or character vector which is used to identify points in the
plot. If missing, no points are identified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idLabels</code></td>
<td>
<p>an optional vector, or one-sided formula. If given as a
vector, it is converted to character and used to label the
points identified according to <code>id</code>. If given as a
one-sided formula, its right hand side must evaluate to a vector
which is converted to character and used to label the identified
points. Default is the innermost grouping factor.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis plot function.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a diagnostic Trellis plot.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>,
<code><a href="#pairs.lme">pairs.lme</a></code>,
<code><a href="#pairs.compareFits">pairs.compareFits</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#splom">splom</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>

<span class="token comment"># scatter plot of coefficients by gender, identifying unusual subjects</span>
pairs<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> <span class="token operator">~</span>coef<span class="token punctuation">(</span>.<span class="token punctuation">)</span> <span class="token operator">|</span> Sex<span class="token punctuation">,</span> id <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">)</span>

<span class="token comment"># scatter plot of estimated random effects -- "bivariate Gaussian (?)"</span>
pairs<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> <span class="token operator">~</span>ranef<span class="token punctuation">(</span>.<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="PBG">

<a href="#PBG" class="help-page-title"><h2>Effect of Phenylbiguanide on Blood Pressure</h2></a>

<h3>Description</h3>

<p>The <code>PBG</code> data frame has 60 rows and 5 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>deltaBP</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>dose</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>Run</dt>
<dd>
<p>an ordered factor with levels
<code>T5</code> &lt; <code>T4</code> &lt; <code>T3</code> &lt; <code>T2</code> &lt; <code>T1</code> &lt; <code>P5</code> &lt; <code>P3</code> &lt; <code>P2</code> &lt; <code>P4</code> &lt; <code>P1</code>
</p>
</dd>
<dt>Treatment</dt>
<dd>
<p>a factor with levels
<code>MDL 72222</code> 
<code>Placebo</code> 
</p>
</dd>
<dt>Rabbit</dt>
<dd>
<p>an ordered factor with levels
<code>5</code> &lt; <code>3</code> &lt; <code>2</code> &lt; <code>4</code> &lt; <code>1</code>
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Data on an experiment to examine the effect of a antagonist MDL 72222
on the change in blood pressure experienced with increasing dosage of
phenylbiguanide are described in Ludbrook (1994) and analyzed
in Venables and Ripley (2002, section 10.3).  Each of five rabbits was exposed to
increasing doses of phenylbiguanide after having either a placebo or
the HD5-antagonist MDL 72222 administered.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.21)
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) <em>Modern Applied
Statistics with S (4th ed)</em>, Springer, New York.
</p>
<p>Ludbrook, J. (1994), Repeated measurements and multiple comparisons
in cardiovascular research, <em>Cardiovascular Research</em>,
<b>28</b>, 303-311.
</p>

<hr>
</div>
<div class="container manual-page" id="pdBlocked">

<a href="#pdBlocked" class="help-page-title"><h2>Positive-Definite Block Diagonal Matrix</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>pdBlocked</code> class,
representing a positive-definite block-diagonal matrix. Each
block-diagonal element of the underlying  matrix is itself a
positive-definite matrix and is represented internally as an
individual <code>pdMat</code> object. When <code>value</code> is
<code>numeric(0)</code>, a list of uninitialized <code>pdMat</code> objects, a
list of one-sided formulas, or a list of vectors 
of character strings,  <code>object</code> is returned
as an uninitialized <code>pdBlocked</code> object (with just some of its
attributes and its class defined) and needs to have its coefficients
assigned later, generally using the <code>coef</code> or <code>matrix</code> replacement
functions. If <code>value</code> is a list of  initialized <code>pdMat</code>
objects, <code>object</code> will be constructed from the list obtained by
applying <code>as.matrix</code> to each of the <code>pdMat</code> elements of
<code>value</code>. Finally, if <code>value</code> is a list of numeric vectors,
they are assumed to represent the unrestricted coefficients
of the block-diagonal elements of the  underlying positive-definite
matrix.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdBlocked<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">,</span> pdClass<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional list with elements to be used as the
<code>value</code> argument to other <code>pdMat</code> constructors. These
include: <code>pdMat</code> objects, positive-definite
matrices, one-sided linear formulas, vectors of character strings, or
numeric vectors. All elements in the list must be similar (e.g. all
one-sided formulas, or all numeric vectors). Defaults to
<code>numeric(0)</code>, corresponding to an uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional list of one-sided linear formulas specifying the
row/column names for the block-diagonal elements of the matrix
represented by <code>object</code>. Because factors may be present in
<code>form</code>, the formulas needs to be evaluated on a data.frame to
resolve the names they define. This argument is ignored when
<code>value</code> is a list of one-sided formulas. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional list of vector of character strings specifying the
row/column names for the block-diagonal elements of the matrix
represented by object. Each of its components must have  
length equal to the dimension of the corresponding block-diagonal
element and unreplicated elements. This argument is ignored when 
<code>value</code> is a list of vector of character strings. Defaults to 
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>. It is used to
obtain the levels for <code>factors</code>, which affect the
dimensions and the row/column names of the underlying matrix. If
<code>NULL</code>, no attempt is made to obtain information on any
<code>factors</code> appearing in the formulas. Defaults to the parent
frame from which the function was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdClass</code></td>
<td>
<p>an optional vector of character strings naming the
<code>pdMat</code> classes to be assigned to the individual blocks in the
underlying matrix. If a single class is specified, it is used for all
block-diagonal elements. This argument will only be used when
<code>value</code> is missing, or its elements are not <code>pdMat</code>
objects. Defaults to <code>"pdSymm"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdBlocked</code> object representing a positive-definite
block-diagonal matrix, also inheriting from class <code>pdMat</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. p. 162.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>,
<code><a href="#coef.pdMat">coef.pdMat</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#Matrix.pdMat">matrix&lt;-.pdMat</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdBlocked<span class="token punctuation">(</span>list<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 nam <span class="token operator">=</span> list<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"a1"</span><span class="token punctuation">,</span> <span class="token string">"a2"</span><span class="token punctuation">,</span> <span class="token string">"a3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pd1</code></pre>

<hr>
</div>
<div class="container manual-page" id="pdClasses">

<a href="#pdClasses" class="help-page-title"><h2>Positive-Definite Matrix Classes</h2></a>

<h3>Description</h3>

<p>Standard classes of positive-definite matrices (<code>pdMat</code>)
structures  available in the <code>nlme</code> package. 
</p>


<h3>Value</h3>

<p>Available standard classes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pdSymm</code></td>
<td>
<p>general positive-definite matrix, with no additional
structure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdLogChol</code></td>
<td>
<p>general positive-definite matrix, with no additional
structure, using a log-Cholesky parameterization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdDiag</code></td>
<td>
<p>diagonal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdIdent</code></td>
<td>
<p>multiple of an identity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdCompSymm</code></td>
<td>
<p>compound symmetry structure (constant diagonal and
constant off-diagonal elements)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdBlocked</code></td>
<td>
<p>block-diagonal matrix, with diagonal blocks of any
"atomic" <code>pdMat</code> class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdNatural</code></td>
<td>
<p>general positive-definite matrix in natural
parametrization (i.e. parametrized in terms of standard deviations
and correlations). The underlying coefficients are not unrestricted,
so this class should NOT be used for optimization.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Users may define their own <code>pdMat</code> classes by specifying a
<code>constructor</code> function and, at a minimum, methods for the
functions <code>pdConstruct</code>, <code>pdMatrix</code> and <code>coef</code>. For
examples of these functions, see the methods for classes <code>pdSymm</code>
and <code>pdDiag</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#pdBlocked">pdBlocked</a></code>,
<code><a href="#pdCompSymm">pdCompSymm</a></code>,
<code><a href="#pdDiag">pdDiag</a></code>,
<code><a href="#pdFactor">pdFactor</a></code>, 
<code><a href="#pdIdent">pdIdent</a></code>,
<code><a href="#pdMat">pdMat</a></code>,
<code><a href="#pdMatrix">pdMatrix</a></code>,
<code><a href="#pdNatural">pdNatural</a></code>,
<code><a href="#pdSymm">pdSymm</a></code>,
<code><a href="#pdLogChol">pdLogChol</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="pdCompSymm">

<a href="#pdCompSymm" class="help-page-title"><h2>Positive-Definite Matrix with Compound Symmetry Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>pdCompSymm</code> class,
representing a positive-definite matrix with compound symmetry
structure (constant diagonal and constant off-diagonal elements). The
underlying matrix is represented by 2 unrestricted parameters.
When <code>value</code> is <code>numeric(0)</code>, an uninitialized <code>pdMat</code>
object, a one-sided formula, or a vector of character strings,
<code>object</code> is returned  as an uninitialized <code>pdCompSymm</code>
object (with just some of its  attributes and its class defined) and
needs to have its coefficients assigned later, generally using the
<code>coef</code> or <code>matrix</code> replacement functions. If <code>value</code> is
an initialized
<code>pdMat</code> object, <code>object</code> will be constructed from 
<code>as.matrix(value)</code>. Finally, if <code>value</code> is a numeric vector
of length 2, it is assumed to represent the unrestricted coefficients
of the underlying positive-definite matrix.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdCompSymm<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional initialization value, which can be any of the
following: a <code>pdMat</code> object, a positive-definite
matrix, a one-sided linear formula (with variables separated by
<code>+</code>), a vector of character strings, or a numeric
vector of length 2. Defaults to <code>numeric(0)</code>, corresponding to
an uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided linear formula specifying the
row/column names for the matrix represented by <code>object</code>. Because
factors may be present in <code>form</code>, the formula needs to be
evaluated on a data.frame to resolve the names it defines. This
argument is ignored when <code>value</code> is a one-sided
formula. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional vector of character strings specifying the
row/column names for the matrix represented by object. It must have 
length equal to the dimension of the underlying positive-definite
matrix and unreplicated elements. This argument is ignored when
<code>value</code> is a vector of character strings. Defaults to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>. It is used to
obtain the levels for <code>factors</code>, which affect the
dimensions and the row/column names of the underlying matrix. If
<code>NULL</code>, no attempt is made to obtain information on 
<code>factors</code> appearing in the formulas. Defaults to the
parent frame from which the function was called.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdCompSymm</code> object representing a positive-definite
matrix with compound symmetry structure, also inheriting from class
<code>pdMat</code>.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. p. 161.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>,
<code><a href="#coef.pdMat">coef.pdMat</a></code>,
<code><a href="#Matrix.pdMat">matrix&lt;-.pdMat</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdCompSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> nam <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pd1</code></pre>

<hr>
</div>
<div class="container manual-page" id="pdConstruct">

<a href="#pdConstruct" class="help-page-title"><h2>Construct pdMat Objects</h2></a>

<h3>Description</h3>

<p>This function is an alternative constructor for the <code>pdMat</code>
class associated with <code>object</code> and is mostly used internally in other
functions. See the documentation on the principal constructor
function, generally with the same name as the <code>pdMat</code> class of
object. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdConstruct<span class="token punctuation">(</span>object<span class="token punctuation">,</span> value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>pdMat</code>, representing
a positive definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional initialization value, which can be any of the
following: a <code>pdMat</code> object, a positive-definite
matrix, a one-sided linear formula (with variables separated by
<code>+</code>), a vector of character strings, or a numeric
vector. Defaults to <code>numeric(0)</code>, corresponding to an
uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided linear formula specifying the
row/column names for the matrix represented by <code>object</code>. Because
factors may be present in <code>form</code>, the formula needs to be
evaluated on a data.frame to resolve the names it defines. This
argument is ignored when <code>value</code> is a one-sided
formula. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional vector of character strings specifying the
row/column names for the matrix represented by object. It must have 
length equal to the dimension of the underlying positive-definite
matrix and unreplicated elements. This argument is ignored when
<code>value</code> is a vector of character strings. Defaults to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>. It is used to
obtain the levels for <code>factors</code>, which affect the
dimensions and the row/column names of the underlying matrix. If
<code>NULL</code>, no attempt is made to obtain information on 
<code>factors</code> appearing in the formulas. Defaults to the
parent frame from which the function was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments for some methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdMat</code> object representing a positive-definite matrix,
inheriting from the same classes as <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#pdCompSymm">pdCompSymm</a></code>, <code><a href="#pdDiag">pdDiag</a></code>,
<code><a href="#pdIdent">pdIdent</a></code>, <code><a href="#pdNatural">pdNatural</a></code>, <code><a href="#pdSymm">pdSymm</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdSymm<span class="token punctuation">(</span><span class="token punctuation">)</span>
pdConstruct<span class="token punctuation">(</span>pd1<span class="token punctuation">,</span> diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pdConstruct.pdBlocked">

<a href="#pdConstruct.pdBlocked" class="help-page-title"><h2>Construct pdBlocked Objects</h2></a>

<h3>Description</h3>

<p>This function give an alternative constructor for the <code>pdBlocked</code>
class, representing a positive-definite block-diagonal matrix. Each
block-diagonal element of the underlying  matrix is itself a
positive-definite matrix and is represented internally as an
individual <code>pdMat</code> object. When <code>value</code> is
<code>numeric(0)</code>, a list of uninitialized <code>pdMat</code> objects, a
list of one-sided formulas, or a list of vectors of character strings,
<code>object</code> is returned as an uninitialized <code>pdBlocked</code> object
(with just some of its attributes and its class defined) and needs to
have its coefficients assigned later, generally using the <code>coef</code>
or <code>matrix</code> replacement functions. If <code>value</code> is a list of  initialized
<code>pdMat</code> objects, <code>object</code> will be constructed from the list
obtained by applying <code>as.matrix</code> to each of the <code>pdMat</code>
elements of <code>value</code>. Finally, if <code>value</code> is a list of
numeric vectors, they are assumed to represent the unrestricted
coefficients of the block-diagonal elements of the  underlying
positive-definite matrix.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdBlocked'</span>
pdConstruct<span class="token punctuation">(</span>object<span class="token punctuation">,</span> value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">,</span> pdClass<span class="token punctuation">,</span>
<span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"pdBlocked"</code>,
representing a positive definite block-diagonal matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional list with elements to be used as the
<code>value</code> argument to other <code>pdMat</code> constructors. These
include: <code>pdMat</code> objects, positive-definite
matrices, one-sided linear formulas, vectors of character strings, or
numeric vectors. All elements in the list must be similar (e.g. all
one-sided formulas, or all numeric vectors). Defaults to
<code>numeric(0)</code>, corresponding to an uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional list of one-sided linear formula specifying the
row/column names for the block-diagonal elements of the matrix
represented by <code>object</code>. Because factors may be present in
<code>form</code>, the formulas needs to be evaluated on a data.frame to
resolve the names they defines. This argument is ignored when
<code>value</code> is a list of one-sided formulas. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional list of vector of character strings specifying the
row/column names for the block-diagonal elements of the matrix
represented by object. Each of its components must have  
length equal to the dimension of the corresponding block-diagonal
element and unreplicated elements. This argument is ignored when 
<code>value</code> is a list of vector of character strings. Defaults to 
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>. It is used to
obtain the levels for <code>factors</code>, which affect the
dimensions and the row/column names of the underlying matrix. If
<code>NULL</code>, no attempt is made to obtain information on 
<code>factors</code> appearing in the formulas. Defaults to the
parent frame from which the function was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdClass</code></td>
<td>
<p>an optional vector of character strings naming the
<code>pdMat</code> classes to be assigned to the individual blocks in the
underlying matrix. If a single class is specified, it is used for all
block-diagonal elements. This argument will only be used when
<code>value</code> is missing, or its elements are not <code>pdMat</code>
objects. Defaults to <code>"pdSymm"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdBlocked</code> object representing a positive-definite
block-diagonal matrix, also inheriting from class <code>pdMat</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>,
<code><a href="#coef.pdMat">coef.pdMat</a></code>,
<code><a href="#pdBlocked">pdBlocked</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#pdConstruct">pdConstruct</a></code>,
<code><a href="#Matrix.pdMat">matrix&lt;-.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdBlocked<span class="token punctuation">(</span>list<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"a1"</span><span class="token punctuation">,</span> <span class="token string">"a2"</span><span class="token punctuation">,</span> <span class="token string">"a3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pdConstruct<span class="token punctuation">(</span>pd1<span class="token punctuation">,</span> list<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diag<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pdDiag">

<a href="#pdDiag" class="help-page-title"><h2>Diagonal Positive-Definite Matrix</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>pdDiag</code> class,
representing a diagonal positive-definite matrix. If the matrix
associated with <code>object</code> is of dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, it is
represented by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> unrestricted parameters, given by the logarithm
of the square-root of the diagonal values. When <code>value</code> is
<code>numeric(0)</code>, an uninitialized <code>pdMat</code> object, a one-sided
formula, or a vector of character strings, <code>object</code> is returned
as an uninitialized <code>pdDiag</code> object (with just some of its
attributes and its class defined) and needs to have its coefficients
assigned later, generally using the <code>coef</code> or <code>matrix</code> replacement
functions. If <code>value</code> is an initialized <code>pdMat</code> object,
<code>object</code> will be constructed from
<code>as.matrix(value)</code>. Finally, if <code>value</code> is a numeric vector,
it is assumed to represent the unrestricted coefficients of the
underlying positive-definite
matrix.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdDiag<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional initialization value, which can be any of the
following: a <code>pdMat</code> object, a positive-definite
matrix, a one-sided linear formula (with variables separated by
<code>+</code>), a vector of character strings, or a numeric
vector of length equal to the dimension of the underlying
positive-definite matrix. Defaults to <code>numeric(0)</code>, corresponding
to an uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided linear formula specifying the
row/column names for the matrix represented by <code>object</code>. Because
factors may be present in <code>form</code>, the formula needs to be
evaluated on a data.frame to resolve the names it defines. This
argument is ignored when <code>value</code> is a one-sided
formula. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional vector of character strings specifying the
row/column names for the matrix represented by object. It must have 
length equal to the dimension of the underlying positive-definite
matrix and unreplicated elements. This argument is ignored when
<code>value</code> is a vector of character strings. Defaults to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>. It is used to
obtain the levels for <code>factors</code>, which affect the
dimensions and the row/column names of the underlying matrix. If
<code>NULL</code>, no attempt is made to obtain information on 
<code>factors</code> appearing in the formulas. Defaults to the
parent frame from which the function was called.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdDiag</code> object representing a diagonal positive-definite
matrix, also inheriting from class <code>pdMat</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>,
<code><a href="#coef.pdMat">coef.pdMat</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#Matrix.pdMat">matrix&lt;-.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdDiag<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nam <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pd1</code></pre>

<hr>
</div>
<div class="container manual-page" id="pdFactor">

<a href="#pdFactor" class="help-page-title"><h2>Square-Root Factor of a Positive-Definite Matrix</h2></a>

<h3>Description</h3>

<p>A square-root factor of the positive-definite matrix represented by
<code>object</code> is obtained. Letting <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></code> denote a
positive-definite matrix, a square-root factor of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></code> is
any square matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> such that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi><mo>=</mo><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>L</mi></mrow><annotation encoding="application/x-tex">\Sigma = L'L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">L</span></span></span></span></code>. This function extracts <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdFactor<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>pdMat</code>, representing
a positive definite matrix, which must have been initialized
(i.e. <code>length(coef(object)) &gt; 0</code>).</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a vector with a square-root factor of the positive-definite matrix
associated with <code>object</code> stacked column-wise.
</p>


<h3>Note</h3>

<p>This function is used intensively in optimization
algorithms and its value is returned as a vector for efficiency
reasons. The <code>pdMatrix</code> function can be used to obtain
square-root factors in matrix form.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#pdMatrix">pdMatrix</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdCompSymm<span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
pdFactor<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pdFactor.reStruct">

<a href="#pdFactor.reStruct" class="help-page-title"><h2>Extract Square-Root Factor from Components of an reStruct Object</h2></a>

<h3>Description</h3>

<p>This method function extracts square-root factors of the
positive-definite matrices corresponding to the <code>pdMat</code> elements
of <code>object</code>.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
pdFactor<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a vector with square-root factors of the positive-definite matrices
corresponding to the elements of <code>object</code> stacked column-wise.
</p>


<h3>Note</h3>

<p>This function is used intensively in optimization
algorithms and its value is returned as a vector for efficiency
reasons. The <code>pdMatrix</code> function can be used to obtain
square-root factors in matrix form.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#pdFactor">pdFactor</a></code>,
<code><a href="#pdMatrix.reStruct">pdMatrix.reStruct</a></code>,
<code><a href="#pdFactor">pdFactor.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">~</span>age<span class="token operator">+</span>Sex<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span><span class="token punctuation">)</span>
pdFactor<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pdIdent">

<a href="#pdIdent" class="help-page-title"><h2>Multiple of the Identity Positive-Definite Matrix</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>pdIdent</code> class,
representing a multiple of the identity positive-definite matrix. 
The matrix associated with <code>object</code> is represented by 1
unrestricted parameter, given by the logarithm of the square-root of
the diagonal value. When <code>value</code> is 
<code>numeric(0)</code>, an uninitialized <code>pdMat</code> object, a one-sided
formula, or a vector of character strings, <code>object</code> is returned
as an uninitialized <code>pdIdent</code> object (with just some of its
attributes and its class defined) and needs to have its coefficients
assigned later, generally using the <code>coef</code> or <code>matrix</code> replacement
functions. If <code>value</code> is an initialized <code>pdMat</code> object,
<code>object</code> will be constructed from
<code>as.matrix(value)</code>. Finally, if <code>value</code> is a numeric value,
it is assumed to represent the unrestricted coefficient of the
underlying positive-definite  matrix.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdIdent<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional initialization value, which can be any of the
following: a <code>pdMat</code> object, a positive-definite
matrix, a one-sided linear formula (with variables separated by
<code>+</code>), a vector of character strings, or a numeric
value. Defaults to <code>numeric(0)</code>, corresponding
to an uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided linear formula specifying the
row/column names for the matrix represented by <code>object</code>. Because
factors may be present in <code>form</code>, the formula needs to be
evaluated on a data.frame to resolve the names it defines. This
argument is ignored when <code>value</code> is a one-sided
formula. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional vector of character strings specifying the
row/column names for the matrix represented by object. It must have 
length equal to the dimension of the underlying positive-definite
matrix and unreplicated elements. This argument is ignored when
<code>value</code> is a vector of character strings. Defaults to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>. It is used to
obtain the levels for <code>factors</code>, which affect the
dimensions and the row/column names of the underlying matrix. If
<code>NULL</code>, no attempt is made to obtain information on 
<code>factors</code> appearing in the formulas. Defaults to the
parent frame from which the function was called.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdIdent</code> object representing a multiple of the identity
positive-definite matrix, also inheriting from class <code>pdMat</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>,
<code><a href="#coef.pdMat">coef.pdMat</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#Matrix.pdMat">matrix&lt;-.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdIdent<span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nam <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pd1</code></pre>

<hr>
</div>
<div class="container manual-page" id="pdLogChol">

<a href="#pdLogChol" class="help-page-title"><h2>General Positive-Definite Matrix</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>pdLogChol</code> class,
representing a general positive-definite matrix.  If the matrix
associated with <code>object</code> is of dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, it is
represented by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n(n+1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code> unrestricted parameters,
using the log-Cholesky parametrization described in Pinheiro and
Bates (1996).
</p>

<ul>
<li>
<p> When <code>value</code> is <code>numeric(0)</code>, an uninitialized <code>pdMat</code>
object, a one-sided formula, or a character vector, <code>object</code> is
returned as an <em>uninitialized</em> <code>pdLogChol</code> object (with just
some of its attributes and its class defined) and needs to have its
coefficients assigned later, generally using the <code>coef</code> or
<code>matrix</code> replacement functions.
</p>
</li>
<li>
<p> If <code>value</code> is an <em>initialized</em> <code>pdMat</code> object,
<code>object</code> will be constructed from <code>as.matrix(value)</code>.
</p>
</li>
<li>
<p> Finally, if <code>value</code> is a numeric vector, it is assumed to
represent the unrestricted coefficients of the matrix-logarithm
parametrization of the underlying positive-definite matrix.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdLogChol<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional initialization value, which can be any of the
following: a <code>pdMat</code> object, a positive-definite
matrix, a one-sided linear formula (with variables separated by
<code>+</code>), a vector of character strings, or a numeric
vector.  Defaults to <code>numeric(0)</code>, corresponding to an
uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided linear formula specifying the
row/column names for the matrix represented by <code>object</code>.  Because
factors may be present in <code>form</code>, the formula needs to be
evaluated on a data frame to resolve the names it defines.  This
argument is ignored when <code>value</code> is a one-sided
formula.  Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional character vector specifying the row/column names
for the matrix represented by object.  It must have length equal to
the dimension of the underlying positive-definite matrix and
unreplicated elements.  This argument is ignored when
<code>value</code> is a character vector.  Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>.  It is used to obtain the
levels for <code>factors</code>, which affect the dimensions and the
row/column names of the underlying matrix.  If <code>NULL</code>, no
attempt is made to obtain information on <code>factor</code>s appearing in
the formulas.  Defaults to the parent frame from which the function
was called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Internally, the <code>pdLogChol</code> representation of a symmetric
positive definite matrix is a vector starting with the logarithms of
the diagonal of the Choleski factorization of that matrix followed by
its upper triangular portion.
</p>


<h3>Value</h3>

<p>a <code>pdLogChol</code> object representing a general positive-definite
matrix, also inheriting from class <code>pdMat</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C. and Bates., D.M. (1996)
Unconstrained Parametrizations for Variance-Covariance Matrices,
<em>Statistics and Computing</em> <b>6</b>, 289–296.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000)
<em>Mixed-Effects Models in S and S-PLUS</em>, Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>,
<code><a href="#coef.pdMat">coef.pdMat</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#Matrix.pdMat">matrix&lt;-.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>pd1 <span class="token operator">&lt;-</span> pdLogChol<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nam <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>pd4 <span class="token operator">&lt;-</span> pdLogChol<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>pd4c <span class="token operator">&lt;-</span> chol<span class="token punctuation">(</span>pd4<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; upper-tri matrix with off-diagonals  4 5 6</span>
pd4c<span class="token punctuation">[</span>upper.tri<span class="token punctuation">(</span>pd4c<span class="token punctuation">)</span><span class="token punctuation">]</span>
log<span class="token punctuation">(</span>diag<span class="token punctuation">(</span>pd4c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 1 2 3</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pdMat">

<a href="#pdMat" class="help-page-title"><h2>Positive-Definite Matrix</h2></a>

<h3>Description</h3>

<p>This function gives an alternative way of constructing an object
inheriting from the <code>pdMat</code> class named in <code>pdClass</code>, or
from <code>data.class(object)</code> if <code>object</code> inherits from
<code>pdMat</code>,  and is mostly used internally in other functions. See
the documentation on the principal constructor function, generally
with the same name as the <code>pdMat</code> class of object. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdMat<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">,</span> pdClass<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional initialization value, which can be any of the
following: a <code>pdMat</code> object, a positive-definite
matrix, a one-sided linear formula (with variables separated by
<code>+</code>), a vector of character strings, or a numeric
vector. Defaults to <code>numeric(0)</code>, corresponding to an
uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided linear formula specifying the
row/column names for the matrix represented by <code>object</code>. Because
factors may be present in <code>form</code>, the formula needs to be
evaluated on a data.frame to resolve the names it defines. This
argument is ignored when <code>value</code> is a one-sided
formula. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional vector of character strings specifying the
row/column names for the matrix represented by object. It must have 
length equal to the dimension of the underlying positive-definite
matrix and unreplicated elements. This argument is ignored when
<code>value</code> is a vector of character strings. Defaults to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>. It is used to
obtain the levels for <code>factors</code>, which affect the
dimensions and the row/column names of the underlying matrix. If
<code>NULL</code>, no attempt is made to obtain information on 
<code>factors</code> appearing in the formulas. Defaults to the
parent frame from which the function was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdClass</code></td>
<td>
<p>an optional character string naming the
<code>pdMat</code> class to be assigned to the returned object. This
argument will only be used when <code>value</code> is not a <code>pdMat</code> 
object. Defaults to <code>"pdSymm"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdMat</code> object representing a positive-definite matrix,
inheriting from the class named in <code>pdClass</code>, or from
<code>class(object)</code>, if <code>object</code> inherits from <code>pdMat</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#pdClasses">pdClasses</a></code>, 
<code><a href="#pdCompSymm">pdCompSymm</a></code>, <code><a href="#pdDiag">pdDiag</a></code>,
<code><a href="#pdIdent">pdIdent</a></code>, <code><a href="#pdNatural">pdNatural</a></code>,
<code><a href="#pdSymm">pdSymm</a></code>,
<code><a href="#reStruct">reStruct</a></code>,
<code><a href="#solve.pdMat">solve.pdMat</a></code>, 
<code><a href="#summary.pdMat">summary.pdMat</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdMat<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pdClass <span class="token operator">=</span> <span class="token string">"pdDiag"</span><span class="token punctuation">)</span>
pd1</code></pre>

<hr>
</div>
<div class="container manual-page" id="pdMatrix">

<a href="#pdMatrix" class="help-page-title"><h2>Extract Matrix or Square-Root Factor from a pdMat Object</h2></a>

<h3>Description</h3>

<p>The positive-definite matrix represented by <code>object</code>, or a
square-root factor of it is obtained. Letting <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></code> denote a
positive-definite matrix, a square-root factor of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></code> is
any square matrix <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code> such that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi><mo>=</mo><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>L</mi></mrow><annotation encoding="application/x-tex">\Sigma = L'L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">L</span></span></span></span></code>. This function extracts <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></code> or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdMatrix<span class="token punctuation">(</span>object<span class="token punctuation">,</span> factor<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>pdMat</code>, representing
a positive definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, a square-root
factor of the positive-definite matrix represented by <code>object</code>
is returned; else, if <code>FALSE</code>, the positive-definite matrix is
returned. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>fact</code> is <code>FALSE</code> the positive-definite matrix
represented by <code>object</code> is returned; else a square-root of the
positive-definite matrix is returned.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. p. 162.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#pdFactor">pdFactor</a></code>,
<code><a href="#pdMat">pdMat</a></code>,
<code><a href="#pdMatrix.reStruct">pdMatrix.reStruct</a></code>,
<code><a href="#corMatrix">corMatrix</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pdMatrix<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pdMatrix.reStruct">

<a href="#pdMatrix.reStruct" class="help-page-title"><h2>Extract Matrix or Square-Root Factor from Components of an
reStruct Object</h2></a>

<h3>Description</h3>

<p>This method function extracts the positive-definite  matrices
corresponding to the <code>pdMat</code> elements of <code>object</code>, or
square-root factors of the positive-definite matrices. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
pdMatrix<span class="token punctuation">(</span>object<span class="token punctuation">,</span> factor<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, square-root
factors of the positive-definite matrices represented by the elements
of <code>object</code> are returned; else, if <code>FALSE</code>, the
positive-definite matrices are returned. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components given by the positive-definite matrices
corresponding to the elements of <code>object</code>, or square-root factors
of the positive-definite matrices.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. p. 162.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.reStruct">as.matrix.reStruct</a></code>,
<code><a href="#reStruct">reStruct</a></code>,
<code><a href="#pdMat">pdMat</a></code>, 
<code><a href="#pdMatrix">pdMatrix</a></code>, 
<code><a href="#pdMatrix">pdMatrix.pdMat</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">~</span>age<span class="token operator">+</span>Sex<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span><span class="token punctuation">)</span>
pdMatrix<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pdNatural">

<a href="#pdNatural" class="help-page-title"><h2>General Positive-Definite Matrix in Natural Parametrization</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>pdNatural</code> class,
representing a general positive-definite matrix, using a natural
parametrization . If the matrix associated with <code>object</code> is of
dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, it is represented by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n(n+1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code>
parameters. Letting <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> denote the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>j</mi></mrow><annotation encoding="application/x-tex">ij</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">ij</span></span></span></span></code>-th
element of the underlying positive definite matrix and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>σ</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><msqrt><mrow><msub><mi>σ</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><msub><mi>σ</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub></mrow></msqrt><mo separator="true">,</mo><mtext>  </mtext><mi>i</mi><mo mathvariant="normal">≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">\rho_{ij}=\sigma_{i}/\sqrt{\sigma_{ii}\sigma_{jj}},\;i\neq j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1328em;vertical-align:-0.3828em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6572em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ii</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">jj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6172em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3828em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></code> denote the associated
"correlations", the "natural" parameters are given by
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><msub><mi>σ</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub></msqrt><mo separator="true">,</mo><mtext>  </mtext><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\sqrt{\sigma_{ii}}, \;i=1,\ldots,n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.3147em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ii</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span></code> and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msub><mi>ρ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>ρ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext>  </mtext><mi>i</mi><mo mathvariant="normal">≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">\log((1+\rho_{ij})/(1-\rho_{ij})),\; i \neq
    j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">((</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></code>. Note that all
natural parameters are individually unrestricted, but not jointly
unrestricted (meaning that not all unrestricted vectors would give
positive-definite matrices). Therefore, this parametrization should
NOT be used for optimization. It is mostly used for deriving
approximate confidence intervals on parameters following the
optimization of an objective function. When <code>value</code> is
<code>numeric(0)</code>, an uninitialized <code>pdMat</code> object, a one-sided
formula, or a vector of character strings, <code>object</code> is returned
as an uninitialized <code>pdSymm</code> object (with just some of its
attributes and its class defined) and needs to have its coefficients
assigned later, generally using the <code>coef</code> or <code>matrix</code> replacement
functions. If <code>value</code> is an initialized <code>pdMat</code> object,
<code>object</code> will be constructed from
<code>as.matrix(value)</code>. Finally, if <code>value</code> is a numeric 
vector, it is assumed to represent the natural parameters of the
underlying positive-definite matrix.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdNatural<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional initialization value, which can be any of the
following: a <code>pdMat</code> object, a positive-definite
matrix, a one-sided linear formula (with variables separated by
<code>+</code>), a vector of character strings, or a numeric
vector. Defaults to <code>numeric(0)</code>, corresponding to an
uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided linear formula specifying the
row/column names for the matrix represented by <code>object</code>. Because
factors may be present in <code>form</code>, the formula needs to be
evaluated on a data.frame to resolve the names it defines. This
argument is ignored when <code>value</code> is a one-sided
formula. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional vector of character strings specifying the
row/column names for the matrix represented by object. It must have 
length equal to the dimension of the underlying positive-definite
matrix and unreplicated elements. This argument is ignored when
<code>value</code> is a vector of character strings. Defaults to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>. It is used to
obtain the levels for <code>factors</code>, which affect the
dimensions and the row/column names of the underlying matrix. If
<code>NULL</code>, no attempt is made to obtain information on 
<code>factors</code> appearing in the formulas. Defaults to the
parent frame from which the function was called.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdNatural</code> object representing a general positive-definite
matrix in natural parametrization, also inheriting from class
<code>pdMat</code>.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. p. 162.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>,
<code><a href="#coef.pdMat">coef.pdMat</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#Matrix.pdMat">matrix&lt;-.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pdNatural<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pdSymm">

<a href="#pdSymm" class="help-page-title"><h2>General Positive-Definite Matrix</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>pdSymm</code> class,
representing a general positive-definite matrix. If the matrix
associated with <code>object</code> is of dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, it is
represented by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n(n+1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code> unrestricted parameters,
using the matrix-logarithm parametrization described in Pinheiro and
Bates (1996). When <code>value</code> is <code>numeric(0)</code>, an uninitialized
<code>pdMat</code> object, a one-sided
formula, or a vector of character strings, <code>object</code> is returned
as an uninitialized <code>pdSymm</code> object (with just some of its
attributes and its class defined) and needs to have its coefficients
assigned later, generally using the <code>coef</code> or <code>matrix</code> replacement
functions. If <code>value</code> is an initialized <code>pdMat</code> object,
<code>object</code> will be constructed from
<code>as.matrix(value)</code>. Finally, if <code>value</code> is a numeric vector,
it is assumed to represent the unrestricted coefficients of the
matrix-logarithm parametrization of the underlying positive-definite
matrix.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pdSymm<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> nam<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional initialization value, which can be any of the
following: a <code>pdMat</code> object, a positive-definite
matrix, a one-sided linear formula (with variables separated by
<code>+</code>), a vector of character strings, or a numeric
vector. Defaults to <code>numeric(0)</code>, corresponding to an
uninitialized object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided linear formula specifying the
row/column names for the matrix represented by <code>object</code>. Because
factors may be present in <code>form</code>, the formula needs to be
evaluated on a data.frame to resolve the names it defines. This
argument is ignored when <code>value</code> is a one-sided
formula. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nam</code></td>
<td>
<p>an optional vector of character strings specifying the
row/column names for the matrix represented by object. It must have 
length equal to the dimension of the underlying positive-definite
matrix and unreplicated elements. This argument is ignored when
<code>value</code> is a vector of character strings. Defaults to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
named in <code>value</code> and <code>form</code>. It is used to
obtain the levels for <code>factors</code>, which affect the
dimensions and the row/column names of the underlying matrix. If
<code>NULL</code>, no attempt is made to obtain information on 
<code>factors</code> appearing in the formulas. Defaults to the
parent frame from which the function was called.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdSymm</code> object representing a general positive-definite
matrix, also inheriting from class <code>pdMat</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C. and Bates., D.M.  (1996) "Unconstrained
Parametrizations for Variance-Covariance Matrices", Statistics and
Computing, 6, 289-296.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#as.matrix.pdMat">as.matrix.pdMat</a></code>,
<code><a href="#coef.pdMat">coef.pdMat</a></code>,
<code><a href="#pdClasses">pdClasses</a></code>,
<code><a href="#Matrix.pdMat">matrix&lt;-.pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nam <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pd1</code></pre>

<hr>
</div>
<div class="container manual-page" id="Phenobarb">

<a href="#Phenobarb" class="help-page-title"><h2>Phenobarbitol Kinetics</h2></a>

<h3>Description</h3>

<p>The <code>Phenobarb</code> data frame has 744 rows and 7 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Subject</dt>
<dd>
<p>an ordered factor identifying the infant.
</p>
</dd>
<dt>Wt</dt>
<dd>
<p>a numeric vector giving the birth weight of the infant (kg).
</p>
</dd>
<dt>Apgar</dt>
<dd>
<p>an ordered factor giving the 5-minute Apgar score for
the infant.  This is an indication of health of the newborn
infant.
</p>
</dd>
<dt>ApgarInd</dt>
<dd>
<p>a factor indicating whether the 5-minute Apgar score is <code>&lt; 5</code>
or <code>&gt;= 5</code>. 
</p>
</dd>
<dt>time</dt>
<dd>
<p>a numeric vector giving the time when the sample is drawn or
drug administered (hr).
</p>
</dd>
<dt>dose</dt>
<dd>
<p>a numeric vector giving the dose of drug administered
(<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></code>g/kg).
</p>
</dd>
<dt>conc</dt>
<dd>
<p>a numeric vector giving the phenobarbital concentration in
the serum (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></code>g/L).
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Data from a pharmacokinetics study of phenobarbital in neonatal
infants.  During the first few days of life the infants receive
multiple doses of phenobarbital for prevention of seizures.  At
irregular intervals blood samples are drawn and serum phenobarbital
concentrations are determined.  The data
were originally given in Grasela and Donn(1985) and are analyzed
in Boeckmann, Sheiner and Beal (1994), in
Davidian and Giltinan (1995), and in Littell et al. (1996).
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.23)
</p>
<p>Davidian, M. and Giltinan, D. M. (1995), <em>Nonlinear Models for
Repeated Measurement Data</em>,  Chapman and Hall, London.  (section 6.6)
</p>
<p>Grasela and Donn (1985), Neonatal population pharmacokinetics of
phenobarbital derived from routine clinical data,
<em>Developmental Pharmacology and Therapeutics</em>, <b>8</b>,
374-383.
</p>
<p>Boeckmann, A. J., Sheiner, L. B., and Beal, S. L. (1994),
<em>NONMEM Users Guide: Part V</em>, University of California, San
Francisco.
</p>
<p>Littell, R. C., Milliken, G. A., Stroup, W. W. and Wolfinger,
R. D. (1996), <em>SAS System for Mixed Models</em>, SAS Institute,
Cary, NC.
</p>

<hr>
</div>
<div class="container manual-page" id="phenoModel">

<a href="#phenoModel" class="help-page-title"><h2>Model function for the Phenobarb data</h2></a>

<h3>Description</h3>

<p>A model function for a model used with the <code>Phenobarb</code> data.
This function uses compiled C code to improve execution speed.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">phenoModel<span class="token punctuation">(</span>Subject<span class="token punctuation">,</span> time<span class="token punctuation">,</span> dose<span class="token punctuation">,</span> lCl<span class="token punctuation">,</span> lV<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Subject</code></td>
<td>
<p>an integer vector of subject identifiers.  These should
be sorted in increasing order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>numeric. A vector of the times at which the sample was drawn or
the drug administered (hr).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose</code></td>
<td>
<p>numeric. A vector of doses of drug administered
(<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></code>g/kg).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lCl</code></td>
<td>
<p>numeric.  A vector of values of the natural log of the
clearance parameter according to <code>Subject</code> and <code>time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lV</code></td>
<td>
<p>numeric.  A vector of values of the natural log of the
effective volume of distribution according to <code>Subject</code> and
<code>time</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the details section of <code><a href="#Phenobarb">Phenobarb</a></code> for a description
of the model function that <code>phenoModel</code> evaluates.
</p>


<h3>Value</h3>

<p>a numeric vector of predicted phenobarbital concentrations.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>
</p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000) <em>Mixed-effects Models in
S and S-PLUS</em>, Springer. (section 6.4)
</p>

<hr>
</div>
<div class="container manual-page" id="Pixel">

<a href="#Pixel" class="help-page-title"><h2>X-ray pixel intensities over time</h2></a>

<h3>Description</h3>

<p>The <code>Pixel</code> data frame has 102 rows and 4 columns of data on the
pixel intensities of CT scans of dogs over time
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Dog</dt>
<dd>
<p>a factor with levels <code>1</code> to <code>10</code> designating the dog
on which the scan was made
</p>
</dd>
<dt>Side</dt>
<dd>
<p>a factor with levels <code>L</code> and <code>R</code> designating the side
of the dog being scanned
</p>
</dd>
<dt>day</dt>
<dd>
<p>a numeric vector giving the day post injection of the contrast
on which the scan was made
</p>
</dd>
<dt>pixel</dt>
<dd>
<p>a numeric vector of pixel intensities
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000) <em>Mixed-effects Models in
S and S-PLUS</em>, Springer.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>pixel <span class="token operator">~</span> day <span class="token operator">+</span> I<span class="token punctuation">(</span>day<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Pixel<span class="token punctuation">,</span>
           random <span class="token operator">=</span> list<span class="token punctuation">(</span>Dog <span class="token operator">=</span> <span class="token operator">~</span> day<span class="token punctuation">,</span> Side <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
VarCorr<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.ACF">

<a href="#plot.ACF" class="help-page-title"><h2>Plot an ACF Object</h2></a>

<h3>Description</h3>

<p>an <code>xyplot</code> of the autocorrelations versus the lags, with
<code>type = "h"</code>, is produced. If <code>alpha &gt; 0</code>, curves
representing the critical limits for a two-sided test of level
<code>alpha</code> for the autocorrelations are added to the plot.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'ACF'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> xlab<span class="token punctuation">,</span> ylab<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>ACF</code>,
consisting of a data frame with two columns named <code>lag</code> and
<code>ACF</code>, representing the autocorrelation values and the
corresponding lags. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>an optional numeric value with the significance level for
testing if the autocorrelations are zero. Lines corresponding to the
lower and upper critical values for a test of level <code>alpha</code> are
added to the plot. Default is <code>0</code>, in which case no lines are
plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>optional character strings with the x- and y-axis
labels. Default respectively to <code>"Lag"</code> and 
<code>"Autocorrelation"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the <code>xyplot</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an <code>xyplot</code> Trellis plot.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#ACF">ACF</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>ACF<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> maxLag <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.augPred">

<a href="#plot.augPred" class="help-page-title"><h2>Plot an augPred Object</h2></a>

<h3>Description</h3>

<p>A Trellis <code>xyplot</code> of predictions versus the primary covariate is
generated, with a different panel for each value of the grouping
factor. Predicted values are joined by lines, with  
different line types (colors) being used for each level of
grouping. Original observations are represented by circles.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'augPred'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> key<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"<a href="#augPred">augPred</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>an optional logical value, or list. If <code>TRUE</code>, a legend
is included at the top of the plot indicating which symbols (colors)
correspond to which prediction levels. If <code>FALSE</code>, no legend
is included. If given as a list, <code>key</code> is passed down as an
argument to the <code>trellis</code> function generating the plots
(<code>xyplot</code>). Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed down to the <code>trellis</code>
function generating the plots.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A Trellis plot of predictions versus the primary covariate, with panels
determined by the grouping factor.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#augPred">augPred</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>augPred<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.compareFits">

<a href="#plot.compareFits" class="help-page-title"><h2>Plot a compareFits Object</h2></a>

<h3>Description</h3>

<p>A Trellis <code>dotplot</code> of the values being compared, with different
rows per group, is generated, with a different panel for each
coefficient. Different symbols (colors) are used for each object being
compared.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'compareFits'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> key<span class="token punctuation">,</span> mark<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"<a href="#compareFits">compareFits</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional logical or integer vector specifying which
rows of <code>x</code> should be used in the plots. If missing, all
rows are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>an optional logical value, or list. If <code>TRUE</code>, a legend
is included at the top of the plot indicating which symbols (colors)
correspond to which objects being compared. If <code>FALSE</code>, no legend
is included. If given as a list, <code>key</code> is passed down as an
argument to the <code>trellis</code> function generating the plots
(<code>dotplot</code>). Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark</code></td>
<td>
<p>an optional numeric vector, of length equal to the number of
coefficients being compared, indicating where vertical lines should
be drawn in the plots. If missing, no lines are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed down to the <code>trellis</code>
function generating the plots.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A Trellis <code>dotplot</code> of the values being compared, with rows
determined by the groups and panels by the coefficients.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#compareFits">compareFits</a></code>, <code><a href="#pairs.compareFits">pairs.compareFits</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">example<span class="token punctuation">(</span>compareFits<span class="token punctuation">)</span> <span class="token comment"># cF12 &lt;- compareFits(coef(lmList(Orthodont)), .. lme(*))</span>
plot<span class="token punctuation">(</span>cF12<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.gls">

<a href="#plot.gls" class="help-page-title"><h2>Plot a gls Object</h2></a>

<h3>Description</h3>

<p>Diagnostic plots for the linear model fit are obtained. The
<code>form</code> argument gives considerable flexibility in the type of
plot specification. A conditioning expression (on the right side of a
<code>|</code> operator) always implies that different panels are used for
each level of the conditioning factor, according to a Trellis
display. If <code>form</code> is a one-sided formula, histograms of the
variable on the right hand side of the formula, before a <code>|</code>
operator, are displayed (the Trellis function <code>histogram</code> is
used). If <code>form</code> is two-sided and both its left and
right hand side variables are numeric, scatter plots are displayed
(the Trellis function <code>xyplot</code> is used). Finally, if <code>form</code>
is two-sided and its left had side variable is a factor, box-plots of
the right hand side variable by the levels of the left hand side
variable are displayed (the Trellis function  <code>bwplot</code> is used). 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> form<span class="token punctuation">,</span> abline<span class="token punctuation">,</span> id<span class="token punctuation">,</span> idLabels<span class="token punctuation">,</span> idResType<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gls">gls</a>"</code>, representing
a generalized least squares fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula specifying the desired type of
plot. Any variable present in the original data frame used to obtain
<code>x</code> can be referenced. In addition, <code>x</code> itself
can be referenced in the formula using the symbol
<code>"."</code>. Conditional expressions on the right of a <code>|</code>
operator can be used to define separate panels in a Trellis
display. Default is <code>resid(., type = "p") ~ fitted(.) </code>,
corresponding to a plot of the standardized residuals versus fitted
values, both evaluated at the innermost level of nesting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline</code></td>
<td>
<p>an optional numeric value, or numeric vector of length
two. If given as a single value, a horizontal line will be added to the
plot at that coordinate; else, if given as a vector, its values are
used as the intercept and slope for a line added to the plot. If
missing, no lines are added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>an optional numeric value, or one-sided formula. If given as
a value, it is used as a significance level for a two-sided outlier
test for the standardized residuals. Observations with
absolute standardized residuals greater than the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1 - value/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mord">/2</span></span></span></span></code>
quantile of the standard normal distribution are identified in the
plot using <code>idLabels</code>. If given as a one-sided formula, its
right hand side must evaluate to a  logical, integer, or character
vector which is used to identify observations in the plot. If
missing, no observations are identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idLabels</code></td>
<td>
<p>an optional vector, or one-sided formula. If given as a
vector, it is converted to character mode and used to label the
observations identified according to <code>id</code>. If given as a
one-sided formula, its right hand side must evaluate to a vector
which is converted to character mode and used to label the identified
observations. Default is the innermost grouping factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idResType</code></td>
<td>
<p>an optional character string specifying the type of
residuals to be used in identifying outliers, when <code>id</code> is a
numeric value. If <code>"pearson"</code>, the standardized residuals (raw 
residuals divided by the corresponding standard errors) are used;
else, if <code>"normalized"</code>, the normalized residuals (standardized
residuals pre-multiplied by the inverse square-root factor of the
estimated error correlation matrix) are used. Partial matching of
arguments is used, so only the first character needs to be
provided. Defaults to <code>"pearson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default depends on the type of Trellis plot used:
if <code>xyplot</code> defaults to <code>TRUE</code>, else defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis plot function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a diagnostic Trellis plot.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">bwplot</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#histogram">histogram</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># standardized residuals versus fitted values by Mare</span>
plot<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> resid<span class="token punctuation">(</span>.<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"p"</span><span class="token punctuation">)</span> <span class="token operator">~</span> fitted<span class="token punctuation">(</span>.<span class="token punctuation">)</span> <span class="token operator">|</span> Mare<span class="token punctuation">,</span> abline <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># box-plots of residuals by Mare</span>
plot<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> Mare <span class="token operator">~</span> resid<span class="token punctuation">(</span>.<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># observed versus fitted values by Mare</span>
plot<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> follicles <span class="token operator">~</span> fitted<span class="token punctuation">(</span>.<span class="token punctuation">)</span> <span class="token operator">|</span> Mare<span class="token punctuation">,</span> abline <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.intervals.lmList">

<a href="#plot.intervals.lmList" class="help-page-title"><h2>Plot lmList Confidence Intervals</h2></a>

<h3>Description</h3>

<p>A Trellis dot-plot of the confidence intervals on the linear model
coefficients is generated, with a different panel for each
coefficient. Rows in the dot-plot correspond to the names of the
<code>lm</code> components of the <code>lmList</code> object used to produce
<code>x</code>. The lower and upper confidence limits are connected by
a line segment and the estimated coefficients are marked with a
<code>"+"</code>. 
</p>
<p>This is based on function <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a>()</code> from
package <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'intervals.lmList'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> attr<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">"groupsName"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     strip <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span> strip.default<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">,</span> style <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#intervals.lmList">intervals.lmList</a>"</code>,
representing confidence intervals and estimates for the coefficients
in the <code>lm</code> components of the <code>lmList</code> object used to
produce <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>axis labels, each with a sensible default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#function">function</a></code> or <code>FALSE</code>, see
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a>()</code> from package <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the <code>dotplot</code> function
(see above).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a Trellis plot with the confidence intervals on the coefficients of
the individual <code>lm</code> components of the <code>lmList</code> that
generated <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#intervals.lmList">intervals.lmList</a></code>,
<code><a href="#lmList">lmList</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>intervals<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.lme">

<a href="#plot.lme" class="help-page-title"><h2>Plot an lme or nls object</h2></a>

<h3>Description</h3>

<p>Diagnostic plots for the linear mixed-effects fit are obtained. The
<code>form</code> argument gives considerable flexibility in the type of
plot specification. A conditioning expression (on the right side of a
<code>|</code> operator) always implies that different panels are used for
each level of the conditioning factor, according to a Trellis
display. If <code>form</code> is a one-sided formula, histograms of the
variable on the right hand side of the formula, before a <code>|</code>
operator, are displayed (the Trellis function <code>histogram</code> is
used). If <code>form</code> is two-sided and both its left and
right hand side variables are numeric, scatter plots are displayed
(the Trellis function <code>xyplot</code> is used). Finally, if <code>form</code>
is two-sided and its left had side variable is a factor, box-plots of
the right hand side variable by the levels of the left hand side
variable are displayed (the Trellis function  <code>bwplot</code> is used). 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> form<span class="token punctuation">,</span> abline<span class="token punctuation">,</span> id<span class="token punctuation">,</span> idLabels<span class="token punctuation">,</span> idResType<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'nls'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> form<span class="token punctuation">,</span> abline<span class="token punctuation">,</span> id<span class="token punctuation">,</span> idLabels<span class="token punctuation">,</span> idResType<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model, or from <code>nls</code>, representing
an fitted nonlinear least squares model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula specifying the desired type of
plot. Any variable present in the original data frame used to obtain
<code>x</code> can be referenced. In addition, <code>x</code> itself
can be referenced in the formula using the symbol
<code>"."</code>. Conditional expressions on the right of a <code>|</code>
operator can be used to define separate panels in a Trellis
display. Default is <code>resid(., type = "p") ~ fitted(.) </code>,
corresponding to a plot of the standardized residuals versus fitted
values, both evaluated at the innermost level of nesting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline</code></td>
<td>
<p>an optional numeric value, or numeric vector of length
two. If given as a single value, a horizontal line will be added to the
plot at that coordinate; else, if given as a vector, its values are
used as the intercept and slope for a line added to the plot. If
missing, no lines are added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>an optional numeric value, or one-sided formula. If given as
a value, it is used as a significance level for a two-sided outlier
test for the standardized, or normalized residuals. Observations with
absolute standardized (normalized) residuals greater than the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1
     - value/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mord">/2</span></span></span></span></code> quantile of the standard normal distribution are
identified in the plot using <code>idLabels</code>. If given as a one-sided
formula, its right hand side must evaluate to a  logical, integer, or
character vector which is used to identify observations in the
plot. If missing, no observations are identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idLabels</code></td>
<td>
<p>an optional vector, or one-sided formula. If given as a
vector, it is converted to character and used to label the
observations identified according to <code>id</code>. If given as a
one-sided formula, its right hand side must evaluate to a vector
which is converted to character and used to label the identified
observations. Default is the innermost grouping factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idResType</code></td>
<td>
<p>an optional character string specifying the type of
residuals to be used in identifying outliers, when <code>id</code> is a
numeric value. If <code>"pearson"</code>, the standardized residuals (raw 
residuals divided by the corresponding standard errors) are used;
else, if <code>"normalized"</code>, the normalized residuals (standardized
residuals pre-multiplied by the inverse square-root factor of the
estimated error correlation matrix) are used. Partial matching of
arguments is used, so only the first character needs to be
provided. Defaults to <code>"pearson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default depends on the type of Trellis plot used:
if <code>xyplot</code> defaults to <code>TRUE</code>, else defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis plot function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a diagnostic Trellis plot.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">bwplot</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#histogram">histogram</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
<span class="token comment"># standardized residuals versus fitted values by gender</span>
plot<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> resid<span class="token punctuation">(</span>.<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"p"</span><span class="token punctuation">)</span> <span class="token operator">~</span> fitted<span class="token punctuation">(</span>.<span class="token punctuation">)</span> <span class="token operator">|</span> Sex<span class="token punctuation">,</span> abline <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># box-plots of residuals by Subject</span>
plot<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> Subject <span class="token operator">~</span> resid<span class="token punctuation">(</span>.<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># observed versus fitted values by Subject</span>
plot<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> distance <span class="token operator">~</span> fitted<span class="token punctuation">(</span>.<span class="token punctuation">)</span> <span class="token operator">|</span> Subject<span class="token punctuation">,</span> abline <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.lmList">

<a href="#plot.lmList" class="help-page-title"><h2>Plot an lmList Object</h2></a>

<h3>Description</h3>

<p>Diagnostic plots for the linear model fits corresponding to the
<code>x</code>  components are obtained. The <code>form</code> argument gives
considerable flexibility in the type of  plot specification. A
conditioning expression (on the right side of a  <code>|</code> operator)
always implies that different panels are used for  each level of the
conditioning factor, according to a Trellis  display. If <code>form</code>
is a one-sided formula, histograms of the  variable on the right hand
side of the formula, before a <code>|</code>  operator, are displayed (the
Trellis function <code>histogram</code> is  used). If <code>form</code> is
two-sided and both its left and  right hand side variables are
numeric, scatter plots are displayed  (the Trellis function
<code>xyplot</code> is used). Finally, if <code>form</code>  is two-sided and its
left had side variable is a factor, box-plots of  the right hand side
variable by the levels of the left hand side  variable are displayed
(the Trellis function  <code>bwplot</code> is used).  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> form<span class="token punctuation">,</span> abline<span class="token punctuation">,</span> id<span class="token punctuation">,</span> idLabels<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula specifying the desired type of
plot. Any variable present in the original data frame used to obtain
<code>x</code> can be referenced. In addition, <code>x</code> itself
can be referenced in the formula using the symbol
<code>"."</code>. Conditional expressions on the right of a <code>|</code>
operator can be used to define separate panels in a Trellis
display. Default is <code>resid(., type = "pool") ~ fitted(.) </code>,
corresponding to a plot of the standardized residuals (using a pooled
estimate for the residual standard error) versus fitted values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline</code></td>
<td>
<p>an optional numeric value, or numeric vector of length
two. If given as a single value, a horizontal line will be added to the
plot at that coordinate; else, if given as a vector, its values are
used as the intercept and slope for a line added to the plot. If
missing, no lines are added to the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>an optional numeric value, or one-sided formula. If given as
a value, it is used as a significance level for a two-sided outlier
test for the standardized residuals. Observations with
absolute standardized residuals greater than the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1 - value/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mord">/2</span></span></span></span></code>
quantile of the standard normal distribution are identified in the
plot using <code>idLabels</code>. If given as a one-sided formula, its
right hand side must evaluate to a  logical, integer, or character
vector which is used to identify observations in the plot. If
missing, no observations are identified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idLabels</code></td>
<td>
<p>an optional vector, or one-sided formula. If given as a
vector, it is converted to character and used to label the
observations identified according to <code>id</code>. If given as a
one-sided formula, its right hand side must evaluate to a vector
which is converted to character and used to label the identified
observations. Default is <code>getGroups(x)</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default depends on the type of Trellis plot used:
if <code>xyplot</code> defaults to <code>TRUE</code>, else defaults to
<code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis plot function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a diagnostic Trellis plot.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>,<code><a href="https://r-universe.dev/manuals/stats.html#predict.lm">predict.lm</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">bwplot</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#histogram">histogram</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
<span class="token comment"># standardized residuals versus fitted values by gender</span>
plot<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> resid<span class="token punctuation">(</span>.<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"pool"</span><span class="token punctuation">)</span> <span class="token operator">~</span> fitted<span class="token punctuation">(</span>.<span class="token punctuation">)</span> <span class="token operator">|</span> Sex<span class="token punctuation">,</span> abline <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> id <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">)</span>
<span class="token comment"># box-plots of residuals by Subject</span>
plot<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> Subject <span class="token operator">~</span> resid<span class="token punctuation">(</span>.<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># observed versus fitted values by Subject</span>
plot<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> distance <span class="token operator">~</span> fitted<span class="token punctuation">(</span>.<span class="token punctuation">)</span> <span class="token operator">|</span> Subject<span class="token punctuation">,</span> abline <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.nffGroupedData">

<a href="#plot.nffGroupedData" class="help-page-title"><h2>Plot an nffGroupedData Object</h2></a>

<h3>Description</h3>

<p>A Trellis dot-plot of the response by group is generated. If outer
variables are specified, the combination of their levels are used to
determine the panels of the Trellis display. The Trellis function
<code>dotplot</code> is used.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'nffGroupedData'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> outer<span class="token punctuation">,</span> inner<span class="token punctuation">,</span> innerGroups<span class="token punctuation">,</span> xlab<span class="token punctuation">,</span> ylab<span class="token punctuation">,</span> strip<span class="token punctuation">,</span> panel<span class="token punctuation">,</span> key<span class="token punctuation">,</span>
     grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>nffGroupedData</code>,
representing a <code>groupedData</code> object with a factor primary
covariate and a single grouping level.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer</code></td>
<td>
<p>an optional logical value or one-sided formula,
indicating covariates that are outer to the grouping factor, which
are used to determine the panels of the Trellis plot. If
equal to <code>TRUE</code>, <code>attr(object, "outer")</code> is used to indicate the
outer covariates. An outer covariate is invariant within the sets
of rows defined by the grouping factor.  Ordering of the groups is
done in such a way as to preserve adjacency of groups with the same
value of the outer variables. Defaults to <code>NULL</code>, meaning that
no outer covariates are to be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner</code></td>
<td>
<p>an optional logical value or one-sided formula, indicating
a covariate that is inner to the grouping factor, which is used to
associate points within each panel of the Trellis plot. If
equal to <code>TRUE</code>, <code>attr(object, "inner")</code> is used to indicate the
inner covariate. An inner covariate can change within the sets of
rows defined by the grouping  factor. Defaults to <code>NULL</code>,
meaning that no inner covariate  is present. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>innerGroups</code></td>
<td>
<p>an optional one-sided formula specifying a factor
to be used for grouping the levels of the <code>inner</code>
covariate. Different colors, or symbols, are used for each level
of the <code>innerGroups</code> factor. Default is <code>NULL</code>, meaning
that no <code>innerGroups</code> covariate is present.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>an optional character string with the label for the
horizontal axis. Default is the <code>y</code> elements of <code>attr(object,
     "labels")</code> and <code>attr(object, "units")</code> pasted together.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>an optional character string with the label for the
vertical axis. Default is the grouping factor name.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip</code></td>
<td>
<p>an optional function passed as the <code>strip</code> argument to
the <code>dotplot</code> function. Default is <code>strip.default(..., style
     = 1)</code> (see <code>trellis.args</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>an optional function used to generate the individual
panels in the Trellis display, passed as the <code>panel</code> argument
to the <code>dotplot</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>an optional logical function or function. If <code>TRUE</code>
and either <code>inner</code> or <code>innerGroups</code> are non-<code>NULL</code>, a
legend for the different <code>inner</code> (<code>innerGroups</code>) levels is 
included at the top of the plot. If given as a function, it is passed
as the <code>key</code> argument to the <code>dotplot</code> function. Default is
<code>TRUE</code> is either <code>inner</code> or <code>innerGroups</code> are
non-<code>NULL</code> and <code>FALSE</code> otherwise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>this argument is included for consistency with the
<code>plot.nfnGroupedData</code> method calling sequence. It is
ignored in this method function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the <code>dotplot</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a Trellis dot-plot of the response by group.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Bates, D.M. and Pinheiro, J.C. (1997), "Software Design for Longitudinal
Data", in "Modelling Longitudinal and Spatially Correlated Data:
Methods, Applications and Future Directions", T.G. Gregoire (ed.),
Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#groupedData">groupedData</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span>Machines<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>Machines<span class="token punctuation">,</span> inner <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.nfnGroupedData">

<a href="#plot.nfnGroupedData" class="help-page-title"><h2>Plot an nfnGroupedData Object</h2></a>

<h3>Description</h3>

<p>A Trellis plot of the response versus the primary covariate is
generated. If outer variables are specified, the combination of their
levels are used to determine the panels of the Trellis
display. Otherwise, the levels of the grouping variable determine the
panels. A scatter plot of the response versus the primary covariate is
displayed in each panel, with observations corresponding to same
inner group joined by line segments. The Trellis function
<code>xyplot</code> is used. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'nfnGroupedData'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> outer<span class="token punctuation">,</span> inner<span class="token punctuation">,</span> innerGroups<span class="token punctuation">,</span> xlab<span class="token punctuation">,</span> ylab<span class="token punctuation">,</span> strip<span class="token punctuation">,</span> aspect<span class="token punctuation">,</span> panel<span class="token punctuation">,</span>
     key<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>nfnGroupedData</code>,
representing a <code>groupedData</code> object with a numeric primary
covariate and a single grouping level.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer</code></td>
<td>
<p>an optional logical value or one-sided formula,
indicating covariates that are outer to the grouping factor, which
are used to determine the panels of the Trellis plot. If
equal to <code>TRUE</code>, <code>attr(object, "outer")</code> is used to
indicate the outer covariates. An outer covariate is invariant within
the sets of rows defined by the grouping factor.  Ordering of the
groups is done in such a way as to preserve adjacency of groups with
the same value of the outer variables. Defaults to <code>NULL</code>,
meaning that no outer covariates are to be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner</code></td>
<td>
<p>an optional logical value or one-sided formula, indicating
a covariate that is inner to the grouping factor, which is used to
associate points within each panel of the Trellis plot. If
equal to <code>TRUE</code>, <code>attr(object, "inner")</code> is used to
indicate the inner covariate. An inner covariate can change within
the sets of rows defined by the grouping  factor. Defaults to
<code>NULL</code>, meaning that no inner covariate  is present. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>innerGroups</code></td>
<td>
<p>an optional one-sided formula specifying a factor
to be used for grouping the levels of the <code>inner</code>
covariate. Different colors, or line types, are used for each level
of the <code>innerGroups</code> factor. Default is <code>NULL</code>, meaning
that no <code>innerGroups</code> covariate is present.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>optional character strings with the labels for the
plot. Default is the corresponding elements of <code>attr(object,
     "labels")</code> and <code>attr(object, "units")</code> pasted together.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip</code></td>
<td>
<p>an optional function passed as the <code>strip</code> argument to
the <code>xyplot</code> function. Default is <code>strip.default(..., style
     = 1)</code> (see <code>trellis.args</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aspect</code></td>
<td>
<p>an optional character string indicating the aspect ratio
for the plot passed as the <code>aspect</code> argument to the
<code>xyplot</code> function. Default is <code>"xy"</code> (see
<code>trellis.args</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>an optional function used to generate the individual
panels in the Trellis display, passed as the <code>panel</code> argument
to the <code>xyplot</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>an optional logical function or function. If <code>TRUE</code>
and <code>innerGroups</code> is non-<code>NULL</code>, a legend for the
different <code>innerGroups</code> levels is included at the top of the
plot. If given as a function, it is passed as the <code>key</code> argument
to the <code>xyplot</code> function.  Default is <code>TRUE</code> if
<code>innerGroups</code> is non-<code>NULL</code> and <code>FALSE</code> otherwise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the <code>xyplot</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a Trellis plot of the response versus the primary covariate.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Bates, D.M. and Pinheiro, J.C. (1997), "Software Design for Longitudinal
Data", in "Modelling Longitudinal and Spatially Correlated Data:
Methods, Applications and Future Directions", T.G. Gregoire (ed.),
Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#groupedData">groupedData</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># different panels per Subject</span>
plot<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>
<span class="token comment"># different panels per gender</span>
plot<span class="token punctuation">(</span>Orthodont<span class="token punctuation">,</span> outer <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.nmGroupedData">

<a href="#plot.nmGroupedData" class="help-page-title"><h2>Plot an nmGroupedData Object</h2></a>

<h3>Description</h3>

<p>The <code>groupedData</code> object is summarized by the values of the
<code>displayLevel</code> grouping factor (or the combination of its values
and the values of the covariate indicated in <code>preserve</code>, if any is
present). The collapsed data is used to produce a new
<code>groupedData</code> object, with grouping factor given by the
<code>displayLevel</code> factor, which is plotted using the
appropriate <code>plot</code> method for <code>groupedData</code> objects with
single level of grouping. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'nmGroupedData'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> collapseLevel<span class="token punctuation">,</span> displayLevel<span class="token punctuation">,</span> outer<span class="token punctuation">,</span> inner<span class="token punctuation">,</span>
    preserve<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> key<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>nmGroupedData</code>,
representing a <code>groupedData</code> object with multiple grouping
factors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapseLevel</code></td>
<td>
<p>an optional positive integer or character string
indicating the grouping level to use when collapsing the data. Level
values increase from outermost to innermost grouping. Default is the
highest or innermost level of grouping.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displayLevel</code></td>
<td>
<p>an optional positive integer or character string
indicating the grouping level to use for determining the panels in
the Trellis display, when <code>outer</code> is missing. Default is
<code>collapseLevel</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer</code></td>
<td>
<p>an optional logical value or one-sided formula,
indicating covariates that are outer to the <code>displayLevel</code>
grouping factor, which are used to determine the panels of the
Trellis plot. If equal to <code>TRUE</code>, the <code>displayLevel</code>
element <code>attr(object, "outer")</code> is used to indicate the 
outer covariates. An outer covariate is invariant within the sets
of rows defined by the grouping factor.  Ordering of the groups is
done in such a way as to preserve adjacency of groups with the same
value of the outer variables. Defaults to <code>NULL</code>, meaning that
no outer covariates are to be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner</code></td>
<td>
<p>an optional logical value or one-sided formula, indicating
a covariate that is inner to the <code>displayLevel</code> grouping factor,
which is used to associate points within each panel of the Trellis
plot. If equal to <code>TRUE</code>, <code>attr(object, "outer")</code> is used
to indicate the inner covariate. An inner covariate can change within
the sets of rows defined by the grouping  factor. Defaults to
<code>NULL</code>, meaning that no inner covariate  is present.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preserve</code></td>
<td>
<p>an optional one-sided formula indicating a covariate
whose levels should be preserved when collapsing the data according
to the <code>collapseLevel</code> grouping factor. The collapsing factor is
obtained by pasting together the levels of the <code>collapseLevel</code>
grouping factor and the values of the covariate to be
preserved. Default is <code>NULL</code>, meaning that no covariates need to
be preserved.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>an optional summary function or a list of summary functions
to be used for collapsing the data.  The function or functions are
applied only to variables in <code>object</code> that vary within the
groups defined by <code>collapseLevel</code>.  Invariant variables are 
always summarized by group using the unique value that they assume
within that group.  If <code>FUN</code> is a single
function it will be applied to each non-invariant variable by group
to produce the summary for that variable.  If <code>FUN</code> is a list of
functions, the names in the list should designate classes of
variables in the data such as <code>ordered</code>, <code>factor</code>, or
<code>numeric</code>.  The indicated function will be applied to any
non-invariant variables of that class.  The default functions to be
used are <code>mean</code> for numeric factors, and <code>Mode</code> for both
<code>factor</code> and <code>ordered</code>.  The <code>Mode</code> function, defined
internally in <code>gsummary</code>, returns the modal or most popular
value of the variable.  It is different from the <code>mode</code> function
that returns the S-language mode of the variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional named list. Names can be either positive
integers representing grouping levels, or names of grouping
factors. Each element in the list is a vector indicating the levels
of the corresponding grouping factor to be used for plotting the
data. Default is <code>NULL</code>, meaning that all levels are
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>an optional logical value, or list. If <code>TRUE</code>, a legend
is included at the top of the plot indicating which symbols (colors)
correspond to which prediction levels. If <code>FALSE</code>, no legend
is included. If given as a list, <code>key</code> is passed down as an
argument to the <code>trellis</code> function generating the plots
(<code>xyplot</code>). Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis plot function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a Trellis display of the data collapsed over the values of the
<code>collapseLevel</code> grouping factor and grouped according to the
<code>displayLevel</code> grouping factor. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Bates, D.M. and Pinheiro, J.C. (1997), "Software Design for Longitudinal
Data", in "Modelling Longitudinal and Spatially Correlated Data:
Methods, Applications and Future Directions", T.G. Gregoire (ed.),
Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#groupedData">groupedData</a></code>, <code><a href="#collapse.groupedData">collapse.groupedData</a></code>,
<code><a href="#plot.nfnGroupedData">plot.nfnGroupedData</a></code>, <code><a href="#plot.nffGroupedData">plot.nffGroupedData</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># no collapsing, panels by Dog</span>
plot<span class="token punctuation">(</span>Pixel<span class="token punctuation">,</span> display <span class="token operator">=</span> <span class="token string">"Dog"</span><span class="token punctuation">,</span> inner <span class="token operator">=</span> <span class="token operator">~</span>Side<span class="token punctuation">)</span>
<span class="token comment"># collapsing by Dog, preserving day</span>
plot<span class="token punctuation">(</span>Pixel<span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token string">"Dog"</span><span class="token punctuation">,</span> preserve <span class="token operator">=</span> <span class="token operator">~</span>day<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.ranef.lme">

<a href="#plot.ranef.lme" class="help-page-title"><h2>Plot a ranef.lme Object</h2></a>

<h3>Description</h3>

<p>Plots (class <code>"Trellis"</code> from package <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>) of the
random effects from linear mixed effects model, i.e., the result of
<code><a href="#random.effects">ranef</a>(<a href="#lme">lme</a>(*))</code> (of class <code>"<a href="#ranef.lme">ranef.lme</a>"</code>).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'ranef.lme'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> omitFixed <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> level <span class="token operator">=</span> Q<span class="token punctuation">,</span>
     grid <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> control<span class="token punctuation">,</span> xlab<span class="token punctuation">,</span> ylab<span class="token punctuation">,</span> strip<span class="token punctuation">,</span>
     <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class
<code>"<a href="#ranef.lme">ranef.lme</a>"</code>, representing the estimated coefficients or
estimated random effects for the <code>lme</code> object from which it was
produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula specifying the desired type of plot.
</p>

<ul>
<li>
<p> If given as a one-sided formula, a <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a>()</code>
of the estimated random effects (coefficients) grouped according to
all combinations of the levels of the factors named in <code>form</code>
is returned.
</p>
</li>
<li>
<p> If given as a two-sided formula (or by default, <code>NULL</code>),
an <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a>()</code> Trellis display of the random
effect (coefficient) versus the named covariates is returned.  In
<code>NULL</code> case the row names of the random effects (coefficients)
are used (as covariates).
</p>
</li>
</ul>
<p>See also ‘Details:’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omitFixed</code></td>
<td>
<p>an optional logical value indicating whether
columns with values that are constant across groups should be
omitted. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer value giving the level of grouping
to be used for <code>x</code>. Only used when <code>x</code> is a list
with different components for each grouping level. Defaults to the
highest or innermost level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot.  Only applies to plots associated with two-sided
formulas in <code>form</code>.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>an optional list with control values for the
plot, when <code>form</code> is given as a two-sided formula. The control
values are referenced by name in the <code>control</code> list and  only
the ones to be modified from the default need to be
specified. Available values include: <code>drawLine</code>, a logical
value indicating whether a <code>loess</code> smoother should be added to
the scatter plots and a line connecting the medians should be added
to the boxplots (default is <code>TRUE</code>); <code>span.loess</code>, used
as the <code>span</code> argument in the call to <code>panel.loess</code>
(default is <code>2/3</code>); <code>degree.loess</code>, used as the
<code>degree</code> argument in the call to <code>panel.loess</code> (default
is <code>1</code>); <code>cex.axis</code>, the character expansion factor for
the x-axis (default is <code>0.8</code>); <code>srt.axis</code>, the rotation
factor for the x-axis (default is <code>0</code>); and <code>mgp.axis</code>, the
margin parameters for the x-axis (default is <code>c(2, 0.5, 0)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>axis labels, each with a sensible default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#function">function</a></code> or <code>FALSE</code>, see
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a>()</code> from package <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis <code>dotplot</code>
function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>form</code> is missing, or is given as a one-sided formula, a
Trellis dot-plot (via <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a>()</code> from pkg
<a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>) of the random effects is generated, with a different
panel for each random effect (coefficient).  Rows in the dot-plot are
determined by the <code>form</code> argument (if not missing) or by the row
names of the random effects (coefficients).  Single factors (<code>~g</code>)
or crossed factors (<code>~g1*g2</code>) are allowed.  For a single factor,
its levels determine the dot-plot rows (with possibly multiple dots
per row); otherwise, if <code>form</code>
specifies a crossing of factors, the dot-plot rows are determined by
all combinations of the levels of the individual factors in the
formula.
</p>
<p>If <code>form</code> is a two-sided formula, the left hand side must
be a single random effect (coefficient) and the right hand side is
formed by covariates in <code>x</code> separated by <code>+</code>.
An <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a>()</code> Trellis display is generated,
with a different panel for each variable listed in the right hand side
of <code>form</code>.  Scatter plots are generated for numeric variables and
boxplots are generated for categorical (<code>factor</code> or
<code>ordered</code>) variables.
</p>


<h3>Value</h3>

<p>a Trellis plot of the estimated random-effects (coefficients) versus
covariates, or groups.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#ranef.lme">ranef.lme</a></code>, <code><a href="#lme">lme</a></code>,
<code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>ranef<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span><span class="token punctuation">)</span>
fm1RE <span class="token operator">&lt;-</span> ranef<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> aug <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>fm1RE<span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Sex<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>fm1RE<span class="token punctuation">,</span> form <span class="token operator">=</span> age <span class="token operator">~</span> Sex<span class="token punctuation">)</span> <span class="token comment"># "connected" boxplots</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.ranef.lmList">

<a href="#plot.ranef.lmList" class="help-page-title"><h2>Plot a ranef.lmList Object</h2></a>

<h3>Description</h3>

<p>If <code>form</code> is missing, or is given as a one-sided formula, a
Trellis dot-plot of the random effects is generated, with a different
panel for each random effect (coefficient). Rows in the dot-plot are
determined by the <code>form</code> argument (if not missing) or by the row
names of the random effects (coefficients). If a single factor is
specified in <code>form</code>, its levels determine the dot-plot rows
(with possibly multiple dots per row); otherwise, if <code>form</code>
specifies a crossing of factors, the dot-plot rows are determined by
all combinations of the levels of the individual factors in the
formula. The Trellis function <code>dotplot</code> is used in this method
function.
</p>
<p>If <code>form</code> is a two-sided formula, a Trellis display is generated,
with a different panel for each variable listed in the right hand side
of <code>form</code>. Scatter plots are generated for numeric variables and
boxplots are generated for categorical (<code>factor</code> or
<code>ordered</code>) variables.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'ranef.lmList'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> form<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> control<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class
<code>"<a href="#ranef.lmList">ranef.lmList</a>"</code>, representing the estimated coefficients or
estimated random effects for the <code>lmList</code> object from which it was
produced.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional formula specifying the desired type of plot. If
given as a one-sided formula, a <code>dotplot</code> of the estimated
random effects (coefficients) grouped according to all combinations of
the levels of the factors named in <code>form</code> is returned. Single
factors (<code>~g</code>) or crossed factors (<code>~g1*g2</code>) are
allowed. If given as a two-sided formula, the left hand side must
be a single random effects (coefficient) and the right hand side
is formed by covariates in <code>x</code> separated by <code>+</code>. A
Trellis display of the random effect (coefficient) versus the named
covariates is returned in this case. Default is <code>NULL</code>, in
which case  the row names of the random effects (coefficients) are
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Only applies to plots associated with two-sided
formulas in <code>form</code>. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>an optional list with control values for the
plot, when <code>form</code> is given as a two-sided formula. The control
values are referenced by name in the <code>control</code> list and  only
the ones to be modified from the default need to be
specified. Available values include: <code>drawLine</code>, a logical
value indicating whether a <code>loess</code> smoother should be added to
the scatter plots and a line connecting the medians should be added
to the boxplots (default is <code>TRUE</code>); <code>span.loess</code>, used
as the <code>span</code> argument in the call to <code>panel.loess</code>
(default is <code>2/3</code>); <code>degree.loess</code>, used as the
<code>degree</code> argument in the call to <code>panel.loess</code> (default
is <code>1</code>); <code>cex.axis</code>, the character expansion factor for
the x-axis (default is <code>0.8</code>); <code>srt.axis</code>, the rotation
factor for the x-axis (default is <code>0</code>); and <code>mgp.axis</code>, the
margin parameters for the x-axis (default is <code>c(2, 0.5, 0)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis <code>dotplot</code>
function.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a Trellis plot of the estimated random-effects (coefficients) versus
covariates, or groups.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">dotplot</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>ranef<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span><span class="token punctuation">)</span>
fm1RE <span class="token operator">&lt;-</span> ranef<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> aug <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>fm1RE<span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Sex<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>fm1RE<span class="token punctuation">,</span> form <span class="token operator">=</span> age <span class="token operator">~</span> Sex<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.Variogram">

<a href="#plot.Variogram" class="help-page-title"><h2>Plot a Variogram Object</h2></a>

<h3>Description</h3>

<p>an <code>xyplot</code> of the semi-variogram versus the distances is
produced. If <code>smooth = TRUE</code>, a <code>loess</code> smoother is added to
the plot. If <code>showModel = TRUE</code> and <code>x</code> includes an
<code>"modelVariog"</code> attribute, the corresponding semi-variogram
is added to the plot.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'Variogram'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> smooth<span class="token punctuation">,</span> showModel<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> span<span class="token punctuation">,</span> xlab<span class="token punctuation">,</span>
     ylab<span class="token punctuation">,</span> type<span class="token punctuation">,</span> ylim<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#Variogram">Variogram</a>"</code>,
consisting of a data frame with two columns named <code>variog</code> and
<code>dist</code>, representing the semi-variogram values and the corresponding
distances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>an optional logical value controlling whether a
<code>loess</code> smoother should be added to the plot. Defaults to
<code>TRUE</code>, when <code>showModel</code> is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showModel</code></td>
<td>
<p>an optional logical value controlling whether the
semi-variogram corresponding to an <code>"modelVariog"</code> attribute of
<code>x</code>, if any is present, should be added to the
plot. Defaults to <code>TRUE</code>, when the <code>"modelVariog"</code>
attribute is present.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>an optional numeric value used as the height of a
horizontal line displayed in the plot. Can be used to represent the
process standard deviation. Default is <code>NULL</code>, implying that no
horizontal line is drawn. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>an optional numeric value with the smoothing parameter for
the <code>loess</code> fit. Default is 0.6.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>optional character strings with the x- and y-axis
labels. Default respectively to <code>"Distance"</code> and
<code>"SemiVariogram"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>an optional character indicating the type of plot. Defaults
to <code>"p"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>an optional numeric vector with the limits for the
y-axis. Defaults to <code>c(0, max(x$variog))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis <code>xyplot</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an <code>xyplot</code> Trellis plot.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#Variogram">Variogram</a></code>, <code><a href="https://deepayan.r-universe.dev/lattice/lattice.html#xyplot">xyplot</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#loess">loess</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>Variogram<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Mare<span class="token punctuation">,</span> maxDist <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pooledSD">

<a href="#pooledSD" class="help-page-title"><h2>Extract Pooled Standard Deviation</h2></a>

<h3>Description</h3>

<p>The pooled estimated standard deviation is obtained by adding together
the residual sum of squares for each non-null element of
<code>object</code>, dividing by the sum of the corresponding residual
degrees-of-freedom, and taking the square-root.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pooledSD<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>lmList</code>.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>the pooled standard deviation for the non-null elements of
<code>object</code>, with an attribute <code>df</code> with the number of
degrees-of-freedom used in the estimation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#lm">lm</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>Orthodont<span class="token punctuation">)</span>
pooledSD<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="predict.gls">

<a href="#predict.gls" class="help-page-title"><h2>Predictions from a gls Object</h2></a>

<h3>Description</h3>

<p>The predictions for the linear model represented by <code>object</code> are
obtained at the covariate values defined in <code>newdata</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> newdata<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gls">gls</a>"</code>, representing
a generalized least squares fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an optional data frame to be used for obtaining the
predictions. All variables used in the linear model must be present
in the data frame. If missing, the fitted values are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when
<code>newdata</code> contains <code>NA</code>s.  The default action
(<code>na.fail</code>) causes the function to print an error message and
terminate if there are any incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the predicted values.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
newOvary <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>Time <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
predict<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> newOvary<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="predict.gnls">

<a href="#predict.gnls" class="help-page-title"><h2>Predictions from a gnls Object</h2></a>

<h3>Description</h3>

<p>The predictions for the nonlinear model represented by <code>object</code> are
obtained at the covariate values defined in <code>newdata</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gnls'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> newdata<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span> naPattern<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gnls">gnls</a>"</code>, representing
a generalized nonlinear least squares fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an optional data frame to be used for obtaining the
predictions. All variables used in the nonlinear model must be present
in the data frame. If missing, the fitted values are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when
<code>newdata</code> contains <code>NA</code>s.  The default action
(<code>na.fail</code>) causes the function to print an error message and
terminate if there are any incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naPattern</code></td>
<td>
<p>an expression or formula object, specifying which returned
values are to be regarded as missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the predicted values.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gnls">gnls</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>weight <span class="token operator">~</span> SSlogis<span class="token punctuation">(</span>Time<span class="token punctuation">,</span> Asym<span class="token punctuation">,</span> xmid<span class="token punctuation">,</span> scal<span class="token punctuation">)</span><span class="token punctuation">,</span> Soybean<span class="token punctuation">,</span>
            weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
newSoybean <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>Time <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
predict<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> newSoybean<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="predict.lme">

<a href="#predict.lme" class="help-page-title"><h2>Predictions from an lme Object</h2></a>

<h3>Description</h3>

<p>The predictions at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by adding together the
population predictions (based only on the fixed effects estimates)
and the estimated contributions of the random effects to the
predictions at grouping levels less or equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>.  The resulting
values estimate the best linear unbiased predictions (BLUPs) at level
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>.  If group values not included in the original grouping factors
are present in <code>newdata</code>, the corresponding predictions will be
set to <code>NA</code> for levels greater or equal to the level at which the
unknown groups occur.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> newdata<span class="token punctuation">,</span> level <span class="token operator">=</span> Q<span class="token punctuation">,</span> asList <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        na.action <span class="token operator">=</span> na.fail<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an optional data frame to be used for obtaining the
predictions.  All variables used in the fixed and random effects
models, as well as the grouping factors, must be present in the data
frame.  If missing, the fitted values are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping
to be used in obtaining the predictions.  Level values increase from
outermost to innermost grouping, with level zero corresponding to the
population predictions.  Defaults to the highest or innermost level of
grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>an optional logical value.  If <code>TRUE</code> and a single
value is given in <code>level</code>, the returned object is a list with
the predictions split by groups; else the returned value is
either a vector or a data frame, according to the length of
<code>level</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when
<code>newdata</code> contains <code>NA</code>s.  The default action
(<code>na.fail</code>) causes the function to print an error message and
terminate if there are any incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if a single level of grouping is specified in <code>level</code>, the
returned value is either a list with the predictions split by groups
(<code>asList = TRUE</code>) or a vector with the predictions
(<code>asList = FALSE</code>); else, when multiple grouping levels are
specified in <code>level</code>, the returned object is a data frame with
columns given by the predictions at different levels and the grouping
factors.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#fitted.lme">fitted.lme</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
newOrth <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>Sex <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Male"</span><span class="token punctuation">,</span><span class="token string">"Male"</span><span class="token punctuation">,</span><span class="token string">"Female"</span><span class="token punctuation">,</span><span class="token string">"Female"</span><span class="token punctuation">,</span><span class="token string">"Male"</span><span class="token punctuation">,</span><span class="token string">"Male"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                      age <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                      Subject <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"M01"</span><span class="token punctuation">,</span><span class="token string">"M01"</span><span class="token punctuation">,</span><span class="token string">"F30"</span><span class="token punctuation">,</span><span class="token string">"F30"</span><span class="token punctuation">,</span><span class="token string">"M04"</span><span class="token punctuation">,</span><span class="token string">"M04"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## The 'Orthodont' data has *no* 'F30', so predict  NA  at level 1 :</span>
predict<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> newOrth<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="predict.lmList">

<a href="#predict.lmList" class="help-page-title"><h2>Predictions from an lmList Object</h2></a>

<h3>Description</h3>

<p>If the grouping factor corresponding to <code>object</code> is included
in <code>newdata</code>, the data frame is partitioned according to the
grouping factor levels; else, <code>newdata</code> is repeated for all
<code>lm</code> components. The predictions and, optionally, the standard
errors for the predictions, are obtained for each <code>lm</code>
component of <code>object</code>, using the corresponding element of the
partitioned <code>newdata</code>, and arranged into a list with as many
components as <code>object</code>, or combined into a single vector or data
frame (if <code>se.fit=TRUE</code>).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> newdata<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> pool<span class="token punctuation">,</span> asList<span class="token punctuation">,</span> se.fit<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an optional data frame to be used for obtaining the
predictions. All variables used in the <code>object</code> model formula
must be present in the data frame. If missing, the same data frame
used to produce <code>object</code> is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional character or integer vector naming the
<code>lm</code> components of <code>object</code> from which the predictions
are to be extracted. Default is <code>NULL</code>, in which case all
components are used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, the returned
object is a list with the predictions split by groups; else the
returned value is a vector. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>an optional logical value indicating whether a pooled
estimate of the residual standard error should be used. Default is
<code>attr(object, "pool")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>an optional logical value indicating whether pointwise
standard errors should be computed along with the
predictions. Default is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components given by the predictions (and, optionally, the
standard errors for the predictions) from each <code>lm</code>
component of <code>object</code>,  a vector with the predictions from all 
<code>lm</code> components of <code>object</code>, or a data frame with columns
given by the predictions and their corresponding standard errors.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#predict.lm">predict.lm</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
predict<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> se.fit <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="predict.nlme">

<a href="#predict.nlme" class="help-page-title"><h2>Predictions from an nlme Object</h2></a>

<h3>Description</h3>

<p>The predictions at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by adding together the
contributions from the estimated fixed effects and the estimated
random effects at levels less or equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> and evaluating the
model function at the resulting estimated parameters.  If group values
not included in the original grouping factors  are present in
<code>newdata</code>, the corresponding predictions will be  set to
<code>NA</code> for levels greater or equal to the level at which the
unknown groups occur.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'nlme'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> newdata<span class="token punctuation">,</span> level <span class="token operator">=</span> Q<span class="token punctuation">,</span> asList <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        na.action <span class="token operator">=</span> na.fail<span class="token punctuation">,</span> naPattern <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#nlme">nlme</a>"</code>,
representing a fitted nonlinear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an optional data frame to be used for obtaining the
predictions.  All variables used in the nonlinear model, the fixed and
the random effects models, as well as the grouping factors, must be
present in the data frame.  If missing, the fitted values are
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping
to be used in obtaining the predictions.  Level values increase from
outermost to innermost grouping, with level zero corresponding to the
population predictions.  Defaults to the highest or innermost level of
grouping (and is <code>object$dims$Q</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>an optional logical value.  If <code>TRUE</code> and a single
value is given in <code>level</code>, the returned object is a list with
the predictions split by groups; else the returned value is
either a vector or a data frame, according to the length of
<code>level</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when
<code>newdata</code> contains <code>NA</code>s.  The default action
(<code>na.fail</code>) causes the function to print an error message and
terminate if there are any incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naPattern</code></td>
<td>
<p>an expression or formula object, specifying which returned
values are to be regarded as missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if a single level of grouping is specified in <code>level</code>, the
returned value is either a list with the predictions split by groups
(<code>asList = TRUE</code>) or a vector with the predictions
(<code>asList = FALSE</code>); else, when multiple grouping levels are
specified in <code>level</code>, the returned object is a data frame with
columns given by the predictions at different levels and the grouping
factors.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#nlme">nlme</a></code>, <code><a href="#fitted.lme">fitted.lme</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">head<span class="token punctuation">(</span>Loblolly<span class="token punctuation">)</span> <span class="token comment"># groupedData  w/  'Seed' is grouping variable :</span>
<span class="token comment">## Grouped Data: height ~ age | Seed</span>
<span class="token comment">##    height age Seed</span>
<span class="token comment">## 1    4.51   3  301</span>
<span class="token comment">## 15  10.89   5  301</span>
<span class="token comment">## ..  .....   .  ...</span>

fm1 <span class="token operator">&lt;-</span> nlme<span class="token punctuation">(</span>height <span class="token operator">~</span> SSasymp<span class="token punctuation">(</span>age<span class="token punctuation">,</span> Asym<span class="token punctuation">,</span> R0<span class="token punctuation">,</span> lrc<span class="token punctuation">)</span><span class="token punctuation">,</span>  data <span class="token operator">=</span> Loblolly<span class="token punctuation">,</span>
            fixed <span class="token operator">=</span> Asym <span class="token operator">+</span> R0 <span class="token operator">+</span> lrc <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">,</span>
            random <span class="token operator">=</span> Asym <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">## &lt;---grouping---&gt;  Asym ~ 1 | Seed</span>
            start <span class="token operator">=</span> c<span class="token punctuation">(</span>Asym <span class="token operator">=</span> <span class="token number">103</span><span class="token punctuation">,</span> R0 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">8.5</span><span class="token punctuation">,</span> lrc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fm1

age. <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span>from <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> to <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
newLL.<span class="token number">301</span> <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>age <span class="token operator">=</span> age.<span class="token punctuation">,</span> Seed <span class="token operator">=</span> <span class="token number">301</span><span class="token punctuation">)</span>
newLL.<span class="token number">329</span> <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>age <span class="token operator">=</span> age.<span class="token punctuation">,</span> Seed <span class="token operator">=</span> <span class="token number">329</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>p301 <span class="token operator">&lt;-</span> predict<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> newLL.<span class="token number">301</span><span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>p329 <span class="token operator">&lt;-</span> predict<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> newLL.<span class="token number">329</span><span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## Prediction are the same at level 0 :</span>
all.equal<span class="token punctuation">(</span>p301<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token string">"predict.fixed"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          p329<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token string">"predict.fixed"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">## and differ by the 'Seed' effect at level 1 :</span>
p301<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token string">"predict.Seed"</span><span class="token punctuation">]</span> <span class="token operator">-</span>
p329<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token string">"predict.Seed"</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="print.summary.pdMat">

<a href="#print.summary.pdMat" class="help-page-title"><h2>Print a summary.pdMat Object</h2></a>

<h3>Description</h3>

<p>The standard deviations and correlations associated with the
positive-definite matrix represented by <code>object</code> (considered as a
variance-covariance matrix) are printed, together with the formula and
the grouping level associated <code>object</code>, if any are present.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'summary.pdMat'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> rdig<span class="token punctuation">,</span> Level<span class="token punctuation">,</span> resid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#summary.pdMat">summary.pdMat</a>"</code>,
generally resulting from applying <code><a href="https://r-universe.dev/manuals/base.html#summary">summary</a></code> to an object
inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>an optional numeric value used as a multiplier for
the square-root factor of the positive-definite matrix represented by
<code>object</code> (usually the estimated within-group standard deviation
from a mixed-effects model). Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdig</code></td>
<td>
<p>an optional integer value with the number of significant
digits to be used in printing correlations. Defaults to 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Level</code></td>
<td>
<p>an optional character string with a description of the
grouping level associated with <code>object</code> (generally corresponding
to levels of grouping in a mixed-effects model). Defaults to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> an extra row
with the <code>"residual"</code> standard deviation given in <code>sigma</code>
will be included in the output. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to <code>print.default</code>; see
the documentation on that method function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#summary.pdMat">summary.pdMat</a></code>,<code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdCompSymm<span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> diag<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>age <span class="token operator">+</span> age<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>
         data <span class="token operator">=</span> Orthodont<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>summary<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span><span class="token punctuation">,</span> sigma <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">,</span> resid <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="print.varFunc">

<a href="#print.varFunc" class="help-page-title"><h2>Print a varFunc Object</h2></a>

<h3>Description</h3>

<p>The class and the coefficients associated with <code>x</code> are printed.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'varFunc'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#varFunc">varFunc</a>"</code>,
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to <code>print.default</code>; see
the documentation on that method function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#summary.varFunc">summary.varFunc</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token punctuation">)</span>
vf1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>vf1<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="qqnorm.gls">

<a href="#qqnorm.gls" class="help-page-title"><h2>Normal Plot of Residuals from a gls Object</h2></a>

<h3>Description</h3>

<p>Diagnostic plots for assessing the normality of residuals the
generalized least squares fit are obtained. The <code>form</code> argument
gives considerable flexibility in the type of plot specification. A
conditioning expression (on the right side of a <code>|</code> operator)
always implies that different panels are used for each level of the
conditioning factor, according to a Trellis display. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
qqnorm<span class="token punctuation">(</span>y<span class="token punctuation">,</span> form<span class="token punctuation">,</span> abline<span class="token punctuation">,</span> id<span class="token punctuation">,</span> idLabels<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gls">gls</a>"</code>, representing
a generalized least squares fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula specifying the desired type of
plot. Any variable present in the original data frame used to obtain
<code>y</code> can be referenced. In addition, <code>y</code> itself
can be referenced in the formula using the symbol
<code>"."</code>. Conditional expressions on the right of a <code>|</code>
operator can be used to define separate panels in a Trellis
display. The expression on the right hand side of <code>form</code> and to
the left of a <code>|</code> operator must evaluate to a residuals
vector. Default is <code>~ resid(., type = "p")</code>, 
corresponding to a normal plot of the standardized residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline</code></td>
<td>
<p>an optional numeric value, or numeric vector of length
two. If given as a single value, a horizontal line will be added to the
plot at that coordinate; else, if given as a vector, its values are
used as the intercept and slope for a line added to the plot. If
missing, no lines are added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>an optional numeric value, or one-sided formula. If given as
a value, it is used as a significance level for a two-sided outlier
test for the standardized residuals (random effects). Observations with
absolute standardized residuals (random effects) greater than the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1 - value/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mord">/2</span></span></span></span></code> quantile of the standard normal distribution are
identified in the plot using <code>idLabels</code>. If given as a one-sided
formula, its right hand side must evaluate to a  logical, integer, or
character vector which is used to identify observations in the
plot. If missing, no observations are identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idLabels</code></td>
<td>
<p>an optional vector, or one-sided formula. If given as a
vector, it is converted to character and used to label the
observations identified according to <code>id</code>. If given as a
one-sided formula, its right hand side must evaluate to a vector
which is converted to character and used to label the identified
observations. Default is the innermost grouping factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default depends on the type of Trellis plot used:
if <code>xyplot</code> defaults to <code>TRUE</code>, else defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis plot function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a diagnostic Trellis plot for assessing normality of residuals.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>, <code><a href="#plot.gls">plot.gls</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
qqnorm<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> abline <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="qqnorm.lme">

<a href="#qqnorm.lme" class="help-page-title"><h2>Normal Plot of Residuals or Random Effects from an lme Object</h2></a>

<h3>Description</h3>

<p>Diagnostic plots for assessing the normality of residuals and random
effects in the linear mixed-effects fit are obtained. The
<code>form</code> argument gives considerable flexibility in the type of
plot specification. A conditioning expression (on the right side of a
<code>|</code> operator) always implies that different panels are used for
each level of the conditioning factor, according to a Trellis
display.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
qqnorm<span class="token punctuation">(</span>y<span class="token punctuation">,</span> form<span class="token punctuation">,</span> abline<span class="token punctuation">,</span> id<span class="token punctuation">,</span> idLabels<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model or from class <code>"<a href="#lmList">lmList</a>"</code>,
representing a list of <code>lm</code> objects, or from class <code>"lm"</code>,
representing a fitted linear model, or from class <code>"nls"</code>,
representing a nonlinear least squares fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula specifying the desired type of
plot. Any variable present in the original data frame used to obtain
<code>y</code> can be referenced. In addition, <code>y</code> itself
can be referenced in the formula using the symbol
<code>"."</code>. Conditional expressions on the right of a <code>|</code>
operator can be used to define separate panels in a Trellis
display. The expression on the right hand side of <code>form</code> and to
the left of a <code>|</code> operator must evaluate to a residuals vector,
or a random effects matrix. Default is <code>~ resid(., type = "p")</code>,
corresponding to a normal plot of the standardized residuals
evaluated at the innermost level of nesting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline</code></td>
<td>
<p>an optional numeric value, or numeric vector of length
two. If given as a single value, a horizontal line will be added to the
plot at that coordinate; else, if given as a vector, its values are
used as the intercept and slope for a line added to the plot. If
missing, no lines are added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>an optional numeric value, or one-sided formula. If given as
a value, it is used as a significance level for a two-sided outlier
test for the standardized residuals (random effects). Observations with
absolute standardized residuals (random effects) greater than the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1 - value/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mord">/2</span></span></span></span></code> quantile of the standard normal distribution are
identified in the plot using <code>idLabels</code>. If given as a one-sided
formula, its right hand side must evaluate to a  logical, integer, or
character vector which is used to identify observations in the
plot. If missing, no observations are identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idLabels</code></td>
<td>
<p>an optional vector, or one-sided formula. If given as a
vector, it is converted to character and used to label the
observations identified according to <code>id</code>. If given as a
one-sided formula, its right hand side must evaluate to a vector
which is converted to character and used to label the identified
observations. Default is the innermost grouping factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an optional logical value indicating whether a grid should
be added to plot. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the Trellis plot function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a diagnostic Trellis plot for assessing normality of residuals or
random effects.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#plot.lme">plot.lme</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
<span class="token comment">## normal plot of standardized residuals by gender</span>
qqnorm<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> <span class="token operator">~</span> resid<span class="token punctuation">(</span>.<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"p"</span><span class="token punctuation">)</span> <span class="token operator">|</span> Sex<span class="token punctuation">,</span> abline <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## normal plots of random effects</span>
qqnorm<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> <span class="token operator">~</span>ranef<span class="token punctuation">(</span>.<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Quinidine">

<a href="#Quinidine" class="help-page-title"><h2>Quinidine Kinetics</h2></a>

<h3>Description</h3>

<p>The <code>Quinidine</code> data frame has 1471 rows and 14 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Subject</dt>
<dd>
<p>a factor identifying the patient on whom the data were collected.
</p>
</dd>
<dt>time</dt>
<dd>
<p>a numeric vector giving the time (hr) at which the drug was
administered or the blood sample drawn.  This is measured
from the time the patient entered the study.
</p>
</dd>
<dt>conc</dt>
<dd>
<p>a numeric vector giving the serum quinidine concentration (mg/L).
</p>
</dd>
<dt>dose</dt>
<dd>
<p>a numeric vector giving the dose of drug administered (mg).
Although there were two different forms of quinidine
administered, the doses were adjusted for differences in
salt content by conversion to milligrams of quinidine base.
</p>
</dd>
<dt>interval</dt>
<dd>
<p>a numeric vector giving the when the drug has been given at
regular intervals for a sufficiently long period of time to
assume steady state behavior, the interval is recorded.
</p>
</dd>
<dt>Age</dt>
<dd>
<p>a numeric vector giving the age of the subject on entry to
the study (yr).
</p>
</dd>
<dt>Height</dt>
<dd>
<p>a numeric vector giving the height of the subject on entry
to the study (in.).
</p>
</dd>
<dt>Weight</dt>
<dd>
<p>a numeric vector giving the body weight of the subject (kg).
</p>
</dd>
<dt>Race</dt>
<dd>
<p>a factor with levels
<code>Caucasian</code>, 
<code>Latin</code>, and
<code>Black</code> identifying the race of the subject.
</p>
</dd>
<dt>Smoke</dt>
<dd>
<p>a factor with levels
<code>no</code> and
<code>yes</code> giving smoking status at the time of the
measurement.
</p>
</dd>
<dt>Ethanol</dt>
<dd>
<p>a factor with levels
<code>none</code>, 
<code>current</code>,
<code>former</code> giving ethanol (alcohol) abuse status at the
time of the measurement.
</p>
</dd>
<dt>Heart</dt>
<dd>
<p>a factor with levels
<code>No/Mild</code>, 
<code>Moderate</code>, and 
<code>Severe</code> indicating congestive heart failure for the subject.
</p>
</dd>
<dt>Creatinine</dt>
<dd>
<p>an ordered factor with levels
<code>&lt; 50</code> &lt; <code>&gt;= 50</code> indicating the creatinine clearance (mg/min).
</p>
</dd>
<dt>glyco</dt>
<dd>
<p>a numeric vector giving the alpha-1 acid glycoprotein
concentration (mg/dL).  Often measured at the same time as
the quinidine concentration.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Verme et al. (1992) analyze routine clinical data on
patients receiving the drug quinidine as a treatment for cardiac
arrhythmia (atrial fibrillation or ventricular arrhythmias).  All
patients were receiving oral quinidine doses.  At irregular intervals
blood samples were drawn and serum concentrations of quinidine were
determined.  These data are
analyzed in several publications, including Davidian and Giltinan (1995,
section 9.3).
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.25)
</p>
<p>Davidian, M. and Giltinan, D. M. (1995), <em>Nonlinear Models for
Repeated Measurement Data</em>,  Chapman and Hall, London.
</p>
<p>Verme, C. N., Ludden,  T. M., Clementi, W. A. and Harris,
S. C. (1992), Pharmacokinetics of quinidine in male patients: A
population analysis, <em>Clinical Pharmacokinetics</em>, <b>22</b>,
468-480.
</p>

<hr>
</div>
<div class="container manual-page" id="quinModel">

<a href="#quinModel" class="help-page-title"><h2>Model function for the Quinidine data</h2></a>

<h3>Description</h3>

<p>A model function for a model used with the <code>Quinidine</code> data.
This function calls compiled C code.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">quinModel<span class="token punctuation">(</span>Subject<span class="token punctuation">,</span> time<span class="token punctuation">,</span> conc<span class="token punctuation">,</span> dose<span class="token punctuation">,</span> interval<span class="token punctuation">,</span> lV<span class="token punctuation">,</span> lKa<span class="token punctuation">,</span> lCl<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Subject</code></td>
<td>

<p>a factor identifying the patient on whom the data were collected.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>

<p>a numeric vector giving the time (hr) at which the drug was
administered or the blood sample drawn.  This is measured
from the time the patient entered the study.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>

<p>a numeric vector giving the serum quinidine concentration (mg/L).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose</code></td>
<td>

<p>a numeric vector giving the dose of drug administered (mg).
Although there were two different forms of quinidine
administered, the doses were adjusted for differences in
salt content by conversion to milligrams of quinidine base.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>

<p>a numeric vector giving the when the drug has been given at
regular intervals for a sufficiently long period of time to
assume steady state behavior, the interval is recorded.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lV</code></td>
<td>
<p>numeric.  A vector of values of the natural log of the
effective volume of distribution according to <code>Subject</code> and
<code>time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lKa</code></td>
<td>
<p>numeric.  A vector of values of the natural log of the
absorption rate constant according to <code>Subject</code> and <code>time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lCl</code></td>
<td>
<p>numeric.  A vector of values of the natural log of the
clearance parameter according to <code>Subject</code> and <code>time</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the details section of <code><a href="#Quinidine">Quinidine</a></code> for a description
of the model function that <code>quinModel</code> evaluates.
</p>


<h3>Value</h3>

<p>a numeric vector of predicted quinidine concentrations.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>
</p>


<h3>References</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000) <em>Mixed-effects Models in
S and S-PLUS</em>, Springer. (section 8.2)
</p>

<hr>
</div>
<div class="container manual-page" id="Rail">

<a href="#Rail" class="help-page-title"><h2>Evaluation of Stress in Railway Rails</h2></a>

<h3>Description</h3>

<p>The <code>Rail</code> data frame has 18 rows and 2 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Rail</dt>
<dd>
<p>an ordered factor identifying the rail on which the
measurement was made.
</p>
</dd>
<dt>travel</dt>
<dd>
<p>a numeric vector giving the travel time for ultrasonic
head-waves in the rail (nanoseconds).  The value given is the
original travel time minus 36,100 nanoseconds.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Devore (2000, Example 10.10, p. 427) cites data from an article in
<em>Materials Evaluation</em> on “a study of travel time for a certain
type of wave that results from longitudinal stress of rails used for
railroad track.”
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.26)
</p>
<p>Devore, J. L. (2000), <em>Probability and Statistics for
Engineering and the Sciences (5th ed)</em>, Duxbury, Boston, MA.
</p>

<hr>
</div>
<div class="container manual-page" id="random.effects">

<a href="#random.effects" class="help-page-title"><h2>Extract Random Effects</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include <code>lmList</code> and <code>lme</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">random.effects<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
ranef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any fitted model object from which random effects
estimates can be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 100, 461.  
</p>


<h3>See Also</h3>

<p><code><a href="#ranef.lmList">ranef.lmList</a></code>,<code><a href="#ranef.lme">ranef.lme</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ranef.lme">

<a href="#ranef.lme" class="help-page-title"><h2>Extract lme Random Effects</h2></a>

<h3>Description</h3>

<p>The estimated random effects at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are represented as a
data frame with rows given by the different groups at that level and
columns given by the random effects. If a single level of
grouping is specified, the returned object is a data frame; else, the
returned object is a list of such data frames. Optionally, the
returned data frame(s) may be augmented with covariates summarized
over groups.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
ranef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> augFrame<span class="token punctuation">,</span> level<span class="token punctuation">,</span> data<span class="token punctuation">,</span> which<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span>
      standard<span class="token punctuation">,</span> omitGroupingFactor<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>augFrame</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, the returned
data frame is augmented with variables defined in <code>data</code>; else,
if <code>FALSE</code>, only the coefficients are returned. Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional vector of positive integers giving the levels
of grouping to be used in extracting the random effects from an
object with multiple nested grouping levels. Defaults to all levels
of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame with the variables to be used for
augmenting the returned data frame when <code>augFrame =
     TRUE</code>. Defaults to the data frame used to fit <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an optional positive integer vector specifying which
columns of <code>data</code> should be used in the augmentation of the
returned data frame. Defaults to all columns in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>an optional summary function or a list of summary functions
to be applied to group-varying variables, when collapsing <code>data</code>
by groups.  Group-invariant variables are always summarized by the
unique value that they assume within that group. If <code>FUN</code> is a
single function it will be applied to each non-invariant variable by
group to produce the summary for that variable.  If <code>FUN</code> is a
list of functions, the names in the list should designate classes of
variables in the frame such as <code>ordered</code>, <code>factor</code>, or
<code>numeric</code>.  The indicated function will be applied to any
group-varying variables of that class.  The default functions to be
used are <code>mean</code> for numeric factors, and <code>Mode</code> for both
<code>factor</code> and <code>ordered</code>.  The <code>Mode</code> function, defined
internally in <code>gsummary</code>, returns the modal or most popular
value of the variable.  It is different from the <code>mode</code> function
that returns the S-language mode of the variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard</code></td>
<td>
<p>an optional logical value indicating whether the
estimated random effects should be "standardized" (i.e. divided by
the estimate of the standard deviation of that group of random
effects). Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omitGroupingFactor</code></td>
<td>
<p>an optional logical value.  When <code>TRUE</code>
the grouping factor itself will be omitted from the group-wise
summary of <code>data</code> but the levels of the grouping factor will
continue to be used as the row names for the returned data frame.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating for which rows the
random effects should be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame, or list of data frames, with the estimated 
random effects at the grouping level(s) specified in <code>level</code> and,
optionally, other covariates  summarized over groups. The returned
object inherits from classes <code>random.effects.lme</code> and
<code>data.frame</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 100, 461.  
</p>


<h3>See Also</h3>

<p><code><a href="#coef.lme">coef.lme</a></code>,
<code><a href="#gsummary">gsummary</a></code>,
<code><a href="#lme">lme</a></code>, 
<code><a href="#plot.ranef.lme">plot.ranef.lme</a></code>, 
<code><a href="#random.effects">random.effects</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
ranef<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
random.effects<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>             <span class="token comment"># same as above</span>
random.effects<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> augFrame <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ranef.lmList">

<a href="#ranef.lmList" class="help-page-title"><h2>Extract lmList Random Effects</h2></a>

<h3>Description</h3>

<p>The difference between the individual <code>lm</code> components
coefficients and their average is calculated.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
ranef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> augFrame<span class="token punctuation">,</span> data<span class="token punctuation">,</span> which<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span> standard<span class="token punctuation">,</span>
                 omitGroupingFactor<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>augFrame</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, the returned
data frame is augmented with variables defined in <code>data</code>; else,
if <code>FALSE</code>, only the coefficients are returned. Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame with the variables to be used for
augmenting the returned data frame when <code>augFrame =
     TRUE</code>. Defaults to the data frame used to fit <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an optional positive integer vector specifying which
columns of <code>data</code> should be used in the augmentation of the
returned data frame. Defaults to all columns in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>an optional summary function or a list of summary functions
to be applied to group-varying variables, when collapsing <code>data</code>
by groups.  Group-invariant variables are always summarized by the
unique value that they assume within that group. If <code>FUN</code> is a
single function it will be applied to each non-invariant variable by
group to produce the summary for that variable.  If <code>FUN</code> is a
list of functions, the names in the list should designate classes of
variables in the frame such as <code>ordered</code>, <code>factor</code>, or
<code>numeric</code>.  The indicated function will be applied to any
group-varying variables of that class.  The default functions to be
used are <code>mean</code> for numeric factors, and <code>Mode</code> for both
<code>factor</code> and <code>ordered</code>.  The <code>Mode</code> function, defined
internally in <code>gsummary</code>, returns the modal or most popular
value of the variable.  It is different from the <code>mode</code> function
that returns the S-language mode of the variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard</code></td>
<td>
<p>an optional logical value indicating whether the
estimated random effects should be "standardized" (i.e. divided by
the corresponding estimated standard error). Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omitGroupingFactor</code></td>
<td>
<p>an optional logical value.  When <code>TRUE</code>
the grouping factor itself will be omitted from the group-wise
summary of <code>data</code> but the levels of the grouping factor will
continue to be used as the row names for the returned data frame.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the differences between the individual <code>lm</code>
coefficients in <code>object</code> and their average. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 100, 461.  
</p>


<h3>See Also</h3>

<p><code><a href="#fixef.lmList">fixed.effects.lmList</a></code>, 
<code><a href="#lmList">lmList</a></code>, 
<code><a href="#random.effects">random.effects</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
ranef<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
random.effects<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>              <span class="token comment"># same as above</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="RatPupWeight">

<a href="#RatPupWeight" class="help-page-title"><h2>The weight of rat pups</h2></a>

<h3>Description</h3>

<p>The <code>RatPupWeight</code> data frame has 322 rows and 5 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>weight</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>sex</dt>
<dd>
<p>a factor with levels
<code>Male</code> 
<code>Female</code> 
</p>
</dd>
<dt>Litter</dt>
<dd>
<p>an ordered factor with levels
<code>9</code> &lt; <code>8</code> &lt; <code>7</code> &lt; <code>4</code> &lt; <code>2</code> &lt; <code>10</code> &lt; <code>1</code> &lt; <code>3</code> &lt; <code>5</code> &lt; <code>6</code> &lt; <code>21</code> &lt; <code>22</code> &lt; <code>24</code> &lt; <code>27</code> &lt; <code>26</code> &lt; <code>25</code> &lt; <code>23</code> &lt; <code>17</code> &lt; <code>11</code> &lt; <code>14</code> &lt; <code>13</code> &lt; <code>15</code> &lt; <code>16</code> &lt; <code>20</code> &lt; <code>19</code> &lt; <code>18</code> &lt; <code>12</code>
</p>
</dd>
<dt>Lsize</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>Treatment</dt>
<dd>
<p>an ordered factor with levels
<code>Control</code> &lt; <code>Low</code> &lt; <code>High</code>
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="recalc">

<a href="#recalc" class="help-page-title"><h2>Recalculate Condensed Linear Model Object</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include: <code>corStruct</code>, <code>modelStruct</code>,
<code>reStruct</code>, and <code>varFunc</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">recalc<span class="token punctuation">(</span>object<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any object which induces a recalculation of the condensed
linear model object <code>conLin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>a condensed linear model object, consisting of a list
with components <code>"Xy"</code>, corresponding to a regression matrix
(<code>X</code>) combined with a response vector (<code>y</code>), and
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic can take additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the recalculated condensed linear model object.
</p>


<h3>Note</h3>

<p>This function is only used inside model fitting functions, such as
<code>lme</code> and <code>gls</code>, that require recalculation of a condensed
linear model object.</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#recalc.corStruct">recalc.corStruct</a></code>,
<code><a href="#recalc.modelStruct">recalc.modelStruct</a></code>,
<code><a href="#recalc.reStruct">recalc.reStruct</a></code>,
<code><a href="#recalc.varFunc">recalc.varFunc</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="recalc.corStruct">

<a href="#recalc.corStruct" class="help-page-title"><h2>Recalculate for corStruct Object</h2></a>

<h3>Description</h3>

<p>This method function pre-multiples the <code>"Xy"</code> component of
<code>conLin</code> by the transpose square-root factor(s) of the
correlation matrix (matrices) associated with <code>object</code> and adds
the log-likelihood contribution of <code>object</code>, given by
<code>logLik(object)</code>, to the <code>"logLik"</code> component of
<code>conLin</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
recalc<span class="token punctuation">(</span>object<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>,
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>a condensed linear model object, consisting of a list
with components <code>"Xy"</code>, corresponding to a regression matrix
(<code>X</code>) combined with a response vector (<code>y</code>), and
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the recalculated condensed linear model object.
</p>


<h3>Note</h3>

<p>This method function is only used inside model
fitting functions, such as <code>lme</code> and <code>gls</code>,
that allow correlated error terms.</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#corFactor">corFactor</a></code>,
<code><a href="#logLik.corStruct">logLik.corStruct</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="recalc.modelStruct">

<a href="#recalc.modelStruct" class="help-page-title"><h2>Recalculate for a modelStruct Object</h2></a>

<h3>Description</h3>

<p>This method function recalculates the condensed linear model object
using each element of <code>object</code> sequentially from last to first.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'modelStruct'</span>
recalc<span class="token punctuation">(</span>object<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"modelStruct"</code>,
representing a list of model components, such as <code>corStruct</code> and
<code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>an optional  condensed linear model object, consisting of
a list with components <code>"Xy"</code>, corresponding to a regression
matrix (<code>X</code>) combined with a response vector (<code>y</code>), and 
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying model. Defaults to <code>attr(object, "conLin")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the recalculated condensed linear model object.
</p>


<h3>Note</h3>

<p>This method function is generally only used inside model fitting
functions, such as <code>lme</code> and <code>gls</code>, that allow model
components, such as correlated error terms and variance functions.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#recalc.corStruct">recalc.corStruct</a></code>,
<code><a href="#recalc.reStruct">recalc.reStruct</a></code>,
<code><a href="#recalc.varFunc">recalc.varFunc</a></code></p>

<hr>
</div>
<div class="container manual-page" id="recalc.reStruct">

<a href="#recalc.reStruct" class="help-page-title"><h2>Recalculate for an reStruct Object</h2></a>

<h3>Description</h3>

<p>The log-likelihood, or restricted log-likelihood, of the
Gaussian linear mixed-effects model represented by <code>object</code> and
<code>conLin</code> (assuming spherical within-group covariance structure),
evaluated at <code>coef(object)</code> is calculated and added to the
<code>logLik</code> component of <code>conLin</code>. The <code>settings</code>
attribute of <code>object</code> determines whether the log-likelihood, or
the restricted log-likelihood, is to be calculated. The computational
methods for the (restricted) log-likelihood calculations are described
in Bates and Pinheiro (1998). 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
recalc<span class="token punctuation">(</span>object<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>a condensed linear model object, consisting of a list
with components <code>"Xy"</code>, corresponding to a regression matrix
(<code>X</code>) combined with a response vector (<code>y</code>), and
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the condensed linear model with its <code>logLik</code> component updated.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#logLik">logLik</a></code>,
<code><a href="#lme">lme</a></code>, 
<code><a href="#recalc">recalc</a></code>,
<code><a href="#reStruct">reStruct</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="recalc.varFunc">

<a href="#recalc.varFunc" class="help-page-title"><h2>Recalculate for varFunc Object</h2></a>

<h3>Description</h3>

<p>This method function pre-multiples the <code>"Xy"</code> component of
<code>conLin</code> by a diagonal matrix with diagonal elements given by the
weights corresponding to the variance structure represented by
<code>object</code>e and adds the log-likelihood contribution of
<code>object</code>, given by <code>logLik(object)</code>, to the <code>"logLik"</code>
component of <code>conLin</code>.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'varFunc'</span>
recalc<span class="token punctuation">(</span>object<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#varFunc">varFunc</a>"</code>,
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>a condensed linear model object, consisting of a list
with components <code>"Xy"</code>, corresponding to a regression matrix
(<code>X</code>) combined with a response vector (<code>y</code>), and
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the recalculated condensed linear model object.
</p>


<h3>Note</h3>

<p>This method function is only used inside model fitting functions,
such as <code>lme</code> and <code>gls</code>, that allow heteroscedastic error
terms.</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#recalc">recalc</a></code>,
<code><a href="#varWeights">varWeights</a></code>,
<code><a href="#logLik.varFunc">logLik.varFunc</a></code></p>

<hr>
</div>
<div class="container manual-page" id="Relaxin">

<a href="#Relaxin" class="help-page-title"><h2>Assay for Relaxin</h2></a>

<h3>Description</h3>

<p>The <code>Relaxin</code> data frame has 198 rows and 3 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Run</dt>
<dd>
<p>an ordered factor with levels
<code>5</code> &lt; <code>8</code> &lt; <code>9</code> &lt; <code>3</code> &lt; <code>4</code> &lt; <code>2</code> &lt; <code>7</code> &lt; <code>1</code> &lt; <code>6</code>
</p>
</dd>
<dt>conc</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>cAMP</dt>
<dd>
<p>a numeric vector
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="Remifentanil">

<a href="#Remifentanil" class="help-page-title"><h2>Pharmacokinetics of Remifentanil</h2></a>

<h3>Description</h3>

<p>Intravenous infusion of remifentanil (a strong analgesic) in different
rates over varying time periods was applied to a total of 65 patients.
Concentration measurements of remifentanil were taken along with several
covariates resulting in the <code>Remifentanil</code> data frame with 2107 rows
and 12 columns.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span><span class="token string">"Remifentanil"</span><span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">"nlme"</span><span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>This data frame (of class <code>"<a href="#groupedData">groupedData</a>"</code>, specifically
<code>"nfnGroupedData"</code>) contains the following columns:
</p>

<dl>
<dt>
<code>ID</code>:</dt>
<dd>
<p>numerical (patient) IDs.</p>
</dd>
<dt>
<code>Subject</code>:</dt>
<dd>
<p>an <code><a href="https://r-universe.dev/manuals/base.html#factor">ordered</a></code> factor with 65 levels (of the
<code>ID</code>s): <code>30</code> &lt; <code>21</code> &lt; <code>25</code> &lt; <code>23</code> &lt;
<code>29</code> &lt; ... ... &lt; <code>36</code> &lt; <code>6</code> &lt; <code>5</code> &lt; <code>10</code> &lt; <code>9</code>.</p>
</dd>
<dt>
<code>Time</code>:</dt>
<dd>
<p>time from beginning of infusion in minutes (<code><a href="https://r-universe.dev/manuals/base.html#numeric">numeric</a></code>).</p>
</dd>
<dt>
<code>conc</code>:</dt>
<dd>
<p>remifentanil concentration in [ng / ml] (numeric).</p>
</dd>
<dt>
<code>Rate</code>:</dt>
<dd>
<p>infusion rate in [µg / min].</p>
</dd>
<dt>
<code>Amt</code>:</dt>
<dd>
<p>amount of remifentanil given in the current time interval in [µg].</p>
</dd>
<dt>
<code>Age</code>:</dt>
<dd>
<p>age of the patient in years.</p>
</dd>
<dt>
<code>Sex</code>:</dt>
<dd>
<p>gender of the patient, a <code><a href="https://r-universe.dev/manuals/base.html#factor">factor</a></code> with levels
<code>Female</code> and <code>Male</code>.</p>
</dd>
<dt>
<code>Ht</code>:</dt>
<dd>
<p>height of the patient in cm.</p>
</dd>
<dt>
<code>Wt</code>:</dt>
<dd>
<p>weight of the patient in kg.</p>
</dd>
<dt>
<code>BSA</code>:</dt>
<dd>
<p>body surface area (DuBois and DuBois 1916): <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>S</mi><mi>A</mi><mo>:</mo><mo>=</mo><mi>W</mi><msup><mi>t</mi><mn>0.425</mn></msup><mo>⋅</mo><mi>H</mi><msup><mi>t</mi><mn>0.725</mn></msup><mo>⋅</mo><mn>0.007184</mn></mrow><annotation encoding="application/x-tex">%
	BSA := Wt^{0.425} \cdot Ht^{0.725} \cdot 0.007184</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">BS</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.425</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.725</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.007184</span></span></span></span></code>.</p>
</dd>
<dt>
<code>LBM</code>:</dt>
<dd>
<p>lean body mass (James 1976), with slightly different
formula for
men <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>B</mi><msub><mi>M</mi><mi>m</mi></msub><mo>:</mo><mo>=</mo><mn>1.1</mn><mi>W</mi><mi>t</mi><mo>−</mo><mn>128</mn><mo stretchy="false">(</mo><mi>W</mi><mi>t</mi><mi mathvariant="normal">/</mi><mi>H</mi><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">LBM_m := 1.1  Wt - 128 (Wt/Ht)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">1.1</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">128</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">t</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></code>, and
women <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>B</mi><msub><mi>M</mi><mi>f</mi></msub><mo>:</mo><mo>=</mo><mn>1.07</mn><mi>W</mi><mi>t</mi><mo>−</mo><mn>148</mn><mo stretchy="false">(</mo><mi>W</mi><mi>t</mi><mi mathvariant="normal">/</mi><mi>H</mi><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">LBM_f := 1.07 Wt - 148 (Wt/Ht)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">1.07</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">148</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">t</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>of this help page: Niels Hagenbuch and Martin Maechler, SfS ETH Zurich.</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000).
<em>Mixed-Effects Models in S and S-PLUS</em>, Springer, New York.
</p>


<h3>References</h3>

<p>Minto CF, Schnider TW, Egan TD, Youngs E, Lemmens HJM, Gambus PL, Billard
V, Hoke JF, Moore KHP, Hermann DJ, Muir KT, Mandema JW, Shafer SL (1997).
Influence of age and gender on the pharmacokinetics and pharmacodynamics
of remifentanil: I. Model development.
<em>Anesthesiology</em> <b>86</b> 1, 10–23.
<a href="https://pubs.asahq.org/anesthesiology/article/86/1/10/35947/Influence-of-Age-and-Gender-on-the" target="_blank">https://pubs.asahq.org/anesthesiology/article/86/1/10/35947/Influence-of-Age-and-Gender-on-the</a>
</p>
<p>Charles F. Minto, Thomas W. Schnider and Steven L. Shafer (1997).
Pharmacokinetics and Pharmacodynamics of Remifentanil: II. Model Application.
<em>Anesthesiology</em> <b>86</b> 1, 24–33.
<a href="https://pubs.asahq.org/anesthesiology/article/86/1/24/35925/Pharmacokinetics-and-Pharmacodynamics-of" target="_blank">https://pubs.asahq.org/anesthesiology/article/86/1/24/35925/Pharmacokinetics-and-Pharmacodynamics-of</a>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span>Remifentanil<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># shows the 65 patients' remi profiles</span>

<span class="token comment">## The same on  log-log  scale  (*more* sensible for modeling ?):</span>
plot<span class="token punctuation">(</span>Remifentanil<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> scales <span class="token operator">=</span> list<span class="token punctuation">(</span>log<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

str<span class="token punctuation">(</span>Remifentanil<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>Remifentanil<span class="token punctuation">)</span>

plot<span class="token punctuation">(</span>xtabs<span class="token punctuation">(</span><span class="token operator">~</span>Subject<span class="token punctuation">,</span> Remifentanil<span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>unclass<span class="token punctuation">(</span>table<span class="token punctuation">(</span>Remifentanil<span class="token operator">$</span>Subject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## between 20 and 54 measurements per patient (median: 24; mean: 32.42)</span>

<span class="token comment">## Only first measurement of each patient :</span>
dim<span class="token punctuation">(</span>Remi.<span class="token number">1</span> <span class="token operator">&lt;-</span> Remifentanil<span class="token punctuation">[</span><span class="token operator">!</span>duplicated<span class="token punctuation">(</span>Remifentanil<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token string">"ID"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#  65 x 12</span>

LBMfn <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>Wt<span class="token punctuation">,</span> Ht<span class="token punctuation">,</span> Sex<span class="token punctuation">)</span> ifelse<span class="token punctuation">(</span>Sex <span class="token operator">==</span> <span class="token string">"Female"</span><span class="token punctuation">,</span>
                                        <span class="token number">1.07</span> <span class="token operator">*</span> Wt <span class="token operator">-</span> <span class="token number">148</span><span class="token operator">*</span><span class="token punctuation">(</span>Wt<span class="token operator">/</span>Ht<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>
                                        <span class="token number">1.1</span>  <span class="token operator">*</span> Wt <span class="token operator">-</span> <span class="token number">128</span><span class="token operator">*</span><span class="token punctuation">(</span>Wt<span class="token operator">/</span>Ht<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
with<span class="token punctuation">(</span>Remi.<span class="token number">1</span><span class="token punctuation">,</span>
    stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>BSA<span class="token punctuation">,</span> Wt<span class="token operator">^</span><span class="token punctuation">{</span><span class="token number">0.425</span><span class="token punctuation">}</span> <span class="token operator">*</span> Ht<span class="token operator">^</span><span class="token punctuation">{</span><span class="token number">0.725</span><span class="token punctuation">}</span> <span class="token operator">*</span> <span class="token number">0.007184</span><span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">1.5e-5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              all.equal<span class="token punctuation">(</span>LBM<span class="token punctuation">,</span> LBMfn<span class="token punctuation">(</span>Wt<span class="token punctuation">,</span> Ht<span class="token punctuation">,</span> Sex<span class="token punctuation">)</span><span class="token punctuation">,</span>                 tol <span class="token operator">=</span> <span class="token number">7e-7</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Rate: typically  3 µg / kg body weight, but :</span>
sunflowerplot<span class="token punctuation">(</span>Rate <span class="token operator">~</span> Wt<span class="token punctuation">,</span> Remifentanil<span class="token punctuation">)</span>
abline<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> lty<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> col<span class="token operator">=</span>adjustcolor<span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="residuals.gls">

<a href="#residuals.gls" class="help-page-title"><h2>Extract gls Residuals</h2></a>

<h3>Description</h3>

<p>The residuals for the linear model represented by <code>object</code>
are extracted.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
residuals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> type<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gls">gls</a>"</code>, representing
a generalized least squares fitted linear model, or from class
<code>gnls</code>, representing a generalized nonlinear least squares
fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>an optional character string specifying the type of
residuals to be used. If <code>"response"</code>, the "raw" residuals
(observed - fitted) are used; else, if <code>"pearson"</code>, the
standardized residuals (raw residuals divided by the corresponding
standard errors) are used; else, if <code>"normalized"</code>, the
normalized residuals (standardized residuals pre-multiplied by the
inverse square-root factor of the estimated error correlation
matrix) are used. Partial matching of arguments is used, so only the
first character needs to be provided.  Defaults to <code>"response"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the residuals for the linear model represented by
<code>object</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
residuals<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="residuals.glsStruct">

<a href="#residuals.glsStruct" class="help-page-title"><h2>Calculate glsStruct Residuals</h2></a>

<h3>Description</h3>

<p>The residuals for the linear model represented by <code>object</code>
are extracted.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'glsStruct'</span>
residuals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> glsFit<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#glsStruct">glsStruct</a>"</code>,
representing a list of linear model components, such as
<code>corStruct</code> and <code>"<a href="#varFunc">varFunc</a>"</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glsFit</code></td>
<td>
<p>an optional list with components <code>logLik</code>   
(log-likelihood), <code>beta</code> (coefficients), <code>sigma</code> (standard
deviation for error term), <code>varBeta</code> (coefficients' covariance
matrix), <code>fitted</code> (fitted values), and <code>residuals</code>
(residuals). Defaults to <code>attr(object, "glsFit")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the residuals for the linear model represented by
<code>object</code>. 
</p>


<h3>Note</h3>

<p>This method function is primarily used inside <code>gls</code> and 
<code>residuals.gls</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>,
<code><a href="#glsStruct">glsStruct</a></code>,
<code><a href="#residuals.gls">residuals.gls</a></code>,
<code><a href="#fitted.glsStruct">fitted.glsStruct</a></code> </p>

<hr>
</div>
<div class="container manual-page" id="residuals.gnlsStruct">

<a href="#residuals.gnlsStruct" class="help-page-title"><h2>Calculate gnlsStruct Residuals</h2></a>

<h3>Description</h3>

<p>The residuals for the nonlinear model represented by <code>object</code>
are extracted.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gnlsStruct'</span>
residuals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gnlsStruct">gnlsStruct</a>"</code>,
representing a list of model components, such as
<code>corStruct</code> and <code>varFunc</code> objects, and attributes
specifying the underlying nonlinear model and the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector with the residuals for the nonlinear model represented by
<code>object</code>. 
</p>


<h3>Note</h3>

<p>This method function is primarily used inside <code>gnls</code> and 
<code>residuals.gnls</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#gnls">gnls</a></code>,
<code><a href="#residuals.gls">residuals.gnls</a></code>,
<code><a href="#fitted.gnlsStruct">fitted.gnlsStruct</a></code> </p>

<hr>
</div>
<div class="container manual-page" id="residuals.lme">

<a href="#residuals.lme" class="help-page-title"><h2>Extract lme Residuals</h2></a>

<h3>Description</h3>

<p>The residuals at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by subtracting the fitted
levels at that level from the response vector (and dividing
by the estimated within-group standard error, if
<code>type="pearson"</code>). The fitted values at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained
by adding together the population fitted values (based only on the
fixed effects estimates) and the estimated contributions of the random
effects to the fitted values at grouping levels less or equal to
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
residuals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level <span class="token operator">=</span> Q<span class="token punctuation">,</span>
          type <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"response"</span><span class="token punctuation">,</span> <span class="token string">"pearson"</span><span class="token punctuation">,</span> <span class="token string">"normalized"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> asList <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping
to be used in extracting the residuals from <code>object</code>. Level
values increase from outermost to innermost grouping, with
level zero corresponding to the population residuals. Defaults to
the highest or innermost level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>an optional character string specifying the type of
residuals to be used.  If <code>"response"</code>, as by default, the
“raw” residuals (observed - fitted) are used; else, if
<code>"pearson"</code>, the
standardized residuals (raw residuals divided by the corresponding
standard errors) are used; else, if <code>"normalized"</code>, the
normalized residuals (standardized residuals pre-multiplied by the
inverse square-root factor of the estimated error correlation
matrix) are used. Partial matching of arguments is used, so only the
first character needs to be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> and a single
value is given in <code>level</code>, the returned object is a list with
the residuals split by groups; else the returned value is
either a vector or a data frame, according to the length of
<code>level</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if a single level of grouping is specified in <code>level</code>, the
returned value is either a list with the residuals split by groups
(<code>asList = TRUE</code>) or a vector with the residuals
(<code>asList = FALSE</code>); else, when multiple grouping levels are
specified in <code>level</code>, the returned object is a data frame with
columns given by the residuals at different levels and the grouping
factors.  For a vector or data frame result the <code><a href="https://r-universe.dev/manuals/stats.html#nafns">naresid</a></code>
method is applied.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#fitted.lme">fitted.lme</a></code> </p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">+</span> Sex<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">)</span>
head<span class="token punctuation">(</span>residuals<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>residuals<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span> <span class="token operator">/</span>
        residuals<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># constant scaling factor 1.432</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="residuals.lmeStruct">

<a href="#residuals.lmeStruct" class="help-page-title"><h2>Calculate lmeStruct Residuals</h2></a>

<h3>Description</h3>

<p>The residuals at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by subtracting the fitted
values at that level from the response vector.  The fitted values at
level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by adding together the population fitted
values (based only on the fixed effects estimates) and the estimated
contributions of the random effects to the fitted values at grouping
levels less or equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmeStruct'</span>
residuals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> lmeFit<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmeStruct">lmeStruct</a>"</code>,
representing a list of linear mixed-effects model components, such as
<code>reStruct</code>, <code>corStruct</code>, and <code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping
to be used in extracting the residuals from <code>object</code>.  Level
values increase from outermost to innermost grouping, with
level zero corresponding to the population fitted values.  Defaults to
the highest or innermost level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>an optional condensed linear model object, consisting of
a list with components <code>"Xy"</code>, corresponding to a regression
matrix (<code>X</code>) combined with a response vector (<code>y</code>), and
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying lme model.  Defaults to <code>attr(object, "conLin")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmeFit</code></td>
<td>
<p>an optional list with components <code>beta</code> and <code>b</code>
containing respectively the fixed effects estimates and the random
effects estimates to be used to calculate the residuals.  Defaults
to <code>attr(object, "lmeFit")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic accept optional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if a single level of grouping is specified in <code>level</code>,
the returned value is a vector with the residuals at the desired
level; else, when multiple grouping levels are specified in
<code>level</code>, the returned object is a matrix with
columns given by the residuals at different levels.
</p>


<h3>Note</h3>

<p>This method function is primarily used within the <code><a href="#lme">lme</a></code>
function.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>,
<code><a href="#residuals.lme">residuals.lme</a></code>,
<code><a href="#fitted.lmeStruct">fitted.lmeStruct</a></code> </p>

<hr>
</div>
<div class="container manual-page" id="residuals.lmList">

<a href="#residuals.lmList" class="help-page-title"><h2>Extract lmList Residuals</h2></a>

<h3>Description</h3>

<p>The residuals are extracted from each <code>lm</code> component of
<code>object</code> and arranged into a list with as many components as
<code>object</code>, or combined into a single vector.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
residuals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> type<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> asList<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> objects with a common model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional character or integer vector naming the
<code>lm</code> components of <code>object</code> from which the residuals 
are to be extracted. Default is <code>NULL</code>, in which case all
components are used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>an optional character string specifying the type of
residuals to be extracted. Options include <code>"response"</code> for the
"raw" residuals (observed - fitted), <code>"pearson"</code> for the
standardized residuals (raw residuals divided by the estimated
residual standard error) using different standard errors for each
<code>lm</code> fit, and <code>"pooled.pearson"</code> for the standardized
residuals using a pooled estimate of the residual standard
error. Partial matching of arguments is used, so only the first 
character needs to be provided. Defaults to <code>"response"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, the returned
object is a list with the residuals split by groups; else the
returned value is a vector. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components given by the residuals of each <code>lm</code>
component of <code>object</code>, or a vector with the residuals for all
<code>lm</code> components of <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>, <code><a href="#fitted.lmList">fitted.lmList</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
residuals<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="residuals.nlmeStruct">

<a href="#residuals.nlmeStruct" class="help-page-title"><h2>Calculate nlmeStruct Residuals</h2></a>

<h3>Description</h3>

<p>The residuals at level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by subtracting the fitted
values at that level from the response vector. The fitted values at
level <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> are obtained by adding together the contributions from
the estimated fixed effects and the estimated random effects at levels
less or equal to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> and evaluating the model function at the
resulting estimated parameters. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'nlmeStruct'</span>
residuals<span class="token punctuation">(</span>object<span class="token punctuation">,</span> level<span class="token punctuation">,</span> conLin<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#nlmeStruct">nlmeStruct</a>"</code>,
representing a list of mixed-effects model components, such as
<code>reStruct</code>, <code>corStruct</code>, and <code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping
to be used in extracting the residuals from <code>object</code>. Level
values increase from outermost to innermost grouping, with
level zero corresponding to the population fitted values. Defaults to
the highest or innermost level of grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conLin</code></td>
<td>
<p>an optional condensed linear model object, consisting of
a list with components <code>"Xy"</code>, corresponding to a regression
matrix (<code>X</code>) combined with a response vector (<code>y</code>), and 
<code>"logLik"</code>, corresponding to the log-likelihood of the
underlying nlme model. Defaults to <code>attr(object, "conLin")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to the residuals generic.  Not
used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if a single level of grouping is specified in <code>level</code>,
the returned value is a vector with the residuals at the desired
level; else, when multiple grouping levels are specified in
<code>level</code>, the returned object is a matrix with 
columns given by the residuals at different levels. 
</p>


<h3>Note</h3>

<p>This method function is primarily used within the <code>nlme</code>
function. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Bates, D.M. and Pinheiro, J.C. (1998) "Computational methods for
multilevel models" available in PostScript or PDF formats at
http://nlme.stat.wisc.edu
</p>


<h3>See Also</h3>

<p><code><a href="#nlme">nlme</a></code>,
<code><a href="#fitted.nlmeStruct">fitted.nlmeStruct</a></code> </p>

<hr>
</div>
<div class="container manual-page" id="reStruct">

<a href="#reStruct" class="help-page-title"><h2>Random Effects Structure</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>reStruct</code> class,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects, plus a <code>settings</code> attribute containing
information for the optimization algorithm used to fit the associated
mixed-effects model.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">reStruct<span class="token punctuation">(</span>object<span class="token punctuation">,</span> pdClass<span class="token punctuation">,</span> REML<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'reStruct'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> reEstimates<span class="token punctuation">,</span> verbose<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>any of the following: (i) a one-sided formula of the form
<code>~x1+...+xn | g1/.../gm</code>, with <code>x1+...+xn</code> specifying the
model for the random effects and <code>g1/.../gm</code> the grouping
structure (<code>m</code> may be equal to 1, in which case no <code>/</code> is
required). The random effects formula will be repeated for all levels
of grouping, in the case of multiple levels of grouping; (ii) a list of
one-sided formulas of the form <code>~x1+...+xn | g</code>, with possibly
different random effects models for each grouping level. The order of
nesting will be assumed the same as the order of the elements in the
list; (iii) a one-sided formula of the form <code>~x1+...+xn</code>, or a
<code>pdMat</code> object with a formula (i.e. a non-<code>NULL</code> value for
<code>formula(object)</code>), or a list of such formulas or <code>pdMat</code>
objects. In this case, the grouping structure formula will be derived
from the data used to to fit the mixed-effects model, which should
inherit from class <code>groupedData</code>; (iv) a named list of formulas or
<code>pdMat</code> objects as in (iii), with the grouping factors as
names. The order of nesting will be assumed the same as the order of
the order of the elements in the list; (v) an <code>reStruct</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdClass</code></td>
<td>
<p>an optional character string with the name of the
<code>pdMat</code> class to be used for the formulas in
<code>object</code>. Defaults to <code>"pdLogChol"</code> which corresponds to a
general positive-definite matrix (Log-Cholesky parametrization).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code>, the associated
mixed-effects model will be fitted using restricted maximum
likelihood; else, if <code>FALSE</code>, maximum likelihood will be
used. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to evaluate the variables
used in the random effects formulas in <code>object</code>. It is used to
obtain the levels for <code>factors</code>, which affect the dimensions and
the row/column names of the underlying <code>pdMat</code> objects. If
<code>NULL</code>, no attempt is made to obtain information on
<code>factors</code> appearing in the formulas. Defaults to the
parent frame from which the function was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>reStruct</code> to be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>an optional numeric value used as a multiplier for
the square-root factors of the <code>pdMat</code> components (usually the
estimated within-group standard deviation from a mixed-effects
model). Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reEstimates</code></td>
<td>
<p>an optional list with the random effects estimates
for each level of grouping. Only used when <code>verbose = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value determining if the random
effects estimates should be printed. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments can be given to other methods for this
generic.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object inheriting from class <code>reStruct</code>, representing a random
effects structure.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#groupedData">groupedData</a></code>, 
<code><a href="#lme">lme</a></code>,
<code><a href="#pdMat">pdMat</a></code>,
<code><a href="#solve.reStruct">solve.reStruct</a></code>,
<code><a href="#summary.modelStruct">summary.reStruct</a></code>,
<code><a href="#update.modelStruct">update.reStruct</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>list<span class="token punctuation">(</span>Dog <span class="token operator">=</span> <span class="token operator">~</span>day<span class="token punctuation">,</span> Side <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Pixel<span class="token punctuation">)</span>
rs1</code></pre>

<hr>
</div>
<div class="container manual-page" id="simulate.lme">

<a href="#simulate.lme" class="help-page-title"><h2>Simulate Results from <code>lme</code> Models</h2></a>

<h3>Description</h3>

<p>The model <code>object</code> is fit to the data.  Using
the fitted values of the parameters, <code>nsim</code> new data vectors from
this model are simulated.  Both <code>object</code> and <code>m2</code> are fit by
maximum likelihood (ML) and/or by restricted maximum likelihood (REML)
to each of the simulated data vectors.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
simulate<span class="token punctuation">(</span>object<span class="token punctuation">,</span> nsim <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> seed <span class="token operator">=</span> <span class="token punctuation">,</span> m2<span class="token punctuation">,</span>
         method <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"REML"</span><span class="token punctuation">,</span> <span class="token string">"ML"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> niterEM <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> useGen<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing a fitted
linear mixed-effects model, or a list containing an <code>lme</code> model
specification.  If given as a list, it should contain
components <code>fixed</code>, <code>data</code>, and <code>random</code>
with values suitable for a call to <code><a href="#lme">lme</a></code>.  This argument
defines the null model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>an <code>"<a href="#lme">lme</a>"</code> object or a list, like <code>object</code>
containing a second lme model specification.  This argument defines
the alternative model.  If given as a list, only those parts of the
specification that change between model <code>object</code> and <code>m2</code>
need to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>an optional integer that is passed to <code>set.seed</code>.  Defaults to
a random integer.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>an optional character array.  If it includes
<code>"REML"</code> the models are fit by maximizing the restricted
log-likelihood.  If it includes <code>"ML"</code> the log-likelihood is
maximized.  Defaults to <code>c("REML", "ML")</code>, in which case both
methods are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>an optional positive integer specifying the number of
simulations to perform.  Defaults to <code>1</code>. <b>This has
changed.  Previously the default was 1000.</b>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niterEM</code></td>
<td>
<p>an optional integer vector of length 2 giving the number of
iterations of the EM algorithm to apply when fitting the <code>object</code>
and <code>m2</code> to each simulated set of data.  Defaults to <code>c(40,200)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useGen</code></td>
<td>

<p>an optional logical value.  If <code>TRUE</code>, the <code><a href="https://r-universe.dev/manuals/stats.html#nlminb">nlminb</a></code>
optimizer is used with numerical derivatives of the log-likelihood. If
<code>FALSE</code>, the <code><a href="https://r-universe.dev/manuals/stats.html#nlm">nlm</a></code> algorithm is used with an
analytic gradient.  The default
depends on the <code>"<a href="#pdMat">pdMat</a>"</code> classes used in <code>object</code> and <code>m2</code>:
if both are standard classes (see <code><a href="#pdClasses">pdClasses</a></code>) then
defaults to <code>FALSE</code>, otherwise defaults to <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional additional arguments.  None are used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>simulate.lme</code> with components <code>null</code> and
<code>alt</code>.  Each of these has components <code>ML</code> and/or <code>REML</code>
which are matrices.  An attribute called <code>seed</code> contains
the seed that was used for the random number generator.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000)
<em>Mixed-Effects Models in S and S-PLUS</em>, Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#Random">set.seed</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">orthSim <span class="token operator">&lt;-</span>
   simulate.lme<span class="token punctuation">(</span>list<span class="token punctuation">(</span>fixed <span class="token operator">=</span> distance <span class="token operator">~</span> age<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">,</span>
                     random <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Subject<span class="token punctuation">)</span><span class="token punctuation">,</span> nsim <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span>
                m2 <span class="token operator">=</span> list<span class="token punctuation">(</span>random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="solve.pdMat">

<a href="#solve.pdMat" class="help-page-title"><h2>Calculate Inverse of a Positive-Definite Matrix</h2></a>

<h3>Description</h3>

<p>The positive-definite matrix represented by <code>a</code> is inverted and
assigned to <code>a</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>, representing
a positive definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>this argument is only included for consistency with the generic
function and is not used in this method function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>pdMat</code> object similar to <code>a</code>, but with coefficients
corresponding to the inverse of the positive-definite matrix
represented by <code>a</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pd1 <span class="token operator">&lt;-</span> pdCompSymm<span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> diag<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>pd1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="solve.reStruct">

<a href="#solve.reStruct" class="help-page-title"><h2>Apply Solve to an reStruct Object</h2></a>

<h3>Description</h3>

<p><code>Solve</code> is applied to each <code>pdMat</code> component of <code>a</code>,
which results in inverting the positive-definite matrices they
represent. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'reStruct'</span>
solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#reStruct">reStruct</a>"</code>,
representing a random effects structure and consisting of a list of
<code>pdMat</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>this argument is only included for consistency with the
generic function and is not used in this method function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an <code>reStruct</code> object similar to <code>a</code>, but with the
<code>pdMat</code> components representing the inverses of the
matrices represented by the components of <code>a</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#solve.pdMat">solve.pdMat</a></code>, <code><a href="#reStruct">reStruct</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">rs1 <span class="token operator">&lt;-</span> reStruct<span class="token punctuation">(</span>list<span class="token punctuation">(</span>A <span class="token operator">=</span> pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>Score<span class="token punctuation">)</span><span class="token punctuation">,</span>
  B <span class="token operator">=</span> pdDiag<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> diag<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>Educ<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>rs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Soybean">

<a href="#Soybean" class="help-page-title"><h2>Growth of soybean plants</h2></a>

<h3>Description</h3>

<p>The <code>Soybean</code> data frame has 412 rows and 5 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Plot</dt>
<dd>
<p>a factor giving a unique identifier for each plot.
</p>
</dd>
<dt>Variety</dt>
<dd>
<p>a factor indicating the variety; Forrest (F) or Plant
Introduction #416937 (P).
</p>
</dd>
<dt>Year</dt>
<dd>
<p>a factor indicating the year the plot was planted.
</p>
</dd>
<dt>Time</dt>
<dd>
<p>a numeric vector giving the time the sample was taken (days
after planting).
</p>
</dd>
<dt>weight</dt>
<dd>
<p>a numeric vector giving the average leaf weight per plant (g).
</p>
</dd>
</dl>
<h3>Details</h3>

<p>These data are described in
Davidian and Giltinan (1995, 1.1.3, p.7) as “Data from an
experiment to compare growth patterns of two genotypes of soybeans:
Plant Introduction #416937 (P), an experimental strain, and Forrest
(F), a commercial variety.”
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.27)
</p>
<p>Davidian, M. and Giltinan, D. M. (1995), <em>Nonlinear Models for
Repeated Measurement Data</em>,  Chapman and Hall, London.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">summary<span class="token punctuation">(</span>fm1 <span class="token operator">&lt;-</span> nlsList<span class="token punctuation">(</span>SSlogis<span class="token punctuation">,</span> data <span class="token operator">=</span> Soybean<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="splitFormula">

<a href="#splitFormula" class="help-page-title"><h2>Split a Formula</h2></a>

<h3>Description</h3>

<p>Splits the right hand side of <code>form</code> into a list of subformulas
according to the presence of <code>sep</code>. The left hand side of
<code>form</code>, if present, will be ignored. The length of the returned
list will be equal to the number of occurrences of <code>sep</code> in
<code>form</code> plus one. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">splitFormula<span class="token punctuation">(</span>form<span class="token punctuation">,</span> sep<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a <code>formula</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>an optional character string specifying the separator to be
used for splitting the formula. Defaults to <code>"/"</code>. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of formulas, corresponding to the split of <code>form</code>
according to <code>sep</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#formula">formula</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">splitFormula<span class="token punctuation">(</span><span class="token operator">~</span> g1<span class="token operator">/</span>g2<span class="token operator">/</span>g3<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Spruce">

<a href="#Spruce" class="help-page-title"><h2>Growth of Spruce Trees</h2></a>

<h3>Description</h3>

<p>The <code>Spruce</code> data frame has 1027 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Tree</dt>
<dd>
<p>a factor giving a unique identifier for each tree.
</p>
</dd>
<dt>days</dt>
<dd>
<p>a numeric vector giving the number of days since the
beginning of the experiment.
</p>
</dd>
<dt>logSize</dt>
<dd>
<p>a numeric vector giving the logarithm of an estimate of the
volume of the tree trunk.
</p>
</dd>
<dt>plot</dt>
<dd>
<p>a factor identifying the plot in which the tree was grown.
</p>
</dd>
</dl>
<h3>Details</h3>

<p>Diggle, Liang, and Zeger (1994, Example 1.3, page 5)
describe data on the growth of spruce trees that have been exposed to
an ozone-rich atmosphere or to a normal atmosphere.
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.28)
</p>
<p>Diggle, Peter J., Liang, Kung-Yee and Zeger, Scott L. (1994),
<em>Analysis of longitudinal data</em>, Oxford University Press,
Oxford.
</p>

<hr>
</div>
<div class="container manual-page" id="summary.corStruct">

<a href="#summary.corStruct" class="help-page-title"><h2>Summarize a corStruct Object</h2></a>

<h3>Description</h3>

<p>This method function prepares <code>object</code> to be printed using the
<code>print.summary</code> method, by changing its class and adding a
<code>structName</code> attribute to it.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corStruct'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> structName<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corClasses">corStruct</a>"</code>,
representing a correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structName</code></td>
<td>
<p>an optional character string defining the type of
correlation structure associated with <code>object</code>, to be used in
the <code>print.summary</code> method. Defaults to
<code>class(object)[1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object identical to <code>object</code>, but with its class changed to
<code>summary.corStruct</code> and an additional attribute
<code>structName</code>. The returned value inherits from the same classes
as <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates </p>


<h3>See Also</h3>

<p><code><a href="#corClasses">corClasses</a></code>, 
<code><a href="#corNatural">corNatural</a></code>,
<code><a href="#Initialize.corStruct">Initialize.corStruct</a></code>, 
<code><a href="https://r-universe.dev/manuals/base.html#summary">summary</a></code> 
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corAR1<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>cs1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.gls">

<a href="#summary.gls" class="help-page-title"><h2>Summarize a Generalized Least Squares <code>gls</code> Object</h2></a>

<h3>Description</h3>

<p>Additional information about the linear model fit represented
by <code>object</code> is extracted and included as components of
<code>object</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> verbose<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gls">gls</a>"</code>, representing
a generalized least squares fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value used to control the amount of
output when the object is printed. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object inheriting from class <code>summary.gls</code> with all components
included in <code>object</code> (see <code><a href="#glsObject">glsObject</a></code> for a full
description of the components) plus the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>corBeta</code></td>
<td>
<p>approximate correlation matrix for the coefficients
estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tTable</code></td>
<td>
<p>a matrix with columns <code>Value</code>,
<code>Std. Error</code>, <code>t-value</code>, and <code>p-value</code> representing
respectively the coefficients estimates, their approximate standard
errors, the ratios between the estimates and their standard errors,
and the associated p-value under a <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></code> approximation.  Rows
correspond to the different coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>if more than five observations are used in the
<code>gls</code> fit, a vector with the minimum, first quartile, median, third
quartile, and maximum of the residuals distribution; else the
residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>the Akaike Information Criterion corresponding to
<code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>the Bayesian Information Criterion corresponding to
<code>object</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#AIC">AIC</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#AIC">BIC</a></code>,
<code><a href="#gls">gls</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#summary">summary</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span>Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
           correlation <span class="token operator">=</span> corAR1<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Mare<span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># "the matrix"</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.lme">

<a href="#summary.lme" class="help-page-title"><h2>Summarize an lme Object</h2></a>

<h3>Description</h3>

<p>Additional information about the linear mixed-effects fit represented
by <code>object</code> is extracted and included as components of
<code>object</code>.  The returned object has a <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code> and a
<code><a href="https://r-universe.dev/manuals/stats.html#coef">coef</a></code> method, the latter returning the coefficient's
<code>tTtable</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> adjustSigma<span class="token punctuation">,</span> verbose<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'summary.lme'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> verbose <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustSigma</code></td>
<td>
<p>an optional logical value.  If <code>TRUE</code> and the
estimation method used to obtain <code>object</code> was maximum
likelihood, the residual standard error is multiplied by
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><msub><mi>n</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mo>−</mo><msub><mi>n</mi><mrow><mi>p</mi><mi>a</mi><mi>r</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{n_{obs}/(n_{obs} - n_{par})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.3231em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9169em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.8769em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3231em;"><span></span></span></span></span></span></span></span></span></code>,
converting it to a REML-like estimate.  This argument is only used
when a single fitted object is passed to the function.  Default is
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value used to control the amount of
output in the <code>print.summary.lme</code> method.  Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional optional arguments passed to methods, mainly
for the <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>"summary.lme"</code> object.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object inheriting from class <code>summary.lme</code> with all components
included in <code>object</code> (see <code><a href="#lmeObject">lmeObject</a></code> for a full
description of the components) plus the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>corFixed</code></td>
<td>
<p>approximate correlation matrix for the fixed effects
estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tTable</code></td>
<td>
<p>a matrix with columns named <code>Value</code>,
<code>Std. Error</code>, <code>DF</code>, <code>t-value</code>, and <code>p-value</code>
representing respectively the fixed effects estimates, their
approximate standard errors, the denominator degrees of freedom, the
ratios between the estimates and their standard errors, and the
associated p-value from a t distribution.  Rows correspond to the
different fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>if more than five observations are used in the
<code>lme</code> fit, a vector with the minimum, first quartile, median, third
quartile, and maximum of the innermost grouping level residuals
distribution; else the innermost grouping level residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>the Akaike Information Criterion corresponding to
<code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>the Bayesian Information Criterion corresponding to
<code>object</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#AIC">AIC</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#AIC">BIC</a></code>,
<code><a href="#lme">lme</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">)</span>
<span class="token punctuation">(</span>s1 <span class="token operator">&lt;-</span> summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span><span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token comment"># the (coef | Std.E | t | P-v ) matrix</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.lmList">

<a href="#summary.lmList" class="help-page-title"><h2>Summarize an lmList Object</h2></a>

<h3>Description</h3>

<p>The <code>summary.lm</code> method is applied to each <code>lm</code> component of
<code>object</code> to produce summary information on the individual fits,
which is organized into a list of summary statistics. The returned
object is suitable for printing with the <code>print.summary.lmList</code>
method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmList'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> pool<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmList">lmList</a>"</code>, representing
a list of <code>lm</code> fitted objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>an optional logical value indicating whether a pooled
estimate of the residual standard error should be used. Default is
<code>attr(object, "pool")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with summary statistics obtained by applying <code>summary.lm</code>
to the elements of <code>object</code>, inheriting from class
<code>summary.lmList</code>. The components of <code>value</code> are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a list containing an image of the <code>lmList</code> call that
produced <code>object</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a three dimensional array with summary information
on the <code>lm</code> coefficients. The first dimension corresponds to
the names of the <code>object</code> components, the second dimension is
given by   <code>"Value"</code>, <code>"Std. Error"</code>, <code>"t value"</code>,
and <code>"Pr(&gt;|t|)"</code>, corresponding, respectively, to the
coefficient estimates and their associated standard errors,
t-values, and p-values. The third dimension is given by the
coefficients names.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>a three dimensional array with the 
correlations between the individual <code>lm</code> coefficient
estimates. The first dimension corresponds to the names of the
<code>object</code> components. The third dimension is given by the
coefficients names. For each coefficient, the rows of the associated
array give the correlations between that coefficient and the
remaining coefficients, by <code>lm</code> component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.unscaled</code></td>
<td>
<p>a three dimensional array with the unscaled
variances/covariances for the individual <code>lm</code> coefficient
estimates (giving the estimated variance/covariance for the
coefficients, when multiplied by the estimated residual errors). The
first dimension corresponds to the names of the <code>object</code>
components. The third dimension is given by the
coefficients names. For each coefficient, the rows of the associated
array give the unscaled covariances between that coefficient and the
remaining coefficients, by <code>lm</code> component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>an array with the number of degrees of freedom for the model
and for residuals, for each <code>lm</code> component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>the total number of degrees of freedom for
residuals, corresponding to the sum of residuals df of all <code>lm</code>
components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fstatistics</code></td>
<td>
<p>an array with the F test statistics and
corresponding degrees of freedom, for each <code>lm</code> component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>the value of the <code>pool</code> argument to the function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.squared</code></td>
<td>
<p>a vector with the multiple R-squared statistics for
each <code>lm</code> component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>a list with components given by the residuals from
individual <code>lm</code> fits.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RSE</code></td>
<td>
<p>the pooled estimate of the residual standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>a vector with the residual standard error estimates for
the individual <code>lm</code> fits.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the terms object used in fitting the individual <code>lm</code>
components.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#lmList">lmList</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#summary">summary</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lmList<span class="token punctuation">(</span>distance <span class="token operator">~</span> age <span class="token operator">|</span> Subject<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.modelStruct">

<a href="#summary.modelStruct" class="help-page-title"><h2>Summarize a modelStruct Object</h2></a>

<h3>Description</h3>

<p>This method function applies <code>summary</code> to each element of
<code>object</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'modelStruct'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"modelStruct"</code>,
representing a list of model components, such as <code>reStruct</code>,
<code>corStruct</code> and <code>varFunc</code> objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with elements given by the summarized components of
<code>object</code>. The returned value is of class
<code>summary.modelStruct</code>, also inheriting from the same classes as
<code>object</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#reStruct">reStruct</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#summary">summary</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">lms1 <span class="token operator">&lt;-</span> lmeStruct<span class="token punctuation">(</span>reStruct <span class="token operator">=</span> reStruct<span class="token punctuation">(</span>pdDiag<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">~</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   corStruct <span class="token operator">=</span> corAR1<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>lms1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.nlsList">

<a href="#summary.nlsList" class="help-page-title"><h2>Summarize an nlsList Object</h2></a>

<h3>Description</h3>

<p>The <code>summary</code> function is applied to each <code>nls</code> component of
<code>object</code> to produce summary information on the individual fits,
which is organized into a list of summary statistics. The returned
object is suitable for printing with the <code>print.summary.nlsList</code>
method. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'nlsList'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#nlsList">nlsList</a>"</code>,
representing a list of <code>nls</code> fitted objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to the <code>summary.lmList</code> method.
One such optional argument is <code>pool</code>, a logical value indicating
whether a pooled estimate of the residual standard error should be
used. Default is <code>attr(object, "pool")</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with summary statistics obtained by applying <code>summary</code>
to the elements of <code>object</code>, inheriting from class
<code>summary.nlsList</code>. The components of <code>value</code> are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a list containing an image of the <code>nlsList</code> call that
produced <code>object</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>a three dimensional array with summary information
on the <code>nls</code> coefficients. The first dimension corresponds to
the names of the <code>object</code> components, the second dimension is
given by   <code>"Value"</code>, <code>"Std. Error"</code>, <code>"t value"</code>,
and <code>"Pr(&gt;|t|)"</code>, corresponding, respectively, to the
coefficient estimates and their associated standard errors,
t-values, and p-values. The third dimension is given by the
coefficients names.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>a three dimensional array with the 
correlations between the individual <code>nls</code> coefficient
estimates. The first dimension corresponds to the names of the
<code>object</code> components. The third dimension is given by the
coefficients names. For each coefficient, the rows of the associated
array give the correlations between that coefficient and the
remaining coefficients, by <code>nls</code> component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.unscaled</code></td>
<td>
<p>a three dimensional array with the unscaled
variances/covariances for the individual <code>lm</code> coefficient
estimates (giving the estimated variance/covariance for the
coefficients, when multiplied by the estimated residual errors). The
first dimension corresponds to the names of the <code>object</code>
components. The third dimension is given by the
coefficients names. For each coefficient, the rows of the associated
array give the unscaled covariances between that coefficient and the
remaining coefficients, by <code>nls</code> component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>an array with the number of degrees of freedom for the model
and for residuals, for each <code>nls</code> component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>the total number of degrees of freedom for
residuals, corresponding to the sum of residuals df of all <code>nls</code>
components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>the value of the <code>pool</code> argument to the function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RSE</code></td>
<td>
<p>the pooled estimate of the residual standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>a vector with the residual standard error estimates for
the individual <code>lm</code> fits.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#nlsList">nlsList</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#summary">summary</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> nlsList<span class="token punctuation">(</span>SSasymp<span class="token punctuation">,</span> Loblolly<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.pdMat">

<a href="#summary.pdMat" class="help-page-title"><h2>Summarize a pdMat Object</h2></a>

<h3>Description</h3>

<p>Attributes <code>structName</code> and <code>noCorrelation</code>, with the values
of the corresponding arguments to the method function, are appended to
<code>object</code> and its class is changed to <code>summary.pdMat</code>. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pdMat'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> structName<span class="token punctuation">,</span> noCorrelation<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#pdMat">pdMat</a>"</code>, representing
a positive definite matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structName</code></td>
<td>
<p>an optional character string with a description of
the <code>pdMat</code> class. Default depends on the method function:
<code>"Blocked"</code> for <code>pdBlocked</code>,
<code>"Compound Symmetry"</code> for <code>pdCompSymm</code>, <code>"Diagonal"</code>
for <code>pdDiag</code>, <code>"Multiple of an Identity"</code> for
<code>pdIdent</code>,
<code>"General Positive-Definite, Natural Parametrization"</code>
for <code>pdNatural</code>, <code>"General Positive-Definite"</code>
for <code>pdSymm</code>, and <code>data.class(object)</code> for <code>pdMat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noCorrelation</code></td>
<td>
<p>an optional logical value indicating whether
correlations are to be printed in <code>print.summary.pdMat</code>. Default
depends on the method function: <code>FALSE</code> for <code>pdDiag</code> and
<code>pdIdent</code>, and <code>TRUE</code> for all other classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object similar to <code>object</code>, with additional attributes
<code>structName</code> and <code>noCorrelation</code>, inheriting from class
<code>summary.pdMat</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#print.summary.pdMat">print.summary.pdMat</a></code>,
<code><a href="#pdMat">pdMat</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">summary<span class="token punctuation">(</span>pdSymm<span class="token punctuation">(</span>diag<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.varFunc">

<a href="#summary.varFunc" class="help-page-title"><h2>Summarize "varFunc" Object</h2></a>

<h3>Description</h3>

<p>A <code>structName</code> attribute, with the value of corresponding
argument, is appended to <code>object</code> and its class is changed to
<code>summary.varFunc</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'varFunc'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> structName<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#varFunc">varFunc</a>"</code>,
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structName</code></td>
<td>
<p>an optional character string with a description of
the <code>varFunc</code> class.  Default depends on the method function:
</p>

<dl>
<dt>for <code>varComb</code>:</dt>
<dd>
<p><code>"Combination of variance functions"</code>,</p>
</dd>
<dt>for <code>varConstPower</code>:</dt>
<dd>
<p><code>"Constant plus power of variance covariate"</code>,</p>
</dd>
<dt>for <code>varConstProp</code>:</dt>
<dd>
<p><code>"Constant plus proportion of variance covariate"</code>,</p>
</dd>
<dt>for <code>varExp</code>:</dt>
<dd>
<p><code>"Exponential of variance covariate"</code>,</p>
</dd>
<dt>for <code>varIdent</code>:</dt>
<dd>
<p><code>"Different standard deviations per stratum"</code>,</p>
</dd>
<dt>for <code>varPower</code>:</dt>
<dd>
<p><code>"Power of variance covariate"</code>,</p>
</dd>
<dt>for <code>varFunc</code>:</dt>
<dd>
<p><code>data.class(object)</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object similar to <code>object</code>, with an additional attribute
<code>structName</code>, inheriting from class <code>summary.varFunc</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#varClasses">varClasses</a></code>,
<code><a href="#varFunc">varFunc</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token punctuation">)</span>
vf1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>vf1<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Tetracycline1">

<a href="#Tetracycline1" class="help-page-title"><h2>Pharmacokinetics of tetracycline</h2></a>

<h3>Description</h3>

<p>The <code>Tetracycline1</code> data frame has 40 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>conc</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>Time</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>Subject</dt>
<dd>
<p>an ordered factor with levels
<code>5</code> &lt; <code>3</code> &lt; <code>2</code> &lt; <code>4</code> &lt; <code>1</code>
</p>
</dd>
<dt>Formulation</dt>
<dd>
<p>a factor with levels
<code>tetrachel</code> 
<code>tetracyn</code> 
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="Tetracycline2">

<a href="#Tetracycline2" class="help-page-title"><h2>Pharmacokinetics of tetracycline</h2></a>

<h3>Description</h3>

<p>The <code>Tetracycline2</code> data frame has 40 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>conc</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>Time</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>Subject</dt>
<dd>
<p>an ordered factor with levels
<code>4</code> &lt; <code>5</code> &lt; <code>2</code> &lt; <code>1</code> &lt; <code>3</code>
</p>
</dd>
<dt>Formulation</dt>
<dd>
<p>a factor with levels
<code>Berkmycin</code> 
<code>tetramycin</code> 
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="update.modelStruct">

<a href="#update.modelStruct" class="help-page-title"><h2>Update a modelStruct Object</h2></a>

<h3>Description</h3>

<p>This method function updates each element of <code>object</code>, allowing
the access to <code>data</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'modelStruct'</span>
update<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"modelStruct"</code>,
representing a list of model components, such as <code>corStruct</code> and
<code>varFunc</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to evaluate the variables needed for
updating the elements of <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object similar to <code>object</code> (same class, length, and names),
but with updated elements.
</p>


<h3>Note</h3>

<p>This method function is primarily used within model fitting
functions, such as <code>lme</code> and <code>gls</code>, that allow model
components such as variance functions.</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#reStruct">reStruct</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="update.varFunc">

<a href="#update.varFunc" class="help-page-title"><h2>Update varFunc Object</h2></a>

<h3>Description</h3>

<p>If the <code>formula(object)</code> includes a <code>"."</code> term, representing
a fitted object, the variance covariate needs to be updated upon
completion of an optimization cycle (in which the variance function
weights are kept fixed). This method function allows a reevaluation of
the variance covariate using the current fitted object and,
optionally, other variables in the original data.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'varFunc'</span>
update<span class="token punctuation">(</span>object<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#varFunc">varFunc</a>"</code>,
representing a variance function structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list with a component named <code>"."</code> with the current
version of the fitted object (from which fitted values, coefficients,
and residuals can be extracted) and, if necessary, other variables
used to evaluate the variance covariate(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>formula(object)</code> includes a <code>"."</code> term, an
<code>varFunc</code> object similar to <code>object</code>, but with the 
variance covariate reevaluated at the current fitted object value;
else <code>object</code> is returned unchanged.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#needUpdate">needUpdate</a></code>,
<code><a href="#Covariate.varFunc">covariate&lt;-.varFunc</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="varClasses">

<a href="#varClasses" class="help-page-title"><h2>Variance Function Classes</h2></a>

<h3>Description</h3>

<p>Standard classes of variance function structures (<code>varFunc</code>) 
available in the <code>nlme</code> package. Covariates included in the
variance function, denoted by variance covariates, may involve
functions of the fitted model object, such as the fitted values and
the residuals. Different coefficients may be assigned to the levels of
a classification factor.
</p>


<h3>Value</h3>

<p>Available standard classes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>varExp</code></td>
<td>
<p>exponential of a variance covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varPower</code></td>
<td>
<p>power of a variance covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varConstPower</code></td>
<td>
<p>constant plus power of a variance covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varConstProp</code></td>
<td>
<p>constant plus proportion of a variance covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varIdent</code></td>
<td>
<p>constant variance(s), generally used to allow
different variances according to the levels of a classification
factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varFixed</code></td>
<td>
<p>fixed weights, determined by a variance covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varComb</code></td>
<td>
<p>combination of variance functions.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Users may define their own <code>varFunc</code> classes by specifying a
<code>constructor</code> function and, at a minimum, methods for the
functions <code>coef</code>, <code>coef&lt;-</code>, and <code>initialize</code>. For
examples of these functions, see the methods for class
<code>varPower</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#varComb">varComb</a></code>,
<code><a href="#varConstPower">varConstPower</a></code>,
<code><a href="#varConstProp">varConstProp</a></code>,
<code><a href="#varExp">varExp</a></code>,
<code><a href="#varFixed">varFixed</a></code>,
<code><a href="#varIdent">varIdent</a></code>,
<code><a href="#varPower">varPower</a></code>,
<code><a href="#summary.varFunc">summary.varFunc</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="varComb">

<a href="#varComb" class="help-page-title"><h2>Combination of Variance Functions</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>varComb</code> class,
representing a combination of variance functions. The corresponding
variance function is equal to the product of the variance functions of
the <code>varFunc</code> objects listed in <code>...</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">varComb<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>objects inheriting from class <code>varFunc</code> representing
variance function structures.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a <code>varComb</code> object representing a combination of variance
functions, also inheriting from class <code>varFunc</code>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#varClasses">varClasses</a></code>,
<code><a href="#varWeights">varWeights.varComb</a></code>,
<code><a href="#coef.varFunc">coef.varComb</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varComb<span class="token punctuation">(</span>varIdent<span class="token punctuation">(</span>form <span class="token operator">=</span> <span class="token operator">~</span><span class="token number">1</span><span class="token operator">|</span>Sex<span class="token punctuation">)</span><span class="token punctuation">,</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="varConstPower">

<a href="#varConstPower" class="help-page-title"><h2>Constant Plus Power Variance Function</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>varConstPower</code> class,
representing a constant plus power variance function
structure. Letting <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code> denote the variance covariate and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></code> denote the variance function evaluated at
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code>, the constant plus power variance function is defined as
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>+</mo><mi mathvariant="normal">∣</mi><mi>v</mi><msubsup><mi mathvariant="normal">∣</mi><mn>2</mn><mi>θ</mi></msubsup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^2(v) = (\theta_1 + |v|^\theta_2)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></code>, where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\theta_1,\theta_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are the variance  
function coefficients. When a grouping factor is present, different
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\theta_1,\theta_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are used for each factor level.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">varConstPower<span class="token punctuation">(</span>const<span class="token punctuation">,</span> power<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>const, power</code></td>
<td>
<p>optional numeric vectors, or lists of numeric
values, with, respectively, the coefficients for the constant 
and the power terms. Both arguments must have length one, unless a
grouping factor is specified in <code>form</code>. If either argument has
length greater than one, it must have names which identify its
elements to the levels of the grouping factor defined in
<code>form</code>. If a grouping factor is present in 
<code>form</code> and the argument has length one, its value will be
assigned to all grouping levels. Only positive values are allowed
for <code>const</code>. Default is <code>numeric(0)</code>, which
results in a vector of zeros of appropriate length being assigned to
the coefficients when <code>object</code> is initialized (corresponding
to constant variance equal to one).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula of the form <code>~ v</code>, or
<code>~ v | g</code>, specifying a variance covariate <code>v</code> and,
optionally, a grouping factor <code>g</code> for the coefficients. The
variance covariate must evaluate to a numeric vector and may involve
expressions using <code>"."</code>, representing  a fitted model object
from which fitted values (<code>fitted(.)</code>) and residuals
(<code>resid(.)</code>) can be extracted (this allows the variance
covariate to be updated during the optimization of an object
function). When a grouping factor is present in <code>form</code>,
a different coefficient value is used for each of its
levels. Several grouping variables may be
simultaneously specified, separated by the <code>*</code> operator, as
in <code>~ v | g1 * g2 * g3</code>. In this case, the levels of each
grouping variable are pasted together and the resulting factor is
used to group the observations. Defaults to <code>~ fitted(.)</code>
representing a variance covariate given by the fitted values of a
fitted model object and no grouping factor. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional list with components <code>const</code> and/or
<code>power</code>, consisting of numeric vectors, or lists of numeric
values, specifying the values at which some or all of the
coefficients in the variance function should be fixed. If a grouping
factor is specified in <code>form</code>, the components of <code>fixed</code>
must have names identifying which coefficients are to be
fixed. Coefficients included in <code>fixed</code> are not allowed to vary
during the optimization of an objective function. Defaults to
<code>NULL</code>, corresponding to no fixed coefficients.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>varConstPower</code> object representing a constant plus power
variance function structure, also inheriting from class
<code>varFunc</code>.  
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#varClasses">varClasses</a></code>,
<code><a href="#varWeights">varWeights.varFunc</a></code>,
<code><a href="#coef.varFunc">coef.varConstPower</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varConstPower<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token operator">|</span>Sex<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="varConstProp">

<a href="#varConstProp" class="help-page-title"><h2>Constant Plus Proportion Variance Function</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>varConstProp</code> class,
representing a variance function structure corresponding to
a two-component error model (additive and proportional error). Letting
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code> denote the variance covariate and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></code>
denote the variance function evaluated at <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code>, the two-component variance
function is defined as
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup><mo>∗</mo><msup><mi>v</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^2(v) = a^2 + b^2 * v^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></code>, where a is
the additive component and b is the relative error component.  In order
to avoid overparameterisation of the model, it is recommended to use
the possibility to fix sigma, preferably to a value of 1 (see examples).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">varConstProp<span class="token punctuation">(</span>const<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>const, prop</code></td>
<td>
<p>optional numeric vectors, or lists of numeric
values, with, respectively, the coefficients for the constant
and the proportional error terms. Both arguments must have length one,
unless a grouping factor is specified in <code>form</code>. If either argument
has length greater than one, it must have names which identify its
elements to the levels of the grouping factor defined in
<code>form</code>. If a grouping factor is present in
<code>form</code> and the argument has length one, its value will be
assigned to all grouping levels. Only positive values are allowed
for <code>const</code>. Default is 0.1 for both <code>const</code> and
<code>prop</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula of the form <code>~ v</code>, or
<code>~ v | g</code>, specifying a variance covariate <code>v</code> and,
optionally, a grouping factor <code>g</code> for the coefficients. The
variance covariate must evaluate to a numeric vector and may involve
expressions using <code>"."</code>, representing  a fitted model object
from which fitted values (<code>fitted(.)</code>) and residuals
(<code>resid(.)</code>) can be extracted (this allows the variance
covariate to be updated during the optimization of an object
function). When a grouping factor is present in <code>form</code>,
a different coefficient value is used for each of its
levels. Several grouping variables may be
simultaneously specified, separated by the <code>*</code> operator, as
in <code>~ v | g1 * g2 * g3</code>. In this case, the levels of each
grouping variable are pasted together and the resulting factor is
used to group the observations. Defaults to <code>~ fitted(.)</code>
representing a variance covariate given by the fitted values of a
fitted model object and no grouping factor. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional list with components <code>const</code> and/or
<code>power</code>, consisting of numeric vectors, or lists of numeric
values, specifying the values at which some or all of the
coefficients in the variance function should be fixed. If a grouping
factor is specified in <code>form</code>, the components of <code>fixed</code>
must have names identifying which coefficients are to be
fixed. Coefficients included in <code>fixed</code> are not allowed to vary
during the optimization of an objective function. Defaults to
<code>NULL</code>, corresponding to no fixed coefficients.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>varConstProp</code> object representing a constant plus proportion variance
function structure, also inheriting from class <code>varFunc</code>.
</p>


<h3>Note</h3>

<p>The error model underlying this variance function structure can be understood
to result from two uncorrelated sequences of standardized random variables
(Lavielle(2015), p. 55) and has been proposed for use in analytical chemistry
(Werner et al. (1978), Wilson et al. (2004)) and chemical degradation
kinetics (Ranke and Meinecke (2019)).  Note that the two-component error
model proposed by Rocke and Lorenzato (1995) assumed a log-normal
distribution of residuals at high absolute values, which is not
compatible with the <code><a href="#varFunc">varFunc</a></code> structures in package <span class="pkg">nlme</span>.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates (for <code><a href="#varConstPower">varConstPower</a></code>) and
Johannes Ranke (adaptation to <code>varConstProp()</code>).
</p>


<h3>References</h3>

<p>Lavielle, M. (2015)
<em>Mixed Effects Models for the Population Approach: Models, Tasks,
Methods and Tools</em>, Chapman and Hall/CRC.
<a href="https://doi.org/10.1201/b17203" target="_blank">doi:10.1201/b17203</a>
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000)
<em>Mixed-Effects Models in S and S-PLUS</em>, Springer.
<a href="https://doi.org/10.1007/b98882" target="_blank">doi:10.1007/b98882</a>
</p>
<p>Ranke, J., and Meinecke, S. (2019)
Error Models for the Kinetic Evaluation of Chemical Degradation Data.
<em>Environments</em> <b>6</b>(12), 124
<a href="https://doi.org/10.3390/environments6120124" target="_blank">doi:10.3390/environments6120124</a>
</p>
<p>Rocke, David M. and Lorenzato, Stefan (1995)
A Two-Component Model for Measurement Error in Analytical Chemistry.
<em>Technometrics</em> <b>37</b>(2), 176–184.
<a href="https://doi.org/10.1080/00401706.1995.10484302" target="_blank">doi:10.1080/00401706.1995.10484302</a>
</p>
<p>Werner, Mario, Brooks, Samuel H., and Knott, Lancaster B. (1978)
Additive, Multiplicative, and Mixed Analytical Errors.
<em>Clinical Chemistry</em> <b>24</b>(11), 1895–1898.
<a href="https://doi.org/10.1093/clinchem/24.11.1895" target="_blank">doi:10.1093/clinchem/24.11.1895</a>
</p>
<p>Wilson, M.D., Rocke, D.M., Durbin, B. and Kahn, H.D (2004)
Detection Limits and Goodness-of-Fit Measures for the Two-Component Model
of Chemical Analytical Error.
<em>Analytica Chimica Acta</em> 2004, 509, 197–208
<a href="https://doi.org/10.1016/j.aca.2003.12.047" target="_blank">doi:10.1016/j.aca.2003.12.047</a>
</p>


<h3>See Also</h3>

<p><code><a href="#varClasses">varClasses</a></code>,
<code><a href="#varWeights">varWeights.varFunc</a></code>,
<code><a href="#coef.varFunc">coef.varFunc</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Generate some synthetic data using the two-component error model and use</span><span class="token comment"># different variance functions, also with fixed sigma in order to avoid</span><span class="token comment"># overparameterisation in the case of a constant term in the variance function</span>
times <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>
pred <span class="token operator">&lt;-</span> <span class="token number">100</span> <span class="token operator">*</span> exp<span class="token punctuation">(</span><span class="token operator">-</span> <span class="token number">0.03</span> <span class="token operator">*</span> times<span class="token punctuation">)</span>
sd_pred <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">0.07</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> pred<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
n_replicates <span class="token operator">&lt;-</span> <span class="token number">2</span>

set.seed<span class="token punctuation">(</span><span class="token number">123456</span><span class="token punctuation">)</span>
syn_data <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>
  time <span class="token operator">=</span> rep<span class="token punctuation">(</span>times<span class="token punctuation">,</span> each <span class="token operator">=</span> n_replicates<span class="token punctuation">)</span><span class="token punctuation">,</span>
  value <span class="token operator">=</span> rnorm<span class="token punctuation">(</span>length<span class="token punctuation">(</span>times<span class="token punctuation">)</span> <span class="token operator">*</span> n_replicates<span class="token punctuation">,</span>
    rep<span class="token punctuation">(</span>pred<span class="token punctuation">,</span> each <span class="token operator">=</span> n_replicates<span class="token punctuation">)</span><span class="token punctuation">,</span>
    rep<span class="token punctuation">(</span>sd_pred<span class="token punctuation">,</span> each <span class="token operator">=</span> n_replicates<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
syn_data<span class="token operator">$</span>value <span class="token operator">&lt;-</span> ifelse<span class="token punctuation">(</span>syn_data<span class="token operator">$</span>value <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> syn_data<span class="token operator">$</span>value<span class="token punctuation">)</span>

f_const <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>value <span class="token operator">~</span> SSasymp<span class="token punctuation">(</span>time<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> parent_0<span class="token punctuation">,</span> lrc<span class="token punctuation">)</span><span class="token punctuation">,</span>
  data <span class="token operator">=</span> syn_data<span class="token punctuation">,</span> na.action <span class="token operator">=</span> na.omit<span class="token punctuation">,</span>
  start <span class="token operator">=</span> list<span class="token punctuation">(</span>parent_0 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> lrc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f_varPower <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>value <span class="token operator">~</span> SSasymp<span class="token punctuation">(</span>time<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> parent_0<span class="token punctuation">,</span> lrc<span class="token punctuation">)</span><span class="token punctuation">,</span>
  data <span class="token operator">=</span> syn_data<span class="token punctuation">,</span> na.action <span class="token operator">=</span> na.omit<span class="token punctuation">,</span>
  start <span class="token operator">=</span> list<span class="token punctuation">(</span>parent_0 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> lrc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  weights <span class="token operator">=</span> varPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f_varConstPower <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>value <span class="token operator">~</span> SSasymp<span class="token punctuation">(</span>time<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> parent_0<span class="token punctuation">,</span> lrc<span class="token punctuation">)</span><span class="token punctuation">,</span>
  data <span class="token operator">=</span> syn_data<span class="token punctuation">,</span> na.action <span class="token operator">=</span> na.omit<span class="token punctuation">,</span>
  start <span class="token operator">=</span> list<span class="token punctuation">(</span>parent_0 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> lrc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  weights <span class="token operator">=</span> varConstPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f_varConstPower_sf <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>value <span class="token operator">~</span> SSasymp<span class="token punctuation">(</span>time<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> parent_0<span class="token punctuation">,</span> lrc<span class="token punctuation">)</span><span class="token punctuation">,</span>
  data <span class="token operator">=</span> syn_data<span class="token punctuation">,</span> na.action <span class="token operator">=</span> na.omit<span class="token punctuation">,</span>
  control <span class="token operator">=</span> list<span class="token punctuation">(</span>sigma <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  start <span class="token operator">=</span> list<span class="token punctuation">(</span>parent_0 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> lrc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  weights <span class="token operator">=</span> varConstPower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f_varConstProp <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>value <span class="token operator">~</span> SSasymp<span class="token punctuation">(</span>time<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> parent_0<span class="token punctuation">,</span> lrc<span class="token punctuation">)</span><span class="token punctuation">,</span>
  data <span class="token operator">=</span> syn_data<span class="token punctuation">,</span> na.action <span class="token operator">=</span> na.omit<span class="token punctuation">,</span>
  start <span class="token operator">=</span> list<span class="token punctuation">(</span>parent_0 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> lrc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  weights <span class="token operator">=</span> varConstProp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f_varConstProp_sf <span class="token operator">&lt;-</span> gnls<span class="token punctuation">(</span>value <span class="token operator">~</span> SSasymp<span class="token punctuation">(</span>time<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> parent_0<span class="token punctuation">,</span> lrc<span class="token punctuation">)</span><span class="token punctuation">,</span>
  data <span class="token operator">=</span> syn_data<span class="token punctuation">,</span> na.action <span class="token operator">=</span> na.omit<span class="token punctuation">,</span>
  start <span class="token operator">=</span> list<span class="token punctuation">(</span>parent_0 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> lrc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  control <span class="token operator">=</span> list<span class="token punctuation">(</span>sigma <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  weights <span class="token operator">=</span> varConstProp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

AIC<span class="token punctuation">(</span>f_const<span class="token punctuation">,</span> f_varPower<span class="token punctuation">,</span> f_varConstPower<span class="token punctuation">,</span> f_varConstPower_sf<span class="token punctuation">,</span>
  f_varConstProp<span class="token punctuation">,</span> f_varConstProp_sf<span class="token punctuation">)</span>

<span class="token comment"># The error model parameters 3 and 0.07 are approximately recovered</span>
intervals<span class="token punctuation">(</span>f_varConstProp_sf<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="VarCorr">

<a href="#VarCorr" class="help-page-title"><h2>Extract variance and correlation components</h2></a>

<h3>Description</h3>

<p>This function calculates the estimated variances, standard
deviations, and correlations between the random-effects terms in a
linear mixed-effects model, of class <code>"<a href="#lme">lme</a>"</code>, or a nonlinear
mixed-effects model, of class <code>"<a href="#nlme">nlme</a>"</code>.  The within-group error
variance and standard deviation are also calculated.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">VarCorr<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sigma <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'lme'</span>
VarCorr<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sigma <span class="token operator">=</span> x<span class="token operator">$</span>sigma<span class="token punctuation">,</span> rdig <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'pdMat'</span>
VarCorr<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sigma <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> rdig <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'pdBlocked'</span>
VarCorr<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sigma <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> rdig <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a fitted model object, usually an object inheriting from
class <code>"<a href="#lme">lme</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>an optional numeric value used as a multiplier for the
standard deviations.  The default is <code>x$sigma</code> or <code>1</code>
depending on <code><a href="https://r-universe.dev/manuals/base.html#class">class</a>(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdig</code></td>
<td>
<p>an optional integer value specifying the number of digits
used to represent correlation estimates.  Default is <code>3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further optional arguments passed to other methods (none
for the methods documented here).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a matrix with the estimated variances, standard deviations, and
correlations for the random effects.  The first two columns, named
<code>Variance</code> and <code>StdDev</code>, give, respectively, the variance
and the standard deviations.  If there are correlation components in
the random effects model, the third column, named <code>Corr</code>,
and the remaining unnamed columns give the estimated correlations
among random effects within the same level of grouping.  The
within-group error variance and standard deviation are included as
the last row in the matrix.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000)
<em>Mixed-Effects Models in S and S-PLUS</em>, Springer, esp. pp. 100, 461.
</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>, <code><a href="#nlme">nlme</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>distance <span class="token operator">~</span> age<span class="token punctuation">,</span> data <span class="token operator">=</span> Orthodont<span class="token punctuation">,</span> random <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token punctuation">)</span>
VarCorr<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="varExp">

<a href="#varExp" class="help-page-title"><h2>Exponential Variance Function</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>varExp</code> class,
representing an exponential variance function structure. Letting
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code> denote the variance covariate and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></code>
denote the variance function evaluated at <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code>, the exponential
variance function is defined as <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>θ</mi><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2(v) = \exp(2\theta
    v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></code>, where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></code> is the variance
function coefficient. When a grouping factor is present, a different
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></code> is used for each factor level.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">varExp<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional numeric vector, or list of numeric values,
with the variance function coefficients. <code>Value</code> must have
length one, unless a grouping factor is specified in <code>form</code>.
If <code>value</code> has length greater than one, it must have names
which identify its elements to the levels of the grouping factor
defined in <code>form</code>. If a grouping factor is present in
<code>form</code> and <code>value</code> has length one, its value will be
assigned to all grouping levels. Default is <code>numeric(0)</code>, which
results in a vector of zeros of appropriate length being assigned to
the coefficients when <code>object</code> is initialized (corresponding
to constant variance equal to one).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula of the form <code>~ v</code>, or
<code>~ v | g</code>, specifying a variance covariate <code>v</code> and,
optionally, a grouping factor <code>g</code> for the coefficients. The
variance covariate must evaluate to a numeric vector and may involve
expressions using <code>"."</code>, representing  a fitted model object
from which fitted values (<code>fitted(.)</code>) and residuals
(<code>resid(.)</code>) can be extracted (this allows the variance
covariate to be updated during the optimization of an object
function). When a grouping factor is present in <code>form</code>,
a different coefficient value is used for each of its
levels. Several grouping variables may be
simultaneously specified, separated by the <code>*</code> operator, like
in <code>~ v | g1 * g2 * g3</code>. In this case, the levels of each
grouping variable are pasted together and the resulting factor is
used to group the observations. Defaults to <code>~ fitted(.)</code>
representing a variance covariate given by the fitted values of a
fitted model object and no grouping factor. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional numeric vector, or list of numeric values,
specifying the values at which some or all of the  coefficients in
the variance function should be fixed. If a grouping factor is
specified in <code>form</code>, <code>fixed</code> must have names identifying
which coefficients are to be fixed. Coefficients included in
<code>fixed</code> are not allowed to vary during the optimization of an
objective function. Defaults to <code>NULL</code>, corresponding to no
fixed coefficients.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>varExp</code> object representing an exponential variance function
structure, also inheriting from class <code>varFunc</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#varClasses">varClasses</a></code>,
<code><a href="#varWeights">varWeights.varFunc</a></code>,
<code><a href="#coef.varFunc">coef.varExp</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varExp<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token operator">|</span>Sex<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="varFixed">

<a href="#varFixed" class="help-page-title"><h2>Fixed Variance Function</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>varFixed</code> class,
representing a variance function with fixed variances. Letting <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code>
denote the variance covariate defined in <code>value</code>, the variance
function <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></code> for this class is
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mi>v</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\sigma^2(v)=|v|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">∣</span></span></span></span></code>. The variance covariate <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code> is
evaluated once at initialization and remains fixed thereafter. No
coefficients are required to represent this variance function.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">varFixed<span class="token punctuation">(</span>value<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a one-sided formula of the form <code>~ v</code> specifying a
variance covariate <code>v</code>. Grouping factors are ignored.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a <code>varFixed</code> object representing a fixed variance function
structure, also inheriting from class <code>varFunc</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#varClasses">varClasses</a></code>,
<code><a href="#varWeights">varWeights.varFunc</a></code>,
<code><a href="#varFunc">varFunc</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varFixed<span class="token punctuation">(</span><span class="token operator">~</span>age<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="varFunc">

<a href="#varFunc" class="help-page-title"><h2>Variance Function Structure</h2></a>

<h3>Description</h3>

<p>If <code>object</code> is a one-sided formula, it is used as the argument to
<code>varFixed</code> and the resulting object is returned. Else, if
<code>object</code> inherits from class <code>varFunc</code>, it is returned
unchanged. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">varFunc<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>either an one-sided formula specifying a variance
covariate, or an object inheriting from class <code>varFunc</code>,
representing a variance function structure.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>an object from class <code>varFunc</code>, representing a variance function
structure. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>See Also</h3>

<p><code><a href="#summary.varFunc">summary.varFunc</a></code>,
<code><a href="#varFixed">varFixed</a></code>,
<code><a href="#varWeights">varWeights.varFunc</a></code>,
<code><a href="#coef.varFunc">coef.varFunc</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varFunc<span class="token punctuation">(</span><span class="token operator">~</span>age<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="varIdent">

<a href="#varIdent" class="help-page-title"><h2>Constant Variance Function</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>varIdent</code> class,
representing a constant variance function structure. If no grouping
factor is present in <code>form</code>, the variance function is constant
and equal to one, and no coefficients required to represent it. When
<code>form</code> includes a grouping factor with <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">M &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> levels, the
variance function allows M different variances, one  for each level of
the factor. For identifiability reasons, the coefficients of the
variance function represent the ratios between the variances and a
reference variance (corresponding to a reference group
level). Therefore, only <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">M-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> coefficients are needed to represent
the variance function. By default, if the elements in <code>value</code> are
unnamed, the first group level is taken as the reference level.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">varIdent<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional numeric vector, or list of numeric values,
with the variance function coefficients. If no grouping factor is
present in <code>form</code>, this argument is ignored, as the resulting
variance function contains no coefficients. If <code>value</code> has
length one, its value is repeated for all coefficients in the
variance function. If <code>value</code> has length greater than one, it
must have length equal to the number of grouping levels minus one
and names which identify its elements to the levels of the grouping
factor. Only positive values are allowed for this argument. Default
is <code>numeric(0)</code>, which results in a vector of zeros of
appropriate length being assigned to the coefficients when
<code>object</code> is initialized (corresponding to constant variance 
equal to one).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula of the form <code>~ v</code>, or
<code>~ v | g</code>, specifying a variance covariate <code>v</code> and,
optionally, a grouping factor <code>g</code> for the coefficients. The
variance covariate is ignored in this variance function. When a
grouping factor is present in <code>form</code>, a different coefficient
value is used for each of its levels less one reference level (see
description section below). Several grouping variables may be
simultaneously specified, separated by the <code>*</code> operator, like
in <code>~ v | g1 * g2 * g3</code>. In this case, the levels of each
grouping variable are pasted together and the resulting factor is
used to group the observations. Defaults to <code>~ 1</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional numeric vector, or list of numeric values,
specifying the values at which some or all of the  coefficients in
the variance function should be fixed. It must have names
identifying which coefficients are to be fixed. Coefficients
included in <code>fixed</code> are not allowed to vary during the
optimization of an objective function. Defaults to <code>NULL</code>,
corresponding to no fixed coefficients.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>varIdent</code> object representing a constant variance function
structure, also inheriting from class <code>varFunc</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#varClasses">varClasses</a></code>,
<code><a href="#varWeights">varWeights.varFunc</a></code>,
<code><a href="#coef.varFunc">coef.varIdent</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varIdent<span class="token punctuation">(</span>c<span class="token punctuation">(</span>Female <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> <span class="token number">1</span> <span class="token operator">|</span> Sex<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram">

<a href="#Variogram" class="help-page-title"><h2>Calculate Semi-variogram</h2></a>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle
specific classes of objects. Classes which already have methods for
this function include <code>default</code>, <code>gls</code> and <code>lme</code>. See
the appropriate method documentation for a description of the
arguments. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a numeric vector with the values to be used for
calculating the semi-variogram, usually a residual vector from a
fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>a numeric vector with the pairwise distances
corresponding to the elements of <code>object</code>. The order of the
elements in <code>distance</code> must correspond to the pairs
<code>(1,2), (1,3), ..., (n-1,n)</code>, with <code>n</code> representing the
length of <code>object</code>, and must have length <code>n(n-1)/2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic function require additional
arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>will depend on the method function used; see the appropriate documentation.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp;
Sons.
</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#Variogram.corExp">Variogram.corExp</a></code>,
<code><a href="#Variogram.corGaus">Variogram.corGaus</a></code>,
<code><a href="#Variogram.corLin">Variogram.corLin</a></code>,
<code><a href="#Variogram.corRatio">Variogram.corRatio</a></code>,
<code><a href="#Variogram.corSpatial">Variogram.corSpatial</a></code>,
<code><a href="#Variogram.corSpher">Variogram.corSpher</a></code>,
<code><a href="#Variogram.default">Variogram.default</a></code>,
<code><a href="#Variogram.gls">Variogram.gls</a></code>,
<code><a href="#Variogram.lme">Variogram.lme</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see the method function documentation</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram.corExp">

<a href="#Variogram.corExp" class="help-page-title"><h2>Calculate Semi-variogram for a corExp Object</h2></a>

<h3>Description</h3>

<p>This method function calculates the semi-variogram values
corresponding to the Exponential correlation model, using the estimated
coefficients corresponding to <code>object</code>, at the distances defined
by <code>distance</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corExp'</span>
Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> sig2<span class="token punctuation">,</span> length.out<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corExp">corExp</a>"</code>,
representing an exponential spatial correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an optional numeric vector with the distances at
which the semi-variogram is to be calculated. Defaults to
<code>NULL</code>, in which case a sequence of length <code>length.out</code>
between the minimum and maximum values of
<code>getCovariate(object)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>an optional numeric value representing the process
variance. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer specifying the length of the
sequence of distances to be used for calculating the semi-variogram,
when <code>distance = NULL</code>. Defaults to <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>variog</code> and <code>dist</code> representing,
respectively, the semi-variogram values and the corresponding
distances. The returned value inherits from class <code>Variogram</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#corExp">corExp</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code>,
<code><a href="#Variogram">Variogram</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">stopifnot<span class="token punctuation">(</span>require<span class="token punctuation">(</span><span class="token string">"stats"</span><span class="token punctuation">,</span> quietly <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> corExp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Rat<span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">)</span>
Variogram<span class="token punctuation">(</span>cs1<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram.corGaus">

<a href="#Variogram.corGaus" class="help-page-title"><h2>Calculate Semi-variogram for a corGaus Object</h2></a>

<h3>Description</h3>

<p>This method function calculates the semi-variogram values
corresponding to the Gaussian correlation model, using the estimated
coefficients corresponding to <code>object</code>, at the distances defined
by <code>distance</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corGaus'</span>
Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> sig2<span class="token punctuation">,</span> length.out<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corGaus">corGaus</a>"</code>,
representing an Gaussian spatial correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an optional numeric vector with the distances at
which the semi-variogram is to be calculated. Defaults to
<code>NULL</code>, in which case a sequence of length <code>length.out</code>
between the minimum and maximum values of
<code>getCovariate(object)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>an optional numeric value representing the process
variance. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer specifying the length of the
sequence of distances to be used for calculating the semi-variogram,
when <code>distance = NULL</code>. Defaults to <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>variog</code> and <code>dist</code> representing,
respectively, the semi-variogram values and the corresponding
distances. The returned value inherits from class <code>Variogram</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#corGaus">corGaus</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code>,
<code><a href="#Variogram">Variogram</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corGaus<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Rat<span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">)</span>
Variogram<span class="token punctuation">(</span>cs1<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram.corLin">

<a href="#Variogram.corLin" class="help-page-title"><h2>Calculate Semi-variogram for a corLin Object</h2></a>

<h3>Description</h3>

<p>This method function calculates the semi-variogram values
corresponding to the Linear correlation model, using the estimated
coefficients corresponding to <code>object</code>, at the distances defined
by <code>distance</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corLin'</span>
Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> sig2<span class="token punctuation">,</span> length.out<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corLin">corLin</a>"</code>,
representing an Linear spatial correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an optional numeric vector with the distances at
which the semi-variogram is to be calculated. Defaults to
<code>NULL</code>, in which case a sequence of length <code>length.out</code>
between the minimum and maximum values of
<code>getCovariate(object)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>an optional numeric value representing the process
variance. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer specifying the length of the
sequence of distances to be used for calculating the semi-variogram,
when <code>distance = NULL</code>. Defaults to <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>variog</code> and <code>dist</code> representing,
respectively, the semi-variogram values and the corresponding
distances. The returned value inherits from class <code>Variogram</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#corLin">corLin</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code>,
<code><a href="#Variogram">Variogram</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corLin<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Rat<span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">)</span>
Variogram<span class="token punctuation">(</span>cs1<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram.corRatio">

<a href="#Variogram.corRatio" class="help-page-title"><h2>Calculate Semi-variogram for a corRatio Object</h2></a>

<h3>Description</h3>

<p>This method function calculates the semi-variogram values
corresponding to the Rational Quadratic correlation model, using the
estimated coefficients corresponding to <code>object</code>, at the
distances defined by <code>distance</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corRatio'</span>
Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> sig2<span class="token punctuation">,</span> length.out<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corRatio">corRatio</a>"</code>,
representing an Rational Quadratic spatial correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an optional numeric vector with the distances at
which the semi-variogram is to be calculated. Defaults to
<code>NULL</code>, in which case a sequence of length <code>length.out</code>
between the minimum and maximum values of
<code>getCovariate(object)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>an optional numeric value representing the process
variance. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer specifying the length of the
sequence of distances to be used for calculating the semi-variogram,
when <code>distance = NULL</code>. Defaults to <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>variog</code> and <code>dist</code> representing,
respectively, the semi-variogram values and the corresponding
distances. The returned value inherits from class <code>Variogram</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#corRatio">corRatio</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code>
<code><a href="#Variogram">Variogram</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corRatio<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Rat<span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">)</span>
Variogram<span class="token punctuation">(</span>cs1<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram.corSpatial">

<a href="#Variogram.corSpatial" class="help-page-title"><h2>Calculate Semi-variogram for a corSpatial Object</h2></a>

<h3>Description</h3>

<p>This method function calculates the semi-variogram values
corresponding to the model defined in <code>FUN</code>, using the estimated
coefficients corresponding to <code>object</code>, at the distances defined
by <code>distance</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corSpatial'</span>
Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> sig2<span class="token punctuation">,</span> length.out<span class="token punctuation">,</span> FUN<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corSpatial">corSpatial</a>"</code>,
representing spatial correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an optional numeric vector with the distances at
which the semi-variogram is to be calculated. Defaults to
<code>NULL</code>, in which case a sequence of length <code>length.out</code>
between the minimum and maximum values of
<code>getCovariate(object)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>an optional numeric value representing the process
variance. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer specifying the length of the
sequence of distances to be used for calculating the semi-variogram,
when <code>distance = NULL</code>. Defaults to <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>a function of two arguments, the distance and the range
corresponding to <code>object</code>, specifying the semi-variogram
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>variog</code> and <code>dist</code> representing,
respectively, the semi-variogram values and the corresponding
distances. The returned value inherits from class <code>Variogram</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#corSpatial">corSpatial</a></code>,
<code><a href="#Variogram">Variogram</a></code>,
<code><a href="#Variogram.default">Variogram.default</a></code>,
<code><a href="#Variogram.corExp">Variogram.corExp</a></code>,
<code><a href="#Variogram.corGaus">Variogram.corGaus</a></code>,
<code><a href="#Variogram.corLin">Variogram.corLin</a></code>,
<code><a href="#Variogram.corRatio">Variogram.corRatio</a></code>,
<code><a href="#Variogram.corSpher">Variogram.corSpher</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corExp<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Rat<span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">)</span>
Variogram<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> FUN <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token operator">/</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram.corSpher">

<a href="#Variogram.corSpher" class="help-page-title"><h2>Calculate Semi-variogram for a corSpher Object</h2></a>

<h3>Description</h3>

<p>This method function calculates the semi-variogram values
corresponding to the Spherical correlation model, using the estimated
coefficients corresponding to <code>object</code>, at the distances defined
by <code>distance</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'corSpher'</span>
Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> sig2<span class="token punctuation">,</span> length.out<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#corSpher">corSpher</a>"</code>,
representing an Spherical spatial correlation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an optional numeric vector with the distances at
which the semi-variogram is to be calculated. Defaults to
<code>NULL</code>, in which case a sequence of length <code>length.out</code>
between the minimum and maximum values of
<code>getCovariate(object)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>an optional numeric value representing the process
variance. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer specifying the length of the
sequence of distances to be used for calculating the semi-variogram,
when <code>distance = NULL</code>. Defaults to <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>variog</code> and <code>dist</code> representing,
respectively, the semi-variogram values and the corresponding
distances. The returned value inherits from class <code>Variogram</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#corSpher">corSpher</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code>,
<code><a href="#Variogram">Variogram</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">cs1 <span class="token operator">&lt;-</span> corSpher<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Rat<span class="token punctuation">)</span>
cs1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">)</span>
Variogram<span class="token punctuation">(</span>cs1<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram.default">

<a href="#Variogram.default" class="help-page-title"><h2>Calculate Semi-variogram</h2></a>

<h3>Description</h3>

<p>This method function calculates the semi-variogram for an arbitrary
vector <code>object</code>, according to the distances in <code>distance</code>.
For each pair of elements <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></code> in <code>object</code>, the
corresponding semi-variogram is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">(x-y)^2/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/2</span></span></span></span></code>. The semi-variogram is
useful for identifying and modeling spatial correlation structures in
observations with constant expectation and constant variance.   
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Default S3 method:</span>
Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a numeric vector with the values to be used for
calculating the semi-variogram, usually a residual vector from a
fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>a numeric vector with the pairwise distances
corresponding to the elements of <code>object</code>. The order of the
elements in <code>distance</code> must correspond to the pairs
<code>(1,2), (1,3), ..., (n-1,n)</code>, with <code>n</code> representing the
length of <code>object</code>, and must have length <code>n(n-1)/2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>variog</code> and <code>dist</code> representing,
respectively, the semi-variogram values and the corresponding
distances. The returned value inherits from class <code>Variogram</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#Variogram">Variogram</a></code>,
<code><a href="#Variogram.gls">Variogram.gls</a></code>,
<code><a href="#Variogram.lme">Variogram.lme</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lm<span class="token punctuation">(</span>follicles <span class="token operator">~</span> sin<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> Time<span class="token punctuation">)</span> <span class="token operator">+</span> cos<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> Time<span class="token punctuation">)</span><span class="token punctuation">,</span> Ovary<span class="token punctuation">,</span>
          subset <span class="token operator">=</span> Mare <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
Variogram<span class="token punctuation">(</span>resid<span class="token punctuation">(</span>fm1<span class="token punctuation">)</span><span class="token punctuation">,</span> dist<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram.gls">

<a href="#Variogram.gls" class="help-page-title"><h2>Calculate Semi-variogram for Residuals from a gls Object</h2></a>

<h3>Description</h3>

<p>This method function calculates the semi-variogram for the residuals
from a <code>gls</code> fit. The semi-variogram values are calculated for
pairs of residuals within the same group level, if a grouping factor
is present. If <code>collapse</code> is different from <code>"none"</code>, the
individual semi-variogram values are collapsed using either a robust
estimator (<code>robust = TRUE</code>) defined in Cressie (1993), or the
average of the values within the same distance interval. The
semi-variogram is useful for modeling the error term correlation
structure.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'gls'</span>
Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> form<span class="token punctuation">,</span> resType<span class="token punctuation">,</span> data<span class="token punctuation">,</span>
      na.action<span class="token punctuation">,</span> maxDist<span class="token punctuation">,</span> length.out<span class="token punctuation">,</span> collapse<span class="token punctuation">,</span> nint<span class="token punctuation">,</span> breaks<span class="token punctuation">,</span>
      robust<span class="token punctuation">,</span> metric<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#gls">gls</a>"</code>, representing
a generalized least squares fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an optional numeric vector with the distances between
residual pairs. If a grouping variable is present, only the
distances between residual pairs within the same group should be
given. If missing, the distances are calculated based on the
values of the arguments <code>form</code>, <code>data</code>, and
<code>metric</code>, unless <code>object</code> includes a <code>corSpatial</code>
element, in which case the associated covariate (obtained with the
<code>getCovariate</code> method) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula specifying the covariate(s)
to be used for calculating the distances between residual pairs and,
optionally, a grouping factor for partitioning the residuals (which
must appear to the right of a <code>|</code> operator in
<code>form</code>). Default is <code>~1</code>, implying that the observation 
order within the groups is used to obtain the distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resType</code></td>
<td>
<p>an optional character string specifying the type of
residuals to be used. If <code>"response"</code>, the "raw" residuals
(observed - fitted) are used; else, if <code>"pearson"</code>, the
standardized residuals (raw residuals divided by the corresponding
standard errors) are used; else, if <code>"normalized"</code>, the
normalized residuals (standardized residuals pre-multiplied by the
inverse square-root factor of the estimated error correlation
matrix) are used. Partial matching of arguments is used, so only the
first character needs to be provided. Defaults to <code>"pearson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to interpret the variables
in <code>form</code>. By default, the same data used to fit <code>object</code>
is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s. The default action (<code>na.fail</code>) causes
an error message to be printed and the function to terminate, if there
are any incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxDist</code></td>
<td>
<p>an optional numeric value for the maximum distance used
for calculating the semi-variogram between two residuals. By default
all residual pairs are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer value. When <code>object</code>
includes a <code>corSpatial</code> element, its semi-variogram values are
calculated and this argument is used as the <code>length.out</code>
argument to the corresponding <code>Variogram</code> method. Defaults to
<code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>an optional character string specifying the type of
collapsing to be applied to the individual semi-variogram values. If
equal to <code>"quantiles"</code>, the semi-variogram values are split
according to quantiles of the distance distribution, with equal
number of observations per group, with possibly varying distance
interval lengths. Else, if <code>"fixed"</code>, the semi-variogram values
are divided according to distance intervals of equal lengths, with
possibly different number of observations per interval. Else, if
<code>"none"</code>, no collapsing is used and the individual
semi-variogram values are returned. Defaults to <code>"quantiles"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>
<p>an optional integer with the number of intervals to be
used when collapsing the semi-variogram values. Defaults to <code>20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>an optional logical value specifying if a robust
semi-variogram estimator should be used when collapsing the
individual values. If <code>TRUE</code> the robust estimator is
used. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>an optional numeric vector with the breakpoints for the
distance intervals to be used in collapsing the semi-variogram
values. If not missing, the option specified in <code>collapse</code> is
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>an optional character string specifying the distance
metric to be used. The currently available options are
<code>"euclidean"</code> for the root sum-of-squares of distances;
<code>"maximum"</code> for the maximum difference; and <code>"manhattan"</code>
for the sum of the absolute differences. Partial matching of
arguments is used, so only the first three characters need to be
provided. Defaults to <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>variog</code> and <code>dist</code> representing,
respectively, the semi-variogram values and the corresponding
distances. If the semi-variogram values are collapsed, an extra
column, <code>n.pairs</code>, with the number of residual pairs used in each
semi-variogram calculation, is included in the returned data frame. If
<code>object</code> includes a <code>corSpatial</code> element, a data frame with
its corresponding semi-variogram is included in the returned value, as
an attribute <code>"modelVariog"</code>. The returned value inherits from
class <code>Variogram</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#gls">gls</a></code>,
<code><a href="#Variogram">Variogram</a></code>,
<code><a href="#Variogram.default">Variogram.default</a></code>,
<code><a href="#Variogram.lme">Variogram.lme</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> gls<span class="token punctuation">(</span>weight <span class="token operator">~</span> Time <span class="token operator">*</span> Diet<span class="token punctuation">,</span> BodyWeight<span class="token punctuation">)</span>
Vm1 <span class="token operator">&lt;-</span> Variogram<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Rat<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>head<span class="token punctuation">(</span>Vm1<span class="token punctuation">)</span><span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="Variogram.lme">

<a href="#Variogram.lme" class="help-page-title"><h2>Calculate Semi-variogram for Residuals from an lme Object</h2></a>

<h3>Description</h3>

<p>This method function calculates the semi-variogram for the
within-group residuals from an <code>lme</code> fit. The semi-variogram
values are calculated for pairs of residuals within the same group. If
<code>collapse</code> is different from <code>"none"</code>, the individual
semi-variogram values are collapsed using either a robust estimator
(<code>robust = TRUE</code>) defined in Cressie (1993), or the average of
the values within the same distance interval. The semi-variogram is
useful for modeling the error term correlation structure.  
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lme'</span>
Variogram<span class="token punctuation">(</span>object<span class="token punctuation">,</span> distance<span class="token punctuation">,</span> form<span class="token punctuation">,</span> resType<span class="token punctuation">,</span> data<span class="token punctuation">,</span>
       na.action<span class="token punctuation">,</span> maxDist<span class="token punctuation">,</span> length.out<span class="token punctuation">,</span> collapse<span class="token punctuation">,</span> nint<span class="token punctuation">,</span> breaks<span class="token punctuation">,</span>
       robust<span class="token punctuation">,</span> metric<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lme">lme</a>"</code>, representing
a fitted linear mixed-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an optional numeric vector with the distances between
residual pairs. If a grouping variable is present, only the
distances between residual pairs within the same group should be
given. If missing, the distances are calculated based on the
values of the arguments <code>form</code>, <code>data</code>, and
<code>metric</code>, unless <code>object</code> includes a <code>corSpatial</code>
element, in which case the associated covariate (obtained with the
<code>getCovariate</code> method) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula specifying the covariate(s)
to be used for calculating the distances between residual pairs and,
optionally, a grouping factor for partitioning the residuals (which
must appear to the right of a <code>|</code> operator in
<code>form</code>). Default is <code>~1</code>, implying that the observation 
order within the groups is used to obtain the distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resType</code></td>
<td>
<p>an optional character string specifying the type of
residuals to be used. If <code>"response"</code>, the "raw" residuals
(observed - fitted) are used; else, if <code>"pearson"</code>, the
standardized residuals (raw residuals divided by the corresponding
standard errors) are used; else, if <code>"normalized"</code>, the
normalized residuals (standardized residuals pre-multiplied by the
inverse square-root factor of the estimated error correlation
matrix) are used. Partial matching of arguments is used, so only the
first character needs to be provided. Defaults to <code>"pearson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to interpret the variables
in <code>form</code>. By default, the same data used to fit <code>object</code>
is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the
data contain <code>NA</code>s. The default action (<code>na.fail</code>) causes
an error message to be printed and the function to terminate, if there
are any incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxDist</code></td>
<td>
<p>an optional numeric value for the maximum distance used
for calculating the semi-variogram between two residuals. By default
all residual pairs are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.out</code></td>
<td>
<p>an optional integer value. When <code>object</code>
includes a <code>corSpatial</code> element, its semi-variogram values are
calculated and this argument is used as the <code>length.out</code>
argument to the corresponding <code>Variogram</code> method. Defaults to
<code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>an optional character string specifying the type of
collapsing to be applied to the individual semi-variogram values. If
equal to <code>"quantiles"</code>, the semi-variogram values are split
according to quantiles of the distance distribution, with equal
number of observations per group, with possibly varying distance
interval lengths. Else, if <code>"fixed"</code>, the semi-variogram values
are divided according to distance intervals of equal lengths, with
possibly different number of observations per interval. Else, if
<code>"none"</code>, no collapsing is used and the individual
semi-variogram values are returned. Defaults to <code>"quantiles"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>
<p>an optional integer with the number of intervals to be
used when collapsing the semi-variogram values. Defaults to <code>20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>an optional logical value specifying if a robust
semi-variogram estimator should be used when collapsing the
individual values. If <code>TRUE</code> the robust estimator is
used. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>an optional numeric vector with the breakpoints for the
distance intervals to be used in collapsing the semi-variogram
values. If not missing, the option specified in <code>collapse</code> is
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>an optional character string specifying the distance
metric to be used. The currently available options are
<code>"euclidean"</code> for the root sum-of-squares of distances;
<code>"maximum"</code> for the maximum difference; and <code>"manhattan"</code>
for the sum of the absolute differences. Partial matching of
arguments is used, so only the first three characters need to be
provided. Defaults to <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional
arguments.  None are used in this method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with columns <code>variog</code> and <code>dist</code> representing,
respectively, the semi-variogram values and the corresponding
distances. If the semi-variogram values are collapsed, an extra
column, <code>n.pairs</code>, with the number of residual pairs used in each
semi-variogram calculation, is included in the returned data frame. If
<code>object</code> includes a <code>corSpatial</code> element, a data frame with
its corresponding semi-variogram is included in the returned value, as
an attribute <code>"modelVariog"</code>. The returned value inherits from
class <code>Variogram</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1993), "Statistics for Spatial Data", J. Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#lme">lme</a></code>,
<code><a href="#Variogram">Variogram</a></code>,
<code><a href="#Variogram.default">Variogram.default</a></code>,
<code><a href="#Variogram.gls">Variogram.gls</a></code>,
<code><a href="#plot.Variogram">plot.Variogram</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">fm1 <span class="token operator">&lt;-</span> lme<span class="token punctuation">(</span>weight <span class="token operator">~</span> Time <span class="token operator">*</span> Diet<span class="token punctuation">,</span> data<span class="token operator">=</span>BodyWeight<span class="token punctuation">,</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Rat<span class="token punctuation">)</span>
Variogram<span class="token punctuation">(</span>fm1<span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span> Time <span class="token operator">|</span> Rat<span class="token punctuation">,</span> nint <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> robust <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="varPower">

<a href="#varPower" class="help-page-title"><h2>Power Variance Function</h2></a>

<h3>Description</h3>

<p>This function is a constructor for the <code>varPower</code> class,
representing a power variance function structure. Letting
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code> denote the variance covariate and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></code>
denote the variance function evaluated at <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code>, the power
variance function is defined as <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mi>v</mi><msup><mi mathvariant="normal">∣</mi><mrow><mn>2</mn><mi>θ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\sigma^2(v) = |v|^{2\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span></span></span></span></span></span></span></span></code>, where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></code> is the variance 
function coefficient. When a grouping factor is present, a different
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></code> is used for each factor level.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">varPower<span class="token punctuation">(</span>value<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fixed<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an optional numeric vector, or list of numeric values,
with the variance function coefficients. <code>Value</code> must have
length one, unless a grouping factor is specified in <code>form</code>.
If <code>value</code> has length greater than one, it must have names
which identify its elements to the levels of the grouping factor
defined in <code>form</code>. If a grouping factor is present in
<code>form</code> and <code>value</code> has length one, its value will be
assigned to all grouping levels. Default is <code>numeric(0)</code>, which
results in a vector of zeros of appropriate length being assigned to
the coefficients when <code>object</code> is initialized (corresponding
to constant variance equal to one).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>an optional one-sided formula of the form <code>~ v</code>, or
<code>~ v | g</code>, specifying a variance covariate <code>v</code> and,
optionally, a grouping factor <code>g</code> for the coefficients. The
variance covariate must evaluate to a numeric vector and may involve
expressions using <code>"."</code>, representing  a fitted model object
from which fitted values (<code>fitted(.)</code>) and residuals
(<code>resid(.)</code>) can be extracted (this allows the variance
covariate to be updated during the optimization of an object
function). When a grouping factor is present in <code>form</code>,
a different coefficient value is used for each of its
levels. Several grouping variables may be
simultaneously specified, separated by the <code>*</code> operator, like
in <code>~ v | g1 * g2 * g3</code>. In this case, the levels of each
grouping variable are pasted together and the resulting factor is
used to group the observations. Defaults to <code>~ fitted(.)</code>
representing a variance covariate given by the fitted values of a
fitted model object and no grouping factor. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional numeric vector, or list of numeric values,
specifying the values at which some or all of the  coefficients in
the variance function should be fixed. If a grouping factor is
specified in <code>form</code>, <code>fixed</code> must have names identifying
which coefficients are to be fixed. Coefficients included in
<code>fixed</code> are not allowed to vary during the optimization of an
objective function. Defaults to <code>NULL</code>, corresponding to no
fixed coefficients.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>varPower</code> object representing a power variance function
structure, also inheriting from class <code>varFunc</code>. 
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#varWeights">varWeights.varFunc</a></code>,
<code><a href="#coef.varFunc">coef.varPower</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> form <span class="token operator">=</span> <span class="token operator">~</span>age<span class="token operator">|</span>Sex<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="varWeights">

<a href="#varWeights" class="help-page-title"><h2>Extract Variance Function Weights</h2></a>

<h3>Description</h3>

<p>The inverse of the standard deviations corresponding to the variance
function structure represented by <code>object</code> are returned.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">varWeights<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>varFunc</code>,
representing a variance function structure.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>if <code>object</code> has a <code>weights</code> attribute, its value is
returned; else <code>NULL</code> is returned.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#logLik.varFunc">logLik.varFunc</a></code>, 
<code><a href="#varWeights">varWeights</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">vf1 <span class="token operator">&lt;-</span> varPower<span class="token punctuation">(</span>form<span class="token operator">=</span><span class="token operator">~</span>age<span class="token punctuation">)</span>
vf1 <span class="token operator">&lt;-</span> Initialize<span class="token punctuation">(</span>vf1<span class="token punctuation">,</span> Orthodont<span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> <span class="token number">0.3</span>
varWeights<span class="token punctuation">(</span>vf1<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">]</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="varWeights.glsStruct">

<a href="#varWeights.glsStruct" class="help-page-title"><h2>Variance Weights for glsStruct Object</h2></a>

<h3>Description</h3>

<p>If <code>object</code> includes a <code>varStruct</code> component, the inverse of
the standard deviations of the variance function structure represented
by the corresponding <code>varFunc</code> object are returned; else, a
vector of ones of length equal to the number of observations in the
data frame used to fit the associated linear model is returned. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'glsStruct'</span>
varWeights<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#glsStruct">glsStruct</a>"</code>,
representing a list of linear model components, such as
<code>corStruct</code> and <code>"<a href="#varFunc">varFunc</a>"</code> objects.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>if <code>object</code> includes a <code>varStruct</code> component, a vector with
the corresponding variance weights; else, or a vector of ones.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#varWeights">varWeights</a></code></p>

<hr>
</div>
<div class="container manual-page" id="varWeights.lmeStruct">

<a href="#varWeights.lmeStruct" class="help-page-title"><h2>Variance Weights for lmeStruct Object</h2></a>

<h3>Description</h3>

<p>If <code>object</code> includes a <code>varStruct</code> component, the inverse of
the standard deviations of the variance function structure represented
by the corresponding <code>varFunc</code> object are returned; else, a
vector of ones of length equal to the number of observations in the
data frame used to fit the associated linear mixed-effects model is
returned. 
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'lmeStruct'</span>
varWeights<span class="token punctuation">(</span>object<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>"<a href="#lmeStruct">lmeStruct</a>"</code>,
representing a list of linear mixed-effects model components, such as
<code>reStruct</code>, <code>corStruct</code>, and <code>varFunc</code> objects.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>if <code>object</code> includes a <code>varStruct</code> component, a vector with
the corresponding variance weights; else, or a vector of ones.
</p>


<h3>Author(s)</h3>

<p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>


<h3>References</h3>

<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer.  
</p>


<h3>See Also</h3>

<p><code><a href="#varWeights">varWeights</a></code></p>

<hr>
</div>
<div class="container manual-page" id="Wafer">

<a href="#Wafer" class="help-page-title"><h2>Modeling of Analog MOS Circuits</h2></a>

<h3>Description</h3>

<p>The <code>Wafer</code> data frame has 400 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Wafer</dt>
<dd>
<p>a factor with levels
<code>1</code> 
<code>2</code> 
<code>3</code> 
<code>4</code> 
<code>5</code> 
<code>6</code> 
<code>7</code> 
<code>8</code> 
<code>9</code> 
<code>10</code> 
</p>
</dd>
<dt>Site</dt>
<dd>
<p>a factor with levels
<code>1</code> 
<code>2</code> 
<code>3</code> 
<code>4</code> 
<code>5</code> 
<code>6</code> 
<code>7</code> 
<code>8</code> 
</p>
</dd>
<dt>voltage</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>current</dt>
<dd>
<p>a numeric vector
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="Wheat">

<a href="#Wheat" class="help-page-title"><h2>Yields by growing conditions</h2></a>

<h3>Description</h3>

<p>The <code>Wheat</code> data frame has 48 rows and 4 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Tray</dt>
<dd>
<p>an ordered factor with levels
<code>3</code> &lt; <code>1</code> &lt; <code>2</code> &lt; <code>4</code> &lt; <code>5</code> &lt; <code>6</code> &lt; <code>8</code> &lt; <code>9</code> &lt; <code>7</code> &lt; <code>12</code> &lt; <code>11</code> &lt; <code>10</code>
</p>
</dd>
<dt>Moisture</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>fertilizer</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>DryMatter</dt>
<dd>
<p>a numeric vector
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.
</p>

<hr>
</div>
<div class="container manual-page" id="Wheat2">

<a href="#Wheat2" class="help-page-title"><h2>Wheat Yield Trials</h2></a>

<h3>Description</h3>

<p>The <code>Wheat2</code> data frame has 224 rows and 5 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Block</dt>
<dd>
<p>an ordered factor with levels
<code>4</code> &lt; <code>2</code> &lt; <code>3</code> &lt; <code>1</code>
</p>
</dd>
<dt>variety</dt>
<dd>
<p>a factor with levels
<code>ARAPAHOE</code> 
<code>BRULE</code> 
<code>BUCKSKIN</code> 
<code>CENTURA</code> 
<code>CENTURK78</code> 
<code>CHEYENNE</code> 
<code>CODY</code> 
<code>COLT</code> 
<code>GAGE</code> 
<code>HOMESTEAD</code> 
<code>KS831374</code> 
<code>LANCER</code> 
<code>LANCOTA</code> 
<code>NE83404</code> 
<code>NE83406</code> 
<code>NE83407</code> 
<code>NE83432</code> 
<code>NE83498</code> 
<code>NE83T12</code> 
<code>NE84557</code> 
<code>NE85556</code> 
<code>NE85623</code> 
<code>NE86482</code> 
<code>NE86501</code> 
<code>NE86503</code> 
<code>NE86507</code> 
<code>NE86509</code> 
<code>NE86527</code> 
<code>NE86582</code> 
<code>NE86606</code> 
<code>NE86607</code> 
<code>NE86T666</code> 
<code>NE87403</code> 
<code>NE87408</code> 
<code>NE87409</code> 
<code>NE87446</code> 
<code>NE87451</code> 
<code>NE87457</code> 
<code>NE87463</code> 
<code>NE87499</code> 
<code>NE87512</code> 
<code>NE87513</code> 
<code>NE87522</code> 
<code>NE87612</code> 
<code>NE87613</code> 
<code>NE87615</code> 
<code>NE87619</code> 
<code>NE87627</code> 
<code>NORKAN</code> 
<code>REDLAND</code> 
<code>ROUGHRIDER</code> 
<code>SCOUT66</code> 
<code>SIOUXLAND</code> 
<code>TAM107</code> 
<code>TAM200</code> 
<code>VONA</code> 
</p>
</dd>
<dt>yield</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>latitude</dt>
<dd>
<p>a numeric vector
</p>
</dd>
<dt>longitude</dt>
<dd>
<p>a numeric vector
</p>
</dd>
</dl>
<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.
</p>

<hr>
</div>
</body>
</html>
