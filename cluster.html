<!DOCTYPE html>
<html>
  <head>
    <title>Package 'cluster' reference manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <!-- styling for math and syntax -->
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/katex.min.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/R.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/prism.css">

    <!-- for (future) customizations -->
    <script src="https://r-universe.dev/static/manual.js"></script>
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/manual.css?nocache=1">

  </head>

  <body class="macintosh">
    <h1 class="manual-title">Package 'cluster'</h1>
    <table class="description-table">
      <tr>
<th>Title:</th>
<td class="description-title">"Finding Groups in Data": Cluster Analysis Extended Rousseeuw et
al.</td>
</tr>
      <tr>
<th>Description:</th>
<td class="description-description">Methods for Cluster analysis.  Much extended the original from
	Peter Rousseeuw, Anja Struyf and Mia Hubert,
	based on Kaufman and Rousseeuw (1990) "Finding Groups in Data".</td>
</tr>
      <tr>
<th>Authors:</th>
<td class="description-author"><span>Martin Maechler [aut, cre] <a href="https://orcid.org/0000-0002-8685-9910" target="_blank"><img style="height:1em" src="https://cran.r-project.org/web/orcid.svg"></a>,
  Peter Rousseeuw [aut] (Fortran original,
    &lt;https://orcid.org/0000-0002-3807-5353&gt;),
  Anja Struyf [aut] (S original),
  Mia Hubert [aut] (S original, &lt;https://orcid.org/0000-0001-6398-4850&gt;),
  Kurt Hornik [trl, ctb] (port to R; maintenance(1999-2000),
    &lt;https://orcid.org/0000-0003-4198-9911&gt;),
  Matthias Studer [ctb],
  Pierre Roudier [ctb],
  Juan Gonzalez [ctb],
  Kamil Kozlowski [ctb],
  Erich Schubert [ctb] (fastpam options for pam(),
    &lt;https://orcid.org/0000-0001-9143-4880&gt;),
  Keefe Murphy [ctb] (volume.ellipsoid({d &gt;= 3}))</span></td>
</tr>
      <tr>
<th>Maintainer:</th>
<td class="description-maintainer">Martin Maechler &lt;maechler@stat.math.ethz.ch&gt;</td>
</tr>
      <tr>
<th>License:</th>
<td class="description-license">GPL (&gt;= 2)</td>
</tr>
      <tr>
<th>Version:</th>
<td class="description-version">2.1.4</td>
</tr>
      <tr>
<th>Built:</th>
<td class="description-date">2022-10-31 22:33:28 UTC</td>
</tr>
      <tr>
<th>Source:</th>
<td class="description-source">CRAN</td>
</tr>
    </table>

    <a href="#help-index" style="color:black;"><h2 id="help-index">Help Index</h2></a>
    <ul id="help-index-list">
<li class="help-index-item"><a href="#agnes">Agglomerative Nesting (Hierarchical Clustering)</a></li>
<li class="help-index-item"><a href="#agnes.object">Agglomerative Nesting (AGNES) Object</a></li>
<li class="help-index-item"><a href="#agriculture">European Union Agricultural Workforces</a></li>
<li class="help-index-item"><a href="#animals">Attributes of Animals</a></li>
<li class="help-index-item"><a href="#bannerplot">Plot Banner (of Hierarchical Clustering)</a></li>
<li class="help-index-item"><a href="#chorSub">Subset of C-horizon of Kola Data</a></li>
<li class="help-index-item"><a href="#clara">Clustering Large Applications</a></li>
<li class="help-index-item"><a href="#clara.object">Clustering Large Applications (CLARA) Object</a></li>
<li class="help-index-item"><a href="#clusGap">Gap Statistic for Estimating the Number of Clusters</a></li>
<li class="help-index-item"><a href="#clusplot.partition">Bivariate Cluster Plot (of a Partitioning Object)</a></li>
<li class="help-index-item"><a href="#clusplot.default">Bivariate Cluster Plot (clusplot) Default Method</a></li>
<li class="help-index-item"><a href="#cluster-internal">Internal cluster functions</a></li>
<li class="help-index-item"><a href="#coef.hclust">Agglomerative / Divisive Coefficient for 'hclust' Objects</a></li>
<li class="help-index-item"><a href="#daisy">Dissimilarity Matrix Calculation</a></li>
<li class="help-index-item"><a href="#diana">DIvisive ANAlysis Clustering</a></li>
<li class="help-index-item"><a href="#dissimilarity.object">Dissimilarity Matrix Object</a></li>
<li class="help-index-item"><a href="#ellipsoidhull">Compute the Ellipsoid Hull or Spanning Ellipsoid of a Point Set</a></li>
<li class="help-index-item"><a href="#fanny">Fuzzy Analysis Clustering</a></li>
<li class="help-index-item"><a href="#fanny.object">Fuzzy Analysis (FANNY) Object</a></li>
<li class="help-index-item"><a href="#flower">Flower Characteristics</a></li>
<li class="help-index-item"><a href="#lower.to.upper.tri.inds">Permute Indices for Triangular Matrices</a></li>
<li class="help-index-item"><a href="#medoids">Compute pam-consistent Medoids from Clustering</a></li>
<li class="help-index-item"><a href="#mona">MONothetic Analysis Clustering of Binary Variables</a></li>
<li class="help-index-item"><a href="#mona.object">Monothetic Analysis (MONA) Object</a></li>
<li class="help-index-item"><a href="#pam">Partitioning Around Medoids</a></li>
<li class="help-index-item"><a href="#pam.object">Partitioning Around Medoids (PAM) Object</a></li>
<li class="help-index-item"><a href="#partition.object">Partitioning Object</a></li>
<li class="help-index-item"><a href="#plantTraits">Plant Species Traits Data</a></li>
<li class="help-index-item"><a href="#plot.agnes">Plots of an Agglomerative Hierarchical Clustering</a></li>
<li class="help-index-item"><a href="#plot.diana">Plots of a Divisive Hierarchical Clustering</a></li>
<li class="help-index-item"><a href="#plot.mona">Banner of Monothetic Divisive Hierarchical Clusterings</a></li>
<li class="help-index-item"><a href="#plot.partition">Plot of a Partition of the Data Set</a></li>
<li class="help-index-item"><a href="#pltree">Plot Clustering Tree of a Hierarchical Clustering</a></li>
<li class="help-index-item"><a href="#pluton">Isotopic Composition Plutonium Batches</a></li>
<li class="help-index-item"><a href="#predict.ellipsoid">Predict Method for Ellipsoid Objects</a></li>
<li class="help-index-item"><a href="#print.agnes">Print Method for AGNES Objects</a></li>
<li class="help-index-item"><a href="#print.clara">Print Method for CLARA Objects</a></li>
<li class="help-index-item"><a href="#print.diana">Print Method for DIANA Objects</a></li>
<li class="help-index-item"><a href="#print.dissimilarity">Print and Summary Methods for Dissimilarity Objects</a></li>
<li class="help-index-item"><a href="#print.fanny">Print and Summary Methods for FANNY Objects</a></li>
<li class="help-index-item"><a href="#print.mona">Print Method for MONA Objects</a></li>
<li class="help-index-item"><a href="#print.pam">Print Method for PAM Objects</a></li>
<li class="help-index-item"><a href="#ruspini">Ruspini Data</a></li>
<li class="help-index-item"><a href="#silhouette">Compute or Extract Silhouette Information from Clustering</a></li>
<li class="help-index-item"><a href="#sizeDiss">Sample Size of Dissimilarity Like Object</a></li>
<li class="help-index-item"><a href="#summary.agnes">Summary Method for 'agnes' Objects</a></li>
<li class="help-index-item"><a href="#summary.clara">Summary Method for 'clara' Objects</a></li>
<li class="help-index-item"><a href="#summary.diana">Summary Method for 'diana' Objects</a></li>
<li class="help-index-item"><a href="#summary.mona">Summary Method for 'mona' Objects</a></li>
<li class="help-index-item"><a href="#summary.pam">Summary Method for PAM Objects</a></li>
<li class="help-index-item"><a href="#twins.object">Hierarchical Clustering Object</a></li>
<li class="help-index-item"><a href="#volume.ellipsoid">Compute the Volume (of an Ellipsoid)</a></li>
<li class="help-index-item"><a href="#votes.repub">Votes for Republican Candidate in Presidential Elections</a></li>
<li class="help-index-item"><a href="#xclara">Bivariate Data Set with 3 Clusters</a></li>
</ul>

    <hr>
    <div class="manual-pages-content">
<div class="container manual-page" id="agnes">

<a href="#agnes" class="help-page-title"><h2>Agglomerative Nesting (Hierarchical Clustering)</h2></a>

<h3>Description</h3>

<p>Computes agglomerative hierarchical clustering of the dataset.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">agnes<span class="token punctuation">(</span>x<span class="token punctuation">,</span> diss <span class="token operator">=</span> inherits<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"euclidean"</span><span class="token punctuation">,</span>
      stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"average"</span><span class="token punctuation">,</span> par.method<span class="token punctuation">,</span>
      keep.diss <span class="token operator">=</span> n <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">,</span> keep.data <span class="token operator">=</span> <span class="token operator">!</span>diss<span class="token punctuation">,</span> trace.lev <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>data matrix or data frame, or dissimilarity matrix, depending on the
value of the <code>diss</code> argument.
</p>
<p>In case of a matrix or data frame, each row corresponds to an observation,
and each column corresponds to a variable. All variables must be numeric.
Missing values (NAs) are allowed.
</p>
<p>In case of a dissimilarity matrix, <code>x</code> is typically the output of
<code><a href="#daisy">daisy</a></code> or <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>.
Also a vector with length n*(n-1)/2 is allowed (where n is the number
of observations), and will be interpreted in the same way as the
output of the above-mentioned functions. Missing values (NAs) are not
allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>

<p>logical flag: if TRUE (default for <code>dist</code> or
<code>dissimilarity</code> objects), then <code>x</code> is assumed to be a
dissimilarity matrix.  If FALSE, then <code>x</code> is treated as
a matrix of observations by variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>

<p>character string specifying the metric to be used for calculating
dissimilarities between observations.
The currently available options are <code>"euclidean"</code> and <code>"manhattan"</code>.
Euclidean distances are root sum-of-squares of differences, and
manhattan distances are the sum of absolute differences.
If <code>x</code> is already a dissimilarity matrix, then this argument will
be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>

<p>logical flag: if TRUE, then the measurements in <code>x</code> are
standardized before calculating the dissimilarities. Measurements
are standardized for each variable (column), by subtracting the
variable's mean value and dividing by the variable's mean absolute
deviation.  If <code>x</code> is already a dissimilarity matrix, then this
argument will be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string defining the clustering method.  The six methods
implemented are
<code>"average"</code> ([unweighted pair-]group [arithMetic] average method, aka ‘UPGMA’),
<code>"single"</code> (single linkage), <code>"complete"</code> (complete linkage),
<code>"ward"</code> (Ward's method),
<code>"weighted"</code> (weighted average linkage, aka ‘WPGMA’), its generalization
<code>"flexible"</code> which uses (a constant version of)
the Lance-Williams formula and the <code>par.method</code> argument, and
<code>"gaverage"</code> a generalized <code>"average"</code> aka “flexible
UPGMA” method also using the Lance-Williams formula and <code>par.method</code>.
</p>
<p>The default is <code>"average"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.method</code></td>
<td>

<p>If <code>method</code> is <code>"flexible"</code> or <code>"gaverage"</code>, a numeric
vector of length 1, 3, or 4, (with a default for <code>"gaverage"</code>), see in
the details section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.diss, keep.data</code></td>
<td>
<p>logicals indicating if the dissimilarities
and/or input data <code>x</code> should be kept in the result.  Setting
these to <code>FALSE</code> can give much smaller results and hence even save
memory allocation <em>time</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.lev</code></td>
<td>
<p>integer specifying a trace level for printing
diagnostics during the algorithm.  Default <code>0</code> does not print
anything; higher values print increasingly more.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>agnes</code> is fully described in chapter 5 of Kaufman and Rousseeuw (1990).
Compared to other agglomerative clustering methods such as <code>hclust</code>,
<code>agnes</code> has the following features: (a) it yields the
agglomerative coefficient (see <code><a href="#agnes.object">agnes.object</a></code>)
which measures the amount of clustering structure found; and (b)
apart from the usual tree it also provides the banner, a novel
graphical display (see <code><a href="#plot.agnes">plot.agnes</a></code>).
</p>
<p>The <code>agnes</code>-algorithm constructs a hierarchy of clusterings.<br>
At first, each observation is a small cluster by itself.  Clusters are
merged until only one large cluster remains which contains all the
observations.  At each stage the two <em>nearest</em> clusters are combined
to form one larger cluster.
</p>
<p>For <code>method="average"</code>, the distance between two clusters is the
average of the dissimilarities between the points in one cluster and the
points in the other cluster.
<br>
In <code>method="single"</code>, we use the smallest dissimilarity between a
point in the first cluster and a point in the second cluster (nearest
neighbor method).
<br>
When <code>method="complete"</code>, we use the largest dissimilarity
between a point in the first cluster and a point in the second cluster
(furthest neighbor method).
</p>
<p>The <code>method = "flexible"</code> allows (and requires) more details:
The Lance-Williams formula specifies how dissimilarities are
computed when clusters are agglomerated (equation (32) in K&amp;R(1990),
p.237).  If clusters <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">C_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> are agglomerated into a
new cluster, the dissimilarity between their union and another
cluster <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></code> is given by
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo>∪</mo><msub><mi>C</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>α</mi><mn>1</mn></msub><mo>∗</mo><mi>D</mi><mo stretchy="false">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>α</mi><mn>2</mn></msub><mo>∗</mo><mi>D</mi><mo stretchy="false">(</mo><msub><mi>C</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>+</mo><mi>β</mi><mo>∗</mo><mi>D</mi><mo stretchy="false">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>D</mi><mo stretchy="false">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>−</mo><mi>D</mi><mo stretchy="false">(</mo><msub><mi>C</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">D(C_1 \cup C_2, Q) = \alpha_1 * D(C_1, Q) + \alpha_2 * D(C_2, Q) +
                         \beta * D(C_1,C_2) + \gamma * |D(C_1, Q) - D(C_2, Q)|,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6153em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6153em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6597em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mord">∣</span><span class="mpunct">,</span></span></span></span></code>
</p>

<p>where the four coefficients <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>α</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>β</mi><mo separator="true">,</mo><mi>γ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\alpha_1, \alpha_2, \beta, \gamma)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span></span></span></span></code>
are specified by the vector <code>par.method</code>, either directly as vector of
length 4, or (more conveniently) if <code>par.method</code> is of length 1,
say <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">= \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></code>, <code>par.method</code> is extended to
give the “Flexible Strategy” (K&amp;R(1990), p.236 f) with
Lance-Williams coefficients <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mn>1</mn></msub><mo>=</mo><msub><mi>α</mi><mn>2</mn></msub><mo>=</mo><mi>α</mi><mo separator="true">,</mo><mi>β</mi><mo>=</mo><mn>1</mn><mo>−</mo><mn>2</mn><mi>α</mi><mo separator="true">,</mo><mi>γ</mi><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\alpha_1 = \alpha_2 = \alpha, \beta =
    1 - 2\alpha, \gamma=0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></code>.<br>
Also, if <code>length(par.method) == 3</code>, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></code> is set.
</p>
<p><b>Care</b> and expertise is probably needed when using <code>method = "flexible"</code>
particularly for the case when <code>par.method</code> is specified of
longer length than one.  Since <span class="pkg">cluster</span> version 2.0, choices
leading to invalid <code>merge</code> structures now signal an error (from
the C code already).
The <em>weighted average</em> (<code>method="weighted"</code>) is the same as
<code>method="flexible", par.method = 0.5</code>.  Further,
<code>method= "single"</code>  is equivalent to <code>method="flexible", par.method = c(.5,.5,0,-.5)</code>, and
<code>method="complete"</code> is equivalent to <code>method="flexible", par.method = c(.5,.5,0,+.5)</code>.
</p>
<p>The <code>method = "gaverage"</code> is a generalization of <code>"average"</code>, aka
“flexible UPGMA” method, and is (a generalization of the approach)
detailed in Belbin et al. (1992).  As <code>"flexible"</code>, it uses the
Lance-Williams formula above for dissimilarity updating, but with
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\alpha_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\alpha_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> not constant, but <em>proportional</em> to
the <em>sizes</em> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> of the clusters <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">C_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> respectively, i.e,
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>j</mi></msub><mo>=</mo><msubsup><mi>α</mi><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mfrac><msub><mi>n</mi><mn>1</mn></msub><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub></mrow></mfrac><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\alpha_j = \alpha'_j \frac{n_1}{n_1+n_2},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.197em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span></code>
</p>

<p>where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\alpha'_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code>, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\alpha'_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code> are determined from <code>par.method</code>,
either directly as <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>α</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>β</mi><mo separator="true">,</mo><mi>γ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\alpha_1, \alpha_2, \beta, \gamma)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span></span></span></span></code> or
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>α</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>β</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\alpha_1, \alpha_2, \beta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">)</span></span></span></span></code> with <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></code>, or (less flexibly,
but more conveniently) as follows:
</p>
<p>Belbin et al proposed “flexible beta”, i.e. the user would only
specify <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></code> (as <code>par.method</code>), sensibly in
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn><mo>≤</mo><mi>β</mi><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">-1 \leq \beta &lt; 1,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span></span></span></span></code>
</p>

<p>and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></code> determines <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\alpha'_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\alpha'_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></code> as
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\alpha'_j = 1 - \beta,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1467em;vertical-align:-0.3948em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span></span></span></span></code>
</p>
<p> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></code>.
</p>
<p>This <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></code> may be specified by <code>par.method</code> (as length 1 vector),
and if <code>par.method</code> is not specified, a default value of -0.1 is used,
as Belbin et al recommend taking a <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></code> value around -0.1 as a general
agglomerative hierarchical clustering strategy.
</p>
<p>Note that <code>method = "gaverage", par.method = 0</code> (or <code>par.method =
  c(1,1,0,0)</code>) is equivalent to the <code>agnes()</code> default method <code>"average"</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>"agnes"</code> (which extends <code>"twins"</code>)
representing the clustering.  See <code><a href="#agnes.object">agnes.object</a></code> for
details, and methods applicable.
</p>


<h3>BACKGROUND</h3>

<p>Cluster analysis divides a dataset into groups (clusters) of
observations that are similar to each other.
</p>

<dl>
<dt>Hierarchical methods</dt>
<dd>
<p>like
<code>agnes</code>, <code><a href="#diana">diana</a></code>, and <code><a href="#mona">mona</a></code>
construct a hierarchy of clusterings, with the number of clusters
ranging from one to the number of observations.</p>
</dd>
<dt>Partitioning methods</dt>
<dd>
<p>like
<code><a href="#pam">pam</a></code>, <code><a href="#clara">clara</a></code>, and <code><a href="#fanny">fanny</a></code>
require that the number of clusters be given by the user.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Method <code>"gaverage"</code> has been contributed by Pierre Roudier, Landcare
Research, New Zealand.
</p>


<h3>References</h3>

<p>Kaufman, L. and Rousseeuw, P.J. (1990). (=: “K&amp;R(1990)”)
<em>Finding Groups in Data: An Introduction to Cluster Analysis</em>.
Wiley, New York.
</p>
<p>Anja Struyf, Mia Hubert and Peter J. Rousseeuw (1996)
Clustering in an Object-Oriented Environment.
<em>Journal of Statistical Software</em> <b>1</b>.
<a href="https://doi.org/10.18637/jss.v001.i04" target="_blank">doi:10.18637/jss.v001.i04</a>
</p>
<p>Struyf, A., Hubert, M. and Rousseeuw, P.J. (1997). Integrating
Robust Clustering Techniques in S-PLUS,
<em>Computational Statistics and Data Analysis</em>, <b>26</b>, 17–37.
</p>
<p>Lance, G.N., and W.T. Williams (1966).
A General Theory of Classifactory Sorting Strategies, I. Hierarchical
Systems.
<em>Computer J.</em> <b>9</b>, 373–380.
</p>
<p>Belbin, L., Faith, D.P. and Milligan, G.W. (1992). A Comparison of
Two Approaches to Beta-Flexible Clustering.
<em>Multivariate Behavioral Research</em>, <b>27</b>, 417–433.
</p>


<h3>See Also</h3>

<p><code><a href="#agnes.object">agnes.object</a></code>, <code><a href="#daisy">daisy</a></code>, <code><a href="#diana">diana</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#hclust">hclust</a></code>, <code><a href="#plot.agnes">plot.agnes</a></code>,
<code><a href="#twins.object">twins.object</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span>
agn1 <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>votes.repub<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"manhattan"</span><span class="token punctuation">,</span> stand <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
agn1
plot<span class="token punctuation">(</span>agn1<span class="token punctuation">)</span>

op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
agn2 <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>daisy<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span><span class="token punctuation">,</span> diss <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"complete"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>agn2<span class="token punctuation">)</span>
<span class="token comment">## alpha = 0.625 ==&gt; beta = -1/4  is "recommended" by some</span>
agnS <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>votes.repub<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"flexible"</span><span class="token punctuation">,</span> par.meth <span class="token operator">=</span> <span class="token number">0.625</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>agnS<span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## "show" equivalence of three "flexible" special cases</span>
d.vr <span class="token operator">&lt;-</span> daisy<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span>
a.wgt  <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>d.vr<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"weighted"</span><span class="token punctuation">)</span>
a.sing <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>d.vr<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"single"</span><span class="token punctuation">)</span>
a.comp <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>d.vr<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"complete"</span><span class="token punctuation">)</span>
iC <span class="token operator">&lt;-</span> <span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment"># not using 'call' and 'method' for comparisons</span>
stopifnot<span class="token punctuation">(</span>
  all.equal<span class="token punctuation">(</span>a.wgt <span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">,</span> agnes<span class="token punctuation">(</span>d.vr<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"flexible"</span><span class="token punctuation">,</span> par.method <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token punctuation">,</span>
  all.equal<span class="token punctuation">(</span>a.sing<span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">,</span> agnes<span class="token punctuation">(</span>d.vr<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"flex"</span><span class="token punctuation">,</span> par.method<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">,</span><span class="token number">.5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  all.equal<span class="token punctuation">(</span>a.comp<span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">,</span> agnes<span class="token punctuation">(</span>d.vr<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"flex"</span><span class="token punctuation">,</span> par.method<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">,</span><span class="token number">.5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">+</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Exploring the dendrogram structure</span>
<span class="token punctuation">(</span>d2 <span class="token operator">&lt;-</span> as.dendrogram<span class="token punctuation">(</span>agn2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># two main branches</span>
d2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># the first branch</span>
d2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># the 2nd one  { 8 + 42  = 50 }</span>
d2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token comment"># first sub-branch of branch 1 .. and shorter form</span>
identical<span class="token punctuation">(</span>d2<span class="token punctuation">[</span><span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          d2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">## a "textual picture" of the dendrogram :</span>
str<span class="token punctuation">(</span>d2<span class="token punctuation">)</span>

data<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>

<span class="token comment">## Plot similar to Figure 7 in ref</span>
<span class="token comment">## Not run: plot(agnes(agriculture), ask = TRUE)</span>


data<span class="token punctuation">(</span>animals<span class="token punctuation">)</span>
aa.a  <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>animals<span class="token punctuation">)</span> <span class="token comment"># default method = "average"</span>
aa.ga <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>animals<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"gaverage"</span><span class="token punctuation">)</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfcol<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> mgp<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token operator">+</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          cex.main<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>aa.a<span class="token punctuation">,</span>  which.plot <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>aa.ga<span class="token punctuation">,</span> which.plot <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>


<span class="token comment">## Show how "gaverage" is a "generalized average":</span>
aa.ga.<span class="token number">0</span> <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>animals<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"gaverage"</span><span class="token punctuation">,</span> par.method <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>aa.ga.<span class="token number">0</span><span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">,</span> aa.a<span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="agnes.object">

<a href="#agnes.object" class="help-page-title"><h2>Agglomerative Nesting (AGNES) Object</h2></a>

<h3>Description</h3>

<p>The objects of class <code>"agnes"</code>
represent an agglomerative hierarchical clustering of a dataset.
</p>


<h3>Value</h3>

<p>A legitimate <code>agnes</code> object is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>

<p>a vector giving a permutation of the original observations to allow
for plotting, in the sense that the branches of a clustering tree
will not cross.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.lab</code></td>
<td>

<p>a vector similar to <code>order</code>, but containing observation labels
instead of observation numbers. This component is only available if
the original observations were labelled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>

<p>a vector with the distances between merging clusters at the successive
stages.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ac</code></td>
<td>

<p>the agglomerative coefficient, measuring the clustering structure of the
dataset.
</p>
<p>For each observation i, denote by m(i) its dissimilarity to the
first cluster it is merged with, divided by the dissimilarity of the
merger in the final step of the algorithm.  The <code>ac</code> is the
average of all 1 - m(i). It can also be seen as the average width
(or the percentage filled) of the banner plot.  Because <code>ac</code>
grows with the number of observations, this measure should not
be used to compare datasets of very different sizes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge</code></td>
<td>

<p>an (n-1) by 2 matrix, where n is the number of observations.  Row i
of <code>merge</code> describes the merging of clusters at step i of the
clustering.  If a number j in the row is negative, then the single
observation |j| is merged at this stage.  If j is positive, then the
merger is with the cluster formed at stage j of the algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>

<p>an object of class <code>"dissimilarity"</code> (see
<code><a href="#dissimilarity.object">dissimilarity.object</a></code>), representing the total
dissimilarity matrix of the dataset.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a matrix containing the original or standardized measurements, depending
on the <code>stand</code> option of the function <code>agnes</code>. If a
dissimilarity matrix was given as input structure, then this
component is not available.
</p>
</td>
</tr>
</table>
<h3>GENERATION</h3>

<p>This class of objects is returned from <code><a href="#agnes">agnes</a></code>.
</p>


<h3>METHODS</h3>

<p>The <code>"agnes"</code> class has methods for the following generic functions:
<code>print</code>, <code>summary</code>, <code>plot</code>, and
<code><a href="https://r-universe.dev/manuals/stats.html#dendrogram">as.dendrogram</a></code>.
</p>
<p>In addition, <code><a href="https://r-universe.dev/manuals/stats.html#cutree">cutree</a>(x, *)</code> can be used to “cut”
the dendrogram in order to produce cluster assignments.
</p>


<h3>INHERITANCE</h3>

<p>The class <code>"agnes"</code> inherits from <code>"twins"</code>.
Therefore, the generic functions <code><a href="#pltree">pltree</a></code> and
<code><a href="https://r-universe.dev/manuals/stats.html#as.hclust">as.hclust</a></code> are available for <code>agnes</code> objects.
After applying <code>as.hclust()</code>, all <em>its</em> methods are
available, of course.
</p>


<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code>, <code><a href="#diana">diana</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#as.hclust">as.hclust</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#hclust">hclust</a></code>,
<code><a href="#plot.agnes">plot.agnes</a></code>, <code><a href="#twins.object">twins.object</a></code>.
</p>
<p><code><a href="https://r-universe.dev/manuals/stats.html#cutree">cutree</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>
ag.ag <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>
class<span class="token punctuation">(</span>ag.ag<span class="token punctuation">)</span>
pltree<span class="token punctuation">(</span>ag.ag<span class="token punctuation">)</span> <span class="token comment"># the dendrogram</span>

<span class="token comment">## cut the dendrogram -&gt; get cluster assignments:</span>
<span class="token punctuation">(</span>ck3 <span class="token operator">&lt;-</span> cutree<span class="token punctuation">(</span>ag.ag<span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>ch6 <span class="token operator">&lt;-</span> cutree<span class="token punctuation">(</span>as.hclust<span class="token punctuation">(</span>ag.ag<span class="token punctuation">)</span><span class="token punctuation">,</span> h <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>ch6<span class="token punctuation">)</span><span class="token punctuation">,</span> ck3<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="agriculture">

<a href="#agriculture" class="help-page-title"><h2>European Union Agricultural Workforces</h2></a>

<h3>Description</h3>

<p>Gross National Product (GNP) per capita and percentage of the
population working in agriculture for each country belonging to the
European Union in 1993.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on 2 variables:
</p>

<table>
<tr>
<td style="text-align: right;">
    [ , 1] </td>
<td style="text-align: left;"> <code>x</code> </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> per capita GNP </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , 2] </td>
<td style="text-align: left;"> <code>y</code> </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> percentage in agriculture
  </td>
</tr>
</table>
<p>The row names of the data frame indicate the countries.
</p>


<h3>Details</h3>

<p>The data seem to show two clusters, the “more agricultural” one
consisting of Greece, Portugal, Spain, and Ireland.
</p>


<h3>Source</h3>

<p>Eurostat (European Statistical Agency, 1994):
<em>Cijfers en feiten: Een statistisch portret van de Europese Unie</em>.
</p>


<h3>References</h3>

<p>see those in <code><a href="#agnes">agnes</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code>, <code><a href="#daisy">daisy</a></code>, <code><a href="#diana">diana</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>

<span class="token comment">## Compute the dissimilarities using Euclidean metric and without</span>
<span class="token comment">## standardization</span>
daisy<span class="token punctuation">(</span>agriculture<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"euclidean"</span><span class="token punctuation">,</span> stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment">## 2nd plot is similar to Figure 3 in Struyf et al (1996)</span>
plot<span class="token punctuation">(</span>pam<span class="token punctuation">(</span>agriculture<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Plot similar to Figure 7 in Struyf et al (1996)</span>
<span class="token comment">## Not run: plot(agnes(agriculture), ask = TRUE)</span>


<span class="token comment">## Plot similar to Figure 8 in Struyf et al (1996)</span>
<span class="token comment">## Not run: plot(diana(agriculture), ask = TRUE)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="animals">

<a href="#animals" class="help-page-title"><h2>Attributes of Animals</h2></a>

<h3>Description</h3>

<p>This data set considers 6 binary attributes for 20 animals.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>animals<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on 6 variables:
</p>

<table>
<tr>
<td style="text-align: right;">
    [ , 1] </td>
<td style="text-align: left;"> war </td>
<td style="text-align: left;"> warm-blooded </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , 2] </td>
<td style="text-align: left;"> fly </td>
<td style="text-align: left;"> can fly </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , 3] </td>
<td style="text-align: left;"> ver </td>
<td style="text-align: left;"> vertebrate </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , 4] </td>
<td style="text-align: left;"> end </td>
<td style="text-align: left;"> endangered </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , 5] </td>
<td style="text-align: left;"> gro </td>
<td style="text-align: left;"> live in groups </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , 6] </td>
<td style="text-align: left;"> hai </td>
<td style="text-align: left;"> have hair </td>
</tr>
<tr>
<td style="text-align: right;">
  </td>
</tr>
</table>
<p>All variables are encoded as 1 = 'no', 2 = 'yes'.
</p>


<h3>Details</h3>

<p>This dataset is useful for illustrating monothetic (only a single
variable is used for each split) hierarchical clustering.
</p>


<h3>Source</h3>

<p>Leonard Kaufman and Peter J. Rousseeuw (1990):
<em>Finding Groups in Data</em>
(pp 297ff).
New York: Wiley.
</p>


<h3>References</h3>

<p>see Struyf, Hubert &amp; Rousseeuw (1996),  in <code><a href="#agnes">agnes</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>animals<span class="token punctuation">)</span>
apply<span class="token punctuation">(</span>animals<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> table<span class="token punctuation">)</span> <span class="token comment"># simple overview</span>

ma <span class="token operator">&lt;-</span> mona<span class="token punctuation">(</span>animals<span class="token punctuation">)</span>
ma
<span class="token comment">## Plot similar to Figure 10 in Struyf et al (1996)</span>
plot<span class="token punctuation">(</span>ma<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="bannerplot">

<a href="#bannerplot" class="help-page-title"><h2>Plot Banner (of Hierarchical Clustering)</h2></a>

<h3>Description</h3>

<p>Draws a “banner”, i.e. basically a horizontal <code><a href="https://r-universe.dev/manuals/graphics.html#barplot">barplot</a></code>
visualizing the (agglomerative or divisive) hierarchical clustering or
an other binary dendrogram structure.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">bannerplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> w <span class="token operator">=</span> rev<span class="token punctuation">(</span>x<span class="token operator">$</span>height<span class="token punctuation">)</span><span class="token punctuation">,</span> fromLeft <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
           main<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> sub<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Height"</span><span class="token punctuation">,</span>  adj <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
           col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> axes<span class="token punctuation">,</span>
           rev.xax <span class="token operator">=</span> <span class="token operator">!</span>fromLeft<span class="token punctuation">,</span> xax.pretty <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
           labels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> nmax.lab <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">,</span> max.strlen <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
           yax.do <span class="token operator">=</span> axes <span class="token operator">&amp;&amp;</span> length<span class="token punctuation">(</span>x<span class="token operator">$</span>order<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> nmax.lab<span class="token punctuation">,</span>
           yaxRight <span class="token operator">=</span> fromLeft<span class="token punctuation">,</span> y.mar <span class="token operator">=</span> <span class="token number">2.4</span> <span class="token operator">+</span> max.strlen<span class="token operator">/</span><span class="token number">2.5</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list with components <code>order</code>, <code>order.lab</code> and
<code>height</code> when <code>w</code>, the next argument is not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>non-negative numeric vector of bar widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fromLeft</code></td>
<td>
<p>logical, indicating if the banner is from the left or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main,sub</code></td>
<td>
<p>main and sub titles, see <code><a href="https://r-universe.dev/manuals/graphics.html#title">title</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x axis label (with ‘correct’ default e.g. for
<code>plot.agnes</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>passed to <code><a href="https://r-universe.dev/manuals/graphics.html#title">title</a>(main,sub)</code> for string adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>vector of length 2, for two horizontal segments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>color for bar border; now defaults to background (no border).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>logical indicating if axes (and labels) should be drawn at all.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame.plot</code></td>
<td>
<p>logical indicating the banner should be framed;
mainly used when <code>border = 0</code> (as per default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rev.xax</code></td>
<td>
<p>logical indicating if the x axis should be reversed (as
in <code>plot.diana</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax.pretty</code></td>
<td>
<p>logical or integer indicating if
<code><a href="https://r-universe.dev/manuals/base.html#pretty">pretty</a>()</code> should be used for the x axis.
<code>xax.pretty = FALSE</code> is mainly for back compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>labels to use on y-axis; the default is constructed from
<code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax.lab</code></td>
<td>
<p>integer indicating the number of labels which is
considered too large for single-name labelling the banner plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.strlen</code></td>
<td>
<p>positive integer giving the length to which
strings are truncated in banner plot labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yax.do</code></td>
<td>
<p>logical indicating if a y axis and banner labels should
be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxRight</code></td>
<td>
<p>logical indicating if the y axis is on the right or left.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.mar</code></td>
<td>
<p>positive number specifying the margin width to use when
banners are labeled (along a y-axis).  The default adapts to the
string width and optimally would also dependend on the font.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters (see <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>) may also
be supplied as arguments to this function.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This is mainly a utility called from <code><a href="#plot.agnes">plot.agnes</a></code>,
<code><a href="#plot.diana">plot.diana</a></code> and <code><a href="#plot.mona">plot.mona</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler (from original code of Kaufman and Rousseeuw).</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>
bannerplot<span class="token punctuation">(</span>agnes<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Bannerplot"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="chorSub">

<a href="#chorSub" class="help-page-title"><h2>Subset of C-horizon of Kola Data</h2></a>

<h3>Description</h3>

<p>This is a small rounded subset of the C-horizon data
<code><a>chorizon</a></code> from package <span class="pkg">mvoutlier</span>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>chorSub<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>A data frame with 61 observations on 10 variables.  The variables
contain scaled concentrations of chemical elements.
</p>


<h3>Details</h3>

<p>This data set was produced from <code>chorizon</code> via these statements:
</p>
<pre>
    data(chorizon, package = "mvoutlier")
    chorSub &lt;- round(100*scale(chorizon[,101:110]))[190:250,]
    storage.mode(chorSub) &lt;- "integer"
    colnames(chorSub) &lt;- gsub("_.*", '', colnames(chorSub))
  </pre>


<h3>Source</h3>

<p>Kola Project (1993-1998)
</p>


<h3>See Also</h3>

<p><code><a>chorizon</a></code> in package <span class="pkg">mvoutlier</span> and other
Kola data in the same package.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>chorSub<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>chorSub<span class="token punctuation">)</span>
pairs<span class="token punctuation">(</span>chorSub<span class="token punctuation">,</span> gap<span class="token operator">=</span> <span class="token number">.1</span><span class="token punctuation">)</span><span class="token comment"># some outliers</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="clara">

<a href="#clara" class="help-page-title"><h2>Clustering Large Applications</h2></a>

<h3>Description</h3>

<p>Computes a <code>"clara"</code> object, a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> representing a
clustering of the data into <code>k</code> clusters.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">clara<span class="token punctuation">(</span>x<span class="token punctuation">,</span> k<span class="token punctuation">,</span> metric <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"euclidean"</span><span class="token punctuation">,</span> <span class="token string">"manhattan"</span><span class="token punctuation">,</span> <span class="token string">"jaccard"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> cluster.only <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> samples <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
      sampsize <span class="token operator">=</span> min<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">40</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> k<span class="token punctuation">)</span><span class="token punctuation">,</span> trace <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> medoids.x <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
      keep.data <span class="token operator">=</span> medoids.x<span class="token punctuation">,</span> rngR <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> pamLike <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> correct.d <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>data matrix or data frame, each row corresponds to an observation,
and each column corresponds to a variable.  All variables must be numeric.
Missing values (NAs) are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer, the number of clusters.
It is required that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>k</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">0 &lt; k &lt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> is the number of
observations (i.e., n = <code>nrow(x)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>

<p>character string specifying the metric to be used for calculating
dissimilarities between observations.
The currently available options are "euclidean", "manhattan", and
"jaccard".
</p>
<p>Euclidean distances are root sum-of-squares of differences, and
manhattan distances are the sum of absolute differences.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>logical, indicating if the measurements in <code>x</code> are
standardized before calculating the dissimilarities.  Measurements
are standardized for each variable (column), by subtracting the
variable's mean value and dividing by the variable's mean absolute
deviation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.only</code></td>
<td>
<p>logical; if true, only the clustering will be
computed and returned, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>integer, say <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></code>, the number of samples to be drawn from the
dataset.  The default, <code>N = 5</code>, is rather small for historical (and
now back compatibility) reasons and we <em>recommend to set
<code>samples</code> an order of magnitude larger</em>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampsize</code></td>
<td>
<p>integer, say <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></code>, the number of observations in each
sample.  <code>sampsize</code> should be higher than the number of clusters
(<code>k</code>) and at most the number of observations (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">n =</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></code>
<code>nrow(x)</code>).  While computational effort is proportional to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>j</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">j^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></code>,
see note below, it may still be advisable to set
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">j =</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></code><code>sampsize</code> to a <em>larger</em> value than the (historical) default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>integer indicating a <em>trace level</em> for diagnostic
output during the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medoids.x</code></td>
<td>
<p>logical indicating if the medoids should be
returned, identically to some rows of the input data <code>x</code>.  If
<code>FALSE</code>, <code>keep.data</code> must be false as well, and the medoid
indices, i.e., row numbers of the medoids will still be returned
(<code>i.med</code> component), and the algorithm saves space by needing
one copy less of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.data</code></td>
<td>
<p>logical indicating if the (<em>scaled</em> if
<code>stand</code> is true) data should be kept in the result.


Setting this to <code>FALSE</code> saves memory (and hence time), but
disables <code><a href="#clusplot.partition">clusplot</a>()</code>ing of the result.  Use
<code>medoids.x = FALSE</code> to save even more memory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rngR</code></td>
<td>
<p>logical indicating if <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s random number generator should
be used instead of the primitive clara()-builtin one.  If true, this
also means that each call to <code>clara()</code> returns a different result
– though only slightly different in good situations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pamLike</code></td>
<td>
<p>logical indicating if the “swap” phase (see
<code><a href="#pam">pam</a></code>, in C code) should use the same algorithm as
<code><a href="#pam">pam</a>()</code>.  Note that from Kaufman and Rousseeuw's
description this <em>should</em> have been true always, but as the
original Fortran code and the subsequent port to C has always
contained a small one-letter change (a typo according to Martin Maechler)
with respect to PAM, the default, <code>pamLike = FALSE</code> has been chosen to
remain back compatible rather than “PAM compatible”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct.d</code></td>
<td>
<p>logical or integer indicating that—only in the case
of <code>NA</code>s present in <code>x</code>—the correct distance computation
should be used instead of the wrong formula which has been present
in the original Fortran code and been in use up to early 2016.
</p>
<p>Because the new correct formula is not back compatible, for the time
being, a warning is signalled in this case, unless the user explicitly
specifies <code>correct.d</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>clara</code> is fully described in chapter 3 of Kaufman and Rousseeuw (1990).
Compared to other partitioning methods such as <code>pam</code>, it can deal with
much larger datasets.  Internally, this is achieved by considering
sub-datasets of fixed size (<code>sampsize</code>) such that the time and
storage requirements become linear in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> rather than quadratic.
</p>
<p>Each sub-dataset is partitioned into <code>k</code> clusters using the same
algorithm as in <code><a href="#pam">pam</a></code>.<br>
Once <code>k</code> representative objects have been selected from the
sub-dataset, each observation of the entire dataset is assigned
to the nearest medoid.
</p>
<p>The mean (equivalent to the sum) of the dissimilarities of the
observations to their closest medoid is used as a measure of the
quality of the clustering.  The sub-dataset for which the mean (or
sum) is minimal, is retained.  A further analysis is carried out on
the final partition.
</p>
<p>Each sub-dataset is forced to contain the medoids obtained from the
best sub-dataset until then.  Randomly drawn observations are added to
this set until <code>sampsize</code> has been reached.
</p>
<p>When <code>cluster.only</code> is true, the result is simply a (possibly
named) integer vector specifying the clustering, i.e.,<br><code>clara(x,k, cluster.only=TRUE)</code> is the same as <br><code>clara(x,k)$clustering</code> but computed more efficiently.
</p>


<h3>Value</h3>

<p>If <code>cluster.only</code> is false (as by default),
an object of class <code>"clara"</code> representing the clustering.  See
<code><a href="#clara.object">clara.object</a></code> for details.
</p>
<p>If <code>cluster.only</code> is true, the result is the "clustering", an
integer vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> with entries from <code>1:k</code>.
</p>


<h3>Note</h3>


<p>By default, the random sampling is implemented with a <em>very</em>
simple scheme (with period <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup><mo>=</mo><mn>65536</mn></mrow><annotation encoding="application/x-tex">2^{16} = 65536</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">65536</span></span></span></span></code>) inside the Fortran
code, independently of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s random number generation, and as a matter
of fact, deterministically.  Alternatively, we recommend setting
<code>rngR = TRUE</code> which uses <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s random number generators.  Then,
<code>clara()</code> results are made reproducible typically by using
<code><a href="https://r-universe.dev/manuals/base.html#Random">set.seed</a>()</code> before calling <code>clara</code>.
</p>
<p>The storage requirement of <code>clara</code> computation (for small
<code>k</code>) is about
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>×</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>j</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \times p) + O(j^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mtext mathvariant="monospace">sampsize</mtext></mrow><annotation encoding="application/x-tex">j = \code{sampsize}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.2222em;"></span><span class="mord text"><span class="mord texttt">sampsize</span></span></span></span></span></code>, and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mtext mathvariant="monospace">dim(x)</mtext></mrow><annotation encoding="application/x-tex">(n,p) = \code{dim(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord texttt">dim(x)</span></span></span></span></span></code>.
The CPU computing time (again assuming small <code>k</code>) is about
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>×</mo><mi>p</mi><mo>×</mo><msup><mi>j</mi><mn>2</mn></msup><mo>×</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \times p \times j^2 \times N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></code>, where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mtext mathvariant="monospace">samples</mtext></mrow><annotation encoding="application/x-tex">N = \code{samples}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.2222em;"></span><span class="mord text"><span class="mord texttt">samples</span></span></span></span></span></code>.
</p>
<p>For “small” datasets, the function <code><a href="#pam">pam</a></code> can be used
directly.  What can be considered <em>small</em>, is really a function
of available computing power, both memory (RAM) and speed.
Originally (1990), “small” meant less than 100 observations;
in 1997, the authors said <em>“small (say with fewer than 200
observations)”</em>; as of 2006, you can use <code><a href="#pam">pam</a></code> with
several thousand observations.
</p>


<h3>Author(s)</h3>

<p>Kaufman and Rousseeuw (see <code><a href="#agnes">agnes</a></code>), originally.
Metric <code>"jaccard"</code>: Kamil Kozlowski (<code>@ownedoutcomes.com</code>)
and Kamil Jadeszko.
All arguments from <code>trace</code> on, and most <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> documentation and all
tests by Martin Maechler.
</p>


<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code> for background and references;
<code><a href="#clara.object">clara.object</a></code>, <code><a href="#pam">pam</a></code>,
<code><a href="#partition.object">partition.object</a></code>, <code><a href="#plot.partition">plot.partition</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## generate 500 objects, divided into 2 clusters.</span>
x <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
clarax <span class="token operator">&lt;-</span> clara<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> samples<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
clarax
clarax<span class="token operator">$</span>clusinfo
<span class="token comment">## using pamLike=TRUE  gives the same (apart from the 'call'):</span>
all.equal<span class="token punctuation">(</span>clarax<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          clara<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> samples<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> pamLike <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>clarax<span class="token punctuation">)</span>

<span class="token comment">## cluster.only = TRUE -- save some memory/time :</span>
clclus <span class="token operator">&lt;-</span> clara<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> samples<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> cluster.only <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>clclus<span class="token punctuation">,</span> clarax<span class="token operator">$</span>clustering<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment">## 'xclara' is an artificial data set with 3 clusters of 1000 bivariate</span>
<span class="token comment">## objects each.</span>
data<span class="token punctuation">(</span>xclara<span class="token punctuation">)</span>
<span class="token punctuation">(</span>clx3 <span class="token operator">&lt;-</span> clara<span class="token punctuation">(</span>xclara<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## "better" number of samples</span>
cl.<span class="token number">3</span> <span class="token operator">&lt;-</span> clara<span class="token punctuation">(</span>xclara<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> samples<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token comment">## but that did not change the result here:</span>
stopifnot<span class="token punctuation">(</span>cl.<span class="token number">3</span><span class="token operator">$</span>clustering <span class="token operator">==</span> clx3<span class="token operator">$</span>clustering<span class="token punctuation">)</span>
<span class="token comment">## Plot similar to Figure 5 in Struyf et al (1996)</span>
<span class="token comment">## Not run: plot(clx3, ask = TRUE)</span>


<span class="token comment">## Try 100 times *different* random samples -- for reliability:</span>
nSim <span class="token operator">&lt;-</span> <span class="token number">100</span>
nCl <span class="token operator">&lt;-</span> <span class="token number">3</span> <span class="token comment"># = no.classes</span>
set.seed<span class="token punctuation">(</span><span class="token number">421</span><span class="token punctuation">)</span><span class="token comment"># (reproducibility)</span>
cl <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span>nrow<span class="token punctuation">(</span>xclara<span class="token punctuation">)</span><span class="token punctuation">,</span> nSim<span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>nSim<span class="token punctuation">)</span>
   cl<span class="token punctuation">[</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> clara<span class="token punctuation">(</span>xclara<span class="token punctuation">,</span> nCl<span class="token punctuation">,</span> medoids.x <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> rngR <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token operator">$</span>cluster
tcl <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>cl<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> tabulate<span class="token punctuation">,</span> nbins <span class="token operator">=</span> nCl<span class="token punctuation">)</span>
<span class="token comment">## those that are not always in same cluster (5 out of 3000 for this seed):</span>
<span class="token punctuation">(</span>iDoubt <span class="token operator">&lt;-</span> which<span class="token punctuation">(</span>apply<span class="token punctuation">(</span>tcl<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> all<span class="token punctuation">(</span>n <span class="token operator">&lt;</span> nSim<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>length<span class="token punctuation">(</span>iDoubt<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment"># (not for all seeds)</span>
  tabD <span class="token operator">&lt;-</span> tcl<span class="token punctuation">[</span><span class="token punctuation">,</span>iDoubt<span class="token punctuation">,</span> drop<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">]</span>
  dimnames<span class="token punctuation">(</span>tabD<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>cluster <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>nCl<span class="token punctuation">)</span><span class="token punctuation">,</span> obs <span class="token operator">=</span> format<span class="token punctuation">(</span>iDoubt<span class="token punctuation">)</span><span class="token punctuation">)</span>
  t<span class="token punctuation">(</span>tabD<span class="token punctuation">)</span> <span class="token comment"># how many times in which clusters</span>
<span class="token punctuation">}</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="clara.object">

<a href="#clara.object" class="help-page-title"><h2>Clustering Large Applications (CLARA) Object</h2></a>

<h3>Description</h3>

<p>The objects of class <code>"clara"</code> represent a partitioning of a large
dataset into clusters and are typically returned from <code><a href="#clara">clara</a></code>.
</p>


<h3>Value</h3>

<p>A legitimate <code>clara</code> object is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>

<p>labels or case numbers of the observations in the best sample, that is,
the sample used by the <code>clara</code> algorithm for the final partition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medoids</code></td>
<td>
<p>the medoids or representative objects of the clusters.
It is a matrix with in each row the coordinates of one medoid.
Possibly <code>NULL</code>, namely when the object resulted from
<code>clara(*, medoids.x=FALSE)</code>. Use the following <code>i.med</code> in
that case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i.med</code></td>
<td>

<p>the <em>indices</em> of the <code>medoids</code> above: <code>medoids &lt;- x[i.med,]</code>
where <code>x</code> is the original data matrix in <code>clara(x,*)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p>the clustering vector, see <code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objective</code></td>
<td>
<p>the objective function for the final clustering of
the entire dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusinfo</code></td>
<td>

<p>matrix, each row gives numerical information for one cluster. These
are the cardinality of the cluster (number of observations), the
maximal and average dissimilarity between the observations in the
cluster and the cluster's medoid.  
The last column is the maximal
dissimilarity between the observations in the cluster and the
cluster's medoid, divided by the minimal dissimilarity between the
cluster's medoid and the medoid of any other cluster. If this ratio
is small, the cluster is well-separated from the other clusters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>
<p>dissimilarity (maybe NULL), see <code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silinfo</code></td>
<td>
<p>list with silhouette width information for the best sample, see
<code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>generating call, see <code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix, possibibly standardized, or NULL, see
<code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
</table>
<h3>Methods, Inheritance</h3>

<p>The <code>"clara"</code> class has methods for the following generic functions:
<code>print</code>, <code>summary</code>.
</p>
<p>The class <code>"clara"</code> inherits from <code>"partition"</code>.
Therefore, the generic functions <code>plot</code> and <code>clusplot</code> can
be used on a <code>clara</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#clara">clara</a></code>, <code><a href="#dissimilarity.object">dissimilarity.object</a></code>,
<code><a href="#partition.object">partition.object</a></code>, <code><a href="#plot.partition">plot.partition</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="clusGap">

<a href="#clusGap" class="help-page-title"><h2>Gap Statistic for Estimating the Number of Clusters</h2></a>

<h3>Description</h3>

<p><code>clusGap()</code> calculates a goodness of clustering measure, the
“gap” statistic.  For each number of clusters <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>, it
compares <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(W(k))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">))</span></span></span></span></code> with
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>E</mi><mo>∗</mo></msup><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E^*[\log(W(k))]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">))]</span></span></span></span></code> where the latter is defined via
bootstrapping, i.e., simulating from a reference (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>)
distribution, a uniform distribution on the hypercube determined by
the ranges of <code>x</code>, after first centering, and then
<code><a href="https://r-universe.dev/manuals/base.html#svd">svd</a></code> (aka ‘PCA’)-rotating them when (as by
default) <code>spaceH0 = "scaledPCA"</code>.
</p>
<p><code>maxSE(f, SE.f)</code> determines the location of the <b>maximum</b>
of <code>f</code>, taking a “1-SE rule” into account for the
<code>*SE*</code> methods.  The default method <code>"firstSEmax"</code> looks for
the smallest <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> such that its value <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></code> is not more than 1
standard error away from the first local maximum.
This is similar but not the same as <code>"Tibs2001SEmax"</code>, Tibshirani
et al's recommendation of determining the number of clusters from the
gap statistics and their standard deviations.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">clusGap<span class="token punctuation">(</span>x<span class="token punctuation">,</span> FUNcluster<span class="token punctuation">,</span> K.max<span class="token punctuation">,</span> B <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> d.power <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        spaceH0 <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"scaledPCA"</span><span class="token punctuation">,</span> <span class="token string">"original"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        verbose <span class="token operator">=</span> interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

maxSE<span class="token punctuation">(</span>f<span class="token punctuation">,</span> SE.f<span class="token punctuation">,</span>
      method <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"firstSEmax"</span><span class="token punctuation">,</span> <span class="token string">"Tibs2001SEmax"</span><span class="token punctuation">,</span> <span class="token string">"globalSEmax"</span><span class="token punctuation">,</span>
                 <span class="token string">"firstmax"</span><span class="token punctuation">,</span> <span class="token string">"globalmax"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      SE.factor <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'clusGap'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"firstSEmax"</span><span class="token punctuation">,</span> SE.factor <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'clusGap'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"k"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> expression<span class="token punctuation">(</span>Gap<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> do.arrows <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
     arrowArgs <span class="token operator">=</span> list<span class="token punctuation">(</span>col<span class="token operator">=</span><span class="token string">"red3"</span><span class="token punctuation">,</span> length<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">,</span> angle<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">,</span> code<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric matrix or <code><a href="https://r-universe.dev/manuals/base.html#data.frame">data.frame</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUNcluster</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#function">function</a></code> which accepts as first
argument a (data) matrix like <code>x</code>, second argument, say
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo separator="true">,</mo><mi>k</mi><mo>≥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">k, k\geq 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code>, the number of clusters desired,
and returns a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> with a component named (or shortened to)
<code>cluster</code> which is a vector of length <code>n = nrow(x)</code> of
integers in <code>1:k</code> determining the clustering or grouping of the
<code>n</code> observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.max</code></td>
<td>
<p>the maximum number of clusters to consider, must be at
least two.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>integer, number of Monte Carlo (“bootstrap”) samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.power</code></td>
<td>
<p>a positive integer specifying the power <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code> which
is applied to the euclidean distances (<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>) before
they are summed up to give <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">W(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></code>.  The default, <code>d.power = 1</code>,
corresponds to the “historical” <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> implementation, whereas
<code>d.power = 2</code> corresponds to what Tibshirani et al had
proposed.  This was found by Juan Gonzalez, in 2016-02.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>spaceH0</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> string specifying the
space of the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> distribution (of <em>no</em> cluster).  Both
<code>"scaledPCA"</code> and <code>"original"</code> use a uniform distribution
in a hyper cube and had been mentioned in the reference;
<code>"original"</code> been added after a proposal (including code) by
Juan Gonzalez.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>integer or logical, determining if “progress”
output should be printed.  The default prints one bit per bootstrap
sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(for <code>clusGap()</code>:) optionally further arguments for
<code>FUNcluster()</code>, see <code>kmeans</code> example below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>numeric vector of ‘function values’, of length
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></code>, whose (“1 SE respected”) maximum we want.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE.f</code></td>
<td>
<p>numeric vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></code> of standard errors of <code>f</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string indicating how the “optimal”
number of clusters, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>k</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9579em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></code>, is computed from the gap
statistics (and their standard deviations), or more generally how
the location <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>k</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9579em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></code> of the maximum of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">f_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>
should be determined.
</p>


<dl>
<dt>
<code>"globalmax"</code>:</dt>
<dd>
<p>simply corresponds to the global maximum,
i.e., is <code>which.max(f)</code></p>
</dd>
<dt>
<code>"firstmax"</code>:</dt>
<dd>
<p>gives the location of the first <em>local</em>
maximum.</p>
</dd>
<dt>
<code>"Tibs2001SEmax"</code>:</dt>
<dd>
<p>uses the criterion, Tibshirani et
al (2001) proposed: “the smallest <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> such that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>≥</mo><mi>f</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><msub><mi>s</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">f(k)
	    \ge f(k+1) - s_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></code>”.  Note that this chooses <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code>
when all standard deviations are larger than the differences
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(k+1) - f(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></code>.</p>
</dd>
<dt>
<code>"firstSEmax"</code>:</dt>
<dd>
<p>location of the first <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mclose">)</span></span></span></span></code> value
which is not smaller than the first <em>local</em> maximum minus
<code>SE.factor * SE.f[]</code>, i.e, within an “f S.E.” range
of that maximum (see also <code>SE.factor</code>).
</p>
<p>This, the default, has been proposed by Martin Maechler in 2012,
when adding <code>clusGap()</code> to the <span class="pkg">cluster</span> package, after
having seen the <code>"globalSEmax"</code> proposal (in code) and read
the <code>"Tibs2001SEmax"</code> proposal.</p>
</dd>
<dt>
<code>"globalSEmax"</code>:</dt>
<dd>
<p>(used in Dudoit and Fridlyand (2002),
supposedly following Tibshirani's proposition):
location of the first <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mclose">)</span></span></span></span></code> value which is not smaller than
the <em>global</em> maximum minus <code>SE.factor * SE.f[]</code>, i.e,
within an “f S.E.” range of that maximum (see also
<code>SE.factor</code>).</p>
</dd>
</dl>
<p>See the examples for a comparison in a simple case.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE.factor</code></td>
<td>
<p>[When <code>method</code> contains <code>"SE"</code>] Determining
the optimal number of clusters, Tibshirani et al. proposed the
“1 S.E.”-rule.  Using an <code>SE.factor</code> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></code>, the
“f S.E.”-rule is used, more generally.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>type, xlab, ylab, main</code></td>
<td>
<p>arguments with the same meaning as in
<code><a href="https://r-universe.dev/manuals/graphics.html#plot.default">plot.default</a>()</code>, with different default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.arrows</code></td>
<td>
<p>logical indicating if (1 SE -)“error bars”
should be drawn, via <code><a href="https://r-universe.dev/manuals/graphics.html#arrows">arrows</a>()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrowArgs</code></td>
<td>
<p>a list of arguments passed to <code><a href="https://r-universe.dev/manuals/graphics.html#arrows">arrows</a>()</code>;
the default, notably <code>angle</code> and <code>code</code>, provide a style
matching usual error bars.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main result <code>&lt;res&gt;$Tab[,"gap"]</code> of course is from
bootstrapping aka Monte Carlo simulation and hence random, or
equivalently, depending on the initial random seed (see
<code><a href="https://r-universe.dev/manuals/base.html#Random">set.seed</a>()</code>).
On the other hand, in our experience, using <code>B = 500</code> gives
quite precise results such that the gap plot is basically unchanged
after an another run.
</p>


<h3>Value</h3>

<p><code>clusGap(..)</code> returns an object of S3 class <code>"clusGap"</code>,
basically a list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Tab</code></td>
<td>
<p>a matrix with <code>K.max</code> rows and 4 columns, named
"logW", "E.logW", "gap", and "SE.sim",
where <code>gap = E.logW - logW</code>, and <code>SE.sim</code> corresponds to
the standard error of <code>gap</code>, <code>SE.sim[k]=</code><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code>,
where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>k</mi></msub><mo>:</mo><mo>=</mo><msqrt><mrow><mn>1</mn><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>B</mi></mrow></msqrt><mi>s</mi><msup><mi>d</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mi>g</mi><mi>a</mi><msub><mi>p</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s_k := \sqrt{1 + 1/B} sd^*(gap_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.305em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1/</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-2.895em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305em;"><span></span></span></span></span></span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code>, and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><msup><mi>d</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sd^*()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span></span></code> is the standard deviation of the
simulated (“bootstrapped”) gap values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the <code>clusGap(..)</code> <code><a href="https://r-universe.dev/manuals/base.html#call">call</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spaceH0</code></td>
<td>
<p>the <code>spaceH0</code> argument (<code><a href="https://r-universe.dev/manuals/base.html#match.arg">match.arg</a>()</code>ed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations, i.e., <code>nrow(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>input <code>B</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUNcluster</code></td>
<td>
<p>input function <code>FUNcluster</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>This function is originally based on the functions <code>gap</code> of
former (Bioconductor) package <span class="pkg">SAGx</span> by Per Broberg,
<code>gapStat()</code> from former package <span class="pkg">SLmisc</span> by Matthias Kohl
and ideas from <code>gap()</code> and its methods of package <span class="pkg">lga</span> by
Justin Harrington.
</p>
<p>The current implementation is by Martin Maechler.
</p>
<p>The implementation of <code>spaceH0 = "original"</code> is based on code
proposed by Juan Gonzalez.
</p>


<h3>References</h3>

<p>Tibshirani, R., Walther, G. and Hastie, T. (2001).
Estimating the number of data clusters via the Gap statistic.
<em>Journal of the Royal Statistical Society B</em>, <b>63</b>, 411–423.
</p>
<p>Tibshirani, R., Walther, G. and Hastie, T. (2000).
Estimating the number of clusters in a dataset via the Gap statistic.
Technical Report. Stanford.
</p>
<p>Dudoit, S. and Fridlyand, J. (2002)
A prediction-based resampling method for estimating the number of clusters in a
dataset. <em>Genome Biology</em> <b>3</b>(7).
<a href="https://doi.org/10.1186/gb-2002-3-7-research0036" target="_blank">doi:10.1186/gb-2002-3-7-research0036</a>
</p>
<p>Per Broberg (2006). SAGx: Statistical Analysis of the GeneChip.
R package version 1.9.7.



<a href="http://bioconductor.org/packages/3.12/bioc/html/SAGx.html" target="_blank">http://bioconductor.org/packages/3.12/bioc/html/SAGx.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#silhouette">silhouette</a></code> for a much simpler less sophisticated
goodness of clustering measure.
</p>
<p><code><a>cluster.stats</a>()</code> in package <span class="pkg">fpc</span> for
alternative measures.
</p>



<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">### --- maxSE() methods -------------------------------------------</span><span class="token punctuation">(</span>mets <span class="token operator">&lt;-</span> eval<span class="token punctuation">(</span>formals<span class="token punctuation">(</span>maxSE<span class="token punctuation">)</span><span class="token operator">$</span>method<span class="token punctuation">)</span><span class="token punctuation">)</span>
fk <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
sk <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
<span class="token comment">## use plot.clusGap():</span>
plot<span class="token punctuation">(</span>structure<span class="token punctuation">(</span>class<span class="token operator">=</span><span class="token string">"clusGap"</span><span class="token punctuation">,</span> list<span class="token punctuation">(</span>Tab <span class="token operator">=</span> cbind<span class="token punctuation">(</span>gap<span class="token operator">=</span>fk<span class="token punctuation">,</span> SE.sim<span class="token operator">=</span>sk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## Note that 'firstmax' and 'globalmax' are always at 3 and 6 :</span>
sapply<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>SEf<span class="token punctuation">)</span>
        sapply<span class="token punctuation">(</span>mets<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span> maxSE<span class="token punctuation">(</span>fk<span class="token punctuation">,</span> sk<span class="token punctuation">,</span> method <span class="token operator">=</span> M<span class="token punctuation">,</span> SE.factor <span class="token operator">=</span> SEf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">### --- clusGap() -------------------------------------------------</span>
<span class="token comment">## ridiculously nicely separated clusters in 3 D :</span>
x <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span>           sd <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> mean <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> sd <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> mean <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> sd <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> mean <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> sd <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Slightly faster way to use pam (see below)</span>
pam1 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>k<span class="token punctuation">)</span> list<span class="token punctuation">(</span>cluster <span class="token operator">=</span> pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span>k<span class="token punctuation">,</span> cluster.only<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## We do not recommend using hier.clustering here, but if you want,</span>
<span class="token comment">## there is  factoextra::hcut () or a cheap version of it</span>
hclusCut <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> k<span class="token punctuation">,</span> d.meth <span class="token operator">=</span> <span class="token string">"euclidean"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
   list<span class="token punctuation">(</span>cluster <span class="token operator">=</span> cutree<span class="token punctuation">(</span>hclust<span class="token punctuation">(</span>dist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> method<span class="token operator">=</span>d.meth<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token punctuation">,</span> k<span class="token operator">=</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## You can manually set it before running this :    doExtras &lt;- TRUE  # or  FALSE</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>exists<span class="token punctuation">(</span><span class="token string">"doExtras"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> is.logical<span class="token punctuation">(</span>doExtras<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  doExtras <span class="token operator">&lt;-</span> cluster<span class="token operator">::</span><span class="token operator">:</span>doExtras<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>doExtras<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">## Note we use  B = 60 in the following examples to keep them "speedy".</span>
  <span class="token comment">## ---- rather keep the default B = 500 for your analysis!</span>

  <span class="token comment">## note we can  pass 'nstart = 20' to kmeans() :</span>
  gskmn <span class="token operator">&lt;-</span> clusGap<span class="token punctuation">(</span>x<span class="token punctuation">,</span> FUN <span class="token operator">=</span> kmeans<span class="token punctuation">,</span> nstart <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> K.max <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> B <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">)</span>
  gskmn <span class="token comment">#-&gt; its print() method</span>
  plot<span class="token punctuation">(</span>gskmn<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"clusGap(., FUN = kmeans, n.start=20, B= 60)"</span><span class="token punctuation">)</span>
  set.seed<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> system.time<span class="token punctuation">(</span>
    gsPam0 <span class="token operator">&lt;-</span> clusGap<span class="token punctuation">(</span>x<span class="token punctuation">,</span> FUN <span class="token operator">=</span> pam<span class="token punctuation">,</span> K.max <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> B <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  set.seed<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> system.time<span class="token punctuation">(</span>
    gsPam1 <span class="token operator">&lt;-</span> clusGap<span class="token punctuation">(</span>x<span class="token punctuation">,</span> FUN <span class="token operator">=</span> pam1<span class="token punctuation">,</span> K.max <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> B <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token comment">## and show that it gives the "same":</span>
  not.eq <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"call"</span><span class="token punctuation">,</span> <span class="token string">"FUNcluster"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> n <span class="token operator">&lt;-</span> names<span class="token punctuation">(</span>gsPam0<span class="token punctuation">)</span>
  eq <span class="token operator">&lt;-</span> n<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">(</span>n <span class="token percent-operator operator">%in%</span> not.eq<span class="token punctuation">)</span><span class="token punctuation">]</span>
  stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>gsPam1<span class="token punctuation">[</span>eq<span class="token punctuation">]</span><span class="token punctuation">,</span> gsPam0<span class="token punctuation">[</span>eq<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  print<span class="token punctuation">(</span>gsPam1<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"globalSEmax"</span><span class="token punctuation">)</span>
  print<span class="token punctuation">(</span>gsPam1<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"globalmax"</span><span class="token punctuation">)</span>

  print<span class="token punctuation">(</span>gsHc <span class="token operator">&lt;-</span> clusGap<span class="token punctuation">(</span>x<span class="token punctuation">,</span> FUN <span class="token operator">=</span> hclusCut<span class="token punctuation">,</span> K.max <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> B <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token comment"># end {doExtras}</span>

gs.pam.RU <span class="token operator">&lt;-</span> clusGap<span class="token punctuation">(</span>ruspini<span class="token punctuation">,</span> FUN <span class="token operator">=</span> pam1<span class="token punctuation">,</span> K.max <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> B <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">)</span>
gs.pam.RU
plot<span class="token punctuation">(</span>gs.pam.RU<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Gap statistic for the 'ruspini' data"</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"k = 4 is best .. and  k = 5  pretty close"</span><span class="token punctuation">)</span>

<span class="token comment">## This takes a minute..</span>
<span class="token comment">## No clustering ==&gt; k = 1 ("one cluster") should be optimal:</span>
Z <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">256</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
gsP.Z <span class="token operator">&lt;-</span> clusGap<span class="token punctuation">(</span>Z<span class="token punctuation">,</span> FUN <span class="token operator">=</span> pam1<span class="token punctuation">,</span> K.max <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> B <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>gsP.Z<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"clusGap(&lt;iid_rnorm_p=3&gt;)  ==&gt; k = 1  cluster is optimal"</span><span class="token punctuation">)</span>
gsP.Z</code></pre>

<hr>
</div>
<div class="container manual-page" id="clusplot.partition">

<a href="#clusplot.partition" class="help-page-title"><h2>Bivariate Cluster Plot (of a Partitioning Object)</h2></a>

<h3>Description</h3>

<p>Draws a 2-dimensional “clusplot” (clustering plot) on the
current graphics device.
The generic function has a default and a <code>partition</code> method.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">clusplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'partition'</span>
clusplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> dist <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object, here, specifically an object of class
<code>"partition"</code>, e.g. created by one of the functions
<code><a href="#pam">pam</a></code>, <code><a href="#clara">clara</a></code>, or <code><a href="#fanny">fanny</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title for the plot; when <code>NULL</code> (by default), a title
is constructed, using <code>x$call</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>when <code>x</code> does not have a <code>diss</code> nor a
<code>data</code> component, e.g., for <code><a href="#pam">pam</a>(dist(*),
      keep.diss=FALSE)</code>, <code>dist</code> must specify the dissimilarity for the
clusplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to methods, notably the
<code><a href="#clusplot.default">clusplot.default</a></code> method (except for the <code>diss</code>
one) may also be supplied to this function.  Many graphical parameters
(see <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>) may also be supplied as arguments here.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>clusplot.partition()</code> method relies on <code><a href="#clusplot.default">clusplot.default</a></code>.
</p>
<p>If the clustering algorithms <code>pam</code>, <code>fanny</code> and <code>clara</code>
are applied to a data matrix of observations-by-variables then a
clusplot of the resulting clustering can always be drawn.  When the
data matrix contains missing values and the clustering is performed
with <code><a href="#pam">pam</a></code> or <code><a href="#fanny">fanny</a></code>, the dissimilarity
matrix will be given as input to <code>clusplot</code>.  When the clustering
algorithm <code><a href="#clara">clara</a></code> was applied to a data matrix with <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s
then <code>clusplot()</code> will replace the missing values as described in
<code><a href="#clusplot.default">clusplot.default</a></code>, because a dissimilarity matrix is not
available.
</p>


<h3>Value</h3>

<p>For the <code>partition</code> (and <code>default</code>) method: An invisible
list with components <code>Distances</code> and <code>Shading</code>, as for
<code><a href="#clusplot.default">clusplot.default</a></code>, see there.
</p>


<h3>Side Effects</h3>

<p>a 2-dimensional clusplot is created on the current graphics device.
</p>


<h3>See Also</h3>

<p><code><a href="#clusplot.default">clusplot.default</a></code> for references;
<code><a href="#partition.object">partition.object</a></code>, <code><a href="#pam">pam</a></code>,
<code><a href="#pam.object">pam.object</a></code>, <code><a href="#clara">clara</a></code>,
<code><a href="#clara.object">clara.object</a></code>, <code><a href="#fanny">fanny</a></code>,
<code><a href="#fanny.object">fanny.object</a></code>, <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## For more, see ?clusplot.default</span><span class="token comment">## generate 25 objects, divided into 2 clusters.</span>
x <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
clusplot<span class="token punctuation">(</span>pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## add noise, and try again :</span>
x4 <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>x<span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
clusplot<span class="token punctuation">(</span>pam<span class="token punctuation">(</span>x4<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="clusplot.default">

<a href="#clusplot.default" class="help-page-title"><h2>Bivariate Cluster Plot (clusplot) Default Method</h2></a>

<h3>Description</h3>

<p>Creates a bivariate plot visualizing a partition (clustering) of the data. All
observation are represented by points in the plot, using principal
components or multidimensional scaling. Around each cluster an ellipse
is drawn.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Default S3 method:</span>
clusplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> clus<span class="token punctuation">,</span> diss <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
          s.x.<span class="token number">2</span>d <span class="token operator">=</span> mkCheckX<span class="token punctuation">(</span>x<span class="token punctuation">,</span> diss<span class="token punctuation">)</span><span class="token punctuation">,</span> stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
          lines <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> shade <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
          labels<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> plotchar <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
          col.p <span class="token operator">=</span> <span class="token string">"dark green"</span><span class="token punctuation">,</span> col.txt <span class="token operator">=</span> col.p<span class="token punctuation">,</span>
          col.clus <span class="token operator">=</span> <span class="token keyword">if</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token number">5</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> cex.txt <span class="token operator">=</span> cex<span class="token punctuation">,</span>
          span <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
          add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
          xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          main <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"CLUSPLOT("</span><span class="token punctuation">,</span> deparse1<span class="token punctuation">(</span>substitute<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          sub <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"These two components explain"</span><span class="token punctuation">,</span>
             round<span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> var.dec<span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"% of the point variability."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          xlab <span class="token operator">=</span> <span class="token string">"Component 1"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Component 2"</span><span class="token punctuation">,</span>
          verbose <span class="token operator">=</span> getOption<span class="token punctuation">(</span><span class="token string">"verbose"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix or data frame, or dissimilarity matrix, depending on
the value of the <code>diss</code> argument.
</p>
<p>In case of a matrix (alike), each row corresponds to an observation,
and each column corresponds to a variable.  All variables must be
numeric.  Missing values (<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s) are allowed.  They are
replaced by the median of the corresponding variable.  When some
variables or some observations contain only missing values, the
function stops with a warning message.
</p>
<p>In case of a dissimilarity matrix, <code>x</code> is the output of
<code><a href="#daisy">daisy</a></code> or <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code> or a symmetric matrix.  Also,
a vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n*(n-1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code> is allowed (where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> is the
number of observations), and will be interpreted in the same way as
the output of the above-mentioned functions.  Missing values (NAs)
are not allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clus</code></td>
<td>

<p>a vector of length n representing a clustering of <code>x</code>.  For
each observation the vector lists the number or name of the cluster
to which it has been assigned. <code>clus</code> is often the clustering
component of the output of <code><a href="#pam">pam</a></code>, <code><a href="#fanny">fanny</a></code> or
<code><a href="#clara">clara</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>

<p>logical indicating if <code>x</code> will be considered as a dissimilarity
matrix or a matrix of observations by variables (see <code>x</code>
arugment above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.x.2d</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> with components named <code>x</code> (a <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n
      \times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code> matrix; typically something like principal components of
original data), <code>labs</code> and <code>var.dec</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>

<p>logical flag: if true, then the representations of the n observations in the
2-dimensional plot are standardized.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lines</code></td>
<td>

<p>integer out of <code>0, 1, 2</code>, used to obtain an idea of the
distances between ellipses.  The distance between two ellipses E1
and E2 is measured along the line connecting the centers <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">m1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">m</span><span class="mord">1</span></span></span></span></code>
and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">m2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">m</span><span class="mord">2</span></span></span></span></code> of the two ellipses.
</p>
<p>In case E1 and E2 overlap on the line through <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">m1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">m</span><span class="mord">1</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">m2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">m</span><span class="mord">2</span></span></span></span></code>,
no line is drawn.  Otherwise, the result depends on the value of
<code>lines</code>: If
</p>

<dl>
<dt>lines = 0,</dt>
<dd>
<p>no distance lines will appear on the plot;</p>
</dd>
<dt>lines = 1,</dt>
<dd>
<p>the line segment between <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">m1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">m</span><span class="mord">1</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">m2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">m</span><span class="mord">2</span></span></span></span></code> is drawn;</p>
</dd>
<dt>lines = 2,</dt>
<dd>
<p>a line segment between the boundaries of E1 and
E2 is drawn (along the line connecting <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">m1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">m</span><span class="mord">1</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">m2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">m</span><span class="mord">2</span></span></span></span></code>).</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>

<p>logical flag: if TRUE, then the ellipses are shaded in relation to their
density. The density is the number of points in the cluster divided by the
area of the ellipse.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>

<p>logical flag: if TRUE, then the ellipses are colored with respect to their
density. With increasing density, the colors are light blue, light
green, red and purple.  To see these colors on the graphics device, an
appropriate color scheme should be selected (we recommend a white
background).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>integer code, currently one of 0,1,2,3,4 and 5.  If
</p>

<dl>
<dt>labels= 0,</dt>
<dd>
<p>no labels are placed in the plot;</p>
</dd>
<dt>labels= 1,</dt>
<dd>
<p>points and ellipses can be identified in the plot (see
<code><a href="https://r-universe.dev/manuals/graphics.html#identify">identify</a></code>);</p>
</dd>
<dt>labels= 2,</dt>
<dd>
<p>all points and ellipses are labelled in the plot;</p>
</dd>
<dt>labels= 3,</dt>
<dd>
<p>only the points are labelled in the plot;</p>
</dd>
<dt>labels= 4,</dt>
<dd>
<p>only the ellipses are labelled in the plot.</p>
</dd>
<dt>labels= 5,</dt>
<dd>
<p>the ellipses are labelled in the plot, and
points can be identified.</p>
</dd>
</dl>
<p>The levels of the vector <code>clus</code> are taken as labels for the
clusters.  The labels
of the points are the rownames of <code>x</code> if <code>x</code> is matrix like.
Otherwise (<code>diss = TRUE</code>), <code>x</code> is a vector, point labels
can be attached to <code>x</code> as a "Labels" attribute
(<code>attr(x,"Labels")</code>), as is done for the output of
<code><a href="#daisy">daisy</a></code>.
</p>
<p>A possible <code><a href="https://r-universe.dev/manuals/base.html#names">names</a></code> attribute of <code>clus</code> will not
be taken into account.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotchar</code></td>
<td>

<p>logical flag: if TRUE, then the plotting symbols differ for points belonging
to different clusters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>

<p>logical flag: if TRUE, then each cluster is represented by the ellipse with
smallest area containing all its points. (This is a special case of the
minimum volume ellipsoid.)<br>
If FALSE, the ellipse is based on the mean and covariance matrix of the
same points.  While this is faster to compute, it often yields a much
larger ellipse.
</p>
<p>There are also some special cases:  When a cluster consists of only
one point, a tiny circle is drawn around it.  When the points of a
cluster fall on a straight line, <code>span=FALSE</code> draws a narrow
ellipse around it and <code>span=TRUE</code> gives the exact line segment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical indicating if ellipses (and labels if <code>labels</code>
is true) should be <em>added</em> to an already existing plot.  If
false, neither a <code><a href="https://r-universe.dev/manuals/graphics.html#title">title</a></code> or sub title, see <code>sub</code>,
is written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.p</code></td>
<td>
<p>color code(s) used for the observation points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.txt</code></td>
<td>
<p>color code(s) used for the labels (if <code>labels &gt;= 2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.clus</code></td>
<td>
<p>color code for the ellipses (and their labels);
only one if color is false (as per default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex, cex.txt</code></td>
<td>
<p>character <b>ex</b>pansion (size), for the point
symbols and point labels, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x- and y-
ranges as in <code><a href="https://r-universe.dev/manuals/graphics.html#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title for the plot; by default, one is constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>sub title for the plot; by default, one is constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>x- and y- axis labels for the plot, with defaults.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical indicating, if there should be extra
diagnostic output; mainly for ‘debugging’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further graphical parameters may also be supplied, see
<code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>clusplot</code> uses function calls
<code><a href="https://r-universe.dev/manuals/stats.html#princomp">princomp</a>(*, cor = (ncol(x) &gt; 2))</code> or
<code><a href="https://r-universe.dev/manuals/stats.html#cmdscale">cmdscale</a>(*, add=TRUE)</code>, respectively, depending on
<code>diss</code> being false or true.  These functions are data reduction
techniques to represent the data in a bivariate plot.
</p>
<p>Ellipses are then drawn to indicate the clusters.  The further layout of the
plot is determined by the optional arguments.
</p>


<h3>Value</h3>

<p>An invisible list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Distances</code></td>
<td>

<p>When <code>lines</code> is 1 or 2 we optain a k by k matrix (k is the number of
clusters).  The element in <code>[i,j]</code> is the distance between ellipse
i and ellipse j.<br>
If <code>lines = 0</code>, then the value of this component is <code>NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Shading</code></td>
<td>

<p>A vector of length k (where k is the number of clusters), containing the
amount of shading per cluster. Let y be a vector where element i is the
ratio between the number of points in cluster i and the area of ellipse i.
When the cluster i is a line segment, y[i] and the density of the cluster are
set to <code>NA</code>. Let z be the sum of all the elements of y without the NAs.
Then we put shading = y/z *37 + 3 .
</p>
</td>
</tr>
</table>
<h3>Side Effects</h3>

<p>a visual display of the clustering is plotted on the current graphics device.
</p>


<h3>Note</h3>

<p>When we have 4 or fewer clusters, then the <code>color=TRUE</code> gives
every cluster a different color.  When there are more than 4 clusters,
clusplot uses the function <code><a href="#pam">pam</a></code> to cluster the
densities into 4 groups such that ellipses with nearly the same
density get the same color.  <code>col.clus</code> specifies the colors used.
</p>
<p>The <code>col.p</code> and <code>col.txt</code> arguments, added for <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>,
are recycled to have length the number of observations.
If <code>col.p</code> has more than one value, using <code>color = TRUE</code> can
be confusing because of a mix of point and ellipse colors.
</p>


<h3>References</h3>

<p>Pison, G., Struyf, A. and Rousseeuw, P.J. (1999)
Displaying a Clustering with CLUSPLOT,
<em>Computational Statistics and Data Analysis</em>, <b>30</b>, 381–392.<br></p>
<p>Kaufman, L. and Rousseeuw, P.J. (1990).
<em>Finding Groups in Data: An Introduction to Cluster Analysis.</em>
Wiley, New York.
</p>
<p>Struyf, A., Hubert, M. and Rousseeuw, P.J. (1997).
Integrating Robust Clustering Techniques in S-PLUS,
<em>Computational Statistics and Data Analysis</em>, <b>26</b>, 17-37.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#princomp">princomp</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#cmdscale">cmdscale</a></code>, <code><a href="#pam">pam</a></code>,
<code><a href="#clara">clara</a></code>, <code><a href="#daisy">daisy</a></code>, <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>,
<code><a href="https://r-universe.dev/manuals/graphics.html#identify">identify</a></code>, <code><a href="https://r-universe.dev/manuals/MASS.html#cov.mve">cov.mve</a></code>,
<code><a href="#clusplot.partition">clusplot.partition</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## plotting votes.diss(dissimilarity) in a bivariate plot and</span><span class="token comment">## partitioning into 2 clusters</span>
data<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span>
votes.diss <span class="token operator">&lt;-</span> daisy<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span>
pamv <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>votes.diss<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> diss <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
clusplot<span class="token punctuation">(</span>pamv<span class="token punctuation">,</span> shade <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment">## is the same as</span>
votes.clus <span class="token operator">&lt;-</span> pamv<span class="token operator">$</span>clustering
clusplot<span class="token punctuation">(</span>votes.diss<span class="token punctuation">,</span> votes.clus<span class="token punctuation">,</span> diss <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> shade <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment">## Now look at components 3 and 2 instead of 1 and 2:</span>
str<span class="token punctuation">(</span>cMDS <span class="token operator">&lt;-</span> cmdscale<span class="token punctuation">(</span>votes.diss<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> add<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
clusplot<span class="token punctuation">(</span>pamv<span class="token punctuation">,</span> s.x.<span class="token number">2</span>d <span class="token operator">=</span> list<span class="token punctuation">(</span>x<span class="token operator">=</span>cMDS<span class="token operator">$</span>points<span class="token punctuation">[</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                             labs<span class="token operator">=</span>rownames<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span><span class="token punctuation">,</span> var.dec<span class="token operator">=</span><span class="token keyword">NA</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         shade <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col.p <span class="token operator">=</span> votes.clus<span class="token punctuation">,</span>
         sub<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Component 3"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Component 2"</span><span class="token punctuation">)</span>

clusplot<span class="token punctuation">(</span>pamv<span class="token punctuation">,</span> col.p <span class="token operator">=</span> votes.clus<span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token comment"># color points and label ellipses</span>
<span class="token comment"># "simple" cheap ellipses: larger than minimum volume:</span>
<span class="token comment"># here they are *added* to the previous plot:</span>
clusplot<span class="token punctuation">(</span>pamv<span class="token punctuation">,</span> span <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col.clus <span class="token operator">=</span> <span class="token string">"midnightblue"</span><span class="token punctuation">)</span>

<span class="token comment">## Setting a small *label* size:</span>
clusplot<span class="token punctuation">(</span>votes.diss<span class="token punctuation">,</span> votes.clus<span class="token punctuation">,</span> diss <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> cex.txt <span class="token operator">=</span> <span class="token number">0.6</span><span class="token punctuation">)</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>dev.interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">#  uses identify() *interactively* :</span>
  clusplot<span class="token punctuation">(</span>votes.diss<span class="token punctuation">,</span> votes.clus<span class="token punctuation">,</span> diss <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> shade <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
  clusplot<span class="token punctuation">(</span>votes.diss<span class="token punctuation">,</span> votes.clus<span class="token punctuation">,</span> diss <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token comment"># ident. only points</span>
<span class="token punctuation">}</span>

<span class="token comment">## plotting iris (data frame) in a 2-dimensional plot and partitioning</span>
<span class="token comment">## into 3 clusters.</span>
data<span class="token punctuation">(</span>iris<span class="token punctuation">)</span>
iris.x <span class="token operator">&lt;-</span> iris<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span>
cl3 <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>iris.x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">$</span>clustering
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
clusplot<span class="token punctuation">(</span>iris.x<span class="token punctuation">,</span> cl3<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
U <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span><span class="token string">"usr"</span><span class="token punctuation">)</span>
<span class="token comment">## zoom in :</span>
rect<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"orange"</span><span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
clusplot<span class="token punctuation">(</span>iris.x<span class="token punctuation">,</span> cl3<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
box<span class="token punctuation">(</span>col<span class="token operator">=</span><span class="token string">"orange"</span><span class="token punctuation">,</span>lwd<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> mtext<span class="token punctuation">(</span><span class="token string">"sub region"</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">##  or zoom out :</span>
clusplot<span class="token punctuation">(</span>iris.x<span class="token punctuation">,</span> cl3<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"'super' region"</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
rect<span class="token punctuation">(</span>U<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>U<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> U<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>U<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># reset graphics</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="cluster-internal">

<a href="#cluster-internal" class="help-page-title"><h2>Internal cluster functions</h2></a>

<h3>Description</h3>

<p>Internal cluster functions.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">meanabsdev<span class="token punctuation">(</span>y<span class="token punctuation">)</span></code></pre>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>

<hr>
</div>
<div class="container manual-page" id="coef.hclust">

<a href="#coef.hclust" class="help-page-title"><h2>Agglomerative / Divisive Coefficient for 'hclust' Objects</h2></a>

<h3>Description</h3>

<p>Computes the “agglomerative coefficient” (aka “divisive
coefficient” for <code><a href="#diana">diana</a></code>), measuring the
clustering structure of the dataset.
</p>
<p>For each observation i, denote by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code> its dissimilarity to the
first cluster it is merged with, divided by the dissimilarity of the
merger in the final step of the algorithm.  The agglomerative
coefficient is the average of all <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>m</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1 - m(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code>.  It can also be seen
as the average width (or the percentage filled) of the banner plot.
</p>
<p><code>coefHier()</code> directly interfaces to the underlying C code, and
“proves” that <em>only</em> <code>object$heights</code> is needed to
compute the coefficient.
</p>
<p>Because it grows with the number of observations, this measure should not
be used to compare datasets of very different sizes.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">coefHier<span class="token punctuation">(</span>object<span class="token punctuation">)</span>
coef.hclust<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'hclust'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'twins'</span>
coef<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>"hclust"</code> or <code>"twins"</code>,
i.e., typically the result of
<code><a href="https://r-universe.dev/manuals/stats.html#hclust">hclust</a>(.)</code>,<code><a href="#agnes">agnes</a>(.)</code>, or <code><a href="#diana">diana</a>(.)</code>.
</p>
<p>Since <code>coef.hclust</code> only uses <code>object$heights</code>, and
<code>object$merge</code>, <code>object</code> can be any list-like object with
appropriate <code>merge</code> and <code>heights</code> components.
</p>
<p>For <code>coefHier</code>, even only <code>object$heights</code> is needed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently unused potential further arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a number specifying the <em>agglomerative</em> (or <em>divisive</em> for
<code>diana</code> objects) coefficient as defined by Kaufman and Rousseeuw,
see <code><a href="#agnes.object">agnes.object</a> $ ac</code> or <code><a href="#diana">diana.object</a> $ dc</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>
aa <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>aa<span class="token punctuation">)</span> <span class="token comment"># really just extracts aa$ac</span>
coef<span class="token punctuation">(</span>as.hclust<span class="token punctuation">(</span>aa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># recomputes</span>
coefHier<span class="token punctuation">(</span>aa<span class="token punctuation">)</span>       <span class="token comment"># ditto</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="daisy">

<a href="#daisy" class="help-page-title"><h2>Dissimilarity Matrix Calculation</h2></a>

<h3>Description</h3>

<p>Compute all the pairwise dissimilarities (distances) between observations
in the data set.  The original variables may be of mixed types.  In
that case, or whenever <code>metric = "gower"</code> is set, a
generalization of Gower's formula is used, see ‘Details’
below.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">daisy<span class="token punctuation">(</span>x<span class="token punctuation">,</span> metric <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"euclidean"</span><span class="token punctuation">,</span> <span class="token string">"manhattan"</span><span class="token punctuation">,</span> <span class="token string">"gower"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> type <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights <span class="token operator">=</span> rep.int<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">,</span>
      warnBin <span class="token operator">=</span> warnType<span class="token punctuation">,</span> warnAsym <span class="token operator">=</span> warnType<span class="token punctuation">,</span> warnConst <span class="token operator">=</span> warnType<span class="token punctuation">,</span>
      warnType <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric matrix or data frame, of dimension <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n\times p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code>,
say.  Dissimilarities will be computed
between the rows of <code>x</code>.  Columns of mode <code>numeric</code>
(i.e. all columns when <code>x</code> is a matrix) will be recognized as
interval scaled variables, columns of class <code>factor</code> will be
recognized as nominal variables, and columns of class <code>ordered</code>
will be recognized as ordinal variables.  Other variable types
should be specified with the <code>type</code> argument.  Missing values
(<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s) are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>

<p>character string specifying the metric to be used.
The currently available options are <code>"euclidean"</code> (the default),
<code>"manhattan"</code> and <code>"gower"</code>.<br>
Euclidean distances are root sum-of-squares of differences, and
manhattan distances are the sum of absolute differences.
</p>
<p>“Gower's distance” is chosen by metric <code>"gower"</code>
or automatically if some columns of <code>x</code> are not numeric. Also
known as Gower's coefficient (1971),
expressed as a dissimilarity, this implies that a particular
standardisation will be applied to each variable, and the
“distance” between two units is the sum of all the
variable-specific distances, see the details section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>logical flag: if TRUE, then the measurements in <code>x</code>
are standardized before calculating the
dissimilarities.  Measurements are standardized for each variable
(column), by subtracting the variable's mean value and dividing by
the variable's mean absolute deviation.
</p>
<p>If not all columns of <code>x</code> are numeric, <code>stand</code> will
be ignored and Gower's standardization (based on the
<code><a href="https://r-universe.dev/manuals/base.html#range">range</a></code>) will be applied in any case, see argument
<code>metric</code>, above, and the details section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>list for specifying some (or all) of the types of the
variables (columns) in <code>x</code>.  The list may contain the following
components:
</p>

<dl>
<dt>
<code>"asymm"</code>  </dt>
<dd>
<p><b>A</b>symmetric binary variable, aka
<code>"A"</code> in result <code>Types</code>, see <code><a href="#dissimilarity.object">dissimilarity.object</a></code>.</p>
</dd>
<dt>
<code>"symm"</code>   </dt>
<dd>
<p><b>S</b>ymmetric  binary variable, aka <code>"S"</code>.</p>
</dd>
<dt>
<code>"factor"</code> </dt>
<dd>
<p><b>N</b>ominal – the default for <code><a href="https://r-universe.dev/manuals/base.html#factor">factor</a></code>
variables, aka <code>"N"</code>.</p>
</dd>
<dt><code>"ordered"</code></dt>
<dd>
<p><b>O</b>rdinal – the default for <code><a href="https://r-universe.dev/manuals/base.html#factor">ordered</a></code>
(factor) variables, aka <code>"O"</code>, see <code><a href="#dissimilarity.object">dissimilarity.object</a></code>.</p>
</dd>
<dt><code>"logratio"</code></dt>
<dd>
<p>ratio scaled numeric variables that are to
be logarithmically transformed (<code><a href="https://r-universe.dev/manuals/base.html#Log">log10</a></code>) and then
treated as numeric (<code>"I"</code>): must be <em>positive</em> numeric variable.</p>
</dd>
<dt><code>"ordratio"</code></dt>
<dd>
<p>“ra<b>T</b>io”-like
variable to be treated as <code><a href="https://r-universe.dev/manuals/base.html#factor">ordered</a></code> (using the factor
codes <code>unclass(<a href="https://r-universe.dev/manuals/base.html#factor">as.ordered</a>(x[,j]))</code>), aka <code>"T"</code>.</p>
</dd>
<dt>
<code>"numeric"</code>/<code>"integer"</code>
</dt>
<dd>
<p><b>I</b>nterval
scaled – the <b>default</b> for all numeric (incl <code>integer</code>)
columns of <code>x</code>, aka <code>"I"</code> in result <code>Types</code>, see
<code><a href="#dissimilarity.object">dissimilarity.object</a></code>.</p>
</dd>
</dl>
<p>Each component is a (character or numeric) vector, containing either
the names or the numbers of the corresponding columns of <code>x</code>.
</p>
<p>Variables not mentioned in <code>type</code> are interpreted as usual, see
argument <code>x</code>, and also ‘default’ above.  Consequently,
the default <code>type = list()</code> may often be sufficient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional numeric vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code>(=<code>ncol(x)</code>); to
be used in “case 2” (mixed variables, or <code>metric = "gower"</code>),
specifying a weight for each variable (<code>x[,k]</code>) instead of
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> in Gower's original formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnBin, warnAsym, warnConst</code></td>
<td>
<p>logicals indicating if the
corresponding type checking warnings should be signalled (when found).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnType</code></td>
<td>
<p>logical indicating if <em>all</em> the type checking
warnings should be active or not.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The original version of <code>daisy</code> is fully described in chapter 1
of Kaufman and Rousseeuw (1990).
Compared to <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code> whose input must be numeric
variables, the main feature of <code>daisy</code> is its ability to handle
other variable types as well (e.g. nominal, ordinal, (a)symmetric
binary) even when different types occur in the same data set.
</p>
<p>The handling of nominal, ordinal, and (a)symmetric binary data is
achieved by using the general dissimilarity coefficient of Gower
(1971).  If <code>x</code> contains any columns of these
data-types, both arguments <code>metric</code> and <code>stand</code> will be
ignored and Gower's coefficient will be used as the metric.  This can
also be activated for purely numeric data by <code>metric = "gower"</code>.
With that, each variable (column) is first standardized by dividing
each entry by the range of the corresponding variable, after
subtracting the minimum value; consequently the rescaled variable has
range <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code>, exactly.

</p>
<p>Note that setting the type to <code>symm</code> (symmetric binary) gives the
same dissimilarities as using <em>nominal</em> (which is chosen for
non-ordered factors) only when no missing values are present, and more
efficiently.
</p>
<p>Note that <code>daisy</code> signals a warning when 2-valued numerical
variables do not have an explicit <code>type</code> specified, because the
reference authors recommend to consider using <code>"asymm"</code>; the
warning may be silenced by <code>warnBin = FALSE</code>.
</p>
<p>In the <code>daisy</code> algorithm, missing values in a row of x are not
included in the dissimilarities involving that row.  There are two
main cases,
</p>

<ol>
<li>
<p> If all variables are interval scaled (and <code>metric</code> is
<em>not</em> <code>"gower"</code>), the metric is "euclidean", and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">n_g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> is the number of columns in which
neither row i and j have NAs, then the dissimilarity d(i,j) returned is
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mi>p</mi><mi mathvariant="normal">/</mi><msub><mi>n</mi><mi>g</mi></msub></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{p/n_g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.3231em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9169em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord mathnormal">p</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8769em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3231em;"><span></span></span></span></span></span></span></span></span></code> (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">p=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></code>ncol(x)) times the
Euclidean distance between the two vectors of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">n_g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code>
shortened to exclude NAs.  The rule is similar for the "manhattan"
metric, except that the coefficient is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi mathvariant="normal">/</mi><msub><mi>n</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">p/n_g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">p</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code>.  If <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>g</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n_g = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></code>,
the dissimilarity is NA.
</p>
</li>
<li>
<p> When some variables have a type other than interval scaled, or
if <code>metric = "gower"</code> is specified, the
dissimilarity between two rows is the weighted mean of the contributions of
each variable.  Specifically,
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>w</mi><mi>k</mi></msub><msubsup><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>w</mi><mi>k</mi></msub><msubsup><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">d_{ij} = d(i,j) = \frac{\sum_{k=1}^p w_k \delta_{ij}^{(k)} d_{ij}^{(k)}}{
	  \sum_{k=1}^p w_k \delta_{ij}^{(k)}}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2484em;vertical-align:-0.8742em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3742em;"><span style="top:-2.4486em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7912em;"><span style="top:-2.1528em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.9837em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.2134em;margin-left:-0.0379em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4612em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6328em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7912em;"><span style="top:-2.1528em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.9837em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.2134em;margin-left:-0.0379em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4612em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.2134em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4612em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8742em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></code>
</p>

<p>In other words, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> is a weighted mean of
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">d_{ij}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span></span></code> with weights <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub><msubsup><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">w_k \delta_{ij}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span></span></code>,
where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">w_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code><code>= weigths[k]</code>,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\delta_{ij}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span></span></code> is 0 or 1, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">d_{ij}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span></span></code>, the k-th variable contribution to the
total distance, is a distance between <code>x[i,k]</code> and <code>x[j,k]</code>,
see below.
</p>
<p>The 0-1 weight <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\delta_{ij}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span></span></code> becomes zero
when the variable <code>x[,k]</code> is missing in either or both rows
(i and j), or when the variable is asymmetric binary and both
values are zero.  In all other situations it is 1.
</p>
<p>The contribution <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">d_{ij}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span></span></code> of a nominal or binary variable to the total
dissimilarity is 0 if both values are equal, 1 otherwise.
The contribution of other variables is the absolute difference of
both values, divided by the total range of that variable.  Note
that “standard scoring” is applied to ordinal variables,
i.e., they are replaced by their integer codes <code>1:K</code>.  Note
that this is not the same as using their ranks (since there
typically are ties).


</p>
<p>As the individual contributions <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">d_{ij}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span></span></code> are in
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code>, the dissimilarity <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> will remain in
this range.
If all weights <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub><msubsup><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">w_k \delta_{ij}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span></span></code> are zero,
the dissimilarity is set to <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>.
</p>
</li>
</ol>
<h3>Value</h3>

<p>an object of class <code>"dissimilarity"</code> containing the
dissimilarities among the rows of <code>x</code>.  This is typically the
input for the functions <code>pam</code>, <code>fanny</code>, <code>agnes</code> or
<code>diana</code>.  For more details, see <code><a href="#dissimilarity.object">dissimilarity.object</a></code>.
</p>


<h3>Background</h3>

<p>Dissimilarities are used as inputs to cluster analysis and
multidimensional scaling.  The choice of metric may have a
large impact.
</p>


<h3>Author(s)</h3>

<p>Anja Struyf, Mia Hubert, and Peter and Rousseeuw, for the original
version.
<br>
Martin Maechler improved the <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code> handling and
<code>type</code> specification checking, and extended functionality to
<code>metric = "gower"</code> and the optional <code>weights</code> argument.
</p>


<h3>References</h3>

<p>Gower, J. C. (1971)
A general coefficient of similarity and some of its properties,
<em>Biometrics</em> <b>27</b>, 857–874.
</p>
<p>Kaufman, L. and Rousseeuw, P.J. (1990)
<em>Finding Groups in Data: An Introduction to Cluster Analysis</em>.
Wiley, New York.
</p>
<p>Struyf, A., Hubert, M. and Rousseeuw, P.J. (1997)
Integrating Robust Clustering Techniques in S-PLUS,
<em>Computational Statistics and Data Analysis</em> <b>26</b>, 17–37.
</p>


<h3>See Also</h3>

<p><code><a href="#dissimilarity.object">dissimilarity.object</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>,
<code><a href="#pam">pam</a></code>, <code><a href="#fanny">fanny</a></code>, <code><a href="#clara">clara</a></code>,
<code><a href="#agnes">agnes</a></code>, <code><a href="#diana">diana</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>
<span class="token comment">## Example 1 in ref:</span>
<span class="token comment">##  Dissimilarities using Euclidean metric and without standardization</span>
d.agr <span class="token operator">&lt;-</span> daisy<span class="token punctuation">(</span>agriculture<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"euclidean"</span><span class="token punctuation">,</span> stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
d.agr
as.matrix<span class="token punctuation">(</span>d.agr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token string">"DK"</span><span class="token punctuation">]</span> <span class="token comment"># via as.matrix.dist(.)</span>
<span class="token comment">## compare with</span>
as.matrix<span class="token punctuation">(</span>daisy<span class="token punctuation">(</span>agriculture<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"gower"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

data<span class="token punctuation">(</span>flower<span class="token punctuation">)</span>
<span class="token comment">## Example 2 in ref</span>
summary<span class="token punctuation">(</span>dfl1 <span class="token operator">&lt;-</span> daisy<span class="token punctuation">(</span>flower<span class="token punctuation">,</span> type <span class="token operator">=</span> list<span class="token punctuation">(</span>asymm <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>dfl2 <span class="token operator">&lt;-</span> daisy<span class="token punctuation">(</span>flower<span class="token punctuation">,</span> type <span class="token operator">=</span> list<span class="token punctuation">(</span>asymm <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ordratio <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## this failed earlier:</span>
summary<span class="token punctuation">(</span>dfl3 <span class="token operator">&lt;-</span> daisy<span class="token punctuation">(</span>flower<span class="token punctuation">,</span>
        type <span class="token operator">=</span> list<span class="token punctuation">(</span>asymm <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"V1"</span><span class="token punctuation">,</span> <span class="token string">"V3"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> symm<span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    ordratio<span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> logratio<span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="diana">

<a href="#diana" class="help-page-title"><h2>DIvisive ANAlysis Clustering</h2></a>

<h3>Description</h3>

<p>Computes a divisive hierarchical clustering of the dataset
returning an object of class <code>diana</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">diana<span class="token punctuation">(</span>x<span class="token punctuation">,</span> diss <span class="token operator">=</span> inherits<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"euclidean"</span><span class="token punctuation">,</span> stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      stop.at.k <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      keep.diss <span class="token operator">=</span> n <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">,</span> keep.data <span class="token operator">=</span> <span class="token operator">!</span>diss<span class="token punctuation">,</span> trace.lev <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>data matrix or data frame, or dissimilarity matrix or object,
depending on the value of the <code>diss</code> argument.
</p>
<p>In case of a matrix or data frame, each row corresponds to an observation,
and each column corresponds to a variable.  All variables must be numeric.
Missing values (<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s) <em>are</em> allowed.
</p>
<p>In case of a dissimilarity matrix, <code>x</code> is typically the output
of <code><a href="#daisy">daisy</a></code> or <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>.  Also a vector of
length n*(n-1)/2 is allowed (where n is the number of observations),
and will be interpreted in the same way as the output of the
above-mentioned functions. Missing values (NAs) are <em>not</em> allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>

<p>logical flag: if TRUE (default for <code>dist</code> or
<code>dissimilarity</code> objects), then <code>x</code> will be considered as a
dissimilarity matrix.  If FALSE, then <code>x</code> will be considered as
a matrix of observations by variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>

<p>character string specifying the metric to be used for calculating
dissimilarities between observations.<br>
The currently available options are "euclidean" and
"manhattan".  Euclidean distances are root sum-of-squares of
differences, and manhattan distances are the sum of absolute
differences.  If <code>x</code> is already a dissimilarity matrix, then
this argument will be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>logical; if true, the measurements in <code>x</code> are
standardized before calculating the dissimilarities.  Measurements
are standardized for each variable (column), by subtracting the
variable's mean value and dividing by the variable's mean absolute
deviation.  If <code>x</code> is already a dissimilarity matrix, then this
argument will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop.at.k</code></td>
<td>
<p>logical or integer, <code>FALSE</code> by default.
Otherwise must be integer, say <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>, in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{1,2,..,n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">..</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">}</span></span></span></span></code>,
specifying that the <code>diana</code> algorithm should stop early.

Non-default NOT YET IMPLEMENTED.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.diss, keep.data</code></td>
<td>
<p>logicals indicating if the dissimilarities
and/or input data <code>x</code> should be kept in the result.  Setting
these to <code>FALSE</code> can give much smaller results and hence even save
memory allocation <em>time</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.lev</code></td>
<td>
<p>integer specifying a trace level for printing
diagnostics during the algorithm.  Default <code>0</code> does not print
anything; higher values print increasingly more.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>diana</code> is fully described in chapter 6 of Kaufman and Rousseeuw (1990).
It is probably unique in computing a divisive hierarchy, whereas most
other software for hierarchical clustering is agglomerative.
Moreover, <code>diana</code> provides (a) the divisive coefficient
(see <code>diana.object</code>) which measures the amount of clustering structure
found; and (b) the banner, a novel graphical display
(see <code>plot.diana</code>).
</p>
<p>The <code>diana</code>-algorithm constructs a hierarchy of clusterings,
starting with one large
cluster containing all n observations. Clusters are divided until each cluster
contains only a single observation.<br>
At each stage, the cluster with the largest diameter is selected.
(The diameter of a cluster is the largest dissimilarity between any
two of its observations.)<br>
To divide the selected cluster, the algorithm first looks for its most
disparate observation (i.e., which has the largest average dissimilarity to the
other observations of the selected cluster). This observation initiates the
"splinter group". In subsequent steps, the algorithm reassigns observations
that are closer to the "splinter group" than to the "old party". The result
is a division of the selected cluster into two new clusters.
</p>


<h3>Value</h3>

<p>an object of class <code>"diana"</code> representing the clustering;
this class has methods for the following generic functions:
<code>print</code>, <code>summary</code>, <code>plot</code>.
</p>
<p>Further, the class <code>"diana"</code> inherits from
<code>"twins"</code>.  Therefore, the generic function <code><a href="#pltree">pltree</a></code> can be
used on a <code>diana</code> object, and <code><a href="https://r-universe.dev/manuals/stats.html#as.hclust">as.hclust</a></code> and
<code><a href="https://r-universe.dev/manuals/stats.html#dendrogram">as.dendrogram</a></code> methods are available.
</p>
<p>A legitimate <code>diana</code> object is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>

<p>a vector giving a permutation of the original observations to allow for
plotting, in the sense that the branches of a clustering tree will
not cross.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.lab</code></td>
<td>

<p>a vector similar to <code>order</code>, but containing observation labels
instead of observation numbers.  This component is only available if
the original observations were labelled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>a vector with the diameters of the clusters prior to splitting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dc</code></td>
<td>

<p>the divisive coefficient, measuring the clustering structure of the
dataset.  For each observation i, denote by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code> the diameter of the
last cluster to which it belongs (before being split off as a single
observation), divided by the diameter of the whole dataset.  The
<code>dc</code> is the average of all <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1 - d(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code>.  It can also be seen
as the average width (or the percentage filled) of the banner plot.
Because <code>dc</code> grows with the number of observations, this
measure should not be used to compare datasets of very different
sizes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge</code></td>
<td>

<p>an (n-1) by 2 matrix, where n is the number of
observations. Row i of <code>merge</code> describes the split at step n-i of
the clustering. If a number <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></code> in row r is negative, then the single
observation <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>j</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|j|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord">∣</span></span></span></span></code> is split off at stage n-r. If j is positive, then the
cluster that will be splitted at stage n-j (described by row j), is
split off at stage n-r.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>

<p>an object of class <code>"dissimilarity"</code>, representing the total
dissimilarity matrix of the dataset.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a matrix containing the original or standardized measurements, depending
on the <code>stand</code> option of the function <code>agnes</code>.  If a
dissimilarity matrix was given as input structure, then this component
is not available.
</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code> also for background and references;
<code><a href="https://r-universe.dev/manuals/stats.html#cutree">cutree</a></code> (and <code><a href="https://r-universe.dev/manuals/stats.html#as.hclust">as.hclust</a></code>) for grouping
extraction; <code><a href="#daisy">daisy</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>,
<code><a href="#plot.diana">plot.diana</a></code>, <code><a href="#twins.object">twins.object</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span>
dv <span class="token operator">&lt;-</span> diana<span class="token punctuation">(</span>votes.repub<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"manhattan"</span><span class="token punctuation">,</span> stand <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>dv<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>dv<span class="token punctuation">)</span>

<span class="token comment">## Cut into 2 groups:</span>
dv2 <span class="token operator">&lt;-</span> cutree<span class="token punctuation">(</span>as.hclust<span class="token punctuation">(</span>dv<span class="token punctuation">)</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
table<span class="token punctuation">(</span>dv2<span class="token punctuation">)</span> <span class="token comment"># 8 and 42 group members</span>
rownames<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span><span class="token punctuation">[</span>dv2 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span>

<span class="token comment">## For two groups, does the metric matter ?</span>
dv0 <span class="token operator">&lt;-</span> diana<span class="token punctuation">(</span>votes.repub<span class="token punctuation">,</span> stand <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># default: Euclidean</span>
dv.<span class="token number">2</span> <span class="token operator">&lt;-</span> cutree<span class="token punctuation">(</span>as.hclust<span class="token punctuation">(</span>dv0<span class="token punctuation">)</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
table<span class="token punctuation">(</span>dv2 <span class="token operator">==</span> dv.<span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">## identical group assignments</span>

str<span class="token punctuation">(</span>as.dendrogram<span class="token punctuation">(</span>dv0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># {via as.dendrogram.twins() method}</span>

data<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>
<span class="token comment">## Plot similar to Figure 8 in ref</span>
<span class="token comment">## Not run: plot(diana(agriculture), ask = TRUE)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dissimilarity.object">

<a href="#dissimilarity.object" class="help-page-title"><h2>Dissimilarity Matrix Object</h2></a>

<h3>Description</h3>

<p>Objects of class <code>"dissimilarity"</code> representing the dissimilarity
matrix of a dataset.
</p>


<h3>Value</h3>

<p>The dissimilarity matrix is symmetric, and hence its lower triangle
(column wise) is represented as a vector to save storage space.
If the object, is called <code>do</code>, and <code>n</code> the number of
observations, i.e., <code>n &lt;- attr(do, "Size")</code>, then
for <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>&lt;</mo><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i &lt; j &lt;= n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, the dissimilarity between (row) i and j is
<code>do[n*(i-1) - i*(i-1)/2 + j-i]</code>.
The length of the vector is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n*(n-1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code>, i.e., of order <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></code>.
</p>
<p><code>"dissimilarity"</code> objects also inherit from class
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code> and can use <code>dist</code> methods, in
particular, <code><a href="https://r-universe.dev/manuals/base.html#matrix">as.matrix</a></code>, such that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code>
from above is just <code>as.matrix(do)[i,j]</code>.
</p>
<p>The object has the following attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Size</code></td>
<td>
<p>the number of observations in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Metric</code></td>
<td>
<p>the metric used for calculating the
dissimilarities.  Possible values are "euclidean", "manhattan",
"mixed" (if variables of different types were present in the
dataset), and "unspecified".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Labels</code></td>
<td>
<p>optionally, contains the labels, if any, of the
observations of the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NA.message</code></td>
<td>
<p>optionally, if a dissimilarity could not be
computed, because of too many missing values for some observations
of the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Types</code></td>
<td>
<p>when a mixed metric was used, the types for each
variable as one-letter codes, see also <code>type</code> in <code><a href="#daisy">daisy</a>()</code>:

</p>

<dl>
<dt>
<code>A</code>: </dt>
<dd>
<p>Asymmetric binary</p>
</dd>
<dt>
<code>S</code>: </dt>
<dd>
<p>Symmetric  binary</p>
</dd>
<dt>
<code>N</code>: </dt>
<dd>
<p>Nominal (factor)</p>
</dd>
<dt>
<code>O</code>: </dt>
<dd>
<p>Ordinal (ordered factor)</p>
</dd>
<dt>
<code>I</code>: </dt>
<dd>
<p>Interval scaled, possibly after log transform
<code>"logratio"</code> (numeric)</p>
</dd>
<dt>
<code>T</code>: </dt>
<dd>
<p>ra<b>T</b>io treated as <code><a href="https://r-universe.dev/manuals/base.html#factor">ordered</a></code></p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>GENERATION</h3>

<p><code><a href="#daisy">daisy</a></code> returns this class of objects.
Also the functions <code>pam</code>, <code>clara</code>, <code>fanny</code>,
<code>agnes</code>, and <code>diana</code> return a <code>dissimilarity</code> object,
as one component of their return objects.
</p>


<h3>METHODS</h3>

<p>The <code>"dissimilarity"</code> class has methods for the following generic
functions: <code>print</code>, <code>summary</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#daisy">daisy</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>,
<code><a href="#pam">pam</a></code>, <code><a href="#clara">clara</a></code>, <code><a href="#fanny">fanny</a></code>,
<code><a href="#agnes">agnes</a></code>, <code><a href="#diana">diana</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="ellipsoidhull">

<a href="#ellipsoidhull" class="help-page-title"><h2>Compute the Ellipsoid Hull or Spanning Ellipsoid of a Point Set</h2></a>

<h3>Description</h3>

<p>Compute the “ellipsoid hull” or “spanning ellipsoid”, i.e. the
ellipsoid of minimal volume (‘area’ in 2D) such that all given points
lie just inside or on the boundary of the ellipsoid.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">ellipsoidhull<span class="token punctuation">(</span>x<span class="token punctuation">,</span> tol<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> maxit<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">,</span>
              ret.wt <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> ret.sqdist <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> ret.pr <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'ellipsoid'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> digits <span class="token operator">=</span> max<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> getOption<span class="token punctuation">(</span><span class="token string">"digits"</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code>-dimensional points  asnumeric
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n\times p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>convergence tolerance for Titterington's algorithm.
Setting this to much smaller values may drastically increase the number of
iterations needed, and you may want to increas <code>maxit</code> as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>integer giving the maximal number of iteration steps for
the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret.wt, ret.sqdist, ret.pr</code></td>
<td>
<p>logicals indicating if additional
information should be returned, <code>ret.wt</code> specifying the
<em>weights</em>, <code>ret.sqdist</code> the <em><b>sq</b>uared
<b>dist</b>ances</em> and <code>ret.pr</code> the final <b>pr</b>obabilities
in the algorithms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits,...</code></td>
<td>
<p>the usual arguments to <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code> methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The “spanning ellipsoid” algorithm is said to stem from
Titterington(1976), in Pison et al (1999) who use it for
<code><a href="#clusplot.default">clusplot.default</a></code>.<br>
The problem can be seen as a special case of the “Min.Vol.”
ellipsoid of which a more more flexible and general implementation is
<code><a href="https://r-universe.dev/manuals/MASS.html#cov.mve">cov.mve</a></code> in the <code>MASS</code> package.
</p>


<h3>Value</h3>

<p>an object of class <code>"ellipsoid"</code>, basically a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code>
with several components, comprising at least
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">p\times p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code> <em>covariance</em> matrix description
the ellipsoid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code>-dimensional location of the ellipsoid center.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d2</code></td>
<td>
<p>average squared radius.  Further, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mn>2</mn><mo>=</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">d2 = t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></code>, where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></code> is “the value of a t-statistic on the ellipse
boundary” (from <code><a>ellipse</a></code> in the
<a href="https://CRAN.R-project.org/package=ellipse" target="_blank"><span class="pkg">ellipse</span></a> package), and hence, more usefully,
<code>d2 = qchisq(alpha, df = p)</code>, where <code>alpha</code> is the
confidence level for p-variate normally distributed data with
location and covariance <code>loc</code> and <code>cov</code> to lie inside the
ellipsoid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>the vector of weights iff <code>ret.wt</code> was true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqdist</code></td>
<td>
<p>the vector of squared distances iff <code>ret.sqdist</code> was true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>the vector of algorithm probabilities iff <code>ret.pr</code> was true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>
<p>number of iterations used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol, maxit</code></td>
<td>
<p>just the input argument, see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>the achieved tolerance which is the maximal squared radius
minus <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ierr</code></td>
<td>
<p>error code as from the algorithm; <code>0</code> means <em>ok</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>logical indicating if the converged.  This is defined as
<code>it &lt; maxit &amp;&amp; ierr == 0</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Martin Maechler did the present class implementation; Rousseeuw
et al did the underlying original code.</p>


<h3>References</h3>

<p>Pison, G., Struyf, A. and Rousseeuw, P.J. (1999)
Displaying a Clustering with CLUSPLOT,
<em>Computational Statistics and Data Analysis</em>, <b>30</b>, 381–392.<br></p>
<p>D.M. Titterington (1976)
Algorithms for computing D-optimal design on finite design spaces.  In
<em>Proc.\ of the 1976 Conf.\ on Information Science and Systems</em>,
213–216; John Hopkins University.
</p>


<h3>See Also</h3>

<p><code><a href="#predict.ellipsoid">predict.ellipsoid</a></code> which is also the
<code><a href="https://r-universe.dev/manuals/stats.html#predict">predict</a></code> method for <code>ellipsoid</code> objects.
<code><a href="#volume.ellipsoid">volume.ellipsoid</a></code> for an example of ‘manual’
<code>ellipsoid</code> object construction;<br>
further <code><a>ellipse</a></code> from package <a href="https://CRAN.R-project.org/package=ellipse" target="_blank"><span class="pkg">ellipse</span></a>
and <code><a href="https://mmaechler.r-universe.dev/manual/sfsmisc.html#ellipsePoints">ellipsePoints</a></code> from package <a href="https://CRAN.R-project.org/package=sfsmisc" target="_blank"><span class="pkg">sfsmisc</span></a>.
</p>
<p><code><a href="https://r-universe.dev/manuals/grDevices.html#chull">chull</a></code> for the convex hull,
<code><a href="#clusplot.partition">clusplot</a></code> which makes use of this; <code><a href="https://r-universe.dev/manuals/MASS.html#cov.mve">cov.mve</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">x <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
xy <span class="token operator">&lt;-</span> unname<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>x<span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
exy. <span class="token operator">&lt;-</span> ellipsoidhull<span class="token punctuation">(</span>xy<span class="token punctuation">)</span>
exy. <span class="token comment"># &gt;&gt; calling print.ellipsoid()</span>

plot<span class="token punctuation">(</span>xy<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"ellipsoidhull(&lt;Gauss data&gt;) -- 'spanning points'"</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>predict<span class="token punctuation">(</span>exy.<span class="token punctuation">)</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"blue"</span><span class="token punctuation">)</span>
points<span class="token punctuation">(</span>rbind<span class="token punctuation">(</span>exy.<span class="token operator">$</span>loc<span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">)</span>

exy <span class="token operator">&lt;-</span> ellipsoidhull<span class="token punctuation">(</span>xy<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">1e-7</span><span class="token punctuation">,</span> ret.wt <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> ret.sq <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>exy<span class="token punctuation">)</span> <span class="token comment"># had small 'tol', hence many iterations</span>
<span class="token punctuation">(</span>ii <span class="token operator">&lt;-</span> which<span class="token punctuation">(</span>zapsmall<span class="token punctuation">(</span>exy <span class="token operator">$</span> wt<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1e-6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## --&gt; only about 4 to 6  "spanning ellipsoid" points</span>
round<span class="token punctuation">(</span>exy<span class="token operator">$</span>wt<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> sum<span class="token punctuation">(</span>exy<span class="token operator">$</span>wt<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># weights summing to 1</span>
points<span class="token punctuation">(</span>xy<span class="token punctuation">[</span>ii<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
       col<span class="token operator">=</span><span class="token string">"blue"</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> adjustcolor<span class="token punctuation">(</span><span class="token string">"blue"</span><span class="token punctuation">,</span><span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="fanny">

<a href="#fanny" class="help-page-title"><h2>Fuzzy Analysis Clustering</h2></a>

<h3>Description</h3>

<p>Computes a fuzzy clustering of the data into <code>k</code> clusters.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">fanny<span class="token punctuation">(</span>x<span class="token punctuation">,</span> k<span class="token punctuation">,</span> diss <span class="token operator">=</span> inherits<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> memb.exp <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
      metric <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"euclidean"</span><span class="token punctuation">,</span> <span class="token string">"manhattan"</span><span class="token punctuation">,</span> <span class="token string">"SqEuclidean"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> iniMem.p <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> cluster.only <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      keep.diss <span class="token operator">=</span> <span class="token operator">!</span>diss <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>cluster.only <span class="token operator">&amp;&amp;</span> n <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">,</span>
      keep.data <span class="token operator">=</span> <span class="token operator">!</span>diss <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>cluster.only<span class="token punctuation">,</span>
      maxit <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">1e-15</span><span class="token punctuation">,</span> trace.lev <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>data matrix or data frame, or dissimilarity matrix, depending on the
value of the <code>diss</code> argument.
</p>
<p>In case of a matrix or data frame, each row corresponds to an observation,
and each column corresponds to a variable. All variables must be numeric.
Missing values (NAs) are allowed.
</p>
<p>In case of a dissimilarity matrix, <code>x</code> is typically the output
of <code><a href="#daisy">daisy</a></code> or <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>.  Also a vector of
length n*(n-1)/2 is allowed (where n is the number of observations),
and will be interpreted in the same way as the output of the
above-mentioned functions.  Missing values (NAs) are not allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer giving the desired number of clusters.  It is
required that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>k</mi><mo>&lt;</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">0 &lt; k &lt; n/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/2</span></span></span></span></code> where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> is the number of
observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>

<p>logical flag: if TRUE (default for <code>dist</code> or
<code>dissimilarity</code> objects), then <code>x</code> is assumed to be a
dissimilarity matrix.  If FALSE, then <code>x</code> is treated as
a matrix of observations by variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb.exp</code></td>
<td>
<p>number <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></code> strictly larger than 1 specifying the
<em>membership exponent</em> used in the fit criterion; see the
‘Details’ below. Default: <code>2</code> which used to be hardwired
inside FANNY.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>character string specifying the metric to be used for
calculating dissimilarities between observations.  Options are
<code>"euclidean"</code> (default), <code>"manhattan"</code>, and
<code>"SqEuclidean"</code>.  Euclidean distances are root sum-of-squares
of differences, and manhattan distances are the sum of absolute
differences, and <code>"SqEuclidean"</code>, the <em>squared</em> euclidean
distances are sum-of-squares of differences.  Using this last option is
equivalent (but somewhat slower) to computing so called “fuzzy C-means”.
<br>
If <code>x</code> is already a dissimilarity matrix, then this argument will
be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>logical; if true, the measurements in <code>x</code> are
standardized before calculating the dissimilarities.  Measurements
are standardized for each variable (column), by subtracting the
variable's mean value and dividing by the variable's mean absolute
deviation.  If <code>x</code> is already a dissimilarity matrix, then this
argument will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniMem.p</code></td>
<td>
<p>numeric <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">n \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> matrix or <code>NULL</code>
(by default); can be used to specify a starting <code>membership</code>
matrix, i.e., a matrix of non-negative numbers, each row summing to
one.
</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>cluster.only</code></td>
<td>
<p>logical; if true, no silhouette information will be
computed and returned, see details.</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>keep.diss, keep.data</code></td>
<td>
<p>logicals indicating if the dissimilarities
and/or input data <code>x</code> should be kept in the result.  Setting
these to <code>FALSE</code> can give smaller results and hence also save
memory allocation <em>time</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit, tol</code></td>
<td>
<p>maximal number of iterations and default tolerance
for convergence (relative convergence of the fit criterion) for the
FANNY algorithm.  The defaults <code>maxit = 500</code> and <code>tol =
      1e-15</code> used to be hardwired inside the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.lev</code></td>
<td>
<p>integer specifying a trace level for printing
diagnostics during the C-internal algorithm.
Default <code>0</code> does not print anything; higher values print
increasingly more.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In a fuzzy clustering, each observation is “spread out” over
the various clusters.  Denote by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>i</mi><mi>v</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_{iv}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> the membership
of observation <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> to cluster <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></code>.
</p>
<p>The memberships are nonnegative, and for a fixed observation i they sum to 1.
The particular method <code>fanny</code> stems from chapter 4 of
Kaufman and Rousseeuw (1990) (see the references in
<code><a href="#daisy">daisy</a></code>) and has been extended by Martin Maechler to allow
user specified <code>memb.exp</code>, <code>iniMem.p</code>, <code>maxit</code>,
<code>tol</code>, etc.
</p>
<p>Fanny aims to minimize the objective function
</p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>v</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mfrac><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi>u</mi><mrow><mi>i</mi><mi>v</mi></mrow><mi>r</mi></msubsup><msubsup><mi>u</mi><mrow><mi>j</mi><mi>v</mi></mrow><mi>r</mi></msubsup><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi>u</mi><mrow><mi>j</mi><mi>v</mi></mrow><mi>r</mi></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\sum_{v=1}^k
    \frac{\sum_{i=1}^n\sum_{j=1}^n u_{iv}^r u_{jv}^r d(i,j)}{
      2 \sum_{j=1}^n u_{jv}^r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.825em;vertical-align:-0.6678em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1572em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7047em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4603em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6523em;"><span style="top:-2.1777em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4612em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6322em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4603em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.214em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.214em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4249em;"><span></span></span></span></span></span></span><span class="mord mathnormal mtight">d</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6678em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></code>
</p>

<p>where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> is the number of observations, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> is the number of
clusters, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></code> is the membership exponent <code>memb.exp</code> and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></code> is the dissimilarity between observations <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></code>.
<br> Note that <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r \to 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> gives increasingly crisper
clusterings whereas <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">r \to \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">∞</span></span></span></span></code> leads to complete
fuzzyness.  K&amp;R(1990), p.191 note that values too close to 1 can lead
to slow convergence.  Further note that even the default, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">r = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code>
can lead to complete fuzzyness, i.e., memberships <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>i</mi><mi>v</mi></mrow></msub><mo>≡</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">u_{iv} \equiv
    1/k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6138em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>.  In that case a warning is signalled and the
user is advised to chose a smaller <code>memb.exp</code> (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">=r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></code>).
</p>
<p>Compared to other fuzzy clustering methods, <code>fanny</code> has the following
features: (a) it also accepts a dissimilarity matrix; (b) it is
more robust to the <code>spherical cluster</code> assumption; (c) it provides
a novel graphical display, the silhouette plot (see
<code><a href="#plot.partition">plot.partition</a></code>).
</p>


<h3>Value</h3>

<p>an object of class <code>"fanny"</code> representing the clustering.
See <code><a href="#fanny.object">fanny.object</a></code> for details.
</p>


<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code> for background and references;
<code><a href="#fanny.object">fanny.object</a></code>, <code><a href="#partition.object">partition.object</a></code>,
<code><a href="#plot.partition">plot.partition</a></code>, <code><a href="#daisy">daisy</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## generate 10+15 objects in two clusters, plus 3 objects lying</span><span class="token comment">## between those clusters.</span>
x <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3.2</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3.2</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fannyx <span class="token operator">&lt;-</span> fanny<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">## Note that observations 26:28 are "fuzzy" (closer to # 2):</span>
fannyx
summary<span class="token punctuation">(</span>fannyx<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>fannyx<span class="token punctuation">)</span>

<span class="token punctuation">(</span>fan.x.<span class="token number">15</span> <span class="token operator">&lt;-</span> fanny<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> memb.exp <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 'crispier' for obs. 26:28</span>
<span class="token punctuation">(</span>fanny<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> memb.exp <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>               <span class="token comment"># more fuzzy in general</span>

data<span class="token punctuation">(</span>ruspini<span class="token punctuation">)</span>
f4 <span class="token operator">&lt;-</span> fanny<span class="token punctuation">(</span>ruspini<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>rle<span class="token punctuation">(</span>f4<span class="token operator">$</span>clustering<span class="token punctuation">)</span><span class="token operator">$</span>lengths <span class="token operator">==</span> c<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>f4<span class="token punctuation">,</span> which <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">## Plot similar to Figure 6 in Stryuf et al (1996)</span>
plot<span class="token punctuation">(</span>fanny<span class="token punctuation">(</span>ruspini<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="fanny.object">

<a href="#fanny.object" class="help-page-title"><h2>Fuzzy Analysis (FANNY) Object</h2></a>

<h3>Description</h3>

<p>The objects of class <code>"fanny"</code> represent a fuzzy clustering of a
dataset.
</p>


<h3>Value</h3>

<p>A legitimate <code>fanny</code> object is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>membership</code></td>
<td>

<p>matrix containing the memberships for each pair consisting of an
observation and a cluster.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb.exp</code></td>
<td>
<p>the membership exponent used in the fitting criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>

<p>Dunn's partition coefficient <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></code> of the clustering, where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> is the number of clusters. <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></code> is the sum of all
<em>squared</em> membership coefficients, divided by the number of
observations.  Its value is between <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">1/k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> and 1.
</p>
<p>The normalized form of the coefficient is also given.  It is defined
as <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>k</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(F(k) - 1/k) / (1 - 1/k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></code>, and ranges between 0 and 1.
A low value of Dunn's coefficient indicates a very fuzzy clustering,
whereas a value close to 1 indicates a near-crisp clustering.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>

<p>the clustering vector of the nearest crisp clustering, see
<code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.crisp</code></td>
<td>
<p>integer (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\le k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>) giving the number of <em>crisp</em>
clusters; can be less than <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>, where it's recommended to
decrease <code>memb.exp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objective</code></td>
<td>

<p>named vector containing the minimal value of the objective function
reached by the FANNY algorithm and the relative convergence
tolerance <code>tol</code> used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>

<p>named vector with <code>iterations</code>, the number of iterations needed
and <code>converged</code> indicating if the algorithm converged (in
<code>maxit</code> iterations within convergence tolerance <code>tol</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>

<p>an object of class <code>"dissimilarity"</code>, see
<code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>generating call, see <code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silinfo</code></td>
<td>

<p>list with silhouette information of the nearest crisp clustering, see
<code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix, possibibly standardized, or NULL, see
<code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
</table>
<h3>GENERATION</h3>

<p>These objects are returned from <code><a href="#fanny">fanny</a></code>.
</p>


<h3>METHODS</h3>

<p>The <code>"fanny"</code> class has methods for the following generic functions:
<code>print</code>, <code>summary</code>.
</p>


<h3>INHERITANCE</h3>

<p>The class <code>"fanny"</code> inherits from <code>"partition"</code>.
Therefore, the generic functions <code>plot</code> and <code>clusplot</code> can
be used on a <code>fanny</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#fanny">fanny</a></code>, <code><a href="#print.fanny">print.fanny</a></code>,
<code><a href="#dissimilarity.object">dissimilarity.object</a></code>,
<code><a href="#partition.object">partition.object</a></code>, <code><a href="#plot.partition">plot.partition</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="flower">

<a href="#flower" class="help-page-title"><h2>Flower Characteristics</h2></a>

<h3>Description</h3>

<p>8 characteristics for 18 popular flowers.</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>flower<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>A data frame with 18 observations on 8 variables:
</p>

<table>
<tr>
<td style="text-align: right;">
    [ , "V1"] </td>
<td style="text-align: left;"> factor  </td>
<td style="text-align: left;"> winters </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , "V2"] </td>
<td style="text-align: left;"> factor  </td>
<td style="text-align: left;"> shadow </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , "V3"] </td>
<td style="text-align: left;"> factor  </td>
<td style="text-align: left;"> tubers </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , "V4"] </td>
<td style="text-align: left;"> factor  </td>
<td style="text-align: left;"> color </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , "V5"] </td>
<td style="text-align: left;"> ordered </td>
<td style="text-align: left;"> soil </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , "V6"] </td>
<td style="text-align: left;"> ordered </td>
<td style="text-align: left;"> preference </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , "V7"] </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> height </td>
</tr>
<tr>
<td style="text-align: right;">
    [ , "V8"] </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> distance
  </td>
</tr>
</table>
<dl>
<dt>V1</dt>
<dd>
<p>winters, is binary and indicates whether the plant may be left
in the garden when it freezes.</p>
</dd>
<dt>V2</dt>
<dd>
<p>shadow, is binary and shows whether the plant needs to stand
in the shadow.</p>
</dd>
<dt>V3</dt>
<dd>
<p>tubers, is asymmetric binary and distinguishes between plants
with tubers and plants that grow in any other way.</p>
</dd>
<dt>V4</dt>
<dd>
<p>color, is nominal and specifies the flower's color (1 = white,
2 = yellow, 3 = pink, 4 = red, 5 = blue).</p>
</dd>
<dt>V5</dt>
<dd>
<p>soil, is ordinal and indicates whether the plant grows in dry
(1), normal (2), or wet (3) soil.</p>
</dd>
<dt>V6</dt>
<dd>
<p>preference, is ordinal and gives someone's preference ranking
going from 1 to 18.</p>
</dd>
<dt>V7</dt>
<dd>
<p>height, is interval scaled, the plant's height in centimeters.</p>
</dd>
<dt>V8</dt>
<dd>
<p>distance, is interval scaled, the distance in centimeters that
should be left between the plants.</p>
</dd>
</dl>
<h3>References</h3>

<p>Struyf, Hubert and Rousseeuw (1996), see <code><a href="#agnes">agnes</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>flower<span class="token punctuation">)</span>
<span class="token comment">## Example 2 in ref</span>
daisy<span class="token punctuation">(</span>flower<span class="token punctuation">,</span> type <span class="token operator">=</span> list<span class="token punctuation">(</span>asymm <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
daisy<span class="token punctuation">(</span>flower<span class="token punctuation">,</span> type <span class="token operator">=</span> list<span class="token punctuation">(</span>asymm <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ordratio <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lower.to.upper.tri.inds">

<a href="#lower.to.upper.tri.inds" class="help-page-title"><h2>Permute Indices for Triangular Matrices</h2></a>

<h3>Description</h3>

<p>Compute index vectors for extracting or reordering of lower or upper
triangular matrices that are stored as contiguous vectors.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">lower.to.upper.tri.inds<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
upper.to.lower.tri.inds<span class="token punctuation">(</span>n<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer larger than 1.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>integer vector containing a permutation of <code>1:N</code> where
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">N = n(n-1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code>.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#lower.tri">upper.tri</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#lower.tri">lower.tri</a></code> with a related
purpose.</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">m5 <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
m <span class="token operator">&lt;-</span> m5<span class="token punctuation">;</span> m<span class="token punctuation">[</span>lower.tri<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> upper.to.lower.tri.inds<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> m
m <span class="token operator">&lt;-</span> m5<span class="token punctuation">;</span> m<span class="token punctuation">[</span>upper.tri<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> lower.to.upper.tri.inds<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> m

stopifnot<span class="token punctuation">(</span>lower.to.upper.tri.inds<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>
          lower.to.upper.tri.inds<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
          upper.to.lower.tri.inds<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
     sort<span class="token punctuation">(</span>upper.to.lower.tri.inds<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span>
     sort<span class="token punctuation">(</span>lower.to.upper.tri.inds<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="medoids">

<a href="#medoids" class="help-page-title"><h2>Compute <code>pam</code>-consistent Medoids from Clustering</h2></a>

<h3>Description</h3>

<p>Given a data matrix or dissimilarity <code>x</code> for say <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>
observational units and a clustering,
compute the <code><a href="#pam">pam</a>()</code>-consistent medoids.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">medoids<span class="token punctuation">(</span>x<span class="token punctuation">,</span> clustering<span class="token punctuation">,</span> diss <span class="token operator">=</span> inherits<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> USE.NAMES <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Either a data matrix or data frame, or dissimilarity matrix or
object, see also <code><a href="#pam">pam</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p>an integer vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, the number of
observations, giving for each observation the number ('id') of the
cluster to which it belongs.  In other words, <code>clustering</code> has
values from <code>1:k</code> where <code>k</code> is the number of clusters, see
also <code><a href="#partition.object">partition.object</a></code> and <code><a href="https://r-universe.dev/manuals/stats.html#cutree">cutree</a>()</code>, for
examples where such clustering vectors are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>
<p>see also <code><a href="#pam">pam</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>USE.NAMES</code></td>
<td>
<p>a logical, typical false, passed to the
<code><a href="https://r-universe.dev/manuals/base.html#lapply">vapply</a>()</code> call computing the medoids.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional further argument passed to <code><a href="#pam">pam</a>(xj, k=1, ...)</code>,
notably <code>metric</code>, or <code>variant="f_5"</code> to use a faster algorithm, or
<code>trace.lev = k</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a numeric vector of length
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, after being asked how <code><a href="#pam">pam</a>()</code> could be used
instead of <code><a href="https://r-universe.dev/manuals/stats.html#kmeans">kmeans</a>()</code>, starting from a previous clustering.
</p>


<h3>See Also</h3>

<p><code><a href="#pam">pam</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#kmeans">kmeans</a></code>.
Further, <code><a href="https://r-universe.dev/manuals/stats.html#cutree">cutree</a>()</code> and <code><a href="#agnes">agnes</a></code> (or <code><a href="https://r-universe.dev/manuals/stats.html#hclust">hclust</a></code>).
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## From example(agnes):</span>
data<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span>
agn1 <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>votes.repub<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"manhattan"</span><span class="token punctuation">,</span> stand <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
agn2 <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>daisy<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span><span class="token punctuation">,</span> diss <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"complete"</span><span class="token punctuation">)</span>
agnS <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>votes.repub<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"flexible"</span><span class="token punctuation">,</span> par.meth <span class="token operator">=</span> <span class="token number">0.625</span><span class="token punctuation">)</span>

<span class="token keyword">for</span><span class="token punctuation">(</span>k <span class="token keyword">in</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  print<span class="token punctuation">(</span>table<span class="token punctuation">(</span>cl.k <span class="token operator">&lt;-</span> cutree<span class="token punctuation">(</span>agnS<span class="token punctuation">,</span> k<span class="token operator">=</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  stopifnot<span class="token punctuation">(</span>length<span class="token punctuation">(</span>cl.k<span class="token punctuation">)</span> <span class="token operator">==</span> nrow<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> cl.k<span class="token punctuation">,</span> cl.k <span class="token operator">&lt;=</span> k<span class="token punctuation">,</span> table<span class="token punctuation">(</span>cl.k<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span>
  m.k <span class="token operator">&lt;-</span> medoids<span class="token punctuation">(</span>votes.repub<span class="token punctuation">,</span> cl.k<span class="token punctuation">)</span>
  cat<span class="token punctuation">(</span><span class="token string">"k ="</span><span class="token punctuation">,</span> k<span class="token punctuation">,</span><span class="token string">"; sort(medoids) = "</span><span class="token punctuation">)</span><span class="token punctuation">;</span> dput<span class="token punctuation">(</span>sort<span class="token punctuation">(</span>m.k<span class="token punctuation">)</span><span class="token punctuation">,</span> control<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="mona">

<a href="#mona" class="help-page-title"><h2>MONothetic Analysis Clustering of Binary Variables</h2></a>

<h3>Description</h3>

<p>Returns a list representing a divisive hierarchical clustering of
a dataset with binary variables only.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">mona<span class="token punctuation">(</span>x<span class="token punctuation">,</span> trace.lev <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>data matrix or data frame in which each row corresponds to an
observation, and each column corresponds to a variable.  All
variables must be binary.  A limited number of missing values (<code>NA</code>s)
is allowed.  Every observation must have at least one value different
from <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>.  No variable should have half of its values
missing.  There must be at least one variable which has no missing
values.  A variable with all its non-missing values identical is
not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.lev</code></td>
<td>
<p>logical or integer indicating if (and how much) the
algorithm should produce progress output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mona</code> is fully described in chapter 7 of Kaufman and Rousseeuw (1990).
It is “monothetic” in the sense that each division is based on a
single (well-chosen) variable, whereas most other hierarchical methods
(including <code>agnes</code> and <code>diana</code>) are “polythetic”, i.e. they use
all variables together.
</p>
<p>The <code>mona</code>-algorithm constructs a hierarchy of clusterings,
starting with one large cluster.  Clusters are divided until all
observations in the same cluster have identical values for all variables.
<br>
At each stage, all clusters are divided according to the values of one
variable. A cluster is divided into one cluster with all observations having
value 1 for that variable, and another cluster with all observations having
value 0 for that variable.
</p>
<p>The variable used for splitting a cluster is the variable with the maximal
total association to the other variables, according to the observations in the
cluster to be splitted. The association between variables f and g
is given by a(f,g)*d(f,g) - b(f,g)*c(f,g), where a(f,g), b(f,g), c(f,g),
and d(f,g) are the numbers in the contingency table of f and g.
[That is, a(f,g) (resp. d(f,g)) is the number of observations for which f and g
both have value 0 (resp. value 1); b(f,g) (resp. c(f,g)) is the number of
observations for which f has value 0 (resp. 1) and g has value 1 (resp. 0).]
The total association of a variable f is the sum of its associations to all
variables.
</p>


<h3>Value</h3>

<p>an object of class <code>"mona"</code> representing the clustering.
See <code><a href="#mona.object">mona.object</a></code> for details.
</p>


<h3>Missing Values (<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s)</h3>

<p>The mona-algorithm requires “pure” 0-1 values.  However,
<code>mona(x)</code> allows <code>x</code> to contain (not too many)
<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s.  In a preliminary step, these are “imputed”,
i.e., all missing values are filled in.  To do this, the same measure
of association between variables is used as in the algorithm.  When variable
f has missing values, the variable g with the largest absolute association
to f is looked up. When the association between f and g is positive,
any missing value of f is replaced by the value of g for the same
observation. If the association between f and g is negative, then any missing
value of f is replaced by the value of 1-g for the same
observation.
</p>


<h3>Note</h3>

<p>In <span class="pkg">cluster</span> versions before 2.0.6, the algorithm entered an
infinite loop in the boundary case of one variable, i.e.,
<code>ncol(x) == 1</code>, which currently signals an error (because the
algorithm now in C, haes not correctly taken account of this special case).

</p>


<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code> for background and references;
<code><a href="#mona.object">mona.object</a></code>, <code><a href="#plot.mona">plot.mona</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>animals<span class="token punctuation">)</span>
ma <span class="token operator">&lt;-</span> mona<span class="token punctuation">(</span>animals<span class="token punctuation">)</span>
ma
<span class="token comment">## Plot similar to Figure 10 in Struyf et al (1996)</span>
plot<span class="token punctuation">(</span>ma<span class="token punctuation">)</span>

<span class="token comment">## One place to see if/how error messages are *translated* (to 'de' / 'pl'):</span>
ani.<span class="token keyword">NA</span>   <span class="token operator">&lt;-</span> animals<span class="token punctuation">;</span> ani.<span class="token keyword">NA</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token keyword">NA</span>
aniNA    <span class="token operator">&lt;-</span> within<span class="token punctuation">(</span>animals<span class="token punctuation">,</span> <span class="token punctuation">{</span> end<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token keyword">NA</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
aniN2    <span class="token operator">&lt;-</span> animals<span class="token punctuation">;</span> aniN2<span class="token punctuation">[</span>cbind<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token keyword">NA</span>
ani.non2 <span class="token operator">&lt;-</span> within<span class="token punctuation">(</span>animals<span class="token punctuation">,</span> end<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">3</span> <span class="token punctuation">)</span>
ani.idNA <span class="token operator">&lt;-</span> within<span class="token punctuation">(</span>animals<span class="token punctuation">,</span> end<span class="token punctuation">[</span><span class="token operator">!</span>is.na<span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span> <span class="token punctuation">)</span>
try<span class="token punctuation">(</span> mona<span class="token punctuation">(</span>ani.<span class="token keyword">NA</span><span class="token punctuation">)</span>   <span class="token punctuation">)</span> <span class="token comment">## error: .. object with all values missing</span>
try<span class="token punctuation">(</span> mona<span class="token punctuation">(</span>aniNA<span class="token punctuation">)</span>    <span class="token punctuation">)</span> <span class="token comment">## error: .. more than half missing values</span>
try<span class="token punctuation">(</span> mona<span class="token punctuation">(</span>aniN2<span class="token punctuation">)</span>    <span class="token punctuation">)</span> <span class="token comment">## error: all have at least one missing</span>
try<span class="token punctuation">(</span> mona<span class="token punctuation">(</span>ani.non2<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment">## error: all must be binary</span>
try<span class="token punctuation">(</span> mona<span class="token punctuation">(</span>ani.idNA<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment">## error:  ditto</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="mona.object">

<a href="#mona.object" class="help-page-title"><h2>Monothetic Analysis (MONA) Object</h2></a>

<h3>Description</h3>

<p>The objects of class <code>"mona"</code> represent the divisive
hierarchical clustering of a dataset with only binary variables
(measurements).   This class of objects is returned from
<code><a href="#mona">mona</a></code>.
</p>


<h3>Value</h3>

<p>A legitimate <code>mona</code> object is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>matrix with the same dimensions as the original data matrix,
but with factors coded as 0 and 1, and all missing values replaced.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>

<p>a vector giving a permutation of the original observations to allow
for plotting, in the sense that the branches of a clustering tree
will not cross.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.lab</code></td>
<td>

<p>a vector similar to <code>order</code>, but containing observation labels
instead of observation numbers. This component is only available if
the original observations were labelled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>

<p>vector of length n-1 where n is the number of observations,
specifying the variables used to separate the observations of <code>order</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>

<p>vector of length n-1 where n is the number of observations,
specifying the separation steps at which the observations of
<code>order</code> are separated.
</p>
</td>
</tr>
</table>
<h3>METHODS</h3>

<p>The <code>"mona"</code> class has methods for the following generic functions:
<code>print</code>, <code>summary</code>, <code>plot</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#mona">mona</a></code> for examples etc, <code><a href="#plot.mona">plot.mona</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="pam">

<a href="#pam" class="help-page-title"><h2>Partitioning Around Medoids</h2></a>

<h3>Description</h3>

<p>Partitioning (clustering) of the data into <code>k</code> clusters “around
medoids”, a more robust version of K-means.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span> k<span class="token punctuation">,</span> diss <span class="token operator">=</span> inherits<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    metric <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"euclidean"</span><span class="token punctuation">,</span> <span class="token string">"manhattan"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    medoids <span class="token operator">=</span> <span class="token keyword">if</span><span class="token punctuation">(</span>is.numeric<span class="token punctuation">(</span>nstart<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">"random"</span><span class="token punctuation">,</span>
    nstart <span class="token operator">=</span> <span class="token keyword">if</span><span class="token punctuation">(</span>variant <span class="token operator">==</span> <span class="token string">"faster"</span><span class="token punctuation">)</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
    stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> cluster.only <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
    do.swap <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
    keep.diss <span class="token operator">=</span> <span class="token operator">!</span>diss <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>cluster.only <span class="token operator">&amp;&amp;</span> n <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">,</span>
    keep.data <span class="token operator">=</span> <span class="token operator">!</span>diss <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>cluster.only<span class="token punctuation">,</span>
    variant <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"original"</span><span class="token punctuation">,</span> <span class="token string">"o_1"</span><span class="token punctuation">,</span> <span class="token string">"o_2"</span><span class="token punctuation">,</span> <span class="token string">"f_3"</span><span class="token punctuation">,</span> <span class="token string">"f_4"</span><span class="token punctuation">,</span> <span class="token string">"f_5"</span><span class="token punctuation">,</span> <span class="token string">"faster"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    pamonce <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> trace.lev <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>data matrix or data frame, or dissimilarity matrix or object,
depending on the value of the <code>diss</code> argument.
</p>
<p>In case of a matrix or data frame, each row corresponds to an
observation, and each column corresponds to a variable.  All
variables must be numeric.  Missing values (<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s)
<em>are</em> allowed—as long as every pair of observations has at
least one case not missing.
</p>
<p>In case of a dissimilarity matrix, <code>x</code> is typically the output
of <code><a href="#daisy">daisy</a></code> or <code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>.  Also a vector of
length n*(n-1)/2 is allowed (where n is the number of observations),
and will be interpreted in the same way as the output of the
above-mentioned functions. Missing values (<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s) are
<em>not</em> allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>positive integer specifying the number of clusters, less than
the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>

<p>logical flag: if TRUE (default for <code>dist</code> or
<code>dissimilarity</code> objects), then <code>x</code> will be considered as a
dissimilarity matrix.  If FALSE, then <code>x</code> will be considered as
a matrix of observations by variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>

<p>character string specifying the metric to be used for calculating
dissimilarities between observations.<br>
The currently available options are "euclidean" and
"manhattan".  Euclidean distances are root sum-of-squares of
differences, and manhattan distances are the sum of absolute
differences.  If <code>x</code> is already a dissimilarity matrix, then
this argument will be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medoids</code></td>
<td>
<p>NULL (default) or length-<code>k</code> vector of integer
indices (in <code>1:n</code>) specifying initial medoids instead of using
the ‘<em>build</em>’ algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>used only when <code>medoids = "random"</code>: specifies the
<em>number</em> of random “starts”;  this argument corresponds to
the one of <code><a href="https://r-universe.dev/manuals/stats.html#kmeans">kmeans</a>()</code> (from <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s package <span class="pkg">stats</span>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>logical; if true, the measurements in <code>x</code> are
standardized before calculating the dissimilarities.  Measurements
are standardized for each variable (column), by subtracting the
variable's mean value and dividing by the variable's mean absolute
deviation.  If <code>x</code> is already a dissimilarity matrix, then this
argument will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.only</code></td>
<td>
<p>logical; if true, only the clustering will be
computed and returned, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.swap</code></td>
<td>
<p>logical indicating if the <b>swap</b> phase should
happen. The default, <code>TRUE</code>, correspond to the
original algorithm.  On the other hand, the <b>swap</b> phase is
much more computer intensive than the <b>build</b> one for large
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, so can be skipped by <code>do.swap = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.diss, keep.data</code></td>
<td>
<p>logicals indicating if the dissimilarities
and/or input data <code>x</code> should be kept in the result.  Setting
these to <code>FALSE</code> can give much smaller results and hence even save
memory allocation <em>time</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pamonce</code></td>
<td>
<p>logical or integer in <code>0:6</code> specifying algorithmic
short cuts as proposed by Reynolds et al. (2006), and
Schubert and Rousseeuw (2019, 2021) see below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variant</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> string denoting the variant of
PAM algorithm to use; a more self-documenting version of <code>pamonce</code>
which should be used preferably; note that <code>"faster"</code> not only
uses <code>pamonce = 6</code> but also <code>nstart = 1</code> and hence
<code>medoids = "random"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.lev</code></td>
<td>
<p>integer specifying a trace level for printing
diagnostics during the build and swap phase of the algorithm.
Default <code>0</code> does not print anything; higher values print
increasingly more.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The basic <code>pam</code> algorithm is fully described in chapter 2 of
Kaufman and Rousseeuw(1990).  Compared to the k-means approach in <code>kmeans</code>, the
function <code>pam</code> has the following features: (a) it also accepts a
dissimilarity matrix; (b) it is more robust because it minimizes a sum
of dissimilarities instead of a sum of squared euclidean distances;
(c) it provides a novel graphical display, the silhouette plot (see
<code>plot.partition</code>) (d) it allows to select the number of clusters
using <code>mean(<a href="#silhouette">silhouette</a>(pr)[, "sil_width"])</code> on the result
<code>pr &lt;- pam(..)</code>, or directly its component
<code>pr$silinfo$avg.width</code>, see also <code><a href="#pam.object">pam.object</a></code>.
</p>
<p>When <code>cluster.only</code> is true, the result is simply a (possibly
named) integer vector specifying the clustering, i.e.,<br><code>pam(x,k, cluster.only=TRUE)</code> is the same as <br><code>pam(x,k)$clustering</code> but computed more efficiently.
</p>
<p>The <code>pam</code>-algorithm is based on the search for <code>k</code>
representative objects or medoids among the observations of the
dataset.  These observations should represent the structure of the
data.  After finding a set of <code>k</code> medoids, <code>k</code> clusters are
constructed by assigning each observation to the nearest medoid.  The
goal is to find <code>k</code> representative objects which minimize the sum
of the dissimilarities of the observations to their closest
representative object.
<br>
By default, when <code>medoids</code> are not specified, the algorithm first
looks for a good initial set of medoids (this is called the
<b>build</b> phase).  Then it finds a local minimum for the
objective function, that is, a solution such that there is no single
switch of an observation with a medoid (i.e. a ‘swap’) that will
decrease the objective (this is called the <b>swap</b> phase).
</p>
<p>When the <code>medoids</code> are specified (or randomly generated), their order does <em>not</em>
matter; in general, the algorithms have been designed to not depend on
the order of the observations.
</p>
<p>The <code>pamonce</code> option, new in cluster 1.14.2 (Jan. 2012), has been
proposed by Matthias Studer, University of Geneva, based on the
findings by Reynolds et al. (2006) and was extended by Erich Schubert,
TU Dortmund, with the FastPAM optimizations.
</p>
<p>The default <code>FALSE</code> (or integer <code>0</code>) corresponds to the
original “swap” algorithm, whereas <code>pamonce = 1</code> (or
<code>TRUE</code>), corresponds to the first proposal .... 
and <code>pamonce = 2</code> additionally implements the second proposal as
well. 
</p>
<p>The key ideas of ‘FastPAM’ (Schubert and Rousseeuw, 2019) are implemented
except for the linear approximate build as follows:
</p>

<dl>
<dt>
<code>pamonce = 3</code>:</dt>
<dd>
<p>reduces the runtime by a factor of O(k) by exploiting
that points cannot be closest to all current medoids at the same time.</p>
</dd>
<dt>
<code>pamonce = 4</code>:</dt>
<dd>
<p> additionally allows executing multiple swaps
per iteration, usually reducing the number of iterations.</p>
</dd>
<dt>
<code>pamonce = 5</code>:</dt>
<dd>
<p> adds minor optimizations copied from the
<code>pamonce = 2</code> approach, and is expected to be the fastest of the
‘FastPam’ variants included.</p>
</dd>
</dl>
<p>‘FasterPAM’ (Schubert and Rousseeuw, 2021) is implemented via
</p>

<dl>
<dt>
<code>pamonce = 6</code>:</dt>
<dd>
<p>execute each swap which improves results
immediately, and hence typically multiple swaps per iteration;
this swapping algorithm runs in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> rather than
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo stretchy="false">)</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n(n-k)k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></code> time which is much faster for all but small <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>.</p>
</dd>
</dl>
<p>In addition, ‘FasterPAM’ uses <em>random</em> initialization of the
medoids (instead of the ‘<em>build</em>’ phase) to avoid the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2 k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></code> initialization cost of the build algorithm.  In particular
for large k, this yields a much faster algorithm, while preserving a
similar result quality.
</p>
<p>One may decide to use <em>repeated</em> random initialization by setting
<code>nstart &gt; 1</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>"pam"</code> representing the clustering.  See
<code>?<a href="#pam.object">pam.object</a></code> for details.
</p>


<h3>Note</h3>

<p>For large datasets, <code>pam</code> may need too much memory or too much
computation time since both are <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code>.  Then,
<code><a href="#clara">clara</a>()</code> is preferable, see its documentation.
</p>
<p>There is hard limit currently, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>≤</mo><mn>65536</mn></mrow><annotation encoding="application/x-tex">n \le 65536</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">65536</span></span></span></span></code>, at
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup></mrow><annotation encoding="application/x-tex">2^{16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span></span></span></span></code> because for larger <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n(n-1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code> is larger than
the maximal integer (<code><a href="https://r-universe.dev/manuals/base.html#zMachine">.Machine</a>$integer.max</code> = <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{31} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code>).
</p>


<h3>Author(s)</h3>

<p>Kaufman and Rousseeuw's orginal Fortran code was translated to C
and augmented in several ways, e.g. to allow <code>cluster.only=TRUE</code>
or <code>do.swap=FALSE</code>, by Martin Maechler.
<br>
Matthias Studer, Univ.Geneva provided the <code>pamonce</code> (<code>1</code> and <code>2</code>)
implementation.
<br>
Erich Schubert, TU Dortmund contributed the <code>pamonce</code> (<code>3</code> to <code>6</code>)
implementation.
</p>


<h3>References</h3>


<p>Reynolds, A., Richards, G., de la Iglesia, B. and Rayward-Smith, V. (1992)
Clustering rules: A comparison of partitioning and hierarchical
clustering algorithms;
<em>Journal of Mathematical Modelling and Algorithms</em> <b>5</b>,
475–504. <a href="https://doi.org/10.1007/s10852-005-9022-1" target="_blank">doi:10.1007/s10852-005-9022-1</a>.
</p>

<p>Erich Schubert and Peter J. Rousseeuw (2019)
Faster k-Medoids Clustering:
Improving the PAM, CLARA, and CLARANS Algorithms;
SISAP 2020, 171–187. <a href="https://doi.org/10.1007/978-3-030-32047-8_16" target="_blank">doi:10.1007/978-3-030-32047-8_16</a>.
</p>

<p>Erich Schubert and Peter J. Rousseeuw (2021)
Fast and Eager k-Medoids Clustering:
O(k) Runtime Improvement of the PAM, CLARA, and CLARANS Algorithms;
Preprint, to appear in Information Systems (<a href="https://arxiv.org/abs/2008.05171" target="_blank">https://arxiv.org/abs/2008.05171</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code> for background and references;
<code><a href="#pam.object">pam.object</a></code>, <code><a href="#clara">clara</a></code>, <code><a href="#daisy">daisy</a></code>,
<code><a href="#partition.object">partition.object</a></code>, <code><a href="#plot.partition">plot.partition</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## generate 25 objects, divided into 2 clusters.</span>
x <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pamx <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
pamx <span class="token comment"># Medoids: '7' and '25' ...</span>
summary<span class="token punctuation">(</span>pamx<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>pamx<span class="token punctuation">)</span>
<span class="token comment">## use obs. 1 &amp; 16 as starting medoids -- same result (typically)</span>
<span class="token punctuation">(</span>p2m <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> medoids <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## no _build_ *and* no _swap_ phase: just cluster all obs. around (1, 16):</span>
p2.s <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> medoids <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> do.swap <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
p2.s

p3m <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> trace <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">## rather stupid initial medoids:</span>
<span class="token punctuation">(</span>p3m. <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> medoids <span class="token operator">=</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> trace <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


pam<span class="token punctuation">(</span>daisy<span class="token punctuation">(</span>x<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"manhattan"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> diss <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

data<span class="token punctuation">(</span>ruspini<span class="token punctuation">)</span>
<span class="token comment">## Plot similar to Figure 4 in Stryuf et al (1996)</span>
<span class="token comment">## Not run: plot(pam(ruspini, 4), ask = TRUE)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pam.object">

<a href="#pam.object" class="help-page-title"><h2>Partitioning Around Medoids (PAM) Object</h2></a>

<h3>Description</h3>

<p>The objects of class <code>"pam"</code> represent a partitioning of a
dataset into clusters.
</p>


<h3>Value</h3>

<p>A legitimate <code>pam</code> object is a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>medoids</code></td>
<td>

<p>the medoids or representative objects of the
clusters.  If a dissimilarity matrix was given as input to
<code>pam</code>, then a vector of numbers or labels of observations is
given, else <code>medoids</code> is a <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code> with in each
row the coordinates of one medoid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.med</code></td>
<td>
<p>integer vector of <em>indices</em> giving the medoid
observation numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p>the clustering vector, see <code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objective</code></td>
<td>
<p>the objective function after the first and second
step of the <code>pam</code> algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isolation</code></td>
<td>

<p>vector with length equal to the number of clusters, specifying which
clusters are isolated clusters (L- or L*-clusters) and which clusters are
not isolated.<br>
A cluster is an L*-cluster iff its diameter is smaller than its
separation.  A cluster is an L-cluster iff for each observation i
the maximal dissimilarity between i and any other observation of the
cluster is smaller than the minimal dissimilarity between i and any
observation of another cluster.  Clearly each L*-cluster is also an
L-cluster.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusinfo</code></td>
<td>

<p>matrix, each row gives numerical information for one cluster. These
are the cardinality of the cluster (number of observations), the
maximal and average dissimilarity between the observations in the
cluster and the cluster's medoid, 
the diameter of the cluster
(maximal dissimilarity between two observations of the cluster), and
the separation of the cluster (minimal dissimilarity between an
observation of the cluster and an observation of another cluster).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silinfo</code></td>
<td>
<p>list with silhouette width information, see
<code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>
<p>dissimilarity (maybe NULL), see <code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>generating call, see <code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>(possibibly standardized) see <code><a href="#partition.object">partition.object</a></code>.</p>
</td>
</tr>
</table>
<h3>GENERATION</h3>

<p>These objects are returned from <code><a href="#pam">pam</a></code>.</p>


<h3>METHODS</h3>

<p>The <code>"pam"</code> class has methods for the following generic functions:
<code>print</code>, <code>summary</code>.
</p>


<h3>INHERITANCE</h3>

<p>The class <code>"pam"</code> inherits from <code>"partition"</code>.
Therefore, the generic functions <code>plot</code> and <code>clusplot</code> can
be used on a <code>pam</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#pam">pam</a></code>, <code><a href="#dissimilarity.object">dissimilarity.object</a></code>,
<code><a href="#partition.object">partition.object</a></code>, <code><a href="#plot.partition">plot.partition</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Use the silhouette widths for assessing the best number of clusters,</span><span class="token comment">## following a one-dimensional example from Christian Hennig :</span><span class="token comment">##</span>
x <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span>mean<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span>mean<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
asw <span class="token operator">&lt;-</span> numeric<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment">## Note that "k=1" won't work!</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token keyword">in</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">)</span>
  asw<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token operator">$</span> silinfo <span class="token operator">$</span> avg.width
k.best <span class="token operator">&lt;-</span> which.max<span class="token punctuation">(</span>asw<span class="token punctuation">)</span>
cat<span class="token punctuation">(</span><span class="token string">"silhouette-optimal number of clusters:"</span><span class="token punctuation">,</span> k.best<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>

plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span> asw<span class="token punctuation">,</span> type<span class="token operator">=</span> <span class="token string">"h"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"pam() clustering assessment"</span><span class="token punctuation">,</span>
     xlab<span class="token operator">=</span> <span class="token string">"k  (# clusters)"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"average silhouette width"</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> k.best<span class="token punctuation">,</span> paste<span class="token punctuation">(</span><span class="token string">"best"</span><span class="token punctuation">,</span>k.best<span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> col.axis <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="partition.object">

<a href="#partition.object" class="help-page-title"><h2>Partitioning Object</h2></a>

<h3>Description</h3>

<p>The objects of class <code>"partition"</code> represent a partitioning of a
dataset into clusters.
</p>


<h3>Value</h3>

<p>a <code>"partition"</code> object is a list with the following
(and typically more) components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>

<p>the clustering vector.  An integer vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>, the number of
observations, giving for each observation the number ('id') of the
cluster to which it belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched <code><a href="https://r-universe.dev/manuals/base.html#call">call</a></code> generating the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silinfo</code></td>
<td>

<p>a list with all <em>silhouette</em> information, only available when
the number of clusters is non-trivial, i.e., <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>k</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 &lt; k &lt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> and
then has the following components, see <code><a href="#silhouette">silhouette</a></code>
</p>

<dl>
<dt>widths</dt>
<dd>
<p>an (n x 3) matrix, as returned by
<code><a href="#silhouette">silhouette</a>()</code>, with for each observation i the
cluster to which i belongs, as well as the neighbor cluster of i
(the cluster, not containing i, for which the average
dissimilarity between its observations and i is minimal), and
the silhouette width <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code> of the observation.
</p>
</dd>
<dt>clus.avg.widths</dt>
<dd>
<p>the average silhouette width per cluster.</p>
</dd>
<dt>avg.width</dt>
<dd>
<p>the average silhouette width for the dataset, i.e.,
simply the average of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code> over all observations <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code>.</p>
</dd>
</dl>
<p>This information is also needed to construct a <em>silhouette plot</em> of
the clustering, see <code><a href="#plot.partition">plot.partition</a></code>.
</p>
<p>Note that <code>avg.width</code> can be maximized over different
clusterings (e.g. with varying number of clusters) to choose an
<em>optimal</em> clustering.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objective</code></td>
<td>
<p>value of criterion maximized during the
partitioning algorithm, may more than one entry for different stages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>

<p>an object of class <code>"dissimilarity"</code>, representing the total
dissimilarity matrix of the dataset (or relevant subset, e.g. for
<code>clara</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a matrix containing the original or standardized data.  This might
be missing to save memory or when a dissimilarity matrix was given
as input structure to the clustering method.
</p>
</td>
</tr>
</table>
<h3>GENERATION</h3>

<p>These objects are returned from <code>pam</code>, <code>clara</code> or <code>fanny</code>.
</p>


<h3>METHODS</h3>

<p>The <code>"partition"</code> class has a method for the following generic functions:
<code>plot</code>, <code>clusplot</code>.
</p>


<h3>INHERITANCE</h3>

<p>The following classes inherit from class <code>"partition"</code> :
<code>"pam"</code>, <code>"clara"</code> and <code>"fanny"</code>.
</p>
<p>See <code><a href="#pam.object">pam.object</a></code>, <code><a href="#clara.object">clara.object</a></code> and
<code><a href="#fanny.object">fanny.object</a></code> for details.
</p>


<h3>See Also</h3>

<p><code><a href="#pam">pam</a></code>, <code><a href="#clara">clara</a></code>, <code><a href="#fanny">fanny</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="plantTraits">

<a href="#plantTraits" class="help-page-title"><h2>Plant Species Traits Data</h2></a>

<h3>Description</h3>

<p>This dataset constitutes a description of 136 plant species
according to biological attributes (morphological or reproductive)
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>plantTraits<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>A data frame with 136 observations on the following 31 variables.
</p>

<dl>
<dt><code>pdias</code></dt>
<dd>
<p>Diaspore mass (mg)</p>
</dd>
<dt><code>longindex</code></dt>
<dd>
<p>Seed bank longevity</p>
</dd>
<dt><code>durflow</code></dt>
<dd>
<p>Flowering duration</p>
</dd>
<dt><code>height</code></dt>
<dd>
<p>Plant height, an ordered factor with levels
<code>1</code> &lt; <code>2</code> &lt; ... &lt; <code>8</code>.</p>
</dd>
</dl>
<dl>
<dt><code>begflow</code></dt>
<dd>
<p>Time of first flowering, an ordered factor with levels <code>1</code> &lt; <code>2</code> &lt; <code>3</code> &lt; <code>4</code> &lt; <code>5</code> &lt; <code>6</code> &lt; <code>7</code> &lt; <code>8</code> &lt; <code>9</code></p>
</dd>
</dl>
<dl>
<dt><code>mycor</code></dt>
<dd>
<p>Mycorrhizas, an ordered factor with levels <code>0</code>never &lt; <code>1</code> sometimes&lt; <code>2</code>always</p>
</dd>
<dt><code>vegaer</code></dt>
<dd>
<p>aerial vegetative propagation, an ordered
factor with levels <code>0</code>never &lt; <code>1</code> present but limited&lt; <code>2</code>important.</p>
</dd>
<dt><code>vegsout</code></dt>
<dd>
<p>underground vegetative propagation, an ordered
factor with 3 levels identical to <code>vegaer</code> above.</p>
</dd>
<dt><code>autopoll</code></dt>
<dd>
<p>selfing pollination, an ordered factor with
levels <code>0</code>never &lt; <code>1</code>rare &lt; <code>2</code> often&lt; the rule<code>3</code></p>
</dd>
<dt><code>insects</code></dt>
<dd>
<p>insect pollination, an ordered factor with 5 levels <code>0</code> &lt; ... &lt; <code>4</code>.</p>
</dd>
<dt><code>wind</code></dt>
<dd>
<p>wind pollination, an ordered factor with 5 levels <code>0</code> &lt; ... &lt; <code>4</code>.</p>
</dd>
<dt><code>lign</code></dt>
<dd>
<p>a binary factor with levels <code>0:1</code>,
indicating if plant is woody.</p>
</dd>
<dt><code>piq</code></dt>
<dd>
<p>a binary factor indicating if plant is thorny.</p>
</dd>
<dt><code>ros</code></dt>
<dd>
<p>a binary factor indicating if plant is rosette.</p>
</dd>
<dt><code>semiros</code></dt>
<dd>
<p>semi-rosette plant, a binary factor (<code>0</code>:
no; <code>1</code>: yes).</p>
</dd>
<dt><code>leafy</code></dt>
<dd>
<p>leafy plant, a binary factor.</p>
</dd>
<dt><code>suman</code></dt>
<dd>
<p>summer annual, a binary factor.</p>
</dd>
<dt><code>winan</code></dt>
<dd>
<p>winter annual, a binary factor.</p>
</dd>
<dt><code>monocarp</code></dt>
<dd>
<p>monocarpic perennial, a binary factor.</p>
</dd>
<dt><code>polycarp</code></dt>
<dd>
<p>polycarpic perennial, a binary factor.</p>
</dd>
<dt><code>seasaes</code></dt>
<dd>
<p>seasonal aestival leaves, a binary factor.</p>
</dd>
<dt><code>seashiv</code></dt>
<dd>
<p>seasonal hibernal leaves, a binary factor.</p>
</dd>
<dt><code>seasver</code></dt>
<dd>
<p>seasonal vernal leaves, a binary factor.</p>
</dd>
<dt><code>everalw</code></dt>
<dd>
<p>leaves always evergreen, a binary factor.</p>
</dd>
<dt><code>everparti</code></dt>
<dd>
<p>leaves partially evergreen, a binary factor.</p>
</dd>
<dt><code>elaio</code></dt>
<dd>
<p>fruits with an elaiosome (dispersed by ants), a binary factor.</p>
</dd>
<dt><code>endozoo</code></dt>
<dd>
<p>endozoochorous fruits, a binary factor.</p>
</dd>
<dt><code>epizoo</code></dt>
<dd>
<p>epizoochorous fruits, a binary factor.</p>
</dd>
<dt><code>aquat</code></dt>
<dd>
<p>aquatic dispersal fruits, a binary factor.</p>
</dd>
<dt><code>windgl</code></dt>
<dd>
<p>wind dispersed fruits,  a binary factor.</p>
</dd>
<dt><code>unsp</code></dt>
<dd>
<p>unspecialized mechanism of seed dispersal, a binary factor.</p>
</dd>
</dl>
<h3>Details</h3>

<p>Most of factor attributes are not disjunctive. For example, a plant can be usually
pollinated by insects but sometimes self-pollination can occured.
</p>


<h3>Source</h3>

<p>Vallet, Jeanne (2005)
<em>Structuration de communautés végétales et analyse comparative de
traits biologiques le long d'un gradient d'urbanisation</em>.
Mémoire de Master 2 'Ecologie-Biodiversité-Evolution';
Université Paris Sud XI, 30p.+ annexes (in french)
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>plantTraits<span class="token punctuation">)</span>

<span class="token comment">## Calculation of a dissimilarity matrix</span>
library<span class="token punctuation">(</span>cluster<span class="token punctuation">)</span>
dai.b <span class="token operator">&lt;-</span> daisy<span class="token punctuation">(</span>plantTraits<span class="token punctuation">,</span>
               type <span class="token operator">=</span> list<span class="token punctuation">(</span>ordratio <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">,</span> symm <span class="token operator">=</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">13</span><span class="token punctuation">,</span> asymm <span class="token operator">=</span> <span class="token number">14</span><span class="token operator">:</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Hierarchical classification</span>
agn.trts <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>dai.b<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"ward"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>agn.trts<span class="token punctuation">,</span> which.plots <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> cex<span class="token operator">=</span> <span class="token number">0.6</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>agn.trts<span class="token punctuation">,</span> which.plots <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
cutree6 <span class="token operator">&lt;-</span> cutree<span class="token punctuation">(</span>agn.trts<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>
cutree6

<span class="token comment">## Principal Coordinate Analysis</span>
cmdsdai.b <span class="token operator">&lt;-</span> cmdscale<span class="token punctuation">(</span>dai.b<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>cmdsdai.b<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> asp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">=</span> cutree6<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.agnes">

<a href="#plot.agnes" class="help-page-title"><h2>Plots of an Agglomerative Hierarchical Clustering</h2></a>

<h3>Description</h3>

<p>Creates plots for visualizing an <code>agnes</code> object.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'agnes'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> ask <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> which.plots <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
           sub <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"Agglomerative Coefficient = "</span><span class="token punctuation">,</span>round<span class="token punctuation">(</span>x<span class="token operator">$</span>ac<span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           adj <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> nmax.lab <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">,</span> max.strlen <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> xax.pretty <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"agnes"</code>, typically created by
<code><a href="#agnes">agnes</a>(.)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if true and <code>which.plots</code> is <code>NULL</code>,
<code>plot.agnes</code> operates in interactive mode, via <code><a href="https://r-universe.dev/manuals/utils.html#menu">menu</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.plots</code></td>
<td>
<p>integer vector or NULL (default), the latter
producing both plots.  Otherwise, <code>which.plots</code>
must contain integers of <code>1</code> for a <em>banner</em> plot or <code>2</code> for a
dendrogram or “clustering tree”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, sub</code></td>
<td>
<p>main and sub title for the plot, with convenient
defaults.  See documentation for these arguments in <code><a href="https://r-universe.dev/manuals/graphics.html#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>for label adjustment in <code><a href="#bannerplot">bannerplot</a>()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax.lab</code></td>
<td>
<p>integer indicating the number of labels which is
considered too large for single-name labelling the banner plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.strlen</code></td>
<td>
<p>positive integer giving the length to which
strings are truncated in banner plot labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax.pretty</code></td>
<td>
<p>logical or integer indicating if
<code><a href="https://r-universe.dev/manuals/base.html#pretty">pretty</a>(*, n = xax.pretty)</code> should be used for the x axis.
<code>xax.pretty = FALSE</code> is for back compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters (see <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>) may also
be supplied and are passed to <code><a href="#bannerplot">bannerplot</a>()</code> or
<code>pltree()</code> (see <code><a href="#pltree">pltree.twins</a></code>), respectively.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>ask = TRUE</code>, rather than producing each plot sequentially,
<code>plot.agnes</code> displays a menu listing all the plots that can be produced.
If the menu is not desired but a pause between plots is still wanted
one must set <code>par(ask= TRUE)</code> before invoking the plot command.
</p>
<p>The banner displays the hierarchy of clusters, and is equivalent to a tree.
See Rousseeuw (1986) or chapter 5 of Kaufman and Rousseeuw (1990).
The banner plots distances at which observations and clusters are merged.
The observations are listed in the order found by the <code>agnes</code> algorithm,
and the numbers in the <code>height</code> vector are represented as bars
between the observations.
</p>
<p>The leaves of the clustering tree are the original observations.  Two
branches come together at the distance between the two clusters being merged.
</p>
<p>For more customization of the plots, rather call
<code><a href="#bannerplot">bannerplot</a></code> and <code>pltree()</code>, i.e., its method
<code><a href="#pltree">pltree.twins</a></code>, respectively.
</p>
<p>directly with
corresponding arguments, e.g., <code>xlab</code> or <code>ylab</code>.
</p>


<h3>Side Effects</h3>

<p>Appropriate plots are produced on the current graphics device. This can
be one or both of the following choices:
<br> Banner
<br> Clustering tree
</p>


<h3>Note</h3>

<p>In the banner plot, observation labels are only printed when the
number of observations is limited less than <code>nmax.lab</code> (35, by
default), for readability.  Moreover, observation labels are truncated
to maximally <code>max.strlen</code> (5) characters.
</p>
<p>For the dendrogram, more flexibility than via <code>pltree()</code> is
provided by <code>dg &lt;- <a href="https://r-universe.dev/manuals/stats.html#dendrogram">as.dendrogram</a>(x)</code> and
plotting <code>dg</code> via <code><a href="https://r-universe.dev/manuals/stats.html#plot.dendrogram">plot.dendrogram</a></code>.
</p>


<h3>References</h3>

<p>Kaufman, L. and Rousseeuw, P.J. (1990)
<em>Finding Groups in Data: An Introduction to Cluster Analysis</em>.
Wiley, New York.
</p>
<p>Rousseeuw, P.J. (1986). A visual display for hierarchical classification,
in <em>Data Analysis and Informatics 4</em>; edited by E. Diday,
Y. Escoufier, L. Lebart, J. Pages, Y. Schektman, and R. Tomassone.
North-Holland, Amsterdam, 743–748.
</p>
<p>Struyf, A., Hubert, M. and Rousseeuw, P.J. (1997)
Integrating Robust Clustering Techniques in S-PLUS,
<em>Computational Statistics and Data Analysis</em>, <b>26</b>, 17–37.
</p>


<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code> and <code><a href="#agnes.object">agnes.object</a></code>;
<code><a href="#bannerplot">bannerplot</a></code>, <code><a href="#pltree">pltree.twins</a></code>,
and <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Can also pass 'labels' to pltree() and bannerplot():</span>
data<span class="token punctuation">(</span>iris<span class="token punctuation">)</span>
cS <span class="token operator">&lt;-</span> as.character<span class="token punctuation">(</span>Sp <span class="token operator">&lt;-</span> iris<span class="token operator">$</span>Species<span class="token punctuation">)</span>
cS<span class="token punctuation">[</span>Sp <span class="token operator">==</span> <span class="token string">"setosa"</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token string">"S"</span>
cS<span class="token punctuation">[</span>Sp <span class="token operator">==</span> <span class="token string">"versicolor"</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token string">"V"</span>
cS<span class="token punctuation">[</span>Sp <span class="token operator">==</span> <span class="token string">"virginica"</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token string">"g"</span>
ai <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>ai<span class="token punctuation">,</span> labels <span class="token operator">=</span> cS<span class="token punctuation">,</span> nmax <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token comment"># bannerplot labels are mess</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.diana">

<a href="#plot.diana" class="help-page-title"><h2>Plots of a Divisive Hierarchical Clustering</h2></a>

<h3>Description</h3>

<p>Creates plots for visualizing a <code>diana</code> object.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'diana'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> ask <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> which.plots <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
           sub <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"Divisive Coefficient = "</span><span class="token punctuation">,</span> round<span class="token punctuation">(</span>x<span class="token operator">$</span>dc<span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           adj <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> nmax.lab <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">,</span> max.strlen <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> xax.pretty <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"diana"</code>, typically created by
<code><a href="#diana">diana</a>(.)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if true and <code>which.plots</code> is <code>NULL</code>,
<code>plot.diana</code> operates in interactive mode, via <code><a href="https://r-universe.dev/manuals/utils.html#menu">menu</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.plots</code></td>
<td>
<p>integer vector or NULL (default), the latter
producing both plots.  Otherwise, <code>which.plots</code>
must contain integers of <code>1</code> for a <em>banner</em> plot or <code>2</code> for a
dendrogram or “clustering tree”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, sub</code></td>
<td>
<p>main and sub title for the plot, each with a convenient
default.  See documentation for these arguments in
<code><a href="https://r-universe.dev/manuals/graphics.html#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>for label adjustment in <code><a href="#bannerplot">bannerplot</a>()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax.lab</code></td>
<td>
<p>integer indicating the number of labels which is
considered too large for single-name labelling the banner plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.strlen</code></td>
<td>
<p>positive integer giving the length to which
strings are truncated in banner plot labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax.pretty</code></td>
<td>
<p>logical or integer indicating if
<code><a href="https://r-universe.dev/manuals/base.html#pretty">pretty</a>(*, n = xax.pretty)</code> should be used for the x axis.
<code>xax.pretty = FALSE</code> is for back compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters (see <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>) may also
be supplied and are passed to <code><a href="#bannerplot">bannerplot</a>()</code> or
<code><a href="#pltree">pltree</a>()</code>, respectively.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>ask = TRUE</code>, rather than producing each plot sequentially,
<code>plot.diana</code> displays a menu listing all the plots that can be produced.
If the menu is not desired but a pause between plots is still wanted
one must set <code>par(ask= TRUE)</code> before invoking the plot command.
</p>
<p>The banner displays the hierarchy of clusters, and is equivalent to a tree.
See Rousseeuw (1986) or chapter 6 of Kaufman and Rousseeuw (1990).
The banner plots the diameter of each cluster being splitted.
The observations are listed in the order found by the <code>diana</code>
algorithm, and the numbers in the <code>height</code> vector are represented
as bars between the observations.
</p>
<p>The leaves of the clustering tree are the original observations.
A branch splits up at the diameter of the cluster being splitted.
</p>


<h3>Side Effects</h3>

<p>An appropriate plot is produced on the current graphics device. This can
be one or both of the following choices:
<br> Banner
<br> Clustering tree
</p>


<h3>Note</h3>

<p>In the banner plot,
observation labels are only printed when the number of observations is
limited less than <code>nmax.lab</code> (35, by default), for readability.
Moreover, observation labels are truncated to maximally
<code>max.strlen</code> (5) characters.
</p>


<h3>References</h3>

<p>see those in <code><a href="#plot.agnes">plot.agnes</a></code>.</p>


<h3>See Also</h3>

<p><code><a href="#diana">diana</a></code>, <code><a href="#diana">diana.object</a></code>,
<code><a href="#twins.object">twins.object</a></code>, <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">example<span class="token punctuation">(</span>diana<span class="token punctuation">)</span><span class="token comment"># -&gt; dv &lt;- diana(....)</span>

plot<span class="token punctuation">(</span>dv<span class="token punctuation">,</span> which <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> nmax.lab <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span>

<span class="token comment">## wider labels :</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mar <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"mar"</span><span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>dv<span class="token punctuation">,</span> which <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> nmax.lab <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> max.strlen <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.mona">

<a href="#plot.mona" class="help-page-title"><h2>Banner of Monothetic Divisive Hierarchical Clusterings</h2></a>

<h3>Description</h3>

<p>Creates the banner of a <code>mona</code> object.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'mona'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> main <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"Banner of "</span><span class="token punctuation">,</span> deparse1<span class="token punctuation">(</span>x<span class="token operator">$</span>call<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          sub <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Separation step"</span><span class="token punctuation">,</span>
	  col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
          nmax.lab <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">,</span> max.strlen <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"mona"</code>, typically created by
<code><a href="#mona">mona</a>(.)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main,sub</code></td>
<td>
<p>main and sub titles for the plot, with convenient
defaults.  See documentation in <code><a href="https://r-universe.dev/manuals/graphics.html#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x axis label, see <code><a href="https://r-universe.dev/manuals/graphics.html#title">title</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col,adj</code></td>
<td>
<p>graphical parameters passed to <code><a href="#bannerplot">bannerplot</a>()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>logical, indicating if (labeled) axes should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax.lab</code></td>
<td>
<p>integer indicating the number of labels which is
considered too large for labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.strlen</code></td>
<td>
<p>positive integer giving the length to which
strings are truncated in labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further graphical arguments are passed to
<code><a href="#bannerplot">bannerplot</a>()</code> and <code><a href="https://r-universe.dev/manuals/graphics.html#text">text</a></code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Plots the separation step at which clusters are splitted.  The
observations are given in the order found by the <code>mona</code>
algorithm, the numbers in the <code>step</code> vector are represented as
bars between the observations.
</p>
<p>When a long bar is drawn between two observations,
those observations have the same value for each variable.
See chapter 7 of Kaufman and Rousseeuw (1990).
</p>


<h3>Side Effects</h3>

<p>A banner is plotted on the current graphics device.
</p>


<h3>Note</h3>

<p>In the banner plot,
observation labels are only printed when the number of observations is
limited less than <code>nmax.lab</code> (35, by default), for readability.
Moreover, observation labels are truncated to maximally
<code>max.strlen</code> (5) characters.
</p>


<h3>References</h3>

<p>see those in <code><a href="#plot.agnes">plot.agnes</a></code>.</p>


<h3>See Also</h3>

<p><code><a href="#mona">mona</a></code>, <code><a href="#mona.object">mona.object</a></code>, <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="plot.partition">

<a href="#plot.partition" class="help-page-title"><h2>Plot of a Partition of the Data Set</h2></a>

<h3>Description</h3>

<p>Creates plots for visualizing a <code>partition</code> object.</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'partition'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> ask <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> which.plots <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
     nmax.lab <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">,</span> max.strlen <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> data <span class="token operator">=</span> x<span class="token operator">$</span>data<span class="token punctuation">,</span> dist <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
     stand <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> lines <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
     shade <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> plotchar <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
     span <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"partition"</code>, typically created by the
functions <code><a href="#pam">pam</a></code>, <code><a href="#clara">clara</a></code>, or <code><a href="#fanny">fanny</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if true and <code>which.plots</code> is <code>NULL</code>,
<code>plot.partition</code> operates in interactive mode, via <code><a href="https://r-universe.dev/manuals/utils.html#menu">menu</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.plots</code></td>
<td>
<p>integer vector or NULL (default), the latter
producing both plots.  Otherwise, <code>which.plots</code> must contain
integers of <code>1</code> for a <em>clusplot</em> or <code>2</code> for
<em>silhouette</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax.lab</code></td>
<td>
<p>integer indicating the number of labels which is
considered too large for single-name labeling the silhouette plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.strlen</code></td>
<td>
<p>positive integer giving the length to which
strings are truncated in silhouette plot labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>numeric matrix with the scaled data; per default taken
from the partition object <code>x</code>, but can be specified explicitly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>when <code>x</code> does not have a <code>diss</code> component as for
<code><a href="#pam">pam</a>(*, keep.diss=FALSE)</code>, <code>dist</code> must be the
dissimilarity if a clusplot is desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand,lines,shade,color,labels,plotchar,span,xlim,ylim,main, ...</code></td>
<td>

<p>All optional arguments available for the <code><a href="#clusplot.default">clusplot.default</a></code>
function (except for the <code>diss</code> one) and graphical parameters
(see <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>) may also be supplied as arguments to this function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>ask= TRUE</code>, rather than producing each plot sequentially,
<code>plot.partition</code> displays a menu listing all the plots that can
be produced.
If the menu is not desired but a pause between plots is still wanted,
call <code>par(ask= TRUE)</code> before invoking the plot command.
</p>
<p>The <em>clusplot</em> of a cluster partition consists of a two-dimensional
representation of the observations, in which the clusters are
indicated by ellipses (see <code><a href="#clusplot.partition">clusplot.partition</a></code> for more
details).
</p>
<p>The <em>silhouette plot</em> of a nonhierarchical clustering is fully
described in Rousseeuw (1987) and in chapter 2 of Kaufman and
Rousseeuw (1990).
For each observation i, a bar is drawn, representing its silhouette
width s(i), see <code><a href="#silhouette">silhouette</a></code> for details.
Observations are grouped per cluster, starting with cluster 1 at the
top.  Observations with a large s(i) (almost 1) are very well
clustered, a small s(i) (around 0) means that the observation lies
between two clusters, and observations with a negative s(i) are
probably placed in the wrong cluster.
</p>
<p>A clustering can be performed for several values of <code>k</code> (the number of
clusters).  Finally, choose the value of <code>k</code> with the largest overall
average silhouette width.
</p>


<h3>Side Effects</h3>

<p>An appropriate plot is produced on the current graphics device.  This
can be one or both of the following choices:
<br> Clusplot
<br> Silhouette plot
</p>


<h3>Note</h3>

<p>In the silhouette plot, observation labels are only printed when the
number of observations is less than <code>nmax.lab</code> (40, by default),
for readability.  Moreover, observation labels are truncated to
maximally <code>max.strlen</code> (5) characters.  <br>
For more flexibility, use <code>plot(silhouette(x), ...)</code>, see
<code><a href="#silhouette">plot.silhouette</a></code>.
</p>


<h3>References</h3>

<p>Rousseeuw, P.J. (1987)
Silhouettes: A graphical aid to the interpretation and validation of
cluster analysis. <em>J. Comput. Appl. Math.</em>, <b>20</b>, 53–65.
</p>
<p>Further, the references in <code><a href="#plot.agnes">plot.agnes</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#partition.object">partition.object</a></code>, <code><a href="#clusplot.partition">clusplot.partition</a></code>,
<code><a href="#clusplot.default">clusplot.default</a></code>, <code><a href="#pam">pam</a></code>,
<code><a href="#pam.object">pam.object</a></code>, <code><a href="#clara">clara</a></code>,
<code><a href="#clara.object">clara.object</a></code>, <code><a href="#fanny">fanny</a></code>,
<code><a href="#fanny.object">fanny.object</a></code>, <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## generate 25 objects, divided into 2 clusters.</span>
x <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>pam<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Save space not keeping data in clus.object, and still clusplot() it:</span>
data<span class="token punctuation">(</span>xclara<span class="token punctuation">)</span>
cx <span class="token operator">&lt;-</span> clara<span class="token punctuation">(</span>xclara<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> keep.data <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
cx<span class="token operator">$</span>data <span class="token comment"># is NULL</span>
plot<span class="token punctuation">(</span>cx<span class="token punctuation">,</span> data <span class="token operator">=</span> xclara<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pltree">

<a href="#pltree" class="help-page-title"><h2>Plot Clustering Tree of a Hierarchical Clustering</h2></a>

<h3>Description</h3>

<p><code>pltree()</code> Draws a clustering tree (“dendrogram”) on the
current graphics device.  We provide the <code>twins</code> method draws the
tree of a <code>twins</code> object, i.e., hierarchical clustering,
typically resulting from <code><a href="#agnes">agnes</a>()</code> or <code><a href="#diana">diana</a>()</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pltree<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'twins'</span>
pltree<span class="token punctuation">(</span>x<span class="token punctuation">,</span> main <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"Dendrogram of "</span><span class="token punctuation">,</span> deparse1<span class="token punctuation">(</span>x<span class="token operator">$</span>call<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             labels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Height"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>in general, an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object for which a <code>pltree</code> method is
defined; specifically, an object of class <code>"twins"</code>, typically
created by either <code><a href="#agnes">agnes</a>()</code> or <code><a href="#diana">diana</a>()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title with a sensible default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>labels to use; the default is constructed from <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label for y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters (see <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>) may also
be supplied as arguments to this function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Creates a plot of a clustering tree given a <code>twins</code> object.  The
leaves of the tree are the original observations.  In case of an
agglomerative clustering, two branches come together at the distance
between the two clusters being merged.  For a divisive clustering, a
branch splits up at the diameter of the cluster being splitted.
</p>
<p>Note that currently the method function simply calls
<code>plot(<a href="https://r-universe.dev/manuals/stats.html#as.hclust">as.hclust</a>(x), ...)</code>, which dispatches to
<code><a href="https://r-universe.dev/manuals/stats.html#hclust">plot.hclust</a>(..)</code>.  If more flexible plots are needed,
consider <code>xx &lt;- <a href="https://r-universe.dev/manuals/stats.html#dendrogram">as.dendrogram</a>(<a href="https://r-universe.dev/manuals/stats.html#as.hclust">as.hclust</a>(x))</code> and plotting
<code>xx</code>, see <code><a href="https://r-universe.dev/manuals/stats.html#dendrogram">plot.dendrogram</a></code>.
</p>


<h3>Value</h3>

<p>a NULL value is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code>, <code><a href="#agnes.object">agnes.object</a></code>, <code><a href="#diana">diana</a></code>,
<code><a href="#diana">diana.object</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#hclust">hclust</a></code>, <code><a href="https://r-universe.dev/manuals/graphics.html#par">par</a></code>,
<code><a href="#plot.agnes">plot.agnes</a></code>, <code><a href="#plot.diana">plot.diana</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span>
agn <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span>
pltree<span class="token punctuation">(</span>agn<span class="token punctuation">)</span>

dagn  <span class="token operator">&lt;-</span> as.dendrogram<span class="token punctuation">(</span>as.hclust<span class="token punctuation">(</span>agn<span class="token punctuation">)</span><span class="token punctuation">)</span>
dagn2 <span class="token operator">&lt;-</span> as.dendrogram<span class="token punctuation">(</span>as.hclust<span class="token punctuation">(</span>agn<span class="token punctuation">)</span><span class="token punctuation">,</span> hang <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">)</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mar <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"mar"</span><span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># more space to the right</span>
plot<span class="token punctuation">(</span>dagn2<span class="token punctuation">,</span> horiz <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>dagn<span class="token punctuation">,</span> horiz <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> center <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
     nodePar <span class="token operator">=</span> list<span class="token punctuation">(</span>lab.cex <span class="token operator">=</span> <span class="token number">0.6</span><span class="token punctuation">,</span> lab.col <span class="token operator">=</span> <span class="token string">"forest green"</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> deparse<span class="token punctuation">(</span>agn<span class="token operator">$</span>call<span class="token punctuation">)</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pluton">

<a href="#pluton" class="help-page-title"><h2>Isotopic Composition Plutonium Batches</h2></a>

<h3>Description</h3>

<p>The <code>pluton</code> data frame has 45 rows and 4 columns,
containing percentages of isotopic composition of 45 Plutonium
batches.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>pluton<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Pu238</dt>
<dd>
<p>the percentages of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext> </mtext><mn>238</mn></msup><mi>P</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">\ ^{238}Pu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mspace"> </span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">238</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">u</span></span></span></span></code>,
always less than 2 percent.</p>
</dd>
<dt>Pu239</dt>
<dd>
<p>the percentages of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext> </mtext><mn>239</mn></msup><mi>P</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">\ ^{239}Pu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mspace"> </span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">239</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">u</span></span></span></span></code>,
typically between 60 and 80 percent (from neutron capture of Uranium,
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext> </mtext><mn>238</mn></msup><mi>U</mi></mrow><annotation encoding="application/x-tex">\ ^{238}U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mspace"> </span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">238</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></code>).</p>
</dd>
<dt>Pu240</dt>
<dd>
<p>percentage of the plutonium 240 isotope.</p>
</dd>
<dt>Pu241</dt>
<dd>
<p>percentage of the plutonium 241 isotope.</p>
</dd>
</dl>
<h3>Details</h3>

<p>Note that the percentage of plutonium~242 can be computed from the
other four percentages, see the examples.
</p>
<p>In the reference below it is explained why it is very desirable to
combine these plutonium patches in three groups of similar size.
</p>


<h3>Source</h3>

<p>Available as ‘<span class="file">pluton.dat</span>’ from the archive of the University of Antwerpen,




‘<span class="file">..../datasets/clusplot-examples.tar.gz</span>’, no longer available.
</p>


<h3>References</h3>

<p>Rousseeuw, P.J. and Kaufman, L and Trauwaert, E. (1996)
Fuzzy clustering using scatter matrices,
<em>Computational Statistics and Data Analysis</em> <b>23</b>(1), 135–151.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>pluton<span class="token punctuation">)</span>

hist<span class="token punctuation">(</span>apply<span class="token punctuation">(</span>pluton<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>sum<span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray"</span><span class="token punctuation">)</span> <span class="token comment"># between 94% and 100%</span>
pu5 <span class="token operator">&lt;-</span> pluton
pu5<span class="token operator">$</span>Pu242 <span class="token operator">&lt;-</span> <span class="token number">100</span> <span class="token operator">-</span> apply<span class="token punctuation">(</span>pluton<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>sum<span class="token punctuation">)</span> <span class="token comment"># the remaining isotope.</span>
pairs<span class="token punctuation">(</span>pu5<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="predict.ellipsoid">

<a href="#predict.ellipsoid" class="help-page-title"><h2>Predict Method for Ellipsoid Objects</h2></a>

<h3>Description</h3>

<p>Compute points on the ellipsoid boundary, mostly for drawing.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">predict.ellipsoid<span class="token punctuation">(</span>object<span class="token punctuation">,</span> n.out<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'ellipsoid'</span>
predict<span class="token punctuation">(</span>object<span class="token punctuation">,</span> n.out<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
ellipsoidPoints<span class="token punctuation">(</span>A<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> loc<span class="token punctuation">,</span> n.half <span class="token operator">=</span> <span class="token number">201</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>ellipsoid</code>, typically from
<code><a href="#ellipsoidhull">ellipsoidhull</a>()</code>; alternatively any list-like object
with proper components, see details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.out, n.half</code></td>
<td>
<p>half the number of points to create.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A, d2, loc</code></td>
<td>
<p>arguments of the auxilary <code>ellipsoidPoints</code>,
see below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to and from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note <code>ellipsoidPoints</code> is the workhorse function of
<code>predict.ellipsoid</code> a standalone function and method for
<code>ellipsoid</code> objects, see <code><a href="#ellipsoidhull">ellipsoidhull</a></code>.
The class of <code>object</code> is not checked; it must solely have valid
components <code>loc</code> (length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code>), the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">p \times p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code>
matrix <code>cov</code> (corresponding to <code>A</code>) and <code>d2</code> for the
center, the shape (“covariance”) matrix and the squared average
radius (or distance) or <code><a href="https://r-universe.dev/manuals/stats.html#Chisquare">qchisq</a>(*, p)</code> quantile.
</p>
<p>Unfortunately, this is only implemented for <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">p = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code>, currently;
contributions for <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≥</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">p \ge 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></code> are <em>very welcome</em>.
</p>


<h3>Value</h3>

<p>a numeric matrix of dimension <code>2*n.out</code> times <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#ellipsoidhull">ellipsoidhull</a></code>, <code><a href="#volume.ellipsoid">volume.ellipsoid</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## see also  example(ellipsoidhull)</span><span class="token comment">## Robust vs. L.S. covariance matrix</span>
set.seed<span class="token punctuation">(</span><span class="token number">143</span><span class="token punctuation">)</span>
x <span class="token operator">&lt;-</span> rt<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> <span class="token number">3</span><span class="token operator">*</span>x <span class="token operator">+</span> rt<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span> main<span class="token operator">=</span><span class="token string">"non-normal data (N=200)"</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"with classical and robust cov.matrix ellipsoids"</span><span class="token punctuation">)</span>
X <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
C.ls <span class="token operator">&lt;-</span> cov<span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token punctuation">;</span> m.ls <span class="token operator">&lt;-</span> colMeans<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
d2.<span class="token number">99</span> <span class="token operator">&lt;-</span> qchisq<span class="token punctuation">(</span><span class="token number">0.99</span><span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>ellipsoidPoints<span class="token punctuation">(</span>C.ls<span class="token punctuation">,</span> d2.<span class="token number">99</span><span class="token punctuation">,</span> loc<span class="token operator">=</span>m.ls<span class="token punctuation">)</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"green"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>require<span class="token punctuation">(</span>MASS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Cxy <span class="token operator">&lt;-</span> cov.rob<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
  lines<span class="token punctuation">(</span>ellipsoidPoints<span class="token punctuation">(</span>Cxy<span class="token operator">$</span>cov<span class="token punctuation">,</span> d2 <span class="token operator">=</span> d2.<span class="token number">99</span><span class="token punctuation">,</span> loc<span class="token operator">=</span>Cxy<span class="token operator">$</span>center<span class="token punctuation">)</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token comment"># MASS</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="print.agnes">

<a href="#print.agnes" class="help-page-title"><h2>Print Method for AGNES Objects</h2></a>

<h3>Description</h3>

<p>Prints the call, agglomerative coefficient, ordering of objects and
distances between merging clusters ('Height') of an <code>agnes</code> object.
</p>
<p>This is a method for the generic <code><a href="https://r-universe.dev/manuals/base.html#print">print</a>()</code> function for objects
inheriting from class <code>agnes</code>, see <code><a href="#agnes.object">agnes.object</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'agnes'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an agnes object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (required by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#summary.agnes">summary.agnes</a></code> producing more output;
<code><a href="#agnes">agnes</a></code>, <code><a href="#agnes.object">agnes.object</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="print.clara">

<a href="#print.clara" class="help-page-title"><h2>Print Method for CLARA Objects</h2></a>

<h3>Description</h3>

<p>Prints the best sample, medoids, clustering vector and objective function
of <code>clara</code> object.
</p>
<p>This is a method for the function <code><a href="https://r-universe.dev/manuals/base.html#print">print</a>()</code> for objects
inheriting from class <code><a href="#clara">clara</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'clara'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a clara object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#summary.clara">summary.clara</a></code> producing more output;
<code><a href="#clara">clara</a></code>, <code><a href="#clara.object">clara.object</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="print.diana">

<a href="#print.diana" class="help-page-title"><h2>Print Method for DIANA Objects</h2></a>

<h3>Description</h3>

<p>Prints the ordering of objects, diameters of splitted clusters,
and divisive coefficient of a <code>diana</code> object.
</p>
<p>This is a method for the function <code><a href="https://r-universe.dev/manuals/base.html#print">print</a>()</code> for objects
inheriting from class <code><a href="#diana">diana</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'diana'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a diana object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#diana">diana</a></code>, <code><a href="#diana">diana.object</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="print.dissimilarity">

<a href="#print.dissimilarity" class="help-page-title"><h2>Print and Summary Methods for Dissimilarity Objects</h2></a>

<h3>Description</h3>

<p>Print or summarize the distances and the attributes of a
<code>dissimilarity</code> object.
</p>
<p>These are methods for the functions <code>print()</code> and <code>summary()</code> for
<code>dissimilarity</code> objects.  See <code>print</code>, <code>print.default</code>,
or <code>summary</code> for the general behavior of these.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'dissimilarity'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> diag <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> upper <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
      digits <span class="token operator">=</span> getOption<span class="token punctuation">(</span><span class="token string">"digits"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> justify <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'dissimilarity'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span>
        digits <span class="token operator">=</span> max<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> getOption<span class="token punctuation">(</span><span class="token string">"digits"</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'summary.dissimilarity'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>a <code>dissimilarity</code> object or a
<code>summary.dissimilarity</code> one for <code>print.summary.dissimilarity()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of digits to use, see <code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag, upper, justify, right</code></td>
<td>
<p>optional arguments specifying how
the triangular dissimilarity matrix is printed; see
<code><a href="https://r-universe.dev/manuals/stats.html#print.dist">print.dist</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#daisy">daisy</a></code>, <code><a href="#dissimilarity.object">dissimilarity.object</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#dist">print.dist</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## See  example(daisy)</span>

 sd <span class="token operator">&lt;-</span> summary<span class="token punctuation">(</span>daisy<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 sd <span class="token comment"># -&gt; print.summary.dissimilarity(.)</span>
 str<span class="token punctuation">(</span>sd<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="print.fanny">

<a href="#print.fanny" class="help-page-title"><h2>Print and Summary Methods for FANNY Objects</h2></a>

<h3>Description</h3>

<p>Prints the objective function, membership coefficients and clustering vector
of <code>fanny</code> object.
</p>
<p>This is a method for the function <code><a href="https://r-universe.dev/manuals/base.html#print">print</a>()</code> for objects
inheriting from class <code><a href="#fanny">fanny</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'fanny'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> digits <span class="token operator">=</span> getOption<span class="token punctuation">(</span><span class="token string">"digits"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'fanny'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'summary.fanny'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> digits <span class="token operator">=</span> getOption<span class="token punctuation">(</span><span class="token string">"digits"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>a <code><a href="#fanny">fanny</a></code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of significant digits for printing, see
<code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (required by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#fanny">fanny</a></code>, <code><a href="#fanny.object">fanny.object</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="print.mona">

<a href="#print.mona" class="help-page-title"><h2>Print Method for MONA Objects</h2></a>

<h3>Description</h3>

<p>Prints the ordering of objects, separation steps, and used variables
of a <code>mona</code> object.
</p>
<p>This is a method for the function <code><a href="https://r-universe.dev/manuals/base.html#print">print</a>()</code> for objects
inheriting from class <code><a href="#mona">mona</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'mona'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a mona object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#mona">mona</a></code>, <code><a href="#mona.object">mona.object</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="print.pam">

<a href="#print.pam" class="help-page-title"><h2>Print Method for PAM Objects</h2></a>

<h3>Description</h3>

<p>Prints the medoids, clustering vector and objective function
of <code>pam</code> object.
</p>
<p>This is a method for the function <code><a href="https://r-universe.dev/manuals/base.html#print">print</a>()</code> for objects
inheriting from class <code><a href="#pam">pam</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pam'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a pam object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#pam">pam</a></code>, <code><a href="#pam.object">pam.object</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="ruspini">

<a href="#ruspini" class="help-page-title"><h2>Ruspini Data</h2></a>

<h3>Description</h3>

<p>The Ruspini data set, consisting of 75 points in four groups that is
popular for illustrating clustering techniques.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>ruspini<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>A data frame with 75 observations on 2 variables giving the x and y
coordinates of the points, respectively.
</p>


<h3>Source</h3>

<p>E. H. Ruspini (1970)
Numerical methods for fuzzy clustering.
<em>Inform. Sci.</em> <b>2</b>, 319–350.
</p>


<h3>References</h3>

<p>see those in <code><a href="#agnes">agnes</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>ruspini<span class="token punctuation">)</span>

<span class="token comment">## Plot similar to Figure 4 in Stryuf et al (1996)</span>
<span class="token comment">## Not run: plot(pam(ruspini, 4), ask = TRUE)</span>


<span class="token comment">## Plot similar to Figure 6 in Stryuf et al (1996)</span>
plot<span class="token punctuation">(</span>fanny<span class="token punctuation">(</span>ruspini<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="silhouette">

<a href="#silhouette" class="help-page-title"><h2>Compute or Extract Silhouette Information from Clustering</h2></a>

<h3>Description</h3>

<p>Compute silhouette information according to a given clustering in
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> clusters.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">silhouette<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## Default S3 method:</span>
  silhouette<span class="token punctuation">(</span>x<span class="token punctuation">,</span> dist<span class="token punctuation">,</span> dmatrix<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'partition'</span>
silhouette<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'clara'</span>
silhouette<span class="token punctuation">(</span>x<span class="token punctuation">,</span> full <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> subset <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

sortSilhouette<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'silhouette'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> FUN <span class="token operator">=</span> mean<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'silhouette'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> nmax.lab <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">,</span> max.strlen <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> sub <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> expression<span class="token punctuation">(</span><span class="token string">"Silhouette width "</span><span class="token operator">*</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     col <span class="token operator">=</span> <span class="token string">"gray"</span><span class="token punctuation">,</span>  do.col.sort <span class="token operator">=</span> length<span class="token punctuation">(</span>col<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
     cex.names <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"cex.axis"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> do.n.k <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> do.clus.stat <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of appropriate class; for the <code>default</code>
method an integer vector with <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> different integer cluster
codes or a list with such an <code>x$clustering</code>
component.  Note that silhouette statistics are only defined if
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 \le k \le n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>a dissimilarity object inheriting from class
<code><a href="https://r-universe.dev/manuals/stats.html#dist">dist</a></code> or coercible to one.  If not specified,
<code>dmatrix</code> must be.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmatrix</code></td>
<td>
<p>a symmetric dissimilarity matrix (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code>),
specified instead of <code>dist</code>, which can be more efficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>logical or number in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code> specifying if a <em>full</em>
silhouette should be computed for <code><a href="#clara">clara</a></code> object.  When a
number, say <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></code>, for a random <code><a href="https://r-universe.dev/manuals/base.html#sample">sample.int</a>(n, size = f*n)</code>
of the data the silhouette values are computed.
This requires <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>f</mi><mo>∗</mo><mi>n</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O((f*n)^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> memory, since the full dissimilarity of
the (sub)sample (see <code><a href="#daisy">daisy</a></code>) is needed internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>a subset from <code>1:n</code>, specified instead of <code>full</code>
to specify the indices of the observations to be used for the silhouette
computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>silhouette</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to and from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>function used to summarize silhouette widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax.lab</code></td>
<td>
<p>integer indicating the number of labels which is
considered too large for single-name labeling the silhouette plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.strlen</code></td>
<td>
<p>positive integer giving the length to which
strings are truncated in silhouette plot labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, sub, xlab</code></td>
<td>
<p>arguments to <code><a href="https://r-universe.dev/manuals/graphics.html#title">title</a></code>; have a
sensible non-NULL default here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, border, cex.names</code></td>
<td>
<p>arguments passed
<code><a href="https://r-universe.dev/manuals/graphics.html#barplot">barplot</a>()</code>; note that the default used to be <code>col
      = heat.colors(n), border = par("fg")</code> instead.<br><code>col</code> can also be a color vector of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> for
clusterwise coloring, see also <code>do.col.sort</code>:
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.col.sort</code></td>
<td>
<p>logical indicating if the colors <code>col</code> should
be sorted “along” the silhouette; this is useful for casewise or
clusterwise coloring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.n.k</code></td>
<td>
<p>logical indicating if <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> “title text”
should be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.clus.stat</code></td>
<td>
<p>logical indicating if cluster size and averages
should be written right to the silhouettes.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each observation i, the <em>silhouette width</em> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code> is
defined as follows: <br>
Put a(i) = average dissimilarity between i and all other points of the
cluster to which i belongs (if i is the <em>only</em> observation in
its cluster, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s(i) := 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></code> without further calculations).
For all <em>other</em> clusters C, put <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(i,C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></code> = average
dissimilarity of i to all observations of C.  The smallest of these
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(i,C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></code> is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>C</mi></msub><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b(i) := \min_C d(i,C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></code>,
and can be seen as the dissimilarity between i and its “neighbor”
cluster, i.e., the nearest one to which it does <em>not</em> belong.
Finally, </p>
<p style="text-align: center;"><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mfrac><mrow><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>−</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">s(i) := \frac{b(i) - a(i) }{max(a(i), b(i))}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">))</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">a</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></code>
</p>

<p><code>silhouette.default()</code> is now based on C code donated by Romain
Francois (the R version being still available as
<code>cluster:::silhouette.default.R</code>).
</p>
<p>Observations with a large <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code> (almost 1) are very well
clustered, a small <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code> (around 0) means that the observation
lies between two clusters, and observations with a negative
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code> are probably placed in the wrong cluster.
</p>


<h3>Value</h3>

<p><code>silhouette()</code> returns an object, <code>sil</code>, of class
<code>silhouette</code> which is an <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">n \times 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></code> matrix with
attributes.  For each observation i, <code>sil[i,]</code> contains the
cluster to which i belongs as well as the neighbor cluster of i (the
cluster, not containing i, for which the average dissimilarity between its
observations and i is minimal), and the silhouette width <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code> of
the observation.  The <code><a href="https://r-universe.dev/manuals/base.html#colnames">colnames</a></code> correspondingly are
<code>c("cluster", "neighbor", "sil_width")</code>.
</p>
<p><code>summary(sil)</code> returns an object of class
<code>summary.silhouette</code>, a list with components
</p>

<dl>
<dt>
<code>si.summary</code>:</dt>
<dd>
<p>numerical <code><a href="https://r-universe.dev/manuals/base.html#summary">summary</a></code> of the
individual silhouette widths <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code>.</p>
</dd>
<dt>
<code>clus.avg.widths</code>:</dt>
<dd>
<p>numeric (rank 1) array of clusterwise
<em>means</em> of silhouette widths where <code>mean = FUN</code> is used.</p>
</dd>
<dt>
<code>avg.width</code>:</dt>
<dd>
<p>the total mean <code>FUN(s)</code> where
<code>s</code> are the individual silhouette widths.</p>
</dd>
<dt>
<code>clus.sizes</code>:</dt>
<dd>
<p><code><a href="https://r-universe.dev/manuals/base.html#table">table</a></code> of the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> cluster sizes.</p>
</dd>
<dt>
<code>call</code>:</dt>
<dd>
<p>if available, the <code><a href="https://r-universe.dev/manuals/base.html#call">call</a></code> creating <code>sil</code>.</p>
</dd>
<dt>
<code>Ordered</code>:</dt>
<dd>
<p>logical identical to <code>attr(sil, "Ordered")</code>,
see below.</p>
</dd>
</dl>
<p><code>sortSilhouette(sil)</code> orders the rows of <code>sil</code> as in the
silhouette plot, by cluster (increasingly) and decreasing silhouette
width <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></code>.
<br><code>attr(sil, "Ordered")</code> is a logical indicating if <code>sil</code> <em>is</em>
ordered as by <code>sortSilhouette()</code>.  In that case,
<code>rownames(sil)</code> will contain case labels or numbers, and <br><code>attr(sil, "iOrd")</code> the ordering index vector.
</p>


<h3>Note</h3>

<p>While <code>silhouette()</code> is <em>intrinsic</em> to the
<code><a href="#partition.object">partition</a></code> clusterings, and hence has a (trivial) method
for these, it is straightforward to get silhouettes from hierarchical
clusterings from <code>silhouette.default()</code> with
<code><a href="https://r-universe.dev/manuals/stats.html#cutree">cutree</a>()</code> and distance as input.
</p>
<p>By default, for <code><a href="#clara">clara</a>()</code> partitions, the silhouette is
just for the best random <em>subset</em> used.  Use <code>full = TRUE</code>
to compute (and later possibly plot) the full silhouette.
</p>


<h3>References</h3>

<p>Rousseeuw, P.J. (1987)
Silhouettes: A graphical aid to the interpretation and validation of
cluster analysis. <em>J. Comput. Appl. Math.</em>, <b>20</b>, 53–65.
</p>
<p>chapter 2 of Kaufman and Rousseeuw (1990), see
the references in <code><a href="#plot.agnes">plot.agnes</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#partition.object">partition.object</a></code>, <code><a href="#plot.partition">plot.partition</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>ruspini<span class="token punctuation">)</span>
pr4 <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>ruspini<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>si <span class="token operator">&lt;-</span> silhouette<span class="token punctuation">(</span>pr4<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>ssi <span class="token operator">&lt;-</span> summary<span class="token punctuation">(</span>si<span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>si<span class="token punctuation">)</span> <span class="token comment"># silhouette plot</span>
plot<span class="token punctuation">(</span>si<span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"purple"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># with cluster-wise coloring</span>

si2 <span class="token operator">&lt;-</span> silhouette<span class="token punctuation">(</span>pr4<span class="token operator">$</span>clustering<span class="token punctuation">,</span> dist<span class="token punctuation">(</span>ruspini<span class="token punctuation">,</span> <span class="token string">"canberra"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>si2<span class="token punctuation">)</span> <span class="token comment"># has small values: "canberra"'s fault</span>
plot<span class="token punctuation">(</span>si2<span class="token punctuation">,</span> nmax<span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">,</span> cex.names<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>

op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> oma<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          mgp<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1.6</span><span class="token punctuation">,</span><span class="token number">.8</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar<span class="token operator">=</span> <span class="token number">.1</span><span class="token operator">+</span>c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>k <span class="token keyword">in</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span>
   plot<span class="token punctuation">(</span>silhouette<span class="token punctuation">(</span>pam<span class="token punctuation">(</span>ruspini<span class="token punctuation">,</span> k<span class="token operator">=</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"k = "</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> do.n.k<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"PAM(Ruspini) as in Kaufman &amp; Rousseeuw, p.101"</span><span class="token punctuation">,</span>
      outer <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> font <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"font.main"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"cex.main"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> frame<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">## the same with cluster-wise colours:</span>
c6 <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"tomato"</span><span class="token punctuation">,</span> <span class="token string">"forest green"</span><span class="token punctuation">,</span> <span class="token string">"dark blue"</span><span class="token punctuation">,</span> <span class="token string">"purple2"</span><span class="token punctuation">,</span> <span class="token string">"goldenrod4"</span><span class="token punctuation">,</span> <span class="token string">"gray20"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>k <span class="token keyword">in</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span>
   plot<span class="token punctuation">(</span>silhouette<span class="token punctuation">(</span>pam<span class="token punctuation">(</span>ruspini<span class="token punctuation">,</span> k<span class="token operator">=</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"k = "</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> do.n.k<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> c6<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## clara(): standard silhouette is just for the best random subset</span>
data<span class="token punctuation">(</span>xclara<span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>xc1k <span class="token operator">&lt;-</span> xclara<span class="token punctuation">[</span> sample<span class="token punctuation">(</span>nrow<span class="token punctuation">(</span>xclara<span class="token punctuation">)</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># rownames == indices</span>
cl3 <span class="token operator">&lt;-</span> clara<span class="token punctuation">(</span>xc1k<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>silhouette<span class="token punctuation">(</span>cl3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># only of the "best" subset of 46</span>
<span class="token comment">## The full silhouette: internally needs large (36 MB) dist object:</span>
sf <span class="token operator">&lt;-</span> silhouette<span class="token punctuation">(</span>cl3<span class="token punctuation">,</span> full <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment">## this is the same as</span>
s.full <span class="token operator">&lt;-</span> silhouette<span class="token punctuation">(</span>cl3<span class="token operator">$</span>clustering<span class="token punctuation">,</span> daisy<span class="token punctuation">(</span>xc1k<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>sf<span class="token punctuation">,</span> s.full<span class="token punctuation">,</span> check.attributes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> tolerance <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## color dependent on original "3 groups of each 1000": % __FIXME ??__</span>
plot<span class="token punctuation">(</span>sf<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">+</span> as.integer<span class="token punctuation">(</span>names<span class="token punctuation">(</span>cl3<span class="token operator">$</span>clustering<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token percent-operator operator">%/%</span> <span class="token number">1000</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span><span class="token string">"plot(silhouette(clara(.), full = TRUE))"</span><span class="token punctuation">)</span>

<span class="token comment">## Silhouette for a hierarchical clustering:</span>
ar <span class="token operator">&lt;-</span> agnes<span class="token punctuation">(</span>ruspini<span class="token punctuation">)</span>
si3 <span class="token operator">&lt;-</span> silhouette<span class="token punctuation">(</span>cutree<span class="token punctuation">(</span>ar<span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># k = 4 gave the same as pam() above</span>
    	           daisy<span class="token punctuation">(</span>ruspini<span class="token punctuation">)</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>is.data.frame<span class="token punctuation">(</span>di3 <span class="token operator">&lt;-</span> as.data.frame<span class="token punctuation">(</span>si3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
plot<span class="token punctuation">(</span>si3<span class="token punctuation">,</span> nmax <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">,</span> cex.names <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
<span class="token comment">## 2 groups: Agnes() wasn't too good:</span>
si4 <span class="token operator">&lt;-</span> silhouette<span class="token punctuation">(</span>cutree<span class="token punctuation">(</span>ar<span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> daisy<span class="token punctuation">(</span>ruspini<span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>si4<span class="token punctuation">,</span> nmax <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">,</span> cex.names <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="sizeDiss">

<a href="#sizeDiss" class="help-page-title"><h2>Sample Size of Dissimilarity Like Object</h2></a>

<h3>Description</h3>

<p>Returns the number of observations (<em>sample size</em>) corresponding
to a  dissimilarity like object, or equivalently,
the number of rows or columns of a matrix
when only the lower or upper triangular part (without diagonal) is given.
</p>
<p>It is nothing else but the inverse function of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">f(n) = n(n-1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">sizeDiss<span class="token punctuation">(</span>d<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>any <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object with length (typically) <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n(n-1)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/2</span></span></span></span></code>.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a number; <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> if <code>length(d) == n(n-1)/2</code>, <code>NA</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="#dissimilarity.object">dissimilarity.object</a></code> and also
<code><a href="https://r-universe.dev/manuals/stats.html#dist">as.dist</a></code> for class <code>dissimilarity</code> and
<code>dist</code> objects which have a <code>Size</code> attribute.</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">sizeDiss<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token comment"># 5, since 10 == 5 * (5 - 1) / 2</span>
sizeDiss<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token comment"># NA</span>

n <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">100</span>
stopifnot<span class="token punctuation">(</span>n <span class="token operator">==</span> sapply<span class="token punctuation">(</span> n<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> sizeDiss<span class="token punctuation">(</span>logical<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.agnes">

<a href="#summary.agnes" class="help-page-title"><h2>Summary Method for 'agnes' Objects</h2></a>

<h3>Description</h3>

<p>Returns (and prints) a summary list for an <code>agnes</code> object.
Printing gives more output than the corresponding
<code><a href="#print.agnes">print.agnes</a></code> method.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'agnes'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'summary.agnes'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>a <code><a href="#agnes">agnes</a></code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code>, <code><a href="#agnes.object">agnes.object</a></code>.</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>agnes<span class="token punctuation">(</span>agriculture<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.clara">

<a href="#summary.clara" class="help-page-title"><h2>Summary Method for 'clara' Objects</h2></a>

<h3>Description</h3>

<p>Returns (and prints) a summary list for a <code>clara</code> object.
Printing gives more output than the corresponding
<code><a href="#print.clara">print.clara</a></code> method.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'clara'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'summary.clara'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>a <code><a href="#clara">clara</a></code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#clara.object">clara.object</a></code></p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## generate 2000 objects, divided into 5 clusters.</span>
set.seed<span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">)</span>
x <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cbind<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
clx5 <span class="token operator">&lt;-</span> clara<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">## Mis'classification' table:</span>


table<span class="token punctuation">(</span>rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> clx5<span class="token operator">$</span>clust<span class="token punctuation">)</span> <span class="token comment"># -&gt; 1 "error"</span>
summary<span class="token punctuation">(</span>clx5<span class="token punctuation">)</span>

<span class="token comment">## Graphically:</span>
par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mgp <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"mar"</span><span class="token punctuation">)</span> <span class="token operator">-</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> col <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>clx5<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="summary.diana">

<a href="#summary.diana" class="help-page-title"><h2>Summary Method for 'diana' Objects</h2></a>

<h3>Description</h3>

<p>Returns (and prints) a summary list for a <code>diana</code> object.</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'diana'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'summary.diana'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>a <code><a href="#diana">diana</a></code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#diana">diana</a></code>, <code><a href="#diana">diana.object</a></code>.</p>

<hr>
</div>
<div class="container manual-page" id="summary.mona">

<a href="#summary.mona" class="help-page-title"><h2>Summary Method for 'mona' Objects</h2></a>

<h3>Description</h3>

<p>Returns (and prints) a summary list for a <code>mona</code> object.</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'mona'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'summary.mona'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>a <code><a href="#mona">mona</a></code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#mona">mona</a></code>, <code><a href="#mona.object">mona.object</a></code>.</p>

<hr>
</div>
<div class="container manual-page" id="summary.pam">

<a href="#summary.pam" class="help-page-title"><h2>Summary Method for PAM Objects</h2></a>

<h3>Description</h3>

<p>Summarize a <code><a href="#pam">pam</a></code> object and return an object
of class <code>summary.pam</code>.
There's a <code><a href="https://r-universe.dev/manuals/base.html#print">print</a></code> method for the latter.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'pam'</span>
summary<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'summary.pam'</span>
print<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>a <code><a href="#pam">pam</a></code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#pam">pam</a></code>, <code><a href="#pam.object">pam.object</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="twins.object">

<a href="#twins.object" class="help-page-title"><h2>Hierarchical Clustering Object</h2></a>

<h3>Description</h3>

<p>The objects of class <code>"twins"</code> represent an agglomerative or
divisive (polythetic) hierarchical clustering of a dataset.
</p>


<h3>Value</h3>

<p>See <code><a href="#agnes.object">agnes.object</a></code> and <code><a href="#diana">diana.object</a></code> for details.
</p>


<h3>GENERATION</h3>

<p>This class of objects is returned from <code>agnes</code> or <code>diana</code>.
</p>


<h3>METHODS</h3>

<p>The <code>"twins"</code> class has a method for the following generic function:
<code>pltree</code>.
</p>


<h3>INHERITANCE</h3>

<p>The following classes inherit from class <code>"twins"</code> :
<code>"agnes"</code> and <code>"diana"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#agnes">agnes</a></code>,<code><a href="#diana">diana</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="volume.ellipsoid">

<a href="#volume.ellipsoid" class="help-page-title"><h2>Compute the Volume (of an Ellipsoid)</h2></a>

<h3>Description</h3>

<p>Compute the volume of geometric <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object.
This is a generic function and has a method for <code>ellipsoid</code> objects
(typically resulting from <code><a href="#ellipsoidhull">ellipsoidhull</a>()</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">volume<span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'ellipsoid'</span>
volume<span class="token punctuation">(</span>object<span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object the volume of which is wanted; for the
<code>ellipsoid</code> method, an object of that class (see
<code><a href="#ellipsoidhull">ellipsoidhull</a></code> or the example below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if the volume should be
returned in log scale.  Maybe needed in largish dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments of methods, e.g. <code>log</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a number, the volume <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></code> (or <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>V</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(V)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span></span></span></span></code> if <code>log = TRUE</code>) of
the given <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler (2002, extracting from former <code><a href="#clusplot.partition">clusplot</a></code> code);
Keefe Murphy (2019) provided code for dimensions <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">d &gt; 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#ellipsoidhull">ellipsoidhull</a></code> for spanning ellipsoid computation.</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## example(ellipsoidhull) # which defines 'ellipsoid' object &lt;namefoo&gt;</span>

myEl <span class="token operator">&lt;-</span> structure<span class="token punctuation">(</span>list<span class="token punctuation">(</span>cov <span class="token operator">=</span> rbind<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> d2 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   class <span class="token operator">=</span> <span class="token string">"ellipsoid"</span><span class="token punctuation">)</span>
volume<span class="token punctuation">(</span>myEl<span class="token punctuation">)</span><span class="token comment"># i.e. "area" here (d = 2)</span>
myEl <span class="token comment"># also mentions the "volume"</span>

set.seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
d5 <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>rt<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
e5 <span class="token operator">&lt;-</span> ellipsoidhull<span class="token punctuation">(</span>d5<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="votes.repub">

<a href="#votes.repub" class="help-page-title"><h2>Votes for Republican Candidate in Presidential Elections</h2></a>

<h3>Description</h3>

<p>A data frame with the percents of votes given to the republican
candidate in presidential elections from 1856 to 1976.  Rows
represent the 50 states, and columns the 31 elections.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>votes.repub<span class="token punctuation">)</span></code></pre>


<h3>Source</h3>

<p>S. Peterson (1973):
<em>A Statistical History of the American Presidential Elections</em>.
New York: Frederick Ungar Publishing Co.
</p>
<p>Data from 1964 to 1976 is from R. M. Scammon, 
<em>American Votes 12</em>, Congressional Quarterly.
</p>

<hr>
</div>
<div class="container manual-page" id="xclara">

<a href="#xclara" class="help-page-title"><h2>Bivariate Data Set with 3 Clusters</h2></a>

<h3>Description</h3>

<p>An artificial data set consisting of 3000 points in 3 quite well-separated
clusters.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">data<span class="token punctuation">(</span>xclara<span class="token punctuation">)</span></code></pre>


<h3>Format</h3>

<p>A data frame with 3000 observations on 2 numeric variables (named
<code>V1</code> and <code>V2</code>) giving the
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></code> coordinates of the points, respectively.
</p>


<h3>Note</h3>

<p>Our version of the <code>xclara</code> is slightly more rounded than the one
from <code><a href="https://r-universe.dev/manuals/utils.html#read.table">read.table</a>("xclara.dat")</code> and the relative
difference measured by <code><a href="https://r-universe.dev/manuals/base.html#all.equal">all.equal</a></code> is <code>1.15e-7</code> for
<code>V1</code> and <code>1.17e-7</code> for <code>V2</code> which suggests that our
version has been the result of a <code><a href="https://r-universe.dev/manuals/base.html#options">options</a>(digits = 7)</code>
formatting.
</p>
<p>Previously (before May 2017), it was claimed the three cluster were
each of size 1000, which is clearly wrong.  <code><a href="#pam">pam</a>(*, 3)</code>
gives cluster sizes of 899, 1149, and 952, which apart from seven
“outliers” (or “mislabellings”) correspond to
observation indices <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>1</mn><mo>:</mo><mn>900</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{1:900\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">900</span><span class="mclose">}</span></span></span></span></code>, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>901</mn><mo>:</mo><mn>2050</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{901:2050\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">901</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2050</span><span class="mclose">}</span></span></span></span></code>, and
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>2051</mn><mo>:</mo><mn>3000</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{2051:3000\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">2051</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3000</span><span class="mclose">}</span></span></span></span></code>, see the example.
</p>


<h3>Source</h3>

<p>Sample data set accompanying the reference below (file
‘<span class="file">xclara.dat</span>’ in side ‘<span class="file">clus_examples.tar.gz</span>’).
</p>


<h3>References</h3>

<p>Anja Struyf, Mia Hubert &amp; Peter J. Rousseeuw (1996)
Clustering in an Object-Oriented Environment.
<em>Journal of Statistical Software</em> <b>1</b>.
<a href="https://doi.org/10.18637/jss.v001.i04" target="_blank">doi:10.18637/jss.v001.i04</a>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Visualization: Assuming groups are defined as {1:1000}, {1001:2000}, {2001:3000}</span>
plot<span class="token punctuation">(</span>xclara<span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">3</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">,</span> col <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> each<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
p.ID <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">1411</span><span class="token punctuation">,</span> <span class="token number">2535</span><span class="token punctuation">)</span> <span class="token comment">## PAM's medoid indices  == pam(xclara, 3)$id.med</span>
text<span class="token punctuation">(</span>xclara<span class="token punctuation">[</span>p.ID<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> cex<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>

 px <span class="token operator">&lt;-</span> pam<span class="token punctuation">(</span>xclara<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">## takes ~2 seconds</span>
 cxcl <span class="token operator">&lt;-</span> px<span class="token operator">$</span>clustering <span class="token punctuation">;</span> iCl <span class="token operator">&lt;-</span> split<span class="token punctuation">(</span>seq_along<span class="token punctuation">(</span>cxcl<span class="token punctuation">)</span><span class="token punctuation">,</span> cxcl<span class="token punctuation">)</span>
 boxplot<span class="token punctuation">(</span>iCl<span class="token punctuation">,</span> range <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">,</span> horizontal<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span>
         main <span class="token operator">=</span> <span class="token string">"Indices of the 3 clusters of  pam(xclara, 3)"</span><span class="token punctuation">)</span>

 <span class="token comment">## Look more closely now:</span>
 bxCl <span class="token operator">&lt;-</span> boxplot<span class="token punctuation">(</span>iCl<span class="token punctuation">,</span> range <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">,</span> plot<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
 <span class="token comment">## We see 3 + 2 + 2 = 7  clear "outlier"s  or "wrong group" observations:</span>
 with<span class="token punctuation">(</span>bxCl<span class="token punctuation">,</span> rbind<span class="token punctuation">(</span>out<span class="token punctuation">,</span> group<span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token comment">## out   1038 1451 1610   30  327  562  770</span>
 <span class="token comment">## group    1    1    1    2    2    3    3</span>
 <span class="token comment">## Apart from these, what are the robust ranges of indices? -- Robust range:</span>
 t<span class="token punctuation">(</span>iR <span class="token operator">&lt;-</span> bxCl<span class="token operator">$</span>stats<span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 <span class="token comment">##    1  900</span>
 <span class="token comment">##  901 2050</span>
 <span class="token comment">## 2051 3000</span>
 gc <span class="token operator">&lt;-</span> adjustcolor<span class="token punctuation">(</span><span class="token string">"gray20"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>
 abline<span class="token punctuation">(</span>v <span class="token operator">=</span> iR<span class="token punctuation">,</span> col <span class="token operator">=</span> gc<span class="token punctuation">,</span> lty<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
 axis<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> at <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> iR<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padj <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">,</span> col<span class="token operator">=</span>gc<span class="token punctuation">,</span> col.axis<span class="token operator">=</span>gc<span class="token punctuation">)</span></code></pre>

<hr>
</div>
</div>
    <footer><p>Rendered with postdoc 1.0.9000</p></footer>
  </body>
</html>
