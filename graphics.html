<!DOCTYPE html>
<html>
  <head>
    <title>Package 'graphics' reference manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <!-- styling for math and syntax -->
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/katex.min.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/R.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/prism.css">

    <!-- for (future) customizations -->
    <script src="https://r-universe.dev/static/manual.js"></script>
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/manual.css?nocache=1">

  </head>

  <body class="macintosh">
    <h1 class="manual-title">Package 'graphics'</h1>
    <table class="description-table">
      <tr>
<th>Title:</th>
<td class="description-title">The R Graphics Package</td>
</tr>
      <tr>
<th>Description:</th>
<td class="description-description">R functions for base graphics.</td>
</tr>
      <tr>
<th>Authors:</th>
<td class="description-author"><span>R Core Team and contributors worldwide</span></td>
</tr>
      <tr>
<th>Maintainer:</th>
<td class="description-maintainer">R Core Team &lt;do-use-Contact-address@r-project.org&gt;</td>
</tr>
      <tr>
<th>License:</th>
<td class="description-license">Part of R 4.2.2</td>
</tr>
      <tr>
<th>Version:</th>
<td class="description-version">4.2.2</td>
</tr>
      <tr>
<th>Built:</th>
<td class="description-date">2022-10-31 22:32:26 UTC</td>
</tr>
      <tr>
<th>Source:</th>
<td class="description-source">base</td>
</tr>
    </table>

    <a href="#help-index" style="color:black;"><h2 id="help-index">Help Index</h2></a>
    <ul id="help-index-list">
<li class="help-index-item"><a href="#abline">Add Straight Lines to a Plot</a></li>
<li class="help-index-item"><a href="#arrows">Add Arrows to a Plot</a></li>
<li class="help-index-item"><a href="#assocplot">Association Plots</a></li>
<li class="help-index-item"><a href="#axis">Add an Axis to a Plot</a></li>
<li class="help-index-item"><a href="#zAxis">Generic Function to Add an Axis to a Plot</a></li>
<li class="help-index-item"><a href="#axis.POSIXct">Date and Date-time Plotting Functions</a></li>
<li class="help-index-item"><a href="#axTicks">Compute Axis Tickmark Locations</a></li>
<li class="help-index-item"><a href="#barplot">Bar Plots</a></li>
<li class="help-index-item"><a href="#box">Draw a Box around a Plot</a></li>
<li class="help-index-item"><a href="#boxplot">Box Plots</a></li>
<li class="help-index-item"><a href="#boxplot.matrix">Draw a Boxplot for each Column (Row) of a Matrix</a></li>
<li class="help-index-item"><a href="#bxp">Draw Box Plots from Summaries</a></li>
<li class="help-index-item"><a href="#cdplot">Conditional Density Plots</a></li>
<li class="help-index-item"><a href="#clip">Set Clipping Region</a></li>
<li class="help-index-item"><a href="#contour">Display Contours</a></li>
<li class="help-index-item"><a href="#convertXY">Convert between Graphics Coordinate Systems</a></li>
<li class="help-index-item"><a href="#coplot">Conditioning Plots</a></li>
<li class="help-index-item"><a href="#curve">Draw Function Plots</a></li>
<li class="help-index-item"><a href="#dotchart">Cleveland's Dot Plots</a></li>
<li class="help-index-item"><a href="#filled.contour">Level (Contour) Plots</a></li>
<li class="help-index-item"><a href="#fourfoldplot">Fourfold Plots</a></li>
<li class="help-index-item"><a href="#frame">Create / Start a New Plot Frame</a></li>
<li class="help-index-item"><a href="#graphics-defunct">Defunct Functions in Package graphics</a></li>
<li class="help-index-item"><a href="#graphics-package">
The R Graphics Package
</a></li>
<li class="help-index-item"><a href="#grid">Add Grid to a Plot</a></li>
<li class="help-index-item"><a href="#hist">Histograms</a></li>
<li class="help-index-item"><a href="#hist.POSIXt">Histogram of a Date or Date-Time Object</a></li>
<li class="help-index-item"><a href="#identify">Identify Points in a Scatter Plot</a></li>
<li class="help-index-item"><a href="#image">Display a Color Image</a></li>
<li class="help-index-item"><a href="#layout">Specifying Complex Plot Arrangements</a></li>
<li class="help-index-item"><a href="#legend">Add Legends to Plots</a></li>
<li class="help-index-item"><a href="#lines">Add Connected Line Segments to a Plot</a></li>
<li class="help-index-item"><a href="#locator">Graphical Input</a></li>
<li class="help-index-item"><a href="#matplot">Plot Columns of Matrices</a></li>
<li class="help-index-item"><a href="#mosaicplot">Mosaic Plots</a></li>
<li class="help-index-item"><a href="#mtext">Write Text into the Margins of a Plot</a></li>
<li class="help-index-item"><a href="#pairs">Scatterplot Matrices</a></li>
<li class="help-index-item"><a href="#panel.smooth">Simple Panel Plot</a></li>
<li class="help-index-item"><a href="#par">Set or Query Graphical Parameters</a></li>
<li class="help-index-item"><a href="#persp">Perspective Plots</a></li>
<li class="help-index-item"><a href="#pie">Pie Charts</a></li>
<li class="help-index-item"><a href="#plot.dataframe">Plot Method for Data Frames</a></li>
<li class="help-index-item"><a href="#plot.default">The Default Scatterplot Function</a></li>
<li class="help-index-item"><a href="#plot.design">Plot Univariate Effects of a Design or Model</a></li>
<li class="help-index-item"><a href="#plot.factor">Plotting Factor Variables</a></li>
<li class="help-index-item"><a href="#plot.formula">Formula Notation for Scatterplots</a></li>
<li class="help-index-item"><a href="#plothistogram">Plot Histograms</a></li>
<li class="help-index-item"><a href="#plot.raster">Plotting Raster Images</a></li>
<li class="help-index-item"><a href="#plot.table">Plot Methods for table Objects</a></li>
<li class="help-index-item"><a href="#plot.window">Set up World Coordinates for Graphics Window</a></li>
<li class="help-index-item"><a href="#plot.xy">Basic Internal Plot Function</a></li>
<li class="help-index-item"><a href="#points">Add Points to a Plot</a></li>
<li class="help-index-item"><a href="#polygon">Polygon Drawing</a></li>
<li class="help-index-item"><a href="#polypath">Path Drawing</a></li>
<li class="help-index-item"><a href="#rasterImage">Draw One or More Raster Images</a></li>
<li class="help-index-item"><a href="#rect">Draw One or More Rectangles</a></li>
<li class="help-index-item"><a href="#rug">Add a Rug to a Plot</a></li>
<li class="help-index-item"><a href="#screen">Creating and Controlling Multiple Screens on a Single Device</a></li>
<li class="help-index-item"><a href="#segments">Add Line Segments to a Plot</a></li>
<li class="help-index-item"><a href="#smoothScatter">Scatterplots with Smoothed Densities Color Representation</a></li>
<li class="help-index-item"><a href="#spineplot">Spine Plots and Spinograms</a></li>
<li class="help-index-item"><a href="#stars">Star (Spider/Radar) Plots and Segment Diagrams</a></li>
<li class="help-index-item"><a href="#stem">Stem-and-Leaf Plots</a></li>
<li class="help-index-item"><a href="#stripchart">1-D Scatter Plots</a></li>
<li class="help-index-item"><a href="#strwidth">Plotting Dimensions of Character Strings and Math Expressions</a></li>
<li class="help-index-item"><a href="#sunflowerplot">Produce a Sunflower Scatter Plot</a></li>
<li class="help-index-item"><a href="#symbols">Draw Symbols (Circles, Squares, Stars, Thermometers, Boxplots)</a></li>
<li class="help-index-item"><a href="#text">Add Text to a Plot</a></li>
<li class="help-index-item"><a href="#title">Plot Annotation</a></li>
<li class="help-index-item"><a href="#units">Graphical Units</a></li>
<li class="help-index-item"><a href="#xspline">Draw an X-spline</a></li>
</ul>

    <hr>
    <div class="manual-pages-content">
<div class="container manual-page" id="abline">

<a href="#abline" class="help-page-title"><h2>Add Straight Lines to a Plot</h2></a>

<h3>Description</h3>

<p>This function adds one or more straight lines through the current plot.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">abline<span class="token punctuation">(</span>a <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> h <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> v <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> reg <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
       coef <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> untf <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a, b</code></td>
<td>
<p>the intercept and slope, single values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>untf</code></td>
<td>
<p>logical asking whether to <em>untransform</em>.  See
‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the y-value(s) for horizontal line(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>the x-value(s) for vertical line(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>a vector of length two giving the intercept and slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg</code></td>
<td>
<p>an object with a <code><a href="https://r-universe.dev/manuals/stats.html#coef">coef</a></code> method.  See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a> such as
<code>col</code>, <code>lty</code> and  <code>lwd</code> (possibly as vectors: see
‘Details’) and <code>xpd</code> and the line characteristics
<code>lend</code>, <code>ljoin</code> and <code>lmitre</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Typical usages are
</p>
<pre>abline(a, b, ...)
abline(h =, ...)
abline(v =, ...)
abline(coef =, ...)
abline(reg =, ...)
</pre>
<p>The first form specifies the line in intercept/slope form
(alternatively <code>a</code> can be specified on its own and is taken to
contain the slope and intercept in vector form).
</p>
<p>The <code>h=</code> and <code>v=</code> forms draw horizontal and vertical lines
at the specified coordinates.
</p>
<p>The <code>coef</code> form specifies the line by a vector containing the
slope and intercept.
</p>
<p><code>reg</code> is a regression object with a <code><a href="https://r-universe.dev/manuals/stats.html#coef">coef</a></code> method.
If this returns a vector of length 1 then the value is taken to be the
slope of a line through the origin, otherwise, the first 2 values are
taken to be the intercept and slope.
</p>
<p>If <code>untf</code> is true, and one or both axes are log-transformed, then
a curve is drawn corresponding to a line in original coordinates,
otherwise a line is drawn in the transformed coordinate system. The
<code>h</code> and <code>v</code> parameters always refer to original coordinates.
</p>
<p>The <a href="#par">graphical parameters</a> <code>col</code>, <code>lty</code> and <code>lwd</code>
can be specified; see <code><a href="#par">par</a></code> for details.  For the
<code>h=</code> and <code>v=</code> usages they can be vectors of length greater
than one, recycled as necessary.
</p>
<p>Specifying an <code>xpd</code> argument for clipping overrides
the global <code><a href="#par">par</a>("xpd")</code> setting used otherwise.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#lines">lines</a></code> and <code><a href="#segments">segments</a></code> for connected and
arbitrary lines given by their <em>endpoints</em>.
<code><a href="#par">par</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Setup up coordinate system (with x == y aspect ratio):</span>
plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">,</span> asp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">## the x- and y-axis, and an integer grid</span>
abline<span class="token punctuation">(</span>h <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray60"</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"abline( h = 0 )"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray60"</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>h <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> v <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightgray"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"abline( 1, 2 )"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Simple Regression Lines:</span>
require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
sale5 <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>sale5<span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>lsfit<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> sale5<span class="token punctuation">)</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>lsfit<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> sale5<span class="token punctuation">,</span> intercept <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment"># less fitting</span>

z <span class="token operator">&lt;-</span> lm<span class="token punctuation">(</span>dist <span class="token operator">~</span> speed<span class="token punctuation">,</span> data <span class="token operator">=</span> cars<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>cars<span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token comment"># equivalent to abline(reg = z) or</span>
abline<span class="token punctuation">(</span>coef <span class="token operator">=</span> coef<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## trivial intercept model</span>
abline<span class="token punctuation">(</span>mC <span class="token operator">&lt;-</span> lm<span class="token punctuation">(</span>dist <span class="token operator">~</span> <span class="token number">1</span><span class="token punctuation">,</span> data <span class="token operator">=</span> cars<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">## the same as</span>
abline<span class="token punctuation">(</span>a <span class="token operator">=</span> coef<span class="token punctuation">(</span>mC<span class="token punctuation">)</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="arrows">

<a href="#arrows" class="help-page-title"><h2>Add Arrows to a Plot</h2></a>

<h3>Description</h3>

<p>Draw arrows between pairs of points.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">arrows<span class="token punctuation">(</span>x0<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> x1 <span class="token operator">=</span> x0<span class="token punctuation">,</span> y1 <span class="token operator">=</span> y0<span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span>
       code <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lty"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       lwd <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lwd"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x0, y0</code></td>
<td>
<p>coordinates of points <b>from</b> which to draw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1, y1</code></td>
<td>
<p>coordinates of points <b>to</b> which to draw.  At least
one must the supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>length of the edges of the arrow head (in inches).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>angle from the shaft of the arrow to the edge of the
arrow head.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>integer code, determining <em>kind</em> of arrows to be
drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, lty, lwd</code></td>
<td>
<p><a href="#par">graphical parameters</a>, possible vectors.
<code>NA</code> values in <code>col</code> cause the arrow to be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a> such as <code>xpd</code> and the line
characteristics <code>lend</code>, <code>ljoin</code> and <code>lmitre</code>:
see <code><a href="#par">par</a></code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each <code>i</code>, an arrow is drawn between the point <code>(x0[i],
    y0[i])</code> and the point <code>(x1[i], y1[i])</code>.  The coordinate vectors
will be recycled to the length of the longest.
</p>
<p>If <code>code = 1</code> an arrowhead is drawn at <code>(x0[i], y0[i])</code> and if
<code>code = 2</code> an arrowhead is drawn at <code>(x1[i], y1[i])</code>.  If
<code>code = 3</code> a head is drawn at both ends of the arrow.  Unless
<code>length = 0</code>, when no head is drawn.
</p>
<p>The <a href="#par">graphical parameters</a> <code>col</code>, <code>lty</code> and <code>lwd</code>
can be vectors of length greater than one and will be recycled if
necessary.
</p>
<p>The direction of a zero-length arrow is indeterminate, and hence so is
the direction of the arrowheads.  To allow for rounding error,
arrowheads are omitted (with a warning) on any arrow of length less
than 1/1000 inch.
</p>


<h3>Note</h3>

<p>The first four arguments in the comparable S function are named
<code>x1, y1, x2, y2</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#segments">segments</a></code> to draw segments.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">x <span class="token operator">&lt;-</span> stats<span class="token operator">::</span>runif<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">&lt;-</span> stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
i <span class="token operator">&lt;-</span> order<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> x <span class="token operator">&lt;-</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> y <span class="token operator">&lt;-</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"arrows(.) and segments(.)"</span><span class="token punctuation">)</span>
<span class="token comment">## draw arrows from point to point :</span>
s <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span>length<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># one shorter than data</span>
arrows<span class="token punctuation">(</span>x<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span>s<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>s<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>
s <span class="token operator">&lt;-</span> s<span class="token punctuation">[</span><span class="token operator">-</span>length<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">]</span>
segments<span class="token punctuation">(</span>x<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span>s<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>s<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="assocplot">

<a href="#assocplot" class="help-page-title"><h2>Association Plots</h2></a>

<h3>Description</h3>

<p>Produce a Cohen-Friendly association plot indicating deviations from
independence of rows and columns in a 2-dimensional contingency
table.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">assocplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> space <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span>
          main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a two-dimensional contingency table in matrix form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a character vector of length two giving the colors used for
drawing positive and negative Pearson residuals, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>space</code></td>
<td>
<p>the amount of space (as a fraction of the average
rectangle width and height) left between each rectangle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>overall title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a label for the x axis.  Defaults to the name (if any) of
the row dimension in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a label for the y axis.  Defaults to the name (if any) of
the column dimension in <code>x</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a two-way contingency table, the signed contribution to Pearson's
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></code> for cell <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i, j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></code> is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>f</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msqrt><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msqrt></mrow><annotation encoding="application/x-tex">d_{ij} = (f_{ij} -
    e_{ij}) / \sqrt{e_{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1328em;vertical-align:-0.3828em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6572em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6172em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3828em;"><span></span></span></span></span></span></span></span></span></code>,
where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">e_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> are the observed and expected
counts corresponding to the cell.  In the Cohen-Friendly association
plot, each cell is represented by a rectangle that has (signed) height
proportional to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> and width proportional to
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{e_{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.3828em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6572em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6172em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3828em;"><span></span></span></span></span></span></span></span></span></code>, so that the area of the box is
proportional to the difference in observed and expected frequencies.
The rectangles in each row are positioned relative to a baseline
indicating independence (<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">d_{ij} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></code>).  If the observed frequency
of a cell is greater than the expected one, the box rises above the
baseline and is shaded in the color specified by the first element of
<code>col</code>, which defaults to black; otherwise, the box falls below
the baseline and is shaded in the color specified by the second
element of <code>col</code>, which defaults to red.
</p>
<p>A more flexible and extensible implementation of association plots
written in the grid graphics system is provided in the function
<code><a>assoc</a></code> in the contributed package <a href="https://CRAN.R-project.org/package=vcd" target="_blank"><span class="pkg">vcd</span></a>
(Meyer, Zeileis and Hornik, 2006).
</p>


<h3>References</h3>

<p>Cohen, A. (1980),
On the graphical display of the significant components in a two-way
contingency table.
<em>Communications in Statistics—Theory and Methods</em>, <b>9</b>,
1025–1041.
<a href="https://doi.org/10.1080/03610928008827940" target="_blank">doi:10.1080/03610928008827940</a>.
</p>
<p>Friendly, M. (1992),
Graphical methods for categorical data.
<em>SAS User Group International Conference Proceedings</em>, <b>17</b>,
190–200.
<a href="http://datavis.ca/papers/sugi/sugi17.pdf" target="_blank">http://datavis.ca/papers/sugi/sugi17.pdf</a>
</p>
<p>Meyer, D., Zeileis, A., and Hornik, K. (2006)  
The strucplot Framework: Visualizing Multi-Way Contingency Tables with
<span class="pkg">vcd</span>.
<em>Journal of Statistical Software</em>, <b>17(3)</b>, 1–48.
<a href="https://doi.org/10.18637/jss.v017.i03" target="_blank">doi:10.18637/jss.v017.i03</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#mosaicplot">mosaicplot</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#chisq.test">chisq.test</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Aggregate over sex:</span>
x <span class="token operator">&lt;-</span> marginSums<span class="token punctuation">(</span>HairEyeColor<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
x
assocplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Relation between hair and eye color"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="axis">

<a href="#axis" class="help-page-title"><h2>Add an Axis to a Plot</h2></a>

<h3>Description</h3>

<p>Adds an axis to the current plot, allowing the
specification of the side, position, labels, and other options.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">axis<span class="token punctuation">(</span>side<span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> tick <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
     pos <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> outer <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token string">"solid"</span><span class="token punctuation">,</span>
     lwd <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> lwd.ticks <span class="token operator">=</span> lwd<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> col.ticks <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
     hadj <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> padj <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> gap.axis <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>an integer specifying which side of the plot the axis is
to be drawn on.  The axis is placed as follows: 1=below,
2=left, 3=above and 4=right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>the points at which tick-marks are to be drawn.  Non-finite
(infinite, <code>NaN</code> or <code>NA</code>) values are omitted.  By default
(when <code>NULL</code>) tickmark locations are computed, see
‘Details’ below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>this can either be a logical value specifying whether
(numerical) annotations are to be made at the tickmarks, or a
character or expression vector of labels to be placed at the
tickpoints.  (Other objects are coerced by <code><a href="https://r-universe.dev/manuals/grDevices.html#as.graphicsAnnot">as.graphicsAnnot</a></code>.)
If this is not logical, <code>at</code> should also be supplied and of the
same length.  If <code>labels</code> is of length zero after coercion,
it has the same effect as supplying <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick</code></td>
<td>
<p>a logical value specifying whether tickmarks and an axis line
should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>
<p>the number of lines into the margin at which the axis line
will be drawn, if not <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>the coordinate at which the axis line is to be drawn:
if not <code>NA</code> this overrides the value of <code>line</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer</code></td>
<td>
<p>a logical value indicating whether the axis should be
drawn in the outer plot margin, rather than the standard plot
margin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font</code></td>
<td>
<p>font for text.  Defaults to <code>par("font")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>line type for both the axis line and the tick marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd, lwd.ticks</code></td>
<td>
<p>line widths for the axis line and the tick
marks.  Zero or negative values will suppress the line or ticks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, col.ticks</code></td>
<td>
<p>colors for the axis line and the tick marks
respectively.  <code>col = NULL</code> means to use <code>par("fg")</code>,
possibly specified inline, and <code>col.ticks = NULL</code> means to use
whatever color <code>col</code> resolved to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hadj</code></td>
<td>
<p>adjustment (see <code><a href="#par">par</a>("adj")</code>) for all labels
<em>parallel</em> (‘horizontal’) to the reading direction.  If
this is not a finite value, the default is used (centring for
strings parallel to the axis, justification of the end nearest the
axis otherwise).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padj</code></td>
<td>
<p>adjustment for each tick label <em>perpendicular</em> to the
reading direction.  For labels parallel to the axes, <code>padj = 0</code>
means right or top alignment, and <code>padj = 1</code> means left or bottom
alignment.  This can be a vector given a value for each string, and
will be recycled as necessary.
</p>
<p>If <code>padj</code> is not a finite value (the default), the value of
<code>par("las")</code> determines the adjustment.  For strings plotted
perpendicular to the axis the default is to centre the string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap.axis</code></td>
<td>
<p>an optional (typically non-negative) numeric factor to
be multiplied with the size of an ‘m’ to determine the
minimal gap between labels that are drawn, see ‘Details’.
The default, <code>NA</code>, corresponds to <code>1</code> for tick labels drawn
<em>parallel</em> to the axis and <code>0.25</code> otherwise, i.e., the
default is equivalent to </p>
<pre>  perpendicular &lt;- function(side, las) {
    is.x &lt;- (side %% 2 == 1) # is horizontal x-axis
    ( is.x &amp;&amp; (las %in% 2:3)) ||
    (!is.x &amp;&amp; (las %in% 1:2))
  }
  gap.axis &lt;- if(perpendicular(side, las)) 0.25 else 1</pre>
<p><code>gap.axis</code> may typically be relevant when <code>at = ..</code>
tick-mark positions are specified explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <a href="#par">graphical parameters</a> may also be passed as
arguments to this function, particularly, <code>cex.axis</code>, <code>col.axis</code>
and <code>font.axis</code> for axis annotation, i.e. tick labels, <code>mgp</code>
and <code>xaxp</code> or <code>yaxp</code> for positioning, <code>tck</code> or
<code>tcl</code> for tick mark length and direction, <code>las</code> for
vertical/horizontal label orientation, or <code>fg</code> instead of
<code>col</code>, and <code>xpd</code> for clipping.  See <code><a href="#par">par</a></code> on these.
</p>
<p>Parameters <code>xaxt</code> (sides 1 and 3) and <code>yaxt</code> (sides 2 and
4) control if the axis is plotted at all.
</p>
<p>Note that <code>lab</code> will partial match to argument
<code>labels</code> unless the latter is also supplied.  (Since the
default axes have already been set up by <code><a href="#plot.window">plot.window</a></code>,
<code>lab</code> will not be acted on by <code>axis</code>.)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The axis line is drawn from the lowest to the highest value of
<code>at</code>, but will be clipped at the plot region.  By default, only
ticks which are drawn from points within the plot region (up to a
tolerance for rounding error) are plotted, but the ticks and their
labels may well extend outside the plot region.  Use <code>xpd = TRUE</code>
or <code>xpd = NA</code> to allow axes to extend further.
</p>
<p>When <code>at = NULL</code>, pretty tick mark locations are computed internally
(the same way <code><a href="#axTicks">axTicks</a>(side)</code> would) from
<code><a href="#par">par</a>("xaxp")</code> or <code>"yaxp"</code> and
<code><a href="#par">par</a>("xlog")</code> (or <code>"ylog"</code>).  Note that these
locations may change if an on-screen plot is resized (for example, if
the <code>plot</code> argument <code>asp</code> (see <code><a href="#plot.window">plot.window</a></code>) is set.)
</p>
<p>If <code>labels</code> is not specified, the numeric values supplied or
calculated for <code>at</code> are converted to character strings as if they
were a numeric vector printed by <code><a href="https://r-universe.dev/manuals/base.html#print.default">print.default</a>(digits = 7)</code>.
</p>
<p>The code tries hard not to draw overlapping tick labels, and so will
omit labels where they would abut or overlap previously drawn labels.
This can result in, for example, every other tick being labelled.
The ticks are drawn left to right or bottom to top, and space at
least the size of an ‘m’, multiplied by <code>gap.axis</code>,
is left between labels.  In previous <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> versions, this applied only
for labels written <em>parallel</em> to the axis direction, hence not
for e.g., <code>las = 2</code>.  Using <code>gap.axis = -1</code> restores that
(buggy) previous behaviour (in the perpendicular case).
</p>
<p>If either <code>line</code> or <code>pos</code> is set, they (rather than
<code>par("mgp")[3]</code>) determine the position of the axis line and tick
marks, and the tick labels are placed <code>par("mgp")[2]</code> further
lines into (or towards for <code>pos</code>) the margin.
</p>
<p>Several of the graphics parameters affect the way axes are drawn. The
vertical (for sides 1 and 3) positions of the axis and the tick labels
are controlled by <code>mgp[2:3]</code> and <code>mex</code>, the size and
direction of the ticks is controlled by <code>tck</code> and <code>tcl</code> and
the appearance of the tick labels by <code>cex.axis</code>, <code>col.axis</code>
and <code>font.axis</code> with orientation controlled by <code>las</code> (but
not <code>srt</code>, unlike S which uses <code>srt</code> if <code>at</code> is
supplied and <code>las</code> if it is not).  Note that <code>adj</code> is not
supported and labels are always centered.  See <code><a href="#par">par</a></code> for details.
</p>


<h3>Value</h3>

<p>The numeric locations on the axis scale at which tick marks were drawn
when the plot was first drawn (see ‘Details’).
</p>
<p>This function is usually invoked for its side effect, which is to add
an axis to an already existing plot.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#zAxis">Axis</a></code> for a generic interface.
</p>
<p><code><a href="#axTicks">axTicks</a></code> returns the axis tick locations
corresponding to <code>at = NULL</code>; <code><a href="https://r-universe.dev/manuals/base.html#pretty">pretty</a></code> is more flexible
for computing pretty tick coordinates and does <em>not</em> depend on
(nor adapt to) the coordinate system in use.
</p>
<p>Several graphics parameters affecting the appearance are documented
in <code><a href="#par">par</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span> <span class="token comment"># for rnorm</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
box<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#- to make it look "as usual"</span>

plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"axis() examples"</span><span class="token punctuation">,</span>
     type <span class="token operator">=</span> <span class="token string">"s"</span><span class="token punctuation">,</span> xaxt <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col.axis <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span>
<span class="token comment"># unusual options:</span>
axis<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"violet"</span><span class="token punctuation">,</span> col.axis <span class="token operator">=</span> <span class="token string">"dark violet"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gold"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span>

<span class="token comment"># one way to have a custom x axis</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> xaxt <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> xaxp <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Changing default gap between labels:</span>
plot<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"n"</span><span class="token punctuation">,</span> axes<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> ann<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span>quote<span class="token punctuation">(</span><span class="token string">"axis(1, .., gap.axis = f),"</span> <span class="token operator">~</span><span class="token operator">~</span> f <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token number">5</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> las <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> gap.axis <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span>
gaps <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
chG <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span>ifelse<span class="token punctuation">(</span>gaps <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"default:  "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token string">"gap.axis="</span><span class="token punctuation">,</span> formatC<span class="token punctuation">(</span>gaps<span class="token punctuation">)</span><span class="token punctuation">)</span>
jj <span class="token operator">&lt;-</span> seq_along<span class="token punctuation">(</span>gaps<span class="token punctuation">)</span>
linG <span class="token operator">&lt;-</span> <span class="token operator">-</span><span class="token number">2.5</span><span class="token operator">*</span><span class="token punctuation">(</span>jj<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token keyword">in</span> jj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isD <span class="token operator">&lt;-</span> gaps<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token comment"># is default</span>
    axis <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> at<span class="token operator">=</span><span class="token number">5</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gap.axis <span class="token operator">=</span> gaps<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> padj<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> line <span class="token operator">=</span> linG<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>
          col.axis <span class="token operator">=</span> <span class="token keyword">if</span><span class="token punctuation">(</span>isD<span class="token punctuation">)</span> <span class="token string">"forest green"</span> <span class="token keyword">else</span> <span class="token number">1</span><span class="token punctuation">,</span> font.axis<span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span>isD<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
mtext<span class="token punctuation">(</span>chG<span class="token punctuation">,</span> side<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padj<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> line <span class="token operator">=</span> linG <span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> cex<span class="token operator">=</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">,</span>
      col <span class="token operator">=</span> ifelse<span class="token punctuation">(</span>gaps <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"forest green"</span><span class="token punctuation">,</span> <span class="token string">"blue3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## now shrink the window (in x- and y-direction) and observe the axis labels drawn</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="zAxis">

<a href="#zAxis" class="help-page-title"><h2>Generic Function to Add an Axis to a Plot</h2></a>

<h3>Description</h3>

<p>Generic function to add a suitable axis to the current plot.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">Axis<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> side<span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object which indicates the range over which an axis should
be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>the points at which tick-marks are to be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>an integer specifying which side of the plot the axis is
to be drawn on.  The axis is placed as follows: 1=below,
2=left, 3=above and 4=right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>this can either be a logical value specifying whether
(numerical) annotations are to be made at the tickmarks, or a
character or expression vector of labels to be placed at the
tickpoints. If this is specified as a character or expression
vector, <code>at</code> should be supplied and they should be the same
length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to methods and perhaps then to
<code><a href="#axis">axis</a></code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a generic function.  It works in a slightly non-standard way:
if <code>x</code> is supplied and non-NULL it dispatches on <code>x</code>,
otherwise if <code>at</code> is supplied and non-NULL it dispatches on <code>at</code>,
and the default action is to call <code><a href="#axis">axis</a></code>, omitting argument
<code>x</code>.
</p>
<p>The idea is that for plots for which either or both of the axes are
numerical but with a special interpretation, the standard plotting
functions (including <code><a href="#boxplot">boxplot</a></code>, <code><a href="#contour">contour</a></code>,
<code><a href="#coplot">coplot</a></code>, <code><a href="#filled.contour">filled.contour</a></code>,
<code><a href="#pairs">pairs</a></code>, <code><a href="#plot.default">plot.default</a></code>, <code><a href="#rug">rug</a></code> and
<code><a href="#stripchart">stripchart</a></code>) will set up user coordinates and <code>Axis</code>
will be called to label them appropriately.
</p>
<p>There are <code>"Date"</code> and <code>"POSIXt"</code> methods which can pass an
argument <code>format</code> on to the appropriate <code>axis</code> method (see
<code><a href="#axis.POSIXct">axis.POSIXct</a></code>).
</p>


<h3>Value</h3>

<p>The numeric locations on the axis scale at which tick marks were drawn
when the plot was first drawn (see ‘Details’).
</p>
<p>This function is usually invoked for its side effect, which is to add
an axis to an already existing plot.
</p>


<h3>See Also</h3>

<p><code><a href="#axis">axis</a></code> (which is eventually called from all <code>Axis()</code>
methods) in package <span class="pkg">graphics</span>.
</p>

<hr>
</div>
<div class="container manual-page" id="axis.POSIXct">

<a href="#axis.POSIXct" class="help-page-title"><h2>Date and Date-time Plotting Functions</h2></a>

<h3>Description</h3>

<p>Functions to plot objects of classes <code>"POSIXlt"</code>,
<code>"POSIXct"</code> and <code>"Date"</code> representing calendar dates and times.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">axis.POSIXct<span class="token punctuation">(</span>side<span class="token punctuation">,</span> x<span class="token punctuation">,</span> at<span class="token punctuation">,</span> format<span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
axis.Date<span class="token punctuation">(</span>side<span class="token punctuation">,</span> x<span class="token punctuation">,</span> at<span class="token punctuation">,</span> format<span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, at</code></td>
<td>
<p>A date-time or date object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>See <code><a href="#axis">axis</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>See <code><a href="https://r-universe.dev/manuals/base.html#strptime">strptime</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Either a logical value specifying whether
annotations are to be made at the tickmarks, or a vector of character
strings to be placed at the tickpoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed from or to other methods,
typically <a href="#par">graphical parameters</a>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>axis.POSIXct</code> and <code>axis.Date</code> work quite hard to choose
suitable time units (years, months, days, hours, minutes or seconds)
and a sensible output format, but this can be overridden by supplying
a <code>format</code> specification.
</p>
<p>If <code>at</code> is supplied it specifies the locations of the ticks
and labels whereas if <code>x</code> is specified a suitable grid of labels
is chosen. Printing of tick labels can be suppressed by using
<code>labels = FALSE</code>.
</p>
<p>The date-times for a <code>"POSIXct"</code> input are interpreted in the
time zone give by the <code>"tzone"</code> attribute if there is one,
otherwise the current time zone.
</p>
<p>The way the date-times are rendered (especially month names) is
controlled by the locale setting of category <code>"LC_TIME"</code> (see
<code><a href="https://r-universe.dev/manuals/base.html#locales">Sys.setlocale</a></code>).
</p>


<h3>Value</h3>

<p>The locations on the axis scale at which tick marks were drawn.
</p>


<h3>See Also</h3>

<p><a href="https://r-universe.dev/manuals/base.html#DateTimeClasses">DateTimeClasses</a>, <a href="https://r-universe.dev/manuals/base.html#Dates">Dates</a> for details of the classes.
</p>
<p><code><a href="#zAxis">Axis</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">with<span class="token punctuation">(</span>beaver1<span class="token punctuation">,</span> <span class="token punctuation">{</span>
time <span class="token operator">&lt;-</span> strptime<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token number">1990</span><span class="token punctuation">,</span> day<span class="token punctuation">,</span> time <span class="token percent-operator operator">%/%</span> <span class="token number">100</span><span class="token punctuation">,</span> time <span class="token percent-operator operator">%%</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 <span class="token string">"%Y %j %H %M"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>time<span class="token punctuation">,</span> temp<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">)</span> <span class="token comment"># axis at 4-hour intervals.</span>
<span class="token comment"># now label every hour on the time axis</span>
plot<span class="token punctuation">(</span>time<span class="token punctuation">,</span> temp<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> xaxt <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> as.POSIXct<span class="token punctuation">(</span>round<span class="token punctuation">(</span>range<span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"hours"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
axis.POSIXct<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> seq<span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token string">"hour"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">"%H"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

plot<span class="token punctuation">(</span>.leap.seconds<span class="token punctuation">,</span> seq_along<span class="token punctuation">(</span>.leap.seconds<span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> yaxt <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> <span class="token string">"leap seconds"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> bty <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
rug<span class="token punctuation">(</span>.leap.seconds<span class="token punctuation">)</span>
<span class="token comment">## or as dates</span>
lps <span class="token operator">&lt;-</span> as.Date<span class="token punctuation">(</span>.leap.seconds<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>lps<span class="token punctuation">,</span> seq_along<span class="token punctuation">(</span>.leap.seconds<span class="token punctuation">)</span><span class="token punctuation">,</span>
     type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> yaxt <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"leap seconds"</span><span class="token punctuation">,</span>
     ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> bty <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
rug<span class="token punctuation">(</span>lps<span class="token punctuation">)</span>

<span class="token comment">## 100 random dates in a 10-week period</span>
random.dates <span class="token operator">&lt;-</span> as.Date<span class="token punctuation">(</span><span class="token string">"2001/1/1"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">70</span><span class="token operator">*</span>sort<span class="token punctuation">(</span>stats<span class="token operator">::</span>runif<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>random.dates<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token comment"># or for a better axis labelling</span>
plot<span class="token punctuation">(</span>random.dates<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> xaxt <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
axis.Date<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> seq<span class="token punctuation">(</span>as.Date<span class="token punctuation">(</span><span class="token string">"2001/1/1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max<span class="token punctuation">(</span>random.dates<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"weeks"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
axis.Date<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> seq<span class="token punctuation">(</span>as.Date<span class="token punctuation">(</span><span class="token string">"2001/1/1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max<span class="token punctuation">(</span>random.dates<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"days"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     labels <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> tcl <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="axTicks">

<a href="#axTicks" class="help-page-title"><h2>Compute Axis Tickmark Locations</h2></a>

<h3>Description</h3>

<p>Compute pretty tickmark locations, the same way as <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> does internally.
This is only non-trivial when <b>log</b> coordinates are active.
By default, gives the <code>at</code> values which
<code><a href="#axis">axis</a>(side)</code> would use.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">axTicks<span class="token punctuation">(</span>side<span class="token punctuation">,</span> axp <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> usr <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> nintLog <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>integer in 1:4, as for <code><a href="#axis">axis</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axp</code></td>
<td>
<p>numeric vector of length three, defaulting to
<code><a href="#par">par</a>("xaxp")</code> or <code><a href="#par">par</a>("yaxp")</code>
depending on the <code>side</code> argument (<code>par("xaxp")</code>
if <code>side</code> is 1 or 3, <code>par("yaxp")</code> if side is 2 or 4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usr</code></td>
<td>
<p>numeric vector of length two giving user coordinate
limits, defaulting to the relevant portion of
<code><a href="#par">par</a>("usr")</code> (<code>par("usr")[1:2]</code> or
<code>par("usr")[3:4]</code> for <code>side</code> in (1,3) or (2,4)
respectively).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical indicating if log coordinates are active; defaults
to <code><a href="#par">par</a>("xlog")</code> or <code><a href="#par">par</a>("ylog")</code>
depending on <code>side</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nintLog</code></td>
<td>
<p>(only used when <code>log</code> is true): approximate (lower
bound for the) number of tick intervals; defaults to
<code><a href="#par">par</a>("lab")[j]</code> where <code>j</code> is 1 or 2 depending on
<code>side</code>.  Set this to <code>Inf</code> if you want the same behavior
as in earlier <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> versions (than 2.14.x).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>axp</code>, <code>usr</code>, and <code>log</code> arguments must be consistent
as their default values (the <code>par(..)</code> results) are.  If you
specify all three (as non-NULL), the graphics environment is not used
at all.  Note that the meaning of <code>axp</code> differs significantly
when <code>log</code> is <code>TRUE</code>; see the documentation on
<code><a href="#par">par</a>(xaxp = .)</code>.
</p>
<p><code>axTicks()</code> may be seen as an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> implementation of the C function
<code>CreateAtVector()</code> in ‘<span class="file">..../src/main/plot.c</span>’
which is called by <code><a href="#axis">axis</a>(side, *)</code> when no argument
<code>at</code> is specified or directly by <code><a href="https://r-universe.dev/manuals/grDevices.html#axisTicks">axisTicks</a>()</code> (in package
<span class="pkg">grDevices</span>).
<br>
The delicate case, <code>log = TRUE</code>, now makes use of
<code><a href="https://r-universe.dev/manuals/grDevices.html#axisTicks">axisTicks</a></code> unless <code>nintLog = Inf</code> which exists for back
compatibility.
</p>


<h3>Value</h3>

<p>numeric vector of coordinate values at which axis tickmarks can be
drawn.  By default, when only the first argument is specified,
these values should be identical to those that
<code><a href="#axis">axis</a>(side)</code> would use or has used.  Note that the values
are decreasing when <code>usr</code> is (“reverse axis” case).
</p>


<h3>See Also</h3>

<p><code><a href="#axis">axis</a></code>, <code><a href="#par">par</a></code>.  <code><a href="https://r-universe.dev/manuals/base.html#pretty">pretty</a></code>
uses the same algorithm (but independently of the graphics
environment) and has more options.  However it is not available for
<code>log = TRUE.</code>
</p>
<p><code><a href="https://r-universe.dev/manuals/grDevices.html#axisTicks">axisTicks</a>()</code> (package <span class="pkg">grDevices</span>).
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">21</span><span class="token operator">:</span><span class="token number">27</span><span class="token punctuation">)</span>
 axTicks<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
 axTicks<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
 stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>axTicks<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axTicks<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           identical<span class="token punctuation">(</span>axTicks<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axTicks<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Show how axTicks() and axis() correspond :</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>x <span class="token keyword">in</span> <span class="token number">9999</span> <span class="token operator">*</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">)</span>
    cat<span class="token punctuation">(</span>formatC<span class="token punctuation">(</span>par<span class="token punctuation">(</span><span class="token string">"xaxp"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">";"</span><span class="token punctuation">,</span> T <span class="token operator">&lt;-</span> axTicks<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
    rug<span class="token punctuation">(</span>T<span class="token punctuation">,</span> col <span class="token operator">=</span>  adjustcolor<span class="token punctuation">(</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

x <span class="token operator">&lt;-</span> <span class="token number">9.9</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">)</span>
axTicks<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># now length 7, in R &lt;= 2.13.x gave 'nintLog = Inf' res; then</span>
<span class="token comment">## 1e-01 1e+01 1e+03 1e+05 1e+07 1e+09 1e+11 ; since R 4.2.0: 1e-2 1e0 1e2 .. 1e10</span>
axTicks<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> nintLog <span class="token operator">=</span> <span class="token number">Inf</span><span class="token punctuation">)</span> <span class="token comment"># rather too many</span>

<span class="token comment">## An example using axTicks() without reference to an existing plot</span>
<span class="token comment">## (copying R's internal procedures for setting axis ranges etc.),</span>
<span class="token comment">## You do need to supply _all_ of axp, usr, log, nintLog</span>
<span class="token comment">## standard logarithmic y axis labels</span>
ylims <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span>
get_axp <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token number">10</span><span class="token operator">^</span>c<span class="token punctuation">(</span>ceiling<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> floor<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## mimic par("yaxs") == "i"</span>
usr.i <span class="token operator">&lt;-</span> log10<span class="token punctuation">(</span>ylims<span class="token punctuation">)</span>
<span class="token punctuation">(</span>aT.i <span class="token operator">&lt;-</span> axTicks<span class="token punctuation">(</span>side <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> usr <span class="token operator">=</span> usr.i<span class="token punctuation">,</span>
                 axp <span class="token operator">=</span> c<span class="token punctuation">(</span>get_axp<span class="token punctuation">(</span>usr.i<span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> nintLog <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## mimic (default) par("yaxs") == "r"</span>
usr.r <span class="token operator">&lt;-</span> extendrange<span class="token punctuation">(</span>r <span class="token operator">=</span> log10<span class="token punctuation">(</span>ylims<span class="token punctuation">)</span><span class="token punctuation">,</span> f <span class="token operator">=</span> <span class="token number">0.04</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>aT.r <span class="token operator">&lt;-</span> axTicks<span class="token punctuation">(</span>side <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> usr <span class="token operator">=</span> usr.r<span class="token punctuation">,</span>
                 axp <span class="token operator">=</span> c<span class="token punctuation">(</span>get_axp<span class="token punctuation">(</span>usr.r<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> nintLog <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Prove that we got it right :</span>
plot<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> ylims<span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">,</span> yaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>aT.i<span class="token punctuation">,</span> axTicks<span class="token punctuation">(</span>side <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plot<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> ylims<span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">,</span> yaxs <span class="token operator">=</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>all.equal<span class="token punctuation">(</span>aT.r<span class="token punctuation">,</span> axTicks<span class="token punctuation">(</span>side <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="barplot">

<a href="#barplot" class="help-page-title"><h2>Bar Plots</h2></a>

<h3>Description</h3>

<p>Creates a bar plot with vertical or horizontal bars.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">barplot<span class="token punctuation">(</span>height<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
barplot<span class="token punctuation">(</span>height<span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> space <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
        names.arg <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> legend.text <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> beside <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        horiz <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> density <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> border <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> sub <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
        xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xpd <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
        axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> axisnames <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
        cex.axis <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"cex.axis"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cex.names <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"cex.axis"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        inside <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> axis.lty <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> ann <span class="token operator">=</span> <span class="token operator">!</span>add <span class="token operator">&amp;&amp;</span> par<span class="token punctuation">(</span><span class="token string">"ann"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> args.legend <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
barplot<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data<span class="token punctuation">,</span> subset<span class="token punctuation">,</span> na.action<span class="token punctuation">,</span>
        horiz <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>either a vector or matrix of values describing the
bars which make up the plot.  If <code>height</code> is a vector, the
plot consists of a sequence of rectangular bars with heights
given by the values in the vector.  If <code>height</code> is a matrix
and <code>beside</code> is <code>FALSE</code> then each bar of the plot
corresponds to a column of <code>height</code>, with the values in the
column giving the heights of stacked sub-bars making up the
bar.  If <code>height</code> is a matrix and <code>beside</code> is
<code>TRUE</code>, then the values in each column are juxtaposed
rather than stacked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>optional vector of bar widths. Re-cycled to length the
number of bars drawn.  Specifying a single value will have no
visible effect unless <code>xlim</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>space</code></td>
<td>
<p>the amount of space (as a fraction of the average bar
width) left before each bar.  May be given as a single number or
one number per bar.  If <code>height</code> is a matrix and
<code>beside</code> is <code>TRUE</code>, <code>space</code> may be specified by
two numbers, where the first is the space between bars in the
same group, and the second the space between the groups.  If not
given explicitly, it defaults to <code>c(0,1)</code> if <code>height</code>
is a matrix and <code>beside</code> is <code>TRUE</code>, and to 0.2
otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.arg</code></td>
<td>
<p>a vector of names to be plotted below each bar or
group of bars.  If this argument is omitted, then the names are
taken from the <code>names</code> attribute of <code>height</code> if this
is a vector, or the column names if it is a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text</code></td>
<td>
<p>a vector of text used to construct a legend for
the plot, or a logical indicating whether a legend should be
included.  This is only useful when <code>height</code> is a matrix.
In that case given legend labels should correspond to the rows of
<code>height</code>; if <code>legend.text</code> is true, the row names of
<code>height</code> will be used as labels if they are non-null.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beside</code></td>
<td>
<p>a logical value.  If <code>FALSE</code>, the columns of
<code>height</code> are portrayed as stacked bars, and if <code>TRUE</code>
the columns are portrayed as juxtaposed bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horiz</code></td>
<td>
<p>a logical value.  If <code>FALSE</code>, the bars are drawn
vertically with the first bar to the left.  If <code>TRUE</code>, the
bars are drawn horizontally with the first at the bottom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>a vector giving the density of shading lines, in
lines per inch, for the bars or bar components.
The default value of <code>NULL</code> means that no shading lines
are drawn. Non-positive values of <code>density</code> also inhibit the
drawing of shading lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>the slope of shading lines, given as an angle in
degrees (counter-clockwise), for the bars or bar components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector of colors for the bars or bar components.
By default, <code>"grey"</code> is used if <code>height</code> is a vector, and a
gamma-corrected grey palette if <code>height</code> is a matrix;
see <code><a href="https://r-universe.dev/manuals/grDevices.html#gray.colors">grey.colors</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>the color to be used for the border of the bars.
Use <code>border = NA</code> to omit borders.  If there are shading
lines, <code>border = TRUE</code> means use the same colour for
the border as for the shading lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main,sub</code></td>
<td>
<p>main title and subtitle for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a label for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a label for the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>limits for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>limits for the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpd</code></td>
<td>
<p>logical. Should bars be allowed to go outside region?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>string specifying if axis scales should be logarithmic; see
<code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>logical.  If <code>TRUE</code>, a vertical (or horizontal, if
<code>horiz</code> is true) axis is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axisnames</code></td>
<td>
<p>logical.  If <code>TRUE</code>, and if there are
<code>names.arg</code> (see above), the
other axis is drawn (with <code>lty = 0</code>) and labeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>expansion factor for numeric axis labels (see
<code><a href="#par">par</a>('cex')</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.names</code></td>
<td>
<p>expansion factor for axis names (bar labels).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inside</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the lines which divide
adjacent (non-stacked!) bars will be drawn.  Only applies when
<code>space = 0</code> (which it partly is when <code>beside = TRUE</code>).</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical.  If <code>FALSE</code>, nothing is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.lty</code></td>
<td>
<p>the graphics parameter <code>lty</code> (see
<code><a href="#par">par</a>('lty')</code>) applied to the axis
and tick marks of the categorical (default horizontal) axis.  Note
that by default the axis is suppressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>a vector indicating how much the bars should be shifted
relative to the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical specifying if bars should be added to an already
existing plot; defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ann</code></td>
<td>
<p>logical specifying if the default annotation (<code>main</code>,
<code>sub</code>, <code>xlab</code>, <code>ylab</code>) should appear on the plot, see
<code><a href="#title">title</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.legend</code></td>
<td>
<p>list of additional arguments to pass to
<code><a href="#legend">legend</a>()</code>; names of the list are used as argument
names.  Only used if <code>legend.text</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula where the <code>y</code> variables are numeric data
to plot against the categorical <code>x</code> variables.  The formula
can have one of three forms:
</p>
<pre>
      y ~ x
      y ~ x1 + x2
      cbind(y1, y2) ~ x
    </pre>
<p>(see the examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame (or list) from which the variables in formula
should be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code> values.  The default is to ignore missing
values in the given variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to/from other methods.  For the
default method these can include further arguments (such as
<code>axes</code>, <code>asp</code> and <code>main</code>) and
<a href="#par">graphical parameters</a> (see <code><a href="#par">par</a></code>) which are passed to
<code><a href="#plot.window">plot.window</a>()</code>, <code><a href="#title">title</a>()</code> and
<code><a href="#axis">axis</a></code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector (or matrix, when <code>beside = TRUE</code>), say
<code>mp</code>, giving the coordinates of <em>all</em> the bar midpoints
drawn, useful for adding to the graph.
</p>
<p>If <code>beside</code> is true, use <code>colMeans(mp)</code> for the
midpoints of each <em>group</em> of bars, see example.
</p>


<h3>Author(s)</h3>

<p>R Core, with a contribution by Arni Magnusson.</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.default">plot</a>(..., type = "h")</code>, <code><a href="#dotchart">dotchart</a></code>;
<code><a href="#hist">hist</a></code> for bars of a <em>continuous</em> variable.
<code><a href="#mosaicplot">mosaicplot</a>()</code>, more sophisticated to visualize
<em>several</em> categorical variables.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Formula method</span>
barplot<span class="token punctuation">(</span>GNP <span class="token operator">~</span> Year<span class="token punctuation">,</span> data <span class="token operator">=</span> longley<span class="token punctuation">)</span>
barplot<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span>Employed<span class="token punctuation">,</span> Unemployed<span class="token punctuation">)</span> <span class="token operator">~</span> Year<span class="token punctuation">,</span> data <span class="token operator">=</span> longley<span class="token punctuation">)</span>

<span class="token comment">## 3rd form of formula - 2 categories :</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> mgp <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> mar <span class="token operator">=</span> <span class="token number">.1</span><span class="token operator">+</span>c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>d.Titanic <span class="token operator">&lt;-</span> as.data.frame<span class="token punctuation">(</span>Titanic<span class="token punctuation">)</span><span class="token punctuation">)</span>
barplot<span class="token punctuation">(</span>Freq <span class="token operator">~</span> Class <span class="token operator">+</span> Survived<span class="token punctuation">,</span> data <span class="token operator">=</span> d.Titanic<span class="token punctuation">,</span>
        subset <span class="token operator">=</span> Age <span class="token operator">==</span> <span class="token string">"Adult"</span> <span class="token operator">&amp;</span> Sex <span class="token operator">==</span> <span class="token string">"Male"</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"barplot(Freq ~ Class + Survived, *)"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"# {passengers}"</span><span class="token punctuation">,</span> legend.text <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment"># Corresponding table :</span>
<span class="token punctuation">(</span>xt <span class="token operator">&lt;-</span> xtabs<span class="token punctuation">(</span>Freq <span class="token operator">~</span> Survived <span class="token operator">+</span> Class <span class="token operator">+</span> Sex<span class="token punctuation">,</span> d.Titanic<span class="token punctuation">,</span> subset <span class="token operator">=</span> Age<span class="token operator">==</span><span class="token string">"Adult"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Alternatively, a mosaic plot :</span>
mosaicplot<span class="token punctuation">(</span>xt<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token string">"Male"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"mosaicplot(Freq ~ Class + Survived, *)"</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>


<span class="token comment"># Default method</span>
require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span> <span class="token comment"># for colours</span>
tN <span class="token operator">&lt;-</span> table<span class="token punctuation">(</span>Ni <span class="token operator">&lt;-</span> stats<span class="token operator">::</span>rpois<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> lambda <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> barplot<span class="token punctuation">(</span>tN<span class="token punctuation">,</span> col <span class="token operator">=</span> rainbow<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#- type = "h" plotting *is* 'bar'plot</span>
lines<span class="token punctuation">(</span>r<span class="token punctuation">,</span> tN<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"h"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>

barplot<span class="token punctuation">(</span>tN<span class="token punctuation">,</span> space <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span> axisnames <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        sub <span class="token operator">=</span> <span class="token string">"barplot(..., space= 1.5, axisnames = FALSE)"</span><span class="token punctuation">)</span>

barplot<span class="token punctuation">(</span>VADeaths<span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
barplot<span class="token punctuation">(</span>VADeaths<span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> beside <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

mp <span class="token operator">&lt;-</span> barplot<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span> <span class="token comment"># default</span>
tot <span class="token operator">&lt;-</span> colMeans<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span>
text<span class="token punctuation">(</span>mp<span class="token punctuation">,</span> tot <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> format<span class="token punctuation">(</span>tot<span class="token punctuation">)</span><span class="token punctuation">,</span> xpd <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span>
barplot<span class="token punctuation">(</span>VADeaths<span class="token punctuation">,</span> beside <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"lightblue"</span><span class="token punctuation">,</span> <span class="token string">"mistyrose"</span><span class="token punctuation">,</span> <span class="token string">"lightcyan"</span><span class="token punctuation">,</span>
                <span class="token string">"lavender"</span><span class="token punctuation">,</span> <span class="token string">"cornsilk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        legend.text <span class="token operator">=</span> rownames<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span>main <span class="token operator">=</span> <span class="token string">"Death Rates in Virginia"</span><span class="token punctuation">,</span> font.main <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>

hh <span class="token operator">&lt;-</span> t<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span>
mybarcol <span class="token operator">&lt;-</span> <span class="token string">"gray20"</span>
mp <span class="token operator">&lt;-</span> barplot<span class="token punctuation">(</span>hh<span class="token punctuation">,</span> beside <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"lightblue"</span><span class="token punctuation">,</span> <span class="token string">"mistyrose"</span><span class="token punctuation">,</span>
                <span class="token string">"lightcyan"</span><span class="token punctuation">,</span> <span class="token string">"lavender"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        legend.text <span class="token operator">=</span> colnames<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"Death Rates in Virginia"</span><span class="token punctuation">,</span> font.main <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
        sub <span class="token operator">=</span> <span class="token string">"Faked upper 2*sigma error bars"</span><span class="token punctuation">,</span> col.sub <span class="token operator">=</span> mybarcol<span class="token punctuation">,</span>
        cex.names <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">)</span>
segments<span class="token punctuation">(</span>mp<span class="token punctuation">,</span> hh<span class="token punctuation">,</span> mp<span class="token punctuation">,</span> hh <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>sqrt<span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span>hh<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> mybarcol<span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>mp<span class="token punctuation">)</span> <span class="token operator">==</span> dim<span class="token punctuation">(</span>hh<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># corresponding matrices</span>
mtext<span class="token punctuation">(</span>side <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> colMeans<span class="token punctuation">(</span>mp<span class="token punctuation">)</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>
      text <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"Mean"</span><span class="token punctuation">,</span> formatC<span class="token punctuation">(</span>colMeans<span class="token punctuation">(</span>hh<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>

<span class="token comment"># Bar shading example</span>
barplot<span class="token punctuation">(</span>VADeaths<span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">15</span><span class="token operator">+</span><span class="token number">10</span><span class="token operator">*</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> density <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">,</span>
        legend.text <span class="token operator">=</span> rownames<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span>main <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token string">"Death Rates in Virginia"</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Border color</span>
barplot<span class="token punctuation">(</span>VADeaths<span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"dark blue"</span><span class="token punctuation">)</span> 


<span class="token comment"># Log scales (not much sense here)</span>
barplot<span class="token punctuation">(</span>tN<span class="token punctuation">,</span> col <span class="token operator">=</span> heat.colors<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">)</span>
barplot<span class="token punctuation">(</span>tN<span class="token punctuation">,</span> col <span class="token operator">=</span> gray.colors<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"xy"</span><span class="token punctuation">)</span>

<span class="token comment"># Legend location</span>
barplot<span class="token punctuation">(</span>height <span class="token operator">=</span> cbind<span class="token punctuation">(</span>x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">465</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">465</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>
                       y <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">840</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">840</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>
                       z <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">37</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        beside <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        width <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">465</span><span class="token punctuation">,</span> <span class="token number">840</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        legend.text <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        args.legend <span class="token operator">=</span> list<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">"topleft"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="box">

<a href="#box" class="help-page-title"><h2>Draw a Box around a Plot</h2></a>

<h3>Description</h3>

<p>This function draws a box around the current plot in the given color
and linetype.  The <code>bty</code> parameter determines
the type of box drawn.  See <code><a href="#par">par</a></code> for details.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">box<span class="token punctuation">(</span>which <span class="token operator">=</span> <span class="token string">"plot"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token string">"solid"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>character, one of <code>"plot"</code>, <code>"figure"</code>,
<code>"inner"</code> and <code>"outer"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>line type of the box.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further <a href="#par">graphical parameters</a>, such as <code>bty</code>,
<code>col</code>, or <code>lwd</code>, see <code><a href="#par">par</a></code>.  Note that
<code>xpd</code> is not accepted as clipping is always to the device
region.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The choice of colour is complicated.  If <code>col</code> was supplied
and is not <code>NA</code>, it is used.  Otherwise, if <code>fg</code> was supplied
and is not <code>NA</code>, it is used.  The final default is <code>par("col")</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#rect">rect</a></code> for drawing of arbitrary rectangles.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> abs<span class="token punctuation">(</span>stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"h"</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
box<span class="token punctuation">(</span>lty <span class="token operator">=</span> <span class="token string">'1373'</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="boxplot">

<a href="#boxplot" class="help-page-title"><h2>Box Plots</h2></a>

<h3>Description</h3>

<p>Produce box-and-whisker plot(s) of the given (grouped) values.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">boxplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
boxplot<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> subset<span class="token punctuation">,</span> na.action <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
        xlab <span class="token operator">=</span> mklab<span class="token punctuation">(</span>y_var <span class="token operator">=</span> horizontal<span class="token punctuation">)</span><span class="token punctuation">,</span>
        ylab <span class="token operator">=</span> mklab<span class="token punctuation">(</span>y_var <span class="token operator">=</span><span class="token operator">!</span>horizontal<span class="token punctuation">)</span><span class="token punctuation">,</span>
        add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> ann <span class="token operator">=</span> <span class="token operator">!</span>add<span class="token punctuation">,</span> horizontal <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        drop <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> sep <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">,</span> lex.order <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
boxplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> range <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> varwidth <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        notch <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> outline <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> names<span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
        border <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightgray"</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
        pars <span class="token operator">=</span> list<span class="token punctuation">(</span>boxwex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> staplewex <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> outwex <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         ann <span class="token operator">=</span> <span class="token operator">!</span>add<span class="token punctuation">,</span> horizontal <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula, such as <code>y ~ grp</code>, where <code>y</code> is a
numeric vector of data values to be split into groups according to
the grouping variable <code>grp</code> (usually a factor).  Note that
<code>~ g1 + g2</code> is equivalent to <code>g1:g2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>formula</code> should be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is to ignore missing
values in either the response or the group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>x- and y-axis annotation, since <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> 3.6.0 with a
non-empty default.  Can be suppressed by <code>ann=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ann</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating if axes should be annotated (by
<code>xlab</code> and <code>ylab</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop, sep, lex.order</code></td>
<td>
<p>passed to <code><a href="https://r-universe.dev/manuals/base.html#split">split.default</a></code>, see there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>for specifying data from which the boxplots are to be
produced. Either a numeric vector, or a single list containing such
vectors. Additional unnamed arguments specify further data
as separate vectors (each corresponding to a component boxplot).
<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>s are allowed in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>For the <code>formula</code> method, named arguments to be passed to
the default method.
</p>
<p>For the default method, unnamed arguments are additional data
vectors (unless <code>x</code> is a list when they are ignored), and named
arguments are arguments and <a href="#par">graphical parameters</a> to be passed
to <code><a href="#bxp">bxp</a></code> in addition to the ones given by argument
<code>pars</code> (and override those in <code>pars</code>). Note that
<code>bxp</code> may or may not make use of graphical parameters it is
passed: see its documentation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>this determines how far the plot whiskers extend out
from the box.  If <code>range</code> is positive, the whiskers extend
to the most extreme data point which is no more than
<code>range</code> times the interquartile range from the box. A value
of zero causes the whiskers to extend to the data extremes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a vector giving the relative widths of the boxes making
up the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varwidth</code></td>
<td>
<p>if <code>varwidth</code> is <code>TRUE</code>, the boxes are
drawn with widths proportional to the square-roots of the number
of observations in the groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notch</code></td>
<td>
<p>if <code>notch</code> is <code>TRUE</code>, a notch is drawn in
each side of the boxes.  If the notches of two plots do not
overlap this is ‘strong evidence’ that the two medians differ
(Chambers <em>et al</em>, 1983, p. 62).  See <code><a href="https://r-universe.dev/manuals/grDevices.html#boxplot.stats">boxplot.stats</a></code>
for the calculations used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outline</code></td>
<td>
<p>if <code>outline</code> is not true, the outliers are
not drawn (as points whereas S+ uses lines).</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>group labels which will be printed under each boxplot.
Can be a character vector or an <a href="https://r-universe.dev/manuals/base.html#expression">expression</a> (see
<a href="https://r-universe.dev/manuals/grDevices.html#plotmath">plotmath</a>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxwex</code></td>
<td>
<p>a scale factor to be applied to all boxes.  When there
are only a few groups, the appearance of the plot can be improved
by making the boxes narrower.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>staplewex</code></td>
<td>
<p>staple line width expansion, proportional to box
width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outwex</code></td>
<td>
<p>outlier line width expansion, proportional to box
width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>TRUE</code> (the default) then a boxplot is
produced.  If not, the summaries which the boxplots are based on
are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>an optional vector of colors for the outlines of the
boxplots.  The values in <code>border</code> are recycled if the
length of <code>border</code> is less than the number of plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>if <code>col</code> is non-null it is assumed to contain colors
to be used to colour the bodies of the box plots. By default they
are in the background colour.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>character indicating if x or y or both coordinates should
be plotted in log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>a list of (potentially many) more graphical parameters,
e.g., <code>boxwex</code> or <code>outpch</code>; these are passed to
<code><a href="#bxp">bxp</a></code> (if <code>plot</code> is true); for details, see there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>
<p>logical indicating if the boxplots should be
horizontal; default <code>FALSE</code> means vertical boxes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical, if true <em>add</em> boxplot to current plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>numeric vector giving the locations where the boxplots should
be drawn, particularly when <code>add = TRUE</code>;
defaults to <code>1:n</code> where <code>n</code> is the number of boxes.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The generic function <code>boxplot</code> currently has a default method
(<code>boxplot.default</code>) and a formula interface (<code>boxplot.formula</code>).
</p>
<p>If multiple groups are supplied either as multiple arguments or via a
formula, parallel boxplots will be plotted, in the order of the
arguments or the order of the levels of the factor (see
<code><a href="https://r-universe.dev/manuals/base.html#factor">factor</a></code>).
</p>
<p>Missing values are ignored when forming boxplots.
</p>


<h3>Value</h3>

<p>List with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>a matrix, each column contains the extreme of the lower
whisker, the lower hinge, the median, the upper hinge and the
extreme of the upper whisker for one group/plot.  If all the inputs
have the same class attribute, so will this component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a vector with the number of (non-<code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>) observations in each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>a matrix where each column contains the lower and upper
extremes of the notch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>the values of any data points which lie beyond the
extremes of the whiskers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>a vector of the same length as <code>out</code> whose elements
indicate to which group the outlier belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>a vector of names for the groups.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988).
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983).
<em>Graphical Methods for Data Analysis</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005).
<em>R Graphics</em>.
Chapman &amp; Hall/CRC Press.
</p>
<p>See also <code><a href="https://r-universe.dev/manuals/grDevices.html#boxplot.stats">boxplot.stats</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/grDevices.html#boxplot.stats">boxplot.stats</a></code> which does the computation,
<code><a href="#bxp">bxp</a></code> for the plotting and more examples;
and <code><a href="#stripchart">stripchart</a></code> for an alternative (with small data
sets).
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## boxplot on a formula:</span>
boxplot<span class="token punctuation">(</span>count <span class="token operator">~</span> spray<span class="token punctuation">,</span> data <span class="token operator">=</span> InsectSprays<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightgray"</span><span class="token punctuation">)</span>
<span class="token comment"># *add* notches (somewhat funny here &lt;--&gt; warning "notches .. outside hinges"):</span>
boxplot<span class="token punctuation">(</span>count <span class="token operator">~</span> spray<span class="token punctuation">,</span> data <span class="token operator">=</span> InsectSprays<span class="token punctuation">,</span>
        notch <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span>

boxplot<span class="token punctuation">(</span>decrease <span class="token operator">~</span> treatment<span class="token punctuation">,</span> data <span class="token operator">=</span> OrchardSprays<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"bisque"</span><span class="token punctuation">,</span>
        log <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">)</span>
<span class="token comment">## horizontal=TRUE, switching  y &lt;--&gt; x :</span>
boxplot<span class="token punctuation">(</span>decrease <span class="token operator">~</span> treatment<span class="token punctuation">,</span> data <span class="token operator">=</span> OrchardSprays<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"bisque"</span><span class="token punctuation">,</span>
        log <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">,</span> horizontal<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>

rb <span class="token operator">&lt;-</span> boxplot<span class="token punctuation">(</span>decrease <span class="token operator">~</span> treatment<span class="token punctuation">,</span> data <span class="token operator">=</span> OrchardSprays<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"bisque"</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span><span class="token string">"Comparing boxplot()s and non-robust mean +/- SD"</span><span class="token punctuation">)</span>
mn.t <span class="token operator">&lt;-</span> tapply<span class="token punctuation">(</span>OrchardSprays<span class="token operator">$</span>decrease<span class="token punctuation">,</span> OrchardSprays<span class="token operator">$</span>treatment<span class="token punctuation">,</span> mean<span class="token punctuation">)</span>
sd.t <span class="token operator">&lt;-</span> tapply<span class="token punctuation">(</span>OrchardSprays<span class="token operator">$</span>decrease<span class="token punctuation">,</span> OrchardSprays<span class="token operator">$</span>treatment<span class="token punctuation">,</span> sd<span class="token punctuation">)</span>
xi <span class="token operator">&lt;-</span> <span class="token number">0.3</span> <span class="token operator">+</span> seq<span class="token punctuation">(</span>rb<span class="token operator">$</span>n<span class="token punctuation">)</span>
points<span class="token punctuation">(</span>xi<span class="token punctuation">,</span> mn.t<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"orange"</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">)</span>
arrows<span class="token punctuation">(</span>xi<span class="token punctuation">,</span> mn.t <span class="token operator">-</span> sd.t<span class="token punctuation">,</span> xi<span class="token punctuation">,</span> mn.t <span class="token operator">+</span> sd.t<span class="token punctuation">,</span>
       code <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">.1</span><span class="token punctuation">)</span>

<span class="token comment">## boxplot on a matrix:</span>
mat <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>Uni05 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">21</span><span class="token punctuation">,</span> Norm <span class="token operator">=</span> rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             `<span class="token number">5</span>T` <span class="token operator">=</span> rt<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Gam2 <span class="token operator">=</span> rgamma<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> shape <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
boxplot<span class="token punctuation">(</span>mat<span class="token punctuation">)</span> <span class="token comment"># directly, calling boxplot.matrix()</span>

<span class="token comment">## boxplot on a data frame:</span>
df. <span class="token operator">&lt;-</span> as.data.frame<span class="token punctuation">(</span>mat<span class="token punctuation">)</span>
par<span class="token punctuation">(</span>las <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># all axis labels horizontal</span>
boxplot<span class="token punctuation">(</span>df.<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"boxplot(*, horizontal = TRUE)"</span><span class="token punctuation">,</span> horizontal <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

<span class="token comment">## Using 'at = ' and adding boxplots -- example idea by Roger Bivand :</span>
boxplot<span class="token punctuation">(</span>len <span class="token operator">~</span> dose<span class="token punctuation">,</span> data <span class="token operator">=</span> ToothGrowth<span class="token punctuation">,</span>
        boxwex <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span> <span class="token operator">-</span> <span class="token number">0.2</span><span class="token punctuation">,</span>
        subset <span class="token operator">=</span> supp <span class="token operator">==</span> <span class="token string">"VC"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"yellow"</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"Guinea Pigs' Tooth Growth"</span><span class="token punctuation">,</span>
        xlab <span class="token operator">=</span> <span class="token string">"Vitamin C dose mg"</span><span class="token punctuation">,</span>
        ylab <span class="token operator">=</span> <span class="token string">"tooth length"</span><span class="token punctuation">,</span>
        xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">3.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">)</span>
boxplot<span class="token punctuation">(</span>len <span class="token operator">~</span> dose<span class="token punctuation">,</span> data <span class="token operator">=</span> ToothGrowth<span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
        boxwex <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">,</span>
        subset <span class="token operator">=</span> supp <span class="token operator">==</span> <span class="token string">"OJ"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"orange"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"Ascorbic acid"</span><span class="token punctuation">,</span> <span class="token string">"Orange juice"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       fill <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"yellow"</span><span class="token punctuation">,</span> <span class="token string">"orange"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## With less effort (slightly different) using factor *interaction*:</span>
boxplot<span class="token punctuation">(</span>len <span class="token operator">~</span> dose<span class="token operator">:</span>supp<span class="token punctuation">,</span> data <span class="token operator">=</span> ToothGrowth<span class="token punctuation">,</span>
        boxwex <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"orange"</span><span class="token punctuation">,</span> <span class="token string">"yellow"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"Guinea Pigs' Tooth Growth"</span><span class="token punctuation">,</span>
        xlab <span class="token operator">=</span> <span class="token string">"Vitamin C dose mg"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"tooth length"</span><span class="token punctuation">,</span>
        sep <span class="token operator">=</span> <span class="token string">":"</span><span class="token punctuation">,</span> lex.order <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">)</span>

<span class="token comment">## more examples in  help(bxp)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="boxplot.matrix">

<a href="#boxplot.matrix" class="help-page-title"><h2>Draw a Boxplot for each Column (Row) of a Matrix</h2></a>

<h3>Description</h3>

<p>Interpreting the columns (or rows) of a matrix as different groups, draw a
boxplot for each.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'matrix'</span>
boxplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> use.cols <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.cols</code></td>
<td>
<p>logical indicating if columns (by default) or rows
(<code>use.cols = FALSE</code>) should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to <code><a href="#boxplot">boxplot</a></code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list as for <code><a href="#boxplot">boxplot</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 1995, for S+, then <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package <a href="https://CRAN.R-project.org/package=sfsmisc" target="_blank"><span class="pkg">sfsmisc</span></a>.</p>


<h3>See Also</h3>

<p><code><a href="#boxplot">boxplot.default</a></code> which already works nowadays with
data.frames; <code><a href="#boxplot">boxplot.formula</a></code>, <code><a href="#plot.factor">plot.factor</a></code> which
work with (the more general concept) of a grouping factor.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Very similar to the example in ?boxplot</span>
mat <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>Uni05 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">21</span><span class="token punctuation">,</span> Norm <span class="token operator">=</span> rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             T5 <span class="token operator">=</span> rt<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Gam2 <span class="token operator">=</span> rgamma<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> shape <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
boxplot<span class="token punctuation">(</span>mat<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"boxplot.matrix(...., main = ...)"</span><span class="token punctuation">,</span>
        notch <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="bxp">

<a href="#bxp" class="help-page-title"><h2>Draw Box Plots from Summaries</h2></a>

<h3>Description</h3>

<p><code>bxp</code> draws box plots based on the given summaries in <code>z</code>.
It is usually called from within <code><a href="#boxplot">boxplot</a></code>, but can be
invoked directly.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">bxp<span class="token punctuation">(</span>z<span class="token punctuation">,</span> notch <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> varwidth <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
    outline <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> notch.frac <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
    border <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pars <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> axes<span class="token punctuation">,</span>
    horizontal <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> ann <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
    add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> show.names <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
    <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a list containing data summaries to be used in constructing
the plots.  These are usually the result of a call to
<code><a href="#boxplot">boxplot</a></code>, but can be generated in any fashion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notch</code></td>
<td>
<p>if <code>notch</code> is <code>TRUE</code>, a notch is drawn in each
side of the boxes.  If the notches of two plots do not overlap then
the medians are significantly different at the 5 percent level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a vector giving the relative widths of the boxes making
up the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varwidth</code></td>
<td>
<p>if <code>varwidth</code> is <code>TRUE</code>, the boxes are drawn
with widths proportional to the square-roots of the number of
observations in the groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outline</code></td>
<td>
<p>if <code>outline</code> is not true, the outliers are not
drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notch.frac</code></td>
<td>
<p>numeric in (0,1). When <code>notch = TRUE</code>, the
fraction of the box width that the notches should use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>character or numeric (vector), the color of the box
borders.  Is recycled for multiple boxes.  Is used as default for
the <code>boxcol</code>, <code>medcol</code>, <code>whiskcol</code>, <code>staplecol</code>,
and <code>outcol</code> options (see below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>character, indicating if any axis should be drawn in
logarithmic scale, as in <code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame.plot</code></td>
<td>
<p>logical, indicating if a ‘frame’
(<code><a href="#box">box</a></code>) should be drawn; defaults to <code>TRUE</code>, unless
<code>axes = FALSE</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>
<p>logical indicating if the  boxplots should be
horizontal; default <code>FALSE</code> means vertical boxes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ann</code></td>
<td>
<p>a logical value indicating whether the default annotation
(title and x and y axis labels) should appear on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical, if true <em>add</em> boxplot to current plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>numeric vector giving the locations where the boxplots
should be drawn, particularly when <code>add = TRUE</code>; defaults to
<code>1:n</code> where <code>n</code> is the number of boxes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.names</code></td>
<td>
<p>Set to <code>TRUE</code> or <code>FALSE</code> to override the
defaults on whether an x-axis label is printed for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars,...</code></td>
<td>
<p><a href="#par">graphical parameters</a> (etc) can be passed as
arguments to this function, either as a list (<code>pars</code>) or
normally(<code>...</code>), see the following.  (Those in <code>...</code>
take precedence over those in <code>pars</code>.)
</p>
<p>Currently, <code>yaxs</code> and <code>ylim</code> are used ‘along the
boxplot’, i.e., vertically, when <code>horizontal</code> is
false, and <code>xlim</code> horizontally.
<code>xaxt</code>, <code>yaxt</code>, <code>las</code>, <code>cex.axis</code>,
<code>gap.axis</code>, and
<code>col.axis</code> are passed to <code><a href="#axis">axis</a></code>, and <code>main</code>,
<code>cex.main</code>, <code>col.main</code>, <code>sub</code>, <code>cex.sub</code>,
<code>col.sub</code>, <code>xlab</code>, <code>ylab</code>, <code>cex.lab</code>, and
<code>col.lab</code> are passed to <code><a href="#title">title</a></code>.
</p>
<p>In addition, <code>axes</code> is accepted (see
<code><a href="#plot.window">plot.window</a></code>), with default <code>TRUE</code>.
</p>
<p>The following arguments (or <code>pars</code> components) allow further
customization of the boxplot graphics.  Their defaults are typically
determined from the non-prefixed version (e.g., <code>boxlty</code> from
<code>lty</code>), either from the specified argument or <code>pars</code>
component or the corresponding <code><a href="#par">par</a></code> one.
</p>

<dl>
<dt>boxwex:</dt>
<dd>
<p>a scale factor to be applied to all boxes.  When there
are only a few groups, the appearance of the plot can be improved by
making the boxes narrower.  The default depends on <code>at</code> and
typically is <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.8</mn></mrow><annotation encoding="application/x-tex">0.8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.8</span></span></span></span></code>.</p>
</dd>
<dt>staplewex, outwex:</dt>
<dd>
<p>staple and outlier line width expansion,
proportional to box width; both default to 0.5.</p>
</dd>
<dt>boxlty, boxlwd, boxcol, boxfill:</dt>
<dd>
<p>box outline type, width,
color, and fill color (which currently defaults to <code>col</code> and will
in future default to <code>par("bg")</code>).</p>
</dd>
<dt>medlty, medlwd, medpch, medcex, medcol, medbg:</dt>
<dd>
<p>median line type,
line width, point character, point size expansion, color, and
background color.  The default <code>medpch = NA</code> suppresses the
point, and <code>medlty = "blank"</code> does so for the line.
Note that <code>medlwd</code> defaults to
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo></mrow><annotation encoding="application/x-tex">3\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mord">×</span></span></span></span></code> the default <code>lwd</code>.</p>
</dd>
<dt>whisklty, whisklwd, whiskcol:</dt>
<dd>
<p>whisker line type (default:
<code>"dashed"</code>), width, and color.</p>
</dd>
<dt>staplelty, staplelwd, staplecol:</dt>
<dd>
<p>staple (= end of whisker) line
type, width, and color.</p>
</dd>
<dt>outlty, outlwd, outpch, outcex, outcol, outbg:</dt>
<dd>
<p>outlier line
type, line width, point character, point size expansion, color, and
background color.  The default <code>outlty =  "blank"</code> suppresses the
lines and <code>outpch = NA</code> suppresses points.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An invisible vector, actually identical to the <code>at</code> argument,
with the coordinates ("x" if horizontal is false, "y" otherwise) of
box centers, useful for adding to the plot.
</p>


<h3>Note</h3>

<p>When <code>add = FALSE</code>, <code>xlim</code> now defaults to <code>xlim =
    range(at, *) + c(-0.5, 0.5)</code>.  It will usually be a good idea to
specify <code>xlim</code> if the "x" axis has a log scale or <code>width</code> is
far from uniform.
</p>


<h3>Author(s)</h3>

<p>The R Core development team and Arni Magnusson
(then at U Washington) who has provided most changes for the
box*, med*, whisk*, staple*, and out* arguments.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">753</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>bx.p <span class="token operator">&lt;-</span> boxplot<span class="token punctuation">(</span>split<span class="token punctuation">(</span>rt<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gl<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span>  c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
bxp<span class="token punctuation">(</span>bx.p<span class="token punctuation">,</span> xaxt <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
bxp<span class="token punctuation">(</span>bx.p<span class="token punctuation">,</span> notch <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> boxfill <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span>
bxp<span class="token punctuation">(</span>bx.p<span class="token punctuation">,</span> notch <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> boxfill <span class="token operator">=</span> <span class="token string">"lightblue"</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
    outline <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"bxp(*, frame.plot= FALSE, outline= FALSE)"</span><span class="token punctuation">)</span>
bxp<span class="token punctuation">(</span>bx.p<span class="token punctuation">,</span> notch <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> boxfill <span class="token operator">=</span> <span class="token string">"lightblue"</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span>
    ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"green"</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">,</span>
    main <span class="token operator">=</span> <span class="token string">"... log = 'x', ylim = *"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## single group -- no label</span>
boxplot <span class="token punctuation">(</span>weight <span class="token operator">~</span> group<span class="token punctuation">,</span> data <span class="token operator">=</span> PlantGrowth<span class="token punctuation">,</span> subset <span class="token operator">=</span> group <span class="token operator">==</span> <span class="token string">"ctrl"</span><span class="token punctuation">)</span>
<span class="token comment">## with label</span>
bx <span class="token operator">&lt;-</span> boxplot<span class="token punctuation">(</span>weight <span class="token operator">~</span> group<span class="token punctuation">,</span> data <span class="token operator">=</span> PlantGrowth<span class="token punctuation">,</span>
              subset <span class="token operator">=</span> group <span class="token operator">==</span> <span class="token string">"ctrl"</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
bxp<span class="token punctuation">(</span>bx<span class="token punctuation">,</span> show.names<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## passing gap.axis=* to axis(), PR#18109:</span>
boxplot<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span>rnorm<span class="token punctuation">(</span><span class="token number">1e3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        cex.axis <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span> gap.axis <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># showing *all* labels</span>


z <span class="token operator">&lt;-</span> split<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rpois<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
boxplot<span class="token punctuation">(</span>z<span class="token punctuation">,</span> whisklty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"boxplot(z, whisklty = 3)"</span><span class="token punctuation">)</span>

<span class="token comment">## Colour support similar to plot.default:</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"light gray"</span><span class="token punctuation">,</span> fg <span class="token operator">=</span> <span class="token string">"midnight blue"</span><span class="token punctuation">)</span>
boxplot<span class="token punctuation">(</span>z<span class="token punctuation">,</span>   col.axis <span class="token operator">=</span> <span class="token string">"skyblue3"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"boxplot(*, col.axis=..,main=..)"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>z<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col.axis <span class="token operator">=</span> <span class="token string">"skyblue3"</span><span class="token punctuation">,</span> main <span class="token operator">=</span>    <span class="token string">"plot(*, col.axis=..,main=..)"</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"par(bg=\"light gray\", fg=\"midnight blue\")"</span><span class="token punctuation">,</span>
      outer <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.2</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## Mimic S-Plus:</span>
splus <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>boxwex <span class="token operator">=</span> <span class="token number">0.4</span><span class="token punctuation">,</span> staplewex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> outwex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> boxfill <span class="token operator">=</span> <span class="token string">"grey40"</span><span class="token punctuation">,</span>
              medlwd <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> medcol <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">,</span> whisklty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> outlty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> outpch <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
boxplot<span class="token punctuation">(</span>z<span class="token punctuation">,</span> pars <span class="token operator">=</span> splus<span class="token punctuation">)</span>
<span class="token comment">## Recycled and "sweeping" parameters</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 boxplot<span class="token punctuation">(</span>z<span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> medlty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> medlwd <span class="token operator">=</span> <span class="token number">2.5</span><span class="token punctuation">)</span>
 boxplot<span class="token punctuation">(</span>z<span class="token punctuation">,</span> boxfill <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span> medcol <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>
<span class="token comment">## too many possibilities</span>
boxplot<span class="token punctuation">(</span>z<span class="token punctuation">,</span> boxfill <span class="token operator">=</span> <span class="token string">"light gray"</span><span class="token punctuation">,</span> outpch <span class="token operator">=</span> <span class="token number">21</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> outlty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
        bg <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
        medcol <span class="token operator">=</span> <span class="token string">"dark blue"</span><span class="token punctuation">,</span> medcex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> medpch <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="cdplot">

<a href="#cdplot" class="help-page-title"><h2>Conditional Density Plots</h2></a>

<h3>Description</h3>

<p>Computes and plots conditional densities describing how the
conditional distribution of a categorical variable <code>y</code> changes over a
numerical variable <code>x</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">cdplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
cdplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
  plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> tol.ylab <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">,</span> ylevels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  bw <span class="token operator">=</span> <span class="token string">"nrd0"</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">,</span> from <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> to <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  yaxlabels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
cdplot<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> tol.ylab <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">,</span> ylevels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  bw <span class="token operator">=</span> <span class="token string">"nrd0"</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">,</span> from <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> to <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  yaxlabels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
  subset <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object, the default method expects a single numerical
variable (or an object coercible to this).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>"factor"</code> interpreted to be the dependent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>"formula"</code> of type <code>y ~ x</code> with a single dependent
<code>"factor"</code> and a single numerical explanatory variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. Should the computed conditional densities be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.ylab</code></td>
<td>
<p>convenience tolerance parameter for y-axis annotation.
If the distance between two labels drops under this threshold, they are
plotted equidistantly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylevels</code></td>
<td>
<p>a character or numeric vector specifying in which order
the levels of the dependent variable should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw, n, from, to, ...</code></td>
<td>
<p>arguments passed to <code><a href="https://r-universe.dev/manuals/stats.html#density">density</a></code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector of fill colors of the same length as <code>levels(y)</code>.
The default is to call <code><a href="https://r-universe.dev/manuals/grDevices.html#gray.colors">gray.colors</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>border color of shaded polygons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab</code></td>
<td>
<p>character strings for annotation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxlabels</code></td>
<td>
<p>character vector for annotation of y axis, defaults to
<code>levels(y)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>the range of x and y values with sensible defaults.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>cdplot</code> computes the conditional densities of <code>x</code> given
the levels of <code>y</code> weighted by the marginal distribution of <code>y</code>.
The densities are derived cumulatively over the levels of <code>y</code>.
</p>
<p>This visualization technique is similar to spinograms (see <code><a href="#spineplot">spineplot</a></code>)
and plots <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(y | x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></code> against <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code>. The conditional probabilities
are not derived by discretization (as in the spinogram), but using a smoothing
approach via <code><a href="https://r-universe.dev/manuals/stats.html#density">density</a></code>.
</p>
<p>Note, that the estimates of the conditional densities are more reliable for
high-density regions of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code>. Conversely, the are less reliable in regions
with only few <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code> observations.
</p>


<h3>Value</h3>

<p>The conditional density functions (cumulative over the levels of <code>y</code>)
are returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Achim Zeileis <a href="mailto:Achim.Zeileis@R-project.org">Achim.Zeileis@R-project.org</a>
</p>


<h3>References</h3>

<p>Hofmann, H., Theus, M. (2005), <em>Interactive graphics for visualizing
conditional distributions</em>, Unpublished Manuscript.
</p>


<h3>See Also</h3>

<p><code><a href="#spineplot">spineplot</a></code>, <code><a href="https://r-universe.dev/manuals/stats.html#density">density</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## NASA space shuttle o-ring failures</span>
fail <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                 <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               levels <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">,</span> <span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
temperature <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span>
                 <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span>

<span class="token comment">## CD plot</span>
cdplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">)</span>
cdplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">,</span> bw <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
cdplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">,</span> bw <span class="token operator">=</span> <span class="token string">"SJ"</span><span class="token punctuation">)</span>

<span class="token comment">## compare with spinogram</span>
<span class="token punctuation">(</span>spineplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">,</span> breaks <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## highlighting for failures</span>
cdplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">,</span> ylevels <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">## scatter plot with conditional density</span>
cdens <span class="token operator">&lt;-</span> cdplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>I<span class="token punctuation">(</span>as.numeric<span class="token punctuation">(</span>fail<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">~</span> jitter<span class="token punctuation">(</span>temperature<span class="token punctuation">,</span> factor <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> <span class="token string">"Temperature"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Conditional failure probability"</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span><span class="token number">53</span><span class="token operator">:</span><span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> cdens<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">53</span><span class="token operator">:</span><span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="clip">

<a href="#clip" class="help-page-title"><h2>Set Clipping Region</h2></a>

<h3>Description</h3>

<p>Set clipping region in user coordinates
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">clip<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> y2<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>x1, x2, y1, y2</code></td>
<td>
<p>user coordinates of clipping rectangle</p>
</td>
</tr></table>
<h3>Details</h3>

<p>How the clipping rectangle is set depends on the setting of
<code><a href="#par">par</a>("xpd")</code>: this function changes the current setting
until the next high-level plotting command resets it.
</p>
<p>Clipping of lines, rectangles and polygons is done in the graphics
engine, but clipping of text is if possible done in the device, so the
effect of clipping text is device-dependent (and may result in text
not wholly within the clipping region being omitted entirely).
</p>
<p>Exactly when the clipping region will be reset can be hard to
predict.  <code><a href="#frame">plot.new</a></code> always resets it.
Functions such as <code><a href="#lines">lines</a></code> and <code><a href="#text">text</a></code> only
reset it if <code><a href="#par">par</a>("xpd")</code> has been changed.  However,
functions such as <code><a href="#box">box</a></code>, <code><a href="#mtext">mtext</a></code>,
<code><a href="#title">title</a></code> and <code><a href="https://r-universe.dev/manuals/stats.html#dendrogram">plot.dendrogram</a></code> can manipulate
the <code>xpd</code> setting.
</p>


<h3>See Also</h3>

<p><code><a href="#par">par</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">x <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
usr <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span><span class="token string">"usr"</span><span class="token punctuation">)</span>
clip<span class="token punctuation">(</span>usr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> usr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> usr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
clip<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> usr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> usr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> usr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
do.call<span class="token punctuation">(</span><span class="token string">"clip"</span><span class="token punctuation">,</span> as.list<span class="token punctuation">(</span>usr<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># reset to plot region</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="contour">

<a href="#contour" class="help-page-title"><h2>Display Contours</h2></a>

<h3>Description</h3>

<p>Create a contour plot, or add contour lines to an existing plot.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">contour<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
contour<span class="token punctuation">(</span>x <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> nrow<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        y <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> ncol<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        z<span class="token punctuation">,</span>
        nlevels <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> levels <span class="token operator">=</span> pretty<span class="token punctuation">(</span>zlim<span class="token punctuation">,</span> nlevels<span class="token punctuation">)</span><span class="token punctuation">,</span>
        labels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
        xlim <span class="token operator">=</span> range<span class="token punctuation">(</span>x<span class="token punctuation">,</span> finite <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        ylim <span class="token operator">=</span> range<span class="token punctuation">(</span>y<span class="token punctuation">,</span> finite <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        zlim <span class="token operator">=</span> range<span class="token punctuation">(</span>z<span class="token punctuation">,</span> finite <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        labcex <span class="token operator">=</span> <span class="token number">0.6</span><span class="token punctuation">,</span> drawlabels <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"flattest"</span><span class="token punctuation">,</span>
        vfont<span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> axes<span class="token punctuation">,</span>
        col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lty"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lwd"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are
measured.  These must be in ascending order.  By default, equally
spaced values from 0 to 1 are used.  If <code>x</code> is a <code>list</code>,
its components <code>x$x</code> and <code>x$y</code> are used for <code>x</code>
and <code>y</code>, respectively. If the list has component <code>z</code> this
is used for <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a matrix containing the values to be plotted (<code>NA</code>s are
allowed).  Note that <code>x</code> can be used instead of <code>z</code> for
convenience.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>number of contour levels desired <b>iff</b>
<code>levels</code> is not supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>numeric vector of levels at which to draw contour
lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>a vector giving the labels for the contour lines.  If
<code>NULL</code> then the levels are used as labels, otherwise this is
coerced by <code><a href="https://r-universe.dev/manuals/base.html#character">as.character</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labcex</code></td>
<td>
<p><code>cex</code> for contour labelling.  This is an absolute
size, not a multiple of <code>par("cex")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drawlabels</code></td>
<td>
<p>logical.  Contours are labelled if <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string specifying where the labels will be
located. Possible values are <code>"simple"</code>, <code>"edge"</code> and
<code>"flattest"</code> (the default).  See the ‘Details’ section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vfont</code></td>
<td>
<p>if <code>NULL</code>, the current font family and face are used
for the contour labels.  If a character vector of length 2 then
Hershey vector fonts are used for the contour labels. The first
element of the vector selects a typeface and the second element
selects a fontindex (see <code><a href="#text">text</a></code> for more information).
The default is <code>NULL</code> on graphics devices with high-quality
rotation of text and <code>c("sans serif", "plain")</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim, zlim</code></td>
<td>
<p>x-, y- and z-limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes, frame.plot</code></td>
<td>
<p>logical indicating whether axes or a box
should be drawn, see <code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour(s) for the lines drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>line type(s) for the lines drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width(s) for the lines drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical. If <code>TRUE</code>, add to a current plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code><a href="#plot.window">plot.window</a></code>,
<code><a href="#title">title</a></code>, <code><a href="#zAxis">Axis</a></code> and <code><a href="#box">box</a></code>,
typically <a href="#par">graphical parameters</a> such as <code>cex.axis</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>contour</code> is a generic function with only a default method in
base <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.
</p>
<p>The methods for positioning the labels on contours are <code>"simple"</code>
(draw at the edge of the plot, overlaying the contour line),
<code>"edge"</code> (draw at the edge of the plot, embedded in the contour
line, with no labels overlapping) and <code>"flattest"</code>
(draw on the flattest section of the contour, embedded in the
contour line, with no labels overlapping).  The second and third may
not draw a label on every contour line.
</p>
<p>For information about vector fonts, see the
help for <code><a href="#text">text</a></code> and <code><a href="https://r-universe.dev/manuals/grDevices.html#Hershey">Hershey</a></code>.
</p>
<p>Notice that <code>contour</code> interprets the <code>z</code> matrix as a table of
<code>f(x[i], y[j])</code> values, so that the x axis corresponds to row
number and the y axis to column number, with column 1 at the bottom,
i.e. a 90 degree counter-clockwise rotation of the conventional textual
layout.
</p>
<p>Vector (of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">&gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code>) <code>col</code>, <code>lty</code>, and <code>lwd</code> are
applied along <code>levels</code> and recycled, see the Examples.
</p>
<p>Alternatively, use <code><a href="https://deepayan.r-universe.dev/manual/lattice.html#levelplot">contourplot</a></code> from the
<a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a> package where the <code><a href="https://r-universe.dev/manuals/stats.html#formula">formula</a></code> notation allows
to use vectors <code>x</code>, <code>y</code>, and <code>z</code> of the same length.
</p>
<p>There is limited control over the axes and frame as arguments
<code>col</code>, <code>lwd</code> and <code>lty</code> refer to the contour lines
(rather than being general <a href="#par">graphical parameters</a>).  For more control,
add contours to a plot, or add axes and frame to a contour plot.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#options">options</a>("max.contour.segments")</code> for the maximal
complexity of a single contour line.
</p>
<p><code><a href="https://r-universe.dev/manuals/grDevices.html#contourLines">contourLines</a></code>, <code><a href="#filled.contour">filled.contour</a></code>
for color-filled contours,
<code><a href="https://deepayan.r-universe.dev/manual/lattice.html#levelplot">contourplot</a></code> (and
<code><a href="https://deepayan.r-universe.dev/manual/lattice.html#levelplot">levelplot</a></code>) from package <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>.
Further, <code><a href="#image">image</a></code> and the graphics demo which can be
invoked as <code>demo(graphics)</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span> <span class="token comment"># for colours</span>
x <span class="token operator">&lt;-</span> <span class="token operator">-</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">16</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
contour<span class="token punctuation">(</span>outer<span class="token punctuation">(</span>x<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"edge"</span><span class="token punctuation">,</span> vfont <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"sans serif"</span><span class="token punctuation">,</span> <span class="token string">"plain"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
z <span class="token operator">&lt;-</span> outer<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sqrt<span class="token punctuation">(</span>abs<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> FUN <span class="token operator">=</span> `<span class="token operator">/</span>`<span class="token punctuation">)</span>
image<span class="token punctuation">(</span>x<span class="token punctuation">,</span> x<span class="token punctuation">,</span> z<span class="token punctuation">)</span>
contour<span class="token punctuation">(</span>x<span class="token punctuation">,</span> x<span class="token punctuation">,</span> z<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"edge"</span><span class="token punctuation">,</span>
        vfont <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"sans serif"</span><span class="token punctuation">,</span> <span class="token string">"plain"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
contour<span class="token punctuation">(</span>x<span class="token punctuation">,</span> x<span class="token punctuation">,</span> z<span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"simple"</span><span class="token punctuation">,</span> labcex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        xlab <span class="token operator">=</span> quote<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> quote<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
contour<span class="token punctuation">(</span>x<span class="token punctuation">,</span> x<span class="token punctuation">,</span> z<span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nlevels <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"simple"</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"20 levels; \"simple\" labelling method"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## Passing multiple colours / lty / lwd :</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
z <span class="token operator">&lt;-</span> outer<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">9</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">)</span>
<span class="token comment">## Using default levels &lt;- pretty(range(z, finite = TRUE), 10),</span>
<span class="token comment">##  the first and last of which typically are *not* drawn:</span>
<span class="token punctuation">(</span>levs <span class="token operator">&lt;-</span> pretty<span class="token punctuation">(</span>z<span class="token punctuation">,</span> n<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># -300 -200 ... 600 700</span>
contour<span class="token punctuation">(</span>z<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token comment">## Set levels explicitly; show that 'lwd' and 'lty' are recycled as well:</span>
contour<span class="token punctuation">(</span>z<span class="token punctuation">,</span> levels<span class="token operator">=</span>levs<span class="token punctuation">[</span><span class="token operator">-</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>length<span class="token punctuation">(</span>levs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span> <span class="token operator">*</span><span class="token number">1.5</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## Persian Rug Art:</span>
x <span class="token operator">&lt;-</span> y <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>outer<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> y<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> `<span class="token operator">+</span>`<span class="token punctuation">)</span><span class="token punctuation">)</span>
opar <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>f <span class="token keyword">in</span> pi<span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  contour<span class="token punctuation">(</span>cos<span class="token punctuation">(</span>r<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>r<span class="token operator">/</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span>
          drawlabels <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

rx <span class="token operator">&lt;-</span> range<span class="token punctuation">(</span>x <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">1</span><span class="token operator">:</span>nrow<span class="token punctuation">(</span>volcano<span class="token punctuation">)</span><span class="token punctuation">)</span>
ry <span class="token operator">&lt;-</span> range<span class="token punctuation">(</span>y <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">1</span><span class="token operator">:</span>ncol<span class="token punctuation">(</span>volcano<span class="token punctuation">)</span><span class="token punctuation">)</span>
ry <span class="token operator">&lt;-</span> ry <span class="token operator">+</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>diff<span class="token punctuation">(</span>rx<span class="token punctuation">)</span> <span class="token operator">-</span> diff<span class="token punctuation">(</span>ry<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
tcol <span class="token operator">&lt;-</span> terrain.colors<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>opar<span class="token punctuation">)</span><span class="token punctuation">;</span> opar <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>pty <span class="token operator">=</span> <span class="token string">"s"</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"lightcyan"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> rx<span class="token punctuation">,</span> ylim <span class="token operator">=</span> ry<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
u <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span><span class="token string">"usr"</span><span class="token punctuation">)</span>
rect<span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> u<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> u<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col <span class="token operator">=</span> tcol<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
contour<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> volcano<span class="token punctuation">,</span> col <span class="token operator">=</span> tcol<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token string">"solid"</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
        vfont <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"sans serif"</span><span class="token punctuation">,</span> <span class="token string">"plain"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span><span class="token string">"A Topographic Map of Maunga Whau"</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>h <span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> v <span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightgray"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span>

<span class="token comment">## contourLines produces the same contour lines as contour</span>
plot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> rx<span class="token punctuation">,</span> ylim <span class="token operator">=</span> ry<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
u <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span><span class="token string">"usr"</span><span class="token punctuation">)</span>
rect<span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> u<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> u<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col <span class="token operator">=</span> tcol<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
contour<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> volcano<span class="token punctuation">,</span> col <span class="token operator">=</span> tcol<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token string">"solid"</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
        vfont <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"sans serif"</span><span class="token punctuation">,</span> <span class="token string">"plain"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
line.list <span class="token operator">&lt;-</span> contourLines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> volcano<span class="token punctuation">)</span>
invisible<span class="token punctuation">(</span>lapply<span class="token punctuation">(</span>line.list<span class="token punctuation">,</span> lines<span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> col<span class="token operator">=</span>adjustcolor<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>opar<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="convertXY">

<a href="#convertXY" class="help-page-title"><h2>Convert between Graphics Coordinate Systems</h2></a>

<h3>Description</h3>

<p>Convert between graphics coordinate systems.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">grconvertX<span class="token punctuation">(</span>x<span class="token punctuation">,</span> from <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">,</span> to <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">)</span>
grconvertY<span class="token punctuation">(</span>y<span class="token punctuation">,</span> from <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">,</span> to <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>numeric vector of coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from, to</code></td>
<td>
<p>character strings giving the coordinate systems to
convert between.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The coordinate systems are
</p>

<dl>
<dt><code>"user"</code></dt>
<dd>
<p>user coordinates.</p>
</dd>
<dt><code>"inches"</code></dt>
<dd>
<p>inches.</p>
</dd>
<dt><code>"device"</code></dt>
<dd>
<p>the device coordinate system.</p>
</dd>
<dt><code>"ndc"</code></dt>
<dd>
<p>normalized device coordinates.</p>
</dd>
<dt><code>"nfc"</code></dt>
<dd>
<p>normalized figure coordinates.</p>
</dd>
<dt><code>"npc"</code></dt>
<dd>
<p>normalized plot coordinates.</p>
</dd>
<dt><code>"nic"</code></dt>
<dd>
<p>normalized inner region coordinates.  (The
‘inner region’ is that inside the outer margins.)</p>
</dd>
<dt><code>"lines"</code></dt>
<dd>
<p>lines of margin (based on <code>mex</code>).</p>
</dd>
<dt><code>"chars"</code></dt>
<dd>
<p>lines of text (based on <code>cex</code>).</p>
</dd>
</dl>
<p>(These names can be partially matched.)  For the ‘normalized’
coordinate systems the lower left has value 0 and the top right
value 1.
</p>
<p>Device coordinates are those in which the device works: they are
usually in pixels where that makes sense and in big points (1/72 inch)
otherwise (e.g., <code><a href="https://r-universe.dev/manuals/grDevices.html#pdf">pdf</a></code> and <code><a href="https://r-universe.dev/manuals/grDevices.html#postscript">postscript</a></code>).
</p>


<h3>Value</h3>

<p>A numeric vector of the same length as the input.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>omd<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>tp <span class="token keyword">in</span> c<span class="token punctuation">(</span><span class="token string">"in"</span><span class="token punctuation">,</span> <span class="token string">"dev"</span><span class="token punctuation">,</span> <span class="token string">"ndc"</span><span class="token punctuation">,</span> <span class="token string">"nfc"</span><span class="token punctuation">,</span> <span class="token string">"npc"</span><span class="token punctuation">,</span> <span class="token string">"nic"</span><span class="token punctuation">,</span> <span class="token string">"lines"</span><span class="token punctuation">,</span> <span class="token string">"chars"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    print<span class="token punctuation">(</span>grconvertX<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"user"</span><span class="token punctuation">,</span> tp<span class="token punctuation">)</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="coplot">

<a href="#coplot" class="help-page-title"><h2>Conditioning Plots</h2></a>

<h3>Description</h3>

<p>This function produces two variants of the <b>co</b>nditioning plots
discussed in the reference below.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">coplot<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data<span class="token punctuation">,</span> given.values<span class="token punctuation">,</span> panel <span class="token operator">=</span> points<span class="token punctuation">,</span> rows<span class="token punctuation">,</span> columns<span class="token punctuation">,</span>
       show.given <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"pch"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       bar.bg <span class="token operator">=</span> c<span class="token punctuation">(</span>num <span class="token operator">=</span> gray<span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fac <span class="token operator">=</span> gray<span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       xlab <span class="token operator">=</span> c<span class="token punctuation">(</span>x.name<span class="token punctuation">,</span> paste<span class="token punctuation">(</span><span class="token string">"Given :"</span><span class="token punctuation">,</span> a.name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       ylab <span class="token operator">=</span> c<span class="token punctuation">(</span>y.name<span class="token punctuation">,</span> paste<span class="token punctuation">(</span><span class="token string">"Given :"</span><span class="token punctuation">,</span> b.name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       subscripts <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
       axlabels <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> abbreviate<span class="token punctuation">(</span>levels<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       number <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> overlap <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> xlim<span class="token punctuation">,</span> ylim<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
co.intervals<span class="token punctuation">(</span>x<span class="token punctuation">,</span> number <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> overlap <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula describing the form of conditioning plot.  A
formula of the form <code>y ~ x | a</code> indicates that plots of
<code>y</code> versus <code>x</code> should be produced conditional on the
variable <code>a</code>.  A formula of the form <code>y ~ x| a * b</code>
indicates that plots of <code>y</code> versus <code>x</code> should be produced
conditional on the two variables <code>a</code> and <code>b</code>.
</p>
<p>All three or four variables may be either numeric or factors.
When <code>x</code> or <code>y</code> are factors, the result is almost as if
<code>as.numeric()</code> was applied, whereas for factor
<code>a</code> or <code>b</code>, the conditioning (and its graphics if
<code>show.given</code> is true) are adapted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing values for any variables in the
formula.  By default the environment where <code>coplot</code> was called
from is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>given.values</code></td>
<td>
<p>a value or list of two values which determine how
the conditioning on <code>a</code> and <code>b</code> is to take place.
</p>
<p>When there is no <code>b</code> (i.e., conditioning only on <code>a</code>),
usually this is a matrix with two columns each row of which gives an
interval, to be conditioned on, but is can also be a single vector
of numbers or a set of factor levels (if the variable being
conditioned on is a factor). In this case (no <code>b</code>),
the result of <code>co.intervals</code> can be used directly as
<code>given.values</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#function">function</a>(x, y, col, pch, ...)</code>
which gives the action to be carried out in
each panel of the display.  The default is <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows</code></td>
<td>
<p>the panels of the plot are laid out in a <code>rows</code> by
<code>columns</code> array.  <code>rows</code> gives the number of rows in the
array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>the number of columns in the panel layout array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.given</code></td>
<td>
<p>logical (possibly of length 2 for 2 conditioning
variables): should conditioning plots be shown for the
corresponding conditioning variables (default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector of colors to be used to plot the points.  If too
short, the values are recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>a vector of plotting symbols or characters.  If too short,
the values are recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar.bg</code></td>
<td>
<p>a named vector with components <code>"num"</code> and
<code>"fac"</code> giving the background colors for the (shingle) bars,
for <b>num</b>eric and <b>fac</b>tor conditioning variables respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>character; labels to use for the x axis and the
first conditioning variable.  If only one label is given, it is used
for the x axis and the default label is used for the conditioning
variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>character; labels to use for the y axis and any
second conditioning variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subscripts</code></td>
<td>
<p>logical: if true the panel function is given an
additional (third) argument <code>subscripts</code> giving the subscripts
of the data passed to that panel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axlabels</code></td>
<td>
<p>function for creating axis (tick) labels when x or y
are factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number</code></td>
<td>
<p>integer; the number of conditioning intervals,
for a and b, possibly of length 2.  It is only used if the
corresponding conditioning variable is not a <code><a href="https://r-universe.dev/manuals/base.html#factor">factor</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>numeric &lt; 1; the fraction of overlap of the
conditioning variables, possibly of length 2 for x and y
direction.  When overlap &lt; 0, there will be <em>gaps</em> between
the data slices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>the range for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the range for the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to the panel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the case of a single conditioning variable <code>a</code>, when both
<code>rows</code> and <code>columns</code> are unspecified, a ‘close to
square’ layout is chosen with <code>columns &gt;= rows</code>.
</p>
<p>In the case of multiple <code>rows</code>, the <em>order</em> of the panel
plots is from the bottom and from the left (corresponding to
increasing <code>a</code>, typically).
</p>
<p>A panel function should not attempt to start a new plot, but just plot
within a given coordinate system: thus <code>plot</code> and <code>boxplot</code>
are not panel functions.
</p>
<p>The rendering of arguments <code>xlab</code> and
<code>ylab</code> is not controlled by <code><a href="#par">par</a></code> arguments
<code>cex.lab</code> and <code>font.lab</code> even though they are plotted by
<code><a href="#mtext">mtext</a></code> rather than <code><a href="#title">title</a></code>.
</p>


<h3>Value</h3>

<p><code>co.intervals(., number, .)</code> returns a (<code>number</code> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">×</span></span></span></span></code>
2) <code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>, say <code>ci</code>,  where <code>ci[k,]</code> is
the <code><a href="https://r-universe.dev/manuals/base.html#range">range</a></code> of <code>x</code> values for the <code>k</code>-th interval.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1992)
<em>Data for models.</em>
Chapter 3 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>
<p>Cleveland, W. S. (1993) <em>Visualizing Data.</em> New Jersey: Summit Press.
</p>


<h3>See Also</h3>

<p><code><a href="#pairs">pairs</a></code>,
<code><a href="#panel.smooth">panel.smooth</a></code>,
<code><a href="#points">points</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Tonga Trench Earthquakes</span>
coplot<span class="token punctuation">(</span>lat <span class="token operator">~</span> long <span class="token operator">|</span> depth<span class="token punctuation">,</span> data <span class="token operator">=</span> quakes<span class="token punctuation">)</span>
given.depth <span class="token operator">&lt;-</span> co.intervals<span class="token punctuation">(</span>quakes<span class="token operator">$</span>depth<span class="token punctuation">,</span> number <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> overlap <span class="token operator">=</span> <span class="token number">.1</span><span class="token punctuation">)</span>
coplot<span class="token punctuation">(</span>lat <span class="token operator">~</span> long <span class="token operator">|</span> depth<span class="token punctuation">,</span> data <span class="token operator">=</span> quakes<span class="token punctuation">,</span> given.values <span class="token operator">=</span> given.depth<span class="token punctuation">,</span> rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">## Conditioning on 2 variables:</span>
ll.dm <span class="token operator">&lt;-</span> lat <span class="token operator">~</span> long <span class="token operator">|</span> depth <span class="token operator">*</span> mag
coplot<span class="token punctuation">(</span>ll.dm<span class="token punctuation">,</span> data <span class="token operator">=</span> quakes<span class="token punctuation">)</span>
coplot<span class="token punctuation">(</span>ll.dm<span class="token punctuation">,</span> data <span class="token operator">=</span> quakes<span class="token punctuation">,</span> number <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> show.given <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
coplot<span class="token punctuation">(</span>ll.dm<span class="token punctuation">,</span> data <span class="token operator">=</span> quakes<span class="token punctuation">,</span> number <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       overlap <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">.5</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># negative overlap DROPS values</span>

<span class="token comment">## given two factors</span>
Index <span class="token operator">&lt;-</span> seq_len<span class="token punctuation">(</span>nrow<span class="token punctuation">(</span>warpbreaks<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># to get nicer default labels</span>
coplot<span class="token punctuation">(</span>breaks <span class="token operator">~</span> Index <span class="token operator">|</span> wool <span class="token operator">*</span> tension<span class="token punctuation">,</span> data <span class="token operator">=</span> warpbreaks<span class="token punctuation">,</span>
       show.given <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>
coplot<span class="token punctuation">(</span>breaks <span class="token operator">~</span> Index <span class="token operator">|</span> wool <span class="token operator">*</span> tension<span class="token punctuation">,</span> data <span class="token operator">=</span> warpbreaks<span class="token punctuation">,</span>
       col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">,</span>
       bar.bg <span class="token operator">=</span> c<span class="token punctuation">(</span>fac <span class="token operator">=</span> <span class="token string">"light blue"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Example with empty panels:</span>
with<span class="token punctuation">(</span>data.frame<span class="token punctuation">(</span>state.x77<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
coplot<span class="token punctuation">(</span>Life.Exp <span class="token operator">~</span> Income <span class="token operator">|</span> Illiteracy <span class="token operator">*</span> state.region<span class="token punctuation">,</span> number <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
       panel <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> panel.smooth<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> span <span class="token operator">=</span> <span class="token number">.8</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## y ~ factor -- not really sensible, but 'show off':</span>
coplot<span class="token punctuation">(</span>Life.Exp <span class="token operator">~</span> state.region <span class="token operator">|</span> Income <span class="token operator">*</span> state.division<span class="token punctuation">,</span>
       panel <span class="token operator">=</span> panel.smooth<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="curve">

<a href="#curve" class="help-page-title"><h2>Draw Function Plots</h2></a>

<h3>Description</h3>

<p>Draws a curve corresponding to a function over the interval
<code>[from, to]</code>. <code>curve</code> can plot also an expression in the variable
<code>xname</code>, default ‘<span class="samp">⁠x⁠</span>’.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">curve<span class="token punctuation">(</span>expr<span class="token punctuation">,</span> from <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> to <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> xname <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> xname<span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
      log <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'function'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> to <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> from <span class="token operator">=</span> y<span class="token punctuation">,</span> xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>
<p>The name of a function, or a <a href="https://r-universe.dev/manuals/base.html#call">call</a> or an
<a href="https://r-universe.dev/manuals/base.html#expression">expression</a> written as a function of <code>x</code> which will
evaluate to an object of the same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a ‘vectorizing’ numeric <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>alias for <code>from</code> for compatibility with <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from, to</code></td>
<td>
<p>the range over which the function will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer; the number of x values at which to evaluate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical; if <code>TRUE</code> add to an already existing plot; if
<code>NA</code> start a new plot taking the defaults for the limits and
log-scaling of the x-axis from the previous plot.  Taken as
<code>FALSE</code> (with a warning if a different value is supplied) if no
graphics device is open.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p><code>NULL</code> or a numeric vector of length 2;
if non-<code>NULL</code> it provides the defaults for <code>c(from, to)</code>
and, unless <code>add = TRUE</code>, selects the x-limits of the plot – see
<code><a href="#plot.window">plot.window</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>plot type: see <code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xname</code></td>
<td>
<p>character string giving the name to be used for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, log, ...</code></td>
<td>
<p>labels and <a href="#par">graphical parameters</a>
can also be specified as arguments.  See ‘Details’ for the
interpretation of the default for <code>log</code>.
</p>
<p>For the <code>"function"</code> method of <code>plot</code>, <code>...</code> can
include any of the other arguments of <code>curve</code>, except
<code>expr</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function or expression <code>expr</code> (for <code>curve</code>) or function
<code>x</code> (for <code>plot</code>) is evaluated at <code>n</code> points equally
spaced over the range <code>[from, to]</code>.  The points determined in
this way are then plotted.
</p>
<p>If either <code>from</code> or <code>to</code> is <code>NULL</code>, it defaults to the
corresponding element of <code>xlim</code> if that is not <code>NULL</code>.
</p>
<p>What happens when neither <code>from</code>/<code>to</code> nor <code>xlim</code>
specifies both x-limits is a complex story.  For
<code>plot(&lt;function&gt;)</code> and for <code>curve(add = FALSE)</code> the defaults
are <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></code>.  For <code>curve(add = NA)</code> and <code>curve(add =
  TRUE)</code> the defaults are taken from the x-limits used for the previous
plot.  (This differs from versions of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> prior to 2.14.0.)
</p>
<p>The value of <code>log</code> is used both to specify the plot axes (unless
<code>add = TRUE</code>) and how ‘equally spaced’ is interpreted: if
the x component indicates log-scaling, the points at which the
expression or function is plotted are equally spaced on log scale.
</p>
<p>The default value of <code>log</code> is taken from the current plot when
<code>add = TRUE</code>, whereas if <code>add = NA</code> the x component is taken
from the existing plot (if any) and the y component defaults to
linear.  For <code>add = FALSE</code> the default is <code>""</code>
</p>
<p>This used to be a quick hack which now seems to serve a useful purpose,
but can give bad results for functions which are not smooth.
</p>
<p>For expensive-to-compute <code>expr</code>essions, you should use smarter tools.
</p>
<p>The way <code>curve</code> handles <code>expr</code> has caused confusion.  It
first looks to see if <code>expr</code> is a <a href="https://r-universe.dev/manuals/base.html#name">name</a> (also known as a
symbol), in which case it is taken to be the name of a function, and
<code>expr</code> is replaced by a call to <code>expr</code> with a single
argument with name given by <code>xname</code>.  Otherwise it checks that
<code>expr</code> is either a <a href="https://r-universe.dev/manuals/base.html#call">call</a> or an <a href="https://r-universe.dev/manuals/base.html#expression">expression</a>, and that
it contains a reference to the variable given by <code>xname</code> (using
<code><a href="https://r-universe.dev/manuals/base.html#allnames">all.vars</a></code>): anything else is an error.  Then <code>expr</code>
is evaluated in an environment which supplies a vector of name given
by <code>xname</code> of length <code>n</code>, and should evaluate to an object
of length <code>n</code>.  Note that this means that <code>curve(x, ...)</code> is
taken as a request to plot a function named <code>x</code> (and it is used
as such in the <code>function</code> method for <code>plot</code>).
</p>
<p>The <code>plot</code> method can be called directly as <code>plot.function</code>.
</p>


<h3>Value</h3>

<p>A list with components <code>x</code> and <code>y</code> of the points that were
drawn is returned invisibly.
</p>


<h3>Warning</h3>

<p>For historical reasons, <code>add</code> is allowed as an argument to the
<code>"function"</code> method of <code>plot</code>, but its behaviour may surprise
you.  It is recommended to use <code>add</code> only with <code>curve</code>.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#splinefun">splinefun</a></code> for spline interpolation, <code><a href="#lines">lines</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span>qnorm<span class="token punctuation">)</span> <span class="token comment"># default range c(0, 1) is appropriate here,</span>
            <span class="token comment"># but end values are -/+Inf and so are omitted.</span>
plot<span class="token punctuation">(</span>qlogis<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"The Inverse Logit : qlogis()"</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>h <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray"</span><span class="token punctuation">)</span>

curve<span class="token punctuation">(</span>sin<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> xname <span class="token operator">=</span> <span class="token string">"t"</span><span class="token punctuation">)</span>
curve<span class="token punctuation">(</span>tan<span class="token punctuation">,</span> xname <span class="token operator">=</span> <span class="token string">"t"</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
      main <span class="token operator">=</span> <span class="token string">"curve(tan)  --&gt; same x-scale as previous plot"</span><span class="token punctuation">)</span>

op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
curve<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
curve<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"violet"</span><span class="token punctuation">)</span>

<span class="token comment">## simple and advanced versions, quite similar:</span>
plot<span class="token punctuation">(</span>cos<span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token punctuation">,</span>  <span class="token number">3</span><span class="token operator">*</span>pi<span class="token punctuation">)</span>
curve<span class="token punctuation">(</span>cos<span class="token punctuation">,</span> xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span>pi<span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">*</span>pi<span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">1001</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

chippy <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> sin<span class="token punctuation">(</span>cos<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">*</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
curve<span class="token punctuation">(</span>chippy<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">2001</span><span class="token punctuation">)</span>
plot <span class="token punctuation">(</span>chippy<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token keyword">for</span><span class="token punctuation">(</span>ll <span class="token keyword">in</span> c<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">,</span> <span class="token string">"xy"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   curve<span class="token punctuation">(</span>log<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> log <span class="token operator">=</span> ll<span class="token punctuation">,</span> sub <span class="token operator">=</span> paste0<span class="token punctuation">(</span><span class="token string">"log = '"</span><span class="token punctuation">,</span> ll<span class="token punctuation">,</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="dotchart">

<a href="#dotchart" class="help-page-title"><h2>Cleveland's Dot Plots</h2></a>

<h3>Description</h3>

<p>Draw a Cleveland dot plot.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">dotchart<span class="token punctuation">(</span>x<span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> gdata <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> offset <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">,</span>
         ann <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"ann"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xaxt <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"xaxt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
         cex <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"cex"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pt.cex <span class="token operator">=</span> cex<span class="token punctuation">,</span>
         pch <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">,</span> gpch <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"bg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         color <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gcolor <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lcolor <span class="token operator">=</span> <span class="token string">"gray"</span><span class="token punctuation">,</span>
         xlim <span class="token operator">=</span> range<span class="token punctuation">(</span>x<span class="token punctuation">[</span>is.finite<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a vector or matrix of numeric values (<code>NA</code>s are
allowed).  If <code>x</code> is a matrix the overall plot consists of
juxtaposed dotplots for each row.  Inputs which satisfy
<code><a href="https://r-universe.dev/manuals/base.html#numeric">is.numeric</a>(x)</code> but not
<code>is.vector(x) || is.matrix(x)</code> are coerced by
<code><a href="https://r-universe.dev/manuals/base.html#numeric">as.numeric</a></code>, with a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>a vector of labels for each point.
For vectors the default is to use <code>names(x)</code> and for matrices
the row labels <code>dimnames(x)[[1]]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>an optional factor indicating how the elements of
<code>x</code> are grouped.
If <code>x</code> is a matrix, <code>groups</code> will default to the columns
of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gdata</code></td>
<td>
<p>data values for the groups.
This is typically a summary such as the median or mean
of each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>offset in inches of <code>ylab</code> and <code>labels</code>; was
hardwired to 0.4 before <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> 4.0.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ann</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> value indicating whether the default annotation
(title and x and y axis labels) should appear on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxt</code></td>
<td>
<p>a string indicating the x-axis style; use <code>"n"</code> to
suppress and see also <code><a href="#par">par</a>("xaxt")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame.plot</code></td>
<td>
<p>a logical indicating whether a box should be drawn
around the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>a character string indicating if one or the other axis should
be logarithmic, see <code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>the character size to be used.  Setting <code>cex</code>
to a value smaller than one can be a useful way of avoiding label
overlap.  Unlike many other graphics functions, this sets the actual
size, not a multiple of <code>par("cex")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.cex</code></td>
<td>
<p>the <code>cex</code> to be applied to plotting symbols.
This behaves like <code>cex</code> in <code>plot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>the plotting character or symbol to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpch</code></td>
<td>
<p>the plotting character or symbol to be used for group
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>the background color of plotting characters or symbols to be
used; use <code><a href="#par">par</a>(bg= *)</code> to set the background color of
the whole plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>the color(s) to be used for points and labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcolor</code></td>
<td>
<p>the single color to be used for group labels and
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcolor</code></td>
<td>
<p>the color(s) to be used for the horizontal lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>horizontal range for the plot, see
<code><a href="#plot.window">plot.window</a></code>, for example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>overall title for the plot, see <code><a href="#title">title</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>axis annotations as in <code>title</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a> can also be specified as arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function is invoked for its side effect, which is to produce two
variants of dotplots as described in Cleveland (1985).
</p>
<p>Dot plots are a reasonable substitute for bar plots.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Cleveland, W. S. (1985)
<em>The Elements of Graphing Data.</em>
Monterey, CA: Wadsworth.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">dotchart<span class="token punctuation">(</span>VADeaths<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Death Rates in Virginia - 1940"</span><span class="token punctuation">)</span>

op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>xaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">)</span>  <span class="token comment"># 0 -- 100%</span>
dotchart<span class="token punctuation">(</span>t<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"skyblue"</span><span class="token punctuation">,</span>
         main <span class="token operator">=</span> <span class="token string">"Death Rates in Virginia - 1940"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"rate [ % ]"</span><span class="token punctuation">,</span>
         ylab <span class="token operator">=</span> <span class="token string">"Grouping:  Age  x   Urbanity . Gender"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="filled.contour">

<a href="#filled.contour" class="help-page-title"><h2>Level (Contour) Plots</h2></a>

<h3>Description</h3>

<p>This function produces a contour plot with the areas between the
contours filled in solid color (Cleveland calls this a level plot).  A
key showing how the colors map to z values is shown to the right of
the plot.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">filled.contour<span class="token punctuation">(</span>x <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> nrow<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               y <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> ncol<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               z<span class="token punctuation">,</span>
               xlim <span class="token operator">=</span> range<span class="token punctuation">(</span>x<span class="token punctuation">,</span> finite <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               ylim <span class="token operator">=</span> range<span class="token punctuation">(</span>y<span class="token punctuation">,</span> finite <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               zlim <span class="token operator">=</span> range<span class="token punctuation">(</span>z<span class="token punctuation">,</span> finite <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               levels <span class="token operator">=</span> pretty<span class="token punctuation">(</span>zlim<span class="token punctuation">,</span> nlevels<span class="token punctuation">)</span><span class="token punctuation">,</span> nlevels <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span>
               color.palette <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> hcl.colors<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token string">"YlOrRd"</span><span class="token punctuation">,</span> rev <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               col <span class="token operator">=</span> color.palette<span class="token punctuation">(</span>length<span class="token punctuation">(</span>levels<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               plot.title<span class="token punctuation">,</span> plot.axes<span class="token punctuation">,</span> key.title<span class="token punctuation">,</span> key.axes<span class="token punctuation">,</span>
               asp <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> xaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">,</span> yaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">,</span> las <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
               axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> axes<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

.filled.contour<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> levels<span class="token punctuation">,</span> col<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are
measured.  These must be in ascending order.  (The rest of this
description does not apply to <code>.filled.contour</code>.)
By default, equally spaced values from 0 to 1 are used.  If <code>x</code>
is a <code>list</code>, its components <code>x$x</code> and <code>x$y</code> are used
for <code>x</code> and <code>y</code>, respectively.  If the list has component
<code>z</code> this is used for <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a numeric matrix containing the values to be plotted..  Note that
<code>x</code> can be used instead of <code>z</code> for convenience.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>x limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>z limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>a set of levels which are used to partition the range
of <code>z</code>.  Must be <b>strictly</b> increasing (and finite).  Areas
with <code>z</code> values between consecutive levels are painted with the
same color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>if <code>levels</code> is not specified, the range of <code>z</code>,
values is divided into approximately this many levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.palette</code></td>
<td>
<p>a color palette function to be used to assign
colors in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>an explicit set of colors to be used in the plot.
This argument overrides any palette function specification.  There
should be one less color than levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title</code></td>
<td>
<p>statements which add titles to the main plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.axes</code></td>
<td>
<p>statements which draw axes (and a <code><a href="#box">box</a></code>)
on the main plot.  This overrides the default axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.title</code></td>
<td>
<p>statements which add titles for the plot key.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.axes</code></td>
<td>
<p>statements which draw axes on the plot key.
This overrides the default axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asp</code></td>
<td>
<p>the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi mathvariant="normal">/</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">y/x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">/</span><span class="mord mathnormal">x</span></span></span></span></code> aspect ratio, see <code><a href="#plot.window">plot.window</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxs</code></td>
<td>
<p>the x axis style.  The default is to use internal
labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxs</code></td>
<td>
<p>the y axis style.  The default is to use internal
labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las</code></td>
<td>
<p>the style of labeling to be used.  The default is to
use horizontal labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes, frame.plot</code></td>
<td>
<p>logicals indicating if axes and a box should be
drawn, as in <code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional <a href="#par">graphical parameters</a>, currently only passed to
<code><a href="#title">title</a>()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The values to be plotted can contain <code>NA</code>s.  Rectangles with two
or more corner values are <code>NA</code> are omitted entirely: where there
is a single <code>NA</code> value the triangle opposite the <code>NA</code> is
omitted.
</p>
<p>Values to be plotted can be infinite: the effect is similar to that
described for <code>NA</code> values.
</p>
<p><code>.filled.contour</code> is a ‘bare bones’ interface to add
just the contour plot to an already-set-up plot region.  It is is
intended for programmatic use, and the programmer is
responsible for checking the conditions on the arguments.
</p>


<h3>Note</h3>

<p><code>filled.contour</code> uses the <code><a href="#layout">layout</a></code> function and so is
restricted to a full page display.
</p>
<p>The output produced by <code>filled.contour</code> is actually a combination
of two plots; one is the filled contour and one is the legend.  Two
separate coordinate systems are set up for these two plots, but they
are only used internally – once the function has returned these
coordinate systems are lost.  If you want to annotate the main contour
plot, for example to add points, you can specify graphics commands in
the <code>plot.axes</code> argument.  See the examples.
</p>


<h3>Author(s)</h3>

<p>Ross Ihaka and R Core Team</p>


<h3>References</h3>

<p>Cleveland, W. S. (1993)
<em>Visualizing Data</em>.
Summit, New Jersey: Hobart.
</p>


<h3>See Also</h3>

<p><code><a href="#contour">contour</a></code>, <code><a href="#image">image</a></code>,
<code><a href="https://r-universe.dev/manuals/grDevices.html#palettes">hcl.colors</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#gray.colors">gray.colors</a></code>,
<code><a href="https://r-universe.dev/manuals/grDevices.html#palette">palette</a></code>; <code><a href="https://deepayan.r-universe.dev/manual/lattice.html#levelplot">contourplot</a></code>
and <code><a href="https://deepayan.r-universe.dev/manual/lattice.html#levelplot">levelplot</a></code> from package <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span><span class="token string">"grDevices"</span><span class="token punctuation">)</span> <span class="token comment"># for colours</span>
filled.contour<span class="token punctuation">(</span>volcano<span class="token punctuation">,</span> asp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># simple</span>

x <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">1</span><span class="token operator">:</span>nrow<span class="token punctuation">(</span>volcano<span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">1</span><span class="token operator">:</span>ncol<span class="token punctuation">(</span>volcano<span class="token punctuation">)</span>
filled.contour<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> volcano<span class="token punctuation">,</span>
    color.palette <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> hcl.colors<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token string">"terrain"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    plot.title <span class="token operator">=</span> title<span class="token punctuation">(</span>main <span class="token operator">=</span> <span class="token string">"The Topography of Maunga Whau"</span><span class="token punctuation">,</span>
    xlab <span class="token operator">=</span> <span class="token string">"Meters North"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Meters West"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    plot.axes <span class="token operator">=</span> <span class="token punctuation">{</span> axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> seq<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                  axis<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> seq<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    key.title <span class="token operator">=</span> title<span class="token punctuation">(</span>main <span class="token operator">=</span> <span class="token string">"Height\n(meters)"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    key.axes <span class="token operator">=</span> axis<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> seq<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># maybe also asp = 1</span>
mtext<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"filled.contour(.) from"</span><span class="token punctuation">,</span> R.version.string<span class="token punctuation">)</span><span class="token punctuation">,</span>
      side <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">.66</span><span class="token punctuation">)</span>

<span class="token comment"># Annotating a filled contour plot</span>
a <span class="token operator">&lt;-</span> expand.grid<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">)</span>
b <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
filled.contour<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span> z <span class="token operator">=</span> b<span class="token punctuation">,</span>
               plot.axes <span class="token operator">=</span> <span class="token punctuation">{</span> axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> axis<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> points<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## Persian Rug Art:</span>
x <span class="token operator">&lt;-</span> y <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>outer<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> y<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> `<span class="token operator">+</span>`<span class="token punctuation">)</span><span class="token punctuation">)</span>
filled.contour<span class="token punctuation">(</span>cos<span class="token punctuation">(</span>r<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>r<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
<span class="token comment">## rather, the key *should* be labeled:</span>
filled.contour<span class="token punctuation">(</span>cos<span class="token punctuation">(</span>r<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>r<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
               plot.axes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="fourfoldplot">

<a href="#fourfoldplot" class="help-page-title"><h2>Fourfold Plots</h2></a>

<h3>Description</h3>

<p>Creates a fourfold display of a 2 by 2 by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> contingency table on
the current graphics device, allowing for the visual inspection of the
association between two dichotomous variables in one or several
populations (strata).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">fourfoldplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> color <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"#99CCFF"</span><span class="token punctuation">,</span> <span class="token string">"#6699CC"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             conf.level <span class="token operator">=</span> <span class="token number">0.95</span><span class="token punctuation">,</span>
             std <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"margins"</span><span class="token punctuation">,</span> <span class="token string">"ind.max"</span><span class="token punctuation">,</span> <span class="token string">"all.max"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             margin <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> space <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
             mfrow <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> mfcol <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a 2 by 2 by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> contingency table in array form, or as a
2 by 2 matrix if <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>a vector of length 2 specifying the colors to use for the
smaller and larger diagonals of each 2 by 2 table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level used for the confidence rings on
the odds ratios.  Must be a single nonnegative number less than 1;
if set to 0, confidence rings are suppressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std</code></td>
<td>
<p>a character string specifying how to standardize the table.
Must match one of <code>"margins"</code>, <code>"ind.max"</code>, or
<code>"all.max"</code>, and can be abbreviated to the initial letter.
If set to <code>"margins"</code>, each 2 by 2 table is standardized to
equate the margins specified by <code>margin</code> while preserving the
odds ratio.  If <code>"ind.max"</code> or <code>"all.max"</code>, the tables are
either individually or simultaneously standardized to a maximal cell
frequency of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>a numeric vector with the margins to equate.  Must be
one of <code>1</code>, <code>2</code>, or <code>c(1, 2)</code> (the default), which
corresponds to standardizing the row, column, or both margins in
each 2 by 2 table.
Only used if <code>std</code> equals <code>"margins"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>space</code></td>
<td>
<p>the amount of space (as a fraction of the maximal radius
of the quarter circles) used for the row and column labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>character string for the fourfold title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfrow</code></td>
<td>
<p>a numeric vector of the form <code>c(nr, nc)</code>, indicating
that the displays for the 2 by 2 tables should be arranged in an
<code>nr</code> by <code>nc</code> layout, filled by rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfcol</code></td>
<td>
<p>a numeric vector of the form <code>c(nr, nc)</code>, indicating
that the displays for the 2 by 2 tables should be arranged in an
<code>nr</code> by <code>nc</code> layout, filled by columns.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The fourfold display is designed for the display of 2 by 2 by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code>
tables.
</p>
<p>Following suitable standardization, the cell frequencies
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></code> of each 2 by 2 table are shown as a quarter
circle whose radius is proportional to
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><msub><mi>f</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{f_{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.3508em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8892em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8492em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3508em;"><span></span></span></span></span></span></span></span></span></code> so that its area is proportional to
the cell frequency.  An association (odds ratio different from 1)
between the binary row and column variables is indicated by the
tendency of diagonally opposite cells in one direction to differ in
size from those in the other direction; color is used to show this
direction.  Confidence rings for the odds ratio allow a visual test of
the null of no association; the rings for adjacent quadrants overlap
if and only if the observed counts are consistent with the null hypothesis.
</p>
<p>Typically, the number <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> corresponds to the number of levels of a
stratifying variable, and it is of interest to see whether the
association is homogeneous across strata.  The fourfold display
visualizes the pattern of association.  Note that the confidence rings
for the individual odds ratios are not adjusted for multiple testing.
</p>


<h3>References</h3>

<p>Friendly, M. (1994).
A fourfold display for 2 by 2 by <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></code> tables.
Technical Report 217, York University, Psychology Department.
<a href="http://datavis.ca/papers/4fold/4fold.pdf" target="_blank">http://datavis.ca/papers/4fold/4fold.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#mosaicplot">mosaicplot</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Use the Berkeley admission data as in Friendly (1995).</span>
x <span class="token operator">&lt;-</span> aperm<span class="token punctuation">(</span>UCBAdmissions<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dimnames<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"Yes"</span><span class="token punctuation">,</span> <span class="token string">"No"</span><span class="token punctuation">)</span>
names<span class="token punctuation">(</span>dimnames<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"Sex"</span><span class="token punctuation">,</span> <span class="token string">"Admit?"</span><span class="token punctuation">,</span> <span class="token string">"Department"</span><span class="token punctuation">)</span>
stats<span class="token operator">::</span>ftable<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment">## Fourfold display of data aggregated over departments, with</span>
<span class="token comment">## frequencies standardized to equate the margins for admission</span>
<span class="token comment">## and sex.</span>
<span class="token comment">## Figure 1 in Friendly (1994).</span>
fourfoldplot<span class="token punctuation">(</span>marginSums<span class="token punctuation">(</span>x<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Fourfold display of x, with frequencies in each table</span>
<span class="token comment">## standardized to equate the margins for admission and sex.</span>
<span class="token comment">## Figure 2 in Friendly (1994).</span>
fourfoldplot<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment">## Fourfold display of x, with frequencies in each table</span>
<span class="token comment">## standardized to equate the margins for admission. but not</span>
<span class="token comment">## for sex.</span>
<span class="token comment">## Figure 3 in Friendly (1994).</span>
fourfoldplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> margin <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="frame">

<a href="#frame" class="help-page-title"><h2>Create / Start a New Plot Frame</h2></a>

<h3>Description</h3>

<p>This function (<code>frame</code> is an alias for
<code>plot.new</code>) causes the completion of plotting in the current plot
(if there is one) and an advance to a new graphics frame.  This is
used in all high-level plotting functions and also useful for skipping
plots when a multi-figure region is in use.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">plot.new<span class="token punctuation">(</span><span class="token punctuation">)</span>
frame<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>


<h3>Details</h3>

<p>The new page is painted with the background colour
(<code><a href="#par">par</a>("bg")</code>), which is often transparent.  For devices
with a <em>canvas</em> colour (the on-screen devices <code>X11</code>,
<code>windows</code> and <code>quartz</code>), the window is first painted with the
canvas colour and then the background colour.
</p>
<p>There are two hooks called <code>"before.plot.new"</code> and
<code>"plot.new"</code> (see <code><a href="https://r-universe.dev/manuals/base.html#userhooks">setHook</a></code>) called immediately
before and after advancing the frame. The latter is used
in the testing code to annotate the new page. The hook function(s) are
called with no argument.  (If the value is a character string,
<code>get</code> is called on it from within the <span class="pkg">graphics</span> namespace.)
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole. (<code>frame</code>.)
</p>


<h3>See Also</h3>

<p><code><a href="#plot.window">plot.window</a></code>, <code><a href="#plot.default">plot.default</a></code>.
</p>

<hr>
</div>
<div class="container manual-page" id="graphics-defunct">

<a href="#graphics-defunct" class="help-page-title"><h2>Defunct Functions in Package <span class="pkg">graphics</span>
</h2></a>

<h3>Description</h3>

<p>The functions or variables listed here are no longer part of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> as
they are not needed (any more).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Defunct in 1.3.0</span>
dotplot<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span>
stripplot<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment"># Defunct in 1.6.0</span>
piechart<span class="token punctuation">(</span>x<span class="token punctuation">,</span> labels <span class="token operator">=</span> names<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> edges <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span> radius <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
         density <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Details</h3>

<p><code>dotplot</code> and <code>stripplot</code> have been renamed to
<code><a href="#dotchart">dotchart</a></code> and <code><a href="#stripchart">stripchart</a></code>,
respectively.  The names are now used in <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>.
</p>
<p><code>piechart</code> was the old name for <code>pie</code>, but clashed with usage
in Trellis (not implemented in <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>).
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#Defunct">Defunct</a></code>
</p>

<hr>
</div>
<div class="container manual-page" id="graphics-package">

<a href="#graphics-package" class="help-page-title"><h2>
The R Graphics Package
</h2></a>

<h3>Description</h3>

<p>R functions for base graphics
</p>


<h3>Details</h3>

<p>This package contains functions for ‘base’ graphics.  Base graphics
are traditional S-like graphics, as opposed to the more recent
<a href="https://r-universe.dev/manuals/grid.html#grid-package">grid</a> graphics.
</p>
<p>For a complete list of functions with individual help pages,
use <code>library(help = "graphics")</code>.
</p>


<h3>Author(s)</h3>

<p>R Core Team and contributors worldwide
</p>
<p>Maintainer: R Core Team <a href="mailto:R-core@r-project.org">R-core@r-project.org</a>
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>

<hr>
</div>
<div class="container manual-page" id="grid">

<a href="#grid" class="help-page-title"><h2>Add Grid to a Plot</h2></a>

<h3>Description</h3>

<p><code>grid</code> adds an <code>nx</code> by <code>ny</code> rectangular grid to an
existing plot.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">grid<span class="token punctuation">(</span>nx <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ny <span class="token operator">=</span> nx<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightgray"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token string">"dotted"</span><span class="token punctuation">,</span>
     lwd <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lwd"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> equilogs <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nx, ny</code></td>
<td>
<p>number of cells of the grid in x and y direction.  When
<code>NULL</code>, as per default, the grid aligns with the tick marks on
the corresponding <em>default</em> axis (i.e., tickmarks as computed by
<code><a href="#axTicks">axTicks</a></code>).  When <code><a href="https://r-universe.dev/manuals/base.html#NA">NA</a></code>, no grid lines are
drawn in the corresponding direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>character or (integer) numeric; color of the grid lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>character or (integer) numeric; line type of the grid lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>non-negative numeric giving line width of the grid lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equilogs</code></td>
<td>
<p>logical, only used when <em>log</em> coordinates and
alignment with the axis tick marks are active.  Setting <code>equilogs =
      FALSE</code> in that case gives <em>non equidistant</em> tick aligned
grid lines.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If more fine tuning is required, use <code><a href="#abline">abline</a>(h = ., v = .)</code>
directly.
</p>


<h3>References</h3>

<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.default">plot</a></code>, <code><a href="#abline">abline</a></code>, <code><a href="#lines">lines</a></code>,
<code><a href="#points">points</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>
grid<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># grid only in y-direction</span>

<span class="token comment">## maybe change the desired number of tick marks:  par(lab = c(mx, my, 7))</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfcol <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>
with<span class="token punctuation">(</span>iris<span class="token punctuation">,</span>
     <span class="token punctuation">{</span>
     plot<span class="token punctuation">(</span>Sepal.Length<span class="token punctuation">,</span> Sepal.Width<span class="token punctuation">,</span> col <span class="token operator">=</span> as.integer<span class="token punctuation">(</span>Species<span class="token punctuation">)</span><span class="token punctuation">,</span>
          xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> panel.first <span class="token operator">=</span> grid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          main <span class="token operator">=</span> <span class="token string">"with(iris,  plot(...., panel.first = grid(), ..) )"</span><span class="token punctuation">)</span>
     plot<span class="token punctuation">(</span>Sepal.Length<span class="token punctuation">,</span> Sepal.Width<span class="token punctuation">,</span> col <span class="token operator">=</span> as.integer<span class="token punctuation">(</span>Species<span class="token punctuation">)</span><span class="token punctuation">,</span>
          panel.first <span class="token operator">=</span> grid<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          main <span class="token operator">=</span> <span class="token string">"... panel.first = grid(3, lty = 1, lwd = 2), .."</span><span class="token punctuation">)</span>
     <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="hist">

<a href="#hist" class="help-page-title"><h2>Histograms</h2></a>

<h3>Description</h3>

<p>The generic function <code>hist</code> computes a histogram of the given
data values.  If <code>plot = TRUE</code>, the resulting object of
<a href="https://r-universe.dev/manuals/base.html#class">class</a> <code>"histogram"</code> is plotted by
<code><a href="#plothistogram">plot.histogram</a></code>, before it is returned.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> breaks <span class="token operator">=</span> <span class="token string">"Sturges"</span><span class="token punctuation">,</span>
     freq <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> probability <span class="token operator">=</span> <span class="token operator">!</span>freq<span class="token punctuation">,</span>
     include.lowest <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> fuzz <span class="token operator">=</span> <span class="token number">1e-7</span><span class="token punctuation">,</span>
     density <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightgray"</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"Histogram of"</span> <span class="token punctuation">,</span> xname<span class="token punctuation">)</span><span class="token punctuation">,</span>
     xlim <span class="token operator">=</span> range<span class="token punctuation">(</span>breaks<span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> xname<span class="token punctuation">,</span> ylab<span class="token punctuation">,</span>
     axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
     nclass <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> warn.unused <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of values for which the histogram is desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>one of:
</p>

<ul>
<li>
<p> a vector giving the breakpoints between histogram cells,
</p>
</li>
<li>
<p> a function to compute the vector of breakpoints,
</p>
</li>
<li>
<p> a single number giving the number of cells for the histogram,
</p>
</li>
<li>
<p> a character string naming an algorithm to compute the
number of cells (see ‘Details’),
</p>
</li>
<li>
<p> a function to compute the number of cells.
</p>
</li>
</ul>
<p>In the last three cases the number is a suggestion only; as the
breakpoints will be set to <code><a href="https://r-universe.dev/manuals/base.html#pretty">pretty</a></code> values, the number
is limited to <code>1e6</code> (with a warning if it was larger).  If
<code>breaks</code> is a function, the <code>x</code> vector is supplied to it
as the only argument (and the number of breaks is only limited by
the amount of available memory).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>logical; if <code>TRUE</code>, the histogram graphic is a
representation of frequencies, the <code>counts</code> component of
the result; if <code>FALSE</code>, probability densities, component
<code>density</code>, are plotted (so that the histogram has a total area
of one).  Defaults to <code>TRUE</code> <em>if and only if</em> <code>breaks</code> are
equidistant (and <code>probability</code> is not specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probability</code></td>
<td>
<p>an <em>alias</em> for <code>!freq</code>, for S compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.lowest</code></td>
<td>
<p>logical; if <code>TRUE</code>, an <code>x[i]</code> equal to
the <code>breaks</code> value will be included in the first (or last, for
<code>right = FALSE</code>) bar.  This will be ignored (with a warning)
unless <code>breaks</code> is a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>
<p>logical; if <code>TRUE</code>, the histogram cells are
right-closed (left open) intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fuzz</code></td>
<td>
<p>non-negative number, for the case when the data is
“pretty” and some observations <code>x[.]</code> are close but not
exactly on a <code>break</code>.  For counting fuzzy breaks proportional
to <code>fuzz</code> are used.  The default is occasionally suboptimal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>the density of shading lines, in lines per inch.
The default value of <code>NULL</code> means that no shading lines
are drawn. Non-positive values of <code>density</code> also inhibit the
drawing of shading lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>the slope of shading lines, given as an angle in
degrees (counter-clockwise).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a colour to be used to fill the bars.
The default used to be <code>NULL</code> (unfilled bars) in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> versions before 4.0.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>the color of the border around the bars.  The default
is to use the standard foreground color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab</code></td>
<td>
<p>main title and axis labels: these arguments to
<code><a href="#title">title</a>()</code> get “smart” defaults here, e.g., the default
<code>ylab</code> is <code>"Frequency"</code> iff <code>freq</code> is true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>the range of x and y values with sensible defaults.
Note that <code>xlim</code> is <em>not</em> used to define the histogram (breaks),
but only for plotting (when <code>plot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), axes are draw if the
plot is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), a histogram is
plotted, otherwise a list of breaks and counts is returned.  In the
latter case, a warning is used if (typically graphical) arguments
are specified that only apply to the <code>plot = TRUE</code> case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>logical or character string.  Additionally draw labels on top
of bars, if not <code>FALSE</code>; see <code><a href="#plothistogram">plot.histogram</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p>numeric (integer).  For S(-PLUS) compatibility only,
<code>nclass</code> is equivalent to <code>breaks</code> for a scalar or
character argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn.unused</code></td>
<td>
<p>logical.  If <code>plot = FALSE</code> and
<code>warn.unused = TRUE</code>, a warning will be issued when graphical
parameters are passed to <code>hist.default()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments and <a href="#par">graphical parameters</a> passed to
<code><a href="#plothistogram">plot.histogram</a></code> and thence to <code><a href="#title">title</a></code> and
<code><a href="#axis">axis</a></code> (if <code>plot = TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The definition of <em>histogram</em> differs by source (with
country-specific biases).  <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s default with equi-spaced breaks (also
the default) is to plot the counts in the cells defined by
<code>breaks</code>.  Thus the height of a rectangle is proportional to
the number of points falling into the cell, as is the area
<em>provided</em> the breaks are equally-spaced.
</p>
<p>The default with non-equi-spaced breaks is to give
a plot of area one, in which the <em>area</em> of the rectangles is the
fraction of the data points falling in the cells.
</p>
<p>If <code>right = TRUE</code> (default), the histogram cells are intervals
of the form <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">(a, b]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">]</span></span></span></span></code>, i.e., they include their right-hand endpoint,
but not their left one, with the exception of the first cell when
<code>include.lowest</code> is <code>TRUE</code>.
</p>
<p>For <code>right = FALSE</code>, the intervals are of the form <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[a, b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></code>,
and <code>include.lowest</code> means ‘<em>include highest</em>’.
</p>
<p>A numerical tolerance of <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>7</mn></mrow></msup></mrow><annotation encoding="application/x-tex">10^{-7}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span></span></code> times the median bin size
(for more than four bins, otherwise the median is substituted) is
applied when counting entries on the edges of bins.  This is not
included in the reported <code>breaks</code> nor in the calculation of
<code>density</code>.
</p>
<p>The default for <code>breaks</code> is <code>"Sturges"</code>: see
<code><a href="https://r-universe.dev/manuals/grDevices.html#nclass">nclass.Sturges</a></code>.  Other names for which algorithms
are supplied are <code>"Scott"</code> and <code>"FD"</code> /
<code>"Freedman-Diaconis"</code> (with corresponding functions
<code><a href="https://r-universe.dev/manuals/grDevices.html#nclass">nclass.scott</a></code> and <code><a href="https://r-universe.dev/manuals/grDevices.html#nclass">nclass.FD</a></code>).
Case is ignored and partial matching is used.
Alternatively, a function can be supplied which
will compute the intended number of breaks or the actual breakpoints
as a function of <code>x</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>"histogram"</code> which is a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> cell boundaries (= <code>breaks</code> if that
was a vector). These are the nominal breaks, not with the boundary fuzz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p><code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> integers; for each cell, the number of
<code>x[]</code> inside.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>values <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat f(x_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2079em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0833em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code>, as estimated
density values. If <code>all(diff(breaks) == 1)</code>, they are the
relative frequencies <code>counts/n</code> and in general satisfy
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_i \hat f(x_i) (b_{i+1}-b_i) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2576em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0833em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code>, where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></code> = <code>breaks[i]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mids</code></td>
<td>
<p>the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></code> cell midpoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xname</code></td>
<td>
<p>a character string with the actual <code>x</code> argument name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equidist</code></td>
<td>
<p>logical, indicating if the distances between
<code>breaks</code> are all the same.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Venables, W. N. and Ripley. B. D. (2002)
<em>Modern Applied Statistics with S</em>.  Springer.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/grDevices.html#nclass">nclass.Sturges</a></code>, <code><a href="#stem">stem</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#density">density</a></code>,  <code><a href="https://r-universe.dev/manuals/MASS.html#truehist">truehist</a></code> in package
<a href="https://CRAN.R-project.org/package=MASS" target="_blank"><span class="pkg">MASS</span></a>.
</p>
<p>Typical plots with vertical bars are <em>not</em> histograms.  Consider
<code><a href="#barplot">barplot</a></code> or <code><a href="#plot.default">plot</a>(*, type = "h")</code>
for such bar plots.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
hist<span class="token punctuation">(</span>islands<span class="token punctuation">)</span>
utils<span class="token operator">::</span>str<span class="token punctuation">(</span>hist<span class="token punctuation">(</span>islands<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray"</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

hist<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>islands<span class="token punctuation">)</span><span class="token punctuation">,</span> breaks <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightblue"</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">)</span>
<span class="token comment">##-- For non-equidistant breaks, counts should NOT be graphed unscaled:</span>
r <span class="token operator">&lt;-</span> hist<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>islands<span class="token punctuation">)</span><span class="token punctuation">,</span> breaks <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          col <span class="token operator">=</span> <span class="token string">"blue1"</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span>r<span class="token operator">$</span>mids<span class="token punctuation">,</span> r<span class="token operator">$</span>density<span class="token punctuation">,</span> r<span class="token operator">$</span>counts<span class="token punctuation">,</span> adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue3"</span><span class="token punctuation">)</span>
sapply<span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span>
sum<span class="token punctuation">(</span>r<span class="token operator">$</span>density <span class="token operator">*</span> diff<span class="token punctuation">(</span>r<span class="token operator">$</span>breaks<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># == 1</span>
lines<span class="token punctuation">(</span>r<span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"purple"</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; lines.histogram(*)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

require<span class="token punctuation">(</span>utils<span class="token punctuation">)</span> <span class="token comment"># for str</span>
str<span class="token punctuation">(</span>hist<span class="token punctuation">(</span>islands<span class="token punctuation">,</span> breaks <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">,</span> plot <span class="token operator">=</span>  <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#-&gt; 10 (~= 12) breaks</span>
str<span class="token punctuation">(</span>hist<span class="token punctuation">(</span>islands<span class="token punctuation">,</span> breaks <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">17000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

hist<span class="token punctuation">(</span>islands<span class="token punctuation">,</span> breaks <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">17000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token string">"WRONG histogram"</span><span class="token punctuation">)</span> <span class="token comment"># and warning</span>

<span class="token comment">## Extreme outliers; the "FD" rule would take very large number of 'breaks':</span>
XXL <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1e300</span><span class="token punctuation">)</span>
hh <span class="token operator">&lt;-</span> hist<span class="token punctuation">(</span>XXL<span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span> <span class="token comment"># did not work in R &lt;= 3.4.1; now gives warning</span>
<span class="token comment">## pretty() determines how many counts are used (platform dependently!):</span>
length<span class="token punctuation">(</span>hh<span class="token operator">$</span>breaks<span class="token punctuation">)</span> <span class="token comment">## typically 1 million -- though 1e6 was "a suggestion only"</span>

<span class="token comment">## R &gt;= 4.2.0: no "*.5" labels on y-axis:</span>
hist<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>
x <span class="token operator">&lt;-</span> rchisq<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>

<span class="token comment">## Histogram with custom x-axis:</span>
hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> xaxt <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span>


<span class="token comment">## Comparing data with a model distribution should be done with qqplot()!</span>
qqplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> qchisq<span class="token punctuation">(</span>ppoints<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> abline<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">## if you really insist on using hist() ... :</span>
hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> freq <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
curve<span class="token punctuation">(</span>dchisq<span class="token punctuation">(</span>x<span class="token punctuation">,</span> df <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="hist.POSIXt">

<a href="#hist.POSIXt" class="help-page-title"><h2>Histogram of a Date or Date-Time Object</h2></a>

<h3>Description</h3>

<p>Methods for <code><a href="#hist">hist</a></code> applied to date (class <code>"<a href="https://r-universe.dev/manuals/base.html#Dates">Date</a>"</code>)
or date-time (class  <code>"<a href="https://r-universe.dev/manuals/base.html#DateTimeClasses">POSIXt</a>"</code>) objects.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'POSIXt'</span>
hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> breaks<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> deparse1<span class="token punctuation">(</span>substitute<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> freq <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
     start.on.monday <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> format<span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'Date'</span>
hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> breaks<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> deparse1<span class="token punctuation">(</span>substitute<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> freq <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
     start.on.monday <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> format<span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="https://r-universe.dev/manuals/base.html#DateTimeClasses">POSIXt</a>"</code>
or <code>"<a href="https://r-universe.dev/manuals/base.html#Dates">Date</a>"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>a vector of cut points <em>or</em> number giving the number of
intervals which <code>x</code> is to be cut into <em>or</em> an
interval specification, one of <code>"days"</code>, <code>"weeks"</code>,
<code>"months"</code>, <code>"quarters"</code> or <code>"years"</code>,
plus <code>"secs"</code>, <code>"mins"</code>, <code>"hours"</code> for
date-time objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a>, or arguments to
<code><a href="#hist">hist.default</a></code> such as <code>include.lowest</code>,
<code>density</code> and <code>labels</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a character string giving the label for the x axis, if plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), a histogram is
plotted, otherwise a list of breaks and counts is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>logical; if <code>TRUE</code>, the
histogram graphic is a representation of frequencies, i.e,
the <code>counts</code> component of the result; if <code>FALSE</code>,
<em>relative</em> frequencies (probabilities) are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.on.monday</code></td>
<td>
<p>logical. If <code>breaks = "weeks"</code>, should the
week start on Mondays or Sundays?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>for the x-axis labels. See <code><a href="https://r-universe.dev/manuals/base.html#strptime">strptime</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>
<p>logical; if <code>TRUE</code>, the histogram cells are
right-closed (left open) intervals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that unlike the default method, <code>breaks</code> is a required argument.
</p>
<p>Using <code>breaks = "quarters"</code> will create intervals of 3 calendar
months, with the intervals beginning on January 1, April 1,
July 1 or October 1, based upon <code>min(x)</code> as appropriate.
</p>
<p>With the default <code>right = TRUE</code>, breaks will be set
on the last day of the previous period when <code>breaks</code> is
<code>"months"</code>, <code>"quarters"</code> or <code>"years"</code>.  Use
<code>right = FALSE</code> to set them to the first day of the
interval shown in each bar.
</p>


<h3>Value</h3>

<p>An object of class <code>"histogram"</code>: see <code><a href="#hist">hist</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#seq.POSIXt">seq.POSIXt</a></code>, <code><a href="#axis.POSIXct">axis.POSIXct</a></code>, <code><a href="#hist">hist</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">hist<span class="token punctuation">(</span>.leap.seconds<span class="token punctuation">,</span> <span class="token string">"years"</span><span class="token punctuation">,</span> freq <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
brks <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span>ISOdate<span class="token punctuation">(</span><span class="token number">1970</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ISOdate<span class="token punctuation">(</span><span class="token number">2030</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"5 years"</span><span class="token punctuation">)</span>
hist<span class="token punctuation">(</span>.leap.seconds<span class="token punctuation">,</span> brks<span class="token punctuation">)</span>
rug<span class="token punctuation">(</span>.leap.seconds<span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">## show that  'include.lowest' "works"</span>
stopifnot<span class="token punctuation">(</span>identical<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   hist<span class="token punctuation">(</span>brks<span class="token punctuation">,</span> brks<span class="token punctuation">,</span> plot<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> include.lowest<span class="token operator">=</span><span class="token boolean">TRUE</span> <span class="token punctuation">)</span><span class="token operator">$</span>counts<span class="token punctuation">)</span><span class="token punctuation">)</span>
tools<span class="token operator">::</span>assertError<span class="token punctuation">(</span>verbose<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token comment">##--&gt; 'breaks' do not span range of 'x'</span>
   hist<span class="token punctuation">(</span>brks<span class="token punctuation">,</span> brks<span class="token punctuation">,</span> plot<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> include.lowest<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## The default fuzz in hist.default()  "kills" this, with a "wrong" message:</span>
try <span class="token punctuation">(</span> hist<span class="token punctuation">(</span>brks<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> brks<span class="token punctuation">,</span> include.lowest <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment">## and decreasing 'fuzz' solves the issue:</span>
hb <span class="token operator">&lt;-</span> hist<span class="token punctuation">(</span>brks<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> brks<span class="token punctuation">,</span> include.lowest <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> fuzz <span class="token operator">=</span> <span class="token number">1e-10</span><span class="token punctuation">)</span>
stopifnot<span class="token punctuation">(</span>hb<span class="token operator">$</span>counts <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">## 100 random dates in a 10-week period</span>
random.dates <span class="token operator">&lt;-</span> as.Date<span class="token punctuation">(</span><span class="token string">"2001/1/1"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">70</span><span class="token operator">*</span>stats<span class="token operator">::</span>runif<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
hist<span class="token punctuation">(</span>random.dates<span class="token punctuation">,</span> <span class="token string">"weeks"</span><span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">"%d %b"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="identify">

<a href="#identify" class="help-page-title"><h2>Identify Points in a Scatter Plot</h2></a>

<h3>Description</h3>

<p><code>identify</code> reads the position of the graphics pointer when the
(first) mouse button is pressed.  It then searches the coordinates
given in <code>x</code> and <code>y</code> for the point closest to the pointer.
If this point is close enough to the pointer, its index will be returned as
part of the value of the call.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">identify<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
identify<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> seq_along<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> pos <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
         n <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> atpen <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> offset <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
         tolerance <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">,</span> order <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>coordinates of points in a scatter plot.  Alternatively, any
object which defines coordinates (a plotting structure, time
series etc: see <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>) can be given as <code>x</code>,
and <code>y</code> left missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>an optional character vector giving labels for the
points.  Will be coerced using <code><a href="https://r-universe.dev/manuals/base.html#character">as.character</a></code>, and
recycled if necessary to the length of <code>x</code>.  Excess labels will
be discarded, with a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>if <code>pos</code> is <code>TRUE</code>, a component is added to the
return value which indicates where text was plotted relative to each
identified point: see Value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the maximum number of points to be identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical: if <code>plot</code> is <code>TRUE</code>, the labels are
printed near the points and if <code>FALSE</code> they are omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atpen</code></td>
<td>
<p>logical: if <code>TRUE</code> and <code>plot = TRUE</code>, the
lower-left corners of the labels are plotted at the points clicked
rather than relative to the points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>the distance (in character widths) which separates the
label from identified points.  Negative values are allowed.  Not
used if <code>atpen = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>the maximal distance (in inches) for the pointer to be
‘close enough’ to a point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>if <code>order</code> is <code>TRUE</code>, a component is added to the
return value which indicates the order in which points were
identified: see Value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code><a href="#par">par</a></code> such as
<code>cex</code>, <code>col</code> and <code>font</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>identify</code> is a generic function, and only the default method is
described here.
</p>
<p><code>identify</code> is only supported on screen devices such as
<code>X11</code>, <code>windows</code> and <code>quartz</code>.  On other devices the
call will do nothing.
</p>
<p>Clicking near (as defined by <code>tolerance</code>) a point adds it to the
list of identified points.  Points can be identified only once, and if
the point has already been identified or the click is not
near any of the points a message is printed immediately on
the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> console.
</p>
<p>If <code>plot</code> is <code>TRUE</code>, the point is labelled with the
corresponding element of <code>labels</code>.  If <code>atpen</code> is false (the
default) the labels are placed below, to the left, above or to the
right of the identified point, depending on where the pointer was
relative to the point.  If <code>atpen</code> is true, the
labels are placed with the bottom left of the string's box at the
pointer.
</p>
<p>For the usual <code><a href="https://r-universe.dev/manuals/grDevices.html#x11">X11</a></code> device the identification process is
terminated by pressing any mouse button other than the first.
For the <code><a href="https://r-universe.dev/manuals/grDevices.html#quartz">quartz</a></code> device the process is terminated by
pressing either the pop-up menu equivalent (usually second mouse
button or <code>Ctrl</code>-click) or the <code>ESC</code> key.
</p>
<p>On most devices which support <code>identify</code>, successful selection of
a point is indicated by a bell sound unless
<code><a href="https://r-universe.dev/manuals/base.html#options">options</a>(locatorBell = FALSE)</code> has been set.
</p>
<p>If the window is resized or hidden and then exposed before the identification
process has terminated, any labels drawn by <code>identify</code>
will disappear.  These will reappear once the identification process has
terminated and the window is resized or hidden and exposed again.
This is because the labels drawn by <code>identify</code> are not
recorded in the device's display list until the identification process has
terminated.
</p>
<p>If you interrupt the <code>identify</code> call this leaves the graphics
device in an undefined state, with points labelled but labels not
recorded in the display list.  Copying a device in that state
will give unpredictable results.
</p>


<h3>Value</h3>

<p>If both <code>pos</code> and <code>order</code> are <code>FALSE</code>,
an integer vector containing the
indices of the identified points.
</p>
<p>If either of <code>pos</code> or <code>order</code> is <code>TRUE</code>,
a list containing a component
<code>ind</code>, indicating which points were identified and (if
<code>pos</code> is <code>TRUE</code>) a component
<code>pos</code>, indicating where the labels were placed relative to the
identified points (1=below, 2=left, 3=above, 4=right and 0=no offset,
used if <code>atpen = TRUE</code>) and (if <code>order</code> is <code>TRUE</code>)
a component <code>order</code>, indicating the order in which points
were identified.
</p>


<h3>Technicalities</h3>

<p>The algorithm used for placing labels is the same as used by
<code>text</code> if <code>pos</code> is specified there, the difference being
that the position of the pointer relative the identified point
determines <code>pos</code> in <code>identify</code>.
</p>
<p>For labels placed to the left of a point, the right-hand edge of the
string's box is placed <code>offset</code> units to the left of the point,
and analogously for points to the right.  The baseline of the text is
placed below the point so as to approximately centre string vertically.
For labels placed above or below a point, the string is centered
horizontally on the point.  For labels placed above, the baseline of
the text is placed <code>offset</code> units above the point, and
for those placed below, the baseline is placed so that the top
of the string's box is approximately <code>offset</code> units below the
point.  If you want more precise placement (e.g., centering) use
<code>plot = FALSE</code> and plot via <code><a href="#text">text</a></code> or
<code><a href="#points">points</a></code>: see the examples.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#locator">locator</a></code>, <code><a href="#text">text</a></code>.
</p>
<p><code><a href="https://r-universe.dev/manuals/grDevices.html#dev.capabilities">dev.capabilities</a></code> to see if it is supported.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## A function to use identify to select points, and overplot the</span>
<span class="token comment">## points with another symbol as they are selected</span>
identifyPch <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> n <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    xy <span class="token operator">&lt;-</span> xy.coords<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> x <span class="token operator">&lt;-</span> xy<span class="token operator">$</span>x<span class="token punctuation">;</span> y <span class="token operator">&lt;-</span> xy<span class="token operator">$</span>y
    sel <span class="token operator">&lt;-</span> rep<span class="token punctuation">(</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>sum<span class="token punctuation">(</span>sel<span class="token punctuation">)</span> <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ans <span class="token operator">&lt;-</span> identify<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token operator">!</span>sel<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span><span class="token operator">!</span>sel<span class="token punctuation">]</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> which<span class="token punctuation">(</span><span class="token operator">!</span>sel<span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> plot<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>length<span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span>
        ans <span class="token operator">&lt;-</span> which<span class="token punctuation">(</span><span class="token operator">!</span>sel<span class="token punctuation">)</span><span class="token punctuation">[</span>ans<span class="token punctuation">]</span>
        points<span class="token punctuation">(</span>x<span class="token punctuation">[</span>ans<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>ans<span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> pch<span class="token punctuation">)</span>
        sel<span class="token punctuation">[</span>ans<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token boolean">TRUE</span>
    <span class="token punctuation">}</span>
    <span class="token comment">## return indices of selected points</span>
    which<span class="token punctuation">(</span>sel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>dev.interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">## use it</span>
  x <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">&lt;-</span> rnorm<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
  plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> identifyPch<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token comment"># how fast to get all?</span>
<span class="token punctuation">}</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="image">

<a href="#image" class="help-page-title"><h2>Display a Color Image</h2></a>

<h3>Description</h3>

<p>Creates a grid of colored or gray-scale rectangles with colors
corresponding to the values in <code>z</code>.  This can be used to display
three-dimensional or spatial data aka <em>images</em>.
This is a generic function.
</p>
<p><em>NOTE:</em> the grid is drawn as a set of rectangles by default;
see the <code>useRaster</code> argument to draw the grid as a raster image.
</p>
<p>The function <code><a href="https://r-universe.dev/manuals/grDevices.html#palettes">hcl.colors</a></code> provides a broad range of sequential
color palettes that are suitable for displaying ordered data, with
<code>n</code> giving the number of colors desired.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">image<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
image<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> zlim<span class="token punctuation">,</span> xlim<span class="token punctuation">,</span> ylim<span class="token punctuation">,</span>
      col <span class="token operator">=</span> hcl.colors<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">"YlOrRd"</span><span class="token punctuation">,</span> rev <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> xaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">,</span> yaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">,</span> xlab<span class="token punctuation">,</span> ylab<span class="token punctuation">,</span>
      breaks<span class="token punctuation">,</span> oldstyle <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> useRaster<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are
measured.  These must be finite, non-missing and in (strictly)
ascending order.  By default, equally
spaced values from 0 to 1 are used.  If <code>x</code> is a <code>list</code>,
its components <code>x$x</code> and <code>x$y</code> are used for <code>x</code>
and <code>y</code>, respectively. If the list has component <code>z</code> this
is used for <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a numeric or logical matrix containing the values to be plotted
(<code>NA</code>s are allowed).  Note that <code>x</code> can be used instead
of <code>z</code> for convenience.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>the minimum and maximum <code>z</code> values for which colors
should be plotted, defaulting to the range of the finite values of
<code>z</code>. Each of the given colors will be used to color an
equispaced interval of this range. The <em>midpoints</em> of the
intervals cover the range, so that values just outside the range
will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>ranges for the plotted <code>x</code> and <code>y</code> values,
defaulting to the ranges of <code>x</code> and <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a list of colors such as that generated by
<code><a href="https://r-universe.dev/manuals/grDevices.html#palettes">hcl.colors</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#gray.colors">gray.colors</a></code> or similar
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical; if <code>TRUE</code>, add to current plot (and disregard
the following four arguments).  This is rarely useful because
<code>image</code> ‘paints’ over existing graphics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxs, yaxs</code></td>
<td>
<p>style of x and y axis.  The default <code>"i"</code> is
appropriate for images.  See <code><a href="#par">par</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>each a character string giving the labels for the x and
y axis.  Default to the ‘call names’ of <code>x</code> or <code>y</code>, or to
<code>""</code> if these were unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>a set of finite numeric breakpoints for the colours:
must have one more breakpoint than colour and be in increasing
order.  Unsorted vectors will be sorted, with a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldstyle</code></td>
<td>
<p>logical. If true the midpoints of the colour intervals
are equally spaced, and <code>zlim[1]</code> and <code>zlim[2]</code> were taken
to be midpoints.  The default is to have colour intervals of equal
lengths between the limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useRaster</code></td>
<td>
<p>logical; if <code>TRUE</code> a bitmap raster is used to
plot the image instead of polygons. The grid must be regular in that
case, otherwise an error is raised.   For the behaviour when this is
not specified, see ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a> for <code><a href="#plot.default">plot</a></code> may also be
passed as arguments to this function, as can the plot aspect ratio
<code>asp</code> and <code>axes</code> (see <code><a href="#plot.window">plot.window</a></code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The length of <code>x</code> should be equal to the <code>nrow(z)+1</code> or
<code>nrow(z)</code>.  In the first case <code>x</code> specifies the boundaries
between the cells: in the second case <code>x</code> specifies the midpoints
of the cells.  Similar reasoning applies to <code>y</code>.  It probably
only makes sense to specify the midpoints of an equally-spaced
grid.  If you specify just one row or column and a length-one <code>x</code>
or <code>y</code>, the whole user area in the corresponding direction is
filled. For logarithmic <code>x</code> or <code>y</code> axes the boundaries between
cells must be specified.
</p>
<p>Rectangles corresponding to missing values are not plotted (and so are
transparent and (unless <code>add = TRUE</code>) the default background
painted in <code>par("bg")</code> will show through and if that is
transparent, the canvas colour will be seen).
</p>
<p>If <code>breaks</code> is specified then <code>zlim</code> is unused and the
algorithm used follows <code><a href="https://r-universe.dev/manuals/base.html#cut">cut</a></code>, so intervals are closed on
the right and open on the left except for the lowest interval which is
closed at both ends.
</p>
<p>The axes (where plotted) make use of the classes of <code>xlim</code> and
<code>ylim</code> (and hence by default the classes of <code>x</code> and
<code>y</code>): this will mean that for example dates are labelled as
such.
</p>
<p>Notice that <code>image</code> interprets the <code>z</code> matrix as a table of
<code>f(x[i], y[j])</code> values, so that the x axis corresponds to row
number and the y axis to column number, with column 1 at the bottom,
i.e. a 90 degree counter-clockwise rotation of the conventional
printed layout of a matrix.
</p>
<p>Images for large <code>z</code> on a regular grid are rendered more
efficiently with <code>useRaster = TRUE</code> and can prevent rare
anti-aliasing artifacts, but may not be supported by all graphics
devices.  Some devices (such as <code>postscript</code> and <code>X11(type =
  "Xlib")</code>) which do not support semi-transparent colours may emit
missing values as white rather than transparent, and there may be
limitations on the size of a raster image.  (Problems with the
rendering of raster images have been reported by users of
<code>windows()</code> devices under Remote Desktop, at least under its
default settings.)
</p>
<p>The graphics files in PDF and PostScript can be much smaller under
this option.
</p>
<p>If <code>useRaster</code> is not specified, raster images are used when the
<code><a href="https://r-universe.dev/manuals/base.html#options">getOption</a>("preferRaster")</code> is true, the grid is regular
and either <code><a href="https://r-universe.dev/manuals/grDevices.html#dev.capabilities">dev.capabilities</a>("rasterImage")$rasterImage</code>
is <code>"yes"</code> or it is <code>"non-missing"</code> and there are no missing
values.
</p>


<h3>Note</h3>

<p>Originally based on a function by Thomas Lumley.
</p>


<h3>See Also</h3>

<p><code><a href="#filled.contour">filled.contour</a></code> or <code><a href="https://r-universe.dev/manuals/stats.html#heatmap">heatmap</a></code> which can
look nicer (but are less modular),
<code><a href="#contour">contour</a></code>;
The <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a> equivalent of <code>image</code> is
<code><a href="https://deepayan.r-universe.dev/manual/lattice.html#levelplot">levelplot</a></code>.
</p>
<p><code><a href="https://r-universe.dev/manuals/grDevices.html#palettes">hcl.colors</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#gray.colors">gray.colors</a></code>,
<code><a href="https://r-universe.dev/manuals/grDevices.html#hcl">hcl</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#hsv">hsv</a></code>, <code><a href="#par">par</a></code>.
</p>
<p><code><a href="https://r-universe.dev/manuals/grDevices.html#dev.capabilities">dev.capabilities</a></code> to see if <code>useRaster = TRUE</code> is
supported on the current device.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span><span class="token string">"grDevices"</span><span class="token punctuation">)</span> <span class="token comment"># for colours</span>
x <span class="token operator">&lt;-</span> y <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>outer<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> y<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> `<span class="token operator">+</span>`<span class="token punctuation">)</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>z <span class="token operator">=</span> z <span class="token operator">&lt;-</span> cos<span class="token punctuation">(</span>r<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>r<span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> gray.colors<span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>z<span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Math can be beautiful ..."</span><span class="token punctuation">,</span>
      xlab <span class="token operator">=</span> expression<span class="token punctuation">(</span>cos<span class="token punctuation">(</span>r<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> e<span class="token operator">^</span><span class="token punctuation">{</span><span class="token operator">-</span>r<span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
contour<span class="token punctuation">(</span>z<span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> drawlabels <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment"># Volcano data visualized as matrix. Need to transpose and flip</span>
<span class="token comment"># matrix horizontally.</span>
image<span class="token punctuation">(</span>t<span class="token punctuation">(</span>volcano<span class="token punctuation">)</span><span class="token punctuation">[</span>ncol<span class="token punctuation">(</span>volcano<span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># A prettier display of the volcano</span>
x <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>nrow<span class="token punctuation">(</span>volcano<span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>ncol<span class="token punctuation">(</span>volcano<span class="token punctuation">)</span><span class="token punctuation">)</span>
image<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> volcano<span class="token punctuation">,</span> col <span class="token operator">=</span> hcl.colors<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"terrain"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
contour<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> volcano<span class="token punctuation">,</span> levels <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"brown"</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> at <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
box<span class="token punctuation">(</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span>main <span class="token operator">=</span> <span class="token string">"Maunga Whau Volcano"</span><span class="token punctuation">,</span> font.main <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="layout">

<a href="#layout" class="help-page-title"><h2>Specifying Complex Plot Arrangements</h2></a>

<h3>Description</h3>

<p><code>layout</code> divides the device up into as many rows and columns as
there are in matrix <code>mat</code>, with the column-widths and the
row-heights specified in the respective arguments.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">layout<span class="token punctuation">(</span>mat<span class="token punctuation">,</span> widths <span class="token operator">=</span> rep.int<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> ncol<span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       heights <span class="token operator">=</span> rep.int<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> nrow<span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> respect <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

layout.show<span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
lcm<span class="token punctuation">(</span>x<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>a matrix object specifying the location of the next
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></code> figures on the output device.  Each value in the matrix must
be <code>0</code> or a positive integer.  If <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></code> is the largest
positive integer in the matrix, then the integers
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{1, \dots, N-1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span></code> must also appear at least once in the matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>widths</code></td>
<td>
<p>a vector of values for the widths of columns on the
device.  Relative widths are specified with numeric values.    Absolute
widths (in centimetres) are specified with the <code>lcm()</code> function (see
examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heights</code></td>
<td>
<p>a vector of values for the heights of rows on the device.
Relative and absolute heights can be specified, see <code>widths</code> above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>respect</code></td>
<td>
<p>either a logical value or a matrix object.  If the
latter, then it must have the same dimensions as <code>mat</code> and
each value in the matrix must be either <code>0</code> or <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of figures to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a dimension to be interpreted as a number of centimetres.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Figure <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> is allocated a region composed from a subset
of these rows and columns, based on the rows and columns
in which <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></code> occurs in <code>mat</code>.
</p>
<p>The <code>respect</code> argument controls whether a unit column-width is
the same physical measurement on the device as a unit row-height.
</p>
<p>There is a limit (currently 200) for the numbers of rows and columns
in the layout, and also for the total number of cells (10007).
</p>
<p><code>layout.show(n)</code> plots (part of) the current layout, namely the
outlines of the next <code>n</code> figures.
</p>
<p><code>lcm</code> is a trivial function, to be used as <em>the</em> interface
for specifying absolute dimensions for the <code>widths</code> and
<code>heights</code> arguments of <code>layout()</code>.
</p>


<h3>Value</h3>

<p><code>layout</code> returns the number of figures, <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></code>, see above.
</p>


<h3>Warnings</h3>

<p>These functions are totally incompatible with the other mechanisms for
arranging plots on a device: <code><a href="#par">par</a>(mfrow)</code>,
<code>par(mfcol)</code> and <code><a href="#screen">split.screen</a></code>.
</p>


<h3>Author(s)</h3>

<p>Paul R. Murrell</p>


<h3>References</h3>

<p>Murrell, P. R. (1999).
Layouts: A mechanism for arranging plots on a page.
<em>Journal of Computational and Graphical Statistics</em>,
<b>8</b>, 121–134.
<a href="https://doi.org/10.2307/1390924" target="_blank">doi:10.2307/1390924</a>.
</p>
<p>Chapter 5 of Paul Murrell's Ph.D. thesis.
</p>
<p>Murrell, P. (2005).
<em>R Graphics</em>.
Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#par">par</a></code> with arguments <code>mfrow</code>, <code>mfcol</code>, or
<code>mfg</code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">def.par <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>no.readonly <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># save default, for resetting...</span>

<span class="token comment">## divide the device into two rows and two columns</span>
<span class="token comment">## allocate figure 1 all of row 1</span>
<span class="token comment">## allocate figure 2 the intersection of column 2 and row 2</span>
layout<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> byrow <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## show the regions that have been allocated to each plot</span>
layout.show<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">## divide device into two rows and two columns</span>
<span class="token comment">## allocate figure 1 and figure 2 as above</span>
<span class="token comment">## respect relations between widths and heights</span>
nf <span class="token operator">&lt;-</span> layout<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> byrow <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> respect <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
layout.show<span class="token punctuation">(</span>nf<span class="token punctuation">)</span>

<span class="token comment">## create single figure which is 5cm square</span>
nf <span class="token operator">&lt;-</span> layout<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> widths <span class="token operator">=</span> lcm<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> heights <span class="token operator">=</span> lcm<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
layout.show<span class="token punctuation">(</span>nf<span class="token punctuation">)</span>


<span class="token comment">##-- Create a scatterplot with marginal histograms -----</span>

x <span class="token operator">&lt;-</span> pmin<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> pmax<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> pmin<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> pmax<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xhist <span class="token operator">&lt;-</span> hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> breaks <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
yhist <span class="token operator">&lt;-</span> hist<span class="token punctuation">(</span>y<span class="token punctuation">,</span> breaks <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
top <span class="token operator">&lt;-</span> max<span class="token punctuation">(</span>c<span class="token punctuation">(</span>xhist<span class="token operator">$</span>counts<span class="token punctuation">,</span> yhist<span class="token operator">$</span>counts<span class="token punctuation">)</span><span class="token punctuation">)</span>
xrange <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
yrange <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
nf <span class="token operator">&lt;-</span> layout<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>byrow <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
layout.show<span class="token punctuation">(</span>nf<span class="token punctuation">)</span>

par<span class="token punctuation">(</span>mar <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> xlim <span class="token operator">=</span> xrange<span class="token punctuation">,</span> ylim <span class="token operator">=</span> yrange<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>mar <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
barplot<span class="token punctuation">(</span>xhist<span class="token operator">$</span>counts<span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> top<span class="token punctuation">)</span><span class="token punctuation">,</span> space <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>mar <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
barplot<span class="token punctuation">(</span>yhist<span class="token operator">$</span>counts<span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> top<span class="token punctuation">)</span><span class="token punctuation">,</span> space <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> horiz <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

par<span class="token punctuation">(</span>def.par<span class="token punctuation">)</span>  <span class="token comment">#- reset to default</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="legend">

<a href="#legend" class="help-page-title"><h2>Add Legends to Plots</h2></a>

<h3>Description</h3>

<p>This function can be used to add legends to plots.  Note that a call
to the function <code><a href="#locator">locator</a>(1)</code> can be used in place of the <code>x</code>
and <code>y</code> arguments.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">legend<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> legend<span class="token punctuation">,</span> fill <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"col"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       border <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">,</span> lty<span class="token punctuation">,</span> lwd<span class="token punctuation">,</span> pch<span class="token punctuation">,</span>
       angle <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span> density <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> bty <span class="token operator">=</span> <span class="token string">"o"</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"bg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       box.lwd <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lwd"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> box.lty <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lty"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> box.col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       pt.bg <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> pt.cex <span class="token operator">=</span> cex<span class="token punctuation">,</span> pt.lwd <span class="token operator">=</span> lwd<span class="token punctuation">,</span>
       xjust <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> yjust <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> x.intersp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y.intersp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
       adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> text.width <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> text.col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"col"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       text.font <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> merge <span class="token operator">=</span> do.lines <span class="token operator">&amp;&amp;</span> has.pch<span class="token punctuation">,</span> trace <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
       plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> horiz <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
       inset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> xpd<span class="token punctuation">,</span> title.col <span class="token operator">=</span> text.col<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title.adj <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
       title.cex <span class="token operator">=</span> cex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title.font <span class="token operator">=</span> text.font<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       seg.len <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>the x and y co-ordinates to be used to position the legend.
They can be specified by keyword or in any way which is accepted by
<code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>: See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>a character or <a href="https://r-universe.dev/manuals/base.html#expression">expression</a> vector
of length <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\ge 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code> to appear in the legend.  Other
objects will be coerced by <code><a href="https://r-universe.dev/manuals/grDevices.html#as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>if specified, this argument will cause boxes filled
with the specified colors (or shaded in the specified colors)
to appear beside the legend text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>the color of points or lines appearing in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>the border color for the boxes (used only if
<code>fill</code> is specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, lwd</code></td>
<td>
<p>the line types and widths for lines appearing in the
legend.  One of these two <em>must</em> be specified for line drawing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>the plotting symbols appearing in the legend, as
numeric vector or a vector of 1-character strings (see
<code><a href="#points">points</a></code>). Unlike <code>points</code>, this can all be
specified as a single multi-character string.  <em>Must</em> be
specified for symbol drawing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>angle of shading lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>the density of shading lines, if numeric and
positive. If <code>NULL</code> or negative or <code>NA</code> color filling
is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bty</code></td>
<td>
<p>the type of box to be drawn around the legend.  The allowed
values are <code>"o"</code> (the default) and <code>"n"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>the background color for the legend box.  (Note that this is
only used if <code>bty != "n"</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.lty, box.lwd, box.col</code></td>
<td>
<p>the line type, width and color for
the legend box (if <code>bty = "o"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.bg</code></td>
<td>
<p>the background color for the <code><a href="#points">points</a></code>,
corresponding to its argument <code>bg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>character expansion factor <b>relative</b> to current
<code>par("cex")</code>.  Used for text, and provides the default for
<code>pt.cex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.cex</code></td>
<td>
<p>expansion factor(s) for the points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.lwd</code></td>
<td>
<p>line width for the points, defaults to the one for
lines, or if that is not set, to <code>par("lwd")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xjust</code></td>
<td>
<p>how the legend is to be justified relative to the legend
x location.  A value of 0 means left justified, 0.5 means centered
and 1 means right justified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yjust</code></td>
<td>
<p>the same as <code>xjust</code> for the legend y location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.intersp</code></td>
<td>
<p>character interspacing factor for horizontal (x) spacing
between symbol and legend text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.intersp</code></td>
<td>
<p>vertical (y) distances (in lines of text shared above/below each legend entry).
A vector with one element for each row of the legend can be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>numeric of length 1 or 2; the string adjustment for legend
text.  Useful for y-adjustment when <code>labels</code> are
<a href="https://r-universe.dev/manuals/grDevices.html#plotmath">plotmath</a> expressions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.width</code></td>
<td>
<p>the width of the legend text in x (<code>"user"</code>)
coordinates.  (Should be positive even for a reversed x axis.)
Can be a single positive numeric value (same width for each column of the legend),
a vector (one element for each column of the legend),
<code>NULL</code> (default) for computing a proper maximum value of <code><a href="#strwidth">strwidth</a>(legend)</code>),
or <code>NA</code> for computing a proper column wise maximum value of <code><a href="#strwidth">strwidth</a>(legend)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.col</code></td>
<td>
<p>the color used for the legend text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.font</code></td>
<td>
<p>the font used for the legend text, see <code><a href="#text">text</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge</code></td>
<td>
<p>logical; if <code>TRUE</code>, merge points and lines but
not filled boxes.  Defaults to <code>TRUE</code> if there are points and lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>logical; if <code>TRUE</code>, shows how <code>legend</code> does all
its magical computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical.  If <code>FALSE</code>, nothing is plotted but the
sizes are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>the number of columns in which to set the legend items
(default is 1, a vertical legend).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horiz</code></td>
<td>
<p>logical; if <code>TRUE</code>, set the legend horizontally
rather than vertically (specifying <code>horiz</code> overrides the <code>ncol</code>
specification).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a character string or length-one expression giving a
title to be placed at the top of the legend.  Other objects will be
coerced by <code><a href="https://r-universe.dev/manuals/grDevices.html#as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inset</code></td>
<td>
<p>inset distance(s) from the margins as a fraction of the
plot region when legend is placed by keyword.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpd</code></td>
<td>
<p>if supplied, a value of the <a href="#par">graphical parameter</a> <code>xpd</code>
to be used while the legend is being drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.col</code></td>
<td>
<p>color for <code>title</code>, defaults to <code>text.col[1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.adj</code></td>
<td>
<p>horizontal adjustment for <code>title</code>: see the help
for <code><a href="#par">par</a>("adj")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.cex</code></td>
<td>
<p>expansion factor(s) for the title, defaults to <code>cex[1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.font</code></td>
<td>
<p>the font used for the legend title, defaults to <code>text.font[1]</code>,
see <code><a href="#text">text</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seg.len</code></td>
<td>
<p>the length of lines drawn to illustrate <code>lty</code>
and/or <code>lwd</code> (in units of character widths).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Arguments <code>x</code>, <code>y</code>, <code>legend</code> are interpreted in a
non-standard way to allow the coordinates to be specified <em>via</em>
one or two arguments.  If <code>legend</code> is missing and <code>y</code> is not
numeric, it is assumed that the second argument is intended to be
<code>legend</code> and that the first argument specifies the coordinates.
</p>
<p>The coordinates can be specified in any way which is accepted by
<code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>.  If this gives the coordinates of one point,
it is used as the top-left coordinate of the rectangle containing the
legend.  If it gives the coordinates of two points, these specify
opposite corners of the rectangle (either pair of corners, in any
order).
</p>
<p>The location may also be specified by setting <code>x</code> to a single
keyword from the list <code>"bottomright"</code>, <code>"bottom"</code>,
<code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>,
<code>"top"</code>, <code>"topright"</code>, <code>"right"</code> and
<code>"center"</code>. This places the legend on the inside of the plot
frame at the given location. Partial argument matching is used.  The
optional <code>inset</code> argument specifies how far the legend is inset
from the plot margins.  If a single value is given, it is used for
both margins; if two values are given, the first is used for <code>x</code>-
distance, the second for <code>y</code>-distance.
</p>
<p>Attribute arguments such as <code>col</code>, <code>pch</code>, <code>lty</code>, etc,
are recycled if necessary: <code>merge</code> is not.  Set entries of
<code>lty</code> to <code>0</code> or set entries of <code>lwd</code> to <code>NA</code> to
suppress lines in corresponding legend entries; set <code>pch</code>
values to <code>NA</code> to suppress points.
</p>
<p>Points are drawn <em>after</em> lines in order that they can cover the
line with their background color <code>pt.bg</code>, if applicable.
</p>
<p>See the examples for how to right-justify labels.
</p>
<p>Since they are not used for Unicode code points, values <code>-31:-1</code>
are silently omitted, as are <code>NA</code> and <code>""</code> values.
</p>


<h3>Value</h3>

<p>A list with list components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rect</code></td>
<td>
<p>a list with components
</p>

<dl>
<dt>
<code>w</code>, <code>h</code>
</dt>
<dd>
<p>positive numbers giving <b>w</b>idth and
<b>h</b>eight of the legend's box.</p>
</dd>
<dt>
<code>left</code>, <code>top</code>
</dt>
<dd>
<p>x and y coordinates of upper left
corner of the box.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>a list with components
</p>

<dl>
<dt><code>x, y</code></dt>
<dd>
<p>numeric vectors of length <code>length(legend)</code>,
giving the x and y coordinates of the legend's text(s).</p>
</dd>
</dl>
</td>
</tr>
</table>
<p>returned invisibly.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.default">plot</a></code>, <code><a href="#barplot">barplot</a></code> which uses <code>legend()</code>, and
<code><a href="#text">text</a></code> for more examples of math expressions.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Run the example in '?matplot' or the following:</span>
leg.txt <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"Setosa     Petals"</span><span class="token punctuation">,</span> <span class="token string">"Setosa     Sepals"</span><span class="token punctuation">,</span>
             <span class="token string">"Versicolor Petals"</span><span class="token punctuation">,</span> <span class="token string">"Versicolor Sepals"</span><span class="token punctuation">)</span>
y.leg <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">4.5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2.1</span><span class="token punctuation">,</span> <span class="token number">1.4</span><span class="token punctuation">,</span> <span class="token number">.7</span><span class="token punctuation">)</span>
cexv  <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>
matplot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Length"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Width"</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"Petal and Sepal Dimensions in Iris Blossoms"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> seq<span class="token punctuation">(</span>cexv<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  text  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> y.leg<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0.1</span><span class="token punctuation">,</span> paste<span class="token punctuation">(</span><span class="token string">"cex="</span><span class="token punctuation">,</span> formatC<span class="token punctuation">(</span>cexv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
  legend<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> y.leg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> leg.txt<span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token string">"sSvV"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> cexv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">## cex *vector* [in R &lt;= 3.5.1 has 'if(xc &lt; 0)' w/ length(xc) == 2]</span>
legend<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">,</span> leg.txt<span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token string">"sSvV"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       cex <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">,</span> trace <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token comment"># trace: show computed lengths &amp; coords</span>

<span class="token comment">## 'merge = TRUE' for merging lines &amp; points:</span>
x <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token operator">-</span>pi<span class="token punctuation">,</span> pi<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">65</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>reverse <span class="token keyword">in</span> c<span class="token punctuation">(</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">## normal *and* reverse axes:</span>
  F <span class="token operator">&lt;-</span> <span class="token keyword">if</span><span class="token punctuation">(</span>reverse<span class="token punctuation">)</span> rev <span class="token keyword">else</span> identity
  plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sin<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
       xlim <span class="token operator">=</span> F<span class="token punctuation">(</span>range<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> F<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">1.8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  points<span class="token punctuation">(</span>x<span class="token punctuation">,</span> cos<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
  lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> tan<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">)</span>
  title<span class="token punctuation">(</span><span class="token string">"legend('top', lty = c(2, -1, 1), pch = c(NA, 3, 4), merge = TRUE)"</span><span class="token punctuation">,</span>
        cex.main <span class="token operator">=</span> <span class="token number">1.1</span><span class="token punctuation">)</span>
  legend<span class="token punctuation">(</span><span class="token string">"top"</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"sin"</span><span class="token punctuation">,</span> <span class="token string">"cos"</span><span class="token punctuation">,</span> <span class="token string">"tan"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       text.col <span class="token operator">=</span> <span class="token string">"green4"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       merge <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"gray90"</span><span class="token punctuation">,</span> trace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
  
<span class="token punctuation">}</span> <span class="token comment"># for(..)</span>

<span class="token comment">## right-justifying a set of labels: thanks to Uwe Ligges</span>
x <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">;</span> y1 <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">/</span>x<span class="token punctuation">;</span> y2 <span class="token operator">&lt;-</span> <span class="token number">2</span><span class="token operator">/</span>x
plot<span class="token punctuation">(</span>rep<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span>y1<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">;</span> lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
temp <span class="token operator">&lt;-</span> legend<span class="token punctuation">(</span><span class="token string">"topright"</span><span class="token punctuation">,</span> legend <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               text.width <span class="token operator">=</span> strwidth<span class="token punctuation">(</span><span class="token string">"1,000,000"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> xjust <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> yjust <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> inset <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span>
               title <span class="token operator">=</span> <span class="token string">"Line Types"</span><span class="token punctuation">,</span> title.cex <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> trace<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span>temp<span class="token operator">$</span>rect<span class="token operator">$</span>left <span class="token operator">+</span> temp<span class="token operator">$</span>rect<span class="token operator">$</span>w<span class="token punctuation">,</span> temp<span class="token operator">$</span>text<span class="token operator">$</span>y<span class="token punctuation">,</span>
     c<span class="token punctuation">(</span><span class="token string">"1,000"</span><span class="token punctuation">,</span> <span class="token string">"1,000,000"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pos <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>


<span class="token comment">##--- log scaled Examples ------------------------------</span>
leg.txt <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"a one"</span><span class="token punctuation">,</span> <span class="token string">"a two"</span><span class="token punctuation">)</span>

par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>ll <span class="token keyword">in</span> c<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">"x"</span><span class="token punctuation">,</span><span class="token string">"y"</span><span class="token punctuation">,</span><span class="token string">"xy"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  plot<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> log <span class="token operator">=</span> ll<span class="token punctuation">,</span> main <span class="token operator">=</span> paste0<span class="token punctuation">(</span><span class="token string">"log = '"</span><span class="token punctuation">,</span> ll<span class="token punctuation">,</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  abline<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  lines<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
  points<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
  rect<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
  text<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"rect(2,3,3,2, col=4)"</span><span class="token punctuation">,</span>
                      <span class="token string">"text(c(3,3),2:3,\"c(rect(...)\")"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  legend<span class="token punctuation">(</span>list<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> legend <span class="token operator">=</span> leg.txt<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>
         lty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">#, trace = TRUE)</span>
<span class="token punctuation">}</span> <span class="token comment">#      ^^^^^^^ to force lines -&gt; automatic merge=TRUE</span>
par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">##-- Math expressions:  ------------------------------</span>
x <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token operator">-</span>pi<span class="token punctuation">,</span> pi<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">65</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sin<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> expression<span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">,</span>
     ylab <span class="token operator">=</span> expression<span class="token punctuation">(</span>f<span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>h <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> v <span class="token operator">=</span> pi<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray90"</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> cos<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
ex.cs1 <span class="token operator">&lt;-</span> expression<span class="token punctuation">(</span>plain<span class="token punctuation">(</span>sin<span class="token punctuation">)</span> <span class="token operator">*</span> phi<span class="token punctuation">,</span>  paste<span class="token punctuation">(</span><span class="token string">"cos"</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2 ways</span>
utils<span class="token operator">::</span>str<span class="token punctuation">(</span>legend<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> ex.cs1<span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
           adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># adj y !</span>
legend<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span> ex.cs1<span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>  adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
x <span class="token operator">&lt;-</span> rexp<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> rate <span class="token operator">=</span> <span class="token number">.5</span><span class="token punctuation">)</span>
hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Mean and Median of a Skewed Distribution"</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>v <span class="token operator">=</span> mean<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>   col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>v <span class="token operator">=</span> median<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
ex12 <span class="token operator">&lt;-</span> expression<span class="token punctuation">(</span>bar<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> sum<span class="token punctuation">(</span>over<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span>
                   hat<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> median<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>
utils<span class="token operator">::</span>str<span class="token punctuation">(</span>legend<span class="token punctuation">(</span><span class="token number">4.1</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> ex12<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## 'Filled' boxes -- see also example(barplot) which may call legend(*, fill=)</span>
barplot<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"topright"</span><span class="token punctuation">,</span> rownames<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span><span class="token punctuation">,</span> fill <span class="token operator">=</span> gray.colors<span class="token punctuation">(</span>nrow<span class="token punctuation">(</span>VADeaths<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Using 'ncol'</span>
x <span class="token operator">&lt;-</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">64</span><span class="token operator">/</span><span class="token number">64</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>R <span class="token keyword">in</span> c<span class="token punctuation">(</span>identity<span class="token punctuation">,</span> rev<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment"># normal *and* reverse x-axis works fine:</span>
  xl <span class="token operator">&lt;-</span> R<span class="token punctuation">(</span>range<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> x1 <span class="token operator">&lt;-</span> xl<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
matplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> outer<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> k<span class="token punctuation">)</span> sin<span class="token punctuation">(</span>k <span class="token operator">*</span> pi <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xlim<span class="token operator">=</span>xl<span class="token punctuation">,</span>
        type <span class="token operator">=</span> <span class="token string">"o"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token string">"*"</span><span class="token punctuation">)</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>bg <span class="token operator">=</span> <span class="token string">"antiquewhite1"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> paste<span class="token punctuation">(</span><span class="token string">"sin("</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">"pi * x)"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span>
       pch <span class="token operator">=</span> <span class="token string">"*"</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"bottomright"</span><span class="token punctuation">,</span> paste<span class="token punctuation">(</span><span class="token string">"sin("</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">"pi * x)"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span>
       pch <span class="token operator">=</span> <span class="token string">"*"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">.1</span><span class="token punctuation">,</span> paste<span class="token punctuation">(</span><span class="token string">"sin("</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"pi * x)"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span>
       ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">.4</span><span class="token punctuation">,</span> paste<span class="token punctuation">(</span><span class="token string">"sin("</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">"pi * x)"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span>  pch <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">,</span>
       ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> pt.bg <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">,</span> pt.cex <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>
  
<span class="token punctuation">}</span> <span class="token comment"># for(..)</span>

<span class="token comment">## point covering line :</span>
y <span class="token operator">&lt;-</span> sin<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>pi<span class="token operator">*</span>x<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span>
    main <span class="token operator">=</span> <span class="token string">"points with bg &amp; legend(*, pt.bg)"</span><span class="token punctuation">)</span>
points<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token number">.4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"sin(c x)"</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">,</span> pt.bg <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span>

<span class="token comment">## legends with titles at different locations</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"bottomright"</span><span class="token punctuation">,</span> <span class="token string">"(x,y)"</span><span class="token punctuation">,</span> pch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span> <span class="token string">"bottomright"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"bottom"</span><span class="token punctuation">,</span>      <span class="token string">"(x,y)"</span><span class="token punctuation">,</span> pch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span> <span class="token string">"bottom"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"bottomleft"</span><span class="token punctuation">,</span>  <span class="token string">"(x,y)"</span><span class="token punctuation">,</span> pch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span> <span class="token string">"bottomleft"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">,</span>        <span class="token string">"(x,y)"</span><span class="token punctuation">,</span> pch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span> <span class="token string">"left"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"topleft"</span><span class="token punctuation">,</span>     <span class="token string">"(x,y)"</span><span class="token punctuation">,</span> pch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span> <span class="token string">"topleft, inset = .05"</span><span class="token punctuation">,</span> inset <span class="token operator">=</span> <span class="token number">.05</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"top"</span><span class="token punctuation">,</span>         <span class="token string">"(x,y)"</span><span class="token punctuation">,</span> pch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span> <span class="token string">"top"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"topright"</span><span class="token punctuation">,</span>    <span class="token string">"(x,y)"</span><span class="token punctuation">,</span> pch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span> <span class="token string">"topright, inset = .02"</span><span class="token punctuation">,</span>inset <span class="token operator">=</span> <span class="token number">.02</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">,</span>       <span class="token string">"(x,y)"</span><span class="token punctuation">,</span> pch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span> <span class="token string">"right"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"center"</span><span class="token punctuation">,</span>      <span class="token string">"(x,y)"</span><span class="token punctuation">,</span> pch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">=</span> <span class="token string">"center"</span><span class="token punctuation">)</span>

<span class="token comment"># using text.font (and text.col):</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">2.1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
c6 <span class="token operator">&lt;-</span> terrain.colors<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">]</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> ann <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span> title<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"text.font ="</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
   legend<span class="token punctuation">(</span><span class="token string">"top"</span><span class="token punctuation">,</span> legend <span class="token operator">=</span> LETTERS<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c6<span class="token punctuation">,</span>
          ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> text.font <span class="token operator">=</span> i<span class="token punctuation">,</span> text.col <span class="token operator">=</span> c6<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment"># using text.width for several columns</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"n"</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"topleft"</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"This legend"</span><span class="token punctuation">,</span> <span class="token string">"has"</span><span class="token punctuation">,</span> <span class="token string">"equally sized"</span><span class="token punctuation">,</span> <span class="token string">"columns."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       pch <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"bottomleft"</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"This legend"</span><span class="token punctuation">,</span> <span class="token string">"has"</span><span class="token punctuation">,</span> <span class="token string">"optimally sized"</span><span class="token punctuation">,</span> <span class="token string">"columns."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       pch <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> text.width <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">,</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
       text.width <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span> <span class="token operator">/</span> <span class="token number">50</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="lines">

<a href="#lines" class="help-page-title"><h2>Add Connected Line Segments to a Plot</h2></a>

<h3>Description</h3>

<p>A generic function taking coordinates given in various ways and
joining the corresponding points with line segments.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>coordinate vectors of points to join.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character indicating the type of plotting; actually any of
the <code>type</code>s as in <code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further graphical parameters (see <code><a href="#par">par</a></code>) may
also be supplied as arguments, particularly, line type, <code>lty</code>,
line width, <code>lwd</code>, color, <code>col</code> and for <code>type = "b"</code>,
<code>pch</code>.  Also the line characteristics <code>lend</code>, <code>ljoin</code>
and <code>lmitre</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The coordinates can be passed in a plotting structure
(a list with <code>x</code> and <code>y</code> components), a two-column matrix, a
time series, ....  See <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>.  If supplied
separately, they must be of the same length.
</p>
<p>The coordinates can contain <code>NA</code> values. If a point contains
<code>NA</code> in either its <code>x</code> or <code>y</code> value, it is omitted from
the plot, and lines are not drawn to or from such points.  Thus
missing values can be used to achieve breaks in lines.
</p>
<p>For <code>type = "h"</code>, <code>col</code> can be a vector and will be recycled
as needed.
</p>
<p><code>lwd</code> can be a vector: its first element will apply to lines but
the whole vector to symbols (recycled as necessary).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.formula">lines.formula</a></code> for the formula method;
<code><a href="#points">points</a></code>, particularly for <code>type %in% c("p","b","o")</code>,
<code><a href="#plot.default">plot</a></code>,
and the workhorse function <code><a href="#plot.xy">plot.xy</a></code>.
</p>
<p><code><a href="#abline">abline</a></code> for drawing (single) straight lines.
</p>
<p><code><a href="#par">par</a></code> for line type (<code>lty</code>) specification and how to
specify colors.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># draw a smooth line through a scatter plot</span>
plot<span class="token punctuation">(</span>cars<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Stopping Distance versus Speed"</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>stats<span class="token operator">::</span>lowess<span class="token punctuation">(</span>cars<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="locator">

<a href="#locator" class="help-page-title"><h2>Graphical Input</h2></a>

<h3>Description</h3>

<p>Reads the position of the graphics cursor when the (first) mouse
button is pressed.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">locator<span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the maximum number of points to locate.  Valid values start
at 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>One of <code>"n"</code>, <code>"p"</code>, <code>"l"</code> or
<code>"o"</code>. If <code>"p"</code> or <code>"o"</code> the points are
plotted; if <code>"l"</code>  or <code>"o"</code> they are joined by lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional graphics parameters used if <code>type != "n"</code>
for plotting the locations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>locator</code> is only supported on screen devices such as
<code>X11</code>, <code>windows</code> and <code>quartz</code>.  On other devices the
call will do nothing.
</p>
<p>Unless the process is terminated prematurely by the user (see below)
at most <code>n</code> positions are determined.
</p>
<p>For the usual <code><a href="https://r-universe.dev/manuals/grDevices.html#x11">X11</a></code> device the identification process is
terminated by pressing any mouse button other than the first.
For the <code><a href="https://r-universe.dev/manuals/grDevices.html#quartz">quartz</a></code> device the process is terminated by
pressing the <code>ESC</code> key.
</p>
<p>The current graphics parameters apply just as if <code>plot.default</code>
has been called with the same value of <code>type</code>. The plotting of
the points and lines is subject to clipping, but locations outside the
current clipping rectangle will be returned.
</p>
<p>On most devices which support <code>locator</code>, successful selection of
a point is indicated by a bell sound unless
<code><a href="https://r-universe.dev/manuals/base.html#options">options</a>(locatorBell = FALSE)</code> has been set.
</p>
<p>If the window is resized or hidden and then exposed before the input
process has terminated, any lines or points drawn by <code>locator</code>
will disappear.  These will reappear once the input process has
terminated and the window is resized or hidden and exposed again.
This is because the points and lines drawn by <code>locator</code> are not
recorded in the device's display list until the input process has
terminated.
</p>


<h3>Value</h3>

<p>A list containing <code>x</code> and <code>y</code> components which are the
coordinates of the identified points in the user coordinate system,
i.e., the one specified by <code><a href="#par">par</a>("usr")</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#identify">identify</a></code>.
<code><a href="https://r-universe.dev/manuals/grid.html#grid.locator">grid.locator</a></code> is the corresponding <span class="pkg">grid</span>
package function.
</p>
<p><code><a href="https://r-universe.dev/manuals/grDevices.html#dev.capabilities">dev.capabilities</a></code> to see if it is supported.
</p>

<hr>
</div>
<div class="container manual-page" id="matplot">

<a href="#matplot" class="help-page-title"><h2>Plot Columns of Matrices</h2></a>

<h3>Description</h3>

<p>Plot the columns of one matrix against the columns of another (which
often is just a vector treated as 1-column matrix).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">matplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"p"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> lend <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lend"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        pch <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
        xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
        log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> verbose <span class="token operator">=</span> getOption<span class="token punctuation">(</span><span class="token string">"verbose"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

matpoints<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"p"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

matlines <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,y</code></td>
<td>
<p>vectors or matrices of data for plotting.  The number of
rows should match.  If one of them are missing, the other is taken
as <code>y</code> and an <code>x</code> vector of <code>1:n</code> is used.
Missing values (<code>NA</code>s) are allowed.  Since <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> 4.0.0,
<code><a href="https://r-universe.dev/manuals/base.html#class">class</a>(.)</code>es of <code>x</code> and <code>y</code> such as
<code>"<a href="https://r-universe.dev/manuals/base.html#Dates">Date</a>"</code> are typically preserved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character string (length 1 vector) or vector of 1-character
strings indicating the type of plot for each
column of <code>y</code>, see <code><a href="#plot.default">plot</a></code> for all possible
<code>type</code>s.  The first character of <code>type</code>
defines the first plot, the second character the second, etc.
Characters in <code>type</code> are cycled through; e.g., <code>"pl"</code>
alternately plots points and lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty,lwd,lend</code></td>
<td>
<p>vector of line types, widths, and end styles.
The first element is for the first column, the second element for
the second column, etc., even if lines are not plotted for all
columns. Line types will be used cyclically until all plots are
drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>character string or vector of 1-characters or integers for
plotting characters, see <code><a href="#points">points</a></code> for details.
The first character is the plotting-character for the first plot,
the second for the second, etc.  The default is the digits (1
through 9, 0) then the lowercase and uppercase letters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>vector of colors.  Colors are used cyclically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>vector of character expansion sizes, used cyclically.
This works as a multiple of <code><a href="#par">par</a>("cex")</code>.  <code>NULL</code> is
equivalent to <code>1.0</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>vector of background (fill) colors for the open plot
symbols given by <code>pch = 21:25</code> as in <code><a href="#points">points</a></code>.  The
default <code>NA</code> corresponds to the one of the underlying function
<code><a href="#plot.xy">plot.xy</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>titles for x and y axes, as in <code><a href="#plot.default">plot</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>ranges of x and y axes, as in <code><a href="#plot.default">plot</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, ...</code></td>
<td>
<p>Graphical parameters (see <code><a href="#par">par</a></code>) and any further
arguments of <code>plot</code>, typically <code><a href="#plot.default">plot.default</a></code>, may also be
supplied as arguments to this function; even <code>panel.first</code> etc
now work.  Hence, the high-level
graphics control arguments described under <code><a href="#par">par</a></code> and the
arguments to <code><a href="#title">title</a></code> may be supplied to this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical.  If <code>TRUE</code>, plots are added to current one,
using <code><a href="#points">points</a></code> and <code><a href="#lines">lines</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical.  If <code>TRUE</code>, write one line of what is
done.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>matplot(x,y, ..)</code> is basically a wrapper for
</p>

<ol>
<li>
<p> calling (the generic function) <code><a href="#plot.default">plot</a>(x[,1], y[,1], ..)</code>
for the first columns (only if <code>add = TRUE</code>).
</p>
</li>
<li>
<p> calling (the generic) <code><a href="#lines">lines</a>(x[,j], y[,j], ..)</code> for
subsequent columns.
</p>
</li>
</ol>
<p>Since <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> 4.0.0, care is taken to keep the <code><a href="https://r-universe.dev/manuals/base.html#class">class</a>(.)</code> of
<code>x</code> and <code>y</code>, such that the corresponding <code>plot()</code> and
<code>lines()</code> <em>methods</em> will be called.
</p>
<p>Points involving missing values are not plotted.
</p>
<p>The first column of <code>x</code> is plotted against the first column of
<code>y</code>, the second column of <code>x</code> against the second column of
<code>y</code>, etc.  If one matrix has fewer columns, plotting will cycle
back through the columns again.  (In particular, either <code>x</code> or
<code>y</code> may be a vector, against which all columns of the other
argument will be plotted.)
</p>
<p>The first element of <code>col, cex, lty, lwd</code> is used to plot the axes
as well as the first line.
</p>
<p>Because plotting symbols are drawn with lines and because these
functions may be changing the line style, you should probably specify
<code>lty = 1</code> when using plotting symbols.
</p>


<h3>Side Effects</h3>

<p>Function <code>matplot</code> generates a new plot;
<code>matpoints</code> and <code>matlines</code> add to the current one.</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.default">plot</a></code>, <code><a href="#points">points</a></code>, <code><a href="#lines">lines</a></code>,
<code><a href="https://r-universe.dev/manuals/base.html#matrix">matrix</a></code>, <code><a href="#par">par</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span>
matplot<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Quadratic"</span><span class="token punctuation">)</span> <span class="token comment"># almost identical to plot(*)</span>
sines <span class="token operator">&lt;-</span> outer<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> sin<span class="token punctuation">(</span>x <span class="token operator">/</span> <span class="token number">20</span> <span class="token operator">*</span> pi <span class="token operator">*</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>
matplot<span class="token punctuation">(</span>sines<span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"o"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> rainbow<span class="token punctuation">(</span>ncol<span class="token punctuation">(</span>sines<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
matplot<span class="token punctuation">(</span>sines<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">21</span><span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"matplot(...., pch = 21:23, bg = 2:5)"</span><span class="token punctuation">)</span>

x <span class="token operator">&lt;-</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">50</span><span class="token operator">/</span><span class="token number">50</span>
matplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> outer<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> k<span class="token punctuation">)</span> sin<span class="token punctuation">(</span>k<span class="token operator">*</span>pi <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"plobcsSh"</span><span class="token punctuation">,</span>
        main<span class="token operator">=</span> <span class="token string">"matplot(,type = \"plobcsSh\" )"</span><span class="token punctuation">)</span>
<span class="token comment">## pch &amp; type =  vector of 1-chars :</span>
matplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> outer<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> k<span class="token punctuation">)</span> sin<span class="token punctuation">(</span>k<span class="token operator">*</span>pi <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        pch <span class="token operator">=</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> type <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">,</span><span class="token string">"p"</span><span class="token punctuation">,</span><span class="token string">"o"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

lends <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"round"</span><span class="token punctuation">,</span><span class="token string">"butt"</span><span class="token punctuation">,</span><span class="token string">"square"</span><span class="token punctuation">)</span>
matplot<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"c"</span><span class="token punctuation">,</span> lty<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> lwd<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> lend<span class="token operator">=</span>lends<span class="token punctuation">)</span>
text<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">.4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lends<span class="token punctuation">,</span> col<span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">)</span>

table<span class="token punctuation">(</span>iris<span class="token operator">$</span>Species<span class="token punctuation">)</span> <span class="token comment"># is data.frame with 'Species' factor</span>
iS <span class="token operator">&lt;-</span> iris<span class="token operator">$</span>Species <span class="token operator">==</span> <span class="token string">"setosa"</span>
iV <span class="token operator">&lt;-</span> iris<span class="token operator">$</span>Species <span class="token operator">==</span> <span class="token string">"versicolor"</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>bg <span class="token operator">=</span> <span class="token string">"bisque"</span><span class="token punctuation">)</span>
matplot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span>  <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Length"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Width"</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"Petal and Sepal Dimensions in Iris Blossoms"</span><span class="token punctuation">)</span>
matpoints<span class="token punctuation">(</span>iris<span class="token punctuation">[</span>iS<span class="token punctuation">,</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris<span class="token punctuation">[</span>iS<span class="token punctuation">,</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token string">"sS"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
matpoints<span class="token punctuation">(</span>iris<span class="token punctuation">[</span>iV<span class="token punctuation">,</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris<span class="token punctuation">[</span>iV<span class="token punctuation">,</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token string">"vV"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
legend<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"    Setosa Petals"</span><span class="token punctuation">,</span> <span class="token string">"    Setosa Sepals"</span><span class="token punctuation">,</span>
               <span class="token string">"Versicolor Petals"</span><span class="token punctuation">,</span> <span class="token string">"Versicolor Sepals"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       pch <span class="token operator">=</span> <span class="token string">"sSvV"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

nam.var <span class="token operator">&lt;-</span> colnames<span class="token punctuation">(</span>iris<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span>
nam.spec <span class="token operator">&lt;-</span> as.character<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">50</span><span class="token operator">*</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"Species"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
iris.S <span class="token operator">&lt;-</span> array<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span> dim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                dimnames <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> nam.var<span class="token punctuation">,</span> nam.spec<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span> iris.S<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> data.matrix<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">50</span><span class="token operator">+</span><span class="token number">50</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

matplot<span class="token punctuation">(</span>iris.S<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token string">"Petal.Length"</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris.S<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token string">"Petal.Width"</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token string">"SCV"</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> rainbow<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        sub <span class="token operator">=</span> paste<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"V"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dimnames<span class="token punctuation">(</span>iris.S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    sep <span class="token operator">=</span> <span class="token string">"="</span><span class="token punctuation">,</span> collapse<span class="token operator">=</span> <span class="token string">",  "</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"Fisher's Iris Data"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## 'x' a "Date" vector :</span>
nd <span class="token operator">&lt;-</span> length<span class="token punctuation">(</span>dv <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span>as.Date<span class="token punctuation">(</span><span class="token string">"1959-02-21"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token string">"weeks"</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
mSC <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>I<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> sin<span class="token operator">=</span>sin<span class="token punctuation">(</span>pi<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>nd<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cos<span class="token operator">=</span>cos<span class="token punctuation">(</span>pi<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>nd<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
matplot<span class="token punctuation">(</span>dv<span class="token punctuation">,</span> mSC<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"matplot(&lt;Date&gt;, y)"</span><span class="token punctuation">)</span>

<span class="token comment">## 'x' a "POSIXct" date-time vector :</span>
ct <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span>c<span class="token punctuation">(</span>ISOdate<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> by <span class="token operator">=</span> <span class="token string">"15 mins"</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span>
matplot<span class="token punctuation">(</span>ct<span class="token punctuation">,</span> mSC<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"matplot(&lt;POSIXct&gt;, y)"</span><span class="token punctuation">)</span>
<span class="token comment">## or the same with even more axis flexibility:</span>
matplot<span class="token punctuation">(</span>ct<span class="token punctuation">,</span> mSC<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"matplot(&lt;POSIXct&gt;, y)"</span><span class="token punctuation">,</span> xaxt<span class="token operator">=</span><span class="token string">"n"</span><span class="token punctuation">)</span>
Axis<span class="token punctuation">(</span>ct<span class="token punctuation">,</span> side<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> ct<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## Also works for data frame columns:</span>
matplot<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="mosaicplot">

<a href="#mosaicplot" class="help-page-title"><h2>Mosaic Plots</h2></a>

<h3>Description</h3>

<p>Plots a mosaic on the current graphics device.</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">mosaicplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
mosaicplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> main <span class="token operator">=</span> deparse1<span class="token punctuation">(</span>substitute<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           sub <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
           sort <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> off <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> dir <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
           color <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> shade <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> margin <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
           cex.axis <span class="token operator">=</span> <span class="token number">0.66</span><span class="token punctuation">,</span> las <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"las"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
           type <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"pearson"</span><span class="token punctuation">,</span> <span class="token string">"deviance"</span><span class="token punctuation">,</span> <span class="token string">"FT"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
mosaicplot<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
           main <span class="token operator">=</span> deparse1<span class="token punctuation">(</span>substitute<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> subset<span class="token punctuation">,</span>
           na.action <span class="token operator">=</span> stats<span class="token operator">::</span>na.omit<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a contingency table in array form, with optional category
labels specified in the <code>dimnames(x)</code> attribute.  The table is
best created by the <code>table()</code> command.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>character string for the mosaic title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>character string for the mosaic sub-title (at bottom).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>x- and y-axis labels used for the plot; by default,
the first and second element of <code>names(dimnames(X))</code> (i.e., the
name of the first and second variable in <code>X</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>vector ordering of the variables, containing a permutation
of the integers <code>1:length(dim(x))</code> (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>off</code></td>
<td>
<p>vector of offsets to determine percentage spacing at each
level of the mosaic (appropriate values are between 0 and 20,
and the default is 20 times the number of splits for 2-dimensional
tables, and 10 otherwise).  Rescaled to maximally 50, and recycled if
necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>vector of split directions (<code>"v"</code> for vertical and
<code>"h"</code> for horizontal) for each level of the mosaic, one
direction for each dimension of the contingency table.  The
default consists of alternating directions, beginning with a
vertical split.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>logical or (recycling) vector of colors for color
shading, used only when <code>shade</code> is <code>FALSE</code>, or <code>NULL</code>
(default).  By default, grey boxes are drawn.  <code>color = TRUE</code>
uses <code><a href="https://r-universe.dev/manuals/grDevices.html#gray.colors">grey.colors</a></code> for a gamma-corrected grey palette.
<code>color = FALSE</code> gives empty boxes with no shading.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>
<p>a logical indicating whether to produce extended mosaic
plots, or a numeric vector of at most 5 distinct positive numbers
giving the absolute values of the cut points for the residuals.  By
default, <code>shade</code> is <code>FALSE</code>, and simple mosaics are
created.  Using <code>shade = TRUE</code> cuts absolute values at 2 and
4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>a list of vectors with the marginal totals to be fit in
the log-linear model.  By default, an independence model is fitted.
See <code><a href="https://r-universe.dev/manuals/stats.html#loglin">loglin</a></code> for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation,
as a multiple of <code>par("cex")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las</code></td>
<td>
<p>numeric; the style of axis labels, see <code><a href="#par">par</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>colour of borders of cells: see <code><a href="#polygon">polygon</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string indicating the type of residual to be
represented.  Must be one of <code>"pearson"</code> (giving components of
Pearson's <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></code>), <code>"deviance"</code> (giving
components of the likelihood ratio <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></code>), or
<code>"FT"</code> for the Freeman-Tukey residuals.  The value of this
argument can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula, such as <code>y ~ x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame (or list), or a contingency table from which
the variables in <code>formula</code> should be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
in the data frame to be used for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contains variables to be cross-tabulated, and these
variables contain <code>NA</code>s.  The default is to omit cases which
have an <code>NA</code> in any variable.  Since the tabulation will omit
all cases containing missing values, this will only be useful if the
<code>na.action</code> function replaces missing values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a generic function.  It currently has a default method
(<code>mosaicplot.default</code>) and a formula interface
(<code>mosaicplot.formula</code>).
</p>
<p>Extended mosaic displays visualize standardized residuals of a
loglinear model for the table by color and outline of the mosaic's
tiles.  (Standardized residuals are often referred to a standard
normal distribution.)  Cells representing negative residuals are drawn
in shaded of red and with broken borders; positive ones are drawn in
blue with solid borders.
</p>
<p>For the formula method, if <code>data</code> is an object inheriting from
class <code>"table"</code> or class <code>"ftable"</code> or an array with more
than 2 dimensions, it is taken as a contingency table, and hence all
entries should be non-negative.  In this case the left-hand side of
<code>formula</code> should be empty and the variables on the right-hand
side should be taken from the names of the dimnames attribute of the
contingency table.  A marginal table of these variables is computed,
and a mosaic plot of that table is produced.
</p>
<p>Otherwise, <code>data</code> should be a data frame or matrix, list or
environment containing the variables to be cross-tabulated.  In this
case, after possibly selecting a subset of the data as specified by
the <code>subset</code> argument, a contingency table is computed from the
variables given in <code>formula</code>, and a mosaic is produced from
this.
</p>
<p>See Emerson (1998) for more information and a case study with
television viewer data from Nielsen Media Research.
</p>
<p>Missing values are not supported except via an <code>na.action</code>
function when <code>data</code> contains variables to be cross-tabulated.
</p>
<p>A more flexible and extensible implementation of mosaic plots written
in the grid graphics system is provided in the function
<code><a>mosaic</a></code> in the contributed package <a href="https://CRAN.R-project.org/package=vcd" target="_blank"><span class="pkg">vcd</span></a>
(Meyer, Zeileis and Hornik, 2006).
</p>


<h3>Author(s)</h3>

<p>S-PLUS original by John Emerson <a href="mailto:john.emerson@yale.edu">john.emerson@yale.edu</a>.
Originally modified and enhanced for <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> by Kurt Hornik.
</p>


<h3>References</h3>

<p>Hartigan, J.A., and Kleiner, B. (1984).
A mosaic of television ratings.
<em>The American Statistician</em>, <b>38</b>, 32–35.
<a href="https://doi.org/10.2307/2683556" target="_blank">doi:10.2307/2683556</a>.
</p>
<p>Emerson, J. W. (1998).
Mosaic displays in S-PLUS: A general implementation and a case study.
<em>Statistical Computing and Graphics Newsletter (ASA)</em>,
<b>9</b>, 1, 17–23.
</p>
<p>Friendly, M. (1994).
Mosaic displays for multi-way contingency tables.
<em>Journal of the American Statistical Association</em>, <b>89</b>,
190–200.
<a href="https://doi.org/10.2307/2291215" target="_blank">doi:10.2307/2291215</a>.
</p>
<p>Meyer, D., Zeileis, A., and Hornik, K. (2006)  
The strucplot Framework: Visualizing Multi-Way Contingency Tables with
<span class="pkg">vcd</span>.
<em>Journal of Statistical Software</em>, <b>17(3)</b>, 1–48.
<a href="https://doi.org/10.18637/jss.v017.i03" target="_blank">doi:10.18637/jss.v017.i03</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#assocplot">assocplot</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#loglin">loglin</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
mosaicplot<span class="token punctuation">(</span>Titanic<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Survival on the Titanic"</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment">## Formula interface for tabulated data:</span>
mosaicplot<span class="token punctuation">(</span><span class="token operator">~</span> Sex <span class="token operator">+</span> Age <span class="token operator">+</span> Survived<span class="token punctuation">,</span> data <span class="token operator">=</span> Titanic<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

mosaicplot<span class="token punctuation">(</span>HairEyeColor<span class="token punctuation">,</span> shade <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment">## Independence model of hair and eye color and sex.  Indicates that</span>
<span class="token comment">## there are more blue eyed blonde females than expected in the case</span>
<span class="token comment">## of independence and too few brown eyed blonde females.</span>
<span class="token comment">## The corresponding model is:</span>
fm <span class="token operator">&lt;-</span> loglin<span class="token punctuation">(</span>HairEyeColor<span class="token punctuation">,</span> list<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pchisq<span class="token punctuation">(</span>fm<span class="token operator">$</span>pearson<span class="token punctuation">,</span> fm<span class="token operator">$</span>df<span class="token punctuation">,</span> lower.tail <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

mosaicplot<span class="token punctuation">(</span>HairEyeColor<span class="token punctuation">,</span> shade <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> margin <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## Model of joint independence of sex from hair and eye color.  Males</span>
<span class="token comment">## are underrepresented among people with brown hair and eyes, and are</span>
<span class="token comment">## overrepresented among people with brown hair and blue eyes.</span>
<span class="token comment">## The corresponding model is:</span>
fm <span class="token operator">&lt;-</span> loglin<span class="token punctuation">(</span>HairEyeColor<span class="token punctuation">,</span> list<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pchisq<span class="token punctuation">(</span>fm<span class="token operator">$</span>pearson<span class="token punctuation">,</span> fm<span class="token operator">$</span>df<span class="token punctuation">,</span> lower.tail <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment">## Formula interface for raw data: visualize cross-tabulation of numbers</span>
<span class="token comment">## of gears and carburettors in Motor Trend car data.</span>
mosaicplot<span class="token punctuation">(</span><span class="token operator">~</span> gear <span class="token operator">+</span> carb<span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> las <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># color recycling</span>
mosaicplot<span class="token punctuation">(</span><span class="token operator">~</span> gear <span class="token operator">+</span> carb<span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> las <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="mtext">

<a href="#mtext" class="help-page-title"><h2>Write Text into the Margins of a Plot</h2></a>

<h3>Description</h3>

<p>Text is written in one of the four margins of the current figure region
or one of the outer margins of the device region.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">mtext<span class="token punctuation">(</span>text<span class="token punctuation">,</span> side <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> outer <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
      adj <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> padj <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>a character or <a href="https://r-universe.dev/manuals/base.html#expression">expression</a> vector specifying
the <em>text</em> to be written.  Other objects are coerced by
<code><a href="https://r-universe.dev/manuals/grDevices.html#as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>on which side of the plot (1=bottom, 2=left, 3=top, 4=right).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>
<p>on which MARgin line, starting at 0 counting outwards.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer</code></td>
<td>
<p>use outer margins if available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>give location of each string in user coordinates.  If the
component of <code>at</code> corresponding to a particular text item is
not a finite value (the default), the location will be determined
by <code>adj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>adjustment for each string in reading direction.  For
strings parallel to the axes, <code>adj = 0</code> means left or bottom
alignment, and <code>adj = 1</code> means right or top alignment.
</p>
<p>If <code>adj</code> is not a finite value (the default), the value of
<code>par("las")</code> determines the adjustment.  For strings plotted
parallel to the axis the default is to centre the string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padj</code></td>
<td>
<p>adjustment for each string perpendicular to the reading
direction (which is controlled by <code>adj</code>).  For strings parallel
to the axes, <code>padj = 0</code> means right or top alignment,
and <code>padj = 1</code> means left or bottom alignment.
</p>
<p>If <code>padj</code> is not a finite value (the default), the value of
<code>par("las")</code> determines the adjustment.  For strings plotted
perpendicular to the axis the default is to centre the string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>character expansion factor.  <code>NULL</code> and <code>NA</code>
are equivalent to <code>1.0</code>.  This is an absolute measure, not
scaled by <code>par("cex")</code> or by setting <code>par("mfrow")</code>
or <code>par("mfcol")</code>.  Can be a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color to use.  Can be a vector.  <code>NA</code> values (the
default) mean use <code>par("col")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font</code></td>
<td>
<p>font for text.  Can be a vector.  <code>NA</code> values (the
default) mean use <code>par("font")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further graphical parameters (see <code><a href="#par">par</a></code>),
including <code>family</code>, <code>las</code> and <code>xpd</code>. (The latter
defaults to the figure region unless <code>outer = TRUE</code>, otherwise
the device region.  It can only be increased.)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The user coordinates in the outer margins always range from zero to
one, and are not affected by the user coordinates in the figure
region(s) — <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> differs here from other implementations of S.
</p>
<p>All of the named arguments can be vectors, and recycling will take
place to plot as many strings as the longest of the vector arguments.
</p>
<p>Note that a vector <code>adj</code> has a different meaning from
<code><a href="#text">text</a></code>.  <code>adj = 0.5</code> will centre the string, but for
<code>outer = TRUE</code> on the device region rather than the plot region.
</p>
<p>Parameter <code>las</code> will determine the orientation of the string(s).
For strings plotted perpendicular to the axis the default justification
is to place the end of the string nearest the axis on the specified
line.  (Note that this differs from S, which uses <code>srt</code> if
<code>at</code> is supplied and <code>las</code> if it is not.  Parameter
<code>srt</code> is ignored in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.)
</p>
<p>Note that if the text is to be plotted perpendicular to the axis,
<code>adj</code> determines the justification of the string <em>and</em> the
position along the axis unless <code>at</code> is specified.
</p>
<p>Graphics parameter <code>"ylbias"</code> (see <code><a href="#par">par</a></code>) determines
how the text baseline is placed relative to the nominal line.
</p>


<h3>Side Effects</h3>

<p>The given text is written onto the current plot.</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#title">title</a></code>, <code><a href="#text">text</a></code>, <code><a href="#plot.default">plot</a></code>,
<code><a href="#par">par</a></code>;
<code><a href="https://r-universe.dev/manuals/grDevices.html#plotmath">plotmath</a></code> for details on mathematical annotation.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Parabola Points"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"xlab"</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"10 of them"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>s <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>
    mtext<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"mtext(..., line= -1, {side, col, font} = "</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span>
          <span class="token string">", cex = "</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>s<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
          side <span class="token operator">=</span> s<span class="token punctuation">,</span> col <span class="token operator">=</span> s<span class="token punctuation">,</span> font <span class="token operator">=</span> s<span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>s<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"mtext(..., line= -2)"</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"mtext(..., line= -2, adj = 0)"</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">##--- log axis :</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> exp<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"log =\"y\""</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"xlab"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>s <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> mtext<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"mtext(...,side="</span><span class="token punctuation">,</span> s <span class="token punctuation">,</span><span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> side <span class="token operator">=</span> s<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pairs">

<a href="#pairs" class="help-page-title"><h2>Scatterplot Matrices</h2></a>

<h3>Description</h3>

<p>A matrix of scatterplots is produced.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pairs<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
pairs<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> subset<span class="token punctuation">,</span>
      na.action <span class="token operator">=</span> stats<span class="token operator">::</span>na.pass<span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
pairs<span class="token punctuation">(</span>x<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> panel <span class="token operator">=</span> points<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
      horInd <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>nc<span class="token punctuation">,</span> verInd <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>nc<span class="token punctuation">,</span>
      lower.panel <span class="token operator">=</span> panel<span class="token punctuation">,</span> upper.panel <span class="token operator">=</span> panel<span class="token punctuation">,</span>
      diag.panel <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> text.panel <span class="token operator">=</span> textPanel<span class="token punctuation">,</span>
      label.pos <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">+</span> has.diag<span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> line.main <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
      cex.labels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> font.labels <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
      row1attop <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> gap <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
      horOdd <span class="token operator">=</span> <span class="token operator">!</span>row1attop<span class="token punctuation">,</span> verOdd <span class="token operator">=</span> <span class="token operator">!</span>row1attop<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the coordinates of points given as numeric columns of a
matrix or data frame.  Logical and factor columns are converted to
numeric in the same way that <code><a href="https://r-universe.dev/manuals/base.html#data.matrix">data.matrix</a></code> does.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula, such as <code>~ x + y + z</code>.  Each term will
give a separate variable in the pairs plot, so terms should be
numeric vectors.  (A response will be interpreted as another
variable, but not treated specially, so it is confusing to use one.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>formula</code> should be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is to pass missing
values on to the panel functions, but <code>na.action = na.omit</code>
will cause cases with missing values in any of the variables to be
omitted entirely.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>the names of the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p><code>function(x, y, ...)</code> which is used to plot
the contents of each panel of the display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>arguments to be passed to or from methods.
</p>
<p>Also, <a href="#par">graphical parameters</a> can be given as can arguments to
<code>plot</code> such as <code>main</code>.  <code>par("oma")</code> will be set
appropriately unless specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horInd, verInd</code></td>
<td>
<p>The (numerical) indices of the variables to be
plotted on the horizontal and vertical axes respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.panel, upper.panel</code></td>
<td>
<p>separate panel functions (or
<code>NULL</code>) to be used below and above the diagonal respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag.panel</code></td>
<td>
<p>optional <code>function(x, ...)</code> to be
applied on the diagonals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.panel</code></td>
<td>
<p>optional <code>function(x, y, labels, cex,
      font, ...)</code> to be applied on the diagonals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.pos</code></td>
<td>
<p><code>y</code> position of labels in the text panel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.main</code></td>
<td>
<p>if <code>main</code> is specified, <code>line.main</code> gives
the <code>line</code> argument to <code><a href="#mtext">mtext</a>()</code> which draws the
title.  You may want to specify <code>oma</code> when changing <code>line.main</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.labels, font.labels</code></td>
<td>
<p>graphics parameters for the text panel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row1attop</code></td>
<td>
<p>logical.  Should the layout be matrix-like with row 1
at the top, or graph-like with row 1 at the bottom?  The latter (non
default) leads to a basically symmetric scatterplot matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap</code></td>
<td>
<p>distance between subplots, in margin lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>a character string indicating if logarithmic axes are to be
used, see <code><a href="#plot.default">plot.default</a></code> <em>or</em> a numeric vector of
indices specifying the indices of those variables where logarithmic
axes should be used for both x and y.  <code>log = "xy"</code> specifies
logarithmic axes for all variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horOdd, verOdd</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> (or integer) determining
how the horizontal and vertical axis labeling happens.  If true, the
axis labelling starts at the first (from top left) row or column,
respectively.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>j</mi></mrow><annotation encoding="application/x-tex">ij</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">ij</span></span></span></span></code>th scatterplot contains <code>x[,i]</code> plotted against
<code>x[,j]</code>.  The scatterplot can be customised by setting panel
functions to appear as something completely different. The
off-diagonal panel functions are passed the appropriate columns of
<code>x</code> as <code>x</code> and <code>y</code>: the diagonal panel function (if
any) is passed a single column, and the <code>text.panel</code> function is
passed a single <code>(x, y)</code> location and the column name.
Setting some of these panel functions to <code><a href="https://r-universe.dev/manuals/base.html#NULL">NULL</a></code> is
equivalent to <em>not</em> drawing anything there.
</p>
<p>The <a href="#par">graphical parameters</a> <code>pch</code> and <code>col</code> can be used
to specify a vector of plotting symbols and colors to be used in the
plots.
</p>
<p>The <a href="#par">graphical parameter</a> <code>oma</code> will be set by
<code>pairs.default</code> unless supplied as an argument.
</p>
<p>A panel function should not attempt to start a new plot, but just plot
within a given coordinate system: thus <code>plot</code> and <code>boxplot</code>
are not panel functions.
</p>
<p>By default, missing values are passed to the panel functions and will
often be ignored within a panel.  However, for the formula method and
<code>na.action = na.omit</code>, all cases which contain a missing values for
any of the variables are omitted completely (including when the scales
are selected).
</p>
<p>Arguments <code>horInd</code> and <code>verInd</code> were introduced in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>
3.2.0. If given the same value they can be used to select or re-order
variables: with different ranges of consecutive values they can be
used to plot rectangular windows of a full pairs plot; in the latter
case ‘diagonal’ refers to the diagonal of the full plot.
</p>


<h3>Author(s)</h3>

<p>Enhancements for <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> 1.0.0 contributed by Dr. Jens
Oehlschlägel-Akiyoshi and R-core members.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pairs<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Anderson's Iris Data -- 3 species"</span><span class="token punctuation">,</span>
      pch <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"green3"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">[</span>unclass<span class="token punctuation">(</span>iris<span class="token operator">$</span>Species<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## formula method, "graph" layout (row 1 at bottom):</span>
pairs<span class="token punctuation">(</span><span class="token operator">~</span> Fertility <span class="token operator">+</span> Education <span class="token operator">+</span> Catholic<span class="token punctuation">,</span> data <span class="token operator">=</span> swiss<span class="token punctuation">,</span> row1attop<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      subset <span class="token operator">=</span> Education <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Swiss data, Education &lt; 20"</span><span class="token punctuation">)</span>

pairs<span class="token punctuation">(</span>USJudgeRatings<span class="token punctuation">,</span> gap<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># (gap: not wasting plotting area)</span>
<span class="token comment">## show only lower triangle (and suppress labeling for whatever reason):</span>
pairs<span class="token punctuation">(</span>USJudgeRatings<span class="token punctuation">,</span> text.panel <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> upper.panel <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>

<span class="token comment">## put histograms on the diagonal</span>
panel.hist <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    usr <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span><span class="token string">"usr"</span><span class="token punctuation">)</span>
    par<span class="token punctuation">(</span>usr <span class="token operator">=</span> c<span class="token punctuation">(</span>usr<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    h <span class="token operator">&lt;-</span> hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
    breaks <span class="token operator">&lt;-</span> h<span class="token operator">$</span>breaks<span class="token punctuation">;</span> nB <span class="token operator">&lt;-</span> length<span class="token punctuation">(</span>breaks<span class="token punctuation">)</span>
    y <span class="token operator">&lt;-</span> h<span class="token operator">$</span>counts<span class="token punctuation">;</span> y <span class="token operator">&lt;-</span> y<span class="token operator">/</span>max<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
    rect<span class="token punctuation">(</span>breaks<span class="token punctuation">[</span><span class="token operator">-</span>nB<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> breaks<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"cyan"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
pairs<span class="token punctuation">(</span>USJudgeRatings<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> panel <span class="token operator">=</span> panel.smooth<span class="token punctuation">,</span>
      cex <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"light blue"</span><span class="token punctuation">,</span> horOdd<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span>
      diag.panel <span class="token operator">=</span> panel.hist<span class="token punctuation">,</span> cex.labels <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> font.labels <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">## put (absolute) correlations on the upper panels,</span>
<span class="token comment">## with size proportional to the correlations.</span>
panel.cor <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> prefix <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> cex.cor<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    par<span class="token punctuation">(</span>usr <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    r <span class="token operator">&lt;-</span> abs<span class="token punctuation">(</span>cor<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>
    txt <span class="token operator">&lt;-</span> format<span class="token punctuation">(</span>c<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">0.123456789</span><span class="token punctuation">)</span><span class="token punctuation">,</span> digits <span class="token operator">=</span> digits<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    txt <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span>prefix<span class="token punctuation">,</span> txt<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>missing<span class="token punctuation">(</span>cex.cor<span class="token punctuation">)</span><span class="token punctuation">)</span> cex.cor <span class="token operator">&lt;-</span> <span class="token number">0.8</span><span class="token operator">/</span>strwidth<span class="token punctuation">(</span>txt<span class="token punctuation">)</span>
    text<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> txt<span class="token punctuation">,</span> cex <span class="token operator">=</span> cex.cor <span class="token operator">*</span> r<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
pairs<span class="token punctuation">(</span>USJudgeRatings<span class="token punctuation">,</span> lower.panel <span class="token operator">=</span> panel.smooth<span class="token punctuation">,</span> upper.panel <span class="token operator">=</span> panel.cor<span class="token punctuation">,</span>
      gap<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> row1attop<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>

pairs<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"xy"</span><span class="token punctuation">)</span> <span class="token comment"># plot all variables on log scale</span>
pairs<span class="token punctuation">(</span>iris<span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment"># log the first four</span>
      main <span class="token operator">=</span> <span class="token string">"Lengths and Widths in [log]"</span><span class="token punctuation">,</span> line.main<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">,</span> oma<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="panel.smooth">

<a href="#panel.smooth" class="help-page-title"><h2>Simple Panel Plot</h2></a>

<h3>Description</h3>

<p>An example of a simple useful <code>panel</code> function to be used as
argument in e.g., <code><a href="#coplot">coplot</a></code> or <code><a href="#pairs">pairs</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">panel.smooth<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"col"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"pch"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             cex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> col.smooth <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> span <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> iter <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
             <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>numeric vectors of the same length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, bg, pch, cex</code></td>
<td>
<p>numeric or character codes for the color(s),
point type and size of <code><a href="#points">points</a></code>; see also
<code><a href="#par">par</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.smooth</code></td>
<td>
<p>color to be used by <code>lines</code> for drawing the
smooths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>smoothing parameter <code>f</code> for <code><a href="https://r-universe.dev/manuals/stats.html#lowess">lowess</a></code>, see
there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of robustness iterations for <code><a href="https://r-universe.dev/manuals/stats.html#lowess">lowess</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to <code><a href="#lines">lines</a></code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#coplot">coplot</a></code> and <code><a href="#pairs">pairs</a></code> where <code>panel.smooth</code>
is typically used;
<code><a href="https://r-universe.dev/manuals/stats.html#lowess">lowess</a></code> which does the smoothing.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">pairs<span class="token punctuation">(</span>swiss<span class="token punctuation">,</span> panel <span class="token operator">=</span> panel.smooth<span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">)</span>  <span class="token comment"># emphasize the smooths</span>
pairs<span class="token punctuation">(</span>swiss<span class="token punctuation">,</span> panel <span class="token operator">=</span> panel.smooth<span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment"># hmm...</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="par">

<a href="#par" class="help-page-title"><h2>Set or Query Graphical Parameters</h2></a>

<h3>Description</h3>

<p><code>par</code> can be used to set or query graphical parameters.
Parameters can be set by specifying them as arguments to <code>par</code> in
<code>tag = value</code> form, or by passing them as a list of tagged
values.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">par<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">,</span> no.readonly <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span>highlevel plot<span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token ellipsis">...</span>.<span class="token punctuation">,</span> <span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments in <code>tag = value</code> form, a single list of tagged
values, or character vectors of parameter names. Supported parameters are
described in the ‘Graphical Parameters’ section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.readonly</code></td>
<td>
<p>logical; if <code>TRUE</code> and there are no other
arguments, only parameters are returned which can be set by a
subsequent <code>par()</code> call <em>on the same device</em>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each device has its own set of graphical parameters.  If the current
device is the null device, <code>par</code> will open a new device before
querying/setting parameters.  (What device is controlled by
<code><a href="https://r-universe.dev/manuals/base.html#options">options</a>("device")</code>.)
</p>
<p>Parameters are queried by giving one or more character vectors of
parameter names to <code>par</code>.
</p>
<p><code>par()</code> (no arguments) or <code>par(no.readonly = TRUE)</code> is used to
get <em>all</em> the graphical parameters (as a named list).  Their
names are currently taken from the unexported variable
<code>graphics:::.Pars</code>.
</p>
<p><em><b>R.O.</b></em> indicates <em><b>read-only arguments</b></em>: These
may only be used in queries and cannot be set.  (<code>"cin"</code>,
<code>"cra"</code>, <code>"csi"</code>, <code>"cxy"</code>, <code>"din"</code> and
<code>"page"</code> are always read-only.)
</p>
<p>Several parameters can only be set by a call to <code>par()</code>:
</p>

<ul>
<li> <p><code>"ask"</code>,
</p>
</li>
<li> <p><code>"fig"</code>, <code>"fin"</code>,
</p>
</li>
<li> <p><code>"lheight"</code>,
</p>
</li>
<li> <p><code>"mai"</code>, <code>"mar"</code>, <code>"mex"</code>,
<code>"mfcol"</code>, <code>"mfrow"</code>, <code>"mfg"</code>,
</p>
</li>
<li> <p><code>"new"</code>,
</p>
</li>
<li> <p><code>"oma"</code>, <code>"omd"</code>, <code>"omi"</code>,
</p>
</li>
<li> <p><code>"pin"</code>, <code>"plt"</code>, <code>"ps"</code>, <code>"pty"</code>,
</p>
</li>
<li> <p><code>"usr"</code>,
</p>
</li>
<li> <p><code>"xlog"</code>, <code>"ylog"</code>,
</p>
</li>
<li> <p><code>"ylbias"</code>
</p>
</li>
</ul>
<p>The remaining parameters can also be set as arguments (often via
<code>...</code>) to high-level plot functions such as
<code><a href="#plot.default">plot.default</a></code>, <code><a href="#plot.window">plot.window</a></code>,
<code><a href="#points">points</a></code>, <code><a href="#lines">lines</a></code>, <code><a href="#abline">abline</a></code>,
<code><a href="#axis">axis</a></code>, <code><a href="#title">title</a></code>, <code><a href="#text">text</a></code>,
<code><a href="#mtext">mtext</a></code>, <code><a href="#segments">segments</a></code>, <code><a href="#symbols">symbols</a></code>,
<code><a href="#arrows">arrows</a></code>, <code><a href="#polygon">polygon</a></code>, <code><a href="#rect">rect</a></code>,
<code><a href="#box">box</a></code>, <code><a href="#contour">contour</a></code>, <code><a href="#filled.contour">filled.contour</a></code>
and <code><a href="#image">image</a></code>.  Such settings will be active during the
execution of the function, only.  However, see the comments on
<code>bg</code>, <code>cex</code>, <code>col</code>, <code>lty</code>, <code>lwd</code> and
<code>pch</code> which may be taken as <em>arguments</em> to certain plot
functions rather than as graphical parameters.
</p>
<p>The meaning of ‘character size’ is not well-defined: this is
set up for the device taking <code>pointsize</code> into account but often
not the actual font family in use.  Internally the corresponding pars
(<code>cra</code>, <code>cin</code>, <code>cxy</code> and <code>csi</code>) are used only to
set the inter-line spacing used to convert <code>mar</code> and <code>oma</code>
to physical margins.  (The same inter-line spacing multiplied by
<code>lheight</code> is used for multi-line strings in <code>text</code> and
<code>strheight</code>.)
</p>
<p>Note that graphical parameters are suggestions: plotting functions and
devices need not make use of them (and this is particularly true of
non-default methods for e.g. <code>plot</code>).
</p>


<h3>Value</h3>

<p>When parameters are set, their previous values are returned in an
invisible named list.  Such a list can be passed as an argument to
<code>par</code> to restore the parameter values.  Use <code>par(no.readonly
  = TRUE)</code> for the full list of parameters that can be restored.
However, restoring all of these is not wise: see the ‘Note’
section.
</p>
<p>When just one parameter is queried, the value of that parameter
is returned as (atomic) vector.  When two or more parameters are
queried, their values are returned in a list, with the list names
giving the parameters.
</p>
<p>Note the inconsistency: setting one parameter returns a list, but
querying one parameter returns a vector.
</p>


<h3>Graphical Parameters</h3>


<dl>
<dt><code>adj</code></dt>
<dd>
<p>The value of <code>adj</code> determines the way in
which text strings are justified in <code><a href="#text">text</a></code>,
<code><a href="#mtext">mtext</a></code> and <code><a href="#title">title</a></code>.  A value of <code>0</code> produces
left-justified text, <code>0.5</code> (the default) centered text and <code>1</code>
right-justified text.  (Any value in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code> is allowed, and
on most devices values outside that interval will also work.)
</p>
<p>Note that the <code>adj</code> <em>argument</em> of <code><a href="#text">text</a></code> also
allows <code>adj = c(x, y)</code> for different adjustment in x- and y-
directions.  Note that whereas for <code>text</code> it refers to
positioning of text about a point, for <code>mtext</code> and
<code>title</code> it controls placement within the plot or device region.</p>
</dd>
<dt><code>ann</code></dt>
<dd>
<p>If set to <code>FALSE</code>, high-level plotting
functions calling <code><a href="#plot.default">plot.default</a></code> do not annotate the
plots they produce with axis titles and overall titles.  The
default is to do annotation.</p>
</dd>
<dt><code>ask</code></dt>
<dd>
<p>logical.  If <code>TRUE</code> (and the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> session is
interactive) the user is asked for input, before a new figure is
drawn.  As this applies to the device, it also affects output by
packages <span class="pkg">grid</span> and <a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a>.  It can be set even on
non-screen devices but may have no effect there.
</p>
<p>This not really a graphics parameter, and its use is deprecated in
favour of <code><a href="https://r-universe.dev/manuals/grDevices.html#devAskNewPage">devAskNewPage</a></code>.
</p>
</dd>
<dt><code>bg</code></dt>
<dd>
<p>The color to be used for the background of the
device region.  When called from <code>par()</code> it also sets
<code>new = FALSE</code>. See section ‘Color Specification’ for
suitable values.  For many devices the initial value is set from
the <code>bg</code> argument of the device, and for the rest it is
normally <code>"white"</code>.
</p>
<p>Note that some graphics functions such as
<code><a href="#plot.default">plot.default</a></code> and <code><a href="#points">points</a></code> have an
<em>argument</em> of this name with a different meaning.</p>
</dd>
<dt><code>bty</code></dt>
<dd>
<p>A character string which determined the type of
<code><a href="#box">box</a></code> which is drawn about plots.  If <code>bty</code> is
one of <code>"o"</code> (the default), <code>"l"</code>, <code>"7"</code>,
<code>"c"</code>, <code>"u"</code>, or <code>"]"</code> the resulting box resembles
the corresponding upper case letter.  A value of <code>"n"</code>
suppresses the box.</p>
</dd>
<dt><code>cex</code></dt>
<dd>
<p>A numerical value giving the amount by which
plotting text and symbols should be magnified relative to the
default.  This starts as <code>1</code> when a device is opened, and is
reset when the layout is changed, e.g. by setting <code>mfrow</code>.
</p>
<p>Note that some graphics functions such as
<code><a href="#plot.default">plot.default</a></code> have an <em>argument</em> of this name
which <em>multiplies</em> this graphical parameter, and some
functions such as <code><a href="#points">points</a></code> and <code><a href="#text">text</a></code>
accept a vector of values which are recycled.
</p>
</dd>
<dt><code>cex.axis</code></dt>
<dd>
<p>The magnification to be used for axis
annotation relative to the current setting of <code>cex</code>.</p>
</dd>
<dt><code>cex.lab</code></dt>
<dd>
<p>The magnification to be used for x and y
labels relative to the current setting of <code>cex</code>.</p>
</dd>
<dt><code>cex.main</code></dt>
<dd>
<p>The magnification to be used for main titles
relative to the current setting of <code>cex</code>.</p>
</dd>
<dt><code>cex.sub</code></dt>
<dd>
<p>The magnification to be used for sub-titles
relative to the current setting of <code>cex</code>.</p>
</dd>
<dt><code>cin</code></dt>
<dd>
<p><em><b>R.O.</b></em>; character size
<code>(width, height)</code> in inches.  These are the same measurements
as <code>cra</code>, expressed in different units.</p>
</dd>
<dt><code>col</code></dt>
<dd>
<p>A specification for the default plotting color.  See
section ‘Color Specification’.
</p>
<p>Some functions such as <code><a href="#lines">lines</a></code> and <code><a href="#text">text</a></code>
accept a vector of values which are recycled and may be
interpreted slightly differently.
</p>
</dd>
<dt><code>col.axis</code></dt>
<dd>
<p>The color to be used for axis
annotation.  Defaults to <code>"black"</code>.</p>
</dd>
<dt><code>col.lab</code></dt>
<dd>
<p>The color to be used for x and y labels.
Defaults to <code>"black"</code>.</p>
</dd>
<dt><code>col.main</code></dt>
<dd>
<p>The color to be used for plot main titles.
Defaults to <code>"black"</code>.</p>
</dd>
<dt><code>col.sub</code></dt>
<dd>
<p>The color to be used for plot sub-titles.
Defaults to <code>"black"</code>.</p>
</dd>
<dt><code>cra</code></dt>
<dd>
<p><em><b>R.O.</b></em>; size of default character
<code>(width, height)</code> in ‘rasters’ (pixels).  Some devices
have no concept of pixels and so assume an arbitrary pixel size,
usually 1/72 inch.  These are the same measurements
as <code>cin</code>, expressed in different units.</p>
</dd>
<dt><code>crt</code></dt>
<dd>
<p>A numerical value specifying (in degrees) how
single characters should be rotated.  It is unwise to expect
values other than multiples of 90 to work.  Compare with
<code>srt</code> which does string rotation.</p>
</dd>
<dt><code>csi</code></dt>
<dd>
<p><em><b>R.O.</b></em>; height of (default-sized)
characters in inches.  The same as <code>par("cin")[2]</code>.</p>
</dd>
<dt><code>cxy</code></dt>
<dd>
<p><em><b>R.O.</b></em>; size of default character
<code>(width, height)</code> in user coordinate units.
<code>par("cxy")</code> is <code>par("cin")/par("pin")</code> scaled to user
coordinates.
Note that <code>c(<a href="#strwidth">strwidth</a>(ch), <a href="#strwidth">strheight</a>(ch))</code> for
a given string <code>ch</code> is usually much more precise.</p>
</dd>
<dt><code>din</code></dt>
<dd>
<p><em><b>R.O.</b></em>; the device dimensions,
<code>(width, height)</code>, in inches.  See also
<code><a href="https://r-universe.dev/manuals/grDevices.html#dev.size">dev.size</a></code>, which is updated immediately when an
on-screen device windows is re-sized.</p>
</dd>
<dt><code>err</code></dt>
<dd>
<p>(<em>Unimplemented</em>; <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> is silent when points
outside the plot region are <em>not</em> plotted.)
The degree of error reporting desired.</p>
</dd>
<dt><code>family</code></dt>
<dd>
<p>The name of a font family for drawing text.
The maximum allowed length is 200 bytes.
This name gets mapped by each graphics device to a device-specific
font description.  The default value is <code>""</code> which means that
the default device fonts will be used (and what those are should
be listed on the help page for the device).  Standard values are
<code>"serif"</code>, <code>"sans"</code> and <code>"mono"</code>, and the
<a href="https://r-universe.dev/manuals/grDevices.html#Hershey">Hershey</a> font families are also available.  (Devices may
define others, and some devices will ignore this setting
completely.  Names starting with <code>"Hershey"</code> are treated
specially and should only be used for the built-in Hershey font
families.)  This can be specified inline for <code><a href="#text">text</a></code>.</p>
</dd>
<dt><code>fg</code></dt>
<dd>
<p>The color to be used for the foreground of plots.
This is the default color used for things like axes and boxes
around plots.  When called from <code>par()</code> this also sets
parameter <code>col</code> to the same value.  See section ‘Color
Specification’.  A few devices have an argument to set the
initial value, which is otherwise <code>"black"</code>.</p>
</dd>
<dt><code>fig</code></dt>
<dd>
<p>A numerical vector of the form <code>c(x1, x2, y1,
        y2)</code> which gives the (NDC) coordinates of the figure region in
the display region of the device. If you set this, unlike S, you
start a new plot, so to add to an existing plot use
<code>new = TRUE</code> as well.</p>
</dd>
<dt><code>fin</code></dt>
<dd>
<p>The figure region dimensions,
<code>(width, height)</code>, in inches. If you set this, unlike S, you
start a new plot.</p>
</dd>
<dt><code>font</code></dt>
<dd>
<p>An integer which specifies which font to use for
text.  If possible, device drivers arrange so that 1 corresponds
to plain text (the default), 2 to bold face, 3 to italic and 4 to
bold italic.  Also, font 5 is expected to be the symbol font, in
Adobe symbol encoding.  On some devices font families can be
selected by <code>family</code> to choose different sets of 5 fonts.</p>
</dd>
<dt><code>font.axis</code></dt>
<dd>
<p>The font to be used for axis annotation.</p>
</dd>
<dt><code>font.lab</code></dt>
<dd>
<p>The font to be used for x and y labels.</p>
</dd>
<dt><code>font.main</code></dt>
<dd>
<p>The font to be used for plot main titles.</p>
</dd>
<dt><code>font.sub</code></dt>
<dd>
<p>The font to be used for plot sub-titles.</p>
</dd>
<dt><code>lab</code></dt>
<dd>
<p>A numerical vector of the form <code>c(x, y, len)</code>
which modifies the default way that axes are annotated.  The values of
<code>x</code> and <code>y</code> give the (approximate) number of tickmarks
on the x and y axes and <code>len</code> specifies the label length.  The
default is <code>c(5, 5, 7)</code>. 
<code>len</code> <em>is unimplemented</em> in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.</p>
</dd>
<dt><code>las</code></dt>
<dd>
<p>numeric in {0,1,2,3}; the style of axis labels.
</p>

<dl>
<dt>0:</dt>
<dd>
<p>always parallel to the axis [<em>default</em>],</p>
</dd>
<dt>1:</dt>
<dd>
<p>always horizontal,</p>
</dd>
<dt>2:</dt>
<dd>
<p>always perpendicular to the axis,</p>
</dd>
<dt>3:</dt>
<dd>
<p>always vertical.</p>
</dd>
</dl>
<p>Also supported by <code><a href="#mtext">mtext</a></code>.  Note that
string/character rotation <em>via</em> argument <code>srt</code> to <code>par</code>
does <em>not</em> affect the axis labels.
</p>
</dd>
<dt><code>lend</code></dt>
<dd>
<p>The line end style.  This can be specified as an
integer or string:
</p>

<dl>
<dt><code>0</code></dt>
<dd>
<p>and <code>"round"</code> mean rounded line caps
[<em>default</em>];</p>
</dd>
<dt><code>1</code></dt>
<dd>
<p>and <code>"butt"</code> mean butt line caps;</p>
</dd>
<dt><code>2</code></dt>
<dd>
<p>and <code>"square"</code> mean square line caps.</p>
</dd>
</dl>
</dd>
<dt><code>lheight</code></dt>
<dd>
<p>The line height multiplier.
The height of a line of text (used to vertically space
multi-line text) is found by multiplying the character height
both by the current character expansion and by the
line height multiplier.  Default value is 1.  Used in
<code><a href="#text">text</a></code> and <code><a href="#strwidth">strheight</a></code>.</p>
</dd>
<dt><code>ljoin</code></dt>
<dd>
<p>The line join style.
This can be specified as an integer or string:
</p>

<dl>
<dt><code>0</code></dt>
<dd>
<p>and <code>"round"</code> mean rounded line joins
[<em>default</em>];</p>
</dd>
<dt><code>1</code></dt>
<dd>
<p>and <code>"mitre"</code> mean mitred line joins;</p>
</dd>
<dt><code>2</code></dt>
<dd>
<p>and <code>"bevel"</code> mean bevelled line joins.</p>
</dd>
</dl>
</dd>
<dt><code>lmitre</code></dt>
<dd>
<p>The line mitre limit.  This controls when
mitred line joins are automatically converted into bevelled line
joins.  The value must be larger than 1 and the default is 10.
Not all devices will honour this setting.</p>
</dd>
<dt><code>lty</code></dt>
<dd>
<p>The line type.
Line types can either be specified as an integer (0=blank, 1=solid
(default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash)
or as one of the character strings <code>"blank"</code>, <code>"solid"</code>,
<code>"dashed"</code>, <code>"dotted"</code>, <code>"dotdash"</code>,
<code>"longdash"</code>, or <code>"twodash"</code>, where <code>"blank"</code> uses
‘invisible lines’ (i.e., does not draw them).
</p>
<p>Alternatively, a string of up to 8 characters (from <code>c(1:9,
        "A":"F")</code>) may be given, giving the length of line segments
which are alternatively drawn and skipped.  See section
‘Line Type Specification’.
</p>
<p>Functions such as <code><a href="#lines">lines</a></code> and <code><a href="#segments">segments</a></code>
accept a vector of values which are recycled.
</p>
</dd>
<dt><code>lwd</code></dt>
<dd>
<p>The line width, a <em>positive</em> number,
defaulting to <code>1</code>.  The interpretation is device-specific,
and some devices do not implement line widths less than one.
(See the help on the device for details of the interpretation.)
</p>
<p>Functions such as <code><a href="#lines">lines</a></code> and <code><a href="#segments">segments</a></code>
accept a vector of values which are recycled: in such uses lines
corresponding to values <code>NA</code> or <code>NaN</code> are omitted.  The
interpretation of <code>0</code> is device-specific.
</p>
</dd>
<dt><code>mai</code></dt>
<dd>
<p>A numerical vector of the form <code>c(bottom,
        left, top, right)</code> which gives the margin size specified in
inches.<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAAAAACbDccAAAAACXBIWXMAABcSAAAXEgFnn9JSAAAR7ElEQVR4nO3d6XLzIBKF4WZqbkzfhQ+XxvzQhjZv0RHQvE9V4lhxHMc5bhDCyAwQCJZKPwQ4FP5T+hHAJ4IFCYIFCYIFCYIFCYIFCYIFCYIFCYIFCYIFCYIFCYIFCYIFCYIFCYIFCYIFCYIFCYIFif8W+80xvzLsrv7+zdbuyCsqFiR4MwUUeDMFNAgWJAgWJAgWJAgWJAgWJAgWJAgWJAgWJAgWJAgWJAgWJJg2U/iOvKJiQYJpM1Bg2gw0CBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkmDZT+I68omJBgmkzUGDaDDTK9bFwn2A2tTzB5i/XbUUQLE/CfFG+f0OwfEj5ZbCQLM0xK4M+liNzpSpfr6hYFQtT0Ul5z8nm9i5lt6khSHtUrJqF8VNYr+wvLGQNXqooYVSsioWxWoWpaoVkNl2Zr5mdNXw11DAqVs3S7mPZmCVnn6EQasgVFatmZzVpn5nTDFUQLYLVolcDCen1t59CsFrzQWqShVC6ZDFtpvAdfWs+UlNDVXqFitWW8Gr4s4Ku1aKmx4KNkA2CLpfL/ytMdSvZ4eJw2wKYNtOoi5YwvPzukwhWa8Ly6SCt3y3eDtHHakuaDvCkbOj9+N3yuaJitWaev3AenbS5KInOuwfn/0U67/CHYEGCzrsPx2av8JADFQsSdN6hQOcdGgQLEkybKXxHXlGxIEHnHQp03qFBsCBBsCBBsCBBsCBBsCBBsCBBsCBBsCBBsCBBsCBBsCDBtJnCd+QVFQsSTJuBAtNmoEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIEGwIFH4XDrzCV/S1YbljDD7DfzEhz9R6F1YVCxI8L5C30r9f4u9rzBUcKJ1CNEUQoITYfpWrKNDxYKEuGJNa/b4Xa0HF7TBisP2Et2gKYQEwYIEwYKEeGSWznunwuND/svaroTNs4cO6cT3N4FEsUNnpQ5SRirWI7o7CA3n9CPvQ6Q/1SH9yPv8ga7QFEKi1LSZf8xc9U1fsWgFuyQfeR/OhxaYa+/b8yPv8y8mWK4xjgUNggUJggUJggWJUuNY/yv0e/EQKhYkWnjDajalKI3Xbxiq6GS8o9if2VjFupy2xloQlWmhYuULPoW7XoBd1KuC2qpYpKEZbVSsC8uKdcG2vYlgab6+WdUumM3fCSfr3o0/ZgT4Bg0Ha+pVnTeO4eQ2Id90cS/hxX3iC+0GK8zFKqS1PmXS7jbrlat7sbmO3diV61YLsxvyVivtPu+vzbfbDkxsGr/xm+H0Fpv79IB36bwUJvmm+RlLp2MQ6XCb7Mr1vXjJU3mNNYX8479U7AlrI1g/Pz0Mm5bSRlOI5rRRsX5G01lKJxWLQ4lPazZYy87gix3q7Dbr502/65N7wS9anugXjuOdl7dJlsL5D3xyL/hau32sFKY4LAdjjjVnc5v5SgpXt8B9mm0KbTveeZGLlA632d3yZNTUk2KdyxYq1tlRwMP2qyvp4jbp1W29xuxBDVesLy2vXfpTT+gnWNm+IQVJr4Wm8B5LN51cPaGjipWc99Pr0sJ8LPyO+VjwpZ8+Vp84wyp8IViQIFiQIFiQIFiQIFiQaHmiHypGxYIEwfKt2EQ/ggUJggUJggUJggUJggUJJvr5xkQ/+MJEP9+Y6AdfCBYkCBYk6GMVE8eLoeyjUGG4oZS4fOUxWoH5WIVEGxMV392wUfSxihkGM7PBabYIVhlPNYTMx+qOx55VhmBBgmCV4rJntSJYkCBYZaw7g04rFyPv5UQbluEsdxh5L2WpVNJcFfv/Eqxyopm8XBEsuPLAsUK3vYg/GRtCx8+LtnLEweIwXj76e6v3TAeroGKzG/oWl5kNx5ecE4xjFTDlym25MpMHy+no39/FGGN0O2fG1AOkg8Wln7XV/UQ/M7Nog9dcyUfe3Zf8H81drNKPQ+aZzntWsvw+lR9bulgPPBfF9r6f6bxTsk55floeH26YnszOC9dawr2Gi+GGMuLyySkGSEsYoutQmamD5f7Ixa/8DjPM1HsNV4csej5WOO8Vrl/osPBaR4YOuljMIC3B97INZsZEv1J8rzRjBAsi9LGgQbAgwQDpo9xPdV/Qx3pQB3uDM1b0e5D3Rfw26GM9yvUifhsE6zHrAZwHG0JW9OuB+55VhmBBgmA9yH/PakWwIEGwHuN+Eb8NBkifk41jPdaNZ32sHhSYqU2w+tDNsUKCBQnmY0GDYEGCYEGCYEGC+ViQoGJBgmD5xnws+EKwIEGwIEGwIEGwIEGwIMHsBt9Y0Q++sCiIb8XaBSoWJAgWJAgWJAgWJAgWJJjo97nT927lC2t38+auD5QaQIvtPf9nbzfNF3/kxEGZYktFtiderPM41ao4fR2vzx9UgvMzrDoQz9Z5XFZhWD8PXSwE+R7B+tjpOo/Duxv0imB9Jl5eGZGmHYL1tasMka0cwfoaPahPlArWv3+FfvGPhssro0jgtqhYHztd5/Fk4+br2GvcmEH6ofx8JcN+65yeYTP2vmx95hFWhYXXPnZyhqW8Gg3nTeGwDWI3CNZbaxHaHQrcxsrOOlnz5v6SRbDeuD4AmLWCw37DdLk2id0lizdTvBbNbBiuDtMcDuEseYrLT1uHqTJjr/C9izPBnZ3Laz5i2GWSdgjWKzFv5vYjB8TnFSb6vbbpldc0H6Z2VKzPrIXrA8dWsz8E6714PtPqmJfzLnvRnUJW9KvUZuzqZPKVrQHLdwmHpVvW6zEdpia/MkSL42Gas4PM8Xgur7VaZQcRu+yZ8WaKl+aCdXI852Tbcbex+Nhod2f/aiRYu/Qcj0DbWXLi+eYSCFa1Dm8cbOWBm1mHwWrlWKFZVqei2dDOK8LMWHitCZ3u3/2GvcLPtHo8uVi7IA5Wq/+P1WHWFT6iDdZ8cK3dg2z7MQWaww/RFL6ULdgQD6OheIFgvTFOx8rG0Vmr6CME65V1auj+kE5jow7P+3uwXrUOw2Xnvan5WLa+setqMSPs/D1YL4+IeXpZ532sITa8Q/KIW5rCb462NvZaP8RnnkHTyN9R7AjHLcGaJiBdJ6v9V/dmDt+0qfk/Sknbx5oNhy/beMEfW7wh+xZeYHbDa+MB6GzhhmzuVQt/QbGD0BzSeW0ZZ9iMZ9myBRc4pPPGWq5GkUM7H2GA9K3diyIyjvWJUsH619BEv0w2At9uEX4EFes7A8cKPyPea7h8dbc0NRnfY847JJjzDg2CBQmCBQmCBQkWXoMEFQsSBMs3Fl6DLxzSOdXesjK1IVgnlncREq2f0RQeTaejMGbH/AHBOjUYLeHfcBD6wNXZlVh4rSbD7hLfo/PuW9mF18KDj+DJ34Vy/msFhmZLjQbjOUtTyD97FdfOO35E5/0gP0Eq3fdfBUtjrXqyj2WWKh5ueHUiaHxofjPFc//nx3/he8fKxFsH/4pTnuRnhcNtGCCNhy9wh34HSHdnG3S69mPbK/o1aFpYe2hu7cdW9Bks2j+5PoNl2fkHs8kMHtvCUrrsvMcsV2bW7QnBlboM1iZXw7DZiHuUCta/f4V+8cYYqoG+1v06rVhm2VsmOImJQLedd7N1BOubM2s0ptiBs04rVtxc8i7C+3UZrM3EmKmfRa7u9fdgjasDhDCvEhDC/PW6rULrOS0JlcLtFStsLiq19tY341m4z98772lzGcYvgoVkqd54DVmYtmeewD3uOvq9zN+b7y9YenXvVczHYqaozLuTNIWp7KSpcUvL9uXaLjz1TAx9j7MB6LxvCsd++DQzPqR123KtYe4jVe98rKlJC1PVCmMPau1IbTWfNNzk/V5h2n0sG1+mqNpuO57xtmKl3eX+63OB4tW534cbXtQk1mfAb8F62dBtdh/RqZ+CNVek03xRrmBvd0fnb28ug22vpc0N8lhd33tN74T2rLEV/V4+WBKDvx0rPGkJ2RusTGMT/cLy6YBcwey3ipXCtOd3MvSexY2I9eynipWmz0QHV95UrP24ezpebXZuA5S6nPMOPc6wCon7gnUcimOGQ8doCn0r9j6puyrWWa+dnnzHqFiQIFiQ0O8V8ra9LmmDFYdx/UUWYexOqXGsf3TtfaOPBQlxsFhuo7BUqmFQT12NZsNZF4upyb4VO0kTwfKNkzRB45lg0dXqDk0hFGgKocFEP0g8Hiy6W30QHyucv+BYYSHF+rLyAdKLSFWxuG0HGlu7AXhDHSzqUqceqFh013tEUwgJJvpBgooFia7PsNqBxhZeA95gdgMUGCCFBsGCBMGCBPOxIEHFggTB8q3YwmsECxIECxIECxIECxIECxIECxIchPaNd+nAFyb6+cZEP/hCsCBBsCBBsCBBsCDBRD9IULEgQbB8Y6IffCFYkCBYkCBYkCBYkGA+lm/Mx4IvzMfyjflY8IVgQYJgQYJgQYJgQYJgQYKJfpCgYkGCYPnGRD/4QrAgQbAgQbAgQbAgwUQ/35joB1+Y6OcbE/3gC8GCBMGCBMGCBMGCBPOxIEHFggTB8o35WPCFYEGCYEGCYEFCPNwQx4tB+1tQH22w4rC9RDdKDZD+Y6Kfb/SxIMFEP9+KtQviOdGXnXfmvPsWeDMFFB56M0V85LegIlQsKPD2L2joR96HeNZ5Z6Kfc/qR9/kDXXl8HIt+/KOK9WXpY0FCX7GGl1fhlHzkfZg+oYhiw0kP/GJ67gWxjBF8KRWsYm9LwjOoWJBgPpZvLLwGX5jdAAX2CqFBsCBRrvM+jjcks/HA9L9p8zyfZr5+2LBMuOEnrn5imMdyCnY3qFiQKFWxdq+l4fDiOrzY3m7YXo82fPkTZpYsbLdubvHJXX75d0TJX17DjhEVa4PjAXchWJAgWAdUrTsQLEgQrBzF6jYECxIcs9vi+bgHxwqhQbAgQbAgQbAgQbAgQbAgQbAgQbAgQbAgUcP7CqPNi9CsX/39Tuf7ueE+s7sQPMLb7lLyPP4ulfa/k0833ev393f2fGQPS/EIb7o70fP4oyoqlsC6bmCta90sj7DWB/hHFQRL8cQO2T9O9Cv+aH2Edz3Auv7ICoI1rq0su/PBKq8K9z1A6fP4paLBGl+zg924rvJ8l4tqnukrNz7AmtanLhqsaRfmzueilue1gGoyZWYdjGNVv/x39Q/wNzXMmJx6r3G4fZQoDt/2jU+fj/UBKh7h3eNY9z6PPyp2Wrla8Xzcg6nJ0CBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkCBYkKjiDatywdJ4doC02bLbhhtRsSDRR8VKm4vs1CaJs5yIdFixQvgtTNEsOn13qYCDYIVgFsa0hJClJqzXfozSTk1rblTPwRs0g6XpxOVTfNK0eb02dd7T5od2X5xe3Yjk6mPBRR9rys14PudgYczSFKnQ/CunSQ6aQhsjlH8sG9uvx69se4uf9x3v6Rm85iJYaXdpZpZuj1Qchvr67uHkqyq4CNalX3cAz8TlU/Puf9Ed+ei8n11mY1U3dd6rszuWUFPD76PzfmZ+nitrIW6WQlhfIPOfOu0jz5unF8v4hITN6yysN7yb12CFml6+z5rytSZu/3l3S81us9dg9ZKrlLf4ZnY2zpKyjbmwv+GdfHfevbeEZme1aDfOks42Xm67i99gheVTX/a7fMuRh/nK5jsyXoOVpuOHyXu4xh74fmf2znGW37jtY6VpjyeVfoYfV8cf7CBY+3H3dLx6LPp+u/aVjLN4bQr7kSzkLWF4ZmD9LYLlTg2x6ixYxx5t8T6uzOlY6IPtY1fB8int9glPxlnS86MvDjrvnzprIupoNu6UwnQEcDOinm19CBWrfWk7Ee1k22b4/RlNTRN5gPfn46m/j5M0dWHZR6Hzjnsth6qfKsgddd47NvfdH+xlUbG6kM5mN0hRsTrx9D4JFQsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSBAsSLBWZOzunJH5CxYIEwcpRq25DsCBBsA4oW3cgWJAgWBtUK6Bq/wdAq8f9jY0QIwAAAABJRU5ErkJgggo=" width="35%" alt="Figure: mai.png"></p>
</dd>
<dt><code>mar</code></dt>
<dd>
<p>A numerical vector of the form <code>c(bottom,
        left, top, right)</code> which gives the number of lines of margin to be
specified on the four sides of the plot.
The default is <code>c(5, 4, 4, 2) + 0.1</code>.</p>
</dd>
<dt><code>mex</code></dt>
<dd>
<p><code>mex</code> is a character size expansion factor which is used to
describe coordinates in the margins of plots. Note that this does
not change the font size, rather specifies the size of font (as a
multiple of <code>csi</code>) used to convert between <code>mar</code> and
<code>mai</code>, and between <code>oma</code> and <code>omi</code>.
</p>
<p>This starts as <code>1</code> when the device is opened, and is reset
when the layout is changed (alongside resetting <code>cex</code>).
</p>
</dd>
<dt><code>mfcol, mfrow</code></dt>
<dd>
<p>A vector of the form <code>c(nr, nc)</code>.
Subsequent figures will be drawn in an <code>nr</code>-by-<code>nc</code>
array on the device by <em>columns</em> (<code>mfcol</code>), or
<em>rows</em> (<code>mfrow</code>), respectively.
</p>
<p>In a layout with exactly two rows and columns the base value of
<code>"cex"</code> is reduced by a factor of 0.83: if there are three or
more of either rows or columns, the reduction factor is 0.66.
</p>
<p>Setting a layout resets the base value of <code>cex</code> and that of
<code>mex</code> to <code>1</code>.
</p>
<p>If either of these is queried it will give the current layout, so
querying cannot tell you the order in which the array will be filled.
</p>
<p>Consider the alternatives, <code><a href="#layout">layout</a></code> and
<code><a href="#screen">split.screen</a></code>.
</p>
</dd>
<dt><code>mfg</code></dt>
<dd>
<p>A numerical vector of the form <code>c(i, j)</code>
where <code>i</code> and <code>j</code> indicate which figure in an array of
figures is to be drawn next (if setting) or is being drawn (if
enquiring).  The array must already have been set by <code>mfcol</code>
or <code>mfrow</code>.
</p>
<p>For compatibility with S, the form <code>c(i, j, nr, nc)</code> is also
accepted, when <code>nr</code> and <code>nc</code> should be the current
number of rows and number of columns.  Mismatches will be ignored,
with a warning.</p>
</dd>
<dt><code>mgp</code></dt>
<dd>
<p>The margin line (in <code>mex</code> units) for the axis
title, axis labels and axis line.  Note that <code>mgp[1]</code> affects
<code><a href="#title">title</a></code> whereas <code>mgp[2:3]</code> affect <code><a href="#axis">axis</a></code>.
The default is <code>c(3, 1, 0)</code>.</p>
</dd>
<dt><code>mkh</code></dt>
<dd>
<p>The height in inches of symbols to be drawn when
the value of <code>pch</code> is an integer. <em>Completely ignored in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span></em>.
</p>
</dd>
<dt><code>new</code></dt>
<dd>
<p>logical, defaulting to <code>FALSE</code>.  If set to
<code>TRUE</code>, the next high-level plotting command (actually
<code><a href="#frame">plot.new</a></code>) should <em>not clean</em> the frame before
drawing <em>as if it were on a <b><em>new</em></b> device</em>.  It is
an error (ignored with a warning) to try to use <code>new = TRUE</code>
on a device that does not currently contain a high-level plot.</p>
</dd>
<dt><code>oma</code></dt>
<dd>
<p>A vector of the form <code>c(bottom, left, top,
        right)</code> giving the size of the outer margins in lines of text.<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhwAAAKyCAAAAAC7g1g+AAAACXBIWXMAABcSAAAXEgFnn9JSAAATq0lEQVR4nO3dbZKqOhSF4eTWmRgjZ2i5P/iQCIsGJGTv8D5VR7vVVo8sd0IIEAIgxJBqvwUYFf+r/Q5gF+GARDggEQ5IhAMS4YBEOCARDkiEAxLhgEQ4IBEOSP+qvXK//KX7+nX3zjOPrfJEoRFUDkhssofCJntohAMS4YBEOCARDkiEAxLhgEQ4IBEOSIQDEuGARDggEQ5IhAMS4YBEOCAxTbDAE4VGUDkgMU0QCtMEoREOSIQDEuGARDggEQ5I9QbBcEkMYRx9iGH68XPbvQiHU3G6KjhORTjcScvrGGIKaYrKzehz+DRVjKLj21SO+padhzR1ID43To94fkMHlaO2OCz5qWGIw0V2Y34VQgghPZEUKkdlcagIMcS5dgzZSPONXw/5+vOCKaFyVJfmi+mH5b+Nh8xiLLtRnXDUNS/dlPcylst8twmJZVZUQgg0K25sZSBt33wbwuHATgJSiBs9kZswh7TAE4V7TaPjRavEFiqHeXGzL/rEqAdzSOuKi4GuNP+WXc8PWf6W/12Zxcgc0spSOLwFLW7+WrKtIRzVxfnixCPS59ZypZ8+R2VpGiqXy3h6RMqGSP/+u99ROWpL2ZV+RPp6yN9/9zM6pM5sLzA6pHgY4YBEh9SddRNSanWWygGJDikUOqTQCAckwgGJcEAiHJAIByTCAYk5pAWeKDSCygGJEVIojJBCIxyQCAckwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEBiDmmBJwqNoHJAYg4pFOaQQiMckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIB6Rae7yVOhVqmyrtW0TlgFRvX1mLe9rZ3P+vWpWlckAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGp3oa3TP/3QwrZO6KszXf1HCoHJCOV4/HvysGiUOcbXK9i5cyE41n9sNytLAWjXhqOm2rCV7hs9BTuQ5/jB60XntdWjv6Wr/nySdqLyksrRxdCH/r2Fue9XhqOEFr8pt/treHouhDa60He7LV9DoLxt7dWDhxAOCARDkiEAxLhgEQ4IBEOSIQDEuGARDggvWr4fNjUxrj5UW+qHH12hT+9oHL04VMtOqJxQvuVo58uhknFHaXjsObDsWxL6G2c84JmZdgHoe/umjd60M7M9O/SZTW0rYdjblQWNzyyLFpou1oPRwjTcuq7/tkldrRW2I1R832OxYffZVf4U9OVI/9O9h2xOKflypFlg2Cc13Tl+Ax6EY0rGgvHMgrjoBc71F/WVrPytfVk2nGp7x9bg21KU5Wj/xod3/oJx7VVOUIXNirEUEAoHKc1Fg6NXerPazccqzaFdJzVVJ9j2LS2CMG0msJ2+kuaqhxdCH2/XHXtP1N96HKc11Q4xgQshjXoafyisWZlUR+6RaeDsnFJW5Vjtpg3OtYRSsh5jVWOTBdCH7rQEY2LGq0cY9VYbmphFOy0xirHYhNKP29zY03lonYqRz8eWLSfJ5rTlvyolXD0iyGNz24INCU/aaRZ+Wyk7z4/muKxjLVROfoQum6x6opbNFI57EfCx84IuTYqx8zLx+5DK+GYU8HWlPu0EY7PJvnl8Rbwo1b6HGMsmEd8p0bC0Y0lg2TcqZFwUDBKcBsOjsZSntcOab+4RCFOwzENiZKOkpyGg0nDT3AbDpRHOCC5Dcd4ZFEU5HRVdjr4G72OkrxWjm5xiUKcVo5lLtjWVorXyjHrV4ehxV3cVY6NA8B1PXs8FuGtcnwfa6MPoWOSeSHOKsf3Ub+Cqe5Ga42bt8rBsPmDnFWOjXUTQysrHmeY7/FVOVZH9+JwXyX5CkcIahdHI7WjLe6alWzYvP/MHsX9vFWO7xR0QymhXSnBWzg++8QOSEVB3pqVrTCws0ohrsLxfUKu8PRp217GXbMSwrJOcNiFkjxVjvnYxP0qHSjBUzgC/c9nuWxW8Axn4eg4dOSDaFYgOasceJKvcHQdbcqDfIWjD11Hy/IYj30OasdDPFUOhkMf5qpyEItnuQpHFd99nAIJzV/CzlfAU7OCh7moHJUnbBSfVG511rqDcIw7w9qptq9hv1nJTrGDJ9kPR+DIxLV4CAd7QFbiIRyoxEM4ODZcJR7CEZhjXof9cExrKvQ6HudgnKOrPQj2Wg7CQTJqsd+soBrCAYlwQCIckAgHJMIBycyq7DgGylqrIdYqB+PkhpipHOvjVqM2O+HownD+A3t6/dvOXZd/s8NaswJD7FQOq17cRbZTOZjSY46hysFO0tYYCkcIwVztMPZ2HmanWYE5MaRXve4+3lX2ulQOSIQDEuGARDggEQ5IhAMS4YBEOCARDkiEAxLhgEQ4INXbZB+rvfIem++qEioHpHqVg43jR1WrZlQOSIQDEuGARDggEQ5IhAMS4YBEOCARDkiEAxLhgEQ4IBnZy77e3ux7x3yw+a6eQ+WAZKRyHPquTF/kG79Wf9WGOt9gK0cFMROOQ4azNvU2im77/DUrjSejt1I2gsdwtM1QNDyGw9TH1zZf4ehD4ycDtPW/8xSOzlaL3D5P4Ri+VJ2hr9bdbBUOh6uyeIyrytE6Y4WDcEAjHHZYKxyEAxrhMMNc4SAc0AiHFfYKB+GwwmA2nA2CXTEMuJv74D1ovnL02ZVZFgtH++EIIXSd+fMZm8xG881KH0JnPBh2vaFyDNmwvLXfZuFovnKE4ZO3HYxgMxvNh2OIhdV8zO/JZDaaD4dhxpMRXhCOzuiZrg23JrPmwxFCGGaf1n4PuT5YT0Z4RTi63loyzK6efHnDqmyXXVngIxutVY7tltzYgnDRpITQWjimDSl2P/rxHdp9g0tNhaO32PVcsL/ymmsqHMOnbnK4K/hYec01Fg67bI627PMQDo+f6zc3ndAlB6uy/eLyyGMttiq9y3187VeOqZd5YBVkGu6yuBgsvqe/OKgcQy/z8COXj+17G7M4TLyJ8+xXjlOyDE3tkYUvrYX3cJqHyvEDGw2908LhIhwXe5lDZ8XAqJiTLSlr9sPRhdD31z7fbr7AFfbDseplHtfPFzW5LRwuOqQXP9p5GL36oqn+Bi7yEI59e2sj1auGibdwmfdwDJ3V7Xh0lTd1malcVzkPx/4EjrpLxdXUjU2+w9FPJ1IwyOWmtpyDtZVd48dvLx4NZMN9OKxqIRvuw2G0YW8iG87D0U0nUjCmjWw475CGYHJBGHxLl/iuHONWV2MLopVs+K8c9pZCM9nwXjkMaicbfiuH1cmiDWXDbeU4MyX9SS1lw2vlODEl/UH+9mnb5zQc53Z8fObr3Fo0HIfjhHFCWOHF1lSDMnhBOJ45Tq3fyYCauw7ptJfSmSnpD0xCbzEb3irHGIl5EseBBTJtmiMbp/kKx+foJ9+9v/Z6gwb4CsdUM/rvPdl2pgt2DwyJtFk43IUjhK0W4o/jPZUuK41mw2U4tuwMe2xPQr9x+L3VbPhbWwm7LcTmXV233qPa6vC7Kd4qR9+tBpuGMa7dnSZXNw9Pck82mi0czirH1LFYLNXFuMe5Zd3dtEzbzYazcMyLoV/feHJP/LsWaMPZ8NasrPZi6kPo5gai2aVUibNwbATg4mHv+3sG1FsuHP7CcY+bTrPR4JbYJXfhWA2Cnpjvs2h8ft/UYnR3qju5C8e4Mjs5UwKyMfZuedPp9/B5/WtP4IOzcHS9qOUHF9LPYxuLP286FyEES+E4Np7dfWejO9wnHI8u+MPE05cUjJmZcIzj2QeOYf3nDcf/9IJ3xGJgJhwFppOvBj9+fPKmV1u32BkhPX6E84P67Gpx68VXeV02LFWOArL+5+9jGy/LhqHKcbf10a0vjqV+nu9t7FSOm8azv3X3rXy+rXAYCkehXaPvytsLC4edZuX6Ec71E964QN/XGw2WKkeJz/7OYvS+bBgKxyFnNoPeeXTrNzYqzsIxzQo+vCHlRi8sHHb6HAfZOC/XS3gKx3rkAkV5Cke92v7SNPoKx0sXUi2+wjGqUEBe2dXxtLZy06xgHOWqcvy25Qxneaoc1WLx1nrlqnLU885iRTgg+WpW/mL1gOhONVU5Ch2R5a1djqbCMW2yvX9hvrQYtRSOEELHlrkbtRUOgnGrtsKBW7UVjjMHRD/1pO/U1qpsoQX51taqpcrRfV3jR01Vju6Bc+68SVPhCIuqcdvU8/d2OZpqVpa2d7G/5rW1qNVwhBC6jrnIv2k0HK/ce/F2jYZjREB+0lqHNHdHo/LigDVaObrpNAovXrS/a7hy0Bf9lZlwFFqU9x2T9oUabVZwhxjSq153H+8qe10qByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJDqbbKP1V55j813VQmVA1K9ysHG8aOqVTMqByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAcnMeWVRSAxpOFpl2r9tA5XjhY4e2JTK0bqUXWV3/BUSKsf7HD4iMpXDvRjCWBjiWA3S941fj08H40HlcC4OC3pa3HG4yG/M/+D4c1M5fItDfYghfspEHG+dbvx2+OD/VA7v0nwx/bD8t3LmxBCEw7X4WRn59DLCTnE4dXoOwvE2J84oQzhe5dzZhgjHm5w8ExVrK+/yWeU9EBMqByQqh2spjkMZxxqM6TEHmxcqh3dxvrgdlcO3NA2VlzjnKZXDOblF/gZUDu/S+sfseis2B6NE5YBEOCDRrLzEeu317zUcKgckKscrXOuVUjkgEQ5IhAMSfY7T4t/NdUyrh2U7H+b3TXdtTweuiHCc9+cyjOnzb3HT/Ht+33xXspYOmpX7zcv+s/PQsNjH3/P7Fncd3dnoKVSOA2KK0+Ib9goZdhVZfdf/3m/dF8JxxNCHGArCGIg4BSR/VIjD/eMuRpMsMvl9y7uMNSyE44j15s2pMVgs4+8Fu+64Rn3f3w3Kg2VpeinC8ZvV4krLn+LXSkkS9/21AhTFixUUA+EoK+3UikVv9ehif7q/ytpKGd/LMYaUxH3Lu2yhcvxm1a/c7lLuTPc+MhM8PduuTP8pwnFNGtdW0tdNUzZSNuq1tU4y33d0n4KTu6v9JoUQIuG4aGPUKg2dh/QZ5PqEYPrqb9y3qAq7a7LPRWN6JcJxQMou9Hzv9WjG5i9fdeTXd1cOHdJrFgPhK5dHwW0NgVE5rkrZsVJWd27sL/D3b9ayQTiu2l2Q15aytWzQrEAjHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAYlwQCIckP5Ve+VY7ZX32HxXlVA5INWqHKnS6z4mNvB/pHKU0UTzRDggEY5y3FcPwgGJcBThvmiEEAgHdtQbBGtaCtH/miyVAxrhgEQ4IBEOSIQDEuGARDggEQ5IhAMS4YBEOCARDkiEAxLhgEQ4IBEOSIQDEuGARDggEQ5IhAMS4YBEOCARDkiEAxLhgEQ4IBEOSIQDEuGARDggEQ5IhAMSR/Y5JYY0HPArZbd83dYKKgckKscpKbtaHDUwNXIAwQzhuK7BOOQIRy6GEKZeRJp6EvmN70E4lsZaENPi15hiduNHWvxJkwjHwngajDgGYVw1iWP1WKejdaytZNJ8Mf2w/Pc2hOMjflZGPr2M8M5chBAIB3YQDkiEAxLhgEQ4IBGOj3n7yLvGQTXCkYnzBRghzaQ4BoPCEUKgcuS+t8i/HJUjk9Y/Ztfr2LQcpLvCceup2+O4/Susn3RR9uk2lnZTs3JrH27YGjpuKI9fd32umpx8Zcptzcr93+KxPCy3lOfb1FO1cKyLVpM5NdghHadRDB9/yu8ZW/6paDS5SOw4XTm2Zs/FsFiki7n6Wd8g6q5C1rvY7Urkd6VYZQLO1ms22f25UjnGkaLNL2/eVTj2zd7qXaQmP21nLvQ51rPnspNzj6VkOd/ur+f7rJxsv9jyqfGcK5Vjd/bcchxpeefUHKknnO5epiFG0cZMT8QKS1EXKsfu7Lm8W5FiTF89g42Q7BaErXjcOqgCydAI6ebo40ZlaHK3VJOqhON7/XT3oV9rJJvjpijiiXGOFGKIIc3Xv4iBNZnHGGpWMtshokV5VJVwHFhrlcjGc4o0K6fm26mh8BhWN7OW8qxSlSMux7XSOF4xX288+GvBpzg/RXZzobeLLWXCcWq+3fzg8bdh7SR/iqkEfR7IlI7yCq2tnJpvN25/TVu3svQrsvfdE+spYhjd2rufGX5rR0V78zlObC9pYAGYZi8cx7HRrTCD4dgqHWLTP4WjKIPh2ErH9nAp2SjL5PD5mZUclGOxcsAIwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAiHJAIByTCAYlwQCIckAgHJMIBiXBAIhyQCAckwgGJcEAyua+sf/NJRlyjckAiHEV4rxkDwgGJcJTjvnwQDkiEowz3VQPY9T93URJCpsE8JwAAAABJRU5ErkJgggo=" width="25%" alt="Figure: oma.png"></p>
</dd>
<dt><code>omd</code></dt>
<dd>
<p>A vector of the form <code>c(x1, x2, y1, y2)</code>
giving the region <em>inside</em> outer margins in NDC (=
normalized device coordinates), i.e., as a fraction (in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code>)
of the device region.</p>
</dd>
<dt><code>omi</code></dt>
<dd>
<p>A vector of the form <code>c(bottom, left, top,
        right)</code> giving the size of the outer margins in inches.</p>
</dd>
<dt><code>page</code></dt>
<dd>
<p><em><b>R.O.</b></em>; A boolean value indicating
whether the next call to <code><a href="#frame">plot.new</a></code> is going
to start a new page.  This value may be <code>FALSE</code> if there
are multiple figures on the page.</p>
</dd>
<dt><code>pch</code></dt>
<dd>
<p>Either an integer specifying a symbol or a single
character to be used as the default in plotting points.  See
<code><a href="#points">points</a></code> for possible values and their interpretation.
Note that only integers and single-character strings can
be set as a graphics parameter (and not <code>NA</code> nor <code>NULL</code>).
</p>
<p>Some functions such as <code><a href="#points">points</a></code> accept a vector of values
which are recycled.
</p>
</dd>
<dt><code>pin</code></dt>
<dd>
<p>The current plot dimensions, <code>(width, height)</code>,
in inches.</p>
</dd>
<dt><code>plt</code></dt>
<dd>
<p>A vector of the form <code>c(x1, x2, y1, y2)</code>
giving the coordinates of the plot region as fractions of the
current figure region.</p>
</dd>
<dt><code>ps</code></dt>
<dd>
<p>integer; the point size of text (but not symbols).  Unlike
the <code>pointsize</code> argument of most devices, this does not change
the relationship between <code>mar</code> and <code>mai</code> (nor <code>oma</code>
and <code>omi</code>).
</p>
<p>What is meant by ‘point size’ is device-specific, but most
devices mean a multiple of 1bp, that is 1/72 of an inch.
</p>
</dd>
<dt><code>pty</code></dt>
<dd>
<p>A character specifying the type of plot region to
be used; <code>"s"</code> generates a square plotting region and
<code>"m"</code> generates the maximal plotting region.</p>
</dd>
<dt><code>smo</code></dt>
<dd>
<p>(<em>Unimplemented</em>) a value which indicates how
smooth circles and circular arcs should be.</p>
</dd>
<dt><code>srt</code></dt>
<dd>
<p>The string rotation in degrees.  See the comment
about <code>crt</code>.  Only supported by <code><a href="#text">text</a></code>.


</p>
</dd>
<dt><code>tck</code></dt>
<dd>
<p>The length of tick marks as a fraction of the
smaller of the width or height of the plotting region.
If <code>tck &gt;= 0.5</code> it is interpreted as a fraction of the
relevant side, so if <code>tck = 1</code> grid lines are drawn.  The
default setting (<code>tck = NA</code>) is to use <code>tcl = -0.5</code>.</p>
</dd>
<dt><code>tcl</code></dt>
<dd>
<p>The length of tick marks as a fraction of the
height of a line of text.  The default value is <code>-0.5</code>;
setting <code>tcl = NA</code> sets <code>tck = -0.01</code> which is S' default.</p>
</dd>
<dt><code>usr</code></dt>
<dd>
<p>A vector of the form <code>c(x1, x2, y1, y2)</code>
giving the extremes of the user coordinates of the plotting
region.  When a logarithmic scale is in use (i.e.,
<code>par("xlog")</code> is true, see below), then the x-limits will be
<code>10 ^ par("usr")[1:2]</code>.  Similarly for the y-axis.
</p>
</dd>
<dt><code>xaxp</code></dt>
<dd>
<p>A vector of the form <code>c(x1, x2, n)</code> giving
the coordinates of the extreme tick marks and the number of
intervals between tick-marks when <code>par("xlog")</code> is false.
Otherwise, when <em>log</em> coordinates are active, the three
values have a different meaning: For a small range, <code>n</code> is
<em>negative</em>, and the ticks are as in the linear case,
otherwise, <code>n</code> is in <code>1:3</code>, specifying a case number,
and <code>x1</code> and <code>x2</code> are the lowest and highest power of 10
inside the user coordinates, <code>10 ^ par("usr")[1:2]</code>. (The
<code>"usr"</code> coordinates are log10-transformed here!)
</p>

<dl>
<dt>n = 1</dt>
<dd>
<p>will produce tick marks at <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mi>j</mi></msup></mrow><annotation encoding="application/x-tex">10^j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span></span></span></span></span></span></span></code> for integer <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></code>,</p>
</dd>
<dt>n = 2</dt>
<dd>
<p>gives marks  <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mn>1</mn><msup><mn>0</mn><mi>j</mi></msup></mrow><annotation encoding="application/x-tex">k 10^j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span></span></span></span></span></span></span></code> with
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">k \in \{1, 5\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mclose">}</span></span></span></span></code>,</p>
</dd>
<dt>n = 3</dt>
<dd>
<p>gives marks  <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mn>1</mn><msup><mn>0</mn><mi>j</mi></msup></mrow><annotation encoding="application/x-tex">k 10^j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span></span></span></span></span></span></span></code> with
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">k \in \{1, 2, 5\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mclose">}</span></span></span></span></code>.</p>
</dd>
</dl>
<p>See <code><a href="#axTicks">axTicks</a>()</code> for a pure <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> implementation of this.
</p>
<p>This parameter is reset when a user coordinate system is set up,
for example by starting a new page or by calling
<code><a href="#plot.window">plot.window</a></code> or setting <code>par("usr")</code>: <code>n</code>
is taken from <code>par("lab")</code>.  It affects the default behaviour
of subsequent calls to <code><a href="#axis">axis</a></code> for sides 1 or 3.
</p>
<p>It is only relevant to default numeric axis systems, and not for
example to dates.
</p>
</dd>
<dt><code>xaxs</code></dt>
<dd>
<p>The style of axis interval calculation to be used
for the x-axis.  Possible values are <code>"r"</code>, <code>"i"</code>,
<code>"e"</code>, <code>"s"</code>, <code>"d"</code>.  The styles are generally
controlled by the range of data or <code>xlim</code>, if given.<br>
Style <code>"r"</code> (regular) first extends the data range by 4
percent at each end and then finds an axis with pretty labels
that fits within the extended range.<br>
Style <code>"i"</code> (internal) just finds an axis with pretty labels
that fits within the original data range.<br>
Style <code>"s"</code> (standard) finds an axis with pretty labels
within which the original data range fits.<br>
Style <code>"e"</code> (extended) is like style <code>"s"</code>, except that
it is also ensures that there is room for plotting symbols within
the bounding box.<br>
Style <code>"d"</code> (direct) specifies that the current axis should
be used on subsequent plots.<br>
(<em>Only <code>"r"</code> and <code>"i"</code> styles have been
implemented in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.</em>)</p>
</dd>
<dt><code>xaxt</code></dt>
<dd>
<p>A character which specifies the x axis type.
Specifying <code>"n"</code> suppresses plotting of the axis.  The
standard value is <code>"s"</code>: for compatibility with S values
<code>"l"</code> and <code>"t"</code> are accepted but are equivalent to
<code>"s"</code>: any value other than <code>"n"</code> implies plotting.</p>
</dd>
<dt><code>xlog</code></dt>
<dd>
<p>A logical value (see <code>log</code> in
<code><a href="#plot.default">plot.default</a></code>).  If <code>TRUE</code>, a logarithmic scale
is in use (e.g., after <code>plot(*, log = "x")</code>).
For a new device, it defaults to <code>FALSE</code>, i.e., linear scale.</p>
</dd>
<dt><code>xpd</code></dt>
<dd>
<p>A logical value or <code>NA</code>.
If <code>FALSE</code>, all plotting is clipped to the plot region, if
<code>TRUE</code>, all plotting is clipped to the figure region, and if
<code>NA</code>, all plotting is clipped to the device region.  See also
<code><a href="#clip">clip</a></code>.</p>
</dd>
<dt><code>yaxp</code></dt>
<dd>
<p>A vector of the form <code>c(y1, y2, n)</code> giving
the coordinates of the extreme tick marks and the number of
intervals between tick-marks unless for log coordinates, see
<code>xaxp</code> above.</p>
</dd>
<dt><code>yaxs</code></dt>
<dd>
<p>The style of axis interval calculation to be used
for the y-axis.  See <code>xaxs</code> above.</p>
</dd>
<dt><code>yaxt</code></dt>
<dd>
<p>A character which specifies the y axis type.
Specifying <code>"n"</code> suppresses plotting.</p>
</dd>
<dt><code>ylbias</code></dt>
<dd>
<p>A positive real value used in the positioning
of text in the margins by <code><a href="#axis">axis</a></code> and
<code><a href="#mtext">mtext</a></code>.  The default is in principle device-specific,
but currently <code>0.2</code> for all of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s own devices.  Set this to
<code>0.2</code> for compatibility with <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> &lt; 2.14.0 on <code>x11</code> and
<code>windows()</code> devices.</p>
</dd>
<dt><code>ylog</code></dt>
<dd>
<p>A logical value; see <code>xlog</code> above.</p>
</dd>
</dl>
<h3>Color Specification</h3>

<p>Colors can be specified in several different ways. The simplest way is
with a character string giving the color name (e.g., <code>"red"</code>).  A
list of the possible colors can be obtained with the function
<code><a href="https://r-universe.dev/manuals/grDevices.html#colors">colors</a></code>.  Alternatively, colors can be specified directly
in terms of their RGB components with a string of the form
<code>"#RRGGBB"</code> where each of the pairs <code>RR</code>, <code>GG</code>,
<code>BB</code> consist of two hexadecimal digits giving a value in the
range <code>00</code> to <code>FF</code>.  Colors can also be specified by giving
an index into a small table of colors, the <code><a href="https://r-universe.dev/manuals/grDevices.html#palette">palette</a></code>:
indices wrap round so with the default palette of size 8, <code>10</code> is
the same as <code>2</code>.  This provides compatibility with S.  Index
<code>0</code> corresponds to the background color.  Note that the palette
(apart from <code>0</code> which is per-device) is a per-session setting.
</p>
<p>Negative integer colours are errors.
</p>
<p>Additionally, <code>"transparent"</code> is <em>transparent</em>, useful for
filled areas (such as the background!), and just invisible for things
like lines or text.  In most circumstances (integer) <code>NA</code>
is equivalent to <code>"transparent"</code> (but not for
<code><a href="#text">text</a></code> and <code><a href="#mtext">mtext</a></code>).
</p>
<p>Semi-transparent colors are available for use on devices that support
them.
</p>
<p>The functions <code><a href="https://r-universe.dev/manuals/grDevices.html#rgb">rgb</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#hsv">hsv</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#hcl">hcl</a></code>,
<code><a href="https://r-universe.dev/manuals/grDevices.html#gray">gray</a></code> and <code><a href="https://r-universe.dev/manuals/grDevices.html#palettes">rainbow</a></code> provide additional ways
of generating colors.
</p>


<h3>Line Type Specification</h3>

<p>Line types can either be specified by giving an index into a small
built-in table of line types (1 = solid, 2 = dashed, etc, see
<code>lty</code> above) or directly as the lengths of on/off stretches of
line.  This is done with a string of an even number (up to eight)
of characters, namely <em>non-zero</em>
(hexadecimal) digits which give the lengths in consecutive positions
in the string.  For example, the string <code>"33"</code> specifies three
units on followed by three off and <code>"3313"</code> specifies three units
on followed by three off followed by one on and finally three off.
The ‘units’ here are (on most devices) proportional to
<code>lwd</code>, and with <code>lwd = 1</code> are in pixels or points or 1/96
inch.
</p>
<p>The five standard dash-dot line types (<code>lty = 2:6</code>) correspond to
<code>c("44", "13", "1343", "73", "2262")</code>.
</p>
<p>Note that <code>NA</code> is not a valid value for <code>lty</code>.
</p>


<h3>Note</h3>

<p>The effect of restoring all the (settable) graphics parameters as
in the examples is hard to predict if the device has been resized.
Several of them are attempting to set the same things in different
ways, and those last in the alphabet will win.  In particular, the
settings of <code>mai</code>, <code>mar</code>, <code>pin</code>, <code>plt</code> and
<code>pty</code> interact, as do the outer margin settings, the figure
layout and figure region size.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.default">plot.default</a></code> for some high-level plotting parameters;
<code><a href="https://r-universe.dev/manuals/grDevices.html#colors">colors</a></code>; <code><a href="#clip">clip</a></code>;
<code><a href="https://r-universe.dev/manuals/base.html#options">options</a></code> for other setup parameters;
graphic devices <code><a href="https://r-universe.dev/manuals/grDevices.html#x11">x11</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#postscript">postscript</a></code> and
setting up device regions by <code><a href="#layout">layout</a></code> and
<code><a href="#screen">split.screen</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 2 x 2 pictures on one plot</span>
          pty <span class="token operator">=</span> <span class="token string">"s"</span><span class="token punctuation">)</span>       <span class="token comment"># square plotting region,</span>
                           <span class="token comment"># independent of device size</span>

<span class="token comment">## At end of plotting, reset to previous settings:</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## Alternatively,</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>no.readonly <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># the whole list of settable par's.</span>
<span class="token comment">## do lots of plotting and par(.) calls, then reset:</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>
<span class="token comment">## Note this is not in general good practice</span>

par<span class="token punctuation">(</span><span class="token string">"ylog"</span><span class="token punctuation">)</span> <span class="token comment"># FALSE</span>
plot<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span><span class="token string">"ylog"</span><span class="token punctuation">)</span> <span class="token comment"># TRUE</span>

plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> xaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">)</span> <span class="token comment"># 'inner axis' w/o extra space</span>
par<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"usr"</span><span class="token punctuation">,</span> <span class="token string">"xaxp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span> nr.prof <span class="token operator">&lt;-</span>
c<span class="token punctuation">(</span>prof.pilots <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">,</span> lawyers <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span> farmers <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> salesmen <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> physicians <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span>
  mechanics <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> policemen <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> managers <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> engineers <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> teachers <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
  housewives <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> students <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> armed.forces <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>las <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
barplot<span class="token punctuation">(</span>rbind<span class="token punctuation">(</span>nr.prof<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># R 0.63.2: shows alignment problem</span>
par<span class="token punctuation">(</span>las <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># reset to default</span>

require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span> <span class="token comment"># for gray</span>
<span class="token comment">## 'fg' use:</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"'fg' : axes, ticks and box in gray"</span><span class="token punctuation">,</span>
     fg <span class="token operator">=</span> gray<span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bty <span class="token operator">=</span> <span class="token string">"7"</span> <span class="token punctuation">,</span> sub <span class="token operator">=</span> R.version.string<span class="token punctuation">)</span>

ex <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   old.par <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>no.readonly <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># all par settings which</span>
                                      <span class="token comment"># could be changed.</span>
   on.exit<span class="token punctuation">(</span>par<span class="token punctuation">(</span>old.par<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token comment">## ...</span>
   <span class="token comment">## ... do lots of par() settings and plots</span>
   <span class="token comment">## ...</span>
   invisible<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#-- now,  par(old.par)  will be executed</span>
<span class="token punctuation">}</span>
ex<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">## Line types</span>
showLty <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>ltys<span class="token punctuation">,</span> xoff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   stopifnot<span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">&lt;-</span> length<span class="token punctuation">(</span>ltys<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span>
   op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mar <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> on.exit<span class="token punctuation">(</span>par<span class="token punctuation">(</span>op<span class="token punctuation">)</span><span class="token punctuation">)</span>
   plot<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> ann <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
   y <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
   clty <span class="token operator">&lt;-</span> as.character<span class="token punctuation">(</span>ltys<span class="token punctuation">)</span>
   mytext <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> txt<span class="token punctuation">)</span>
      text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> txt<span class="token punctuation">,</span> adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">.3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
   abline<span class="token punctuation">(</span>h <span class="token operator">=</span> y<span class="token punctuation">,</span> lty <span class="token operator">=</span> ltys<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span> mytext<span class="token punctuation">(</span>xoff<span class="token punctuation">,</span> y<span class="token punctuation">,</span> clty<span class="token punctuation">)</span>
   y <span class="token operator">&lt;-</span> y <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   abline<span class="token punctuation">(</span>h <span class="token operator">=</span> y<span class="token punctuation">,</span> lty <span class="token operator">=</span> ltys<span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
   mytext<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">8</span><span class="token operator">+</span>xoff<span class="token punctuation">,</span> y<span class="token punctuation">,</span> paste<span class="token punctuation">(</span>clty<span class="token punctuation">,</span><span class="token string">" lwd = 2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
showLty<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"solid"</span><span class="token punctuation">,</span> <span class="token string">"dashed"</span><span class="token punctuation">,</span> <span class="token string">"dotted"</span><span class="token punctuation">,</span> <span class="token string">"dotdash"</span><span class="token punctuation">,</span> <span class="token string">"longdash"</span><span class="token punctuation">,</span> <span class="token string">"twodash"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>new <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>  <span class="token comment"># the same:</span>
showLty<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"solid"</span><span class="token punctuation">,</span> <span class="token string">"44"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">,</span> <span class="token string">"1343"</span><span class="token punctuation">,</span> <span class="token string">"73"</span><span class="token punctuation">,</span> <span class="token string">"2262"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xoff <span class="token operator">=</span> <span class="token number">.2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
showLty<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"11"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">,</span> <span class="token string">"33"</span><span class="token punctuation">,</span> <span class="token string">"44"</span><span class="token punctuation">,</span>   <span class="token string">"12"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">,</span> <span class="token string">"14"</span><span class="token punctuation">,</span>   <span class="token string">"21"</span><span class="token punctuation">,</span> <span class="token string">"31"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="persp">

<a href="#persp" class="help-page-title"><h2>Perspective Plots</h2></a>

<h3>Description</h3>

<p>This function draws perspective plots of a surface over the
x–y plane.  <code>persp</code> is a generic function.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">persp<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
persp<span class="token punctuation">(</span>x <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> nrow<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      y <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> ncol<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      z<span class="token punctuation">,</span> xlim <span class="token operator">=</span> range<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> range<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span>
      zlim <span class="token operator">=</span> range<span class="token punctuation">(</span>z<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> zlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
      main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> sub <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
      theta <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> phi <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span> r <span class="token operator">=</span> sqrt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
      scale <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> expand <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
      col <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ltheta <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">135</span><span class="token punctuation">,</span> lphi <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
      shade <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> box <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> nticks <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
      ticktype <span class="token operator">=</span> <span class="token string">"simple"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are
measured.  These must be in ascending order.  By default, equally
spaced values from 0 to 1 are used.  If <code>x</code> is a <code>list</code>,
its components <code>x$x</code> and <code>x$y</code> are used for <code>x</code>
and <code>y</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a matrix containing the values to be plotted (<code>NA</code>s are
allowed).  Note that <code>x</code> can be used instead of <code>z</code> for
convenience.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim, zlim</code></td>
<td>
<p>x-, y-  and z-limits.  These should be chosen
to cover the range of values of the surface: see ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, zlab</code></td>
<td>
<p>titles for the axes.  N.B. These must be
character strings; expressions are not accepted.  Numbers will be
coerced to character strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, sub</code></td>
<td>
<p>main title and subtitle, as for <code><a href="#title">title</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta, phi</code></td>
<td>
<p>angles defining the viewing direction.
<code>theta</code> gives the azimuthal direction and <code>phi</code>
the colatitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>the distance of the eyepoint from the centre of the plotting box.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a value which can be used to vary the strength of
the perspective transformation.  Values of <code>d</code> greater
than 1 will lessen the perspective effect and values less
and 1 will exaggerate it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>before viewing the x, y and z coordinates of the
points defining the surface are transformed to the interval
[0,1].  If <code>scale</code> is <code>TRUE</code> the x, y and z coordinates
are transformed separately.  If <code>scale</code> is <code>FALSE</code>
the coordinates are scaled so that aspect ratios are retained.
This is useful for rendering things like DEM information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expand</code></td>
<td>
<p>a expansion factor applied to the <code>z</code>
coordinates. Often used with <code>0 &lt; expand &lt; 1</code> to shrink the
plotting box in the <code>z</code> direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>the color(s) of the surface facets.  Transparent colours are
ignored.  This is recycled to the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>n</mi><mi>y</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(nx-1)(ny-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></code> facets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>the color of the line drawn around the surface facets.
The default, <code>NULL</code>, corresponds to <code>par("fg")</code>.
A value of <code>NA</code> will disable the drawing of borders: this is
sometimes useful when the surface is shaded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltheta, lphi</code></td>
<td>
<p>if finite values are specified for <code>ltheta</code>
and <code>lphi</code>, the surface is shaded as though it was being
illuminated from the direction specified by azimuth <code>ltheta</code>
and colatitude <code>lphi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>
<p>the shade at a surface facet is computed as
<code>((1+d)/2)^shade</code>, where <code>d</code> is the dot product of
a unit vector normal to the facet and a unit vector in the
direction of a light source.  Values of <code>shade</code> close
to one yield shading similar to a point light source model
and values close to zero produce no shading.  Values in the
range 0.5 to 0.75 provide an approximation to daylight
illumination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box</code></td>
<td>
<p>should the bounding box for the surface be displayed.
The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>should ticks and labels be added to the box.  The
default is <code>TRUE</code>.  If <code>box</code> is <code>FALSE</code> then no
ticks or labels are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticktype</code></td>
<td>
<p>character: <code>"simple"</code> draws just an arrow
parallel to the axis to indicate direction of increase;
<code>"detailed"</code> draws normal ticks as per 2D plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nticks</code></td>
<td>
<p>the (approximate) number of tick marks to draw on the
axes.  Has no effect if <code>ticktype</code> is <code>"simple"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional <a href="#par">graphical parameters</a> (see <code><a href="#par">par</a></code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plots are produced by first transforming the (x,y,z)
coordinates to the interval [0,1] using the limits supplied or
computed from the range of the data.  The surface is then viewed
by looking at the origin from a direction defined by <code>theta</code>
and <code>phi</code>.  If <code>theta</code> and <code>phi</code> are both zero
the viewing direction is directly down the negative y axis.
Changing <code>theta</code> will vary the azimuth and changing <code>phi</code>
the colatitude.
</p>
<p>There is a hook called <code>"persp"</code> (see <code><a href="https://r-universe.dev/manuals/base.html#userhooks">setHook</a></code>)
called after the plot is completed, which is used in the
testing code to annotate the plot page.  The hook function(s) are
called with no argument.
</p>
<p>Notice that <code>persp</code> interprets the <code>z</code> matrix as a table of
<code>f(x[i], y[j])</code> values, so that the x axis corresponds to row
number and the y axis to column number, with column 1 at the bottom,
so that with the standard rotation angles, the top left corner of the
matrix is displayed at the left hand side, closest to the user.
</p>
<p>The sizes and fonts of the axis labels and the annotations for
<code>ticktype = "detailed"</code> are controlled by graphics parameters
<code>"cex.lab"</code>/<code>"font.lab"</code> and
<code>"cex.axis"</code>/<code>"font.axis"</code> respectively.
</p>
<p>The bounding box is drawn with edges of faces facing away from the
viewer (and hence at the back of the box) with solid lines and other
edges dashed and on top of the surface.  This (and the plotting of the
axes) assumes that the axis limits are chosen so that the surface
is within the box, and the function will warn if this is not the case.
</p>


<h3>Value</h3>

<p><code>persp()</code> returns the <em>viewing transformation matrix</em>, say
<code>VT</code>, a <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">4 \times 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></code> matrix suitable for projecting 3D
coordinates <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y,z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span></code> into the 2D plane using homogeneous 4D
coordinates <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y,z,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></code>.  It can be used to superimpose
additional graphical elements on the 3D plot, by
<code><a href="#lines">lines</a>()</code> or <code><a href="#points">points</a>()</code>, using the
function <code><a href="https://r-universe.dev/manuals/grDevices.html#trans3d">trans3d</a>()</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#contour">contour</a></code> and <code><a href="#image">image</a></code>; <code><a href="https://r-universe.dev/manuals/grDevices.html#trans3d">trans3d</a></code>.
</p>
<p>Rotatable 3D plots can be produced by package <a href="https://CRAN.R-project.org/package=rgl" target="_blank"><span class="pkg">rgl</span></a>: other
ways to produce static perspective plots are available in packages
<a href="https://CRAN.R-project.org/package=lattice" target="_blank"><span class="pkg">lattice</span></a> and <a href="https://CRAN.R-project.org/package=scatterplot3d" target="_blank"><span class="pkg">scatterplot3d</span></a>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span> <span class="token comment"># for trans3d</span>
<span class="token comment">## More examples in  demo(persp) !!</span>
<span class="token comment">##                   -----------</span>

<span class="token comment"># (1) The Obligatory Mathematical surface.</span>
<span class="token comment">#     Rotated sinc function.</span>

x <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> x
f <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span> r <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>y<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token number">10</span> <span class="token operator">*</span> sin<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token operator">/</span>r <span class="token punctuation">}</span>
z <span class="token operator">&lt;-</span> outer<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> f<span class="token punctuation">)</span>
z<span class="token punctuation">[</span>is.na<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>bg <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">)</span>
persp<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> theta <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> phi <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> expand <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightblue"</span><span class="token punctuation">)</span>
persp<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> theta <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> phi <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> expand <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightblue"</span><span class="token punctuation">,</span>
      ltheta <span class="token operator">=</span> <span class="token number">120</span><span class="token punctuation">,</span> shade <span class="token operator">=</span> <span class="token number">0.75</span><span class="token punctuation">,</span> ticktype <span class="token operator">=</span> <span class="token string">"detailed"</span><span class="token punctuation">,</span>
      xlab <span class="token operator">=</span> <span class="token string">"X"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Y"</span><span class="token punctuation">,</span> zlab <span class="token operator">=</span> <span class="token string">"Sinc( r )"</span>
<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> res
round<span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># (2) Add to existing persp plot - using trans3d() :</span>

xE <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> xy <span class="token operator">&lt;-</span> expand.grid<span class="token punctuation">(</span>xE<span class="token punctuation">,</span> xE<span class="token punctuation">)</span>
points<span class="token punctuation">(</span>trans3d<span class="token punctuation">(</span>xy<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> xy<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> pmat <span class="token operator">=</span> res<span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">)</span>
lines <span class="token punctuation">(</span>trans3d<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> sin<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> pmat <span class="token operator">=</span> res<span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>

phi <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">201</span><span class="token punctuation">)</span>
r1 <span class="token operator">&lt;-</span> <span class="token number">7.725</span> <span class="token comment"># radius of 2nd maximum</span>
xr <span class="token operator">&lt;-</span> r1 <span class="token operator">*</span> cos<span class="token punctuation">(</span>phi<span class="token punctuation">)</span>
yr <span class="token operator">&lt;-</span> r1 <span class="token operator">*</span> sin<span class="token punctuation">(</span>phi<span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>trans3d<span class="token punctuation">(</span>xr<span class="token punctuation">,</span>yr<span class="token punctuation">,</span> f<span class="token punctuation">(</span>xr<span class="token punctuation">,</span>yr<span class="token punctuation">)</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">## (no hidden lines)</span>

<span class="token comment"># (3) Visualizing a simple DEM model</span>

z <span class="token operator">&lt;-</span> <span class="token number">2</span> <span class="token operator">*</span> volcano        <span class="token comment"># Exaggerate the relief</span>
x <span class="token operator">&lt;-</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>nrow<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># 10 meter spacing (S to N)</span>
y <span class="token operator">&lt;-</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>ncol<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># 10 meter spacing (E to W)</span>
<span class="token comment">## Don't draw the grid lines :  border = NA</span>
par<span class="token punctuation">(</span>bg <span class="token operator">=</span> <span class="token string">"slategray"</span><span class="token punctuation">)</span>
persp<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> theta <span class="token operator">=</span> <span class="token number">135</span><span class="token punctuation">,</span> phi <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"green3"</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      ltheta <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">120</span><span class="token punctuation">,</span> shade <span class="token operator">=</span> <span class="token number">0.75</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> box <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment"># (4) Surface colours corresponding to z-values</span>

par<span class="token punctuation">(</span>bg <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">)</span>
x <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.95</span><span class="token punctuation">,</span> <span class="token number">1.95</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.95</span><span class="token punctuation">,</span> <span class="token number">1.95</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">)</span>
z <span class="token operator">&lt;-</span> outer<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> a<span class="token operator">*</span>b<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
nrz <span class="token operator">&lt;-</span> nrow<span class="token punctuation">(</span>z<span class="token punctuation">)</span>
ncz <span class="token operator">&lt;-</span> ncol<span class="token punctuation">(</span>z<span class="token punctuation">)</span>
<span class="token comment"># Create a function interpolating colors in the range of specified colors</span>
jet.colors <span class="token operator">&lt;-</span> colorRampPalette<span class="token punctuation">(</span> c<span class="token punctuation">(</span><span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment"># Generate the desired number of colors from this palette</span>
nbcol <span class="token operator">&lt;-</span> <span class="token number">100</span>
color <span class="token operator">&lt;-</span> jet.colors<span class="token punctuation">(</span>nbcol<span class="token punctuation">)</span>
<span class="token comment"># Compute the z-value at the facet centres</span>
zfacet <span class="token operator">&lt;-</span> z<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> z<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span>ncz<span class="token punctuation">]</span> <span class="token operator">+</span> z<span class="token punctuation">[</span><span class="token operator">-</span>nrz<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> z<span class="token punctuation">[</span><span class="token operator">-</span>nrz<span class="token punctuation">,</span> <span class="token operator">-</span>ncz<span class="token punctuation">]</span>
<span class="token comment"># Recode facet z-values into color indices</span>
facetcol <span class="token operator">&lt;-</span> cut<span class="token punctuation">(</span>zfacet<span class="token punctuation">,</span> nbcol<span class="token punctuation">)</span>
persp<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> col <span class="token operator">=</span> color<span class="token punctuation">[</span>facetcol<span class="token punctuation">]</span><span class="token punctuation">,</span> phi <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> theta <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">)</span>

par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="pie">

<a href="#pie" class="help-page-title"><h2>Pie Charts</h2></a>

<h3>Description</h3>

<p>Draw a pie chart.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">pie<span class="token punctuation">(</span>x<span class="token punctuation">,</span> labels <span class="token operator">=</span> names<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> edges <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span> radius <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
    clockwise <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> init.angle <span class="token operator">=</span> <span class="token keyword">if</span><span class="token punctuation">(</span>clockwise<span class="token punctuation">)</span> <span class="token number">90</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">,</span>
    density <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
    lty <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of non-negative numerical quantities.
The values in <code>x</code> are displayed as the areas of pie slices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>one or more expressions or character strings giving
names for the slices.  Other objects are coerced by
<code><a href="https://r-universe.dev/manuals/grDevices.html#as.graphicsAnnot">as.graphicsAnnot</a></code>.  For empty or <code>NA</code>
(after coercion to character) labels, no label nor pointing line
is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edges</code></td>
<td>
<p>the circular outline of the pie is approximated by a
polygon with this many edges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>the pie is drawn centered in a square box whose sides
range from <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></code> to <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></code>.  If the character strings labeling
the slices are long it may be necessary to use a smaller radius.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clockwise</code></td>
<td>
<p>logical indicating if slices are drawn clockwise or
counter clockwise (i.e., mathematically positive direction), the
latter is default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.angle</code></td>
<td>
<p>number specifying the <em>starting angle</em> (in
degrees) for the slices. Defaults to 0 (i.e., ‘3 o'clock’)
unless <code>clockwise</code> is true where <code>init.angle</code>
defaults to 90 (degrees), (i.e., ‘12 o'clock’).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>the density of shading lines, in lines per inch.
The default value of <code>NULL</code> means that no shading lines
are drawn. Non-positive values of <code>density</code> also inhibit the
drawing of shading lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>the slope of shading lines, given as an angle in
degrees (counter-clockwise).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector of colors to be used in filling or shading
the slices. If missing a set of 6 pastel colours is used,
unless <code>density</code> is specified when <code>par("fg")</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border, lty</code></td>
<td>
<p>(possibly vectors) arguments passed to
<code><a href="#polygon">polygon</a></code> which draws each slice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>an overall title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a> can be given as arguments to
<code>pie</code>.  They will affect the main title and labels only.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Pie charts are a very bad way of displaying information.
The eye is good at judging linear measures and bad at judging
relative areas.  A bar chart or dot chart is a preferable way of
displaying this type of data.
</p>
<p>Cleveland (1985), page 264: “Data that can be shown by pie charts
always can be shown by a dot chart.  This means that judgements of
position along a common scale can be made instead of the less
accurate angle judgements.”
This statement is based on the empirical investigations of Cleveland
and McGill as well as investigations by perceptual psychologists.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Cleveland, W. S. (1985)
<em>The Elements of Graphing Data</em>.
Wadsworth: Monterey, CA, USA.
</p>


<h3>See Also</h3>

<p><code><a href="#dotchart">dotchart</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span>
pie<span class="token punctuation">(</span>rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> rainbow<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> radius <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">)</span>

pie.sales <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0.12</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.26</span><span class="token punctuation">,</span> <span class="token number">0.16</span><span class="token punctuation">,</span> <span class="token number">0.04</span><span class="token punctuation">,</span> <span class="token number">0.12</span><span class="token punctuation">)</span>
names<span class="token punctuation">(</span>pie.sales<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"Blueberry"</span><span class="token punctuation">,</span> <span class="token string">"Cherry"</span><span class="token punctuation">,</span>
    <span class="token string">"Apple"</span><span class="token punctuation">,</span> <span class="token string">"Boston Cream"</span><span class="token punctuation">,</span> <span class="token string">"Other"</span><span class="token punctuation">,</span> <span class="token string">"Vanilla Cream"</span><span class="token punctuation">)</span>
pie<span class="token punctuation">(</span>pie.sales<span class="token punctuation">)</span> <span class="token comment"># default colours</span>
pie<span class="token punctuation">(</span>pie.sales<span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"purple"</span><span class="token punctuation">,</span> <span class="token string">"violetred1"</span><span class="token punctuation">,</span> <span class="token string">"green3"</span><span class="token punctuation">,</span>
                       <span class="token string">"cornsilk"</span><span class="token punctuation">,</span> <span class="token string">"cyan"</span><span class="token punctuation">,</span> <span class="token string">"white"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pie<span class="token punctuation">(</span>pie.sales<span class="token punctuation">,</span> col <span class="token operator">=</span> gray<span class="token punctuation">(</span>seq<span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pie<span class="token punctuation">(</span>pie.sales<span class="token punctuation">,</span> density <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">15</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">)</span>
pie<span class="token punctuation">(</span>pie.sales<span class="token punctuation">,</span> clockwise <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"pie(*, clockwise = TRUE)"</span><span class="token punctuation">)</span>
segments<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"init.angle = 90"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>

n <span class="token operator">&lt;-</span> <span class="token number">200</span>
pie<span class="token punctuation">(</span>rep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> col <span class="token operator">=</span> rainbow<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
    main <span class="token operator">=</span> <span class="token string">"pie(*, labels=\"\", col=rainbow(n), border=NA,.."</span><span class="token punctuation">)</span>

<span class="token comment">## Another case showing pie() is rather fun than science:</span>
<span class="token comment">## (original by FinalBackwardsGlance on http://imgur.com/gallery/wWrpU4X)</span>
pie<span class="token punctuation">(</span>c<span class="token punctuation">(</span>Sky <span class="token operator">=</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token string">"Sunny side of pyramid"</span> <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token string">"Shady side of pyramid"</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    init.angle <span class="token operator">=</span> <span class="token number">315</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"deepskyblue"</span><span class="token punctuation">,</span> <span class="token string">"yellow"</span><span class="token punctuation">,</span> <span class="token string">"yellow3"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.dataframe">

<a href="#plot.dataframe" class="help-page-title"><h2>Plot Method for Data Frames</h2></a>

<h3>Description</h3>

<p><code>plot.data.frame</code>, a method for the <code><a href="#plot.default">plot</a></code> generic.
It is designed for a quick look at numeric data frames.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'data.frame'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to <code><a href="#stripchart">stripchart</a></code>,
<code><a href="#plot.default">plot.default</a></code> or <code><a href="#pairs">pairs</a></code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is intended for data frames with <em>numeric</em> columns. For more
than two columns it first calls <code><a href="https://r-universe.dev/manuals/base.html#data.matrix">data.matrix</a></code> to convert
the data frame to a numeric matrix and then calls <code><a href="#pairs">pairs</a></code>
to produce a scatterplot matrix.  This can fail and may well be
inappropriate: for example numerical conversion of dates will lose
their special meaning and a warning will be given.
</p>
<p>For a two-column data frame it plots the second column against the
first by the most appropriate method for the first column.
</p>
<p>For a single numeric column it uses <code><a href="#stripchart">stripchart</a></code>, and for
other single-column data frames tries to find a plot method for the
single column.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#data.frame">data.frame</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span>OrchardSprays<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"jitter"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>OrchardSprays<span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>OrchardSprays<span class="token punctuation">)</span>

plot<span class="token punctuation">(</span>iris<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>women<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.default">

<a href="#plot.default" class="help-page-title"><h2>The Default Scatterplot Function</h2></a>

<h3>Description</h3>

<p>Draw a scatter plot with decorations such as axes and titles
in the active graphics window.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Default S3 method:</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"p"</span><span class="token punctuation">,</span>  xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
     log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> sub <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
     ann <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"ann"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> axes<span class="token punctuation">,</span>
     panel.first <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> panel.last <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> asp <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
     xgap.axis <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> ygap.axis <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
     <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>the <code>x</code> and <code>y</code> arguments provide the x and y
coordinates for the plot.  Any reasonable way of defining the
coordinates is acceptable.  See the function <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>
for details.  If supplied separately, they must be of the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>1-character string giving the type of plot desired.  The
following values are possible, for details, see <code><a href="#plot.default">plot</a></code>:
<code>"p"</code> for points, <code>"l"</code> for lines,
<code>"b"</code> for both points and lines,
<code>"c"</code> for empty points joined by lines,
<code>"o"</code> for overplotted points and lines,
<code>"s"</code> and <code>"S"</code> for stair steps and
<code>"h"</code> for histogram-like vertical lines.  Finally,
<code>"n"</code> does not produce any points or lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>the x limits (x1, x2) of the plot.  Note that <code>x1 &gt; x2</code>
is allowed and leads to a ‘reversed axis’.
</p>
<p>The default value, <code>NULL</code>, indicates that the range of the
<a href="https://r-universe.dev/manuals/base.html#is.finite">finite</a> values to be plotted should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the y limits of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>a character string which contains <code>"x"</code> if the x axis
is to be logarithmic, <code>"y"</code> if the y axis is to be logarithmic
and <code>"xy"</code> or <code>"yx"</code> if both axes are to be logarithmic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>a main title for the plot, see also <code><a href="#title">title</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>a subtitle for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a label for the x axis, defaults to a description of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a label for the y axis, defaults to a description of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ann</code></td>
<td>
<p>a logical value indicating whether the default annotation
(title and x and y axis labels) should appear on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>a logical value indicating whether both axes should be drawn on
the plot.  Use <a href="#par">graphical parameter</a> <code>"xaxt"</code> or <code>"yaxt"</code>
to suppress just one of the axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame.plot</code></td>
<td>
<p>a logical indicating whether a box should be drawn
around the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel.first</code></td>
<td>
<p>an ‘expression’ to be evaluated after the
plot axes are set up but before any plotting takes place.  This can
be useful for drawing background grids or scatterplot smooths.  Note
that this works by lazy evaluation: passing this argument from other
<code>plot</code> methods may well not work since it may be evaluated too
early.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel.last</code></td>
<td>
<p>an expression to be evaluated after plotting has
taken place but before the axes, title and box are added.  See the
comments about <code>panel.first</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asp</code></td>
<td>
<p>the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi mathvariant="normal">/</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">y/x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">/</span><span class="mord mathnormal">x</span></span></span></span></code> aspect ratio, see <code><a href="#plot.window">plot.window</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgap.axis, ygap.axis</code></td>
<td>
<p>the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">/</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">x/y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></code> axis gap factors, passed as
<code>gap.axis</code> to the two <code><a href="#axis">axis</a>()</code> calls (when
<code>axes</code> is true, as per default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <a href="#par">graphical parameters</a> (see <code><a href="#par">par</a></code> and
section ‘Details’ below).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Commonly used <a href="#par">graphical parameters</a> are:
</p>

<dl>
<dt><code>col</code></dt>
<dd>
<p>The colors for lines and points.  Multiple colors can be
specified so that each point can be given its own color.  If there
are fewer colors than points they are recycled in the standard
fashion.  Lines will all be plotted in the first colour specified.</p>
</dd>
<dt><code>bg</code></dt>
<dd>
<p>a vector of background colors for open plot symbols, see
<code><a href="#points">points</a></code>.  Note: this is <b>not</b> the same setting
as <code><a href="#par">par</a>("bg")</code>.</p>
</dd>
<dt><code>pch</code></dt>
<dd>
<p>a vector of plotting characters or symbols:
see <code><a href="#points">points</a></code>.</p>
</dd>
<dt><code>cex</code></dt>
<dd>
<p>a numerical vector giving the amount by which
plotting characters and symbols should be scaled relative to the
default.  This works as a multiple of <code><a href="#par">par</a>("cex")</code>.
<code>NULL</code> and <code>NA</code> are equivalent to <code>1.0</code>.  Note that
this does not affect annotation: see below.</p>
</dd>
<dt><code>lty</code></dt>
<dd>
<p>a vector of line types, see <code><a href="#par">par</a></code>.</p>
</dd>
<dt>
<code>cex.main</code>, <code>col.lab</code>, <code>font.sub</code>,
etc</dt>
<dd>
<p>settings for main- and sub-title and axis annotation, see
<code><a href="#title">title</a></code> and <code><a href="#par">par</a></code>.</p>
</dd>
<dt><code>lwd</code></dt>
<dd>
<p>a vector of line widths, see <code><a href="#par">par</a></code>.</p>
</dd>
</dl>
<h3>Note</h3>

<p>The presence of <code>panel.first</code> and <code>panel.last</code> is a
historical anomaly: default plots do not have ‘panels’, unlike
e.g. <code><a href="#pairs">pairs</a></code> plots.  For more control, use lower-level
plotting functions: <code>plot.default</code> calls in turn some of
<code><a href="#frame">plot.new</a></code>, <code><a href="#plot.window">plot.window</a></code>,
<code><a href="#plot.xy">plot.xy</a></code>, <code><a href="#axis">axis</a></code>, <code><a href="#box">box</a></code> and
<code><a href="#title">title</a></code>, and plots can be built up by calling these
individually, or by calling <code>plot(type = "n")</code> and adding further
elements.
</p>
<p>The <code>plot</code> generic was moved from the <span class="pkg">graphics</span> package to
the <span class="pkg">base</span> package in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> 4.0.0. It is currently re-exported from
the <span class="pkg">graphics</span> namespace to allow packages importing it from there
to continue working, but this may change in future versions of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Cleveland, W. S. (1985)
<em>The Elements of Graphing Data.</em>
Monterey, CA: Wadsworth.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.default">plot</a></code>, <code><a href="#plot.window">plot.window</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>.
For thousands of points, consider using <code><a href="#smoothScatter">smoothScatter</a></code>
instead.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">Speed <span class="token operator">&lt;-</span> cars<span class="token operator">$</span>speed
Distance <span class="token operator">&lt;-</span> cars<span class="token operator">$</span>dist
plot<span class="token punctuation">(</span>Speed<span class="token punctuation">,</span> Distance<span class="token punctuation">,</span> panel.first <span class="token operator">=</span> grid<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     pch <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>Speed<span class="token punctuation">,</span> Distance<span class="token punctuation">,</span>
     panel.first <span class="token operator">=</span> lines<span class="token punctuation">(</span>stats<span class="token operator">::</span>lowess<span class="token punctuation">(</span>Speed<span class="token punctuation">,</span> Distance<span class="token punctuation">)</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token string">"dashed"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     pch <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span>

<span class="token comment">## Show the different plot types</span>
x <span class="token operator">&lt;-</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">12</span>
y <span class="token operator">&lt;-</span> sin<span class="token punctuation">(</span>pi<span class="token operator">/</span><span class="token number">5</span> <span class="token operator">*</span> x<span class="token punctuation">)</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar <span class="token operator">=</span> <span class="token number">.1</span><span class="token operator">+</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>tp <span class="token keyword">in</span> c<span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">,</span><span class="token string">"l"</span><span class="token punctuation">,</span><span class="token string">"b"</span><span class="token punctuation">,</span>  <span class="token string">"c"</span><span class="token punctuation">,</span><span class="token string">"o"</span><span class="token punctuation">,</span><span class="token string">"h"</span><span class="token punctuation">,</span>  <span class="token string">"s"</span><span class="token punctuation">,</span><span class="token string">"S"</span><span class="token punctuation">,</span><span class="token string">"n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   plot<span class="token punctuation">(</span>y <span class="token operator">~</span> x<span class="token punctuation">,</span> type <span class="token operator">=</span> tp<span class="token punctuation">,</span> main <span class="token operator">=</span> paste0<span class="token punctuation">(</span><span class="token string">"plot(*, type = \""</span><span class="token punctuation">,</span> tp<span class="token punctuation">,</span> <span class="token string">"\")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>tp <span class="token operator">==</span> <span class="token string">"S"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"s"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
      mtext<span class="token punctuation">(</span><span class="token string">"lines(*, type = \"s\", ...)"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">##--- Log-Log Plot  with  custom axes</span>
lx <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">41</span><span class="token punctuation">)</span>
yl <span class="token operator">&lt;-</span> expression<span class="token punctuation">(</span>e<span class="token operator">^</span><span class="token punctuation">{</span><span class="token operator">-</span>frac<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">{</span>log<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">.5</span><span class="token operator">*</span>lx<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"mar"</span><span class="token punctuation">)</span><span class="token operator">-</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mgp <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">.7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">^</span>lx<span class="token punctuation">,</span> y<span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"xy"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"purple"</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token string">"Log-Log plot"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> yl<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">^</span>lx<span class="token punctuation">,</span> y<span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"xy"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"o"</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"forestgreen"</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token string">"Log-Log plot with custom axes"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> yl<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"x"</span><span class="token punctuation">,</span>
     axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
my.at <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> my.at<span class="token punctuation">,</span> labels <span class="token operator">=</span> formatC<span class="token punctuation">(</span>my.at<span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
e.y <span class="token operator">&lt;-</span> <span class="token operator">-</span><span class="token number">5</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">;</span> at.y <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">^</span>e.y
axis<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> at <span class="token operator">=</span> at.y<span class="token punctuation">,</span> col.axis <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> las <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
     labels <span class="token operator">=</span> as.expression<span class="token punctuation">(</span>lapply<span class="token punctuation">(</span>e.y<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span> bquote<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">^</span>.<span class="token punctuation">(</span>E<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.design">

<a href="#plot.design" class="help-page-title"><h2>Plot Univariate Effects of a Design or Model</h2></a>

<h3>Description</h3>

<p>Plot univariate effects of one or more <code><a href="https://r-universe.dev/manuals/base.html#factor">factor</a></code>s,
typically for a designed experiment as analyzed by <code><a href="https://r-universe.dev/manuals/stats.html#aov">aov</a>()</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">plot.design<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> fun <span class="token operator">=</span> mean<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
            ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Factors"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
            main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ask <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xaxt <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"xaxt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> xtick <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a data frame containing the design factors and
optionally the response, or a <code><a href="https://r-universe.dev/manuals/stats.html#formula">formula</a></code> or
<code><a href="https://r-universe.dev/manuals/stats.html#terms">terms</a></code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response, if not given in x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a function (or name of one) to be applied to each
subset.  It must return one number for a numeric (vector) input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame containing the variables referenced by <code>x</code>
when that is formula-like.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a> such as <code>col</code>,
see <code><a href="#par">par</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>range of y values, as in <code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x axis label, see <code><a href="#title">title</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y axis label with a ‘smart’ default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title, see <code><a href="#title">title</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical indicating if the user should be asked before a new
page is started – in the case of multiple y's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxt</code></td>
<td>
<p>character giving the type of x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>logical indicating if axes should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtick</code></td>
<td>
<p>logical indicating if ticks (one per factor) should
be drawn on the x axis.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The supplied function will be called once for each level of each
factor in the design and the plot will show these summary values.  The
levels of a particular factor are shown along a vertical line, and the
overall value of <code>fun()</code> for the response is drawn as a
horizontal line.
</p>


<h3>Note</h3>

<p>A big effort was taken to make this closely compatible to the S
version.  However, <code>col</code> (and <code>fg</code>) specifications have
different effects.
</p>
<p>In S this was a method of the <code><a href="#plot.default">plot</a></code> generic function for
<code>design</code> objects.
</p>


<h3>Author(s)</h3>

<p>Roberto Frisullo and Martin Maechler</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. eds (1992)
<em>Statistical Models in S</em>.
Chapman &amp; Hall, London, <b>the</b> <em>white book</em>, pp. 546–7 (and 163–4).
</p>
<p>Freeny, A. E. and Landwehr, J. M. (1990)
Displays for data from large designed experiments;
Computer Science and Statistics: Proc.\ 22nd Symp\. Interface, 117–126,
Springer Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#interaction.plot">interaction.plot</a></code> for a ‘standard graphic’
of designed experiments.</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
plot.design<span class="token punctuation">(</span>warpbreaks<span class="token punctuation">)</span>  <span class="token comment"># automatic for data frame with one numeric var.</span>

Form <span class="token operator">&lt;-</span> breaks <span class="token operator">~</span> wool <span class="token operator">+</span> tension
summary<span class="token punctuation">(</span>fm1 <span class="token operator">&lt;-</span> aov<span class="token punctuation">(</span>Form<span class="token punctuation">,</span> data <span class="token operator">=</span> warpbreaks<span class="token punctuation">)</span><span class="token punctuation">)</span>
plot.design<span class="token punctuation">(</span>       Form<span class="token punctuation">,</span> data <span class="token operator">=</span> warpbreaks<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># same as above</span>

<span class="token comment">## More than one y :</span>
utils<span class="token operator">::</span>str<span class="token punctuation">(</span>esoph<span class="token punctuation">)</span>
plot.design<span class="token punctuation">(</span>esoph<span class="token punctuation">)</span> <span class="token comment">## two plots; if interactive you are "ask"ed</span>

<span class="token comment">## or rather, compare mean and median:</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfcol <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>
plot.design<span class="token punctuation">(</span>ncases<span class="token operator">/</span>ncontrols <span class="token operator">~</span> .<span class="token punctuation">,</span> data <span class="token operator">=</span> esoph<span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot.design<span class="token punctuation">(</span>ncases<span class="token operator">/</span>ncontrols <span class="token operator">~</span> .<span class="token punctuation">,</span> data <span class="token operator">=</span> esoph<span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            fun <span class="token operator">=</span> median<span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.factor">

<a href="#plot.factor" class="help-page-title"><h2>Plotting Factor Variables</h2></a>

<h3>Description</h3>

<p>This functions implements a scatterplot method for
<code><a href="https://r-universe.dev/manuals/base.html#factor">factor</a></code> arguments of the <em>generic</em>
<code><a href="#plot.default">plot</a></code> function.
</p>
<p>If <code>y</code> is missing <code><a href="#barplot">barplot</a></code> is produced.
For numeric <code>y</code> a <code><a href="#boxplot">boxplot</a></code> is used, and for a factor
<code>y</code> a <code><a href="#spineplot">spineplot</a></code> is shown.  For any other type of
<code>y</code> the next <code>plot</code> method is called, normally
<code><a href="#plot.default">plot.default</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'factor'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> legend.text <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>numeric or factor. <code>y</code> may be missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text</code></td>
<td>
<p>character vector for annotation of y axis in the
case of a factor <code>y</code>: defaults to <code>levels(y)</code>.  This
sets the <code>yaxlabels</code> argument of <code><a href="#spineplot">spineplot</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to <code><a href="#barplot">barplot</a></code>,
<code><a href="#boxplot">boxplot</a></code>, <code><a href="#spineplot">spineplot</a></code> or
<code><a href="#plot.default">plot</a></code> as appropriate.  All of these accept
<a href="#par">graphical parameters</a> (see <code><a href="#par">par</a></code>) and
annotation arguments passed
to <code><a href="#title">title</a></code> and <code>axes = FALSE</code>.  None accept <code>type</code>.
</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#plot.default">plot.default</a></code>, <code><a href="#plot.formula">plot.formula</a></code>,
<code><a href="#barplot">barplot</a></code>, <code><a href="#boxplot">boxplot</a></code>, <code><a href="#spineplot">spineplot</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span>


plot<span class="token punctuation">(</span>weight <span class="token operator">~</span> group<span class="token punctuation">,</span> data <span class="token operator">=</span> PlantGrowth<span class="token punctuation">)</span>           <span class="token comment"># numeric vector ~ factor</span>
plot<span class="token punctuation">(</span>cut<span class="token punctuation">(</span>weight<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">~</span> group<span class="token punctuation">,</span> data <span class="token operator">=</span> PlantGrowth<span class="token punctuation">)</span>   <span class="token comment"># factor ~ factor</span>
<span class="token comment">## passing "..." to spineplot() eventually:</span>
plot<span class="token punctuation">(</span>cut<span class="token punctuation">(</span>weight<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">~</span> group<span class="token punctuation">,</span> data <span class="token operator">=</span> PlantGrowth<span class="token punctuation">,</span>
     col <span class="token operator">=</span> hcl<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plot<span class="token punctuation">(</span>PlantGrowth<span class="token operator">$</span>group<span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"no axes"</span><span class="token punctuation">)</span>  <span class="token comment"># extremely silly</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.formula">

<a href="#plot.formula" class="help-page-title"><h2>Formula Notation for Scatterplots</h2></a>

<h3>Description</h3>

<p>Specify a scatterplot or add points, lines, or text via a formula.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'formula'</span>
plot<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> parent.frame<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> subset<span class="token punctuation">,</span>
             ylab <span class="token operator">=</span> varnames<span class="token punctuation">[</span>response<span class="token punctuation">]</span><span class="token punctuation">,</span> ask <span class="token operator">=</span> dev.interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
points<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> parent.frame<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> subset<span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
lines<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> parent.frame<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> subset<span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
text<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> parent.frame<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> subset<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/stats.html#formula">formula</a></code>, such as <code>y ~ x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>formula</code> should be taken.  A matrix is converted to a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to or from other methods.
<code>horizontal = TRUE</code> is also accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>the y label of the plot(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical, see <code><a href="#par">par</a></code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the <code>lines</code>, <code>points</code> and <code>text</code> methods the formula
should be of the form <code>y ~ x</code> or <code>y ~ 1</code> with a left-hand
side and a single term on the right-hand side.  The <code>plot</code> method
accepts other forms discussed later in this section.
</p>
<p>Both the terms in the formula and the <code>...</code> arguments are
evaluated in <code>data</code> enclosed in <code>parent.frame()</code> if
<code>data</code> is a list or a data frame.  The terms of the formula and
those arguments in <code>...</code> that are of the same length as
<code>data</code> are subjected to the subsetting specified in
<code>subset</code>.  A plot against the running index can be specified as
<code>plot(y ~ 1)</code>.
</p>
<p>If the formula in the <code>plot</code> method contains more than one term
on the right-hand side, a series of plots is produced of the response
against each non-response term.
</p>
<p>For the <code>plot</code> method the formula can be of the form
<code>~ z + y + z</code>: the variables specified on the right-hand side are
collected into a data frame, subsetted if specified, and displayed by
<code><a href="#plot.dataframe">plot.data.frame</a></code>.
</p>
<p>Missing values are not considered in these methods, and in particular
cases with missing values are not removed.
</p>
<p>If <code>y</code> is an object (i.e., has a <code><a href="https://r-universe.dev/manuals/base.html#class">class</a></code> attribute)
then <code>plot.formula</code> looks for a plot method for that class first.
Otherwise, the class of <code>x</code> will determine the type of the plot.
For factors this will be a parallel boxplot, and argument
<code>horizontal = TRUE</code> can be specified (see <code><a href="#boxplot">boxplot</a></code>).
</p>
<p>Note that some arguments will need to be protected from premature
evaluation by enclosing them in <code><a href="https://r-universe.dev/manuals/base.html#substitute">quote</a></code>: currently this is
done automatically for <code>main</code>, <code>sub</code> and <code>xlab</code>.  For
example, it is needed for the <code>panel.first</code> and <code>panel.last</code>
arguments passed to <code><a href="#plot.default">plot.default</a></code>.
</p>


<h3>Value</h3>

<p>These functions are invoked for their side effect of drawing
on the active graphics device.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.default">plot.default</a></code>, <code><a href="#points">points</a></code>, <code><a href="#lines">lines</a></code>,
<code><a href="#plot.factor">plot.factor</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>Ozone <span class="token operator">~</span> Wind<span class="token punctuation">,</span> data <span class="token operator">=</span> airquality<span class="token punctuation">,</span> pch <span class="token operator">=</span> as.character<span class="token punctuation">(</span>Month<span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>Ozone <span class="token operator">~</span> Wind<span class="token punctuation">,</span> data <span class="token operator">=</span> airquality<span class="token punctuation">,</span> pch <span class="token operator">=</span> as.character<span class="token punctuation">(</span>Month<span class="token punctuation">)</span><span class="token punctuation">,</span>
     subset <span class="token operator">=</span> Month <span class="token operator">!=</span> <span class="token number">7</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## text.formula() can be very natural:</span>
wb <span class="token operator">&lt;-</span> within<span class="token punctuation">(</span>warpbreaks<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    time <span class="token operator">&lt;-</span> seq_along<span class="token punctuation">(</span>breaks<span class="token punctuation">)</span><span class="token punctuation">;</span> W.T <span class="token operator">&lt;-</span> wool<span class="token operator">:</span>tension <span class="token punctuation">}</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>breaks <span class="token operator">~</span> time<span class="token punctuation">,</span> data <span class="token operator">=</span> wb<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span>breaks <span class="token operator">~</span> time<span class="token punctuation">,</span> data <span class="token operator">=</span> wb<span class="token punctuation">,</span> labels <span class="token operator">=</span> W.T<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span>as.integer<span class="token punctuation">(</span>wool<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plothistogram">

<a href="#plothistogram" class="help-page-title"><h2>Plot Histograms</h2></a>

<h3>Description</h3>

<p>Plotting methods for objects of class <code>"histogram"</code>, typically
produced by <code><a href="#hist">hist</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'histogram'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> freq <span class="token operator">=</span> equidist<span class="token punctuation">,</span> density <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span>
               col <span class="token operator">=</span> <span class="token string">"lightgray"</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
               main <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"Histogram of"</span><span class="token punctuation">,</span> paste<span class="token punctuation">(</span>x<span class="token operator">$</span>xname<span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               sub <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> x<span class="token operator">$</span>xname<span class="token punctuation">,</span> ylab<span class="token punctuation">,</span>
               xlim <span class="token operator">=</span> range<span class="token punctuation">(</span>x<span class="token operator">$</span>breaks<span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
               axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
               ann <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'histogram'</span>
lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>histogram</code> object, or a <code><a href="https://r-universe.dev/manuals/base.html#list">list</a></code> with components
<code>density</code>, <code>mid</code>, etc, see <code><a href="#hist">hist</a></code> for
information about the components of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>logical; if <code>TRUE</code>, the
histogram graphic is to present a representation of frequencies, i.e,
<code>x$counts</code>; if <code>FALSE</code>, <em>relative</em> frequencies
(probabilities), i.e., <code>x$density</code>, are plotted.  The
default is true for equidistant <code>breaks</code> and false otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a colour to be used to fill the bars.  The default has been
changed from <code>NULL</code> (unfilled bars) only for <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> 4.2.0 for
consistency with the change in <code><a href="#hist">hist.default</a></code> for <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> 4.0.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>the color of the border around the bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle, density</code></td>
<td>
<p>select shading of bars by lines:
see <code><a href="#rect">rect</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>the line type used for the bars, see also <code><a href="#lines">lines</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, sub, xlab, ylab</code></td>
<td>
<p>these arguments to <code>title</code> have useful
defaults here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>the range of x and y values with sensible defaults.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>logical, indicating if axes should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>logical or character.  Additionally draw labels on top of bars,
if not <code>FALSE</code>; if <code>TRUE</code>, draw the counts or rounded
densities; if <code>labels</code> is a <code>character</code>, draw itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical.  If <code>TRUE</code>, only the bars are added to the
current plot.  This is what <code>lines.histogram(*)</code> does.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ann</code></td>
<td>
<p>logical.  Should annotations (titles and axis titles) be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further <a href="#par">graphical parameters</a> to
<code>title</code> and <code>axis</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lines.histogram(*)</code> is the same as
<code>plot.histogram(*, add = TRUE)</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#hist">hist</a></code>,
<code><a href="#stem">stem</a></code>,
<code><a href="https://r-universe.dev/manuals/stats.html#density">density</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token punctuation">(</span>wwt <span class="token operator">&lt;-</span> hist<span class="token punctuation">(</span>women<span class="token operator">$</span>weight<span class="token punctuation">,</span> nclass <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>wwt<span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># default main &amp; xlab using wwt$xname</span>
plot<span class="token punctuation">(</span>wwt<span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"dark blue"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"light blue"</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token string">"Histogram of 15 women's weights"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"weight [pounds]"</span><span class="token punctuation">)</span>

<span class="token comment">## Fake "lines" example, using non-default labels:</span>
w2 <span class="token operator">&lt;-</span> wwt<span class="token punctuation">;</span> w2<span class="token operator">$</span>counts <span class="token operator">&lt;-</span> w2<span class="token operator">$</span>counts <span class="token operator">-</span> <span class="token number">1</span>
lines<span class="token punctuation">(</span>w2<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"Midnight Blue"</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> ifelse<span class="token punctuation">(</span>w2<span class="token operator">$</span>counts<span class="token punctuation">,</span> <span class="token string">"&gt; 1"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.raster">

<a href="#plot.raster" class="help-page-title"><h2>Plotting Raster Images</h2></a>

<h3>Description</h3>

<p>This functions implements a <code><a href="#plot.default">plot</a></code> method for raster images.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'raster'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
     xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> ncol<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> nrow<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     xaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">,</span> yaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">,</span>
     asp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>raster. <code>y</code> will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>Limits on the plot region (default from dimensions
of the raster).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxs, yaxs</code></td>
<td>
<p>Axis interval calculation style (default means that
raster fills plot region).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asp</code></td>
<td>
<p>Aspect ratio (default retains aspect ratio of the raster).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Logical indicating whether to simply add raster to an
existing plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to the <code><a href="#rasterImage">rasterImage</a></code> function.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#plot.default">plot.default</a></code>, <code><a href="#rasterImage">rasterImage</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> as.raster<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token comment"># additional arguments to rasterImage()</span>
plot<span class="token punctuation">(</span>r<span class="token punctuation">,</span> interpolate<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
<span class="token comment"># distort</span>
plot<span class="token punctuation">(</span>r<span class="token punctuation">,</span> asp<span class="token operator">=</span><span class="token keyword">NA</span><span class="token punctuation">)</span>
<span class="token comment"># fill page</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mar<span class="token operator">=</span>rep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>r<span class="token punctuation">,</span> asp<span class="token operator">=</span><span class="token keyword">NA</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>
<span class="token comment"># normal annotations work</span>
plot<span class="token punctuation">(</span>r<span class="token punctuation">,</span> asp<span class="token operator">=</span><span class="token keyword">NA</span><span class="token punctuation">)</span>
box<span class="token punctuation">(</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span>main<span class="token operator">=</span><span class="token string">"This is my raster"</span><span class="token punctuation">)</span>
<span class="token comment"># add to existing plot</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>r<span class="token punctuation">,</span> add<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.table">

<a href="#plot.table" class="help-page-title"><h2>Plot Methods for <code>table</code> Objects</h2></a>

<h3>Description</h3>

<p>This is a method of the generic <code>plot</code> function for
(contingency) <code><a href="https://r-universe.dev/manuals/base.html#table">table</a></code> objects.  Whereas for two- and more
dimensional tables, a <code><a href="#mosaicplot">mosaicplot</a></code> is drawn,
one-dimensional ones are plotted as bars.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## S3 method for class 'table'</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"h"</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> max<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
     xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> is.num<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'table'</span>
points<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"h"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token comment">## S3 method for class 'table'</span>
lines<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"h"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/base.html#table">table</a></code> (like) object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Must be <code>NULL</code>: there to protect against incorrect calls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>plotting type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>range of y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width for bars when <code>type = "h"</code> is used in the 1D case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>x- and y-axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame.plot</code></td>
<td>
<p>logical indicating if a frame (<code><a href="#box">box</a></code>)
should be drawn in the 1D case.  Defaults to true when <code>x</code> has
<code><a href="https://r-universe.dev/manuals/base.html#dimnames">dimnames</a></code> coerce-able to numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further graphical arguments, see <code><a href="#plot.default">plot.default</a></code>.
<code>axes = FALSE</code> is accepted.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code><a href="#plot.factor">plot.factor</a></code>, the <code><a href="#plot.default">plot</a></code> method for factors.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## 1-d tables</span>
<span class="token punctuation">(</span>Poiss.tab <span class="token operator">&lt;-</span> table<span class="token punctuation">(</span>N <span class="token operator">=</span> stats<span class="token operator">::</span>rpois<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> lambda <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>Poiss.tab<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"plot(table(rpois(200, lambda = 5)))"</span><span class="token punctuation">)</span>

plot<span class="token punctuation">(</span>table<span class="token punctuation">(</span>state.division<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## 4-D :</span>
plot<span class="token punctuation">(</span>Titanic<span class="token punctuation">,</span> main <span class="token operator">=</span><span class="token string">"plot(Titanic, main= *)"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.window">

<a href="#plot.window" class="help-page-title"><h2>Set up World Coordinates for Graphics Window</h2></a>

<h3>Description</h3>

<p>This function sets up the world coordinate system for a graphics
window.  It is called by higher level functions such as
<code><a href="#plot.default">plot.default</a></code> (<em>after</em> <code><a href="#frame">plot.new</a></code>).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">plot.window<span class="token punctuation">(</span>xlim<span class="token punctuation">,</span> ylim<span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> asp <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y
coordinates ranges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>character; indicating which axes should be in log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asp</code></td>
<td>
<p>numeric, giving the <b>asp</b>ect ratio y/x,
see ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further <a href="#par">graphical parameters</a> as in <code><a href="#par">par</a></code>.
The relevant ones are <code>xaxs</code>, <code>yaxs</code> and <code>lab</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>asp:</dt>
<dd>
<p>If <code>asp</code> is a finite positive value then the window is
set up so that one data unit in the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></code> direction is equal in length to
<code>asp</code> <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">×</span></span></span></span></code> one data unit in the <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code> direction.
</p>
<p>Note that in this case, <code><a href="#par">par</a>("usr")</code> is no longer
determined by, e.g., <code>par("xaxs")</code>, but rather by <code>asp</code> and
the device's aspect ratio.  (See what happens if you interactively
resize the plot device after running the example below!)
</p>
<p>The special case <code>asp == 1</code> produces plots where distances
between points are represented accurately on screen.  Values with
<code>asp &gt; 1</code> can be used to produce more accurate maps when using
latitude and longitude.
</p>
</dd>
</dl>
<p>Note that the coordinate ranges will be extended by 4% if the
appropriate <a href="#par">graphical parameter</a> <code>xaxs</code> or <code>yaxs</code> has value
<code>"r"</code> (which is the default).
</p>
<p>To reverse an axis, use <code>xlim</code> or <code>ylim</code> of the form
<code>c(hi, lo)</code>.
</p>
<p>The function attempts to produce a plausible set of scales if one or
both of <code>xlim</code> and <code>ylim</code> is of length one or the two values
given are identical, but it is better to avoid that case.
</p>
<p>Usually, one should rather use the higher-level functions such as
<code><a href="#plot.default">plot</a></code>, <code><a href="#hist">hist</a></code>, <code><a href="#image">image</a></code>, ...,
instead and refer to their help pages for explanation of the
arguments.
</p>
<p>A side-effect of the call is to set up the <code>usr</code>, <code>xaxp</code> and
<code>yaxp</code> <a href="#par">graphical parameters</a>.  (It is for the latter two that
<code>lab</code> is used.)
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>,
<code><a href="#plot.xy">plot.xy</a></code>,
<code><a href="#plot.default">plot.default</a></code>.
</p>
<p><code><a href="#par">par</a></code> for the graphical parameters mentioned.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">##--- An example for the use of 'asp' :</span>
require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>  <span class="token comment"># normally loaded</span>
loc <span class="token operator">&lt;-</span> cmdscale<span class="token punctuation">(</span>eurodist<span class="token punctuation">)</span>
rx <span class="token operator">&lt;-</span> range<span class="token punctuation">(</span>x <span class="token operator">&lt;-</span> loc<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ry <span class="token operator">&lt;-</span> range<span class="token punctuation">(</span>y <span class="token operator">&lt;-</span> <span class="token operator">-</span>loc<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> asp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>h <span class="token operator">=</span> pretty<span class="token punctuation">(</span>rx<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v <span class="token operator">=</span> pretty<span class="token punctuation">(</span>ry<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightgray"</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> labels<span class="token punctuation">(</span>eurodist<span class="token punctuation">)</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="plot.xy">

<a href="#plot.xy" class="help-page-title"><h2>Basic Internal Plot Function</h2></a>

<h3>Description</h3>

<p>This is <em>the</em> internal function that does the basic plotting of
points and lines.  Usually, one should rather use the higher level
functions instead and refer to their help pages for explanation of the
arguments.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">plot.xy<span class="token punctuation">(</span>xy<span class="token punctuation">,</span> type<span class="token punctuation">,</span> pch <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"pch"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lty"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"col"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
        cex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lwd"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>
<p>A four-element list as results from
<code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>1 character code: see <code><a href="#plot.default">plot.default</a></code>.
<code>NULL</code> is accepted as a synonym for <code>"p"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>character or integer code for kind of points, see
<code><a href="#points">points.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>line type code, see <code><a href="#lines">lines</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color code or name, see <code><a href="https://r-universe.dev/manuals/grDevices.html#colors">colors</a></code>,
<code><a href="https://r-universe.dev/manuals/grDevices.html#palette">palette</a></code>.  Here <code>NULL</code> means colour 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>background (fill) color for the open plot symbols 21:25:
see <code><a href="#points">points.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>character expansion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width, also used for (non-filled) plot symbols, see
<code><a href="#lines">lines</a></code> and <code><a href="#points">points</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further <a href="#par">graphical parameters</a> such as <code>xpd</code>,
<code>lend</code>, <code>ljoin</code> and <code>lmitre</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The arguments <code>pch</code>, <code>col</code>, <code>bg</code>, <code>cex</code>,
<code>lwd</code> may be vectors and may be recycled, depending on
<code>type</code>: see <code><a href="#points">points</a></code> and <code><a href="#lines">lines</a></code> for
specifics.  In particular note that <code>lwd</code> is treated as a vector
for points and as a single (first) value for lines.
</p>
<p><code>cex</code> is a numeric factor in addition to <code>par("cex")</code> which
affects symbols and characters as drawn by <code>type</code> <code>"p"</code>,
<code>"o"</code>, <code>"b"</code> and <code>"c"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.default">plot</a></code>,
<code><a href="#plot.default">plot.default</a></code>,
<code><a href="#points">points</a></code>,
<code><a href="#lines">lines</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">points.default <span class="token comment"># to see how it calls "plot.xy(xy.coords(x, y), ...)"</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="points">

<a href="#points" class="help-page-title"><h2>Add Points to a Plot</h2></a>

<h3>Description</h3>

<p><code>points</code> is a generic function to draw a sequence of points at
the specified coordinates.  The specified character(s) are plotted,
centered at the coordinates.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">points<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
points<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"p"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>coordinate vectors of points to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character indicating the type of plotting; actually any of
the <code>type</code>s as in <code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further <a href="#par">graphical parameters</a> may also be supplied as
arguments.  See ‘Details’.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The coordinates can be passed in a plotting structure
(a list with <code>x</code> and <code>y</code> components), a two-column matrix, a
time series, ....  See <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>.  If supplied
separately, they must be of the same length.
</p>
<p>Graphical parameters commonly used are
</p>

<dl>
<dt><code>pch</code></dt>
<dd>
<p>plotting ‘character’, i.e., symbol to use.
This can either be a single character or an integer code for one
of a set of graphics symbols.  The full set of S symbols is
available with <code>pch = 0:18</code>, see the examples below.
(NB: <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> uses circles instead of the octagons used in S.)
</p>
<p>Value <code>pch = "."</code> (equivalently <code>pch = 46</code>) is handled
specially.  It is a rectangle of side 0.01 inch (scaled by
<code>cex</code>).  In addition, if <code>cex = 1</code> (the default), each
side is at least one pixel (1/72 inch on the <code><a href="https://r-universe.dev/manuals/grDevices.html#pdf">pdf</a></code>,
<code><a href="https://r-universe.dev/manuals/grDevices.html#postscript">postscript</a></code> and <code><a href="https://r-universe.dev/manuals/grDevices.html#xfig">xfig</a></code> devices).
</p>
<p>For other text symbols, <code>cex = 1</code> corresponds to the default
fontsize of the device, often specified by an argument
<code>pointsize</code>.  For <code>pch</code> in <code>0:25</code> the default size
is about 75% of the character height (see <code>par("cin")</code>).
</p>
</dd>
<dt><code>col</code></dt>
<dd>
<p>color code or name, see <code><a href="#par">par</a></code>.</p>
</dd>
<dt><code>bg</code></dt>
<dd>
<p>background (fill) color for the open plot
symbols given by <code>pch = 21:25</code>.</p>
</dd>
<dt><code>cex</code></dt>
<dd>
<p>character (or symbol) expansion: a numerical vector.
This works as a multiple of <code><a href="#par">par</a>("cex")</code>.</p>
</dd>
<dt><code>lwd</code></dt>
<dd>
<p>line width for drawing symbols see <code><a href="#par">par</a></code>.</p>
</dd>
</dl>
<p>Others less commonly used are <code>lty</code> and <code>lwd</code> for
types such as <code>"b"</code> and <code>"l"</code>.
</p>
<p>The <a href="#par">graphical parameters</a> <code>pch</code>, <code>col</code>, <code>bg</code>,
<code>cex</code> and <code>lwd</code> can be vectors (which will be recycled as
needed) giving a value for each point plotted.  If lines are to be
plotted (e.g., for <code>type = "b"</code>) the first element of <code>lwd</code>
is used.
</p>
<p>Points whose <code>x</code>, <code>y</code>, <code>pch</code>, <code>col</code> or <code>cex</code>
value is <code>NA</code> are omitted from the plot.
</p>


<h3>'pch' values</h3>

<p>Values of <code>pch</code> are stored internally as integers.  The
interpretation is
</p>

<ul>
<li> <p><code>NA_integer_</code>: no symbol.
</p>
</li>
<li> <p><code>0:18</code>: S-compatible vector symbols.
</p>
</li>
<li> <p><code>19:25</code>: further <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> vector symbols.
</p>
</li>
<li> <p><code>26:31</code>: unused (and ignored).
</p>
</li>
<li> <p><code>32:127</code>: ASCII characters.
</p>
</li>
<li> <p><code>128:255</code> native characters <em>only in a
single-byte locale and for the symbol font</em>.  (<code>128:159</code> are
only used on Windows.)
</p>
</li>
<li> <p><code>-32 ...</code> Unicode code point (where supported).
</p>
</li>
</ul>
<p>Note that unlike S (which uses octagons), symbols <code>1</code>, <code>10</code>,
<code>13</code> and <code>16</code> use circles.  The filled shapes <code>15:18</code>
do not include a border.
</p>


<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArwAAABGCAYAAAAuLEcVAAADJWlDQ1BJQ0MgUHJvZmlsZQAAeAGFlE1IFGEYx/+zjQSxBtGXCMXQwSRUJgtSAtP1K1O2ZdVMCWKdfXedHGenmd0tRSKE6Jh1jC5WRIeITuGhQ6c6RASZdYmgo0UQBV4itv87k7tjVL4wM795nv/7fL3DAFWPUo5jRTRgys67yd6Ydnp0TNv8GlWoRhRcKcNzOhKJAZ+plc/1a/UtFGlZapSx1vs2fKt2mRBQNCp3ZAM+LHk84OOSL+SdPDVnJBsTqTTZITe4Q8lO8i3y1myIx0OcFp4BVLVTkzMcl3EiO8gtRSMrYz4g63batMnvpT3tGVPUsN/INzkL2rjy/UDbHmDTi4ptzAMe3AN211Vs9TXAzhFg8VDF9j3pz0fZ9crLHGr2wynRGGv6UCp9rwM23wB+Xi+VftwulX7eYQ7W8dQyCm7R17Iw5SUQ1BvsZvzkGv2Lg558VQuwwDmObAH6rwA3PwL7HwLbHwOJamCoFZHLbDe48uIi5wJ05pxp18xO5LVmXT+idfBohdZnG00NWsqyNN/laa7whFsU6SZMWQXO2V/beI8Ke3iQT/YXuSS87t+szKVTXZwlmtjWp7To6iY3kO9nzJ4+cj2v9xm3Zzhg5YCZ7xsKOHLKtuI8F6mJ1Njj8ZNkxldUJx+T85A85xUHZUzffi51IkGupT05meuXml3c2z4zMcQzkqxYMxOd8d/8xi0kZd591Nx1LP+bZ22RZxiFBQETNu82NCTRixga4cBFDhl6TCpMWqVf0GrCw+RflRYS5V0WFb1Y4Z4Vf895FLhbxj+FWBxzDeUImv5O/6Iv6wv6Xf3zfG2hvuKZc8+axqtrXxlXZpbVyLhBjTK+rCmIb7DaDnotZGmd4hX05JX1jeHqMvZ8bdmjyRzianw11KUIZWrEOOPJrmX3RbLFN+HnW8v2r+lR+3z2SU0l17K6eGYp+nw2XA1r/7OrYNKyq/DkjZAuPGuh7lUPqn1qi9oKTT2mtqttahffjqoD5R3DnJWJC6zbZfUp9mBjmt7KSVdmi+Dfwi+G/6VeYQvXNDT5D024uYxpCd8R3DZwh5T/w1+zAw3eoYKLCAAAIABJREFUeAHtnQeYJEUZhv+7A8kZJCfJIFlJIhxZckZAwgEiSZAkSUBEkZxEEAkiOeecEck5g4BwIjlKDgJtvYU1T29v785MV83d9uz3P8/sznT4u+qr9P2hZoZkTkwiBISAEBACQkAICAEhIAS6FIGhXVovVUsICAEhIASEgBAQAkJACHgERHjVEYSAEBACQkAICAEhIAS6GgER3q5uXlVOCAgBISAEhIAQEAJCQIRXfUAICAEhIASEgBAQAkKgqxEQ4e3q5lXlhIAQEAJCQAgIASEgBER41QeEgBAQAkJACAgBISAEuhoBEd6ubl5VTggIASEgBISAEBACQkCEV31ACAgBISAEhIAQEAJCoKsREOHt6uZV5YSAEBACQkAICAEhIAREeNUHhIAQEAJCQAgIASEgBLoaARHerm5eVU4ICAEhIASEgBAQAkJAhFd9QAgIASEgBISAEBACQqCrERDh7ermVeWEgBAQAkJACAgBISAERHjVB4SAEBACQkAICAEhIAS6GgER3q5uXlVOCAgBISAEhIAQEAJCQIRXfUAICAEhIASEgBAQAkKgqxEQ4e3q5lXlhIAQEAJCQAgIASEgBER41QeEgBAQAkJACAgBISAEuhoBEd6ubl5VTggIASEgBISAEBACQkCEV31ACAgBISAEhIAQEAJCoKsREOHt6uZV5YSAEBACQkAICAEhIAREeNUHhIAQEAJCQAgIASEgBLoaARHerm5eVU4ICAEhIASEgBAQAkJAhFd9QAgIASEgBISAEBACQqCrERh2gJM61/DTTz+1888/35577jmbe+6561yVjpT9gw8+sPPOO8/+/e9/2xxzzNGRZ3RSKe16+eWX28MPP2wff/yxzTDDDMkfd8cdd9i9995rs846q40xxhhJ9Z966qm+7JT/n//8p80zzzxJ9dP/L774Ynvttdds5plntiFDhiTV//nnn9tFF11kL7/8sscnpfLHHnvM3n//fZtsssksyzK7+uqr7fbbb/cYpW6HlOUeVbry+PBMsLnmmmvsO9/5jo077rijqhiVn1Ms/1//+ld76KGH/HhYYIEFovtqUf+bb75p5557ru9PE088ceVyj6obi+V/4IEH7LrrrrMZZ5zRxhlnnOhivPXWW4bOmWaayetiDqL/oD+2/7z++ut+3f3iiy9suumm8/qZQ5mred54440XXf46KyjDp07jt6z8qcfv6Gjf2nt4d9ttNxtrrLH8RHriiSd2BEMG8gYbbNAR3ZCJLbbYwjbffHNPulI/ZNttt/UT0p133mlnnHFGavVeH0QUIsfkl1oo80cffWSTTjpp9CRdVrbdd9/dXnrpJfvwww/t4IMPLrsk6hhkjtfzzz/vF5soZSU3U34Wx3vuucdOP/30kiviDtEvGV+PPvqo/elPf4pTlrv7tttuszXWWMOeeeYZf/Tkk0/2Y3jssce2nXbaKXdltbcQ6B133NGuvPLKhgKMgsUXX7zxOeZNUf+DDz5om222mR/LGJixUsTn+uuv94bHvPPOaxtvvHGsem9gFPFB6YEHHpiknYvlx2BirmMc84qVon7I3K677mrzzTefbbPNNvbf//436hHF9j3uuONstdVW86+55prLk/aYBxTL/8gjj9gxxxxjc845p+9HMbq599lnn7U111zTbrnlFq/qhhtusGOPPdYbrVtuuaV9/fXXlR/BvcwL4HDOOef4MXbffffZH//4R5tllln8ucrK/3/jYYcdZltttZUfT6+++qo/+tlnn9myyy5r4XPMM4r6MQ6oE8+MXQfK8Ek9fovlD1ikGL9l5U89fkN5R/X/2hPekSNH2vrrr284qrEuU8sll1xiRx99tH3yySepVXt9THynnXaaHXnkkUYnTi1HHXWULbPMMjbJJJN0rA777bdftLemr3o/8cQT3qM1/vjj24ILLtjXZZWP42XB873QQgvZvvvuW1lPXzeutdZa9qMf/cggRCw4qeXdd9+1qaaayqaeemrDw5VSmPjQufbaa3sSetlllyVTzwKPMRY80ldddZXts88+tskmm3hPeOyDNt10U3v66ac9sUMX/YjFLJYIhXIV9UOsGWuM5RNOOCFcVvl/EZ/FFlvMzw/TTjut4XWPlWL50YfRBDH68ssvY9VbsfwQ0u9+97s+SjN8+PBGu1d9UFH/2Wef7ckR44GIx5hjjllVtb+viA/GAX30kEMOMbzTsXNRsfzvvPOO4ZWeZpppjKhcrNx11122yy67NNTg2d15551t6aWX9s9h3awq9D/WqyWWWMKWW24570W+4oorvMHBXIfH98UXX6yq3js43nvvPSM6tuGGG/oxhdMDA5mIUKygq6j/5ptvtq233to/kyjEG2+8UfkxZfikHL9l5aewqcZvWflTj9/K4EbeWGvCi0cRSxxhgkuxEBTxXHHFFTviOQvPwSpGrr32Wm/dh+Op/kOGLrjgArv00ksN71BqwcjA0g9hs9T6Q7ibtAOIdUphYWEgs8gTrklBVMrKR5gV79CEE05Ydjrq2EorreSJ4imnnGIQiZQydOhQ740jZYgFjkU5lbD45sOeRAlCGgMk+Kuvvop6FNEePFyBUJMGQMoEhl8KKerH4J588skNA2qCCSaIfkQRn4kmmsggcxyHcMVKsfwsosxFeElTSLH8zM2E0TFcV1555WhSXdT/yiuvGGOA1C3aPVaK+AR94JPCcC2Wn3Sqp556yhuWiyyySHhc5f8jRowwjKMgyy+/vPcgMwYgRkQ7qgoRJYwXSDPzwnbbbWfgz1yN8P/tt9+uqt73keBlhaizvhD5wahMsYbRB4v6IdZLLrmkn+PoQzEpMWX4pBy/ZeVPOX7Lyp96/FbuHJE31prwfutb32osjHij6AippRM6i2W88MILDQt5//33L56K/oylymAmpJKaMKKbMPqqq65qhJsIC6UWvN6rr766xwZveEqBcOEZ3Xvvve2II47oSISA8kJ4CZelFvo8izzeiRtvvLEjHuqzzjrLkxMWTMKVnRLIbjBeSaEYNmxY1KOK4xayFchvlOL/31zUz2GMJ4gMnqnUgrExxRRT+D7KOAupIFWfUyz/Hnvs4T1cGIG8UnnCQ/lwHODBh4wuuuii0SkBQW/4jzG5ww47+DoQsXnyySfDqUr/i/ig5PHHH/ck8tvf/nYlnf3dRDoDJIx1AMOG6ERKweCGmNKPMJKnn376KPX/+Mc/fMSElDOcKhiSpIUheGE5FiusV7TDOuus441h5oWUktePXtYzosXHH3+8T+OKeVYRn9Tjl7Lly596/BbL3+nxG4N1O/fWmvBSUaxJ8lPJLyR0XzeBUEBWIEWpBzRYkB9MPhceZBaalIIVT/iKMB8bsgjnppaNNtrIGHzkRRJCSymQqtlnn92nGxCuJH8utRCFgJhi4acWPLCEQMGeMdCJTZvbb7+9LbXUUj4lgPy5TgnPII+XjR0Qu7rJ/fff740ywukpFvti/fHMYZThVWNDCR7rlIJ3mrLzIuJBzl5KQe+hhx5qL7zwgie7KbzU+fKtssoqnizinSN9hY1ZqYVIB3nanZCFF17Y7+EgP5VX6vLjHWUDGykNeGPDRrMqdYHQrrfeesb+AdaAf/3rXwYhYg3G0OBz3rtc5RkQOPrkQQcdVOX2pvcU9TOmSGOhDrRFjJThk3r8FsufcvyWlb/T4zcG73burf23NDDRsbMVDxEWLCQgtRBeJS0gxWaRfNnwpOA5wzpmMmXRJAcqpWAEQKbxgIBPCBuneAaeDsKTvG666Sb7wx/+EO2ZK5aL8oM9EygenJReOp6FxwmDg4USizk2969YfrweU045ZUfINM+CKIIPeZds9iLqkVLmn39+n+5BHTCeUgptycKL0fqDH/zAkzm8aHgCCavFChtpCE3mv53kzDPPTEZa8vrxoOGhJgTLeEsxV+TxIYTMonzrrbd6Tz4LXKzky884YxzjUWOs4QWMlXz52UxG+e+++26fi1zmQW33eXn9GKvMo+TyspE5xbe55PGhbMxv5J2n6Jvoy5efTb947uk/lJ/IUwrB0CbdjJQJDAFyexlfMelVEFrWRIgzzhTWFNZhUnlwHOy1116N9IYqdQB38o+JMrApjnzbkObBPgLyhmPShsr08xzqQroH73EOVd1cWYYPXupU47es/HvuuWey8VtWfgyc1OO3St+IvWeIm6S/SYKN1aT7hYAQEAJCQAgIASEgBITAAEQgvTt0AFZSRRICQkAICAEhIASEgBAYvAiI8A7etlfNhYAQEAJCQAgIASEwKBAQ4R0UzaxKCgEhIASEgBAQAkJg8CIgwjt42141FwJCQAgIASEgBITAoEBAhHdQNLMqKQSEgBAQAkJACAiBwYuACO/gbXvVXAgIASEgBISAEBACgwIBEd5B0cyqpBAQAkJACAgBISAEBi8CIryDt+1VcyEgBISAEBACQkAIDAoERHgHQDM/88wz/pe+BkBRVAQh0HUI8NPLL774YtfVSxUSAkJACPAroU899ZSAaAEB/dJaCyB18hJ+PpGfDZ1qqqnsb3/7W0cexe+D8zPA6667bkf0d1IpPwS48847+5+I/c1vftPJR9VW96mnnmrjjjuubbTRRsnrAP783PXYY49tl19+eXL9o0IhP1vMz592anyNijroGaMPgYceesg+/vhj++EPfzj6CqEn1xaBDz74wD777DO/BneiEksuuaS9+uqrhuMs9U/Ld6K8o1PnGKPz4VWf/cknn9jNN9/sf7u+TMeYY45pK664og0bNqzsdFvH/vOf/9iDDz7oF8zvf//7nli0paDJxfw+O2T3jTfesAsvvNDWX3/9Jne0f/rpp5+2999/v/0b+7jj008/9R7p2WefvfSKJ5980uaYYw6PWekFLR6EbG299db26KOP2kcffeQnjUMPPbTFu0ffZfSZ8847z6aZZprSQjA5bbbZZpX7EpMnv3cOxggT3fjjj994Ftb+bLPNZoyDGAH/7bff3h555BE/1nbddVc76qijYlT2uvfDDz+0G264wYYOHWorrLBCj3r0uriFA5Tvd7/7XeNKDErmC+oywQQT9MDkgAMOsJ122qlxbatvvvjiC7vxxhvtq6++8rfQ3sjEE0/s/zPvUJeqiw/68UrPNddcvt/ff//9Xu/3vvc9XwfG8yyzzFJZP5gfccQR9uWXX3q9xT8YB7T1RBNNVDw1KD//4he/8IT3gQce8P20TiBA1Ok/X3/9tdF/JpxwwjoV349dys9YW3jhhWvXJ998801baqmlDNJ7++2326yzzpoU/4suusheeuklm2SSSeyYY46xPfbYI6n+blNWS8J7zTXX2HbbbWcLLLBAaXvcdddddscdd9iCCy5Yer6Vg0wQLIhHH320zT333MbCSViUxXSHHXZoRUXTaxgMBx10kN166632yiuveHKx+uqre29a05tH4wUjR440vGYQ9OWWW65HSS644AJfjyeeeMIT+R4n2/gQyO5jjz3myQUkb5lllvEaYkjvPffc4/FupSirrLKKzT///K1c2uMacIEo0j8nm2yyHudoc+qEkbPWWmv1ONfqB0JYiy++uJ177rm20kor9bjt0ksvtZ/+9KfeSJhuuul6nGvnQyC79957r22wwQa+T1577bWeCKUgveg/5JBD7OCDD7bxxhvPhgwZ4knFfvvtZ7vvvns7Re1xLX2EcXvfffd58rzOOuv4yAbk7uqrrzb6J4vPoosu2uhPPRS08OHvf/+7/eQnPzEMYARyikBCERboSy65xJZddln/ud0/GER4bZgLaE+MF+S5556ztdde26644grD6zjTTDP54+3+wVN/4IEHevIDuc0LxALjeIYZZrCtttoqf6qt9zvuuKNvg7KbGBd//vOfy061dQzD4IQTTjDWA/oTY+HnP/950vkTw5W1BPnLX/7ix1ZbhWzhYsYVBn1qZ8eRRx5p++67b8PI+/zzz23PPfc0ImWMt1RCnwH/Yl+K1Q+B23///f1ciREJsdttt92SlB+HA06zMiHiev3115edautYILtzzjmnTTrppJ74piS9rIm77LKLjRgxwiaffHKPFe+J5lYVnFXML60IEQ/mqTpJz9muJiWHjC622GJ25ZVXlpYYgso1McJAu+6664wOwOSPPP7447bmmmvaWGONlWTiYzKCTECqeFHuww8/3Fj0B7LgeYJsMUHnSW8guyxAELqqwuSJZxdiiPcveM4wDGJJL95KJvyf/exnfU76kKMTTzzRE5gqhJe6cx+GAaSOaAMCCaJeeMaLRLgdrCBAIRpAOwQJZJdxkYrs3nTTTb4OpEzccsstnsSl8PQedthhds4559jDDz9sJ598sh9TG2+8sTcCWDhJY6kiGLn0kcsuu8wWWWQRHzlhUaBPkdqD0UpqA20y77zzVnmE9zaxKOLlRfbZZx/v+Que5SWWWCJq/oHI/vjHP/akEEK3zTbb+OecdNJJ3tCn71YluyiaeuqpvUcI8vCrX/3K6w5/MCZpm5j+gy6iDhgdZVLV853XhQOCVBvmhCD0VcYARIYUnFghkgVBDAJWzNcpvaSQXYyYEC1IRXqJHLKOQIp4BYEEIxg8sYJe+ubZZ5/tx9caa6xhp59+ehJ86PdEIX7/+9/b9NNP74tKFJT1EYktP2s5WBc9rm+99Zaf+/1DIv7kye4WW2zhNWFk4O1NRXoZp6w1eO4RnFD019NOO81/rvIH4535bOWVV+7XgGFdpm3qRnjpqLWT888/P1tttdX6LLcjZJkLP/V5vtmJt99+O3Phz8x50npd6jxembOgMkeKep1r54Dz0GTO6svcwGjc5kKVmSN32csvv9w4luKN87ZkzpOWQlUPHc4gyFwoJXMLTUabOBKXgU+MOEMlc56lzHnPsvfee6+Xqtdeey1zFnPmBnavc60ccAtl5gyL7KyzzurzcrdYZI609Hm+2QlnIWfOu5c5QuTxcd6C7OKLL/bt7aIP2UILLZS5Sa+ZmqbnwR38XW525giS13/nnXc2va+/C8B/2223zRxxzN555x1/6S9/+cvs17/+tX/vFp1snnnmyRyJ7E9Nv+ecN8uPr2effdZfR1s6A9O/d5EBPwbcYtqvjv5OMvanmGKKzE3GmSO5jUtp16WXXtr3U2f4NI63+4b2dItL47a99947c2So8dl5333bNw60+calYGSOVGVnnHGGb1P6kzNi/HuOcY5rqgr9xpF9j4Pz5jbUuFQHj5vzwGaM7RhZfvnlM7fglr5ol1hxBmmpbp7pIhCx6v39LlLQ6xnOSEiiGyXOMZA550njGc7Qy5zTIFq/83xnLmrS0FtsB56Zb/eqD3RkNxtnnHEaz0Gvi1pVVde4jzmaddCR88wZrj1ezujLnPFdujY0FLTwhj7uDNQeunmWI9p+fW9BRZ+XMEe6dLPMOcd66d9yyy0zZ3BmLlrT5/2tnIAjwFGOO+64xjPC3OBSMFtR0ec1znObbb755g29xTZgvnYGd+YiBn3qGKgnaunhrWK5tHMPngk8dGVeDrxG5EYSXiRUUVXwYOHhdQtzQwX6CElgpTlC1jjezhs8k45I9LiFECxhY6zOvBCSjdnoRAgRDyNeb0JOeLzAJ0bAhZxddAXPbl4fFm3w9JK3CobtCN5DQmVu4vGeFTyXeXn33Xe9Bxjvfqy4Rd+H0EldIEeVMBmpCDFyyimn9NiRS9gczzHeAzwW5HTxQvB2brrppm09jjbFC77eeus1cmHxSNDnSQVAsOrd5OpD+VU2sgUPHB5XhP5J/yG3FAErnkkebBUh1w/PDV4c2jkI3nW8dITUq3jugx5ydvEU4+lGCHmDP7nCCJ79kNfrD7T5h/6PV4u2m3HGGW3VVVf1Gq666ipzhN17YGmjmL7EfIC3yS2YDS/v8ccf7yNnztBss8Sj/vL+Qs54n/DqxwhpQ3jQioLnFK9mSDMpnm/1c/DskmYQhMgSUQ4kxtNLVLI/IUJJPnLVlJugG88uXvAg1IVwON73mP0D5Kg7It1IEQr6+U+43pEtX37m14Em4MG4Yi0Pnt18GfGCI1xDdGvKKafMn275vXNC+EhW8H5zI5EH5m1SLu++++6WdRUvZB5gjidSVlyDaVvmflKSUkRqis/u9Gd9LVkJwiy+TD59CeEnFuWqQuif8Az5ZkVxnjQfxq/aYemghMvzL8J7ELv8Md6nCM2R7wcWzqJrEJZindr5TJnYaJFfCIr3M6lALqqWHyLlvKw+VF/UTSoLuZMhTFQ83+5nSGLoK4HQtasjf32xfVm8IFu8aOd8G1fZdESuGelAbPAKulh8eIXPnOMarq0iTJRgEvShO98/qUvsZMrEzDjNj2PeU27OxQhGEwt6vvx5fDjHNVUFbEKIm/4T2jcYHLHzTygXcw17FNBLDinhbo7VQZij+5L+zvV1T/E4m3+CAZM/R98Jhk7+eLvvmbvKSCH9psq4zT+f+jMf9yWcS4FRmNfyzwl9NX+s3feULfT/snsZw2XPLrt2VB+j7DhiWMMoZ5kw1piry9q/7PriMfahYDCRXlMUjGP2ALiIa/FUy59J9dpwww19qkrxJhwcpDSyRtZRqs/Kdaxti2VmQws73Z9//vleOT633XabX8yqWviQNSZTvFtlHR5C89vf/tbYGcyGISaQdoSOWhTINd8YsNdeexVPRX0OObvkzuEVwiuRz+mtopy6kxuGdYknt2gB41kbPny4t2Kr7LAPZWJxh9SyMQcvGsJGO7wWeBhSSMjZxRvFBMgExSaYGMGCD0K+IhvIyPekL+FdKdvIFq5v5T/lwwuKlxj86TcYNRBSjrNxBPzL8j9b0c813M+GIybN+eabzxtKEHf043nCA08ebFXB48qkjw4iHoGgkBeIh5QNXywa7AOoIixoRH8oL0LbsgCHz2yOy39rRrvPwANNNObYY4/1uYrkZDMPkOuJQcZ45ppYwcsdvLwQLfDAO14HcSltjUhGsbzBI1483upnlxbU7zjF086YLm4YbVU/15FvSRSJPGQIEAIJglCEnH9/sMIf9oL0Z3BB2lMY9ERMGFPBy0v5WQP6e3Yr1QmRU9Zg6pIXF8o3XrGRxLzOlO8x1MNeB7Bh83KenLNvgU2tzFFVHAYYK3hwWefL5hgI9wgXJWbOw5uMIV5F2EwPxyGnN2zGJfpJ/2TurKuI8Ja0HBY2ixcLMqQubG4h9ErIiQW5XSIaHkNIjMUMYsWrTLBuWfghHzEpB2W6Ux0LZJcNamHyKdvIVuV5YWNCkfTmyW7s168Q8iY0SWiIuiCkU2AUxGy4C/WljVkQWBxD6JnnQHrxDMZKfoMa75n88hvZYhZjJjsk4B/KGsguRkIgd+FcO/9ZGNngBYEL2HM/qUQsmGz0KzMGW30GmxJJC6Jf8gy+0QVvC0YOZJR0CTa90HcHorBoMu5ZtAJJp5x8owV1cTnWfpNfirLj0eWbVliU8RrVRUj3YGMir7xAIBl3MYIRGTYq96WHNQBiWnUdQG+e9BJ9SEF20QvpYZ2hrwQyynEEwxWnAiktscI4Rdh0yprFN5dgpMUKfZGxSv/nhUcRYf6nbeizZWSv3efy1Y55Msr9bt9Cu2p6XY/3voz05sluX19Z2UtZ4QCeWwx2omzF1MX8pW4fkucpbn9B/nDL7/nWB3DmO97DZlz4CuOuaIS0rHQAXFhLwosFyaJFWLpMXnjhhWgrE0KF1wmPEJYYVjEvBlxZKKGsHGXHmJD5zrxmAtkIRLLZtaP6PLmRWK55sksZQk4vpAVvadVBja4i6SW8OPz/nt1Ysot+hPxfvjGBvoT1OtLlXlb9doBvNH7z122s8/VHd/Er7OhLRA5iJlZ2wPPVY3j+8GJCeBGISyC95Hg2W7S/KW353zzpRS99H/xjyW54Gv2Hccx4QDfEAW8si2hZ7lu4r9l/UoHwQDBJQ6xnnnlm7xVlQaY9INIYIHhK8bSErxZrpjd/Hh3gG+Yf2hsJBJqFKMbLhVcF4xEvOjvtwQR8SInhGIsQOarFHeb5Mvb3nvLzDSih/JAtPEeBKMaWn2cTJesrLcVteuyveC2dg6i4jaDeaQDulJ/5h6+bgvDFCHpHlQTSS5Qg1rObL7PbdOQ/EgWjfQMxx2jiK+NSCH2cb1LglVo22WQTrxLCS1vTpmCEoRoT2Qvl5Cu1iGCVpQ6y9sZKkfQy7wfPbsy6yHzVylf6EfWL5Q+kXGJw4+gj0grRZn2ps9Tyl9YIh+IBZZIrEyZ0OkYY5GXXtHqMZxFaYXBj2RQtwlb1jM7rmCAYZKlSGiAoWJB8vVGZEHLieSmwwgOLV47JDvKYiuyGcvPdmmzcgUwwcVf9btygj/+kZLBxpi9PLuS62de+5PUV37OA4UEOEycY4fEI+Zcp8ceTS/oNY43vx43x7BbrwWfqAkFlQWPMxhBF9DFBk5caBA/X66+/7j/SXyHBQcCNr/hqVyDPLF78R0JIOnidQl2qEi/0UuZpp53W48P8g4RQNd/ZTRQiRn8ny+8Lqz8DAgH6Ev2HCAf9h7WxTkL5STHjfx3LTzoYDgPmfNIYwpxdlzYgdQcjEicdhlLRgVOXeoRy1pLwhsLrf2sI8N2IfBsEP6RQR8GqJ7c5hWVfrD8LAZYw+slFrqPgDSRUybdldELIFyMXLOb7HTtRrlZ1spubhb5OIftW66brhIAQGNgIsAEbJ1EwiAd2aXuXjigc6R9Ebasa2b21jp4jIryjB3c9dQAhgEeU8GvML9QMoOqoKAUESDkg2pMiN7ugWh+FgBAQAl2NAD/GQUph2Nxd58qK8Na59VR2ISAEhIAQEAJCQAgIgaYIDG16hS4QAkJACAgBISAEhIAQEAI1RkCEt8aNp6ILASEgBISAEBACQkAINEdAhLc5RrpCCAgBISAEhIAQEAJCoMYIiPDWuPFUdCEgBISAEBACQkAICIHmCIjwNsdIVwgBISAEhIAQEAIDJRcTAAAA0ElEQVRCQAjUGAER3ho3noouBISAEBACQkAICAEh0BwBEd7mGOkKISAEhIAQEAJCQAgIgRojIMJb48ZT0YWAEBACQkAICAEhIASaIyDC2xwjXSEEhIAQEAJCQAgIASFQYwREeGvceCq6EBACQkAICAEhIASEQHMERHibY6QrhIAQEAJCQAgIASEgBGqMgAhvjRtPRRcCQkAICAEhIASEgBBojoAIb3OMdIUQEAJCQAgIASEgBIRAjREQ4a1x46noQkAICAEhIASEgBAQAs0R+B+hBbIO0IHdAgAAAABJRU5ErkJgggo=" alt="Illustration of pch = 0:25"></p>
<p>The following  <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> plotting symbols are can be obtained with
<code>pch = 19:25</code>: those with <code>21:25</code> can be colored and
filled with different colors: <code>col</code> gives the border color
and <code>bg</code> the background color
(which is ‘<span class="samp">⁠"grey"⁠</span>’ in the figure)

</p>

<ul>
<li> <p><code>pch = 19</code>: solid circle,
</p>
</li>
<li> <p><code>pch = 20</code>: bullet (smaller solid circle,
2/3 the size of <code>19</code>),
</p>
</li>
<li> <p><code>pch = 21</code>: filled circle,
</p>
</li>
<li> <p><code>pch = 22</code>: filled square,
</p>
</li>
<li> <p><code>pch = 23</code>: filled diamond,
</p>
</li>
<li> <p><code>pch = 24</code>: filled triangle point-up,
</p>
</li>
<li> <p><code>pch = 25</code>: filled triangle point down.
</p>
</li>
</ul>
<p>Note that all of these both fill the shape and draw a border.  Some
care in interpretation is needed when semi-transparent colours are
used for both fill and border (and the result might be device-specific
and even viewer-specific for <code><a href="https://r-universe.dev/manuals/grDevices.html#pdf">pdf</a></code>).
</p>
<p>The difference between <code>pch = 16</code> and <code>pch = 19</code> is that the
latter uses a border and so is perceptibly larger when <code>lwd</code> is
large relative to <code>cex</code>.
</p>
<p>Values <code>pch = 26:31</code> are currently unused and <code>pch = 32:127</code>
give the ASCII characters.  In a single-byte locale
<code>pch = 128:255</code> give the corresponding character (if any) in
the locale's character set.  Where supported by the OS, negative
values specify a Unicode code point, so e.g. <code>-0x2642L</code>
is a ‘male sign’ and <code>-0x20ACL</code> is the Euro.
</p>
<p>A character string consisting of a single character is converted to an
integer: <code>32:127</code> for ASCII characters, and usually to the
Unicode code point otherwise.  (In non-Latin-1 single-byte locales,
<code>128:255</code> will be used for 8-bit characters.)
</p>
<p>If <code>pch</code> supplied is a logical, integer or character
<code>NA</code> or an empty character string the point is omitted from
the plot.
</p>
<p>If <code>pch</code> is <code>NULL</code> or otherwise of length 0,
<code>par("pch")</code> is used.
</p>
<p>If the symbol font (<code><a href="#par">par</a>(font = 5)</code>) is used, numerical
values should be used for <code>pch</code>: the range is
<code>c(32:126, 160:254)</code> in all locales (but <code>240</code> is not
defined (used for ‘apple’ on macOS) and <code>160</code>, Euro, may
not be present).
</p>


<h3>Note</h3>

<p>A single-byte encoding may include the characters in
<code>pch = 128:255</code>, and if it does, a font may not include all (or
even any) of them.
</p>
<p>Not all negative numbers are valid as Unicode code points, and no
check is done.  A display device is likely to use a rectangle for (or
omit) Unicode code points which are invalid or for which it does not
have a glyph in the font used.
</p>
<p>What happens for very small or zero values of <code>cex</code> is
device-dependent: symbols or characters may become invisible or
they may be plotted at a fixed minimum size.  Circles of zero radius
will not be plotted.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.formula">points.formula</a></code> for the formula method;
<code><a href="#plot.default">plot</a></code>, <code><a href="#lines">lines</a></code>, and the underlying
workhorse function <code><a href="#plot.xy">plot.xy</a></code>.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span> <span class="token comment"># for rnorm</span>
plot<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>  <span class="token comment"># setting up coord. system</span>
points<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
points<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">)</span>

op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>bg <span class="token operator">=</span> <span class="token string">"light blue"</span><span class="token punctuation">)</span>
x <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">51</span><span class="token punctuation">)</span>
<span class="token comment">## something "between type='b' and type='o'":</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sin<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"o"</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"bg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">.6</span><span class="token punctuation">,</span>
 main <span class="token operator">=</span> <span class="token string">'plot(..., type="o", pch=21, bg=par("bg"))'</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment">## Not run: </span>
<span class="token comment">## The figure was produced by calls like</span>
png<span class="token punctuation">(</span><span class="token string">"pch.png"</span><span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> units <span class="token operator">=</span> <span class="token string">"in"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>mar <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
points<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"grey"</span><span class="token punctuation">)</span>

<span class="token comment">## End(Not run)</span>

<span class="token comment">##-------- Showing all the extra &amp; some char graphics symbols ---------</span>
pchShow <span class="token operator">&lt;-</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span>extras <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"o"</span><span class="token punctuation">,</span><span class="token string">"O"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span><span class="token string">"+"</span><span class="token punctuation">,</span><span class="token string">"-"</span><span class="token punctuation">,</span><span class="token string">"|"</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">,</span><span class="token string">"#"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cex <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">## good for both .Device=="postscript" and "x11"</span>
           col <span class="token operator">=</span> <span class="token string">"red3"</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token string">"gold"</span><span class="token punctuation">,</span> coltext <span class="token operator">=</span> <span class="token string">"brown"</span><span class="token punctuation">,</span> cextext <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">,</span>
           main <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"plot symbols :  points (...  pch = *, cex ="</span><span class="token punctuation">,</span>
                        cex<span class="token punctuation">,</span><span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    nex <span class="token operator">&lt;-</span> length<span class="token punctuation">(</span>extras<span class="token punctuation">)</span>
    np  <span class="token operator">&lt;-</span> <span class="token number">26</span> <span class="token operator">+</span> nex
    ipch <span class="token operator">&lt;-</span> <span class="token number">0</span><span class="token operator">:</span><span class="token punctuation">(</span>np<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    k <span class="token operator">&lt;-</span> floor<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>np<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dd <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
    rx <span class="token operator">&lt;-</span> dd <span class="token operator">+</span> range<span class="token punctuation">(</span>ix <span class="token operator">&lt;-</span> ipch <span class="token percent-operator operator">%/%</span> k<span class="token punctuation">)</span>
    ry <span class="token operator">&lt;-</span> dd <span class="token operator">+</span> range<span class="token punctuation">(</span>iy <span class="token operator">&lt;-</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token punctuation">(</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span> ipch <span class="token percent-operator operator">%%</span> k<span class="token punctuation">)</span>
    pch <span class="token operator">&lt;-</span> as.list<span class="token punctuation">(</span>ipch<span class="token punctuation">)</span> <span class="token comment"># list with integers &amp; strings</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nex <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> pch<span class="token punctuation">[</span><span class="token number">26</span><span class="token operator">+</span> <span class="token number">1</span><span class="token operator">:</span>nex<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> as.list<span class="token punctuation">(</span>extras<span class="token punctuation">)</span>
    plot<span class="token punctuation">(</span>rx<span class="token punctuation">,</span> ry<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> axes  <span class="token operator">=</span>  <span class="token boolean">FALSE</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> main <span class="token operator">=</span> main<span class="token punctuation">)</span>
    abline<span class="token punctuation">(</span>v <span class="token operator">=</span> ix<span class="token punctuation">,</span> h <span class="token operator">=</span> iy<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"lightgray"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token string">"dotted"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>np<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pc <span class="token operator">&lt;-</span> pch<span class="token punctuation">[</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
      <span class="token comment">## 'col' symbols with a 'bg'-colored interior (where available) :</span>
      points<span class="token punctuation">(</span>ix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> iy<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> pc<span class="token punctuation">,</span> col <span class="token operator">=</span> col<span class="token punctuation">,</span> bg <span class="token operator">=</span> bg<span class="token punctuation">,</span> cex <span class="token operator">=</span> cex<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>cextext <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
          text<span class="token punctuation">(</span>ix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0.3</span><span class="token punctuation">,</span> iy<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> pc<span class="token punctuation">,</span> col <span class="token operator">=</span> coltext<span class="token punctuation">,</span> cex <span class="token operator">=</span> cextext<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

pchShow<span class="token punctuation">(</span><span class="token punctuation">)</span>
pchShow<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"o"</span><span class="token punctuation">,</span><span class="token string">"O"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">2.5</span><span class="token punctuation">)</span>
pchShow<span class="token punctuation">(</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> cextext <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>


<span class="token comment">## ------------ test code for various pch specifications -------------</span>
<span class="token comment"># Try this in various font families (including Hershey)</span>
<span class="token comment"># and locales.  Use sign = -1 asserts we want Latin-1.</span>
<span class="token comment"># Standard cases in a MBCS locale will not plot the top half.</span>
TestChars <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>sign <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   MB <span class="token operator">&lt;-</span> l10n_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">$</span>MBCS
   r <span class="token operator">&lt;-</span> <span class="token keyword">if</span><span class="token punctuation">(</span>font <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> sign <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token punctuation">;</span> c<span class="token punctuation">(</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">126</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token operator">:</span><span class="token number">254</span><span class="token punctuation">)</span>
       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>MB<span class="token punctuation">)</span> <span class="token number">32</span><span class="token operator">:</span><span class="token number">126</span> <span class="token keyword">else</span> <span class="token number">32</span><span class="token operator">:</span><span class="token number">255</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>sign <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> r <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">126</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token operator">:</span><span class="token number">255</span><span class="token punctuation">)</span>
   par<span class="token punctuation">(</span>pty <span class="token operator">=</span> <span class="token string">"s"</span><span class="token punctuation">)</span>
   plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
        xaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">,</span> yaxs <span class="token operator">=</span> <span class="token string">"i"</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> sprintf<span class="token punctuation">(</span><span class="token string">"sign = %d, font = %d"</span><span class="token punctuation">,</span> sign<span class="token punctuation">,</span> font<span class="token punctuation">)</span><span class="token punctuation">)</span>
   grid<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> mtext<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"MBCS:"</span><span class="token punctuation">,</span> MB<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> r<span class="token punctuation">)</span> try<span class="token punctuation">(</span>points<span class="token punctuation">(</span>i<span class="token percent-operator operator">%%</span><span class="token number">16</span><span class="token punctuation">,</span> i<span class="token percent-operator operator">%/%</span><span class="token number">16</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> sign<span class="token operator">*</span>i<span class="token punctuation">,</span> font <span class="token operator">=</span> font<span class="token punctuation">,</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
TestChars<span class="token punctuation">(</span><span class="token punctuation">)</span>
try<span class="token punctuation">(</span>TestChars<span class="token punctuation">(</span>sign <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
TestChars<span class="token punctuation">(</span>font <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># Euro might be at 160 (0+10*16).</span>
                     <span class="token comment"># macOS has apple at 240 (0+15*16).</span>
try<span class="token punctuation">(</span>TestChars<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># bold</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="polygon">

<a href="#polygon" class="help-page-title"><h2>Polygon Drawing</h2></a>

<h3>Description</h3>

<p><code>polygon</code> draws the polygons whose vertices are
given in <code>x</code> and <code>y</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">polygon<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> density <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span>
        border <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lty"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token ellipsis">...</span><span class="token punctuation">,</span> fillOddEven <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>vectors containing the coordinates of the vertices
of the polygon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>the density of shading lines, in lines per inch.  The
default value of <code>NULL</code> means that no shading lines are drawn.
A zero value of <code>density</code> means no shading nor filling whereas
negative values and <code>NA</code> suppress shading (and so allow
color filling).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>the slope of shading lines, given as an angle
in degrees (counter-clockwise).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>the color for filling the polygon. The default,
<code>NA</code>, is to leave polygons unfilled, unless <code>density</code> is
specified.  (For back-compatibility, <code>NULL</code> is equivalent to
<code>NA</code>.)  If <code>density</code> is specified with a positive value
this gives the color of the shading lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>the color to draw the border.  The default, <code>NULL</code>,
means to use <code><a href="#par">par</a>("fg")</code>.  Use <code>border = NA</code> to
omit borders.
</p>
<p>For compatibility with S, <code>border</code> can also be logical, in
which case <code>FALSE</code> is equivalent to <code>NA</code> (borders omitted)
and <code>TRUE</code> is equivalent to <code>NULL</code> (use the foreground colour),
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>the line type to be used, as in <code><a href="#par">par</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters such as <code>xpd</code>, <code>lend</code>,
<code>ljoin</code> and <code>lmitre</code> can be given as arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fillOddEven</code></td>
<td>
<p>logical controlling the polygon shading mode:  see
below for details.  Default <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The coordinates can be passed in a plotting structure
(a list with <code>x</code> and <code>y</code> components), a two-column matrix,
....  See <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>.
</p>
<p>It is assumed that the polygon is to be closed by joining the last
point to the first point.
</p>
<p>The coordinates can contain missing values.  The behaviour is similar
to that of <code><a href="#lines">lines</a></code>, except that instead of breaking a line
into several lines, <code>NA</code> values break the polygon into several
complete polygons (including closing the last point to the first
point).  See the examples below.
</p>
<p>When multiple polygons are produced, the values of <code>density</code>,
<code>angle</code>, <code>col</code>, <code>border</code>, and <code>lty</code> are recycled
in the usual manner.
</p>
<p>Shading of polygons is only implemented for linear plots: if either
axis is on log scale then shading is omitted, with a warning.
</p>


<h3>Bugs</h3>

<p>Self-intersecting polygons may be filled using either the
“odd-even” or “non-zero” rule.  These fill a region if
the polygon border encircles it an odd or non-zero number of times,
respectively.  Shading lines are handled internally by <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> according
to the <code>fillOddEven</code> argument, but device-based solid fills
depend on the graphics device.  The <code>windows</code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#pdf">pdf</a></code>
and <code><a href="https://r-universe.dev/manuals/grDevices.html#postscript">postscript</a></code> devices have their own <code>fillOddEven</code>
argument to control this.
</p>


<h3>Author(s)</h3>

<p>The code implementing polygon shading was donated by
Kevin Buhr <a href="mailto:buhr@stat.wisc.edu">buhr@stat.wisc.edu</a>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#segments">segments</a></code> for even more flexibility, <code><a href="#lines">lines</a></code>,
<code><a href="#rect">rect</a></code>, <code><a href="#box">box</a></code>, <code><a href="#abline">abline</a></code>.
</p>
<p><code><a href="#par">par</a></code> for how to specify colors.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">x <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">)</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfcol <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>xpd <span class="token keyword">in</span> c<span class="token punctuation">(</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> main <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"xpd ="</span><span class="token punctuation">,</span> xpd<span class="token punctuation">)</span><span class="token punctuation">)</span>
  box<span class="token punctuation">(</span><span class="token string">"figure"</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
  polygon<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> xpd <span class="token operator">=</span> xpd<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"orange"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

n <span class="token operator">&lt;-</span> <span class="token number">100</span>
xx <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span>n<span class="token punctuation">,</span> n<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span>
yy <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> cumsum<span class="token punctuation">(</span>stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rev<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> cumsum<span class="token punctuation">(</span>stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot   <span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Time"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Distance"</span><span class="token punctuation">)</span>
polygon<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray"</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span><span class="token string">"Distance Between Brownian Motions"</span><span class="token punctuation">)</span>

<span class="token comment"># Multiple polygons from NA values</span>
<span class="token comment"># and recycling of col, border, and lty</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
polygon<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        border <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">"yellow"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        lwd <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"dashed"</span><span class="token punctuation">,</span> <span class="token string">"solid"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
polygon<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">NA</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        border <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">"yellow"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        lwd <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"dashed"</span><span class="token punctuation">,</span> <span class="token string">"solid"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

<span class="token comment"># Line-shaded polygons</span>
plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
polygon<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">NA</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        density <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="polypath">

<a href="#polypath" class="help-page-title"><h2>Path Drawing</h2></a>

<h3>Description</h3>

<p><code>path</code> draws a path whose vertices are
given in <code>x</code> and <code>y</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">polypath<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
         border <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lty"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         rule <span class="token operator">=</span> <span class="token string">"winding"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>vectors containing the coordinates of the vertices
of the path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>the color for filling the path. The default,
<code>NA</code>, is to leave paths unfilled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>the color to draw the border.  The default, <code>NULL</code>,
means to use <code><a href="#par">par</a>("fg")</code>.  Use <code>border = NA</code> to
omit borders.
</p>
<p>For compatibility with S, <code>border</code> can also be logical, in
which case <code>FALSE</code> is equivalent to <code>NA</code> (borders omitted)
and <code>TRUE</code> is equivalent to <code>NULL</code> (use the foreground colour),
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>the line type to be used, as in <code><a href="#par">par</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>character value specifying the path fill mode: either
<code>"winding"</code> or <code>"evenodd"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a> such as <code>xpd</code>, <code>lend</code>,
<code>ljoin</code> and <code>lmitre</code> can be given as arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The coordinates can be passed in a plotting structure
(a list with <code>x</code> and <code>y</code> components), a two-column matrix,
....  See <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>.
</p>
<p>It is assumed that the path is to be closed by joining the last point to
the first point.
</p>
<p>The coordinates can contain missing values.  The behaviour is similar
to that of <code><a href="#polygon">polygon</a></code>, except that instead of breaking a
polygon into several polygons, <code>NA</code> values break the path into
several sub-paths (including closing the last point to the first point
in each sub-path).  See the examples below.
</p>
<p>The distinction between a path and a polygon is that the former
can contain holes, as interpreted by the fill rule; these fill a region if
the path border encircles it an odd or non-zero number of times,
respectively.
</p>
<p>Hatched shading (as implemented for <code>polygon()</code>) is not
(currently) supported.
</p>
<p>Not all graphics devices support this function: for example
<code>xfig</code> and <code>pictex</code> do not.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#segments">segments</a></code> for even more flexibility, <code><a href="#lines">lines</a></code>,
<code><a href="#rect">rect</a></code>, <code><a href="#box">box</a></code>, <code><a href="#polygon">polygon</a></code>.
</p>
<p><code><a href="#par">par</a></code> for how to specify colors.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plotPath <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey"</span><span class="token punctuation">,</span> rule <span class="token operator">=</span> <span class="token string">"winding"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    plot.new<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plot.window<span class="token punctuation">(</span>range<span class="token punctuation">(</span>x<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span> range<span class="token punctuation">(</span>y<span class="token punctuation">,</span> na.rm <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    polypath<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> col <span class="token operator">=</span> col<span class="token punctuation">,</span> rule <span class="token operator">=</span> rule<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>is.na<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">)</span>
        mtext<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"Rule:"</span><span class="token punctuation">,</span> rule<span class="token punctuation">)</span><span class="token punctuation">,</span> side <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

plotRules <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    plotPath<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    plotPath<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> rule <span class="token operator">=</span> <span class="token string">"evenodd"</span><span class="token punctuation">)</span>
    mtext<span class="token punctuation">(</span>title<span class="token punctuation">,</span> side <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> line <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    plotPath<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plotRules<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.2</span><span class="token punctuation">,</span> <span class="token number">.2</span><span class="token punctuation">,</span> <span class="token number">.8</span><span class="token punctuation">,</span> <span class="token number">.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.2</span><span class="token punctuation">,</span> <span class="token number">.8</span><span class="token punctuation">,</span> <span class="token number">.8</span><span class="token punctuation">,</span> <span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">"Nested rectangles, both clockwise"</span><span class="token punctuation">)</span>
plotRules<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.2</span><span class="token punctuation">,</span> <span class="token number">.8</span><span class="token punctuation">,</span> <span class="token number">.8</span><span class="token punctuation">,</span> <span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.2</span><span class="token punctuation">,</span> <span class="token number">.2</span><span class="token punctuation">,</span> <span class="token number">.8</span><span class="token punctuation">,</span> <span class="token number">.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">"Nested rectangles, outer clockwise, inner anti-clockwise"</span><span class="token punctuation">)</span>
plotRules<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">"Disjoint rectangles"</span><span class="token punctuation">)</span>
plotRules<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">"Overlapping rectangles, both clockwise"</span><span class="token punctuation">)</span>
plotRules<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          c<span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">"Overlapping rectangles, one clockwise, other anti-clockwise"</span><span class="token punctuation">)</span>

par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="rasterImage">

<a href="#rasterImage" class="help-page-title"><h2>Draw One or More Raster Images</h2></a>

<h3>Description</h3>

<p><code>rasterImage</code> draws a raster image at the given locations and sizes.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">rasterImage<span class="token punctuation">(</span>image<span class="token punctuation">,</span>
            xleft<span class="token punctuation">,</span> ybottom<span class="token punctuation">,</span> xright<span class="token punctuation">,</span> ytop<span class="token punctuation">,</span>
            angle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> interpolate <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>image</code></td>
<td>
<p>a <code>raster</code> object, or an object that can be
coerced to one by <code><a href="https://r-universe.dev/manuals/grDevices.html#as.raster">as.raster</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xleft</code></td>
<td>
<p>a vector (or scalar) of left x positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ybottom</code></td>
<td>
<p>a vector (or scalar) of bottom y positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xright</code></td>
<td>
<p>a vector (or scalar) of right x positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytop</code></td>
<td>
<p>a vector (or scalar) of top y positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>angle of rotation (in degrees, anti-clockwise
from positive x-axis, about the bottom-left corner).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p>a logical vector (or scalar) indicating
whether to apply linear interpolation to the image when drawing. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The positions supplied, i.e., <code>xleft, ...</code>,
are relative to the current plotting region.  If the x-axis goes from
100 to 200 then <code>xleft</code> should be larger than 100 and <code>xright</code>
should be less than 200.  The position vectors will be recycled to the
length of the longest.
</p>
<p>Plotting raster images is not supported on all devices and may have
limitations where supported, for example (e.g., for <code>postscript</code>
and <code>X11(type = "Xlib")</code> is restricted to opaque colors).
Problems with the rendering of raster images have been reported by
users of <code>windows()</code> devices under Remote Desktop, at least under
its default settings.
</p>
<p>You should not expect a raster image to be re-sized when an on-screen
device is re-sized: whether it is is device-dependent.
</p>


<h3>See Also</h3>

<p><code><a href="#rect">rect</a></code>,
<code><a href="#polygon">polygon</a></code>, and <code><a href="#segments">segments</a></code> and others
for flexible ways to draw shapes.
</p>
<p><code><a href="https://r-universe.dev/manuals/grDevices.html#dev.capabilities">dev.capabilities</a></code> to see if it is supported.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span>
<span class="token comment">## set up the plot region:</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>bg <span class="token operator">=</span> <span class="token string">"thistle"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
image <span class="token operator">&lt;-</span> as.raster<span class="token punctuation">(</span>matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
rasterImage<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">,</span> interpolate <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
rasterImage<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">)</span>
rasterImage<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">200</span> <span class="token operator">+</span> xinch<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">300</span> <span class="token operator">+</span> yinch<span class="token punctuation">(</span><span class="token number">.3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            interpolate <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
rasterImage<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span> interpolate <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="rect">

<a href="#rect" class="help-page-title"><h2>Draw One or More Rectangles</h2></a>

<h3>Description</h3>

<p><code>rect</code> draws a rectangle (or sequence of rectangles) with the
given coordinates, fill and border colors.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">rect<span class="token punctuation">(</span>xleft<span class="token punctuation">,</span> ybottom<span class="token punctuation">,</span> xright<span class="token punctuation">,</span> ytop<span class="token punctuation">,</span> density <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span>
     col <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lty"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lwd"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xleft</code></td>
<td>
<p>a vector (or scalar) of left x positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ybottom</code></td>
<td>
<p>a vector (or scalar) of bottom y positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xright</code></td>
<td>
<p>a vector (or scalar) of right x positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytop</code></td>
<td>
<p>a vector (or scalar) of top y positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>the density of shading lines, in lines per inch.
The default value of <code>NULL</code> means that no shading lines are drawn.
A zero value of <code>density</code> means no shading lines whereas
negative values (and <code>NA</code>) suppress shading (and so allow
color filling).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>angle (in degrees) of the shading lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color(s) to fill or shade the rectangle(s) with.
The default <code>NA</code> (or also <code>NULL</code>) means do not fill,
i.e., draw transparent rectangles, unless <code>density</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>color for rectangle border(s).  The default means
<code>par("fg")</code>.  Use <code>border = NA</code> to omit borders.
If there are shading
lines, <code>border = TRUE</code> means use the same colour for
the border as for the shading lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>line type for borders and shading; defaults to <code>"solid"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width for borders and shading.  Note that the use of
<code>lwd = 0</code> (as in the examples) is device-dependent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a> such as <code>xpd</code>, <code>lend</code>,
<code>ljoin</code> and <code>lmitre</code> can be given as
arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The positions supplied, i.e., <code>xleft, ...</code>,
are relative to the current plotting region.  If the x-axis goes from
100 to 200 then <code>xleft</code> must be larger than 100 and <code>xright</code>
must be less than 200.  The position vectors will be recycled to the
length of the longest.
</p>
<p>It is a graphics primitive used in <code><a href="#hist">hist</a></code>,
<code><a href="#barplot">barplot</a></code>, <code><a href="#legend">legend</a></code>, etc.
</p>


<h3>See Also</h3>

<p><code><a href="#box">box</a></code> for the standard box around the plot;
<code><a href="#polygon">polygon</a></code> and <code><a href="#segments">segments</a></code> for flexible line
drawing.
</p>
<p><code><a href="#par">par</a></code> for how to specify colors.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span>
<span class="token comment">## set up the plot region:</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>bg <span class="token operator">=</span> <span class="token string">"thistle"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
     main <span class="token operator">=</span> <span class="token string">"2 x 11 rectangles; 'rect(100+i,300+i,  150+i,380+i)'"</span><span class="token punctuation">)</span>
i <span class="token operator">&lt;-</span> <span class="token number">4</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment">## draw rectangles with bottom left (100, 300)+i</span>
<span class="token comment">## and top right (150, 380)+i</span>
rect<span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">+</span>i<span class="token punctuation">,</span> <span class="token number">300</span><span class="token operator">+</span>i<span class="token punctuation">,</span> <span class="token number">150</span><span class="token operator">+</span>i<span class="token punctuation">,</span> <span class="token number">380</span><span class="token operator">+</span>i<span class="token punctuation">,</span> col <span class="token operator">=</span> rainbow<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
rect<span class="token punctuation">(</span><span class="token number">240</span><span class="token operator">-</span>i<span class="token punctuation">,</span> <span class="token number">320</span><span class="token operator">+</span>i<span class="token punctuation">,</span> <span class="token number">250</span><span class="token operator">-</span>i<span class="token punctuation">,</span> <span class="token number">410</span><span class="token operator">+</span>i<span class="token punctuation">,</span> col <span class="token operator">=</span> heat.colors<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> i<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">## Background alternating  ( transparent / "bg" ) :</span>
j <span class="token operator">&lt;-</span> <span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span>
rect<span class="token punctuation">(</span><span class="token number">125</span><span class="token operator">+</span>j<span class="token punctuation">,</span> <span class="token number">360</span><span class="token operator">+</span>j<span class="token punctuation">,</span>   <span class="token number">141</span><span class="token operator">+</span>j<span class="token punctuation">,</span> <span class="token number">405</span><span class="token operator">+</span>j<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     border <span class="token operator">=</span> <span class="token string">"gold"</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
rect<span class="token punctuation">(</span><span class="token number">125</span><span class="token operator">+</span>j<span class="token punctuation">,</span> <span class="token number">296</span><span class="token operator">+</span>j<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token operator">+</span>j<span class="token punctuation">,</span> <span class="token number">331</span><span class="token operator">+</span>j<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span><span class="token string">"midnightblue"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"+  2 x 6 rect(*, col = c(NA,0)) and  col = c(NA,\"m..blue\")"</span><span class="token punctuation">)</span>

<span class="token comment">## an example showing colouring and shading</span>
plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type<span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
rect<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">)</span> <span class="token comment"># transparent</span>
rect<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"green"</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span> <span class="token comment"># coloured</span>
rect<span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">375</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">425</span><span class="token punctuation">,</span> col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"bg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"transparent"</span><span class="token punctuation">)</span>
rect<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">,</span> density <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
rect<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">,</span> density <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span>
     angle <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span> border <span class="token operator">=</span> <span class="token string">"transparent"</span><span class="token punctuation">)</span>

legend<span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">,</span> legend <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> fill <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       density <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

par<span class="token punctuation">(</span>op<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="rug">

<a href="#rug" class="help-page-title"><h2>Add a Rug to a Plot</h2></a>

<h3>Description</h3>

<p>Adds a <em>rug</em> representation (1-d plot) of the data to the plot.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">rug<span class="token punctuation">(</span>x<span class="token punctuation">,</span> ticksize <span class="token operator">=</span> <span class="token number">0.03</span><span class="token punctuation">,</span> side <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    quiet <span class="token operator">=</span> getOption<span class="token punctuation">(</span><span class="token string">"warn"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticksize</code></td>
<td>
<p>The length of the ticks making up the ‘rug’.
Positive lengths give inwards ticks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>On which side of the plot box the rug will be
plotted. Normally 1 (bottom) or 3 (top).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>The line width of the ticks.  Some devices will round the
default width up to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>The colour the ticks are plotted in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>logical indicating if there should be a warning about
clipped values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments, passed to <code><a href="#axis">axis</a></code>, such
as <code>line</code> or <code>pos</code> for specifying the location of the rug.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Because of the way <code>rug</code> is implemented, only values of <code>x</code>
that fall within the plot region are included.  There will be a
warning if any finite values are omitted, but non-finite values are
omitted silently.
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S.</em>
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/base.html#jitter">jitter</a></code> which you may want for ties in <code>x</code>.</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span>  <span class="token comment"># both 'density' and its default method</span>
with<span class="token punctuation">(</span>faithful<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>eruptions<span class="token punctuation">,</span> bw <span class="token operator">=</span> <span class="token number">0.15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    rug<span class="token punctuation">(</span>eruptions<span class="token punctuation">)</span>
    rug<span class="token punctuation">(</span>jitter<span class="token punctuation">(</span>eruptions<span class="token punctuation">,</span> amount <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span> side <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"light blue"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="screen">

<a href="#screen" class="help-page-title"><h2>Creating and Controlling Multiple Screens on a Single Device</h2></a>

<h3>Description</h3>

<p><code>split.screen</code> defines a number of regions within the current
device which can, to some extent, be treated as separate graphics
devices.  It is useful for generating multiple plots on a single
device.  Screens can themselves be split, allowing for quite complex
arrangements of plots.
</p>
<p><code>screen</code> is used to select which screen to draw in.
</p>
<p><code>erase.screen</code> is used to clear a single screen, which it
does by filling with the background colour.
</p>
<p><code>close.screen</code> removes the specified screen definition(s).
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">split.screen<span class="token punctuation">(</span>figs<span class="token punctuation">,</span> screen<span class="token punctuation">,</span> erase <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
screen<span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token punctuation">,</span> new <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
erase.screen<span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token punctuation">)</span>
close.screen<span class="token punctuation">(</span>n<span class="token punctuation">,</span> all.screens <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>figs</code></td>
<td>
<p>a two-element vector describing the number of rows and the
number of columns in a screen matrix <em>or</em> a matrix with 4 columns.
If a matrix, then each row describes a screen with values for the left,
right, bottom, and top of the screen (in that order) in NDC units,
that is 0 at the lower left corner of the device surface, and 1 at
the upper right corner.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screen</code></td>
<td>
<p>a number giving the screen to be split.  It defaults to
the current screen if there is one, otherwise the whole device region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>erase</code></td>
<td>
<p>logical: should the selected screen be cleared?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a number indicating which screen to prepare for drawing
(<code>screen</code>), erase (<code>erase.screen</code>), or close
(<code>close.screen</code>).  (<code>close.screen</code> will accept a vector of
screen numbers.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new</code></td>
<td>
<p>logical value indicating whether the screen should be
erased as part of the preparation for drawing in the screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.screens</code></td>
<td>
<p>logical value indicating whether all of the
screens should be closed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The first call to <code>split.screen</code> places <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> into split-screen
mode.  The other split-screen functions only work within this mode.
While in this mode, certain other commands should be avoided (see the
Warnings section below).  Split-screen mode is exited by the command
<code>close.screen(all = TRUE)</code>.
</p>
<p>If the current screen is closed, <code>close.screen</code> sets the current
screen to be the next larger screen number if there is one, otherwise
to the first available screen.
</p>


<h3>Value</h3>

<p><code>split.screen(*)</code> returns a vector of screen numbers for the
newly-created screens.  With no arguments, <code>split.screen()</code>
returns a vector of valid screen numbers.
</p>
<p><code>screen(n)</code> invisibly returns <code>n</code>, the number of the
selected screen. With no arguments, <code>screen()</code> returns the number
of the current screen.
</p>
<p><code>close.screen()</code> returns a vector of valid screen numbers.
</p>
<p><code>screen</code>, <code>erase.screen</code>, and <code>close.screen</code> all return
<code>FALSE</code> if <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> is not in split-screen mode.
</p>


<h3>Warnings</h3>

<p>The recommended way to use these functions is to completely draw a
plot and all additions (i.e., points and lines) to the base plot, prior to
selecting and plotting on another screen. The behavior associated with
returning to a screen to add to an existing plot is unpredictable and
may result in problems that are not readily visible.
</p>
<p>These functions are totally incompatible with the other mechanisms for
arranging plots on a device: <code><a href="#par">par</a>(mfrow)</code>,
<code>par(mfcol)</code> and <code><a href="#layout">layout</a>()</code>.
</p>
<p>The functions are also incompatible with some plotting functions,
such as <code><a href="#coplot">coplot</a></code>, which make use of these other mechanisms.
</p>
<p><code>erase.screen</code> will appear not to work if the background colour
is transparent (as it is by default on most devices).
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#par">par</a></code>, <code><a href="#layout">layout</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#Devices">Devices</a></code>,
<code>dev.*</code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token keyword">if</span> <span class="token punctuation">(</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
par<span class="token punctuation">(</span>bg <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">)</span>           <span class="token comment"># default is likely to be transparent</span>
split.screen<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>       <span class="token comment"># split display into two screens</span>
split.screen<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> screen <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># now split the bottom half into 3</span>
screen<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># prepare screen 1 for output</span>
plot<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>
screen<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment"># prepare screen 4 for output</span>
plot<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>
close.screen<span class="token punctuation">(</span>all <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>    <span class="token comment"># exit split-screen mode</span>

split.screen<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>       <span class="token comment"># split display into two screens</span>
split.screen<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment"># split bottom half in two</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>                  <span class="token comment"># screen 3 is active, draw plot</span>
erase.screen<span class="token punctuation">(</span><span class="token punctuation">)</span>              <span class="token comment"># forgot label, erase and redraw</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"ylab 3"</span><span class="token punctuation">)</span>
screen<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                   <span class="token comment"># prepare screen 1 for output</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
screen<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>                   <span class="token comment"># prepare screen 4 for output</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"ylab 4"</span><span class="token punctuation">)</span>
screen<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>            <span class="token comment"># return to screen 1, but do not clear</span>
plot<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>  <span class="token comment"># overlay second plot</span>
axis<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>                     <span class="token comment"># add tic marks to right-hand axis</span>
title<span class="token punctuation">(</span><span class="token string">"Plot 1"</span><span class="token punctuation">)</span>
close.screen<span class="token punctuation">(</span>all <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>    <span class="token comment"># exit split-screen mode</span>
<span class="token punctuation">}</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="segments">

<a href="#segments" class="help-page-title"><h2>Add Line Segments to a Plot</h2></a>

<h3>Description</h3>

<p>Draw line segments between pairs of points.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">segments<span class="token punctuation">(</span>x0<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> x1 <span class="token operator">=</span> x0<span class="token punctuation">,</span> y1 <span class="token operator">=</span> y0<span class="token punctuation">,</span>
         col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lty"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lwd"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x0, y0</code></td>
<td>
<p>coordinates of points <b>from</b> which to draw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1, y1</code></td>
<td>
<p>coordinates of points <b>to</b> which to draw.  At least
one must be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, lty, lwd</code></td>
<td>
<p><a href="#par">graphical parameters</a> as in
<code><a href="#par">par</a></code>, possibly vectors.  <code>NA</code> values in <code>col</code>
cause the segment to be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further <a href="#par">graphical parameters</a> (from <code><a href="#par">par</a></code>),
such as <code>xpd</code> and the line characteristics <code>lend</code>, <code>ljoin</code>
and <code>lmitre</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each <code>i</code>, a line segment is drawn between the point
<code>(x0[i], y0[i])</code> and the point <code>(x1[i], y1[i])</code>.  The
coordinate vectors will be recycled to the length of the longest.
</p>
<p>The <a href="#par">graphical parameters</a> <code>col</code>, <code>lty</code> and <code>lwd</code> can be
vectors of length greater than one and will be recycled if necessary.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#arrows">arrows</a></code>,
<code><a href="#polygon">polygon</a></code> for slightly easier and less flexible line
drawing, and
<code><a href="#lines">lines</a></code> for the usual polygons.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">x <span class="token operator">&lt;-</span> stats<span class="token operator">::</span>runif<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">&lt;-</span> stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
i <span class="token operator">&lt;-</span> order<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> x <span class="token operator">&lt;-</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> y <span class="token operator">&lt;-</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"arrows(.) and segments(.)"</span><span class="token punctuation">)</span>
<span class="token comment">## draw arrows from point to point :</span>
s <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span>length<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># one shorter than data</span>
arrows<span class="token punctuation">(</span>x<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span>s<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>s<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col<span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>
s <span class="token operator">&lt;-</span> s<span class="token punctuation">[</span><span class="token operator">-</span>length<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">]</span>
segments<span class="token punctuation">(</span>x<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span>s<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>s<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col<span class="token operator">=</span> <span class="token string">'pink'</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="smoothScatter">

<a href="#smoothScatter" class="help-page-title"><h2>Scatterplots with Smoothed Densities Color Representation</h2></a>

<h3>Description</h3>

<p><code>smoothScatter</code> produces a smoothed color density
representation of a scatterplot, obtained through a (2D) kernel
density estimate.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">smoothScatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> nbin <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">,</span> bandwidth<span class="token punctuation">,</span>
              colramp <span class="token operator">=</span> colorRampPalette<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"white"</span><span class="token punctuation">,</span> blues9<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              nrpoints <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> ret.selection <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
              pch <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">,</span>
              transformation <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> x<span class="token operator">^</span><span class="token number">.25</span><span class="token punctuation">,</span>
              postPlotHook <span class="token operator">=</span> box<span class="token punctuation">,</span>
              xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlim<span class="token punctuation">,</span> ylim<span class="token punctuation">,</span>
              xaxs <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"xaxs"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yaxs <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"yaxs"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>the <code>x</code> and <code>y</code> arguments provide the x and y
coordinates for the plot.  Any reasonable way of defining the
coordinates is acceptable.  See the function <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>
for details.  If supplied separately, they must be of the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbin</code></td>
<td>
<p>numeric vector of length one (for both directions) or two
(for x and y separately) specifying the number of equally spaced
grid points for the density estimation; directly used as
<code>gridsize</code> in <code><a href="https://r-universe.dev/manuals/KernSmooth.html#bkde2D">bkde2D</a>()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>numeric vector (length 1 or 2) of smoothing bandwidth(s).
If missing, a more or less useful default is used. <code>bandwidth</code>
is subsequently passed to function
<code><a href="https://r-universe.dev/manuals/KernSmooth.html#bkde2D">bkde2D</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colramp</code></td>
<td>
<p>function accepting an integer <code>n</code> as an argument and
returning <code>n</code> colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrpoints</code></td>
<td>
<p>number of points to be superimposed on the density
image.  The first <code>nrpoints</code> points from those areas of lowest
regional densities will be plotted.  Adding points to the plot
allows for the identification of outliers.  If all points are to be
plotted, choose <code>nrpoints = Inf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret.selection</code></td>
<td>
<p><code><a href="https://r-universe.dev/manuals/base.html#logical">logical</a></code> indicating to return the
ordered indices of “low density” points if <code>nrpoints &gt; 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch, cex, col</code></td>
<td>
<p>arguments passed to <code><a href="#points">points</a></code>,
when <code>nrpoints &gt; 0</code>: point symbol, character expansion factor
and color, see also <code><a href="#par">par</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>
<p>function mapping the density scale to the color scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postPlotHook</code></td>
<td>
<p>either <code>NULL</code> or a function which will be
called (with no arguments) after <code><a href="#image">image</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>character strings to be used as axis labels, passed
to <code><a href="#image">image</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>numeric vectors of length 2 specifying axis limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxs, yaxs, ...</code></td>
<td>
<p>further arguments passed to <code><a href="#image">image</a></code>,
e.g., <code>add=TRUE</code> or <code>useRaster=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>smoothScatter</code> produces a smoothed version of a scatter plot.
Two dimensional (kernel density) smoothing is performed by
<code><a href="https://r-universe.dev/manuals/KernSmooth.html#bkde2D">bkde2D</a></code> from package <a href="https://CRAN.R-project.org/package=KernSmooth" target="_blank"><span class="pkg">KernSmooth</span></a>.
See the examples for how to use this function together with
<code><a href="#pairs">pairs</a></code>.
</p>


<h3>Value</h3>

<p>If <code>ret.selection</code> is true, a vector of integers of length
<code>nrpoints</code> (or smaller, if there are less finite points inside
<code>xlim</code> and <code>ylim</code>) with the indices of the low-density
points drawn, ordered with lowest density first.
</p>


<h3>Author(s)</h3>

<p>Florian Hahne at FHCRC, originally</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/KernSmooth.html#bkde2D">bkde2D</a></code> from package <a href="https://CRAN.R-project.org/package=KernSmooth" target="_blank"><span class="pkg">KernSmooth</span></a>;
<code><a href="https://r-universe.dev/manuals/grDevices.html#densCols">densCols</a></code> which uses the same smoothing computations and
<code><a href="https://r-universe.dev/manuals/grDevices.html#densCols">blues9</a></code> in package <span class="pkg">grDevices</span>.
</p>
<p><code><a href="https://r-universe.dev/manuals/stats.html#scatter.smooth">scatter.smooth</a></code> adds a <code><a href="https://r-universe.dev/manuals/stats.html#loess">loess</a></code>
regression smoother to a scatter plot.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## A largish data set</span>
n <span class="token operator">&lt;-</span> <span class="token number">10000</span>
x1  <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
x2  <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>n<span class="token punctuation">,</span> mean <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> sd <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
x   <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span>

oldpar <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar<span class="token operator">=</span><span class="token number">.1</span><span class="token operator">+</span>c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mgp <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
smoothScatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> nrpoints <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
smoothScatter<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment">## a different color scheme:</span>
Lab.palette <span class="token operator">&lt;-</span> colorRampPalette<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"orange"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> space <span class="token operator">=</span> <span class="token string">"Lab"</span><span class="token punctuation">)</span>
i.s <span class="token operator">&lt;-</span> smoothScatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> colramp <span class="token operator">=</span> Lab.palette<span class="token punctuation">,</span>
                     <span class="token comment">## pch=NA: do not draw them</span>
                     nrpoints <span class="token operator">=</span> <span class="token number">250</span><span class="token punctuation">,</span> ret.selection<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment">## label the 20 very lowest-density points,the "outliers" (with obs.number):</span>
i.<span class="token number">20</span> <span class="token operator">&lt;-</span> i.s<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">]</span>
text<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i.<span class="token number">20</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> i.<span class="token number">20</span><span class="token punctuation">,</span> cex<span class="token operator">=</span> <span class="token number">0.75</span><span class="token punctuation">)</span>

<span class="token comment">## somewhat similar, using identical smoothing computations,</span>
<span class="token comment">## but considerably *less* efficient for really large data:</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> col <span class="token operator">=</span> densCols<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>

<span class="token comment">## use with pairs:</span>
par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">40000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token operator">*</span>rnorm<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span>
y<span class="token punctuation">[</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span>  <span class="token operator">-</span>y<span class="token punctuation">[</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
pairs<span class="token punctuation">(</span>y<span class="token punctuation">,</span> panel <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span> smoothScatter<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">,</span> nrpoints <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      gap <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">)</span>

par<span class="token punctuation">(</span>oldpar<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="spineplot">

<a href="#spineplot" class="help-page-title"><h2>Spine Plots and Spinograms</h2></a>

<h3>Description</h3>

<p>Spine plots are a special cases of mosaic plots, and can be seen as
a generalization of stacked (or highlighted) bar plots. Analogously,
spinograms are an extension of histograms.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">spineplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
spineplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          breaks <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> tol.ylab <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">,</span> off <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          ylevels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          main <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          xaxlabels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> yaxlabels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
spineplot<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          breaks <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> tol.ylab <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">,</span> off <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          ylevels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          main <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          xaxlabels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> yaxlabels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
          xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
          subset <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> drop.unused.levels <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object, the default method expects either a single variable
(interpreted to be the explanatory variable) or a 2-way table.  See
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>"factor"</code> interpreted to be the dependent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>"formula"</code> of type <code>y ~ x</code> with a single
dependent <code>"factor"</code> and a single explanatory variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>if the explanatory variable is numeric, this controls how
it is discretized. <code>breaks</code> is passed to <code><a href="#hist">hist</a></code> and can
be a list of arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.ylab</code></td>
<td>
<p>convenience tolerance parameter for y-axis annotation.
If the distance between two labels drops under this threshold, they are
plotted equidistantly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>off</code></td>
<td>
<p>vertical offset between the bars (in per cent). It is fixed to
<code>0</code> for spinograms and defaults to <code>2</code> for spine plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylevels</code></td>
<td>
<p>a character or numeric vector specifying in which order
the levels of the dependent variable should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector of fill colors of the same length as <code>levels(y)</code>.
The default is to call <code><a href="https://r-universe.dev/manuals/grDevices.html#gray.colors">gray.colors</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab</code></td>
<td>
<p>character strings for annotation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxlabels, yaxlabels</code></td>
<td>
<p>character vectors for annotation of x and y axis.
Default to <code>levels(y)</code> and <code>levels(x)</code>, respectively for the
spine plot. For <code>xaxlabels</code> in the spinogram, the breaks are
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>the range of x and y values with sensible defaults.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>logical.  If <code>FALSE</code> all axes (including those giving
level names) are suppressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code><a href="#rect">rect</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.unused.levels</code></td>
<td>
<p>should factors have unused levels dropped?
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>spineplot</code> creates either a spinogram or a spine plot.  It can
be called via <code>spineplot(x, y)</code> or <code>spineplot(y ~ x)</code> where
<code>y</code> is interpreted to be the dependent variable (and has to be
categorical) and <code>x</code> the explanatory variable.  <code>x</code> can be
either categorical (then a spine plot is created) or numerical (then a
spinogram is plotted).  Additionally, <code>spineplot</code> can also be
called with only a single argument which then has to be a 2-way table,
interpreted to correspond to <code>table(x, y)</code>.
</p>
<p>Both, spine plots and spinograms, are essentially mosaic plots with
special formatting of spacing and shading.  Conceptually, they plot
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(y | x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></code> against <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></code>.  For the spine plot (where both
<code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code> and <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></code> are categorical), both quantities are approximated
by the corresponding empirical relative frequencies.  For the
spinogram (where <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code> is numerical), <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></code> is first discretized
(by calling <code><a href="#hist">hist</a></code> with <code>breaks</code> argument) and then
empirical relative frequencies are taken.
</p>
<p>Thus, spine plots can also be seen as a generalization of stacked bar
plots where not the heights but the widths of the bars corresponds to
the relative frequencies of <code>x</code>. The heights of the bars then
correspond to the conditional relative frequencies of <code>y</code> in
every <code>x</code> group. Analogously, spinograms extend stacked
histograms.
</p>


<h3>Value</h3>

<p>The table visualized is returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Achim Zeileis <a href="mailto:Achim.Zeileis@R-project.org">Achim.Zeileis@R-project.org</a>
</p>


<h3>References</h3>

<p>Friendly, M. (1994).
Mosaic displays for multi-way contingency tables.
<em>Journal of the American Statistical Association</em>, <b>89</b>,
190–200.
<a href="https://doi.org/10.2307/2291215" target="_blank">doi:10.2307/2291215</a>.
</p>
<p>Hartigan, J.A., and Kleiner, B. (1984).
A mosaic of television ratings.
<em>The American Statistician</em>, <b>38</b>, 32–35.
<a href="https://doi.org/10.2307/2683556" target="_blank">doi:10.2307/2683556</a>.
</p>
<p>Hofmann, H., Theus, M. (2005),
<em>Interactive graphics for visualizing conditional distributions</em>.
Unpublished Manuscript.
</p>
<p>Hummel, J. (1996).
Linked bar charts: Analysing categorical data graphically.
<em>Computational Statistics</em>, <b>11</b>, 23–33.
</p>


<h3>See Also</h3>

<p><code><a href="#mosaicplot">mosaicplot</a></code>, <code><a href="#hist">hist</a></code>, <code><a href="#cdplot">cdplot</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## treatment and improvement of patients with rheumatoid arthritis</span>
treatment <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"placebo"</span><span class="token punctuation">,</span> <span class="token string">"treated"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
improved <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>rep<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"none"</span><span class="token punctuation">,</span> <span class="token string">"some"</span><span class="token punctuation">,</span> <span class="token string">"marked"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## (dependence on a categorical variable)</span>
<span class="token punctuation">(</span>spineplot<span class="token punctuation">(</span>improved <span class="token operator">~</span> treatment<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## applications and admissions by department at UC Berkeley</span>
<span class="token comment">## (two-way tables)</span>
<span class="token punctuation">(</span>spineplot<span class="token punctuation">(</span>marginSums<span class="token punctuation">(</span>UCBAdmissions<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           main <span class="token operator">=</span> <span class="token string">"Applications at UCB"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>spineplot<span class="token punctuation">(</span>marginSums<span class="token punctuation">(</span>UCBAdmissions<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           main <span class="token operator">=</span> <span class="token string">"Admissions at UCB"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## NASA space shuttle o-ring failures</span>
fail <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                 <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">,</span> <span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
temperature <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span>
                 <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span>

<span class="token comment">## (dependence on a numerical variable)</span>
<span class="token punctuation">(</span>spineplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>spineplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">,</span> breaks <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>spineplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">,</span> breaks <span class="token operator">=</span> quantile<span class="token punctuation">(</span>temperature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## highlighting for failures</span>
spineplot<span class="token punctuation">(</span>fail <span class="token operator">~</span> temperature<span class="token punctuation">,</span> ylevels <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="stars">

<a href="#stars" class="help-page-title"><h2>Star (Spider/Radar) Plots and Segment Diagrams</h2></a>

<h3>Description</h3>

<p>Draw star plots or segment diagrams of a multivariate data set.
With one single location, also draws ‘spider’
(or ‘radar’) plots.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">stars<span class="token punctuation">(</span>x<span class="token punctuation">,</span> full <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> radius <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
      labels <span class="token operator">=</span> dimnames<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> locations <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
      nrow <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
      key.loc <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> key.labels <span class="token operator">=</span> dimnames<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      key.xpd <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
      xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> flip.labels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
      draw.segments <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      col.segments <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>n.seg<span class="token punctuation">,</span> col.stars <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> col.lines <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
      axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> axes<span class="token punctuation">,</span>
      main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> sub <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
      cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"lty"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xpd <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      mar <span class="token operator">=</span> pmin<span class="token punctuation">(</span>par<span class="token punctuation">(</span><span class="token string">"mar"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 <span class="token number">1.1</span><span class="token operator">+</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>axes<span class="token operator">+</span> <span class="token punctuation">(</span>xlab <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 <span class="token number">2</span><span class="token operator">*</span>axes<span class="token operator">+</span> <span class="token punctuation">(</span>ylab <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix or data frame of data.
One star or segment plot will be produced for each row of <code>x</code>.
Missing values (<code>NA</code>) are allowed, but they are treated as if
they were 0 (after scaling, if relevant).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the segment plots will
occupy a full circle.  Otherwise, they occupy the (upper) semicircle
only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the columns of the data
matrix are scaled independently so that the maximum value in each
column is 1 and the minimum is 0.  If <code>FALSE</code>, the presumption
is that the data have been scaled by some other algorithm to the
range <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>logical flag: in <code>TRUE</code>, the radii corresponding to
each variable in the data will be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>vector of character strings for labeling the plots.
Unlike the S function <code>stars</code>, no attempt is made to construct
labels if <code>labels = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>
<p>Either two column matrix with the x and y coordinates used
to place each of the segment plots; or numeric of length 2 when all
plots should be superimposed (for a ‘spider plot’).
By default, <code>locations = NULL</code>, the segment plots will be
placed in a rectangular grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow, ncol</code></td>
<td>
<p>integers giving the number of rows and columns to use when
<code>locations</code> is <code>NULL</code>.  By default, <code>nrow == ncol</code>, a square
layout will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len</code></td>
<td>
<p>scale factor for the length of radii or segments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.loc</code></td>
<td>
<p>vector with x and y coordinates of the unit key.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.labels</code></td>
<td>
<p>vector of character strings for labeling the
segments of the unit key.  If omitted, the second component of
<code>dimnames(x)</code> is used, if available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.xpd</code></td>
<td>
<p>clipping switch for the unit key (drawing and
labeling), see <code><a href="#par">par</a>("xpd")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>vector with the range of x coordinates to plot. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>vector with the range of y coordinates to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip.labels</code></td>
<td>
<p>logical indicating if the label locations should
flip up and down from diagram to diagram. Defaults to a somewhat
smart heuristic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw.segments</code></td>
<td>
<p>logical. If <code>TRUE</code> draw a segment diagram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.segments</code></td>
<td>
<p>color vector (integer or character, see
<code><a href="#par">par</a></code>), each specifying a color for one of the segments
(variables).  Ignored if <code>draw.segments = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.stars</code></td>
<td>
<p>color vector (integer or character, see
<code><a href="#par">par</a></code>), each specifying a color for one of the stars
(cases).  Ignored if <code>draw.segments = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.lines</code></td>
<td>
<p>color vector (integer or character, see
<code><a href="#par">par</a></code>), each specifying a color for one of the lines
(cases).  Ignored if <code>draw.segments = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>logical flag: if <code>TRUE</code> axes are added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame.plot</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the plot region is framed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>a main title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>a subtitle for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a label for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a label for the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>character expansion factor for the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width used for drawing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>line type used for drawing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpd</code></td>
<td>
<p>logical or NA indicating if clipping should be done, see
<code><a href="#par">par</a>(xpd = .)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>argument to <code><a href="#par">par</a>(mar = *)</code>, typically choosing
smaller margins than by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments, passed to the first call of
<code>plot()</code>, see <code><a href="#plot.default">plot.default</a></code> and to
<code><a href="#box">box</a>()</code> if <code>frame.plot</code> is true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical, if <code>TRUE</code> <em>add</em> stars to current plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>FALSE</code>, nothing is plotted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Missing values are treated as 0.
</p>
<p>Each star plot or segment diagram represents one row of the input
<code>x</code>.  Variables (columns) start on the right and wind
counterclockwise around the circle.  The size of the (scaled) column
is shown by the distance from the center to the point on the star or
the radius of the segment representing the variable.
</p>
<p>Only one page of output is produced.
</p>


<h3>Value</h3>

<p>Returns the locations of the plots in a two column matrix, invisibly
when <code>plot = TRUE</code>.
</p>


<h3>Note</h3>

<p>This code started life as spatial star plots by David A. Andrews.

</p>
<p>Prior to <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> 1.4.1, scaling only shifted the maximum to 1, although
documented as here.
</p>


<h3>Author(s)</h3>

<p>Thomas S. Dye</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#symbols">symbols</a></code> for another way to draw stars and other symbols.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span>
stars<span class="token punctuation">(</span>mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      main <span class="token operator">=</span> <span class="token string">"Motor Trend Cars : stars(*, full = F)"</span><span class="token punctuation">,</span> full <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
stars<span class="token punctuation">(</span>mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      main <span class="token operator">=</span> <span class="token string">"Motor Trend Cars : full stars()"</span><span class="token punctuation">,</span> flip.labels <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment">## 'Spider' or 'Radar' plot:</span>
stars<span class="token punctuation">(</span>mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> locations <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> radius <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Motor Trend Cars"</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">## Segment Diagrams:</span>
palette<span class="token punctuation">(</span>rainbow<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token number">0.6</span><span class="token punctuation">,</span> v <span class="token operator">=</span> <span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stars<span class="token punctuation">(</span>mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      main <span class="token operator">=</span> <span class="token string">"Motor Trend Cars"</span><span class="token punctuation">,</span> draw.segments <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
stars<span class="token punctuation">(</span>mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">0.6</span><span class="token punctuation">,</span> key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      main <span class="token operator">=</span> <span class="token string">"Motor Trend Cars"</span><span class="token punctuation">,</span> draw.segments <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
      frame.plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">.7</span><span class="token punctuation">)</span>

<span class="token comment">## scale linearly (not affinely) to [0, 1]</span>
USJudge <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>USJudgeRatings<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> x<span class="token operator">/</span>max<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
Jnam <span class="token operator">&lt;-</span> row.names<span class="token punctuation">(</span>USJudgeRatings<span class="token punctuation">)</span>
Snam <span class="token operator">&lt;-</span> abbreviate<span class="token punctuation">(</span>substring<span class="token punctuation">(</span>Jnam<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> regexpr<span class="token punctuation">(</span><span class="token string">"[,.]"</span><span class="token punctuation">,</span>Jnam<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
stars<span class="token punctuation">(</span>USJudge<span class="token punctuation">,</span> labels <span class="token operator">=</span> Jnam<span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Judge not ..."</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">)</span>
stars<span class="token punctuation">(</span>USJudge<span class="token punctuation">,</span> labels <span class="token operator">=</span> Snam<span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> radius <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

loc <span class="token operator">&lt;-</span> stars<span class="token punctuation">(</span>USJudge<span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
             radius <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
             key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Judge not ..."</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span>loc<span class="token punctuation">,</span> Snam<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> xpd <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

<span class="token comment">## 'Segments':</span>
stars<span class="token punctuation">(</span>USJudge<span class="token punctuation">,</span> draw.segments <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## 'Spider':</span>
stars<span class="token punctuation">(</span>USJudgeRatings<span class="token punctuation">,</span> locations <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> radius  <span class="token operator">=</span>  <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      col.stars <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"US Judges rated"</span><span class="token punctuation">)</span>
<span class="token comment">## Same as above, but with colored lines instead of filled polygons.</span>
stars<span class="token punctuation">(</span>USJudgeRatings<span class="token punctuation">,</span> locations <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> radius  <span class="token operator">=</span>  <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      col.lines <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> key.loc <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"US Judges rated"</span><span class="token punctuation">)</span>
<span class="token comment">## 'Radar-Segments'</span>
stars<span class="token punctuation">(</span>USJudgeRatings<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> locations <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
      draw.segments <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col.segments <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> col.stars <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> key.loc <span class="token operator">=</span>  <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
      main <span class="token operator">=</span> <span class="token string">"US Judges 1-10 "</span><span class="token punctuation">)</span>
palette<span class="token punctuation">(</span><span class="token string">"default"</span><span class="token punctuation">)</span>
stars<span class="token punctuation">(</span>cbind<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> draw.segments <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
      main <span class="token operator">=</span> <span class="token string">"A Joke -- do *not* use symbols on 2D data!"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="stem">

<a href="#stem" class="help-page-title"><h2>Stem-and-Leaf Plots</h2></a>

<h3>Description</h3>

<p><code>stem</code> produces a stem-and-leaf plot of the values in <code>x</code>.
The parameter <code>scale</code> can be used to expand the scale of the
plot.  A value of <code>scale = 2</code> will cause the plot to be roughly
twice as long as the default.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">stem<span class="token punctuation">(</span>x<span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">,</span> atom <span class="token operator">=</span> <span class="token number">1e-08</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>This controls the plot length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>The desired width of plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atom</code></td>
<td>
<p>a tolerance.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Infinite and missing values in <code>x</code> are discarded.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">stem<span class="token punctuation">(</span>islands<span class="token punctuation">)</span>
stem<span class="token punctuation">(</span>log10<span class="token punctuation">(</span>islands<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="stripchart">

<a href="#stripchart" class="help-page-title"><h2>1-D Scatter Plots</h2></a>

<h3>Description</h3>

<p><code>stripchart</code> produces one dimensional scatter plots (or dot
plots) of the given data.  These plots are a good alternative to
<code><a href="#boxplot">boxplot</a></code>s when sample sizes are small.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">stripchart<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
stripchart<span class="token punctuation">(</span>x<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> dlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
           subset<span class="token punctuation">,</span> na.action <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>


<span class="token comment">## Default S3 method:</span>
stripchart<span class="token punctuation">(</span>x<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"overplot"</span><span class="token punctuation">,</span> jitter <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> offset <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>
           vertical <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> group.names<span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
           at <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
           ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> dlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> glab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>
           log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"cex"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           axes <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> frame.plot <span class="token operator">=</span> axes<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the data from which the plots are to be produced.  In the
default method the data can be specified as a single numeric
vector, or as list of numeric vectors, each corresponding to
a component plot.  In the <code>formula</code> method, a symbolic
specification of the form <code>y ~ g</code> can be given,
indicating the observations in the vector <code>y</code> are to be
grouped according to the levels of the factor
<code>g</code>.  <code>NA</code>s are allowed in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>x</code> should be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is to ignore missing
values in either the response or the group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to the default method, or by
it to <code><a href="#plot.window">plot.window</a></code>, <code><a href="#points">points</a></code>,
<code><a href="#axis">axis</a></code> and <code><a href="#title">title</a></code> to control the appearance
of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used to separate coincident points.
The default method <code>"overplot"</code> causes such points to be
overplotted, but it is also possible to specify <code>"jitter"</code> to
jitter the points, or <code>"stack"</code> have coincident points
stacked.  The last method only makes sense for very granular data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>when <code>method = "jitter"</code> is used, <code>jitter</code>
gives the amount of jittering applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>when stacking is used, points are stacked this many
line-heights (symbol widths) apart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical</code></td>
<td>
<p>when vertical is <code>TRUE</code> the plots are drawn
vertically rather than the default horizontal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.names</code></td>
<td>
<p>group labels which will be printed alongside
(or underneath) each plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical, if true <em>add</em> the chart to the current plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>numeric vector giving the locations where the charts should
be drawn, particularly when <code>add = TRUE</code>;
defaults to <code>1:n</code> where <code>n</code> is the number of boxes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab, xlab</code></td>
<td>
<p>labels: see <code><a href="#title">title</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dlab, glab</code></td>
<td>
<p>alternate way to specify axis labels: see ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>plot limits: see <code><a href="#plot.window">plot.window</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>on which axes to use a log scale:  see
<code><a href="#plot.default">plot.default</a></code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch, col, cex</code></td>
<td>
<p>Graphical parameters: see <code><a href="#par">par</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes, frame.plot</code></td>
<td>
<p>Axis control:  see <code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Extensive examples of the use of this kind of plot can be found in
Box, Hunter and Hunter or Seber and Wild.
</p>
<p>The <code>dlab</code> and <code>glab</code> labels may be used instead of <code>xlab</code>
and <code>ylab</code> if those are not specified.  <code>dlab</code> applies to the
continuous data axis (the X axis unless <code>vertical</code> is <code>TRUE</code>),
<code>glab</code> to the group axis.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">x <span class="token operator">&lt;-</span> stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
xr <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
stripchart<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">;</span> m <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>par<span class="token punctuation">(</span><span class="token string">"usr"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1.04</span><span class="token punctuation">,</span> <span class="token string">"stripchart(x, \"overplot\")"</span><span class="token punctuation">)</span>
stripchart<span class="token punctuation">(</span>xr<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"stack"</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1.35</span><span class="token punctuation">,</span> <span class="token string">"stripchart(round(x,1), \"stack\")"</span><span class="token punctuation">)</span>
stripchart<span class="token punctuation">(</span>xr<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"jitter"</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> at <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token string">"stripchart(round(x,1), \"jitter\")"</span><span class="token punctuation">)</span>

stripchart<span class="token punctuation">(</span>decrease <span class="token operator">~</span> treatment<span class="token punctuation">,</span>
    main <span class="token operator">=</span> <span class="token string">"stripchart(OrchardSprays)"</span><span class="token punctuation">,</span>
    vertical <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">,</span> data <span class="token operator">=</span> OrchardSprays<span class="token punctuation">)</span>

stripchart<span class="token punctuation">(</span>decrease <span class="token operator">~</span> treatment<span class="token punctuation">,</span> at <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>
    main <span class="token operator">=</span> <span class="token string">"stripchart(OrchardSprays)"</span><span class="token punctuation">,</span>
    vertical <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">"y"</span><span class="token punctuation">,</span> data <span class="token operator">=</span> OrchardSprays<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="strwidth">

<a href="#strwidth" class="help-page-title"><h2>Plotting Dimensions of Character Strings and Math Expressions</h2></a>

<h3>Description</h3>

<p>These functions compute the width or height, respectively, of the
given strings or mathematical expressions <code>s[i]</code> on
the current plotting device in <em>user</em> coordinates, <em>inches</em>
or as fraction of the figure width <code>par("fin")</code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">strwidth<span class="token punctuation">(</span>s<span class="token punctuation">,</span> units <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> vfont <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
strheight<span class="token punctuation">(</span>s<span class="token punctuation">,</span> units <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> vfont <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>a character or <a href="https://r-universe.dev/manuals/base.html#expression">expression</a> vector whose dimensions
are to be determined.  Other objects are coerced by
<code><a href="https://r-universe.dev/manuals/grDevices.html#as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>character indicating in which units <code>s</code> is measured;
should be one of <code>"user"</code>, <code>"inches"</code>, <code>"figure"</code>;
partial matching is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>numeric <b>c</b>haracter <b>ex</b>pansion factor; multiplied
by <code><a href="#par">par</a>("cex")</code> yields the final character size; the
default <code>NULL</code> is equivalent to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font, vfont, ...</code></td>
<td>
<p>additional information about the font,
possibly including the graphics parameter <code>"family"</code>:
see <code><a href="#text">text</a></code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the ‘height’ of a string is determined only by the
number of linefeeds (<code>"\n"</code>, aka “newline”s) it contains: it is the (number of
linefeeds - 1) times the line spacing plus the height of <code>"M"</code> in
the selected font.  For an expression it is the height of the
bounding box as computed by <a href="https://r-universe.dev/manuals/grDevices.html#plotmath">plotmath</a>.  Thus in both cases it is
an estimate of how far <b>above</b> the final baseline the typeset
object extends.  (It may also extend below the baseline.)  The
inter-line spacing is controlled by <code>cex</code>,
<code><a href="#par">par</a>("lheight")</code> and the ‘point size’ (but not the
actual font in use).
</p>
<p>Measurements in <code>"user"</code> units (the default) are only available
after <code><a href="#frame">plot.new</a></code> has been called – otherwise an error is
thrown.
</p>


<h3>Value</h3>

<p>Numeric vector with the same length as <code>s</code>, giving the estimate of
width or height for each <code>s[i]</code>.  <code>NA</code> strings are given
width and height 0 (as they are not plotted).
</p>


<h3>See Also</h3>

<p><code><a href="#text">text</a></code>, <code><a href="https://r-universe.dev/manuals/base.html#nchar">nchar</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">str.ex <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"W"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">,</span><span class="token string">"I"</span><span class="token punctuation">,</span><span class="token string">"."</span><span class="token punctuation">,</span><span class="token string">"WwI."</span><span class="token punctuation">)</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>pty <span class="token operator">=</span> <span class="token string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
sw <span class="token operator">&lt;-</span> strwidth<span class="token punctuation">(</span>str.ex<span class="token punctuation">)</span><span class="token punctuation">;</span> sw
all.equal<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>sw<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sw<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#- since the last string contains the others</span>

sw.i <span class="token operator">&lt;-</span> strwidth<span class="token punctuation">(</span>str.ex<span class="token punctuation">,</span> <span class="token string">"inches"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token number">25.4</span> <span class="token operator">*</span> sw.i  <span class="token comment"># width in [mm]</span>
unique<span class="token punctuation">(</span>sw <span class="token operator">/</span> sw.i<span class="token punctuation">)</span>
<span class="token comment"># constant factor: 1 value</span>
mean<span class="token punctuation">(</span>sw.i <span class="token operator">/</span> strwidth<span class="token punctuation">(</span>str.ex<span class="token punctuation">,</span> <span class="token string">"fig"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> par<span class="token punctuation">(</span><span class="token string">'fin'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># = 1: are the same</span>

<span class="token comment">## See how letters fall in classes</span>
<span class="token comment">##  -- depending on graphics device and font!</span>
all.lett <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>letters<span class="token punctuation">,</span> LETTERS<span class="token punctuation">)</span>
shL <span class="token operator">&lt;-</span> strheight<span class="token punctuation">(</span>all.lett<span class="token punctuation">,</span> units <span class="token operator">=</span> <span class="token string">"inches"</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">72</span>  <span class="token comment"># 'big points'</span>
table<span class="token punctuation">(</span>shL<span class="token punctuation">)</span>  <span class="token comment"># all have same heights ...</span>
mean<span class="token punctuation">(</span>shL<span class="token punctuation">)</span><span class="token operator">/</span>par<span class="token punctuation">(</span><span class="token string">"cin"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment"># around 0.6</span>

<span class="token punctuation">(</span>swL <span class="token operator">&lt;-</span> strwidth<span class="token punctuation">(</span>all.lett<span class="token punctuation">,</span> units <span class="token operator">=</span> <span class="token string">"inches"</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">72</span><span class="token punctuation">)</span>  <span class="token comment"># 'big points'</span>
split<span class="token punctuation">(</span>all.lett<span class="token punctuation">,</span> factor<span class="token punctuation">(</span>round<span class="token punctuation">(</span>swL<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

sumex <span class="token operator">&lt;-</span> expression<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token operator">^</span><span class="token punctuation">{</span>i <span class="token operator">*</span> pi<span class="token punctuation">}</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
strwidth<span class="token punctuation">(</span>sumex<span class="token punctuation">)</span>
strheight<span class="token punctuation">(</span>sumex<span class="token punctuation">)</span>

par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>  <span class="token comment">#- reset to previous setting</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="sunflowerplot">

<a href="#sunflowerplot" class="help-page-title"><h2>Produce a Sunflower Scatter Plot</h2></a>

<h3>Description</h3>

<p>Multiple points are plotted as ‘sunflowers’ with multiple leaves
(‘petals’) such that overplotting is visualized instead of
accidental and invisible.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">sunflowerplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
sunflowerplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> number<span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>
              xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
              add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> rotate <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
              pch <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> cex.fact <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span>
              col <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"col"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">,</span> seg.col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
              seg.lwd <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## S3 method for class 'formula'</span>
sunflowerplot<span class="token punctuation">(</span>formula<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span>
             subset<span class="token punctuation">,</span> na.action <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector of <code>x</code>-coordinates of length <code>n</code>,
say, or another valid plotting structure, as for
<code><a href="#plot.default">plot.default</a></code>, see also <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector of <code>y</code>-coordinates of length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number</code></td>
<td>
<p>integer vector of length <code>n</code>. <code>number[i]</code> = number
of replicates for <code>(x[i], y[i])</code>, may be 0.<br>
Default (<code>missing(number)</code>): compute the exact multiplicity of
the points <code>x[], y[]</code>, via
<code><a href="https://r-universe.dev/manuals/grDevices.html#xyTable">xyTable</a>()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>character indicating log coordinate scale, see
<code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>when <code>number</code> is computed (i.e., not specified),
<code>x</code> and <code>y</code> are rounded to <code>digits</code> significant
digits before multiplicities are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>character label for x-, or y-axis, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p><code>numeric(2)</code> limiting the extents of the x-,
or y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical; should the plot be added on a previous one ?
Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate</code></td>
<td>
<p>logical; if <code>TRUE</code>, randomly rotate the
sunflowers (preventing artefacts).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>plotting character to be used for points
(<code>number[i]==1</code>) and center of sunflowers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>numeric; character size expansion of center points
(s. <code>pch</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.fact</code></td>
<td>
<p>numeric <em>shrinking</em> factor to be used for the
center points <em>when there are flower leaves</em>,
i.e., <code>cex / cex.fact</code> is used for these.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, bg</code></td>
<td>
<p>colors for the plot symbols, passed to
<code><a href="#plot.default">plot.default</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>of sunflower leaves in inches, 1[in] := 2.54[cm].
Default: 1/8\", approximately 3.2mm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seg.col</code></td>
<td>
<p>color to be used for the <b>seg</b>ments which make the
sunflowers leaves, see <code><a href="#par">par</a>(col=)</code>;
<code>col = "gold"</code> reminds of real sunflowers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seg.lwd</code></td>
<td>
<p>numeric; the line width for the leaves' segments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to <code><a href="#plot.default">plot</a></code> [if
<code>add = FALSE</code>], or to be passed to or from another method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code><a href="https://r-universe.dev/manuals/stats.html#formula">formula</a></code>, such as <code>y ~ x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>formula</code> should be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is to ignore case
with missing values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a generic function with default and formula methods.
</p>
<p>For <code>number[i] == 1</code>, a (slightly enlarged) usual plotting symbol
(<code>pch</code>) is drawn.  For <code>number[i] &gt; 1</code>, a small plotting
symbol is drawn and <code>number[i]</code> equi-angular ‘rays’
emanate from it.
</p>
<p>If <code>rotate = TRUE</code> and <code>number[i] &gt;= 2</code>, a random direction
is chosen (instead of the y-axis) for the first ray.  The goal is to
<code><a href="https://r-universe.dev/manuals/base.html#jitter">jitter</a></code> the orientations of the sunflowers in order to
prevent artefactual visual impressions.
</p>


<h3>Value</h3>

<p>A list with three components of same length,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>y coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number</code></td>
<td>
<p>number</p>
</td>
</tr>
</table>
<p>Use <code><a href="https://r-universe.dev/manuals/grDevices.html#xyTable">xyTable</a>()</code> (from package
<span class="pkg">grDevices</span>) if you are only interested in this return value.
</p>


<h3>Side Effects</h3>

<p>A scatter plot is drawn with ‘sunflowers’ as symbols.
</p>


<h3>Author(s)</h3>

<p>Andreas Ruckstuhl, Werner Stahel, Martin Maechler, Tim Hesterberg,
1989–1993.  Port to <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> by Martin Maechler
<a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a>.
</p>


<h3>References</h3>

<p>Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983).
<em>Graphical Methods for Data Analysis</em>.
Wadsworth.
</p>
<p>Schilling, M. F. and Watkins, A. E. (1994).
A suggestion for sunflower plots.
<em>The American Statistician</em>, <b>48</b>, 303–305.
<a href="https://doi.org/10.2307/2684839" target="_blank">doi:10.2307/2684839</a>.
</p>
<p>Murrell, P. (2005).
<em>R Graphics</em>.
Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="https://r-universe.dev/manuals/stats.html#density">density</a></code>, <code><a href="https://r-universe.dev/manuals/grDevices.html#xyTable">xyTable</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span> <span class="token comment"># for rnorm</span>
require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span>

<span class="token comment">## 'number' is computed automatically:</span>
sunflowerplot<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">## Imitating Chambers et al, p.109, closely:</span>
sunflowerplot<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">.2</span><span class="token punctuation">,</span> cex.fact <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">.035</span><span class="token punctuation">,</span> seg.lwd <span class="token operator">=</span> <span class="token number">.8</span><span class="token punctuation">)</span>
<span class="token comment">## or</span>
sunflowerplot<span class="token punctuation">(</span>Petal.Width <span class="token operator">~</span> Petal.Length<span class="token punctuation">,</span> data <span class="token operator">=</span> iris<span class="token punctuation">,</span>
              cex <span class="token operator">=</span> <span class="token number">.2</span><span class="token punctuation">,</span> cex.fact <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">.035</span><span class="token punctuation">,</span> seg.lwd <span class="token operator">=</span> <span class="token number">.8</span><span class="token punctuation">)</span>


sunflowerplot<span class="token punctuation">(</span>x <span class="token operator">=</span> sort<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              main <span class="token operator">=</span> <span class="token string">"Sunflower Plot of Rounded N(0,1)"</span><span class="token punctuation">)</span>
<span class="token comment">## Similarly using a "xyTable" argument:</span>
xyT <span class="token operator">&lt;-</span> xyTable<span class="token punctuation">(</span>x <span class="token operator">=</span> sort<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               digits <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
utils<span class="token operator">::</span>str<span class="token punctuation">(</span>xyT<span class="token punctuation">,</span> vec.len <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>
sunflowerplot<span class="token punctuation">(</span>xyT<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"2nd Sunflower Plot of Rounded N(0,1)"</span><span class="token punctuation">)</span>

<span class="token comment">## A 'marked point process' {explicit 'number' argument}:</span>
sunflowerplot<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rnorm<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> number <span class="token operator">=</span> rpois<span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> lambda <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              main <span class="token operator">=</span> <span class="token string">"Sunflower plot (marked point process)"</span><span class="token punctuation">,</span>
              rotate <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue4"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="symbols">

<a href="#symbols" class="help-page-title"><h2>Draw Symbols (Circles, Squares, Stars, Thermometers, Boxplots)</h2></a>

<h3>Description</h3>

<p>This function draws symbols on a plot.  One of six symbols;
<em>circles</em>, <em>squares</em>, <em>rectangles</em>, <em>stars</em>,
<em>thermometers</em>, and <em>boxplots</em>, can be plotted at a
specified set of x and y coordinates.  Specific aspects of the
symbols, such as relative size, can be customized by additional
parameters.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">symbols<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> circles<span class="token punctuation">,</span> squares<span class="token punctuation">,</span> rectangles<span class="token punctuation">,</span> stars<span class="token punctuation">,</span>
        thermometers<span class="token punctuation">,</span> boxplots<span class="token punctuation">,</span> inches <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        fg <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"col"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>
        xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
        xlim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylim <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>the x and y co-ordinates for the centres of the symbols.
They can be specified in any way which is accepted by
<code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>circles</code></td>
<td>
<p>a vector giving the radii of the circles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squares</code></td>
<td>
<p>a vector giving the length of the sides of the squares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rectangles</code></td>
<td>
<p>a matrix with two columns.  The first column gives
widths and the second the heights of rectangles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stars</code></td>
<td>
<p>a matrix with three or more columns giving the lengths
of the rays from the center of the stars.  <code>NA</code> values
are replaced by zeroes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thermometers</code></td>
<td>
<p>a matrix with three or four columns.  The first
two columns give the width and height of the thermometer symbols. If
there are three columns, the third is taken as a proportion: the
thermometers are filled (using colour <code>fg</code>) from their base to
this proportion of their height.  If there are four columns, the
third and fourth columns are taken as proportions and the
thermometers are filled between these two proportions of their
heights.  The part of the box not filled in <code>fg</code> will be filled
in the background colour (default transparent) given by <code>bg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxplots</code></td>
<td>
<p>a matrix with five columns.  The first two columns
give the width and height of the boxes, the next two columns
give the lengths of the lower and upper whiskers and the fifth
the proportion (with a warning if not in [0,1]) of the way up
the box that the median line is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inches</code></td>
<td>
<p><code>TRUE</code>, <code>FALSE</code> or a positive number.
See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>if <code>add</code> is <code>TRUE</code>, the symbols are added to
an existing plot, otherwise a new plot is created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fg</code></td>
<td>
<p>colour(s) the symbols are to be drawn in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>if specified, the symbols are filled with colour(s), the
vector <code>bg</code> being recycled to the number of symbols.
The default is to leave the symbols unfilled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>the x label of the plot if <code>add</code> is not true.
Defaults to the <code><a href="https://r-universe.dev/manuals/base.html#deparse">deparse</a></code>d expression used for <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>the y label of the plot.  Unused if <code>add = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>a main title for the plot.  Unused if <code>add = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>numeric vector of length 2 giving the x limits for the
plot.  Unused if <code>add = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>numeric vector of length 2 giving the y limits for the
plot.  Unused if <code>add = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphics parameters can also be passed to this function,
as can the plot aspect ratio <code>asp</code> (see <code><a href="#plot.window">plot.window</a></code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Observations which have missing coordinates or missing size
parameters are not plotted.  The exception to this is <em>stars</em>.
In that case, the length of any ray which is <code>NA</code> is reset
to zero.
</p>
<p>Argument <code>inches</code> controls the sizes of the symbols.  If
<code>TRUE</code> (the default), the symbols are scaled so that the
largest dimension of any symbol is one inch.  If a positive number is
given the symbols are scaled to make largest dimension this size in
inches (so <code>TRUE</code> and <code>1</code> are equivalent).  If <code>inches</code>
is <code>FALSE</code>, the units are taken to be those of the appropriate
axes.  (For circles, squares and stars the units of the x axis are
used.  For boxplots, the lengths of the whiskers are regarded as
dimensions alongside width and height when scaling by <code>inches</code>,
and are otherwise interpreted in the units of the y axis.)
</p>

<p>Circles of radius zero are plotted at radius one pixel (which is
device-dependent).  Circles of a very small non-zero radius may or may
not be visible, and may be smaller than circles of radius zero.  On
<code>windows</code> devices circles are plotted at radius at least one
pixel as some Windows versions omit smaller circles.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>W. S. Cleveland (1985)
<em>The Elements of Graphing Data.</em>
Monterey, California: Wadsworth.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#stars">stars</a></code> for drawing <em>stars</em> with a bit more
flexibility.
</p>
<p>If you are thinking about doing ‘bubble plots’ by
<code>symbols(*, circles=*)</code>, you should <em>really</em> consider using
<code><a href="#sunflowerplot">sunflowerplot</a></code> instead.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">require<span class="token punctuation">(</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span> require<span class="token punctuation">(</span>grDevices<span class="token punctuation">)</span>
x <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span>
y <span class="token operator">&lt;-</span> sort<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span>runif<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
z <span class="token operator">&lt;-</span> runif<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
z3 <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>z<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>runif<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> runif<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
symbols<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> thermometers <span class="token operator">=</span> cbind<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">,</span> inches <span class="token operator">=</span> <span class="token number">.5</span><span class="token punctuation">,</span> fg <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
symbols<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> thermometers <span class="token operator">=</span> z3<span class="token punctuation">,</span> inches <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> apply<span class="token punctuation">(</span>format<span class="token punctuation">(</span>round<span class="token punctuation">(</span>z3<span class="token punctuation">,</span> digits <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> paste<span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">.2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">.75</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"purple"</span><span class="token punctuation">,</span> xpd <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>

<span class="token comment">## Note that  example(trees)  shows more sensible plots!</span>
N <span class="token operator">&lt;-</span> nrow<span class="token punctuation">(</span>trees<span class="token punctuation">)</span>
with<span class="token punctuation">(</span>trees<span class="token punctuation">,</span> <span class="token punctuation">{</span>
<span class="token comment">## Girth is diameter in inches</span>
symbols<span class="token punctuation">(</span>Height<span class="token punctuation">,</span> Volume<span class="token punctuation">,</span> circles <span class="token operator">=</span> Girth<span class="token operator">/</span><span class="token number">24</span><span class="token punctuation">,</span> inches <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> <span class="token string">"Trees' Girth"</span><span class="token punctuation">)</span> <span class="token comment"># xlab and ylab automatically</span>
<span class="token comment">## Colours too:</span>
op <span class="token operator">&lt;-</span> palette<span class="token punctuation">(</span>rainbow<span class="token punctuation">(</span>N<span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
symbols<span class="token punctuation">(</span>Height<span class="token punctuation">,</span> Volume<span class="token punctuation">,</span> circles <span class="token operator">=</span> Girth<span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">,</span> inches <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> bg <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">,</span>
        fg <span class="token operator">=</span> <span class="token string">"gray30"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"symbols(*, circles = Girth/16, bg = 1:N)"</span><span class="token punctuation">)</span>
palette<span class="token punctuation">(</span>op<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="text">

<a href="#text" class="help-page-title"><h2>Add Text to a Plot</h2></a>

<h3>Description</h3>

<p><code>text</code> draws the strings given in the vector <code>labels</code> at the
coordinates given by <code>x</code> and <code>y</code>.
<code>y</code> may be missing since <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a>(x, y)</code> is used for
construction of the coordinates.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>

<span class="token comment">## Default S3 method:</span>
 text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> seq_along<span class="token punctuation">(</span>x<span class="token operator">$</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> adj <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
     pos <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> offset <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> vfont <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
     cex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>numeric vectors of coordinates where the text
<code>labels</code> should be written.  If the length of <code>x</code> and
<code>y</code> differs, the shorter one is recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>a character vector or <a href="https://r-universe.dev/manuals/base.html#expression">expression</a> specifying
the <em>text</em> to be written.  An attempt is made to coerce other
language objects (names and calls) to expressions, and vectors and
other classed objects to character vectors by <code><a href="https://r-universe.dev/manuals/base.html#character">as.character</a></code>.
If <code>labels</code> is longer than <code>x</code> and
<code>y</code>, the coordinates are recycled to the length of <code>labels</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>one or two values in <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code> which specify the x
(and optionally y) adjustment (‘justification’) of the
labels, with 0 for left/bottom, 1 for right/top, and 0.5 for
centered.  On most devices values outside <code class="reqn"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></code> will also
work.  See below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>a position specifier for the text.  If specified this
overrides any <code>adj</code> value given.  Values of <code>1</code>,
<code>2</code>, <code>3</code> and <code>4</code>, respectively indicate
positions below, to the left of, above and to the right of
the specified <code>(x,y)</code> coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>when <code>pos</code> is specified, this value controls the
distance (‘offset’) of the text label from the specified
coordinate in fractions of a character width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vfont</code></td>
<td>
<p><code>NULL</code> for the current font family, or a character
vector of length 2 for Hershey vector fonts.  The first element of
the vector selects a typeface and the second element selects a
style.  Ignored if <code>labels</code> is an expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>numeric <b>c</b>haracter <b>ex</b>pansion factor; multiplied
by <code><a href="#par">par</a>("cex")</code> yields the final character size.
<code>NULL</code> and <code>NA</code> are equivalent to <code>1.0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, font</code></td>
<td>
<p>the color and (if <code>vfont = NULL</code>) font to be
used, possibly vectors.  These default to the values of the global
<a href="#par">graphical parameters</a> in <code><a href="#par">par</a>()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further <a href="#par">graphical parameters</a> (from <code><a href="#par">par</a></code>),
such as <code>srt</code>, <code>family</code> and <code>xpd</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>labels</code> must be of type <code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> or
<code><a href="https://r-universe.dev/manuals/base.html#expression">expression</a></code> (or be coercible to such a type).
In the latter case, quite a bit of
mathematical notation is available such as sub- and superscripts,
greek letters, fractions, etc.
</p>
<p><code>adj</code> allows <em>adj</em>ustment of the text position with respect to
<code>(x, y)</code>.
Values of 0, 0.5, and 1 specify that <code>(x, y)</code> should align with
the left/bottom, middle and
right/top of the text, respectively.  The default is for centered text, i.e.,
<code>adj = c(0.5, NA)</code>.  Accurate vertical centering needs
character metric information on individual characters which is
only available on some devices.  Vertical alignment is done slightly
differently for character strings and for expressions:
<code>adj = c(0,0)</code> means to left-justify and to align on the baseline
for strings but on the bottom of the bounding box for expressions.
This also affects vertical centering: for strings the centering
excludes any descenders whereas for expressions it includes them.
Using <code>NA</code> for strings centers them, including descenders.
</p>
<p>The <code>pos</code> and <code>offset</code> arguments can be used in conjunction
with values returned by <code>identify</code> to recreate an interactively
labelled plot.
</p>
<p>Text can be rotated by using <a href="#par">graphical parameters</a> <code>srt</code>
(see <code><a href="#par">par</a></code>).  When <code>adj</code> is specified, a non-zero
<code>srt</code> rotates the label about <code>(x, y)</code>.  If <code>pos</code> is
specified, <code>srt</code> rotates the text about the point on its bounding
box which is closest to <code>(x, y)</code>: top center for <code>pos = 1</code>,
right center for <code>pos = 2</code>, bottom center for <code>pos = 3</code>, and
left center for <code>pos = 4</code>.  The <code>pos</code> interface is not as
useful for rotated text because the result is no longer centered
vertically or horizontally with respect to <code>(x, y)</code>.  At present
there is no interface in the <span class="pkg">graphics</span> package for directly
rotating text about its center which is achievable however by fiddling
with <code>adj</code> and <code>srt</code> simultaneously.
</p>
<p>Graphical parameters <code>col</code>, <code>cex</code> and <code>font</code> can be
vectors and will then be applied cyclically to the <code>labels</code> (and
extra values will be ignored).  <code>NA</code> values of <code>font</code> are
replaced by <code>par("font")</code>, and similarly for <code>col</code>.
</p>
<p>Labels whose <code>x</code>, <code>y</code> or <code>labels</code> value is <code>NA</code>
are omitted from the plot.
</p>
<p>What happens when <code>font = 5</code> (the symbol font) is selected can be
both device- and locale-dependent.  Most often <code>labels</code> will be
interpreted in the Adobe symbol encoding, so e.g. <code>"d"</code>
is delta, and <code>"\300"</code> is aleph.
</p>


<h3>Euro symbol</h3>

<p>The Euro symbol may not be available in older fonts.  In current
versions of Adobe symbol fonts it is character 160, so <code>text(x,
  y, "\xA0", font = 5)</code> may work. People using Western European locales
on Unix-alikes can probably select ISO-8895-15 (Latin-9) which has the
Euro as character 165: this can also be used for
<code><a href="https://r-universe.dev/manuals/grDevices.html#postscript">postscript</a></code> and <code><a href="https://r-universe.dev/manuals/grDevices.html#pdf">pdf</a></code>. It is ‘<span class="samp">⁠\u20ac⁠</span>’ in
Unicode, which can be used in UTF-8 locales.
</p>
<p>The Euro should be rendered correctly by <code><a href="https://r-universe.dev/manuals/grDevices.html#x11">X11</a></code> in UTF-8
locales, but the corresponding single-byte encoding in
<code><a href="https://r-universe.dev/manuals/grDevices.html#postscript">postscript</a></code> and <code><a href="https://r-universe.dev/manuals/grDevices.html#pdf">pdf</a></code> will need to be selected
as <code>ISOLatin9.enc</code> (and the font will need to contain the Euro
glyph, which for example older printers may not).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#plot.formula">text.formula</a></code> for the formula method;
<code><a href="#mtext">mtext</a></code>, <code><a href="#title">title</a></code>,
<code><a href="https://r-universe.dev/manuals/grDevices.html#Hershey">Hershey</a></code> for details on Hershey vector fonts,
<code><a href="https://r-universe.dev/manuals/grDevices.html#plotmath">plotmath</a></code> for details and more examples on
mathematical annotation.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"Re"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"Im"</span><span class="token punctuation">)</span>
K <span class="token operator">&lt;-</span> <span class="token number">16</span><span class="token punctuation">;</span> text<span class="token punctuation">(</span>exp<span class="token punctuation">(</span><span class="token number">1i</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>K<span class="token punctuation">)</span> <span class="token operator">/</span> K<span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">## The following two examples use latin1 characters: these may not</span>
<span class="token comment">## appear correctly (or be omitted entirely).</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"text(...) examples\n~~~~~~~~~~~~~~"</span><span class="token punctuation">,</span>
     sub <span class="token operator">=</span> <span class="token string">"R is GNU ©, but not ® ..."</span><span class="token punctuation">)</span>
mtext<span class="token punctuation">(</span><span class="token string">"«Latin-1 accented chars»: éè øØ å&lt;Å æ&lt;Æ"</span><span class="token punctuation">,</span> side <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
points<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"the text is CENTERED around (x,y) = (6,2) by default"</span><span class="token punctuation">,</span>
     cex <span class="token operator">=</span> <span class="token number">.8</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"or Left/Bottom - JUSTIFIED at (2,1) by 'adj = c(0,0)'"</span><span class="token punctuation">,</span>
     adj <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> expression<span class="token punctuation">(</span>hat<span class="token punctuation">(</span>beta<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>X<span class="token operator">^</span>t <span class="token operator">*</span> X<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">*</span> X<span class="token operator">^</span>t <span class="token operator">*</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8.4</span><span class="token punctuation">,</span> <span class="token string">"expression(hat(beta) == (X^t * X)^{-1} * X^t * y)"</span><span class="token punctuation">,</span>
     cex <span class="token operator">=</span> <span class="token number">.75</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> expression<span class="token punctuation">(</span>bar<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> sum<span class="token punctuation">(</span>frac<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Two more latin1 examples</span>
text<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10.2</span><span class="token punctuation">,</span>
     <span class="token string">"Le français, c'est façile: Règles, Liberté, Egalité, Fraternité..."</span><span class="token punctuation">)</span>
text<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9.8</span><span class="token punctuation">,</span>
     <span class="token string">"Jetz no chli züritüütsch: (noch ein bißchen Zürcher deutsch)"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="title">

<a href="#title" class="help-page-title"><h2>Plot Annotation</h2></a>

<h3>Description</h3>

<p>This function can be used to add labels to a plot.  Its first four
principal arguments can also be used as arguments in most high-level
plotting functions.  They must be of type <code><a href="https://r-universe.dev/manuals/base.html#character">character</a></code> or
<code><a href="https://r-universe.dev/manuals/base.html#expression">expression</a></code>. In the latter case, quite a bit of
mathematical notation is available such as sub- and superscripts,
greek letters, fractions, etc: see <a href="https://r-universe.dev/manuals/grDevices.html#plotmath">plotmath</a>
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">title<span class="token punctuation">(</span>main <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> sub <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
      line <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> outer <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>The main title (on top) using font, size (character
expansion) and color <code>par(c("font.main", "cex.main", "col.main"))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>Sub-title (at bottom) using font, size and color 
<code>par(c("font.sub", "cex.sub", "col.sub"))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X axis label using font, size and color 
<code>par(c("font.lab", "cex.lab", "col.lab"))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y axis label, same font attributes as <code>xlab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>
<p>specifying a value for <code>line</code> overrides the
default placement of labels, and places them this many lines
outwards from the plot edge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer</code></td>
<td>
<p>a logical value.  If <code>TRUE</code>, the titles are
placed in the outer margins of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further <a href="#par">graphical parameters</a> from <code><a href="#par">par</a></code>.  Use
e.g., <code>col.main</code> or <code>cex.sub</code> instead of just <code>col</code>
or <code>cex</code>.  <code>adj</code> controls the justification of the titles.
<code>xpd</code> can be used to set the clipping region:
this defaults to the figure region unless <code>outer = TRUE</code>,
otherwise the device region and can only be increased.  <code>mgp</code>
controls the default placing of the axis titles.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The labels passed to <code>title</code> can be character strings or
language objects (names, calls or expressions), or a list
containing the string to be plotted, and a selection of the optional
modifying <a href="#par">graphical parameters</a> <code>cex=</code>, <code>col=</code> and
<code>font=</code>.  Other objects will be coerced by
<code><a href="https://r-universe.dev/manuals/grDevices.html#as.graphicsAnnot">as.graphicsAnnot</a></code>.
</p>
<p>The position of <code>main</code> defaults to being vertically centered in
(outer) margin 3 and justified horizontally according to
<code>par("adj")</code> on the plot region (device region for
<code>outer = TRUE</code>).
</p>
<p>The positions of <code>xlab</code>, <code>ylab</code> and <code>sub</code> are
<code>line</code> (default for <code>xlab</code> and <code>ylab</code> being
<code>par("mgp")[1]</code> and increased by <code>1</code> for <code>sub</code>) lines
(of height <code>par("mex")</code>) into the appropriate margin, justified
in the text direction according to <code>par("adj")</code> on the
plot/device region.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#mtext">mtext</a></code>, <code><a href="#text">text</a></code>;
<code><a href="https://r-universe.dev/manuals/grDevices.html#plotmath">plotmath</a></code> for details on mathematical annotation.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">plot<span class="token punctuation">(</span>cars<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment"># here, could use main directly</span>
title<span class="token punctuation">(</span>main <span class="token operator">=</span> <span class="token string">"Stopping Distance versus Speed"</span><span class="token punctuation">)</span>

plot<span class="token punctuation">(</span>cars<span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span>main <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token string">"Stopping Distance versus Speed"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">,</span>
                  col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> font <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Specifying "..." :</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> col.axis <span class="token operator">=</span> <span class="token string">"sky blue"</span><span class="token punctuation">,</span> col.lab <span class="token operator">=</span> <span class="token string">"thistle"</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span><span class="token string">"Main Title"</span><span class="token punctuation">,</span> sub <span class="token operator">=</span> <span class="token string">"subtitle"</span><span class="token punctuation">,</span>
      cex.main <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   font.main<span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> col.main<span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span>
      cex.sub <span class="token operator">=</span> <span class="token number">0.75</span><span class="token punctuation">,</span> font.sub <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> col.sub <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>


x <span class="token operator">&lt;-</span> seq<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> length.out <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>sin<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> cos<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
matplot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"l"</span><span class="token punctuation">,</span> xaxt <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span>
        main <span class="token operator">=</span> expression<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>plain<span class="token punctuation">(</span>sin<span class="token punctuation">)</span> <span class="token operator">*</span> phi<span class="token punctuation">,</span> <span class="token string">"  and  "</span><span class="token punctuation">,</span>
                                plain<span class="token punctuation">(</span>cos<span class="token punctuation">)</span> <span class="token operator">*</span> phi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        ylab <span class="token operator">=</span> expression<span class="token punctuation">(</span><span class="token string">"sin"</span> <span class="token operator">*</span> phi<span class="token punctuation">,</span> <span class="token string">"cos"</span> <span class="token operator">*</span> phi<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># only 1st is taken</span>
        xlab <span class="token operator">=</span> expression<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"Phase Angle "</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        col.main <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span>
axis<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> at <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token operator">-</span>pi<span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> pi<span class="token punctuation">)</span><span class="token punctuation">,</span>
     labels <span class="token operator">=</span> expression<span class="token punctuation">(</span><span class="token operator">-</span>pi<span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> pi<span class="token punctuation">)</span><span class="token punctuation">)</span>
abline<span class="token punctuation">(</span>h <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v <span class="token operator">=</span> pi<span class="token operator">/</span><span class="token number">2</span> <span class="token operator">*</span> c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lty <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> lwd <span class="token operator">=</span> <span class="token number">.1</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"gray70"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="units">

<a href="#units" class="help-page-title"><h2>Graphical Units</h2></a>

<h3>Description</h3>

<p><code>xinch</code> and <code>yinch</code> convert the specified number of inches
given as their arguments into the correct units for plotting with
graphics functions.  Usually, this only makes sense when normal
coordinates are used, i.e., <em>no</em> <code>log</code> scale (see the
<code>log</code> argument to <code><a href="#par">par</a></code>).
</p>
<p><code>xyinch</code> does the same for a pair of numbers <code>xy</code>,
simultaneously.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">xinch<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> warn.log <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
yinch<span class="token punctuation">(</span>y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> warn.log <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
xyinch<span class="token punctuation">(</span>xy <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> warn.log <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>
<p>numeric of length 1 or 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn.log</code></td>
<td>
<p>logical; if <code>TRUE</code>, a warning is printed in case
of active log scale.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r">all<span class="token punctuation">(</span>c<span class="token punctuation">(</span>xinch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yinch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> xyinch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># TRUE</span>
xyinch<span class="token punctuation">(</span><span class="token punctuation">)</span>
xyinch <span class="token comment">#- to see that is really   delta{"usr"} / "pin"</span>

<span class="token comment">## plot labels offset 0.12 inches to the right</span>
<span class="token comment">## of plotted symbols in a plot</span>
with<span class="token punctuation">(</span>mtcars<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    plot<span class="token punctuation">(</span>mpg<span class="token punctuation">,</span> disp<span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"Motor Trend Cars"</span><span class="token punctuation">)</span>
    text<span class="token punctuation">(</span>mpg <span class="token operator">+</span> xinch<span class="token punctuation">(</span><span class="token number">0.12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> disp<span class="token punctuation">,</span> row.names<span class="token punctuation">(</span>mtcars<span class="token punctuation">)</span><span class="token punctuation">,</span>
         adj <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">.7</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="xspline">

<a href="#xspline" class="help-page-title"><h2>Draw an X-spline</h2></a>

<h3>Description</h3>

<p>Draw an X-spline, a curve drawn relative to control points.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">xspline<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> shape <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> open <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> repEnds <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
        draw <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> border <span class="token operator">=</span> par<span class="token punctuation">(</span><span class="token string">"fg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,y</code></td>
<td>
<p>vectors containing the coordinates of the vertices
of the polygon. See <code><a href="https://r-universe.dev/manuals/grDevices.html#xy.coords">xy.coords</a></code> for alternatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>A numeric vector of values between -1 and 1, which
control the shape of the spline relative to the control points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>open</code></td>
<td>
<p>A logical value indicating whether the spline is
an open or a closed shape.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repEnds</code></td>
<td>
<p>For open X-splines, a logical value indicating whether
the first and last control points should be replicated for drawing
the curve. Ignored for closed X-splines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>logical: should the X-spline be drawn?  If false, a set of
line segments to draw the curve is returned, and nothing is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>the color to draw the curve.   Use <code>border = NA</code> to
omit borders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>the color for filling the shape. The default,
<code>NA</code>, is to leave unfilled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><a href="#par">graphical parameters</a> such as <code>lty</code>, <code>xpd</code>,
<code>lend</code>, <code>ljoin</code> and <code>lmitre</code> can be given as arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An X-spline is a line drawn relative to control points.  For each
control point, the line may pass through (interpolate) the control
point or it may only approach (approximate) the control point;  the
behaviour is determined by a shape parameter for each control point.
</p>
<p>If the shape parameter is greater than zero, the spline approximates
the control points (and is very similar to a cubic B-spline when the
shape is 1).  If the shape parameter is less than zero, the spline
interpolates the control points (and is very similar to a Catmull-Rom
spline when the shape is -1).  If the shape parameter is 0, the spline
forms a sharp corner at that control point.
</p>
<p>For open X-splines, the start and end control points must have a shape
of 0 (and non-zero values are silently converted to zero).
</p>
<p>For open X-splines, by default the start and end control points are
replicated before the curve is drawn.  A curve is drawn between
(interpolating or approximating) the second and third of each set of
four control points, so this default behaviour ensures that the
resulting curve starts at the first control point you have specified
and ends at the last control point.  The default behaviour can be
turned off via the <code>repEnds</code> argument.
</p>


<h3>Value</h3>

<p>If <code>draw = TRUE</code>, <code>NULL</code> otherwise a list with elements
<code>x</code> and <code>y</code> which could be passed to <code><a href="#lines">lines</a></code>,
<code><a href="#polygon">polygon</a></code> and so on.
</p>
<p>Invisible in both cases.
</p>


<h3>Note</h3>

<p>Two-dimensional splines need to be created in an isotropic coordinate
system.  Device coordinates are used (with an anisotropy correction if
needed.)
</p>


<h3>References</h3>

<p>Blanc, C. and Schlick, C. (1995),
<em>X-splines : A Spline Model Designed for the End User</em>,
in <em>Proceedings of SIGGRAPH 95</em>, pp. 377–386.
<a href="https://dept-info.labri.fr/~schlick/DOC/sig1.html" target="_blank">https://dept-info.labri.fr/~schlick/DOC/sig1.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#polygon">polygon</a></code>.
</p>
<p><code><a href="#par">par</a></code> for how to specify colors.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## based on examples in ?grid.xspline</span>

xsplineTest <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> open <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
                        x <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">,</span>
                        y <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    plot<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"n"</span><span class="token punctuation">,</span> axes <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
    points<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">)</span>
    xspline<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> s<span class="token punctuation">,</span> open<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
    text<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">0.05</span><span class="token operator">*</span>c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">0.05</span><span class="token operator">*</span>c<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
op <span class="token operator">&lt;-</span> par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> oma <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span><span class="token string">"Open X-splines"</span><span class="token punctuation">,</span> outer <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mar <span class="token operator">=</span> rep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> oma <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey80"</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey80"</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey80"</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey80"</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey80"</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey80"</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey80"</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey80"</span><span class="token punctuation">)</span>
xsplineTest<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"grey80"</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span><span class="token string">"Closed X-splines"</span><span class="token punctuation">,</span> outer <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

par<span class="token punctuation">(</span>op<span class="token punctuation">)</span>

x <span class="token operator">&lt;-</span> sort<span class="token punctuation">(</span>stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">&lt;-</span> sort<span class="token punctuation">(</span>stats<span class="token operator">::</span>rnorm<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">)</span>
res <span class="token operator">&lt;-</span> xspline<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> draw <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token comment">## the end points may be very close together,</span>
<span class="token comment">## so use last few for direction</span>
nr <span class="token operator">&lt;-</span> length<span class="token punctuation">(</span>res<span class="token operator">$</span>x<span class="token punctuation">)</span>
arrows<span class="token punctuation">(</span>res<span class="token operator">$</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token operator">$</span>y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token operator">$</span>x<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token operator">$</span>y<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> code <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span>
arrows<span class="token punctuation">(</span>res<span class="token operator">$</span>x<span class="token punctuation">[</span>nr<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token operator">$</span>y<span class="token punctuation">[</span>nr<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token operator">$</span>x<span class="token punctuation">[</span>nr<span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token operator">$</span>y<span class="token punctuation">[</span>nr<span class="token punctuation">]</span><span class="token punctuation">,</span> code <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
</div>
    <footer><p>Rendered with postdoc 1.0.9000</p></footer>
  </body>
</html>
